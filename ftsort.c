// Generated by Futhark 0.25.26.
// Compiled with GHC 9.10.1.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size);
void futhark_context_config_set_unified_memory(struct futhark_context_config *cfg, int flag);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s);
const char *futhark_context_config_get_program(struct futhark_context_config *cfg);
void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *s);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_tup3_i64_i32_i64;
struct futhark_opaque_tup2_i64_i64;
struct futhark_opaque_arr1d_tup3_i64_i32_i64;
struct futhark_opaque_arr1d_tup2_i64_i64;
struct futhark_opaque_sortInfo_double;
struct futhark_opaque_sortInfo_float;
struct futhark_opaque_sortInfo_int;
struct futhark_opaque_sortInfo_long;
struct futhark_opaque_sortInfo_short;
int futhark_free_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 *obj);
int futhark_store_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup3_i64_i32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup3_i64_i32_i64 *futhark_restore_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup3_i64_i32_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj);
int futhark_project_opaque_tup3_i64_i32_i64_1(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj);
int futhark_project_opaque_tup3_i64_i32_i64_2(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj);
int futhark_new_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 **out, const int64_t f_0, const int32_t f_1, const int64_t f_2);
int futhark_free_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_store_opaque_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_i64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_i64_i64 *futhark_restore_opaque_tup2_i64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_i64_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_project_opaque_tup2_i64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj);
int futhark_new_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, const int64_t f_0, const int64_t f_1);
int futhark_free_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj);
int futhark_store_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup3_i64_i32_i64 *futhark_restore_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj);
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_1(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj);
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_2(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj);
int futhark_zip_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i32_1d *f_1, const struct futhark_i64_1d *f_2);
int futhark_index_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 **out, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *arr);
int futhark_free_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_store_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_i64_i64 *futhark_restore_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_i64_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_project_opaque_arr1d_tup2_i64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj);
int futhark_zip_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, struct futhark_opaque_arr1d_tup2_i64_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *arr);
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj);
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs);
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj);
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs);
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj);
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs);
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj);
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs);
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj);
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs);

// Entry points
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0);
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0);
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_mergeFunc(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1);
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2);
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2);
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2);
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2);
int futhark_entry_partitionFunc(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out0, const int64_t in0, const struct futhark_i32_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_sortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2);
int futhark_entry_sortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2);
int futhark_entry_sortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2);
int futhark_entry_sortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2);
int futhark_entry_sortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>


#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
};
struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
    struct memblock_device counters_mem_48106;
    struct memblock_device global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882;
};
struct tuning_params {
    int dummy;
    int64_t *argmin_doublezisegred_num_tblocks_44062;
    int64_t *argmin_doublezisegred_tblock_sizze_44060;
    int64_t *argmin_floatzisegred_num_tblocks_44051;
    int64_t *argmin_floatzisegred_tblock_sizze_44049;
    int64_t *argmin_intzisegred_num_tblocks_44029;
    int64_t *argmin_intzisegred_tblock_sizze_44027;
    int64_t *argmin_longzisegred_num_tblocks_44040;
    int64_t *argmin_longzisegred_tblock_sizze_44038;
    int64_t *argmin_shortzisegred_num_tblocks_44018;
    int64_t *argmin_shortzisegred_tblock_sizze_44016;
    int64_t *builtinzhiota_i64zitblock_sizze_48114;
    int64_t *builtinzhreplicate_i16zitblock_sizze_48435;
    int64_t *builtinzhreplicate_i32zitblock_sizze_48190;
    int64_t *builtinzhreplicate_i8zitblock_sizze_48152;
    int64_t *mergeFunczisuff_outer_par_0;
    int64_t *mergeFunczitile_sizze_46988;
    int64_t *mergeFunczitile_sizze_47383;
    int64_t *orderByIndices_doublezisegmap_tblock_sizze_44403;
    int64_t *orderByIndices_floatzisegmap_tblock_sizze_44375;
    int64_t *orderByIndices_intzisegmap_tblock_sizze_44319;
    int64_t *orderByIndices_longzisegmap_tblock_sizze_44347;
    int64_t *orderByIndices_shortzisegmap_tblock_sizze_44291;
    int64_t *partitionFunczisegmap_tblock_sizze_43861;
    int64_t *sortColumn_doublezisegmap_num_tblocks_45923;
    int64_t *sortColumn_doublezisegmap_num_tblocks_46066;
    int64_t *sortColumn_doublezisegmap_num_tblocks_46115;
    int64_t *sortColumn_doublezisegmap_num_tblocks_46137;
    int64_t *sortColumn_doublezisegmap_num_tblocks_46403;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_45921;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_45929;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46064;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46091;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46113;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46135;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46157;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46379;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46401;
    int64_t *sortColumn_doublezisegmap_tblock_sizze_46409;
    int64_t *sortColumn_doublezisegscan_num_tblocks_45913;
    int64_t *sortColumn_doublezisegscan_num_tblocks_46179;
    int64_t *sortColumn_doublezisegscan_num_tblocks_46371;
    int64_t *sortColumn_doublezisegscan_tblock_sizze_45911;
    int64_t *sortColumn_doublezisegscan_tblock_sizze_46177;
    int64_t *sortColumn_doublezisegscan_tblock_sizze_46369;
    int64_t *sortColumn_doublezisuff_intra_par_0;
    int64_t *sortColumn_floatzisegmap_num_tblocks_45407;
    int64_t *sortColumn_floatzisegmap_num_tblocks_45547;
    int64_t *sortColumn_floatzisegmap_num_tblocks_45596;
    int64_t *sortColumn_floatzisegmap_num_tblocks_45618;
    int64_t *sortColumn_floatzisegmap_num_tblocks_45878;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45405;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45413;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45545;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45572;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45594;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45616;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45638;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45854;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45876;
    int64_t *sortColumn_floatzisegmap_tblock_sizze_45884;
    int64_t *sortColumn_floatzisegscan_num_tblocks_45397;
    int64_t *sortColumn_floatzisegscan_num_tblocks_45660;
    int64_t *sortColumn_floatzisegscan_num_tblocks_45846;
    int64_t *sortColumn_floatzisegscan_tblock_sizze_45395;
    int64_t *sortColumn_floatzisegscan_tblock_sizze_45658;
    int64_t *sortColumn_floatzisegscan_tblock_sizze_45844;
    int64_t *sortColumn_floatzisuff_intra_par_0;
    int64_t *sortColumn_intzisegmap_num_tblocks_46448;
    int64_t *sortColumn_intzisegmap_num_tblocks_46579;
    int64_t *sortColumn_intzisegmap_num_tblocks_46628;
    int64_t *sortColumn_intzisegmap_num_tblocks_46650;
    int64_t *sortColumn_intzisegmap_num_tblocks_46892;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46446;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46454;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46577;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46604;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46626;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46648;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46670;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46868;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46890;
    int64_t *sortColumn_intzisegmap_tblock_sizze_46898;
    int64_t *sortColumn_intzisegscan_num_tblocks_46438;
    int64_t *sortColumn_intzisegscan_num_tblocks_46692;
    int64_t *sortColumn_intzisegscan_num_tblocks_46860;
    int64_t *sortColumn_intzisegscan_tblock_sizze_46436;
    int64_t *sortColumn_intzisegscan_tblock_sizze_46690;
    int64_t *sortColumn_intzisegscan_tblock_sizze_46858;
    int64_t *sortColumn_intzisuff_intra_par_0;
    int64_t *sortColumn_longzisegmap_num_tblocks_44924;
    int64_t *sortColumn_longzisegmap_num_tblocks_45053;
    int64_t *sortColumn_longzisegmap_num_tblocks_45102;
    int64_t *sortColumn_longzisegmap_num_tblocks_45124;
    int64_t *sortColumn_longzisegmap_num_tblocks_45362;
    int64_t *sortColumn_longzisegmap_tblock_sizze_44922;
    int64_t *sortColumn_longzisegmap_tblock_sizze_44930;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45051;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45078;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45100;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45122;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45144;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45338;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45360;
    int64_t *sortColumn_longzisegmap_tblock_sizze_45368;
    int64_t *sortColumn_longzisegscan_num_tblocks_44914;
    int64_t *sortColumn_longzisegscan_num_tblocks_45166;
    int64_t *sortColumn_longzisegscan_num_tblocks_45330;
    int64_t *sortColumn_longzisegscan_tblock_sizze_44912;
    int64_t *sortColumn_longzisegscan_tblock_sizze_45164;
    int64_t *sortColumn_longzisegscan_tblock_sizze_45328;
    int64_t *sortColumn_longzisuff_intra_par_0;
    int64_t *sortColumn_shortzisegmap_num_tblocks_44441;
    int64_t *sortColumn_shortzisegmap_num_tblocks_44570;
    int64_t *sortColumn_shortzisegmap_num_tblocks_44619;
    int64_t *sortColumn_shortzisegmap_num_tblocks_44641;
    int64_t *sortColumn_shortzisegmap_num_tblocks_44879;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44439;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44447;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44568;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44595;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44617;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44639;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44661;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44855;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44877;
    int64_t *sortColumn_shortzisegmap_tblock_sizze_44885;
    int64_t *sortColumn_shortzisegscan_num_tblocks_44431;
    int64_t *sortColumn_shortzisegscan_num_tblocks_44683;
    int64_t *sortColumn_shortzisegscan_num_tblocks_44847;
    int64_t *sortColumn_shortzisegscan_tblock_sizze_44429;
    int64_t *sortColumn_shortzisegscan_tblock_sizze_44681;
    int64_t *sortColumn_shortzisegscan_tblock_sizze_44845;
    int64_t *sortColumn_shortzisuff_intra_par_0;
};
static const int num_tuning_params = 133;
static const char *tuning_param_names[] = {"argmin_double.segred_num_tblocks_44062", "argmin_double.segred_tblock_size_44060", "argmin_float.segred_num_tblocks_44051", "argmin_float.segred_tblock_size_44049", "argmin_int.segred_num_tblocks_44029", "argmin_int.segred_tblock_size_44027", "argmin_long.segred_num_tblocks_44040", "argmin_long.segred_tblock_size_44038", "argmin_short.segred_num_tblocks_44018", "argmin_short.segred_tblock_size_44016", "builtin#iota_i64.tblock_size_48114", "builtin#replicate_i16.tblock_size_48435", "builtin#replicate_i32.tblock_size_48190", "builtin#replicate_i8.tblock_size_48152", "mergeFunc.suff_outer_par_0", "mergeFunc.tile_size_46988", "mergeFunc.tile_size_47383", "orderByIndices_double.segmap_tblock_size_44403", "orderByIndices_float.segmap_tblock_size_44375", "orderByIndices_int.segmap_tblock_size_44319", "orderByIndices_long.segmap_tblock_size_44347", "orderByIndices_short.segmap_tblock_size_44291", "partitionFunc.segmap_tblock_size_43861", "sortColumn_double.segmap_num_tblocks_45923", "sortColumn_double.segmap_num_tblocks_46066", "sortColumn_double.segmap_num_tblocks_46115", "sortColumn_double.segmap_num_tblocks_46137", "sortColumn_double.segmap_num_tblocks_46403", "sortColumn_double.segmap_tblock_size_45921", "sortColumn_double.segmap_tblock_size_45929", "sortColumn_double.segmap_tblock_size_46064", "sortColumn_double.segmap_tblock_size_46091", "sortColumn_double.segmap_tblock_size_46113", "sortColumn_double.segmap_tblock_size_46135", "sortColumn_double.segmap_tblock_size_46157", "sortColumn_double.segmap_tblock_size_46379", "sortColumn_double.segmap_tblock_size_46401", "sortColumn_double.segmap_tblock_size_46409", "sortColumn_double.segscan_num_tblocks_45913", "sortColumn_double.segscan_num_tblocks_46179", "sortColumn_double.segscan_num_tblocks_46371", "sortColumn_double.segscan_tblock_size_45911", "sortColumn_double.segscan_tblock_size_46177", "sortColumn_double.segscan_tblock_size_46369", "sortColumn_double.suff_intra_par_0", "sortColumn_float.segmap_num_tblocks_45407", "sortColumn_float.segmap_num_tblocks_45547", "sortColumn_float.segmap_num_tblocks_45596", "sortColumn_float.segmap_num_tblocks_45618", "sortColumn_float.segmap_num_tblocks_45878", "sortColumn_float.segmap_tblock_size_45405", "sortColumn_float.segmap_tblock_size_45413", "sortColumn_float.segmap_tblock_size_45545", "sortColumn_float.segmap_tblock_size_45572", "sortColumn_float.segmap_tblock_size_45594", "sortColumn_float.segmap_tblock_size_45616", "sortColumn_float.segmap_tblock_size_45638", "sortColumn_float.segmap_tblock_size_45854", "sortColumn_float.segmap_tblock_size_45876", "sortColumn_float.segmap_tblock_size_45884", "sortColumn_float.segscan_num_tblocks_45397", "sortColumn_float.segscan_num_tblocks_45660", "sortColumn_float.segscan_num_tblocks_45846", "sortColumn_float.segscan_tblock_size_45395", "sortColumn_float.segscan_tblock_size_45658", "sortColumn_float.segscan_tblock_size_45844", "sortColumn_float.suff_intra_par_0", "sortColumn_int.segmap_num_tblocks_46448", "sortColumn_int.segmap_num_tblocks_46579", "sortColumn_int.segmap_num_tblocks_46628", "sortColumn_int.segmap_num_tblocks_46650", "sortColumn_int.segmap_num_tblocks_46892", "sortColumn_int.segmap_tblock_size_46446", "sortColumn_int.segmap_tblock_size_46454", "sortColumn_int.segmap_tblock_size_46577", "sortColumn_int.segmap_tblock_size_46604", "sortColumn_int.segmap_tblock_size_46626", "sortColumn_int.segmap_tblock_size_46648", "sortColumn_int.segmap_tblock_size_46670", "sortColumn_int.segmap_tblock_size_46868", "sortColumn_int.segmap_tblock_size_46890", "sortColumn_int.segmap_tblock_size_46898", "sortColumn_int.segscan_num_tblocks_46438", "sortColumn_int.segscan_num_tblocks_46692", "sortColumn_int.segscan_num_tblocks_46860", "sortColumn_int.segscan_tblock_size_46436", "sortColumn_int.segscan_tblock_size_46690", "sortColumn_int.segscan_tblock_size_46858", "sortColumn_int.suff_intra_par_0", "sortColumn_long.segmap_num_tblocks_44924", "sortColumn_long.segmap_num_tblocks_45053", "sortColumn_long.segmap_num_tblocks_45102", "sortColumn_long.segmap_num_tblocks_45124", "sortColumn_long.segmap_num_tblocks_45362", "sortColumn_long.segmap_tblock_size_44922", "sortColumn_long.segmap_tblock_size_44930", "sortColumn_long.segmap_tblock_size_45051", "sortColumn_long.segmap_tblock_size_45078", "sortColumn_long.segmap_tblock_size_45100", "sortColumn_long.segmap_tblock_size_45122", "sortColumn_long.segmap_tblock_size_45144", "sortColumn_long.segmap_tblock_size_45338", "sortColumn_long.segmap_tblock_size_45360", "sortColumn_long.segmap_tblock_size_45368", "sortColumn_long.segscan_num_tblocks_44914", "sortColumn_long.segscan_num_tblocks_45166", "sortColumn_long.segscan_num_tblocks_45330", "sortColumn_long.segscan_tblock_size_44912", "sortColumn_long.segscan_tblock_size_45164", "sortColumn_long.segscan_tblock_size_45328", "sortColumn_long.suff_intra_par_0", "sortColumn_short.segmap_num_tblocks_44441", "sortColumn_short.segmap_num_tblocks_44570", "sortColumn_short.segmap_num_tblocks_44619", "sortColumn_short.segmap_num_tblocks_44641", "sortColumn_short.segmap_num_tblocks_44879", "sortColumn_short.segmap_tblock_size_44439", "sortColumn_short.segmap_tblock_size_44447", "sortColumn_short.segmap_tblock_size_44568", "sortColumn_short.segmap_tblock_size_44595", "sortColumn_short.segmap_tblock_size_44617", "sortColumn_short.segmap_tblock_size_44639", "sortColumn_short.segmap_tblock_size_44661", "sortColumn_short.segmap_tblock_size_44855", "sortColumn_short.segmap_tblock_size_44877", "sortColumn_short.segmap_tblock_size_44885", "sortColumn_short.segscan_num_tblocks_44431", "sortColumn_short.segscan_num_tblocks_44683", "sortColumn_short.segscan_num_tblocks_44847", "sortColumn_short.segscan_tblock_size_44429", "sortColumn_short.segscan_tblock_size_44681", "sortColumn_short.segscan_tblock_size_44845", "sortColumn_short.suff_intra_par_0", NULL};
static const char *tuning_param_vars[] = {"argmin_doublezisegred_num_tblocks_44062", "argmin_doublezisegred_tblock_sizze_44060", "argmin_floatzisegred_num_tblocks_44051", "argmin_floatzisegred_tblock_sizze_44049", "argmin_intzisegred_num_tblocks_44029", "argmin_intzisegred_tblock_sizze_44027", "argmin_longzisegred_num_tblocks_44040", "argmin_longzisegred_tblock_sizze_44038", "argmin_shortzisegred_num_tblocks_44018", "argmin_shortzisegred_tblock_sizze_44016", "builtinzhiota_i64zitblock_sizze_48114", "builtinzhreplicate_i16zitblock_sizze_48435", "builtinzhreplicate_i32zitblock_sizze_48190", "builtinzhreplicate_i8zitblock_sizze_48152", "mergeFunczisuff_outer_par_0", "mergeFunczitile_sizze_46988", "mergeFunczitile_sizze_47383", "orderByIndices_doublezisegmap_tblock_sizze_44403", "orderByIndices_floatzisegmap_tblock_sizze_44375", "orderByIndices_intzisegmap_tblock_sizze_44319", "orderByIndices_longzisegmap_tblock_sizze_44347", "orderByIndices_shortzisegmap_tblock_sizze_44291", "partitionFunczisegmap_tblock_sizze_43861", "sortColumn_doublezisegmap_num_tblocks_45923", "sortColumn_doublezisegmap_num_tblocks_46066", "sortColumn_doublezisegmap_num_tblocks_46115", "sortColumn_doublezisegmap_num_tblocks_46137", "sortColumn_doublezisegmap_num_tblocks_46403", "sortColumn_doublezisegmap_tblock_sizze_45921", "sortColumn_doublezisegmap_tblock_sizze_45929", "sortColumn_doublezisegmap_tblock_sizze_46064", "sortColumn_doublezisegmap_tblock_sizze_46091", "sortColumn_doublezisegmap_tblock_sizze_46113", "sortColumn_doublezisegmap_tblock_sizze_46135", "sortColumn_doublezisegmap_tblock_sizze_46157", "sortColumn_doublezisegmap_tblock_sizze_46379", "sortColumn_doublezisegmap_tblock_sizze_46401", "sortColumn_doublezisegmap_tblock_sizze_46409", "sortColumn_doublezisegscan_num_tblocks_45913", "sortColumn_doublezisegscan_num_tblocks_46179", "sortColumn_doublezisegscan_num_tblocks_46371", "sortColumn_doublezisegscan_tblock_sizze_45911", "sortColumn_doublezisegscan_tblock_sizze_46177", "sortColumn_doublezisegscan_tblock_sizze_46369", "sortColumn_doublezisuff_intra_par_0", "sortColumn_floatzisegmap_num_tblocks_45407", "sortColumn_floatzisegmap_num_tblocks_45547", "sortColumn_floatzisegmap_num_tblocks_45596", "sortColumn_floatzisegmap_num_tblocks_45618", "sortColumn_floatzisegmap_num_tblocks_45878", "sortColumn_floatzisegmap_tblock_sizze_45405", "sortColumn_floatzisegmap_tblock_sizze_45413", "sortColumn_floatzisegmap_tblock_sizze_45545", "sortColumn_floatzisegmap_tblock_sizze_45572", "sortColumn_floatzisegmap_tblock_sizze_45594", "sortColumn_floatzisegmap_tblock_sizze_45616", "sortColumn_floatzisegmap_tblock_sizze_45638", "sortColumn_floatzisegmap_tblock_sizze_45854", "sortColumn_floatzisegmap_tblock_sizze_45876", "sortColumn_floatzisegmap_tblock_sizze_45884", "sortColumn_floatzisegscan_num_tblocks_45397", "sortColumn_floatzisegscan_num_tblocks_45660", "sortColumn_floatzisegscan_num_tblocks_45846", "sortColumn_floatzisegscan_tblock_sizze_45395", "sortColumn_floatzisegscan_tblock_sizze_45658", "sortColumn_floatzisegscan_tblock_sizze_45844", "sortColumn_floatzisuff_intra_par_0", "sortColumn_intzisegmap_num_tblocks_46448", "sortColumn_intzisegmap_num_tblocks_46579", "sortColumn_intzisegmap_num_tblocks_46628", "sortColumn_intzisegmap_num_tblocks_46650", "sortColumn_intzisegmap_num_tblocks_46892", "sortColumn_intzisegmap_tblock_sizze_46446", "sortColumn_intzisegmap_tblock_sizze_46454", "sortColumn_intzisegmap_tblock_sizze_46577", "sortColumn_intzisegmap_tblock_sizze_46604", "sortColumn_intzisegmap_tblock_sizze_46626", "sortColumn_intzisegmap_tblock_sizze_46648", "sortColumn_intzisegmap_tblock_sizze_46670", "sortColumn_intzisegmap_tblock_sizze_46868", "sortColumn_intzisegmap_tblock_sizze_46890", "sortColumn_intzisegmap_tblock_sizze_46898", "sortColumn_intzisegscan_num_tblocks_46438", "sortColumn_intzisegscan_num_tblocks_46692", "sortColumn_intzisegscan_num_tblocks_46860", "sortColumn_intzisegscan_tblock_sizze_46436", "sortColumn_intzisegscan_tblock_sizze_46690", "sortColumn_intzisegscan_tblock_sizze_46858", "sortColumn_intzisuff_intra_par_0", "sortColumn_longzisegmap_num_tblocks_44924", "sortColumn_longzisegmap_num_tblocks_45053", "sortColumn_longzisegmap_num_tblocks_45102", "sortColumn_longzisegmap_num_tblocks_45124", "sortColumn_longzisegmap_num_tblocks_45362", "sortColumn_longzisegmap_tblock_sizze_44922", "sortColumn_longzisegmap_tblock_sizze_44930", "sortColumn_longzisegmap_tblock_sizze_45051", "sortColumn_longzisegmap_tblock_sizze_45078", "sortColumn_longzisegmap_tblock_sizze_45100", "sortColumn_longzisegmap_tblock_sizze_45122", "sortColumn_longzisegmap_tblock_sizze_45144", "sortColumn_longzisegmap_tblock_sizze_45338", "sortColumn_longzisegmap_tblock_sizze_45360", "sortColumn_longzisegmap_tblock_sizze_45368", "sortColumn_longzisegscan_num_tblocks_44914", "sortColumn_longzisegscan_num_tblocks_45166", "sortColumn_longzisegscan_num_tblocks_45330", "sortColumn_longzisegscan_tblock_sizze_44912", "sortColumn_longzisegscan_tblock_sizze_45164", "sortColumn_longzisegscan_tblock_sizze_45328", "sortColumn_longzisuff_intra_par_0", "sortColumn_shortzisegmap_num_tblocks_44441", "sortColumn_shortzisegmap_num_tblocks_44570", "sortColumn_shortzisegmap_num_tblocks_44619", "sortColumn_shortzisegmap_num_tblocks_44641", "sortColumn_shortzisegmap_num_tblocks_44879", "sortColumn_shortzisegmap_tblock_sizze_44439", "sortColumn_shortzisegmap_tblock_sizze_44447", "sortColumn_shortzisegmap_tblock_sizze_44568", "sortColumn_shortzisegmap_tblock_sizze_44595", "sortColumn_shortzisegmap_tblock_sizze_44617", "sortColumn_shortzisegmap_tblock_sizze_44639", "sortColumn_shortzisegmap_tblock_sizze_44661", "sortColumn_shortzisegmap_tblock_sizze_44855", "sortColumn_shortzisegmap_tblock_sizze_44877", "sortColumn_shortzisegmap_tblock_sizze_44885", "sortColumn_shortzisegscan_num_tblocks_44431", "sortColumn_shortzisegscan_num_tblocks_44683", "sortColumn_shortzisegscan_num_tblocks_44847", "sortColumn_shortzisegscan_tblock_sizze_44429", "sortColumn_shortzisegscan_tblock_sizze_44681", "sortColumn_shortzisegscan_tblock_sizze_44845", "sortColumn_shortzisuff_intra_par_0", NULL};
static const char *tuning_param_classes[] = {"grid_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(def, )", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, )", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, )", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, )", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, )", "grid_size", "grid_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "thread_block_size", "grid_size", "grid_size", "grid_size", "thread_block_size", "thread_block_size", "thread_block_size", "threshold(32, )", NULL};
static int64_t tuning_param_defaults[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0};
static const int max_failure_args = 2;
static const int f64_required = 1;
static const char *gpu_program[] = {"#define FUTHARK_CUDA\n// start of prelude.cu\n\n#define SCALAR_FUN_ATTR __device__ static inline\n#define FUTHARK_FUN_ATTR __device__ static\n#define FUTHARK_F64_ENABLED\n\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\n\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\n\nstatic inline __device__ int get_tblock_id(int d) {\n  switch (d) {\n  case 0: return blockIdx.x;\n  case 1: return blockIdx.y;\n  case 2: return blockIdx.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_num_tblocks(int d) {\n  switch(d) {\n  case 0: return gridDim.x;\n  case 1: return gridDim.y;\n  case 2: return gridDim.z;\n  default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x + blockIdx.x * blockDim.x;\n    case 1: return threadIdx.y + blockIdx.y * blockDim.y;\n    case 2: return threadIdx.z + blockIdx.z * blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_id(int d) {\n  switch (d) {\n    case 0: return threadIdx.x;\n    case 1: return threadIdx.y;\n    case 2: return threadIdx.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_local_size(int d) {\n  switch (d) {\n    case 0: return blockDim.x;\n    case 1: return blockDim.y;\n    case 2: return blockDim.z;\n    default: return 0;\n  }\n}\n\nstatic inline __device__ int get_global_size(int d) {\n  switch (d) {\n    case 0: return gridDim.x * blockDim.x;\n    case 1: return gridDim.y * blockDim.y;\n    case 2: return gridDim.z * blockDim.z;\n    default: return 0;\n  }\n}\n\n\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline __device__ void barrier(int x) {\n  __syncthreads();\n}\nstatic inline __device__ void mem_fence_local() {\n  __threadfence_block();\n}\nstatic inline __device__ void mem_fence_global", "() {\n  __threadfence();\n}\n\nstatic inline __device__ void barrier_local() {\n  __syncthreads();\n}\n\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ unsigned char shared_mem[];\n\n#define SHARED_MEM_PARAM\n#define FUTHARK_KERNEL extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define FUTHARK_KERNEL_SIZED(a,b,c) extern \"C\" __global__ __launch_bounds__(a*b*c)\n\n// End of prelude.cu\n// Start of half.h.\n\n// Conversion functions are from http://half.sourceforge.net/, but\n// translated to C.\n//\n// Copyright (c) 2012-2021 Christian Rau\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n#ifndef __OPENCL_VERSION__\n#define __constant\n#endif\n\n__constant static const uint16_t base_table[512] = {\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0", "000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,\n  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,\n  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,\n  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8",
                                    "000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,\n  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,\n  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,\n  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,\n  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };\n\n__constant static const unsigned char shift_table[512] = {\n  24, 24, 24, 24, 24, 24,", " 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,\n  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 2", "4, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };\n\n__constant static const uint32_t mantissa_table[2048] = {\n  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,\n  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,\n  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,\n  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,\n  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,\n  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,\n  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,\n  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,\n  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,\n  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x37",
                                    "1B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,\n  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,\n  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,\n  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,\n  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,\n  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,\n  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,\n  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,\n  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,\n  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,\n  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,\n  0x", "37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,\n  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,\n  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,\n  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,\n  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,\n  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,\n  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,\n  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,\n  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,\n  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,\n  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x", "37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,\n  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,\n  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,\n  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,\n  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,\n  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,\n  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,\n  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,\n  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,\n  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,\n  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x",
                                    "38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,\n  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,\n  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,\n  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,\n  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,\n  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,\n  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,\n  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,\n  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,\n  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,\n  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x", "384BC000,\n  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,\n  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,\n  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,\n  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,\n  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,\n  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,\n  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,\n  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,\n  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,\n  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,\n  0x38740000, 0x38744000, 0x38748000, 0x3874C000, ", "0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,\n  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,\n  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,\n  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,\n  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,\n  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,\n  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,\n  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,\n  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,\n  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,\n  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, ",
                                    "0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,\n  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,\n  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,\n  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,\n  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,\n  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,\n  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,\n  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,\n  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,\n  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,\n  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, ", "0x3823C000, 0x3823E000,\n  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,\n  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,\n  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,\n  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,\n  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,\n  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,\n  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,\n  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,\n  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,\n  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,\n  0x38380000, 0x38382000, 0x38384000", ", 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,\n  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,\n  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,\n  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,\n  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,\n  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,\n  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,\n  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,\n  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,\n  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,\n  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000",
                                    ", 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,\n  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,\n  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,\n  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,\n  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,\n  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,\n  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,\n  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,\n  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,\n  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,\n  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000", ", 0x3861A000, 0x3861C000, 0x3861E000,\n  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,\n  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,\n  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,\n  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,\n  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,\n  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,\n  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,\n  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,\n  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,\n  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,\n  0x38760000, 0x387620", "00, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,\n  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,\n  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,\n  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,\n  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };\n__constant static const uint32_t exponent_table[64] = {\n  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,\n  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,\n  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,\n  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };\n__constant static const unsigned short offset_table[64] = {\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1",
                                    "024, 1024, 1024, 1024, 1024, 1024,\n  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };\n\nSCALAR_FUN_ATTR uint16_t float2halfbits(float value) {\n  union { float x; uint32_t y; } u;\n  u.x = value;\n  uint32_t bits = u.y;\n\n  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;\n\n  return hbits;\n}\n\nSCALAR_FUN_ATTR float halfbits2float(uint16_t value) {\n  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];\n\n  union { uint32_t x; float y; } u;\n  u.x = bits;\n  return u.y;\n}\n\nSCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {\n  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;\n  if(fabs > 0x7C00 || tabs > 0x7C00) {\n    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);\n  }\n  if(from == to || !(fabs|tabs)) {\n    return to;\n  }\n  if(!fabs) {\n    return (to&0x8000)+1;\n  }\n  unsigned int out =\n    from +\n    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)\n    - 1;\n  return out;\n}\n\n// End of half.h.\n// Start of scalar.h.\n\n// Implementation of the primitive scalar operations.  Very\n// repetitive.  This code is inserted directly into both CUDA and\n// OpenCL programs, as well as the CPU code, so it has some #ifdefs to\n// work everywhere.  Some operations are defined as macros because\n// this allows us to use them as constant expressions in things like\n// array sizes and static initialisers.\n\n// Some of the #ifdefs are because OpenCL uses type-generic functions\n// for some operations (e.g. sqrt), while C and CUDA sensibly use\n// distinct functions for different precisions (e.g. sqrtf() and\n// sqrt()).  This is quite annoying.  Due to C's unfortunate casting\n// rules, it is also really easy to accidentally implement\n// floating-point functions in the wrong precision, so be careful.\n\n/", "/ Double-precision definitions are only included if the preprocessor\n// macro FUTHARK_F64_ENABLED is set.\n\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);\n\nSCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {\n  return x * y;\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  // This strange pattern is used to prevent the ISPC compiler from\n  // causing SIGFPEs and bogus results on divisions where inactive lanes\n  // have 0-valued divisors. It ensures that any inactive lane instead\n  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  uint", "8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALA",
                                    "R_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : (x + y - 1) / ys;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  uint8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  uint16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  uint32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  uint64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t q = x / ys;\n  int8_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t q = x / ys;\n  int16_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n  int32_t q = x / ys;\n  int32_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t q = x / ys;\n  int64_t r = x % ys;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y)", " {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int8_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int16_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int32_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  int64_t r = x % ys;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) ", "{\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return x % ys;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x / ys;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  int8_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  int16_t ys = 1;\n  ",
                                    "foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  int32_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  int64_t ys = 1;\n  foreach_active(i){\n    ys = y;\n  }\n\n  return y == 0 ? 0 : x % ys;\n}\n\n#else\n\nSCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {\n  return (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {\n  return", " y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : (x + y - 1) / y;\n}\n\nSCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {\n  int8_t q = x / y;\n  int8_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {\n  int16_t q = x / y;\n  int16_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {\n  int32_t q = x / y;\n  int32_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {\n  int64_t q = x / y;\n  int64_t r = x % y;\n\n  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {\n  return sdiv8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {\n  return sdiv16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {\n  return sdiv32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {\n  return sdiv64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {\n  int8_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {\n  int16_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {\n  int32_t r = x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {\n  int64_t r = ", "x % y;\n\n  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : sdiv8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : sdiv16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : sdiv32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : sdiv64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {\n  return sdiv_safe8(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {\n  return sdiv_safe16(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {\n  return sdiv_safe32(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {\n  return sdiv_safe64(x + y - 1, y);\n}\n\nSCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : smod8(x, y);\n}\n\nSCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : smod16(x, y);\n}\n\nSCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : smod32(x, y);\n}\n\nSCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : smod64(x, y);\n}\n\nSCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {\n  return x % y;\n}\n\nSCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t ",
                                    "y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x / y;\n}\n\nSCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\nSCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {\n  return y == 0 ? 0 : x % y;\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {\n  return x < y ? x : y;\n}\n\nSCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {\n  return x < y ? y : x;\n}\n\nSCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {\n  return (uint8_t)(x << y);\n}\n\nS", "CALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {\n  return (uint16_t)(x << y);\n}\n\nSCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {\n  return x << y;\n}\n\nSCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {\n  return x >> y;\n}\n\nSCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {\n  return x & y;\n}\n\nSCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {\n  return x | y;\n}\n\nSCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {\n  return x ^ y;\n}\n\nSCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ult64(uint64_t x, uint64", "_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {\n  uint8_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {\n  uint16_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {\n  uint32_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {\n  uint64_t res = 1, rem = y;\n\n  while (rem != 0) {\n    if (rem & 1)\n      res *= x;\n    rem >>= 1;\n    x *= x;\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x",
                                    ") {\n  return x;\n}\n\nSCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {\n  return x;\n}\n\n#define sext_i8_i8(x) ((int8_t) (int8_t) (x))\n#define sext_i8_i16(x) ((int16_t) (int8_t) (x))\n#define sext_i8_i32(x) ((int32_t) (int8_t) (x))\n#define sext_i8_i64(x) ((int64_t) (int8_t) (x))\n#define sext_i16_i8(x) ((int8_t) (int16_t) (x))\n#define sext_i16_i16(x) ((int16_t) (int16_t) (x))\n#define sext_i16_i32(x) ((int32_t) (int16_t) (x))\n#define sext_i16_i64(x) ((int64_t) (int16_t) (x))\n#define sext_i32_i8(x) ((int8_t) (int32_t) (x))\n#define sext_i32_i16(x) ((int16_t) (int32_t) (x))\n#define sext_i32_i32(x) ((int32_t) (int32_t) (x))\n#define sext_i32_i64(x) ((int64_t) (int32_t) (x))\n#define sext_i64_i8(x) ((int8_t) (int64_t) (x))\n#define sext_i64_i16(x) ((int16_t) (int64_t) (x))\n#define sext_i64_i32(x) ((int32_t) (int64_t) (x))\n#define sext_i64_i64(x) ((int64_t) (int64_t) (x))\n#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))\n#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))\n#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))\n#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))\n#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))\n#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))\n#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))\n#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))\n#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))\n#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))\n#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))\n#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))\n#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))\n#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))\n#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))\n#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))\n\nSCALAR_FUN_ATTR int8_t abs8(int8_t x) {\n  return (int8_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int16_t abs16(int16_t x) {\n  return (int16_t)abs(x);\n}\n\nSCALAR_FUN_ATTR int32_t abs32(int32_t x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR int64_t abs64(int64_t x) {\n#if defined(__OPENCL_VER", "SION__) || defined(ISPC)\n  return abs(x);\n#else\n  return llabs(x);\n#endif\n}\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return popcount(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {\n  return __popc(zext_i8_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {\n  return __popc(zext_i16_i32(x));\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {\n  return __popc(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {\n  return __popcll(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {\n  int c = 0;\n  for (; x; ++c) { x &= x - 1; }\n  return c;\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return m", "ul_hi(a, b); }\n#elif defined(__CUDA_ARCH__)\nSCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }\nSCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }\nSCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }\n#elif ISPC\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 = al * bl;\n  uint64_t p2 = al * bh;\n  uint64_t p3 = ah * bl;\n  uint64_t p4 = ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\nSCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR int",
                                    "32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {\n  uint64_t ah = a >> 32;\n  uint64_t al = a & 0xffffffff;\n  uint64_t bh = b >> 32;\n  uint64_t bl = b & 0xffffffff;\n\n  uint64_t p1 =  al * bl;\n  int64_t  p2 = al * bh;\n  int64_t  p3 = ah * bl;\n  uint64_t p4 =  ah * bh;\n\n  uint64_t p1h = p1 >> 32;\n  uint64_t p2h = p2 >> 32;\n  uint64_t p3h = p3 >> 32;\n  uint64_t p2l = p2 & 0xffffffff;\n  uint64_t p3l = p3 & 0xffffffff;\n\n  uint64_t l = p1h + p2l + p3l;\n  uint64_t m = (p2 >> 32) + (p3 >> 32);\n  uint64_t h = (l >> 32) + m + p4;\n\n  return h;\n}\n\n#else // Not OpenCL, ISPC, or CUDA, but plain C.\nSCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }\nSCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }\nSCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }\nSCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }\nSCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }\nSCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }\nSCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }\nSCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t ", "a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }\n#else // Not OpenCL\n\nSCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }\nSCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }\nSCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }\nSCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }\nSCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return clz(x);\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return __clz(zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return __clz(zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  retur", "n __clz(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return __clzll(x);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return count_leading_zeros((int32_t)(uint8_t)x)-24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return count_leading_zeros((int32_t)(uint16_t)x)-16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return count_leading_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return count_leading_zeros(x);\n}\n\n#else // Not OpenCL, ISPC or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_clz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);\n}\n#endif\n\n#if defined(__OPENCL_VERSION__)\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int i = 0;\n  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int i = 0;\n  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int i = 0;\n  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int i = 0;\n  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n    ;\n  return i;\n}\n\n#elif defined(__CUDA_ARCH__)\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 8 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 16 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  int y = __ffs(x);\n  return y == 0 ? 32 : y - 1;\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  int y = __ffsll(x);\n  return y == 0 ? 64 : y - 1",
                                    ";\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return count_trailing_zeros(x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return count_trailing_zeros(x);\n}\n\n#else // Not OpenCL or CUDA, but plain C.\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {\n  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {\n  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {\n  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);\n}\n\nSCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {\n  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);\n}\n#endif\n\nSCALAR_FUN_ATTR float fdiv32(float x, float y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR float fadd32(float x, float y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR float fsub32(float x, float y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR float fmul32(float x, float y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt32(float x, float y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple32(float x, float y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {\n  return (float) x;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, f", "loat y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return pow(x, y);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float a, float b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\n#else // Not OpenCL, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float fabs32(float x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR float fmax32(float x, float y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR float fmin32(float x, float y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR float fpow32(float x, float y) {\n  return powf(x, y);\n}\n#endif\n\nSCALAR_FUN_ATTR bool futrts_isnan32(float x) {\n  return isnan(x);\n}\n\n#if ISPC\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite32(float x) {\n  return !isnan(x) && !futrts_isinf32(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf32(float x) {\n  return isinf(x);\n}\n\n#endif\n\nSCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  };\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {", "\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {\n  if (futrts_isnan32(x) || futrts_isinf32(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f32_bool(float x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR float btof_bool_f32(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinh(x);\n}\n\nSC",
                                    "ALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fma(a, b, c);\n}\n\n#elif ISPC\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return futrts_log32(x) / log(2.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return futrts_log32(x) / log(10.0f);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;\n  float y = 1.0f + x;\n  float z = y - 1.0f;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform float cbrtf(uniform float);\nSCALAR_FUN_ATTR float futrts_cbrt32(float", " x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return (exp(x)+exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return (exp(x)-exp(-x)) / 2.0f;\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return futrts_sinh32(x)/futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  float f = x+sqrt(x*x-1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  float f = x+sqrt(x*x+1);\n  if(futrts_isfinite32(f)) return log(f);\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  float f = (1+x)/(1-x);\n  if(futrts_isfinite32(f)) return log(f)/2.0f;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {\n    x = abs(x);\n    y = abs(y);\n    float a;\n    float b;\n    if (x >= y){\n        a = x;\n        b = y;\n    } else {\n        a = y;\n        b = x;\n    }\n    if(b == 0){\n      return a;\n    }\n\n    int e;\n    float an;\n    float bn;\n    an = frexp (a, &e);\n    bn = ldexp (b, - e);\n    float cn;\n    cn = sqrt (an * an + bn * bn);\n    return ldexp (cn, e);\n  } else {\n    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;\n    else return x + y;\n  }\n\n}\n\nextern \"C\" unmasked uniform float tgammaf(", "uniform float x);\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = tgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = lgammaf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erff(uniform float x);\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erff(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float erfcf(uniform float x);\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  float res;\n  foreach_active (i) {\n    uniform float r = erfcf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform float nextafterf(uniform float x, uniform float y);\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  float res;\n  foreach_active (i) {\n    uniform float r = nextafterf(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  int32_t xb = futrts_to_bits32(x);\n  int32_t yb = futrts_to_bits32(y);\n  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futr",
                                    "ts_fma32(float a, float b, float c) {\n  return a * b + c;\n}\n\n#else // Not OpenCL or ISPC, but CUDA or plain C.\n\nSCALAR_FUN_ATTR float futrts_log32(float x) {\n  return logf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log2_32(float x) {\n  return log2f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log10_32(float x) {\n  return log10f(x);\n}\n\nSCALAR_FUN_ATTR float futrts_log1p_32(float x) {\n  return log1pf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sqrt32(float x) {\n  return sqrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cbrt32(float x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_exp32(float x) {\n  return expf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cos32(float x) {\n  return cosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sin32(float x) {\n  return sinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tan32(float x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acos32(float x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asin32(float x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan32(float x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_cosh32(float x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_sinh32(float x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_tanh32(float x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_acosh32(float x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_asinh32(float x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atanh32(float x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_gamma32(float x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_lgamma32(float x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erf32(float x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR float futrts_erfc32(float x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR float fmod32(float x, float y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_round32(float x) {\n  re", "turn rintf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_floor32(float x) {\n  return floorf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_ceil32(float x) {\n  return ceilf(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {\n  return nextafterf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {\n  return ldexpf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {\n  return copysignf(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {\n  return fmaf(a, b, c);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  return intbits(x);\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  return floatbits(x);\n}\n#else\nSCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {\n  union {\n    float f;\n    int32_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {\n  union {\n    int32_t f;\n    float t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\nSCALAR_FUN_ATTR float fsignum32(float x) {\n  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf64(float x) {\n  return !isnan(x) && isnan(x - x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isfinite64(float x) {\n  return !isnan(x) && !futrts_isinf64(x);\n}\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}", "\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return isnan(x) ? y : isnan(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double a, double b) {\n  float ret;\n  foreach_active (i) {\n      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));\n      ret = insert(ret, i, r);\n  }\n  return ret;\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return futrts_log64(x)/log(2.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return futrts_log64(x)/log(10.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;\n  double y = 1.0d + x;\n  double z = y - 1.0d;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nextern \"C\" unmasked uniform double cbrt(uniform double);\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = cbrtf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(dou",
                                    "ble x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return (exp(x)+exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return (exp(x)-exp(-x)) / 2.0d;\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return futrts_sinh64(x)/futrts_cosh64(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  double f = x+sqrt(x*x-1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  double f = x+sqrt(x*x+1.0d);\n  if(futrts_isfinite64(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  double f = (1.0d+x)/(1.0d-x);\n  if(futrts_isfinite64(f)) return log(f)/2.0d;\n  return f;\n\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nextern \"C\" unmasked uniform double hypot(uniform double x, uniform double y);\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = hypot(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double tgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = tgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double lgamma(uniform double x);\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = lgamma(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erf(uniform double x);\nSCALAR_FUN_ATTR do", "uble futrts_erf64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erf(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform double erfc(uniform double x);\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  double res;\n  foreach_active (i) {\n    uniform double r = erfc(extract(x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return round(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nextern \"C\" unmasked uniform double nextafter(uniform float x, uniform double y);\nSCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {\n  double res;\n  foreach_active (i) {\n    uniform double r = nextafter(extract(x, i), extract(y, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int", "16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0.0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1.0 : 0.0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  int64_t res;\n  foreach_active (i) {\n    uniform double tmp = extract(x, i);\n    uniform int64_t r = *((uniform int64_t* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  double res;\n  foreach_active (i) {\n    uniform int64_t tmp = extract(x, i);\n    uniform double r = *((uniform double* uniform)&tmp);\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return x - y * trunc(x/y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return x * pow((double)2.0, (double)y);\n}\n\nSCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {\n  int64_t xb = futrts_to_bits64(x);\n  int64_t yb = futrts_to_bits64(y);\n  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#e",
                                    "lse\n\nSCALAR_FUN_ATTR double fdiv64(double x, double y) {\n  return x / y;\n}\n\nSCALAR_FUN_ATTR double fadd64(double x, double y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR double fsub64(double x, double y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR double fmul64(double x, double y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt64(double x, double y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple64(double x, double y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR double fabs64(double x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR double fmax64(double x, double y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR double fmin64(double x, double y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR double fpow64(double x, double y) {\n  return pow(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_log64(double x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log2_64(double x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log10_64(double x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR double futrts_log1p_64(double x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sqrt64(double x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cbrt64(double x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR double futrts_exp64(double x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cos64(double x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sin64(double x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tan64(double x) {\n  r", "eturn tan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acos64(double x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asin64(double x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan64(double x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR double futrts_cosh64(double x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_sinh64(double x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_tanh64(double x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_acosh64(double x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_asinh64(double x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atanh64(double x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_gamma64(double x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_lgamma64(double x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erf64(double x) {\n  return erf(x);\n}\n\nSCALAR_FUN_ATTR double futrts_erfc64(double x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {\n  return fma(a, b, c);\n}\n\nSCALAR_FUN_ATTR double futrts_round64(double x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR double futrts_ceil64(double x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_floor64(double x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan64(double x) {\n  return isnan(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf64(double x) {\n  return isinf(x);\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x", ") {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint8_t) (int8_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint16_t) (int16_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint32_t) (int32_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {\n  if (futrts_isnan64(x) || futrts_isinf64(x)) {\n    return 0;\n  } else {\n    return (uint64_t) (int64_t) x;\n  }\n}\n\nSCALAR_FUN_ATTR bool ftob_f64_bool(double x) {\n  return x != 0;\n}\n\nSCALAR_FUN_ATTR double btof_bool_f64(bool x) {\n  return x ? 1 : 0;\n}\n\nSCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {\n  union {\n    double f;\n    int64_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {\n  union {\n    int64_t f;\n    double t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR double fmod64(double x, double y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR double fsignum64(double x) {\n  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);\n}\n\nSCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {\n#ifdef __OPENCL_VERSION__\n  return mix(v0, v1, t);\n#else\n  return v0 + (v1 - v0) * t;\n#endif\n}\n\nSCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {\n#ifdef __OPENCL_VERSION__\n  return mad(a, b, c);\n#else\n  return a * b + c;\n#endif\n}\n\nSCALAR",
                                    "_FUN_ATTR float fpconv_f32_f32(float x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f32_f64(float x) {\n  return (double) x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f64_f32(double x) {\n  return (float) x;\n}\n\nSCALAR_FUN_ATTR double fpconv_f64_f64(double x) {\n  return (double) x;\n}\n\n#endif\n\n#endif\n\n// End of scalar.h.\n// Start of scalar_f16.h.\n\n// Half-precision is emulated if needed (e.g. in straight C) with the\n// native type used if possible.  The emulation works by typedef'ing\n// 'float' to 'f16', and then implementing all operations on single\n// precision.  To cut down on duplication, we use the same code for\n// those Futhark functions that require just operators or casts.  The\n// in-memory representation for arrays will still be 16 bits even\n// under emulation, so the compiler will have to be careful when\n// generating reads or writes.\n\n#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))\n#define EMULATE_F16\n#endif\n\n#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)\n#pragma OPENCL EXTENSION cl_khr_fp16 : enable\n#endif\n\n#ifdef EMULATE_F16\n\n// Note that the half-precision storage format is still 16 bits - the\n// compiler will have to be real careful!\ntypedef float f16;\n\n#elif ISPC\ntypedef float16 f16;\n\n#else\n\n#ifdef __CUDA_ARCH__\n#include <cuda_fp16.h>\n#endif\n\ntypedef half f16;\n\n#endif\n\n// Some of these functions convert to single precision because half\n// precision versions are not available.\n\nSCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {\n  return x + y;\n}\n\nSCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {\n  return x - y;\n}\n\nSCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {\n  return x * y;\n}\n\nSCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {\n  return x < y;\n}\n\nSCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {\n  return x <= y;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {\n  return (f16) x;\n}\n\nSCALAR", "_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {\n  return (f16) x;\n}\n\nSCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {\n  return (int8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {\n  return (int16_t) x;\n}\n\nSCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {\n  return (int32_t) x;\n}\n\nSCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {\n  return (int64_t) x;\n}\n\nSCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {\n  return (uint8_t) (float) x;\n}\n\nSCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {\n  return (uint16_t) x;\n}\n\nSCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {\n  return (uint32_t) x;\n}\n\nSCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {\n  return (uint64_t) x;\n}\n\nSCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {\n  return x != (f16)0;\n}\n\nSCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {\n  return x ? 1 : 0;\n}\n\n#ifndef EMULATE_F16\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return isnan((float)x);\n}\n\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#elif ISPC\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return abs(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return pow(x, y);\n}\n\n#else // Assuming CUDA.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabsf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmaxf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 ", "x, f16 y) {\n  return fminf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return powf(x, y);\n}\n#endif\n\n#if ISPC\nSCALAR_FUN_ATTR bool futrts_isinf16(float x) {\n  return !futrts_isnan16(x) && futrts_isnan16(x - x);\n}\nSCALAR_FUN_ATTR bool futrts_isfinite16(float x) {\n  return !futrts_isnan16(x) && !futrts_isinf16(x);\n}\n\n#else\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return isinf((float)x);\n}\n#endif\n\n#ifdef __OPENCL_VERSION__\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return log(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return log2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return log10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return log1p(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return sqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return cos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return sin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atan(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return cosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acosh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanh(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypot(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return tgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgamma(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return e",
                                    "rf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfc(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rint(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return floor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return ceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return nextafter(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return mix(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return ldexp(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return copysign(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return mad(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fma(a, b, c);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log16(x) / log(2.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log16(x) / log(10.0f16);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;\n  f16 y = 1.0f16 + x;\n  f16 z = y - 1.0f16;\n  return log(y) - (z-x)/y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return (float16)sqrt((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return exp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return (float16)cos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return (float16)sin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return (float16)tan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return (float16)acos((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return (float16)asin((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return (float16)atan((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  retu", "rn (exp(x)+exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return (exp(x)-exp(-x)) / 2.0f16;\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_sinh16(x)/futrts_cosh16(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x-1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  float16 f = x+(float16)sqrt((float)(x*x+1));\n  if(futrts_isfinite16(f)) return log(f);\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  float16 f = (1+x)/(1-x);\n  if(futrts_isfinite16(f)) return log(f)/2.0f16;\n  return f;\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return (float16)atan2((float)x, (float)y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return (float16)futrts_hypot32((float)x, (float)y);\n}\n\nextern \"C\" unmasked uniform float tgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)tgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nextern \"C\" unmasked uniform float lgammaf(uniform float x);\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  f16 res;\n  foreach_active (i) {\n    uniform f16 r = (f16)lgammaf(extract((float)x, i));\n    res = insert(res, i, r);\n  }\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  f16 res = (f16)futrts_cbrt32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  f16 res = (f16)futrts_erf32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  f16 res = (f16)futrts_erfc32((float)x);\n  return res;\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return x - y * (float16)trunc((float) (x/y));\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return (float16)round((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return (float16)floor((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return (float16)ceil((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrt", "s_nextafter16(f16 x, f16 y) {\n  return (float16)futrts_nextafter32((float)x, (float) y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\n#else // Assume CUDA.\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return hlog(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return hlog2(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return hlog10(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return (f16)log1pf((float)x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return hsqrt(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return cbrtf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return hexp(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return hcos(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return hsin(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return tanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return acosf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return asinf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return atanf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return coshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return sinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return tanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return acoshf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return asinhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return atanhf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return atan2f(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return hypotf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f1",
                                    "6 x) {\n  return tgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return lgammaf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return erff(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return erfcf(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmodf(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return rintf(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return hfloor(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return hceil(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return v0 + (v1 - v0) * t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return a * b + c;\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return fmaf(a, b, c);\n}\n\n#endif\n\n// The CUDA __half type cannot be put in unions for some reason, so we\n// use bespoke conversion functions instead.\n#ifdef __CUDA_ARCH__\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return __half_as_ushort(x);\n}\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return __ushort_as_half(x);\n}\n#elif ISPC\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  varying int16_t y = *((varying int16_t * uniform)&x);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  varying f16 y = *((varying f16 * uniform)&x);\n  return y;\n}\n#else\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  union {\n    f16 f;\n    int16_t t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  union {\n    int16_t f;\n    f16 t;\n  } p;\n\n  p.f = x;\n  return p.t;\n}\n#endif\n\n#else // No native f16 - emulate.\n\nSCALAR_FUN_ATTR f16 fabs16(f16 x) {\n  return fabs32(x);\n}\n\nSC", "ALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {\n  return fmax32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {\n  return fmin32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {\n  return fpow32(x, y);\n}\n\nSCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {\n  return futrts_isnan32(x);\n}\n\nSCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {\n  return futrts_isinf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log16(f16 x) {\n  return futrts_log32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {\n  return futrts_log2_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {\n  return futrts_log10_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {\n  return futrts_log1p_32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {\n  return futrts_sqrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {\n  return futrts_cbrt32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {\n  return futrts_exp32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {\n  return futrts_cos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {\n  return futrts_sin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {\n  return futrts_tan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {\n  return futrts_acos32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {\n  return futrts_asin32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {\n  return futrts_atan32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {\n  return futrts_cosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {\n  return futrts_sinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {\n  return futrts_tanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {\n  return futrts_acosh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {\n  return futrts_asinh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {\n  return futrts_atanh32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {\n  return futrts_atan2_32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {\n  return futrts_hypot32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {\n  return futrts_gamma32(x);\n}\n\nSCA", "LAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {\n  return futrts_lgamma32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {\n  return futrts_erf32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {\n  return futrts_erfc32(x);\n}\n\nSCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {\n  return fmod32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_round16(f16 x) {\n  return futrts_round32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {\n  return futrts_floor32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {\n  return futrts_ceil32(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {\n  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));\n}\n\nSCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {\n  return futrts_lerp32(v0, v1, t);\n}\n\nSCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {\n  return futrts_ldexp32(x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {\n  return futrts_copysign32((float)x, y);\n}\n\nSCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {\n  return futrts_mad32(a, b, c);\n}\n\nSCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {\n  return futrts_fma32(a, b, c);\n}\n\n// Even when we are using an OpenCL that does not support cl_khr_fp16,\n// it must still support vload_half for actually creating a\n// half-precision number, which can then be efficiently converted to a\n// float.  Similarly for vstore_half.\n#ifdef __OPENCL_VERSION__\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  int16_t y;\n  // Violating strict aliasing here.\n  vstore_half((float)x, 0, (half*)&y);\n  return y;\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return (f16)vload_half(0, (half*)&x);\n}\n\n#else\n\nSCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {\n  return (int16_t)float2halfbits(x);\n}\n\nSCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {\n  return halfbits2float((uint16_t)x);\n}\n\nSCALAR_FUN_ATTR f16 fsignum16(f16 x) {\n  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);\n}\n\n#endif\n\n#endif\n\nSCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {\n  retu",
                                    "rn x;\n}\n\nSCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {\n  return x;\n}\n\nSCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {\n  return (f16) x;\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {\n  return (double) x;\n}\n\n#if ISPC\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) ((float)x);\n}\n#else\nSCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {\n  return (f16) x;\n}\n#endif\n#endif\n\n\n// End of scalar_f16.h.\n// Start of atomics.h\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x);\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x);\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32", "_t *p, uint32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x);\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x);\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xchg_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                                         int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_cmpxchg_i32_shared(volatile __local int32_t *p,\n                                                        int32_t cmp, int32_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_add_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((int32_t*)p, x);\n#el", "se\n  return atomic_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  float ret;\n  asm volatile(\"atom.global.add.f32 %0,[%1],%2;\":\"=f\"(ret):\"l\"(p),\"f\"(x):\"memory\");\n  return ret;\n#elif defined(__opencl_c_ext_fp32_global_atomic_add)\n  // use hardware-supported atomic addition on some Intel GPUs\n  return atomic_fetch_add_explicit((volatile __global atomic_float*)p,\n                                   x,\n                                   memory_order_relaxed);\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f32)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f32(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  float old = x;\n  float ret;\n  while ((old=atomic_xchg(p, ret=atomic_xchg(p, 0.0f)+old))!=0.0f);\n  return ret;\n#endif\n}\n\nSCALAR_FUN_ATTR float atomic_fadd_f32_shared(volatile __local float *p, float x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i32_shared((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smax_i32_shared(volatile",
                                    " __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_smin_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umax_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint32_t atomic_umin_i32_shared(volatile __local uint32_t *p, uint32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_and_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_global(volatile __global int32_t *p, ", "int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_or_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int32_t atomic_xor_i32_shared(volatile __local int32_t *p, int32_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\n// Start of 64 bit atomics\n\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR uint", "64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(volatile __global int64_t *p, int64_t x);\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x);\n\n#ifdef FUTHARK_F64_ENABLED\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x);\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x);\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xchg_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicExch((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_global(volatile __global int64_t *p,\n                                                         int64_t cmp, int64_t val) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_cmpxchg_i64_shared(volatile __local int64_t *p,\n                                                        int64_t cmp, int64_t val) {\n#if defined(F",
                                    "UTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicCAS((uint64_t*)p, cmp, val);\n#else\n  return atom_cmpxchg(p, cmp, val);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_add_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAdd((uint64_t*)p, x);\n#else\n  return atom_add(p, x);\n#endif\n}\n\n#ifdef FUTHARK_F64_ENABLED\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_global(volatile __global double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n  // On OpenCL, use technique from\n  // https://pipinspace.github.io/blog/atomic-float-addition-in-opencl.html\n#elif defined(cl_nv_pragma_unroll)\n  // use hardware-supported atomic addition on Nvidia GPUs with inline\n  // PTX assembly\n  double ret;\n  asm volatile(\"atom.global.add.f64 %0,[%1],%2;\":\"=d\"(ret):\"l\"(p),\"d\"(x):\"memory\");\n  return ret;\n#elif __has_builtin(__builtin_amdgcn_global_atomic_fadd_f64)\n  // use hardware-supported atomic addition on some AMD GPUs\n  return __builtin_amdgcn_global_atomic_fadd_f64(p, x);\n#else\n  // fallback emulation:\n  // https://forums.developer.nvidia.com/t/atomicadd-float-float-atomicmul-float-float/14639/5\n  union {int64_t i; double f;} old;\n  union {int64_t i; double f;} ret;\n  old.f = x;\n  while (1) {\n    ret.i = atom_xchg((volatile __global int64_t*)p, (int64_t)0);\n    ret.f += old.f;\n    old.i = atom_xchg((volatile __global int64_t*)p, ret.i);\n    if (old.i == 0) {\n      break;\n    }\n  }\n  return ret.f;\n#endif\n}\n\nSCALAR_FUN_ATTR double atomic_fadd_f64_shared(volatile __local double *p, double x) {\n#if defined(FUTHARK_CUDA) && __CUDA_ARCH__ >= 600 || defined(FUTHARK_HIP)\n  return atomicAdd((double*)p, x);\n#else\n  union { int64_t i; double f; } old;\n  u", "nion { int64_t i; double f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\n#endif\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smax_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMax((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smax64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do {\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_global((volatile __global int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_smin_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA)\n  return atomicMin((int64_t*)p, x);\n#elif defined(FUTHARK_HIP)\n  // Currentely missing in HIP; probably a temporary oversight.\n  int64_t old = *p, assumed;\n  do ", "{\n    assumed = old;\n    old = smin64(old, x);\n    old = atomic_cmpxchg_i64_shared((volatile __local int64_t*)p, assumed, old);\n  } while (assumed != old);\n  return old;\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umax_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMax((uint64_t*)p, x);\n#else\n  return atom_max(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_global(volatile __global uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR uint64_t atomic_umin_i64_shared(volatile __local uint64_t *p, uint64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicMin((uint64_t*)p, x);\n#else\n  return atom_min(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_and_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicAnd((uint64_t*)p, x);\n#else\n  return atom_and(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_global(volatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_or_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicOr((uint64_t*)p, x);\n#else\n  return atom_or(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_global(v",
                                    "olatile __global int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\nSCALAR_FUN_ATTR int64_t atomic_xor_i64_shared(volatile __local int64_t *p, int64_t x) {\n#if defined(FUTHARK_CUDA) || defined(FUTHARK_HIP)\n  return atomicXor((uint64_t*)p, x);\n#else\n  return atom_xor(p, x);\n#endif\n}\n\n#endif // defined(FUTHARK_CUDA) || defined(FUTHARK_HIP) || defined(cl_khr_int64_base_atomics) && defined(cl_khr_int64_extended_atomics)\n\n// End of atomics.h\n// Start of transpose.cl\n\n#define GEN_TRANSPOSE_KERNELS(NAME, ELEM_TYPE)                          \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_PER_THREAD, 1)\\\nvoid map_transpose_##NAME(SHARED_MEM_PARAM                              \\\n                          __global ELEM_TYPE *dst_mem,                  \\\n                          int64_t dst_offset,                           \\\n                          __global ELEM_TYPE *src_mem,                  \\\n                          int64_t src_offset,                           \\\n                          int32_t num_arrays,                           \\\n                          int32_t x_elems,                              \\\n                          int32_t y_elems,                              \\\n                          int32_t mulx,                                 \\\n                          int32_t muly,                                 \\\n                          int32_t repeat_1,                             \\\n                          int32_t repeat_2) {                           \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_g", "lobal_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = global_id_0;                                    \\\n      int32_t y_index = tblock_id_1 * TR_TILE_DIM + get_local_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int32_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int32_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_in", "dex + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_height(SHARED_MEM_PARAM                 \\\n                                                __global ELEM_TYPE *dst_mem, \\\n                                                int64_t dst_offset,     \\\n                                                __global ELEM_TYPE *src_mem, \\\n                                                int64_t src_offset,     \\\n                                                int32_t num_arrays,     \\\n                                                int32_t x_elems,        \\\n                                                int32_t y_elems,        \\\n                                                int32_t mulx,           \\\n                                                int32_t muly,           \\\n                                                int32_t repeat_1,       \\\n ",
                                    "                                               int32_t repeat_2) {     \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index =                                                 \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n        get_local_id(0) +                                               \\\n        get_local_id(1)%mulx * TR_BLOCK_DIM;                            \\\n      int32_t y_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(1)/mulx; \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM + get_local_id(0)/mulx;      \\\n      y_index =                                                         \\\n        tblock_id_0 * TR_BLOCK_DIM * mulx +                             \\\n", "        get_local_id(1) +                                               \\\n        (get_local_id(0)%mulx) * TR_BLOCK_DIM;                          \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n      if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM, TR_BLOCK_DIM, 1)                     \\\nvoid map_transpose_##NAME##_low_width(SHARED_MEM_PARAM                  \\\n                                      __global ELEM_TYPE *dst_mem,      \\\n                                      int64_t dst_offset,               \\\n                                      __global ELEM_TYPE *src_mem,      \\\n                                      int64_t src_offset,               \\\n                                      int32_t num_arrays,               \\\n                                      int32_t x_elems,                  \\\n                                      int32_t y_elems,                  \\\n                                      int32_t mulx,                     \\\n                                      int32_t muly,                     \\\n                                      int32_t repeat_1,                 \\\n  ", "                                    int32_t repeat_2) {               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t x_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(0)/muly; \\\n      int32_t y_index =                                                 \\\n        tblock_id_1 * TR_BLOCK_DIM * muly +                             \\\n        get_local_id(1) + (get_local_id(0)%muly) * TR_BLOCK_DIM;        \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      if (x_index < x_elems && y_index < y_elems) {                     \\\n        block[get_local_id(1) * (TR_BLOCK_DIM+1) + get_local_id(0)] =   \\\n          src_mem[idata_offset + index_in];                             \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_BLOCK_DIM * muly +                     \\\n        get_local_id(0) + (get_local_id(1)%muly) * TR_BLOCK_DIM;        \\\n      y_index = tblock_id_0 * TR_BLOCK_DIM + get_local_id(1)/muly;      \\\n      int32_t index_out = y_index * y_elems + x_index;                  \\\n ",
                                    "     if (x_index < y_elems && y_index < x_elems) {                     \\\n        dst_mem[odata_offset + index_out] =                             \\\n          block[get_local_id(0) * (TR_BLOCK_DIM+1) + get_local_id(1)];  \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_num_tblocks(2) * get_local_size(2);            \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_num_tblocks(1) * get_local_size(1);              \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*TR_BLOCK_DIM, 1, 1)                   \\\nvoid map_transpose_##NAME##_small(SHARED_MEM_PARAM                       \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int32_t num_arrays,                   \\\n                                  int32_t x_elems,                      \\\n                                  int32_t y_elems,                      \\\n                                  int32_t mulx,                         \\\n                                  int32_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;            \\\n  ", "int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int32_t our_array_offset = global_id_0/(y_elems * x_elems) * y_elems * x_elems; \\\n      int32_t x_index = (global_id_0 % (y_elems * x_elems))/y_elems;    \\\n      int32_t y_index = global_id_0%y_elems;                            \\\n      int32_t odata_offset = dst_offset + our_array_offset;             \\\n      int32_t idata_offset = src_offset + our_array_offset;             \\\n      int32_t index_in = y_index * x_elems + x_index;                   \\\n      int32_t index_out = x_index * y_elems + y_index;                  \\\n      if (global_id_0 < x_elems * y_elems * num_arrays) {               \\\n        dst_mem[odata_offset + index_out] = src_mem[idata_offset + index_in]; \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                                                   \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n                                                                        \\\nFUTHARK_KERNEL_SIZED(TR_BLOCK_DIM*2, TR_TILE_DIM/TR_ELEMS_", "PER_THREAD, 1)\\\nvoid map_transpose_##NAME##_large(SHARED_MEM_PARAM                      \\\n                                  __global ELEM_TYPE *dst_mem,          \\\n                                  int64_t dst_offset,                   \\\n                                  __global ELEM_TYPE *src_mem,          \\\n                                  int64_t src_offset,                   \\\n                                  int64_t num_arrays,                   \\\n                                  int64_t x_elems,                      \\\n                                  int64_t y_elems,                      \\\n                                  int64_t mulx,                         \\\n                                  int64_t muly,                         \\\n                                  int32_t repeat_1,                     \\\n                                  int32_t repeat_2) {                   \\\n  (void)mulx; (void)muly;                                               \\\n  __local ELEM_TYPE* block = (__local ELEM_TYPE*)shared_mem;             \\\n  int tblock_id_0 = get_tblock_id(0);                                   \\\n  int global_id_0 = get_global_id(0);                                   \\\n  int tblock_id_1 = get_tblock_id(1);                                   \\\n  int global_id_1 = get_global_id(1);                                   \\\n  for (int i1 = 0; i1 <= repeat_1; i1++) {                              \\\n    int tblock_id_2 = get_tblock_id(2);                                 \\\n    int global_id_2 = get_global_id(2);                                 \\\n    for (int i2 = 0; i2 <= repeat_2; i2++) {                            \\\n      int64_t our_array_offset = tblock_id_2 * x_elems * y_elems;       \\\n      int64_t odata_offset = dst_offset + our_array_offset;             \\\n      int64_t idata_offset = src_offset + our_array_offset;             \\\n      int64_t x_index = global_id_0;                                    \\\n      int64_t y_index = tblock_id_1 * TR_TILE_DIM + get_loc",
                                    "al_id(1);    \\\n      if (x_index < x_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_i = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * x_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < y_elems) { \\\n            block[(get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * (TR_TILE_DIM+1) + \\\n                  get_local_id(0)] =                                    \\\n              src_mem[idata_offset + index_i];                          \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      barrier_local();                                                  \\\n      x_index = tblock_id_1 * TR_TILE_DIM + get_local_id(0);            \\\n      y_index = tblock_id_0 * TR_TILE_DIM + get_local_id(1);            \\\n      if (x_index < y_elems) {                                          \\\n        for (int64_t j = 0; j < TR_ELEMS_PER_THREAD; j++) {             \\\n          int64_t index_out = (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)) * y_elems + x_index; \\\n          if (y_index + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD) < x_elems) { \\\n            dst_mem[(odata_offset + index_out)] =                       \\\n              block[get_local_id(0) * (TR_TILE_DIM+1) +                 \\\n                    get_local_id(1) + j * (TR_TILE_DIM/TR_ELEMS_PER_THREAD)]; \\\n          }                                                             \\\n        }                                                               \\\n      }                                                                 \\\n      tblock_id_2 += get_num_tblocks(2);                                \\\n      global_id_2 += get_global_size(2);                                \\\n    }                                      ", "                             \\\n    tblock_id_1 += get_num_tblocks(1);                                  \\\n    global_id_1 += get_global_size(1);                                  \\\n  }                                                                     \\\n}                                                                       \\\n\nGEN_TRANSPOSE_KERNELS(1b, uint8_t)\nGEN_TRANSPOSE_KERNELS(2b, uint16_t)\nGEN_TRANSPOSE_KERNELS(4b, uint32_t)\nGEN_TRANSPOSE_KERNELS(8b, uint64_t)\n\n// End of transpose.cl\n// Start of copy.cl\n\n#define GEN_COPY_KERNEL(NAME, ELEM_TYPE) \\\nFUTHARK_KERNEL void lmad_copy_##NAME(SHARED_MEM_PARAM                   \\\n                               __global ELEM_TYPE *dst_mem,             \\\n                               int64_t dst_offset,                      \\\n                               __global ELEM_TYPE *src_mem,             \\\n                               int64_t src_offset,                      \\\n                               int64_t n,                               \\\n                               int r,                                   \\\n                               int64_t shape0, int64_t dst_stride0, int64_t src_stride0, \\\n                               int64_t shape1, int64_t dst_stride1, int64_t src_stride1, \\\n                               int64_t shape2, int64_t dst_stride2, int64_t src_stride2, \\\n                               int64_t shape3, int64_t dst_stride3, int64_t src_stride3, \\\n                               int64_t shape4, int64_t dst_stride4, int64_t src_stride4, \\\n                               int64_t shape5, int64_t dst_stride5, int64_t src_stride5, \\\n                               int64_t shape6, int64_t dst_stride6, int64_t src_stride6, \\\n                               int64_t shape7, int64_t dst_stride7, int64_t src_stride7) { \\\n  int64_t gtid = get_global_id(0);                                      \\\n  int64_t remainder = gtid;                                             \\\n                                             ", "                           \\\n  if (gtid >= n) {                                                      \\\n    return;                                                             \\\n  }                                                                     \\\n                                                                        \\\n  if (r > 0) {                                                          \\\n    int64_t i = remainder % shape0;                                     \\\n    dst_offset += i * dst_stride0;                                      \\\n    src_offset += i * src_stride0;                                      \\\n    remainder /= shape0;                                                \\\n  }                                                                     \\\n  if (r > 1) {                                                          \\\n    int64_t i = remainder % shape1;                                     \\\n    dst_offset += i * dst_stride1;                                      \\\n    src_offset += i * src_stride1;                                      \\\n    remainder /= shape1;                                                \\\n  }                                                                     \\\n  if (r > 2) {                                                          \\\n    int64_t i = remainder % shape2;                                     \\\n    dst_offset += i * dst_stride2;                                      \\\n    src_offset += i * src_stride2;                                      \\\n    remainder /= shape2;                                                \\\n  }                                                                     \\\n  if (r > 3) {                                                          \\\n    int64_t i = remainder % shape3;                                     \\\n    dst_offset += i * dst_stride3;                                      \\\n    src_offset += i * src_stride3;                                      \\\n    remainder /= shape3;                       ",
                                    "                         \\\n  }                                                                     \\\n  if (r > 4) {                                                          \\\n    int64_t i = remainder % shape4;                                     \\\n    dst_offset += i * dst_stride4;                                      \\\n    src_offset += i * src_stride4;                                      \\\n    remainder /= shape4;                                                \\\n  }                                                                     \\\n  if (r > 5) {                                                          \\\n    int64_t i = remainder % shape5;                                     \\\n    dst_offset += i * dst_stride5;                                      \\\n    src_offset += i * src_stride5;                                      \\\n    remainder /= shape5;                                                \\\n  }                                                                     \\\n  if (r > 6) {                                                          \\\n    int64_t i = remainder % shape6;                                     \\\n    dst_offset += i * dst_stride6;                                      \\\n    src_offset += i * src_stride6;                                      \\\n    remainder /= shape6;                                                \\\n  }                                                                     \\\n  if (r > 7) {                                                          \\\n    int64_t i = remainder % shape7;                                     \\\n    dst_offset += i * dst_stride7;                                      \\\n    src_offset += i * src_stride7;                                      \\\n    remainder /= shape7;                                                \\\n  }                                                                     \\\n                                                                        \\\n  dst_mem[dst_offset] = src_mem[src_offset];     ", "                       \\\n}\n\nGEN_COPY_KERNEL(1b, uint8_t)\nGEN_COPY_KERNEL(2b, uint16_t)\nGEN_COPY_KERNEL(4b, uint32_t)\nGEN_COPY_KERNEL(8b, uint64_t)\n\n// End of copy.cl\n\nFUTHARK_FUN_ATTR void futrts_get_bit_1844(int32_t *out_prim_out_0, int32_t bit_22732, int16_t x_22733);\nFUTHARK_FUN_ATTR void futrts_get_bit_2253(int32_t *out_prim_out_0, int32_t bit_27949, int64_t x_27950);\nFUTHARK_FUN_ATTR void futrts_lifted_f_7536(int64_t *out_prim_out_0, int16_t na_22256, int16_t nb_22257, int16_t nc_22258, int16_t bin_22259, int16_t a_22260, int16_t b_22261, int16_t c_22262, int16_t d_22263);\nFUTHARK_FUN_ATTR void futrts_lifted_lambda_7535(int16_t *out_prim_out_0, int16_t *out_prim_out_1, int16_t *out_prim_out_2, int16_t *out_prim_out_3, int16_t x_22199);\n\nFUTHARK_FUN_ATTR void futrts_get_bit_1844(int32_t *out_prim_out_0, int32_t bit_22732, int16_t x_22733)\n{\n    int32_t prim_out_48103;\n    int16_t i32_res_38034 = sext_i32_i16(bit_22732);\n    int16_t zgzg_res_38037 = ashr16(x_22733, i32_res_38034);\n    int16_t za_res_38042 = (int16_t) 1 & zgzg_res_38037;\n    int32_t to_i32_res_38044 = sext_i16_i32(za_res_38042);\n    \n    prim_out_48103 = to_i32_res_38044;\n    *out_prim_out_0 = prim_out_48103;\n}\nFUTHARK_FUN_ATTR void futrts_get_bit_2253(int32_t *out_prim_out_0, int32_t bit_27949, int64_t x_27950)\n{\n    int32_t prim_out_48103;\n    int64_t i32_res_38034 = sext_i32_i64(bit_27949);\n    int64_t zgzg_res_38037 = ashr64(x_27950, i32_res_38034);\n    int64_t za_res_38042 = (int64_t) 1 & zgzg_res_38037;\n    int32_t to_i32_res_38044 = sext_i64_i32(za_res_38042);\n    \n    prim_out_48103 = to_i32_res_38044;\n    *out_prim_out_0 = prim_out_48103;\n}\nFUTHARK_FUN_ATTR void futrts_lifted_f_7536(int64_t *out_prim_out_0, int16_t na_22256, int16_t nb_22257, int16_t nc_22258, int16_t bin_22259, int16_t a_22260, int16_t b_22261, int16_t c_22262, int16_t d_22263)\n{\n    int64_t prim_out_48103;\n    bool bool_arg0_22264 = bin_22259 == (int16_t) 0;\n    int16_t bool_res_38034 = btoi_bool_i16(bool_arg0_22264);\n ", "   int16_t zp_rhs_22268 = mul16(a_22260, bool_res_38034);\n    int16_t zp_lhs_22271 = add16((int16_t) -1, zp_rhs_22268);\n    bool bool_arg0_22273 = slt16((int16_t) 0, bin_22259);\n    int16_t bool_res_38036 = btoi_bool_i16(bool_arg0_22273);\n    int16_t zp_rhs_22277 = mul16(na_22256, bool_res_38036);\n    int16_t zp_lhs_22279 = add16(zp_lhs_22271, zp_rhs_22277);\n    bool bool_arg0_22281 = bin_22259 == (int16_t) 1;\n    int16_t bool_res_38038 = btoi_bool_i16(bool_arg0_22281);\n    int16_t zp_rhs_22285 = mul16(b_22261, bool_res_38038);\n    int16_t zp_lhs_22287 = add16(zp_lhs_22279, zp_rhs_22285);\n    bool bool_arg0_22289 = slt16((int16_t) 1, bin_22259);\n    int16_t bool_res_38040 = btoi_bool_i16(bool_arg0_22289);\n    int16_t zp_rhs_22293 = mul16(nb_22257, bool_res_38040);\n    int16_t zp_lhs_22295 = add16(zp_lhs_22287, zp_rhs_22293);\n    bool bool_arg0_22297 = bin_22259 == (int16_t) 2;\n    int16_t bool_res_38042 = btoi_bool_i16(bool_arg0_22297);\n    int16_t zp_rhs_22301 = mul16(c_22262, bool_res_38042);\n    int16_t zp_lhs_22303 = add16(zp_lhs_22295, zp_rhs_22301);\n    bool bool_arg0_22305 = slt16((int16_t) 2, bin_22259);\n    int16_t bool_res_38044 = btoi_bool_i16(bool_arg0_22305);\n    int16_t zp_rhs_22309 = mul16(nc_22258, bool_res_38044);\n    int16_t zp_lhs_22311 = add16(zp_lhs_22303, zp_rhs_22309);\n    bool bool_arg0_22313 = bin_22259 == (int16_t) 3;\n    int16_t bool_res_38046 = btoi_bool_i16(bool_arg0_22313);\n    int16_t zp_rhs_22317 = mul16(d_22263, bool_res_38046);\n    int16_t i16_arg0_22319 = add16(zp_lhs_22311, zp_rhs_22317);\n    int64_t i16_res_38048 = sext_i16_i64(i16_arg0_22319);\n    \n    prim_out_48103 = i16_res_38048;\n    *out_prim_out_0 = prim_out_48103;\n}\nFUTHARK_FUN_ATTR void futrts_lifted_lambda_7535(int16_t *out_prim_out_0, int16_t *out_prim_out_1, int16_t *out_prim_out_2, int16_t *out_prim_out_3, int16_t x_22199)\n{\n    int16_t prim_out_48103;\n    int16_t prim_out_48104;\n    int16_t prim_out_48105;\n    int16_t prim_out_48106;\n    bool bool_arg0_22200 = x_221",
                                    "99 == (int16_t) 0;\n    int16_t bool_res_38034 = btoi_bool_i16(bool_arg0_22200);\n    bool bool_arg0_22204 = x_22199 == (int16_t) 1;\n    int16_t bool_res_38036 = btoi_bool_i16(bool_arg0_22204);\n    bool bool_arg0_22208 = x_22199 == (int16_t) 2;\n    int16_t bool_res_38038 = btoi_bool_i16(bool_arg0_22208);\n    bool bool_arg0_22212 = x_22199 == (int16_t) 3;\n    int16_t bool_res_38040 = btoi_bool_i16(bool_arg0_22212);\n    \n    prim_out_48103 = bool_res_38034;\n    prim_out_48104 = bool_res_38036;\n    prim_out_48105 = bool_res_38038;\n    prim_out_48106 = bool_res_38040;\n    *out_prim_out_0 = prim_out_48103;\n    *out_prim_out_1 = prim_out_48104;\n    *out_prim_out_2 = prim_out_48105;\n    *out_prim_out_3 = prim_out_48106;\n}\n\nFUTHARK_KERNEL_SIZED(argmin_doublezisegred_nonseg_44069_dim1, 1, 1)\nvoid argmin_doublezisegred_nonseg_44069(__global int *global_failure, int64_t n_37213, int64_t num_tblocks_44063, int64_t num_threads_48132, __global unsigned char *ks_mem_47844, __global unsigned char *mem_47846, __global unsigned char *mem_47847, __global unsigned char *counters_mem_48106, __global unsigned char *segred_tmp_mem_48128, __global unsigned char *segred_tmp_mem_48130)\n{\n    #define segred_tblock_sizze_44061 (argmin_doublezisegred_nonseg_44069zisegred_tblock_sizze_44061)\n    #define chunk_sizze_48105 (argmin_doublezisegred_nonseg_44069zichunk_sizze_48105)\n    \n    volatile __local unsigned char *sync_arr_mem_48142_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_48142_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f64_mem_48140_backing_1 = &shared_mem[sync_arr_mem_48142_backing_2_offset];\n    const int64_t red_arr_f64_mem_48140_backing_1_offset = sync_arr_mem_48142_backing_2_offset + ((int64_t) 8 * segred_tblock_sizze_44061 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44061, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_48138_backing_0 = &shared_mem[red_arr_f64_mem_48140_backing_1_offset];\n ", "   const int64_t red_arr_i64_mem_48138_backing_0_offset = red_arr_f64_mem_48140_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_44061 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44061, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48134;\n    int32_t tblock_sizze_48137;\n    int32_t wave_sizze_48136;\n    int32_t block_id_48135;\n    int32_t global_tid_48133;\n    int64_t phys_tid_44069;\n    __local unsigned char *red_arr_i64_mem_48138;\n    __local unsigned char *red_arr_f64_mem_48140;\n    __local unsigned char *sync_arr_mem_48142;\n    int64_t dummy_44067;\n    int64_t gtid_44068;\n    int64_t q_48144;\n    int64_t eta_p_block_res_acc_48145;\n    double eta_p_block_res_acc_48146;\n    int64_t eta_p_38737;\n    double eta_p_38738;\n    int64_t eta_p_38739;\n    double eta_p_38740;\n    int64_t tblock_id_in_segment_48160;\n    int64_t block_base_offset_48161;\n    int32_t offset_48164;\n    int32_t skip_waves_48165;\n    int64_t eta_p_48147;\n    double eta_p_48148;\n    int64_t eta_p_48149;\n    double eta_p_48150;\n    int32_t old_counter_48166;\n    bool is_last_block_48167;\n    \n    local_tid_48134 = get_local_id(0);\n    tblock_sizze_48137 = get_local_size(0);\n    wave_sizze_48136 = LOCKSTEP_WIDTH;\n    block_id_48135 = get_tblock_id(0);\n    global_tid_48133 = block_id_48135 * tblock_sizze_48137 + local_tid_48134;\n    phys_tid_44069 = sext_i32_i64(global_tid_48133);\n    red_arr_i64_mem_48138 = (__local unsigned char *) red_arr_i64_mem_48138_backing_0;\n    red_arr_f64_mem_48140 = (__local unsigned char *) red_arr_f64_mem_48140_backing_1;\n    sync_arr_mem_48142 = (__local unsigned char *) sync_arr_mem_48142_backing_2;\n    dummy_44067 = (int64_t) 0;\n    gtid_44068 = (int64_t) 0;\n    q_48144 = sdiv_up64(n_37213, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_44061 * num_tblocks_44063)) * chunk_sizze_48105);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_48145 = n", "_37213;\n        eta_p_block_res_acc_48146 = INFINITY;\n    }\n    tblock_id_in_segment_48160 = squot64(phys_tid_44069, segred_tblock_sizze_44061);\n    block_base_offset_48161 = tblock_id_in_segment_48160 * q_48144 * segred_tblock_sizze_44061;\n    for (int64_t i_48162 = 0; i_48162 < q_48144; i_48162++) {\n        int64_t block_offset_48163 = block_base_offset_48161 + i_48162 * segred_tblock_sizze_44061;\n        \n        gtid_44068 = phys_tid_44069 + num_threads_48132 * i_48162;\n        if (slt64(gtid_44068, n_37213)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    double x_38736 = ((__global double *) ks_mem_47844)[gtid_44068];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_38737 = eta_p_block_res_acc_48145;\n                        eta_p_38738 = eta_p_block_res_acc_48146;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_38739 = gtid_44068;\n                        eta_p_38740 = x_38736;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_lt_res_38741 = eta_p_38738 < eta_p_38740;\n                        bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                        bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                        bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                        bool x_43573 = !defunc_0_lt_res_38741;\n                        bool y_43574 = x_38745 && x_43573;\n                        bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                        int64_t defunc_0_op_res_38746;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38746 = eta_p_38737;\n                        } else {\n                            defunc_0_op",
                                    "_res_38746 = eta_p_38739;\n                        }\n                        \n                        double defunc_0_op_res_38747;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38747 = eta_p_38738;\n                        } else {\n                            defunc_0_op_res_38747 = eta_p_38740;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_48145 = defunc_0_op_res_38746;\n                            eta_p_block_res_acc_48146 = defunc_0_op_res_38747;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48145;\n        ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48146;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_48165 = 1;\n    offset_48164 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44061))) {\n            eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            eta_p_48148 = ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n        }\n    }\n    offset_48164 = 1;\n    while (slt32(offset_48164, wave_sizze_48136)) {\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44061)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48164 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n       ", "         eta_p_48150 = ((volatile __local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                double defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((volatile __local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        offset_48164 *= 2;\n    }\n    while (slt32(skip_waves_48165, squot32(sext_i64_i32(segred_tblock_sizze_44061) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_48164 = skip_waves_48165 * wave_sizze_48136;\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44061)) && ((local_tid_48134 - squ", "ot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48165 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                double defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        skip_waves_48165 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ba",
                                    "rrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_48134) == (int64_t) 0) {\n            eta_p_block_res_acc_48145 = eta_p_48147;\n            eta_p_block_res_acc_48146 = eta_p_48148;\n        } else {\n            eta_p_block_res_acc_48145 = n_37213;\n            eta_p_block_res_acc_48146 = INFINITY;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_48134 == 0) {\n            ((__global int64_t *) segred_tmp_mem_48128)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48145;\n            mem_fence_global();\n            ((__global double *) segred_tmp_mem_48130)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48146;\n            mem_fence_global();\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_48142)[(int64_t) 0] = old_counter_48166 == sext_i64_i32(num_tblocks_44063 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_48167 = ((__local bool *) sync_arr_mem_48142)[(int64_t) 0];\n    if (is_last_block_48167) {\n        if (local_tid_48134 == 0) {\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_44063));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_48168 = sdiv_up64(num_tblocks_44063, segred_tblock_sizze_44061);\n            \n            eta_p_38737 = n_37213;\n            eta_p_38738 = INFINITY;\n            for (int64_t i_48169 = 0; i_48169 < read_per_thread_48168; i_48169++) {\n                int64_t block_res_id_48170 = sext_i32_i64(local_tid_48134) * read_per_thread_48168 + i_48169;\n                int64_t index_of_block_res_48171 = block_res_id_48170;\n                \n                if (slt64(block_re", "s_id_48170, num_tblocks_44063)) {\n                    eta_p_38739 = ((__global int64_t *) segred_tmp_mem_48128)[index_of_block_res_48171];\n                    eta_p_38740 = ((__global double *) segred_tmp_mem_48130)[index_of_block_res_48171];\n                    \n                    bool defunc_0_lt_res_38741 = eta_p_38738 < eta_p_38740;\n                    bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                    bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                    bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                    bool x_43573 = !defunc_0_lt_res_38741;\n                    bool y_43574 = x_38745 && x_43573;\n                    bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                    int64_t defunc_0_op_res_38746;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38746 = eta_p_38737;\n                    } else {\n                        defunc_0_op_res_38746 = eta_p_38739;\n                    }\n                    \n                    double defunc_0_op_res_38747;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38747 = eta_p_38738;\n                    } else {\n                        defunc_0_op_res_38747 = eta_p_38740;\n                    }\n                    eta_p_38737 = defunc_0_op_res_38746;\n                    eta_p_38738 = defunc_0_op_res_38747;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_38737;\n        ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_38738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_48172;\n            int32_t skip_waves_48173 = 1;\n            int64_t eta_p_48147;\n            double eta_p_48148;\n            int64_t eta_p_48149;\n            double eta_p_48150;", "\n            \n            offset_48172 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44061))) {\n                    eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    eta_p_48148 = ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                }\n            }\n            offset_48172 = 1;\n            while (slt32(offset_48172, wave_sizze_48136)) {\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44061)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48172 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((volatile __local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                 ",
                                    "           defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        double defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((volatile __local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                offset_48172 *= 2;\n            }\n            while (slt32(skip_waves_48173, squot32(sext_i64_i32(segred_tblock_sizze_44061) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_48172 = skip_waves_48173 * wave_sizze_48136;\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44061)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48173 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                     ", "   bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        double defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((__local double *) red_arr_f64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                skip_waves_48173 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_48134 == 0) {\n                    ((__global int64_t *) mem_47846)[(int64_t) 0] = eta_p_48147;\n                    ((__global double *) mem_47847)[(int64_t) 0] = eta_p_48148;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    r", "eturn;\n    #undef segred_tblock_sizze_44061\n    #undef chunk_sizze_48105\n}\nFUTHARK_KERNEL_SIZED(argmin_floatzisegred_nonseg_44058_dim1, 1, 1)\nvoid argmin_floatzisegred_nonseg_44058(__global int *global_failure, int64_t n_37044, int64_t num_tblocks_44052, int64_t num_threads_48132, __global unsigned char *ks_mem_47844, __global unsigned char *mem_47846, __global unsigned char *mem_47847, __global unsigned char *counters_mem_48106, __global unsigned char *segred_tmp_mem_48128, __global unsigned char *segred_tmp_mem_48130)\n{\n    #define segred_tblock_sizze_44050 (argmin_floatzisegred_nonseg_44058zisegred_tblock_sizze_44050)\n    #define chunk_sizze_48105 (argmin_floatzisegred_nonseg_44058zichunk_sizze_48105)\n    \n    volatile __local unsigned char *sync_arr_mem_48142_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_48142_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_f32_mem_48140_backing_1 = &shared_mem[sync_arr_mem_48142_backing_2_offset];\n    const int64_t red_arr_f32_mem_48140_backing_1_offset = sync_arr_mem_48142_backing_2_offset + ((int64_t) 4 * segred_tblock_sizze_44050 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_44050, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_48138_backing_0 = &shared_mem[red_arr_f32_mem_48140_backing_1_offset];\n    const int64_t red_arr_i64_mem_48138_backing_0_offset = red_arr_f32_mem_48140_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_44050 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44050, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48134;\n    int32_t tblock_sizze_48137;\n    int32_t wave_sizze_48136;\n    int32_t block_id_48135;\n    int32_t global_tid_48133;\n    int64_t phys_tid_44058;\n    __local unsigned char *red_arr_i64_mem_48138;\n    __local unsigned char *red_arr_f32_mem_48140;\n    __local unsigned char *sync_arr_mem_48142;\n    int64_t dummy_44056;\n    int6",
                                    "4_t gtid_44057;\n    int64_t q_48144;\n    int64_t eta_p_block_res_acc_48145;\n    float eta_p_block_res_acc_48146;\n    int64_t eta_p_38737;\n    float eta_p_38738;\n    int64_t eta_p_38739;\n    float eta_p_38740;\n    int64_t tblock_id_in_segment_48160;\n    int64_t block_base_offset_48161;\n    int32_t offset_48164;\n    int32_t skip_waves_48165;\n    int64_t eta_p_48147;\n    float eta_p_48148;\n    int64_t eta_p_48149;\n    float eta_p_48150;\n    int32_t old_counter_48166;\n    bool is_last_block_48167;\n    \n    local_tid_48134 = get_local_id(0);\n    tblock_sizze_48137 = get_local_size(0);\n    wave_sizze_48136 = LOCKSTEP_WIDTH;\n    block_id_48135 = get_tblock_id(0);\n    global_tid_48133 = block_id_48135 * tblock_sizze_48137 + local_tid_48134;\n    phys_tid_44058 = sext_i32_i64(global_tid_48133);\n    red_arr_i64_mem_48138 = (__local unsigned char *) red_arr_i64_mem_48138_backing_0;\n    red_arr_f32_mem_48140 = (__local unsigned char *) red_arr_f32_mem_48140_backing_1;\n    sync_arr_mem_48142 = (__local unsigned char *) sync_arr_mem_48142_backing_2;\n    dummy_44056 = (int64_t) 0;\n    gtid_44057 = (int64_t) 0;\n    q_48144 = sdiv_up64(n_37044, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_44050 * num_tblocks_44052)) * chunk_sizze_48105);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_48145 = n_37044;\n        eta_p_block_res_acc_48146 = INFINITY;\n    }\n    tblock_id_in_segment_48160 = squot64(phys_tid_44058, segred_tblock_sizze_44050);\n    block_base_offset_48161 = tblock_id_in_segment_48160 * q_48144 * segred_tblock_sizze_44050;\n    for (int64_t i_48162 = 0; i_48162 < q_48144; i_48162++) {\n        int64_t block_offset_48163 = block_base_offset_48161 + i_48162 * segred_tblock_sizze_44050;\n        \n        gtid_44057 = phys_tid_44058 + num_threads_48132 * i_48162;\n        if (slt64(gtid_44057, n_37044)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    float x_38", "736 = ((__global float *) ks_mem_47844)[gtid_44057];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_38737 = eta_p_block_res_acc_48145;\n                        eta_p_38738 = eta_p_block_res_acc_48146;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_38739 = gtid_44057;\n                        eta_p_38740 = x_38736;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_lt_res_38741 = eta_p_38738 < eta_p_38740;\n                        bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                        bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                        bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                        bool x_43573 = !defunc_0_lt_res_38741;\n                        bool y_43574 = x_38745 && x_43573;\n                        bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                        int64_t defunc_0_op_res_38746;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38746 = eta_p_38737;\n                        } else {\n                            defunc_0_op_res_38746 = eta_p_38739;\n                        }\n                        \n                        float defunc_0_op_res_38747;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38747 = eta_p_38738;\n                        } else {\n                            defunc_0_op_res_38747 = eta_p_38740;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_48145 = defunc_0_op_res_38746;\n                            eta_p_block_res_acc_48146 = defunc_0_op_res_38747;\n                        }\n             ", "       }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48145;\n        ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48146;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_48165 = 1;\n    offset_48164 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44050))) {\n            eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            eta_p_48148 = ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n        }\n    }\n    offset_48164 = 1;\n    while (slt32(offset_48164, wave_sizze_48136)) {\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44050)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48164 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((volatile __local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48",
                                    "156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                float defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((volatile __local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        offset_48164 *= 2;\n    }\n    while (slt32(skip_waves_48165, squot32(sext_i64_i32(segred_tblock_sizze_44050) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_48164 = skip_waves_48165 * wave_sizze_48136;\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44050)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48165 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n             ", "   bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                float defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        skip_waves_48165 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_48134) == (int64_t) 0) {\n            eta_p_block_res_acc_48145 = eta_p_48147;\n            eta_p_block_res_acc_48146 = eta_p_48148;\n        } else {\n            eta_p_block_res_acc_48145 = n_37044;\n            eta_p_block_res_acc_48146 = INFINITY;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_48134 == 0) {\n            ((__global int64_t *) segred_tmp_mem_48128)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48145;\n            mem_fence_global();\n            ((__global f", "loat *) segred_tmp_mem_48130)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48146;\n            mem_fence_global();\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_48142)[(int64_t) 0] = old_counter_48166 == sext_i64_i32(num_tblocks_44052 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_48167 = ((__local bool *) sync_arr_mem_48142)[(int64_t) 0];\n    if (is_last_block_48167) {\n        if (local_tid_48134 == 0) {\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_44052));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_48168 = sdiv_up64(num_tblocks_44052, segred_tblock_sizze_44050);\n            \n            eta_p_38737 = n_37044;\n            eta_p_38738 = INFINITY;\n            for (int64_t i_48169 = 0; i_48169 < read_per_thread_48168; i_48169++) {\n                int64_t block_res_id_48170 = sext_i32_i64(local_tid_48134) * read_per_thread_48168 + i_48169;\n                int64_t index_of_block_res_48171 = block_res_id_48170;\n                \n                if (slt64(block_res_id_48170, num_tblocks_44052)) {\n                    eta_p_38739 = ((__global int64_t *) segred_tmp_mem_48128)[index_of_block_res_48171];\n                    eta_p_38740 = ((__global float *) segred_tmp_mem_48130)[index_of_block_res_48171];\n                    \n                    bool defunc_0_lt_res_38741 = eta_p_38738 < eta_p_38740;\n                    bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                    bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                    bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                    bool x_43573 = !defunc_0_lt_res_38741;\n                    bool y_4",
                                    "3574 = x_38745 && x_43573;\n                    bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                    int64_t defunc_0_op_res_38746;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38746 = eta_p_38737;\n                    } else {\n                        defunc_0_op_res_38746 = eta_p_38739;\n                    }\n                    \n                    float defunc_0_op_res_38747;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38747 = eta_p_38738;\n                    } else {\n                        defunc_0_op_res_38747 = eta_p_38740;\n                    }\n                    eta_p_38737 = defunc_0_op_res_38746;\n                    eta_p_38738 = defunc_0_op_res_38747;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_38737;\n        ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_38738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_48172;\n            int32_t skip_waves_48173 = 1;\n            int64_t eta_p_48147;\n            float eta_p_48148;\n            int64_t eta_p_48149;\n            float eta_p_48150;\n            \n            offset_48172 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44050))) {\n                    eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    eta_p_48148 = ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                }\n            }\n            offset_48172 = 1;\n            while (slt32(offset_48172, wave_sizze_48136)) {\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44050))", " && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48172 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((volatile __local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        float defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) ", "red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((volatile __local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                offset_48172 *= 2;\n            }\n            while (slt32(skip_waves_48173, squot32(sext_i64_i32(segred_tblock_sizze_44050) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_48172 = skip_waves_48173 * wave_sizze_48136;\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44050)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48173 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = eta_p_48148 < eta_p_48150;\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                           ",
                                    " defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        float defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((__local float *) red_arr_f32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                skip_waves_48173 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_48134 == 0) {\n                    ((__global int64_t *) mem_47846)[(int64_t) 0] = eta_p_48147;\n                    ((__global float *) mem_47847)[(int64_t) 0] = eta_p_48148;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_44050\n    #undef chunk_sizze_48105\n}\nFUTHARK_KERNEL_SIZED(argmin_intzisegred_nonseg_44036_dim1, 1, 1)\nvoid argmin_intzisegred_nonseg_44036(__global int *global_failure, int64_t n_36709, int64_t num_tblocks_44030, int64_t num_threads_48132, __global unsigned char *ks_mem_47844, __global unsigned char *mem_47846, __global unsigned char *mem_47847, __global unsigned char *counters_mem_48106, __global unsigned char *segred_tmp_mem_48128, __global unsigned char *segred_tmp_mem_48130)\n{\n    #define segred_tblock_sizze_44028 (argmin_intzisegred_nonseg_44036zisegred_tblock_sizze_44028)\n    #define chunk_sizze_48105 (argmin_intzisegred_nonseg_440", "36zichunk_sizze_48105)\n    \n    volatile __local unsigned char *sync_arr_mem_48142_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_48142_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i32_mem_48140_backing_1 = &shared_mem[sync_arr_mem_48142_backing_2_offset];\n    const int64_t red_arr_i32_mem_48140_backing_1_offset = sync_arr_mem_48142_backing_2_offset + ((int64_t) 4 * segred_tblock_sizze_44028 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_44028, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_48138_backing_0 = &shared_mem[red_arr_i32_mem_48140_backing_1_offset];\n    const int64_t red_arr_i64_mem_48138_backing_0_offset = red_arr_i32_mem_48140_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_44028 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44028, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48134;\n    int32_t tblock_sizze_48137;\n    int32_t wave_sizze_48136;\n    int32_t block_id_48135;\n    int32_t global_tid_48133;\n    int64_t phys_tid_44036;\n    __local unsigned char *red_arr_i64_mem_48138;\n    __local unsigned char *red_arr_i32_mem_48140;\n    __local unsigned char *sync_arr_mem_48142;\n    int64_t dummy_44034;\n    int64_t gtid_44035;\n    int64_t q_48144;\n    int64_t eta_p_block_res_acc_48145;\n    int32_t eta_p_block_res_acc_48146;\n    int64_t eta_p_38737;\n    int32_t eta_p_38738;\n    int64_t eta_p_38739;\n    int32_t eta_p_38740;\n    int64_t tblock_id_in_segment_48160;\n    int64_t block_base_offset_48161;\n    int32_t offset_48164;\n    int32_t skip_waves_48165;\n    int64_t eta_p_48147;\n    int32_t eta_p_48148;\n    int64_t eta_p_48149;\n    int32_t eta_p_48150;\n    int32_t old_counter_48166;\n    bool is_last_block_48167;\n    \n    local_tid_48134 = get_local_id(0);\n    tblock_sizze_48137 = get_local_size(0);\n    wave_sizze_48136 = LOCKSTEP_WIDTH;\n    block_id_48135 = get_tblock_id(0);\n    global_tid_4", "8133 = block_id_48135 * tblock_sizze_48137 + local_tid_48134;\n    phys_tid_44036 = sext_i32_i64(global_tid_48133);\n    red_arr_i64_mem_48138 = (__local unsigned char *) red_arr_i64_mem_48138_backing_0;\n    red_arr_i32_mem_48140 = (__local unsigned char *) red_arr_i32_mem_48140_backing_1;\n    sync_arr_mem_48142 = (__local unsigned char *) sync_arr_mem_48142_backing_2;\n    dummy_44034 = (int64_t) 0;\n    gtid_44035 = (int64_t) 0;\n    q_48144 = sdiv_up64(n_36709, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_44028 * num_tblocks_44030)) * chunk_sizze_48105);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_48145 = n_36709;\n        eta_p_block_res_acc_48146 = 2147483647;\n    }\n    tblock_id_in_segment_48160 = squot64(phys_tid_44036, segred_tblock_sizze_44028);\n    block_base_offset_48161 = tblock_id_in_segment_48160 * q_48144 * segred_tblock_sizze_44028;\n    for (int64_t i_48162 = 0; i_48162 < q_48144; i_48162++) {\n        int64_t block_offset_48163 = block_base_offset_48161 + i_48162 * segred_tblock_sizze_44028;\n        \n        gtid_44035 = phys_tid_44036 + num_threads_48132 * i_48162;\n        if (slt64(gtid_44035, n_36709)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int32_t x_38736 = ((__global int32_t *) ks_mem_47844)[gtid_44035];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_38737 = eta_p_block_res_acc_48145;\n                        eta_p_38738 = eta_p_block_res_acc_48146;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_38739 = gtid_44035;\n                        eta_p_38740 = x_38736;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_lt_res_38741 = slt32(eta_p_38738, eta_p_38740);\n                        bool defunc_0_eq_r",
                                    "es_38743 = eta_p_38738 == eta_p_38740;\n                        bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                        bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                        bool x_43573 = !defunc_0_lt_res_38741;\n                        bool y_43574 = x_38745 && x_43573;\n                        bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                        int64_t defunc_0_op_res_38746;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38746 = eta_p_38737;\n                        } else {\n                            defunc_0_op_res_38746 = eta_p_38739;\n                        }\n                        \n                        int32_t defunc_0_op_res_38747;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38747 = eta_p_38738;\n                        } else {\n                            defunc_0_op_res_38747 = eta_p_38740;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_48145 = defunc_0_op_res_38746;\n                            eta_p_block_res_acc_48146 = defunc_0_op_res_38747;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48145;\n        ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48146;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_48165 = 1;\n    offset_48164 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44028))) {\n            eta_p_48147 = ((__local int64_t *)", " red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            eta_p_48148 = ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n        }\n    }\n    offset_48164 = 1;\n    while (slt32(offset_48164, wave_sizze_48136)) {\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44028)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48164 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((volatile __local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt32(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int32_t defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n   ", "         // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((volatile __local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        offset_48164 *= 2;\n    }\n    while (slt32(skip_waves_48165, squot32(sext_i64_i32(segred_tblock_sizze_44028) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_48164 = skip_waves_48165 * wave_sizze_48136;\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44028)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48165 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt32(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int32_t defunc_0_op_res_48159;\n    ",
                                    "            \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        skip_waves_48165 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_48134) == (int64_t) 0) {\n            eta_p_block_res_acc_48145 = eta_p_48147;\n            eta_p_block_res_acc_48146 = eta_p_48148;\n        } else {\n            eta_p_block_res_acc_48145 = n_36709;\n            eta_p_block_res_acc_48146 = 2147483647;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_48134 == 0) {\n            ((__global int64_t *) segred_tmp_mem_48128)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48145;\n            mem_fence_global();\n            ((__global int32_t *) segred_tmp_mem_48130)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48146;\n            mem_fence_global();\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_48142)[(int64_t) 0] = old_counter_48166 == sext_i64_i32(num_tblocks_44030 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_48167 = ((__local bool *) sync_arr_mem_48142)[(int64_t) 0];\n    if (is_last_block_48167) {\n        if (local_tid_48134 == 0) {\n            old_counter_48166 = atomi", "c_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_44030));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_48168 = sdiv_up64(num_tblocks_44030, segred_tblock_sizze_44028);\n            \n            eta_p_38737 = n_36709;\n            eta_p_38738 = 2147483647;\n            for (int64_t i_48169 = 0; i_48169 < read_per_thread_48168; i_48169++) {\n                int64_t block_res_id_48170 = sext_i32_i64(local_tid_48134) * read_per_thread_48168 + i_48169;\n                int64_t index_of_block_res_48171 = block_res_id_48170;\n                \n                if (slt64(block_res_id_48170, num_tblocks_44030)) {\n                    eta_p_38739 = ((__global int64_t *) segred_tmp_mem_48128)[index_of_block_res_48171];\n                    eta_p_38740 = ((__global int32_t *) segred_tmp_mem_48130)[index_of_block_res_48171];\n                    \n                    bool defunc_0_lt_res_38741 = slt32(eta_p_38738, eta_p_38740);\n                    bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                    bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                    bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                    bool x_43573 = !defunc_0_lt_res_38741;\n                    bool y_43574 = x_38745 && x_43573;\n                    bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                    int64_t defunc_0_op_res_38746;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38746 = eta_p_38737;\n                    } else {\n                        defunc_0_op_res_38746 = eta_p_38739;\n                    }\n                    \n                    int32_t defunc_0_op_res_38747;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38747 = eta_p_38738;\n                    } else {\n                      ", "  defunc_0_op_res_38747 = eta_p_38740;\n                    }\n                    eta_p_38737 = defunc_0_op_res_38746;\n                    eta_p_38738 = defunc_0_op_res_38747;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_38737;\n        ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_38738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_48172;\n            int32_t skip_waves_48173 = 1;\n            int64_t eta_p_48147;\n            int32_t eta_p_48148;\n            int64_t eta_p_48149;\n            int32_t eta_p_48150;\n            \n            offset_48172 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44028))) {\n                    eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    eta_p_48148 = ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                }\n            }\n            offset_48172 = 1;\n            while (slt32(offset_48172, wave_sizze_48136)) {\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44028)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48172 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((volatile __local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt32(et",
                                    "a_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int32_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((volatile __local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                offset_48172 *= 2;\n            }\n            while (slt32(skip_waves_48173, squot32(sext_i64_i32(segred_tblock_sizze_44028) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_48172 = skip_waves_48173 * wave_sizze_48136;\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(se", "gred_tblock_sizze_44028)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48173 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt32(eta_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int32_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n  ", "                  {\n                        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((__local int32_t *) red_arr_i32_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                skip_waves_48173 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_48134 == 0) {\n                    ((__global int64_t *) mem_47846)[(int64_t) 0] = eta_p_48147;\n                    ((__global int32_t *) mem_47847)[(int64_t) 0] = eta_p_48148;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_44028\n    #undef chunk_sizze_48105\n}\nFUTHARK_KERNEL_SIZED(argmin_longzisegred_nonseg_44047_dim1, 1, 1)\nvoid argmin_longzisegred_nonseg_44047(__global int *global_failure, int64_t n_36875, int64_t num_tblocks_44041, int64_t num_threads_48132, __global unsigned char *ks_mem_47844, __global unsigned char *mem_47846, __global unsigned char *mem_47847, __global unsigned char *counters_mem_48106, __global unsigned char *segred_tmp_mem_48128, __global unsigned char *segred_tmp_mem_48130)\n{\n    #define segred_tblock_sizze_44039 (argmin_longzisegred_nonseg_44047zisegred_tblock_sizze_44039)\n    #define chunk_sizze_48105 (argmin_longzisegred_nonseg_44047zichunk_sizze_48105)\n    \n    volatile __local unsigned char *sync_arr_mem_48142_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_48142_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i64_mem_48140_backing_1 = &shared_mem[sync_arr_mem_48142_backing_2_offset];\n    const int64_t red_arr_i64_mem_48140_backing_1_offset = sync_arr_mem_48142_backing_2_offset + ((int64_t) 8 * segred_tblock_sizze_44039 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44039, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_4",
                                    "8138_backing_0 = &shared_mem[red_arr_i64_mem_48140_backing_1_offset];\n    const int64_t red_arr_i64_mem_48138_backing_0_offset = red_arr_i64_mem_48140_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_44039 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44039, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48134;\n    int32_t tblock_sizze_48137;\n    int32_t wave_sizze_48136;\n    int32_t block_id_48135;\n    int32_t global_tid_48133;\n    int64_t phys_tid_44047;\n    __local unsigned char *red_arr_i64_mem_48138;\n    __local unsigned char *red_arr_i64_mem_48140;\n    __local unsigned char *sync_arr_mem_48142;\n    int64_t dummy_44045;\n    int64_t gtid_44046;\n    int64_t q_48144;\n    int64_t eta_p_block_res_acc_48145;\n    int64_t eta_p_block_res_acc_48146;\n    int64_t eta_p_38737;\n    int64_t eta_p_38738;\n    int64_t eta_p_38739;\n    int64_t eta_p_38740;\n    int64_t tblock_id_in_segment_48160;\n    int64_t block_base_offset_48161;\n    int32_t offset_48164;\n    int32_t skip_waves_48165;\n    int64_t eta_p_48147;\n    int64_t eta_p_48148;\n    int64_t eta_p_48149;\n    int64_t eta_p_48150;\n    int32_t old_counter_48166;\n    bool is_last_block_48167;\n    \n    local_tid_48134 = get_local_id(0);\n    tblock_sizze_48137 = get_local_size(0);\n    wave_sizze_48136 = LOCKSTEP_WIDTH;\n    block_id_48135 = get_tblock_id(0);\n    global_tid_48133 = block_id_48135 * tblock_sizze_48137 + local_tid_48134;\n    phys_tid_44047 = sext_i32_i64(global_tid_48133);\n    red_arr_i64_mem_48138 = (__local unsigned char *) red_arr_i64_mem_48138_backing_0;\n    red_arr_i64_mem_48140 = (__local unsigned char *) red_arr_i64_mem_48140_backing_1;\n    sync_arr_mem_48142 = (__local unsigned char *) sync_arr_mem_48142_backing_2;\n    dummy_44045 = (int64_t) 0;\n    gtid_44046 = (int64_t) 0;\n    q_48144 = sdiv_up64(n_36875, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_44039 * num_tblocks_44041)) * chunk_sizze_48105);\n    // ne-initialise the ", "outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_48145 = n_36875;\n        eta_p_block_res_acc_48146 = (int64_t) 9223372036854775807;\n    }\n    tblock_id_in_segment_48160 = squot64(phys_tid_44047, segred_tblock_sizze_44039);\n    block_base_offset_48161 = tblock_id_in_segment_48160 * q_48144 * segred_tblock_sizze_44039;\n    for (int64_t i_48162 = 0; i_48162 < q_48144; i_48162++) {\n        int64_t block_offset_48163 = block_base_offset_48161 + i_48162 * segred_tblock_sizze_44039;\n        \n        gtid_44046 = phys_tid_44047 + num_threads_48132 * i_48162;\n        if (slt64(gtid_44046, n_36875)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int64_t x_38736 = ((__global int64_t *) ks_mem_47844)[gtid_44046];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_38737 = eta_p_block_res_acc_48145;\n                        eta_p_38738 = eta_p_block_res_acc_48146;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_38739 = gtid_44046;\n                        eta_p_38740 = x_38736;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_lt_res_38741 = slt64(eta_p_38738, eta_p_38740);\n                        bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                        bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                        bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                        bool x_43573 = !defunc_0_lt_res_38741;\n                        bool y_43574 = x_38745 && x_43573;\n                        bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                        int64_t defunc_0_op_res_38746;\n                        \n                        if (cond_38742) {\n                            defu", "nc_0_op_res_38746 = eta_p_38737;\n                        } else {\n                            defunc_0_op_res_38746 = eta_p_38739;\n                        }\n                        \n                        int64_t defunc_0_op_res_38747;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38747 = eta_p_38738;\n                        } else {\n                            defunc_0_op_res_38747 = eta_p_38740;\n                        }\n                        // store in accumulator(s)\n                        {\n                            eta_p_block_res_acc_48145 = defunc_0_op_res_38746;\n                            eta_p_block_res_acc_48146 = defunc_0_op_res_38747;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48145;\n        ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48146;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_48165 = 1;\n    offset_48164 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44039))) {\n            eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            eta_p_48148 = ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n        }\n    }\n    offset_48164 = 1;\n    while (slt32(offset_48164, wave_sizze_48136)) {\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44039)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48164 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_48149 =",
                                    " ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((volatile __local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt64(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int64_t defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((volatile __local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        offset_48164 *= 2;\n    }\n    while (slt32(skip_waves_48165, squot32(sext_i64_i32(segred_tblock_sizze_44039) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_48164 = skip_waves_48165 * wave_sizze_48136;\n", "        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44039)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48165 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt64(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int64_t defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_ti", "d_48134)] = eta_p_48148;\n            }\n        }\n        skip_waves_48165 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_48134) == (int64_t) 0) {\n            eta_p_block_res_acc_48145 = eta_p_48147;\n            eta_p_block_res_acc_48146 = eta_p_48148;\n        } else {\n            eta_p_block_res_acc_48145 = n_36875;\n            eta_p_block_res_acc_48146 = (int64_t) 9223372036854775807;\n        }\n    }\n    // first thread in block saves block result to global memory\n    {\n        if (local_tid_48134 == 0) {\n            ((__global int64_t *) segred_tmp_mem_48128)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48145;\n            mem_fence_global();\n            ((__global int64_t *) segred_tmp_mem_48130)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48146;\n            mem_fence_global();\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_48142)[(int64_t) 0] = old_counter_48166 == sext_i64_i32(num_tblocks_44041 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_48167 = ((__local bool *) sync_arr_mem_48142)[(int64_t) 0];\n    if (is_last_block_48167) {\n        if (local_tid_48134 == 0) {\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_44041));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_48168 = sdiv_up64(num_tblocks_44041, segred_tblock_sizze_44039);\n            \n            eta_p_38737 = n_36875;\n            eta_p_38738 = (int64_t) 9223372036854775807;\n            for (int64_t i_48169 = 0; i_48169 < read_per_thread_48168; i_48169++) {\n                int64_t block_res_id_48170 = sext_i32_i64(local",
                                    "_tid_48134) * read_per_thread_48168 + i_48169;\n                int64_t index_of_block_res_48171 = block_res_id_48170;\n                \n                if (slt64(block_res_id_48170, num_tblocks_44041)) {\n                    eta_p_38739 = ((__global int64_t *) segred_tmp_mem_48128)[index_of_block_res_48171];\n                    eta_p_38740 = ((__global int64_t *) segred_tmp_mem_48130)[index_of_block_res_48171];\n                    \n                    bool defunc_0_lt_res_38741 = slt64(eta_p_38738, eta_p_38740);\n                    bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                    bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                    bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                    bool x_43573 = !defunc_0_lt_res_38741;\n                    bool y_43574 = x_38745 && x_43573;\n                    bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                    int64_t defunc_0_op_res_38746;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38746 = eta_p_38737;\n                    } else {\n                        defunc_0_op_res_38746 = eta_p_38739;\n                    }\n                    \n                    int64_t defunc_0_op_res_38747;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38747 = eta_p_38738;\n                    } else {\n                        defunc_0_op_res_38747 = eta_p_38740;\n                    }\n                    eta_p_38737 = defunc_0_op_res_38746;\n                    eta_p_38738 = defunc_0_op_res_38747;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_38737;\n        ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_38738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_", "48172;\n            int32_t skip_waves_48173 = 1;\n            int64_t eta_p_48147;\n            int64_t eta_p_48148;\n            int64_t eta_p_48149;\n            int64_t eta_p_48150;\n            \n            offset_48172 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44039))) {\n                    eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    eta_p_48148 = ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                }\n            }\n            offset_48172 = 1;\n            while (slt32(offset_48172, wave_sizze_48136)) {\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44039)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48172 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((volatile __local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt64(eta_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_4", "8158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int64_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((volatile __local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                offset_48172 *= 2;\n            }\n            while (slt32(skip_waves_48173, squot32(sext_i64_i32(segred_tblock_sizze_44039) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_48172 = skip_waves_48173 * wave_sizze_48136;\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44039)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48173 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n   ",
                                    "                 }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt64(eta_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int64_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((__local int64_t *) red_arr_i64_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                skip_waves_48173 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_48134 == 0) {\n                    ((__global ", "int64_t *) mem_47846)[(int64_t) 0] = eta_p_48147;\n                    ((__global int64_t *) mem_47847)[(int64_t) 0] = eta_p_48148;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_44039\n    #undef chunk_sizze_48105\n}\nFUTHARK_KERNEL_SIZED(argmin_shortzisegred_nonseg_44025_dim1, 1, 1)\nvoid argmin_shortzisegred_nonseg_44025(__global int *global_failure, int64_t n_36543, int64_t num_tblocks_44019, int64_t num_threads_48132, __global unsigned char *ks_mem_47844, __global unsigned char *mem_47846, __global unsigned char *mem_47847, __global unsigned char *counters_mem_48106, __global unsigned char *segred_tmp_mem_48128, __global unsigned char *segred_tmp_mem_48130)\n{\n    #define segred_tblock_sizze_44017 (argmin_shortzisegred_nonseg_44025zisegred_tblock_sizze_44017)\n    #define chunk_sizze_48105 (argmin_shortzisegred_nonseg_44025zichunk_sizze_48105)\n    \n    volatile __local unsigned char *sync_arr_mem_48142_backing_2 = &shared_mem[0];\n    const int64_t sync_arr_mem_48142_backing_2_offset = 0 + 8;\n    volatile __local unsigned char *red_arr_i16_mem_48140_backing_1 = &shared_mem[sync_arr_mem_48142_backing_2_offset];\n    const int64_t red_arr_i16_mem_48140_backing_1_offset = sync_arr_mem_48142_backing_2_offset + ((int64_t) 2 * segred_tblock_sizze_44017 + srem64((int64_t) 8 - srem64((int64_t) 2 * segred_tblock_sizze_44017, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *red_arr_i64_mem_48138_backing_0 = &shared_mem[red_arr_i16_mem_48140_backing_1_offset];\n    const int64_t red_arr_i64_mem_48138_backing_0_offset = red_arr_i16_mem_48140_backing_1_offset + ((int64_t) 8 * segred_tblock_sizze_44017 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44017, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48134;\n    int32_t tblock_sizze_48137;\n    int32_t wave_sizze_48136;\n    int32_t block_id_48135;\n    int32_t global_tid_48133;\n    int6", "4_t phys_tid_44025;\n    __local unsigned char *red_arr_i64_mem_48138;\n    __local unsigned char *red_arr_i16_mem_48140;\n    __local unsigned char *sync_arr_mem_48142;\n    int64_t dummy_44023;\n    int64_t gtid_44024;\n    int64_t q_48144;\n    int64_t eta_p_block_res_acc_48145;\n    int16_t eta_p_block_res_acc_48146;\n    int64_t eta_p_38737;\n    int16_t eta_p_38738;\n    int64_t eta_p_38739;\n    int16_t eta_p_38740;\n    int64_t tblock_id_in_segment_48160;\n    int64_t block_base_offset_48161;\n    int32_t offset_48164;\n    int32_t skip_waves_48165;\n    int64_t eta_p_48147;\n    int16_t eta_p_48148;\n    int64_t eta_p_48149;\n    int16_t eta_p_48150;\n    int32_t old_counter_48166;\n    bool is_last_block_48167;\n    \n    local_tid_48134 = get_local_id(0);\n    tblock_sizze_48137 = get_local_size(0);\n    wave_sizze_48136 = LOCKSTEP_WIDTH;\n    block_id_48135 = get_tblock_id(0);\n    global_tid_48133 = block_id_48135 * tblock_sizze_48137 + local_tid_48134;\n    phys_tid_44025 = sext_i32_i64(global_tid_48133);\n    red_arr_i64_mem_48138 = (__local unsigned char *) red_arr_i64_mem_48138_backing_0;\n    red_arr_i16_mem_48140 = (__local unsigned char *) red_arr_i16_mem_48140_backing_1;\n    sync_arr_mem_48142 = (__local unsigned char *) sync_arr_mem_48142_backing_2;\n    dummy_44023 = (int64_t) 0;\n    gtid_44024 = (int64_t) 0;\n    q_48144 = sdiv_up64(n_36543, sext_i32_i64(sext_i64_i32(segred_tblock_sizze_44017 * num_tblocks_44019)) * chunk_sizze_48105);\n    // ne-initialise the outer (per-block) accumulator(s)\n    {\n        eta_p_block_res_acc_48145 = n_36543;\n        eta_p_block_res_acc_48146 = (int16_t) 32767;\n    }\n    tblock_id_in_segment_48160 = squot64(phys_tid_44025, segred_tblock_sizze_44017);\n    block_base_offset_48161 = tblock_id_in_segment_48160 * q_48144 * segred_tblock_sizze_44017;\n    for (int64_t i_48162 = 0; i_48162 < q_48144; i_48162++) {\n        int64_t block_offset_48163 = block_base_offset_48161 + i_48162 * segred_tblock_sizze_44017;\n        \n        gtid_44024 = phys_tid",
                                    "_44025 + num_threads_48132 * i_48162;\n        if (slt64(gtid_44024, n_36543)) {\n            // apply map function(s)\n            {\n                // apply map function\n                {\n                    int16_t x_38736 = ((__global int16_t *) ks_mem_47844)[gtid_44024];\n                    \n                    // load accumulator(s)\n                    {\n                        eta_p_38737 = eta_p_block_res_acc_48145;\n                        eta_p_38738 = eta_p_block_res_acc_48146;\n                    }\n                    // load next value(s)\n                    {\n                        eta_p_38739 = gtid_44024;\n                        eta_p_38740 = x_38736;\n                    }\n                    // apply reduction operator(s)\n                    {\n                        bool defunc_0_lt_res_38741 = slt16(eta_p_38738, eta_p_38740);\n                        bool defunc_0_eq_res_38743 = eta_p_38738 == eta_p_38740;\n                        bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                        bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                        bool x_43573 = !defunc_0_lt_res_38741;\n                        bool y_43574 = x_38745 && x_43573;\n                        bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                        int64_t defunc_0_op_res_38746;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38746 = eta_p_38737;\n                        } else {\n                            defunc_0_op_res_38746 = eta_p_38739;\n                        }\n                        \n                        int16_t defunc_0_op_res_38747;\n                        \n                        if (cond_38742) {\n                            defunc_0_op_res_38747 = eta_p_38738;\n                        } else {\n                            defunc_0_op_res_38747 = eta_p_38740;\n                        }\n                        // store in accumulat", "or(s)\n                        {\n                            eta_p_block_res_acc_48145 = defunc_0_op_res_38746;\n                            eta_p_block_res_acc_48146 = defunc_0_op_res_38747;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // store accs. prims go in lmem; non-prims in params (in global mem)\n    {\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48145;\n        ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_block_res_acc_48146;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    skip_waves_48165 = 1;\n    offset_48164 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44017))) {\n            eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            eta_p_48148 = ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n        }\n    }\n    offset_48164 = 1;\n    while (slt32(offset_48164, wave_sizze_48136)) {\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44017)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48164 - 1)) == 0) {\n            // read array element\n            {\n                eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((volatile __local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt16(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n        ", "        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int16_t defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((volatile __local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        offset_48164 *= 2;\n    }\n    while (slt32(skip_waves_48165, squot32(sext_i64_i32(segred_tblock_sizze_44017) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_48164 = skip_waves_48165 * wave_sizze_48136;\n        if (slt32(local_tid_48134 + offset_48164, sext_i64_i32(segred_tblock_sizze_44017)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48165 - 1)) == 0)) {\n            // read array element\n            {\n                eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48164)];\n                eta_p_48150 = ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_4813",
                                    "4 + offset_48164)];\n            }\n            // apply reduction operation\n            {\n                bool defunc_0_lt_res_48151 = slt16(eta_p_48148, eta_p_48150);\n                bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                bool x_48155 = !defunc_0_lt_res_48151;\n                bool y_48156 = x_48154 && x_48155;\n                bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                int64_t defunc_0_op_res_48158;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48158 = eta_p_48147;\n                } else {\n                    defunc_0_op_res_48158 = eta_p_48149;\n                }\n                \n                int16_t defunc_0_op_res_48159;\n                \n                if (cond_48157) {\n                    defunc_0_op_res_48159 = eta_p_48148;\n                } else {\n                    defunc_0_op_res_48159 = eta_p_48150;\n                }\n                eta_p_48147 = defunc_0_op_res_48158;\n                eta_p_48148 = defunc_0_op_res_48159;\n            }\n            // write result of operation\n            {\n                ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n            }\n        }\n        skip_waves_48165 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // thread 0 updates per-block acc(s); rest reset to ne\n    {\n        if (sext_i32_i64(local_tid_48134) == (int64_t) 0) {\n            eta_p_block_res_acc_48145 = eta_p_48147;\n            eta_p_block_res_acc_48146 = eta_p_48148;\n        } else {\n            eta_p_block_res_acc_48145 = n_36543;\n            eta_p_block_res_acc_48146 = (int16_t) 32767;\n        }\n    }\n    // first t", "hread in block saves block result to global memory\n    {\n        if (local_tid_48134 == 0) {\n            ((__global int64_t *) segred_tmp_mem_48128)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48145;\n            mem_fence_global();\n            ((__global int16_t *) segred_tmp_mem_48130)[sext_i32_i64(block_id_48135)] = eta_p_block_res_acc_48146;\n            mem_fence_global();\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) 1);\n            ((__local bool *) sync_arr_mem_48142)[(int64_t) 0] = old_counter_48166 == sext_i64_i32(num_tblocks_44019 - (int64_t) 1);\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    is_last_block_48167 = ((__local bool *) sync_arr_mem_48142)[(int64_t) 0];\n    if (is_last_block_48167) {\n        if (local_tid_48134 == 0) {\n            old_counter_48166 = atomic_add_i32_global(&((volatile __global int *) counters_mem_48106)[(int64_t) 0], (int) sext_i64_i32((int64_t) 0 - num_tblocks_44019));\n        }\n        // read in the per-block-results\n        {\n            int64_t read_per_thread_48168 = sdiv_up64(num_tblocks_44019, segred_tblock_sizze_44017);\n            \n            eta_p_38737 = n_36543;\n            eta_p_38738 = (int16_t) 32767;\n            for (int64_t i_48169 = 0; i_48169 < read_per_thread_48168; i_48169++) {\n                int64_t block_res_id_48170 = sext_i32_i64(local_tid_48134) * read_per_thread_48168 + i_48169;\n                int64_t index_of_block_res_48171 = block_res_id_48170;\n                \n                if (slt64(block_res_id_48170, num_tblocks_44019)) {\n                    eta_p_38739 = ((__global int64_t *) segred_tmp_mem_48128)[index_of_block_res_48171];\n                    eta_p_38740 = ((__global int16_t *) segred_tmp_mem_48130)[index_of_block_res_48171];\n                    \n                    bool defunc_0_lt_res_38741 = slt16(eta_p_38738, eta_p_38740);\n                    bool defunc_0_eq_res_38743 = e", "ta_p_38738 == eta_p_38740;\n                    bool cond_f_res_t_res_38744 = slt64(eta_p_38737, eta_p_38739);\n                    bool x_38745 = defunc_0_eq_res_38743 && cond_f_res_t_res_38744;\n                    bool x_43573 = !defunc_0_lt_res_38741;\n                    bool y_43574 = x_38745 && x_43573;\n                    bool cond_38742 = defunc_0_lt_res_38741 || y_43574;\n                    int64_t defunc_0_op_res_38746;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38746 = eta_p_38737;\n                    } else {\n                        defunc_0_op_res_38746 = eta_p_38739;\n                    }\n                    \n                    int16_t defunc_0_op_res_38747;\n                    \n                    if (cond_38742) {\n                        defunc_0_op_res_38747 = eta_p_38738;\n                    } else {\n                        defunc_0_op_res_38747 = eta_p_38740;\n                    }\n                    eta_p_38737 = defunc_0_op_res_38746;\n                    eta_p_38738 = defunc_0_op_res_38747;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_38737;\n        ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_38738;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-block results\n        {\n            int32_t offset_48172;\n            int32_t skip_waves_48173 = 1;\n            int64_t eta_p_48147;\n            int16_t eta_p_48148;\n            int64_t eta_p_48149;\n            int16_t eta_p_48150;\n            \n            offset_48172 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_48134, sext_i64_i32(segred_tblock_sizze_44017))) {\n                    eta_p_48147 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    eta_p_48148 = ((__local int16_t *)",
                                    " red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                }\n            }\n            offset_48172 = 1;\n            while (slt32(offset_48172, wave_sizze_48136)) {\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44017)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) & (2 * offset_48172 - 1)) == 0) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((volatile __local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt16(eta_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n                        bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int16_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_4", "8150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((volatile __local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                offset_48172 *= 2;\n            }\n            while (slt32(skip_waves_48173, squot32(sext_i64_i32(segred_tblock_sizze_44017) + wave_sizze_48136 - 1, wave_sizze_48136))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_48172 = skip_waves_48173 * wave_sizze_48136;\n                if (slt32(local_tid_48134 + offset_48172, sext_i64_i32(segred_tblock_sizze_44017)) && ((local_tid_48134 - squot32(local_tid_48134, wave_sizze_48136) * wave_sizze_48136) == 0 && (squot32(local_tid_48134, wave_sizze_48136) & (2 * skip_waves_48173 - 1)) == 0)) {\n                    // read array element\n                    {\n                        eta_p_48149 = ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                        eta_p_48150 = ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134 + offset_48172)];\n                    }\n                    // apply reduction operation\n                    {\n                        bool defunc_0_lt_res_48151 = slt16(eta_p_48148, eta_p_48150);\n                        bool defunc_0_eq_res_48152 = eta_p_48148 == eta_p_48150;\n                        bool cond_f_res_t_res_48153 = slt64(eta_p_48147, eta_p_48149);\n                        bool x_48154 = defunc_0_eq_res_48152 && cond_f_res_t_res_48153;\n                        bool x_48155 = !defunc_0_lt_res_48151;\n                        bool y_48156 = x_48154 && x_48155;\n            ", "            bool cond_48157 = defunc_0_lt_res_48151 || y_48156;\n                        int64_t defunc_0_op_res_48158;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48158 = eta_p_48147;\n                        } else {\n                            defunc_0_op_res_48158 = eta_p_48149;\n                        }\n                        \n                        int16_t defunc_0_op_res_48159;\n                        \n                        if (cond_48157) {\n                            defunc_0_op_res_48159 = eta_p_48148;\n                        } else {\n                            defunc_0_op_res_48159 = eta_p_48150;\n                        }\n                        eta_p_48147 = defunc_0_op_res_48158;\n                        eta_p_48148 = defunc_0_op_res_48159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local int64_t *) red_arr_i64_mem_48138)[sext_i32_i64(local_tid_48134)] = eta_p_48147;\n                        ((__local int16_t *) red_arr_i16_mem_48140)[sext_i32_i64(local_tid_48134)] = eta_p_48148;\n                    }\n                }\n                skip_waves_48173 *= 2;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // and back to memory with the final result\n            {\n                if (local_tid_48134 == 0) {\n                    ((__global int64_t *) mem_47846)[(int64_t) 0] = eta_p_48147;\n                    ((__global int16_t *) mem_47847)[(int64_t) 0] = eta_p_48148;\n                }\n            }\n        }\n    }\n    \n  error_5:\n    return;\n    #undef segred_tblock_sizze_44017\n    #undef chunk_sizze_48105\n}\nFUTHARK_KERNEL\nvoid builtinzhiota_i64ziiota_i64_48110(int64_t n_48106, int64_t x_48107, int64_t s_48108, int64_t virt_num_tblocks_48115, int64_t num_tblocks_48116, __global unsigned char *mem_48105)\n{\n    int32_t iota_ltid_48111;\n    int32_t tblock_sizze_48113;\n    int32_t iota_gid_48112;\n ",
                                    "   int32_t iota_gtid_48110;\n    int32_t phys_tblock_id_48117;\n    int32_t iterations_48118;\n    \n    iota_ltid_48111 = get_local_id(0);\n    tblock_sizze_48113 = get_local_size(0);\n    iota_gid_48112 = get_tblock_id(0);\n    iota_gtid_48110 = iota_gid_48112 * tblock_sizze_48113 + iota_ltid_48111;\n    phys_tblock_id_48117 = get_tblock_id(0);\n    iterations_48118 = sdiv_up32(sext_i64_i32(virt_num_tblocks_48115) - phys_tblock_id_48117, sext_i64_i32(num_tblocks_48116));\n    for (int32_t i_48119 = 0; i_48119 < iterations_48118; i_48119++) {\n        int32_t virt_tblock_id_48120;\n        int64_t global_tid_48121;\n        \n        virt_tblock_id_48120 = phys_tblock_id_48117 + i_48119 * sext_i64_i32(num_tblocks_48116);\n        global_tid_48121 = sext_i32_i64(virt_tblock_id_48120) * sext_i32_i64(tblock_sizze_48113) + sext_i32_i64(iota_ltid_48111);\n        if (slt64(global_tid_48121, n_48106)) {\n            ((__global int64_t *) mem_48105)[global_tid_48121] = add64(mul64(global_tid_48121, s_48108), x_48107);\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i16zireplicate_48431(int64_t num_elems_48427, int16_t val_48428, int64_t replicate_n_48430, int64_t virt_num_tblocks_48436, int64_t num_tblocks_48437, __global unsigned char *mem_48426)\n{\n    int32_t replicate_ltid_48432;\n    int32_t tblock_sizze_48434;\n    int32_t replicate_gid_48433;\n    int32_t replicate_gtid_48431;\n    int32_t phys_tblock_id_48438;\n    int32_t iterations_48439;\n    \n    replicate_ltid_48432 = get_local_id(0);\n    tblock_sizze_48434 = get_local_size(0);\n    replicate_gid_48433 = get_tblock_id(0);\n    replicate_gtid_48431 = replicate_gid_48433 * tblock_sizze_48434 + replicate_ltid_48432;\n    phys_tblock_id_48438 = get_tblock_id(0);\n    iterations_48439 = sdiv_up32(sext_i64_i32(virt_num_tblocks_48436) - phys_tblock_id_48438, sext_i64_i32(num_tblocks_48437));\n    for (int32_t i_48440 = 0; i_48440 < iterations_48439", "; i_48440++) {\n        int32_t virt_tblock_id_48441;\n        int64_t global_tid_48442;\n        int64_t slice_48444;\n        int64_t rep_i_48443;\n        int64_t remnant_48445;\n        \n        virt_tblock_id_48441 = phys_tblock_id_48438 + i_48440 * sext_i64_i32(num_tblocks_48437);\n        global_tid_48442 = sext_i32_i64(virt_tblock_id_48441) * sext_i32_i64(tblock_sizze_48434) + sext_i32_i64(replicate_ltid_48432);\n        slice_48444 = num_elems_48427;\n        rep_i_48443 = global_tid_48442;\n        remnant_48445 = global_tid_48442 - rep_i_48443;\n        if (slt64(global_tid_48442, replicate_n_48430)) {\n            ((__global int16_t *) mem_48426)[rep_i_48443] = val_48428;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i32zireplicate_48186(int64_t num_elems_48182, int32_t val_48183, int64_t replicate_n_48185, int64_t virt_num_tblocks_48191, int64_t num_tblocks_48192, __global unsigned char *mem_48181)\n{\n    int32_t replicate_ltid_48187;\n    int32_t tblock_sizze_48189;\n    int32_t replicate_gid_48188;\n    int32_t replicate_gtid_48186;\n    int32_t phys_tblock_id_48193;\n    int32_t iterations_48194;\n    \n    replicate_ltid_48187 = get_local_id(0);\n    tblock_sizze_48189 = get_local_size(0);\n    replicate_gid_48188 = get_tblock_id(0);\n    replicate_gtid_48186 = replicate_gid_48188 * tblock_sizze_48189 + replicate_ltid_48187;\n    phys_tblock_id_48193 = get_tblock_id(0);\n    iterations_48194 = sdiv_up32(sext_i64_i32(virt_num_tblocks_48191) - phys_tblock_id_48193, sext_i64_i32(num_tblocks_48192));\n    for (int32_t i_48195 = 0; i_48195 < iterations_48194; i_48195++) {\n        int32_t virt_tblock_id_48196;\n        int64_t global_tid_48197;\n        int64_t slice_48199;\n        int64_t rep_i_48198;\n        int64_t remnant_48200;\n        \n        virt_tblock_id_48196 = phys_tblock_id_48193 + i_48195 * sext_i64_i32(num_tblocks_48192);\n        global_tid_48197 = sext_i32_i64(virt_tbl", "ock_id_48196) * sext_i32_i64(tblock_sizze_48189) + sext_i32_i64(replicate_ltid_48187);\n        slice_48199 = num_elems_48182;\n        rep_i_48198 = global_tid_48197;\n        remnant_48200 = global_tid_48197 - rep_i_48198;\n        if (slt64(global_tid_48197, replicate_n_48185)) {\n            ((__global int32_t *) mem_48181)[rep_i_48198] = val_48183;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL\nvoid builtinzhreplicate_i8zireplicate_48148(int64_t num_elems_48144, int8_t val_48145, int64_t replicate_n_48147, int64_t virt_num_tblocks_48153, int64_t num_tblocks_48154, __global unsigned char *mem_48143)\n{\n    int32_t replicate_ltid_48149;\n    int32_t tblock_sizze_48151;\n    int32_t replicate_gid_48150;\n    int32_t replicate_gtid_48148;\n    int32_t phys_tblock_id_48155;\n    int32_t iterations_48156;\n    \n    replicate_ltid_48149 = get_local_id(0);\n    tblock_sizze_48151 = get_local_size(0);\n    replicate_gid_48150 = get_tblock_id(0);\n    replicate_gtid_48148 = replicate_gid_48150 * tblock_sizze_48151 + replicate_ltid_48149;\n    phys_tblock_id_48155 = get_tblock_id(0);\n    iterations_48156 = sdiv_up32(sext_i64_i32(virt_num_tblocks_48153) - phys_tblock_id_48155, sext_i64_i32(num_tblocks_48154));\n    for (int32_t i_48157 = 0; i_48157 < iterations_48156; i_48157++) {\n        int32_t virt_tblock_id_48158;\n        int64_t global_tid_48159;\n        int64_t slice_48161;\n        int64_t rep_i_48160;\n        int64_t remnant_48162;\n        \n        virt_tblock_id_48158 = phys_tblock_id_48155 + i_48157 * sext_i64_i32(num_tblocks_48154);\n        global_tid_48159 = sext_i32_i64(virt_tblock_id_48158) * sext_i32_i64(tblock_sizze_48151) + sext_i32_i64(replicate_ltid_48149);\n        slice_48161 = num_elems_48144;\n        rep_i_48160 = global_tid_48159;\n        remnant_48162 = global_tid_48159 - rep_i_48160;\n        if (slt64(global_tid_48159, replicate_n_48147)) {\n            ((__global int8_t *) mem_48143)[rep_i_48",
                                    "160] = val_48145;\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n}\nFUTHARK_KERNEL_SIZED(mergeFunczisegmap_intrablock_46987_dim1, 1, 1)\nvoid mergeFunczisegmap_intrablock_46987(__global int *global_failure, int64_t w1_37999, int64_t w2_38000, int64_t ldim_46990, int64_t num_whole_tiles_47004, int64_t residual_input_47258, unsigned char cond_47259_bits, int64_t binop_x_47275, __global unsigned char *xs_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47977, __global unsigned char *mem_47979, __global unsigned char *mem_47981)\n{\n    bool cond_47259 = cond_47259_bits;\n    \n    #define tile_sizze_46989 (mergeFunczisegmap_intrablock_46987zitile_sizze_46989)\n    #define bytes_47934 (mergeFunczisegmap_intrablock_46987zibytes_47934)\n    #define bytes_47936 (mergeFunczisegmap_intrablock_46987zibytes_47936)\n    \n    volatile __local unsigned char *color_48096_backing_2 = &shared_mem[0];\n    const int64_t color_48096_backing_2_offset = 0 + (bytes_47934 + srem64((int64_t) 8 - srem64(bytes_47934, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48095_backing_1 = &shared_mem[color_48096_backing_2_offset];\n    const int64_t color_48095_backing_1_offset = color_48096_backing_2_offset + (bytes_47936 + srem64((int64_t) 8 - srem64(bytes_47936, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48094_backing_0 = &shared_mem[color_48095_backing_1_offset];\n    const int64_t color_48094_backing_0_offset = color_48095_backing_1_offset + (bytes_47934 + srem64((int64_t) 8 - srem64(bytes_47934, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48109;\n    int32_t tblock_sizze_48112;\n    int32_t wave_sizze_48111;\n    int32_t block_id_48110;\n    int32_t global_tid_48108;\n    int64_t gid_flat_46987;\n    int64_t slice_48114;\n    int64_t ltid_pre_48113;\n    int64_t remnant_48115;\n    int64_t slice_48116;\n    int64_t gi", "d_46986;\n    int64_t remnant_48117;\n    __local unsigned char *color_48094;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    int64_t binop_x_46997;\n    int32_t mem_47918[1];\n    int64_t ltid_flat_46992;\n    int64_t ltid_46991;\n    int64_t gtid_46998;\n    bool cond_46999;\n    int32_t pre_47000;\n    int64_t mem_47922[1];\n    int32_t mem_47926[1];\n    int64_t mem_47930[1];\n    int64_t ltid_flat_47006;\n    int64_t ltid_47005;\n    int64_t gtid_47016;\n    bool cond_47017;\n    int64_t neutral_47018;\n    int32_t neutral_47019;\n    int64_t ext_mem_47954[1];\n    int32_t ext_mem_47953[1];\n    int64_t ext_mem_47952[1];\n    int64_t mem_param_47931[1];\n    int32_t mem_param_47932[1];\n    int64_t mem_param_47933[1];\n    int64_t mem_47964[1];\n    int32_t mem_47968[1];\n    int64_t mem_47972[1];\n    int64_t ext_mem_47975[1];\n    int32_t ext_mem_47974[1];\n    int64_t ext_mem_47973[1];\n    \n    local_tid_48109 = get_local_id(0);\n    tblock_sizze_48112 = get_local_size(0);\n    wave_sizze_48111 = LOCKSTEP_WIDTH;\n    block_id_48110 = get_tblock_id(0);\n    global_tid_48108 = block_id_48110 * tblock_sizze_48112 + local_tid_48109;\n    gid_flat_46987 = sext_i32_i64(block_id_48110);\n    slice_48114 = tile_sizze_46989;\n    ltid_pre_48113 = sext_i32_i64(local_tid_48109);\n    remnant_48115 = sext_i32_i64(local_tid_48109) - ltid_pre_48113;\n    slice_48116 = ldim_46990;\n    gid_46986 = sext_i32_i64(block_id_48110);\n    remnant_48117 = sext_i32_i64(block_id_48110) - gid_46986;\n    color_48094 = (__local unsigned char *) color_48094_backing_0;\n    color_48095 = (__local unsigned char *) color_48095_backing_1;\n    color_48096 = (__local unsigned char *) color_48096_backing_2;\n    binop_x_46997 = gid_46986 * tile_sizze_46989;\n    ltid_flat_46992 = sext_i32_i64(local_tid_48109);\n    ltid_46991 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n    gtid_46998 = ltid_46991 + binop_x_46997;\n    cond_46999 = slt64(gtid_46998, w1_37999);\n    if (cond_46999) {\n        int32_t eta", "_p_47001 = ((__global int32_t *) xs_mem_47844)[gtid_46998];\n        \n        pre_47000 = eta_p_47001;\n    } else {\n        pre_47000 = 0;\n    }\n    mem_47918[(int64_t) 0] = pre_47000;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_47006 = sext_i32_i64(local_tid_48109);\n    ltid_47005 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n    gtid_47016 = binop_x_46997 + ltid_47005;\n    cond_47017 = slt64(gtid_47016, w1_37999);\n    if (cond_47017) {\n        neutral_47018 = w2_38000;\n    } else {\n        neutral_47018 = (int64_t) 0;\n    }\n    if (cond_47017) {\n        int32_t eta_p_47021 = mem_47918[(int64_t) 0];\n        \n        neutral_47019 = eta_p_47021;\n    } else {\n        neutral_47019 = 0;\n    }\n    mem_47922[(int64_t) 0] = neutral_47018;\n    mem_47926[(int64_t) 0] = neutral_47019;\n    mem_47930[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_47931[i_3] = mem_47922[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_47932[i_4] = mem_47926[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_47933[i_5] = mem_47930[i_5];\n    for (int64_t tile_id_47031 = 0; tile_id_47031 < num_whole_tiles_47004; tile_id_47031++) {\n        int64_t binop_x_47140;\n        int64_t ltid_flat_47139;\n        int64_t ltid_47138;\n        int64_t j_47141;\n        bool cond_47145;\n        int64_t pre1d_47148;\n        int64_t pre1d_47146;\n        int32_t pre1d_47147;\n        int64_t mem_47943[1];\n        int32_t mem_47947[1];\n        int64_t mem_47951[1];\n        int64_t ltid_flat_47159;\n        int64_t ltid_47158;\n        int64_t gtid_47161;\n        int64_t acc_47163;\n        int32_t acc_47164;\n        int64_t acc_47165;\n        bool cond_47166;\n        int64_t acc_47167;\n        int32_t acc_47168;\n        int64_t acc_47169;\n        int64_t mem_param_tmp_48118[1];\n        int32_t mem_param_tmp_48119[1];\n        int64_t mem_param_tmp_48120[1];\n        \n        binop_",
                                    "x_47140 = tile_sizze_46989 * tile_id_47031;\n        ltid_flat_47139 = sext_i32_i64(local_tid_48109);\n        ltid_47138 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n        j_47141 = ltid_47138 + binop_x_47140;\n        cond_47145 = slt64(j_47141, w2_38000);\n        pre1d_47148 = btoi_bool_i64(cond_47145);\n        if (cond_47145) {\n            pre1d_47146 = j_47141;\n        } else {\n            pre1d_47146 = (int64_t) 0;\n        }\n        if (cond_47145) {\n            int32_t tile_elem_47150 = ((__global int32_t *) ys_mem_47845)[j_47141];\n            \n            pre1d_47147 = tile_elem_47150;\n        } else {\n            pre1d_47147 = 0;\n        }\n        ((__local int64_t *) color_48096)[ltid_47138] = pre1d_47146;\n        ((__local int32_t *) color_48095)[ltid_47138] = pre1d_47147;\n        ((__local int64_t *) color_48094)[ltid_47138] = pre1d_47148;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_47159 = sext_i32_i64(local_tid_48109);\n        ltid_47158 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n        gtid_47161 = binop_x_46997 + ltid_47158;\n        acc_47163 = mem_param_47931[(int64_t) 0];\n        acc_47164 = mem_param_47932[(int64_t) 0];\n        acc_47165 = mem_param_47933[(int64_t) 0];\n        cond_47166 = slt64(gtid_47161, w1_37999);\n        if (cond_47166) {\n            int32_t eta_p_47162;\n            int64_t x_47170;\n            int32_t x_47171;\n            int64_t x_47172;\n            int64_t redout_47790;\n            int32_t redout_47791;\n            int64_t redout_47792;\n            \n            eta_p_47162 = mem_47918[(int64_t) 0];\n            redout_47790 = acc_47163;\n            redout_47791 = acc_47164;\n            redout_47792 = acc_47165;\n            for (int64_t i_47793 = 0; i_47793 < tile_sizze_46989; i_47793++) {\n                int64_t x_47173;\n                int32_t x_47174;\n                bool cond_47182;\n                bool cond_47183;\n                bool cond_f_res_47184;\n                bool y_47185;\n                bool c", "ond_47186;\n                bool cond_47187;\n                bool cond_47188;\n                bool cond_t_res_f_res_47189;\n                bool y_47190;\n                bool cond_t_res_47191;\n                bool x_47192;\n                int64_t lifted_lambda_res_47193;\n                int32_t lifted_lambda_res_47194;\n                int64_t lifted_lambda_res_47195;\n                int64_t redout_tmp_48124;\n                int32_t redout_tmp_48125;\n                int64_t redout_tmp_48126;\n                \n                x_47173 = ((__local int64_t *) color_48096)[i_47793];\n                x_47174 = ((__local int32_t *) color_48095)[i_47793];\n                cond_47182 = redout_47791 == eta_p_47162;\n                cond_47183 = !cond_47182;\n                cond_f_res_47184 = sle64(w2_38000, redout_47790);\n                y_47185 = cond_47182 && cond_f_res_47184;\n                cond_47186 = cond_47183 || y_47185;\n                cond_47187 = x_47174 == eta_p_47162;\n                cond_47188 = !cond_47187;\n                cond_t_res_f_res_47189 = sle64(w2_38000, x_47173);\n                y_47190 = cond_47187 && cond_t_res_f_res_47189;\n                cond_t_res_47191 = cond_47188 || y_47190;\n                x_47192 = cond_47186 && cond_t_res_47191;\n                if (x_47192) {\n                    lifted_lambda_res_47193 = w2_38000;\n                    lifted_lambda_res_47194 = eta_p_47162;\n                    lifted_lambda_res_47195 = (int64_t) 0;\n                } else {\n                    int64_t x_47175;\n                    bool x_47196;\n                    bool y_47197;\n                    bool cond_47198;\n                    int64_t lifted_lambda_res_f_res_47199;\n                    int32_t lifted_lambda_res_f_res_47200;\n                    int64_t lifted_lambda_res_f_res_47201;\n                    \n                    x_47175 = ((__local int64_t *) color_48094)[i_47793];\n                    x_47196 = !cond_f_res_47184;\n                    y_47197 = cond_471", "83 && x_47196;\n                    cond_47198 = cond_f_res_47184 || y_47197;\n                    if (cond_47198) {\n                        lifted_lambda_res_f_res_47199 = x_47173;\n                        lifted_lambda_res_f_res_47200 = x_47174;\n                        lifted_lambda_res_f_res_47201 = x_47175;\n                    } else {\n                        bool x_47202;\n                        bool y_47203;\n                        bool cond_47204;\n                        int32_t lifted_lambda_res_f_res_f_res_47205;\n                        int64_t lifted_lambda_res_f_res_f_res_47206;\n                        int64_t lifted_lambda_res_f_res_f_res_47207;\n                        \n                        x_47202 = !cond_t_res_f_res_47189;\n                        y_47203 = cond_47188 && x_47202;\n                        cond_47204 = cond_t_res_f_res_47189 || y_47203;\n                        if (cond_47204) {\n                            lifted_lambda_res_f_res_f_res_47205 = redout_47791;\n                        } else {\n                            lifted_lambda_res_f_res_f_res_47205 = eta_p_47162;\n                        }\n                        if (cond_47204) {\n                            lifted_lambda_res_f_res_f_res_47206 = redout_47790;\n                            lifted_lambda_res_f_res_f_res_47207 = redout_47792;\n                        } else {\n                            bool cond_47208;\n                            bool x_47209;\n                            bool y_47210;\n                            bool cond_47211;\n                            int64_t tmp_47212;\n                            int64_t tmp_47213;\n                            \n                            cond_47208 = slt64(redout_47790, x_47173);\n                            x_47209 = !cond_47208;\n                            y_47210 = cond_t_res_f_res_47189 && x_47209;\n                            cond_47211 = cond_47208 || y_47210;\n                            if (cond_47211) {\n                           ",
                                    "     tmp_47212 = redout_47790;\n                            } else {\n                                tmp_47212 = x_47173;\n                            }\n                            tmp_47213 = add64(x_47175, redout_47792);\n                            lifted_lambda_res_f_res_f_res_47206 = tmp_47212;\n                            lifted_lambda_res_f_res_f_res_47207 = tmp_47213;\n                        }\n                        lifted_lambda_res_f_res_47199 = lifted_lambda_res_f_res_f_res_47206;\n                        lifted_lambda_res_f_res_47200 = lifted_lambda_res_f_res_f_res_47205;\n                        lifted_lambda_res_f_res_47201 = lifted_lambda_res_f_res_f_res_47207;\n                    }\n                    lifted_lambda_res_47193 = lifted_lambda_res_f_res_47199;\n                    lifted_lambda_res_47194 = lifted_lambda_res_f_res_47200;\n                    lifted_lambda_res_47195 = lifted_lambda_res_f_res_47201;\n                }\n                redout_tmp_48124 = lifted_lambda_res_47193;\n                redout_tmp_48125 = lifted_lambda_res_47194;\n                redout_tmp_48126 = lifted_lambda_res_47195;\n                redout_47790 = redout_tmp_48124;\n                redout_47791 = redout_tmp_48125;\n                redout_47792 = redout_tmp_48126;\n            }\n            x_47170 = redout_47790;\n            x_47171 = redout_47791;\n            x_47172 = redout_47792;\n            acc_47167 = x_47170;\n            acc_47168 = x_47171;\n            acc_47169 = x_47172;\n        } else {\n            acc_47167 = acc_47163;\n            acc_47168 = acc_47164;\n            acc_47169 = acc_47165;\n        }\n        mem_47943[(int64_t) 0] = acc_47167;\n        mem_47947[(int64_t) 0] = acc_47168;\n        mem_47951[(int64_t) 0] = acc_47169;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_48118[i_6] = mem_47943[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_48119[i_7] = mem_47947[i_7", "];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_48120[i_8] = mem_47951[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_47931[i_9] = mem_param_tmp_48118[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_47932[i_10] = mem_param_tmp_48119[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_47933[i_11] = mem_param_tmp_48120[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_47954[i_12] = mem_param_47931[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_47953[i_13] = mem_param_47932[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_47952[i_14] = mem_param_47933[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_47259) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_47975[i_15] = ext_mem_47954[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_47974[i_16] = ext_mem_47953[i_16];\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_47973[i_17] = ext_mem_47952[i_17];\n    } else {\n        int64_t ltid_flat_47261;\n        int64_t ltid_47260;\n        int64_t j_47276;\n        bool cond_47280;\n        int64_t pre1d_47283;\n        int64_t pre1d_47281;\n        int32_t pre1d_47282;\n        int64_t ltid_flat_47297;\n        int64_t ltid_47296;\n        int64_t gtid_47310;\n        int64_t acc_47312;\n        int32_t acc_47313;\n        int64_t acc_47314;\n        bool cond_47315;\n        int64_t acc_47316;\n        int32_t acc_47317;\n        int64_t acc_47318;\n        \n        ltid_flat_47261 = sext_i32_i64(local_tid_48109);\n        ltid_47260 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n        j_47276 = ltid_47260 + binop_x_47275;\n        cond_47280 = slt64(j_47276, w2_38000);\n        pre1d_47283 = btoi_bool_i64(cond_47280);\n        if (cond_47280) {\n            pre1d_47281 = j_47276;\n        } else {\n            pre1d_47281 = (int64_t) 0;\n        }\n        if", " (cond_47280) {\n            int32_t tile_elem_47285 = ((__global int32_t *) ys_mem_47845)[j_47276];\n            \n            pre1d_47282 = tile_elem_47285;\n        } else {\n            pre1d_47282 = 0;\n        }\n        ((__local int64_t *) color_48096)[ltid_47260] = pre1d_47281;\n        ((__local int32_t *) color_48095)[ltid_47260] = pre1d_47282;\n        ((__local int64_t *) color_48094)[ltid_47260] = pre1d_47283;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_47297 = sext_i32_i64(local_tid_48109);\n        ltid_47296 = sext_i32_i64(sext_i64_i32(ltid_pre_48113));\n        gtid_47310 = binop_x_46997 + ltid_47296;\n        acc_47312 = ext_mem_47954[(int64_t) 0];\n        acc_47313 = ext_mem_47953[(int64_t) 0];\n        acc_47314 = ext_mem_47952[(int64_t) 0];\n        cond_47315 = slt64(gtid_47310, w1_37999);\n        if (cond_47315) {\n            int32_t eta_p_47311;\n            int64_t x_47319;\n            int32_t x_47320;\n            int64_t x_47321;\n            int64_t redout_47794;\n            int32_t redout_47795;\n            int64_t redout_47796;\n            \n            eta_p_47311 = mem_47918[(int64_t) 0];\n            redout_47794 = acc_47312;\n            redout_47795 = acc_47313;\n            redout_47796 = acc_47314;\n            for (int64_t i_47797 = 0; i_47797 < residual_input_47258; i_47797++) {\n                int64_t x_47322;\n                int32_t x_47323;\n                bool cond_47331;\n                bool cond_47332;\n                bool cond_f_res_47333;\n                bool y_47334;\n                bool cond_47335;\n                bool cond_47336;\n                bool cond_47337;\n                bool cond_t_res_f_res_47338;\n                bool y_47339;\n                bool cond_t_res_47340;\n                bool x_47341;\n                int64_t lifted_lambda_res_47342;\n                int32_t lifted_lambda_res_47343;\n                int64_t lifted_lambda_res_47344;\n                int64_t redout_tmp_48127;\n                int32_t redout_tmp_48",
                                    "128;\n                int64_t redout_tmp_48129;\n                \n                x_47322 = ((__local int64_t *) color_48096)[i_47797];\n                x_47323 = ((__local int32_t *) color_48095)[i_47797];\n                cond_47331 = redout_47795 == eta_p_47311;\n                cond_47332 = !cond_47331;\n                cond_f_res_47333 = sle64(w2_38000, redout_47794);\n                y_47334 = cond_47331 && cond_f_res_47333;\n                cond_47335 = cond_47332 || y_47334;\n                cond_47336 = x_47323 == eta_p_47311;\n                cond_47337 = !cond_47336;\n                cond_t_res_f_res_47338 = sle64(w2_38000, x_47322);\n                y_47339 = cond_47336 && cond_t_res_f_res_47338;\n                cond_t_res_47340 = cond_47337 || y_47339;\n                x_47341 = cond_47335 && cond_t_res_47340;\n                if (x_47341) {\n                    lifted_lambda_res_47342 = w2_38000;\n                    lifted_lambda_res_47343 = eta_p_47311;\n                    lifted_lambda_res_47344 = (int64_t) 0;\n                } else {\n                    int64_t x_47324;\n                    bool x_47345;\n                    bool y_47346;\n                    bool cond_47347;\n                    int64_t lifted_lambda_res_f_res_47348;\n                    int32_t lifted_lambda_res_f_res_47349;\n                    int64_t lifted_lambda_res_f_res_47350;\n                    \n                    x_47324 = ((__local int64_t *) color_48094)[i_47797];\n                    x_47345 = !cond_f_res_47333;\n                    y_47346 = cond_47332 && x_47345;\n                    cond_47347 = cond_f_res_47333 || y_47346;\n                    if (cond_47347) {\n                        lifted_lambda_res_f_res_47348 = x_47322;\n                        lifted_lambda_res_f_res_47349 = x_47323;\n                        lifted_lambda_res_f_res_47350 = x_47324;\n                    } else {\n                        bool x_47351;\n                        bool y_47352;\n                        bool con", "d_47353;\n                        int32_t lifted_lambda_res_f_res_f_res_47354;\n                        int64_t lifted_lambda_res_f_res_f_res_47355;\n                        int64_t lifted_lambda_res_f_res_f_res_47356;\n                        \n                        x_47351 = !cond_t_res_f_res_47338;\n                        y_47352 = cond_47337 && x_47351;\n                        cond_47353 = cond_t_res_f_res_47338 || y_47352;\n                        if (cond_47353) {\n                            lifted_lambda_res_f_res_f_res_47354 = redout_47795;\n                        } else {\n                            lifted_lambda_res_f_res_f_res_47354 = eta_p_47311;\n                        }\n                        if (cond_47353) {\n                            lifted_lambda_res_f_res_f_res_47355 = redout_47794;\n                            lifted_lambda_res_f_res_f_res_47356 = redout_47796;\n                        } else {\n                            bool cond_47357;\n                            bool x_47358;\n                            bool y_47359;\n                            bool cond_47360;\n                            int64_t tmp_47361;\n                            int64_t tmp_47362;\n                            \n                            cond_47357 = slt64(redout_47794, x_47322);\n                            x_47358 = !cond_47357;\n                            y_47359 = cond_t_res_f_res_47338 && x_47358;\n                            cond_47360 = cond_47357 || y_47359;\n                            if (cond_47360) {\n                                tmp_47361 = redout_47794;\n                            } else {\n                                tmp_47361 = x_47322;\n                            }\n                            tmp_47362 = add64(x_47324, redout_47796);\n                            lifted_lambda_res_f_res_f_res_47355 = tmp_47361;\n                            lifted_lambda_res_f_res_f_res_47356 = tmp_47362;\n                        }\n                        lifted_lambda_res_f_re", "s_47348 = lifted_lambda_res_f_res_f_res_47355;\n                        lifted_lambda_res_f_res_47349 = lifted_lambda_res_f_res_f_res_47354;\n                        lifted_lambda_res_f_res_47350 = lifted_lambda_res_f_res_f_res_47356;\n                    }\n                    lifted_lambda_res_47342 = lifted_lambda_res_f_res_47348;\n                    lifted_lambda_res_47343 = lifted_lambda_res_f_res_47349;\n                    lifted_lambda_res_47344 = lifted_lambda_res_f_res_47350;\n                }\n                redout_tmp_48127 = lifted_lambda_res_47342;\n                redout_tmp_48128 = lifted_lambda_res_47343;\n                redout_tmp_48129 = lifted_lambda_res_47344;\n                redout_47794 = redout_tmp_48127;\n                redout_47795 = redout_tmp_48128;\n                redout_47796 = redout_tmp_48129;\n            }\n            x_47319 = redout_47794;\n            x_47320 = redout_47795;\n            x_47321 = redout_47796;\n            acc_47316 = x_47319;\n            acc_47317 = x_47320;\n            acc_47318 = x_47321;\n        } else {\n            acc_47316 = acc_47312;\n            acc_47317 = acc_47313;\n            acc_47318 = acc_47314;\n        }\n        mem_47964[(int64_t) 0] = acc_47316;\n        mem_47968[(int64_t) 0] = acc_47317;\n        mem_47972[(int64_t) 0] = acc_47318;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_mem_47975[i_18] = mem_47964[i_18];\n        for (int32_t i_19 = 0; i_19 < 1; i_19++)\n            ext_mem_47974[i_19] = mem_47968[i_19];\n        for (int32_t i_20 = 0; i_20 < 1; i_20++)\n            ext_mem_47973[i_20] = mem_47972[i_20];\n    }\n    if (slt64(sext_i32_i64(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110), w1_37999)) {\n        int64_t tmp_48130 = ext_mem_47975[(int64_t) 0];\n        \n        ((__global int64_t *) mem_47977)[sext_i32_i64(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110)] = tmp_48130;\n    }\n    if (slt64(sext_i32_i64",
                                    "(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110), w1_37999)) {\n        int32_t tmp_48131 = ext_mem_47974[(int64_t) 0];\n        \n        ((__global int32_t *) mem_47979)[sext_i32_i64(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110)] = tmp_48131;\n    }\n    if (slt64(sext_i32_i64(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110), w1_37999)) {\n        int64_t tmp_48132 = ext_mem_47973[(int64_t) 0];\n        \n        ((__global int64_t *) mem_47981)[sext_i32_i64(local_tid_48109) + tile_sizze_46989 * sext_i32_i64(block_id_48110)] = tmp_48132;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_46989\n    #undef bytes_47934\n    #undef bytes_47936\n}\nFUTHARK_KERNEL_SIZED(mergeFunczisegmap_intrablock_47382_dim1, 1, 1)\nvoid mergeFunczisegmap_intrablock_47382(__global int *global_failure, int64_t w1_37999, int64_t w2_38000, int64_t ldim_47385, int64_t num_whole_tiles_47399, int64_t residual_input_47653, unsigned char cond_47654_bits, int64_t binop_x_47670, __global unsigned char *xs_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47909, __global unsigned char *mem_47911, __global unsigned char *mem_47913)\n{\n    bool cond_47654 = cond_47654_bits;\n    \n    #define tile_sizze_47384 (mergeFunczisegmap_intrablock_47382zitile_sizze_47384)\n    #define bytes_47866 (mergeFunczisegmap_intrablock_47382zibytes_47866)\n    #define bytes_47868 (mergeFunczisegmap_intrablock_47382zibytes_47868)\n    \n    volatile __local unsigned char *color_48099_backing_2 = &shared_mem[0];\n    const int64_t color_48099_backing_2_offset = 0 + (bytes_47866 + srem64((int64_t) 8 - srem64(bytes_47866, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_1 = &shared_mem[color_48099_backing_2_offset];\n    const int64_t color_48098_backing_1_offset = color_48099_backing_2_offset + (bytes_47868 + srem64((int64_t) 8 - srem64(bytes_47868, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *col", "or_48097_backing_0 = &shared_mem[color_48098_backing_1_offset];\n    const int64_t color_48097_backing_0_offset = color_48098_backing_1_offset + (bytes_47866 + srem64((int64_t) 8 - srem64(bytes_47866, (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48136;\n    int32_t tblock_sizze_48139;\n    int32_t wave_sizze_48138;\n    int32_t block_id_48137;\n    int32_t global_tid_48135;\n    int64_t gid_flat_47382;\n    int64_t slice_48141;\n    int64_t ltid_pre_48140;\n    int64_t remnant_48142;\n    int64_t slice_48143;\n    int64_t gid_47381;\n    int64_t remnant_48144;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    int64_t binop_x_47392;\n    int32_t mem_47850[1];\n    int64_t ltid_flat_47387;\n    int64_t ltid_47386;\n    int64_t gtid_47393;\n    bool cond_47394;\n    int32_t pre_47395;\n    int64_t mem_47854[1];\n    int32_t mem_47858[1];\n    int64_t mem_47862[1];\n    int64_t ltid_flat_47401;\n    int64_t ltid_47400;\n    int64_t gtid_47411;\n    bool cond_47412;\n    int64_t neutral_47413;\n    int32_t neutral_47414;\n    int64_t ext_mem_47886[1];\n    int32_t ext_mem_47885[1];\n    int64_t ext_mem_47884[1];\n    int64_t mem_param_47863[1];\n    int32_t mem_param_47864[1];\n    int64_t mem_param_47865[1];\n    int64_t mem_47896[1];\n    int32_t mem_47900[1];\n    int64_t mem_47904[1];\n    int64_t ext_mem_47907[1];\n    int32_t ext_mem_47906[1];\n    int64_t ext_mem_47905[1];\n    \n    local_tid_48136 = get_local_id(0);\n    tblock_sizze_48139 = get_local_size(0);\n    wave_sizze_48138 = LOCKSTEP_WIDTH;\n    block_id_48137 = get_tblock_id(0);\n    global_tid_48135 = block_id_48137 * tblock_sizze_48139 + local_tid_48136;\n    gid_flat_47382 = sext_i32_i64(block_id_48137);\n    slice_48141 = tile_sizze_47384;\n    ltid_pre_48140 = sext_i32_i64(local_tid_48136);\n    remnant_48142 = sext_i32_i64(local_tid_48136) - ltid_pre_48140;\n    slice_48143 = ldim_47385;\n    gid_47381 = sext_i32", "_i64(block_id_48137);\n    remnant_48144 = sext_i32_i64(block_id_48137) - gid_47381;\n    color_48097 = (__local unsigned char *) color_48097_backing_0;\n    color_48098 = (__local unsigned char *) color_48098_backing_1;\n    color_48099 = (__local unsigned char *) color_48099_backing_2;\n    binop_x_47392 = gid_47381 * tile_sizze_47384;\n    ltid_flat_47387 = sext_i32_i64(local_tid_48136);\n    ltid_47386 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n    gtid_47393 = ltid_47386 + binop_x_47392;\n    cond_47394 = slt64(gtid_47393, w1_37999);\n    if (cond_47394) {\n        int32_t eta_p_47396 = ((__global int32_t *) xs_mem_47844)[gtid_47393];\n        \n        pre_47395 = eta_p_47396;\n    } else {\n        pre_47395 = 0;\n    }\n    mem_47850[(int64_t) 0] = pre_47395;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ltid_flat_47401 = sext_i32_i64(local_tid_48136);\n    ltid_47400 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n    gtid_47411 = binop_x_47392 + ltid_47400;\n    cond_47412 = slt64(gtid_47411, w1_37999);\n    if (cond_47412) {\n        neutral_47413 = w2_38000;\n    } else {\n        neutral_47413 = (int64_t) 0;\n    }\n    if (cond_47412) {\n        int32_t eta_p_47416 = mem_47850[(int64_t) 0];\n        \n        neutral_47414 = eta_p_47416;\n    } else {\n        neutral_47414 = 0;\n    }\n    mem_47854[(int64_t) 0] = neutral_47413;\n    mem_47858[(int64_t) 0] = neutral_47414;\n    mem_47862[(int64_t) 0] = (int64_t) 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    for (int32_t i_3 = 0; i_3 < 1; i_3++)\n        mem_param_47863[i_3] = mem_47854[i_3];\n    for (int32_t i_4 = 0; i_4 < 1; i_4++)\n        mem_param_47864[i_4] = mem_47858[i_4];\n    for (int32_t i_5 = 0; i_5 < 1; i_5++)\n        mem_param_47865[i_5] = mem_47862[i_5];\n    for (int64_t tile_id_47426 = 0; tile_id_47426 < num_whole_tiles_47399; tile_id_47426++) {\n        int64_t binop_x_47535;\n        int64_t ltid_flat_47534;\n        int64_t ltid_47533;\n        int64_t j_47536;\n        bool cond_47540;\n        int64_t",
                                    " pre1d_47543;\n        int64_t pre1d_47541;\n        int32_t pre1d_47542;\n        int64_t mem_47875[1];\n        int32_t mem_47879[1];\n        int64_t mem_47883[1];\n        int64_t ltid_flat_47554;\n        int64_t ltid_47553;\n        int64_t gtid_47556;\n        int64_t acc_47558;\n        int32_t acc_47559;\n        int64_t acc_47560;\n        bool cond_47561;\n        int64_t acc_47562;\n        int32_t acc_47563;\n        int64_t acc_47564;\n        int64_t mem_param_tmp_48145[1];\n        int32_t mem_param_tmp_48146[1];\n        int64_t mem_param_tmp_48147[1];\n        \n        binop_x_47535 = tile_sizze_47384 * tile_id_47426;\n        ltid_flat_47534 = sext_i32_i64(local_tid_48136);\n        ltid_47533 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n        j_47536 = ltid_47533 + binop_x_47535;\n        cond_47540 = slt64(j_47536, w2_38000);\n        pre1d_47543 = btoi_bool_i64(cond_47540);\n        if (cond_47540) {\n            pre1d_47541 = j_47536;\n        } else {\n            pre1d_47541 = (int64_t) 0;\n        }\n        if (cond_47540) {\n            int32_t tile_elem_47545 = ((__global int32_t *) ys_mem_47845)[j_47536];\n            \n            pre1d_47542 = tile_elem_47545;\n        } else {\n            pre1d_47542 = 0;\n        }\n        ((__local int64_t *) color_48099)[ltid_47533] = pre1d_47541;\n        ((__local int32_t *) color_48098)[ltid_47533] = pre1d_47542;\n        ((__local int64_t *) color_48097)[ltid_47533] = pre1d_47543;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_47554 = sext_i32_i64(local_tid_48136);\n        ltid_47553 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n        gtid_47556 = binop_x_47392 + ltid_47553;\n        acc_47558 = mem_param_47863[(int64_t) 0];\n        acc_47559 = mem_param_47864[(int64_t) 0];\n        acc_47560 = mem_param_47865[(int64_t) 0];\n        cond_47561 = slt64(gtid_47556, w1_37999);\n        if (cond_47561) {\n            int32_t eta_p_47557;\n            int64_t x_47565;\n            int32_t x_47566;\n            int64_t x_47567;\n", "            int64_t redout_47798;\n            int32_t redout_47799;\n            int64_t redout_47800;\n            \n            eta_p_47557 = mem_47850[(int64_t) 0];\n            redout_47798 = acc_47558;\n            redout_47799 = acc_47559;\n            redout_47800 = acc_47560;\n            for (int64_t i_47801 = 0; i_47801 < tile_sizze_47384; i_47801++) {\n                int64_t x_47568;\n                int32_t x_47569;\n                bool cond_47577;\n                bool cond_47578;\n                bool cond_f_res_47579;\n                bool y_47580;\n                bool cond_47581;\n                bool cond_47582;\n                bool cond_47583;\n                bool cond_t_res_f_res_47584;\n                bool y_47585;\n                bool cond_t_res_47586;\n                bool x_47587;\n                int64_t lifted_lambda_res_47588;\n                int32_t lifted_lambda_res_47589;\n                int64_t lifted_lambda_res_47590;\n                int64_t redout_tmp_48151;\n                int32_t redout_tmp_48152;\n                int64_t redout_tmp_48153;\n                \n                x_47568 = ((__local int64_t *) color_48099)[i_47801];\n                x_47569 = ((__local int32_t *) color_48098)[i_47801];\n                cond_47577 = redout_47799 == eta_p_47557;\n                cond_47578 = !cond_47577;\n                cond_f_res_47579 = sle64(w2_38000, redout_47798);\n                y_47580 = cond_47577 && cond_f_res_47579;\n                cond_47581 = cond_47578 || y_47580;\n                cond_47582 = x_47569 == eta_p_47557;\n                cond_47583 = !cond_47582;\n                cond_t_res_f_res_47584 = sle64(w2_38000, x_47568);\n                y_47585 = cond_47582 && cond_t_res_f_res_47584;\n                cond_t_res_47586 = cond_47583 || y_47585;\n                x_47587 = cond_47581 && cond_t_res_47586;\n                if (x_47587) {\n                    lifted_lambda_res_47588 = w2_38000;\n                    lifted_lambda_res_47589 = eta_p_47557;\n    ", "                lifted_lambda_res_47590 = (int64_t) 0;\n                } else {\n                    int64_t x_47570;\n                    bool x_47591;\n                    bool y_47592;\n                    bool cond_47593;\n                    int64_t lifted_lambda_res_f_res_47594;\n                    int32_t lifted_lambda_res_f_res_47595;\n                    int64_t lifted_lambda_res_f_res_47596;\n                    \n                    x_47570 = ((__local int64_t *) color_48097)[i_47801];\n                    x_47591 = !cond_f_res_47579;\n                    y_47592 = cond_47578 && x_47591;\n                    cond_47593 = cond_f_res_47579 || y_47592;\n                    if (cond_47593) {\n                        lifted_lambda_res_f_res_47594 = x_47568;\n                        lifted_lambda_res_f_res_47595 = x_47569;\n                        lifted_lambda_res_f_res_47596 = x_47570;\n                    } else {\n                        bool x_47597;\n                        bool y_47598;\n                        bool cond_47599;\n                        int32_t lifted_lambda_res_f_res_f_res_47600;\n                        int64_t lifted_lambda_res_f_res_f_res_47601;\n                        int64_t lifted_lambda_res_f_res_f_res_47602;\n                        \n                        x_47597 = !cond_t_res_f_res_47584;\n                        y_47598 = cond_47583 && x_47597;\n                        cond_47599 = cond_t_res_f_res_47584 || y_47598;\n                        if (cond_47599) {\n                            lifted_lambda_res_f_res_f_res_47600 = redout_47799;\n                        } else {\n                            lifted_lambda_res_f_res_f_res_47600 = eta_p_47557;\n                        }\n                        if (cond_47599) {\n                            lifted_lambda_res_f_res_f_res_47601 = redout_47798;\n                            lifted_lambda_res_f_res_f_res_47602 = redout_47800;\n                        } else {\n                            bool cond_47603;\n   ",
                                    "                         bool x_47604;\n                            bool y_47605;\n                            bool cond_47606;\n                            int64_t tmp_47607;\n                            int64_t tmp_47608;\n                            \n                            cond_47603 = slt64(redout_47798, x_47568);\n                            x_47604 = !cond_47603;\n                            y_47605 = cond_t_res_f_res_47584 && x_47604;\n                            cond_47606 = cond_47603 || y_47605;\n                            if (cond_47606) {\n                                tmp_47607 = redout_47798;\n                            } else {\n                                tmp_47607 = x_47568;\n                            }\n                            tmp_47608 = add64(x_47570, redout_47800);\n                            lifted_lambda_res_f_res_f_res_47601 = tmp_47607;\n                            lifted_lambda_res_f_res_f_res_47602 = tmp_47608;\n                        }\n                        lifted_lambda_res_f_res_47594 = lifted_lambda_res_f_res_f_res_47601;\n                        lifted_lambda_res_f_res_47595 = lifted_lambda_res_f_res_f_res_47600;\n                        lifted_lambda_res_f_res_47596 = lifted_lambda_res_f_res_f_res_47602;\n                    }\n                    lifted_lambda_res_47588 = lifted_lambda_res_f_res_47594;\n                    lifted_lambda_res_47589 = lifted_lambda_res_f_res_47595;\n                    lifted_lambda_res_47590 = lifted_lambda_res_f_res_47596;\n                }\n                redout_tmp_48151 = lifted_lambda_res_47588;\n                redout_tmp_48152 = lifted_lambda_res_47589;\n                redout_tmp_48153 = lifted_lambda_res_47590;\n                redout_47798 = redout_tmp_48151;\n                redout_47799 = redout_tmp_48152;\n                redout_47800 = redout_tmp_48153;\n            }\n            x_47565 = redout_47798;\n            x_47566 = redout_47799;\n            x_47567 = redout_47800;\n            acc_475", "62 = x_47565;\n            acc_47563 = x_47566;\n            acc_47564 = x_47567;\n        } else {\n            acc_47562 = acc_47558;\n            acc_47563 = acc_47559;\n            acc_47564 = acc_47560;\n        }\n        mem_47875[(int64_t) 0] = acc_47562;\n        mem_47879[(int64_t) 0] = acc_47563;\n        mem_47883[(int64_t) 0] = acc_47564;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_6 = 0; i_6 < 1; i_6++)\n            mem_param_tmp_48145[i_6] = mem_47875[i_6];\n        for (int32_t i_7 = 0; i_7 < 1; i_7++)\n            mem_param_tmp_48146[i_7] = mem_47879[i_7];\n        for (int32_t i_8 = 0; i_8 < 1; i_8++)\n            mem_param_tmp_48147[i_8] = mem_47883[i_8];\n        for (int32_t i_9 = 0; i_9 < 1; i_9++)\n            mem_param_47863[i_9] = mem_param_tmp_48145[i_9];\n        for (int32_t i_10 = 0; i_10 < 1; i_10++)\n            mem_param_47864[i_10] = mem_param_tmp_48146[i_10];\n        for (int32_t i_11 = 0; i_11 < 1; i_11++)\n            mem_param_47865[i_11] = mem_param_tmp_48147[i_11];\n    }\n    for (int32_t i_12 = 0; i_12 < 1; i_12++)\n        ext_mem_47886[i_12] = mem_param_47863[i_12];\n    for (int32_t i_13 = 0; i_13 < 1; i_13++)\n        ext_mem_47885[i_13] = mem_param_47864[i_13];\n    for (int32_t i_14 = 0; i_14 < 1; i_14++)\n        ext_mem_47884[i_14] = mem_param_47865[i_14];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (cond_47654) {\n        for (int32_t i_15 = 0; i_15 < 1; i_15++)\n            ext_mem_47907[i_15] = ext_mem_47886[i_15];\n        for (int32_t i_16 = 0; i_16 < 1; i_16++)\n            ext_mem_47906[i_16] = ext_mem_47885[i_16];\n        for (int32_t i_17 = 0; i_17 < 1; i_17++)\n            ext_mem_47905[i_17] = ext_mem_47884[i_17];\n    } else {\n        int64_t ltid_flat_47656;\n        int64_t ltid_47655;\n        int64_t j_47671;\n        bool cond_47675;\n        int64_t pre1d_47678;\n        int64_t pre1d_47676;\n        int32_t pre1d_47677;\n        int64_t ltid_flat_47692;\n        int64_t ltid_47691;\n        int64_t gtid_47705;\n        int64_t ", "acc_47707;\n        int32_t acc_47708;\n        int64_t acc_47709;\n        bool cond_47710;\n        int64_t acc_47711;\n        int32_t acc_47712;\n        int64_t acc_47713;\n        \n        ltid_flat_47656 = sext_i32_i64(local_tid_48136);\n        ltid_47655 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n        j_47671 = ltid_47655 + binop_x_47670;\n        cond_47675 = slt64(j_47671, w2_38000);\n        pre1d_47678 = btoi_bool_i64(cond_47675);\n        if (cond_47675) {\n            pre1d_47676 = j_47671;\n        } else {\n            pre1d_47676 = (int64_t) 0;\n        }\n        if (cond_47675) {\n            int32_t tile_elem_47680 = ((__global int32_t *) ys_mem_47845)[j_47671];\n            \n            pre1d_47677 = tile_elem_47680;\n        } else {\n            pre1d_47677 = 0;\n        }\n        ((__local int64_t *) color_48099)[ltid_47655] = pre1d_47676;\n        ((__local int32_t *) color_48098)[ltid_47655] = pre1d_47677;\n        ((__local int64_t *) color_48097)[ltid_47655] = pre1d_47678;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        ltid_flat_47692 = sext_i32_i64(local_tid_48136);\n        ltid_47691 = sext_i32_i64(sext_i64_i32(ltid_pre_48140));\n        gtid_47705 = binop_x_47392 + ltid_47691;\n        acc_47707 = ext_mem_47886[(int64_t) 0];\n        acc_47708 = ext_mem_47885[(int64_t) 0];\n        acc_47709 = ext_mem_47884[(int64_t) 0];\n        cond_47710 = slt64(gtid_47705, w1_37999);\n        if (cond_47710) {\n            int32_t eta_p_47706;\n            int64_t x_47714;\n            int32_t x_47715;\n            int64_t x_47716;\n            int64_t redout_47802;\n            int32_t redout_47803;\n            int64_t redout_47804;\n            \n            eta_p_47706 = mem_47850[(int64_t) 0];\n            redout_47802 = acc_47707;\n            redout_47803 = acc_47708;\n            redout_47804 = acc_47709;\n            for (int64_t i_47805 = 0; i_47805 < residual_input_47653; i_47805++) {\n                int64_t x_47717;\n                int32_t x_47718;\n                bool co",
                                    "nd_47726;\n                bool cond_47727;\n                bool cond_f_res_47728;\n                bool y_47729;\n                bool cond_47730;\n                bool cond_47731;\n                bool cond_47732;\n                bool cond_t_res_f_res_47733;\n                bool y_47734;\n                bool cond_t_res_47735;\n                bool x_47736;\n                int64_t lifted_lambda_res_47737;\n                int32_t lifted_lambda_res_47738;\n                int64_t lifted_lambda_res_47739;\n                int64_t redout_tmp_48154;\n                int32_t redout_tmp_48155;\n                int64_t redout_tmp_48156;\n                \n                x_47717 = ((__local int64_t *) color_48099)[i_47805];\n                x_47718 = ((__local int32_t *) color_48098)[i_47805];\n                cond_47726 = redout_47803 == eta_p_47706;\n                cond_47727 = !cond_47726;\n                cond_f_res_47728 = sle64(w2_38000, redout_47802);\n                y_47729 = cond_47726 && cond_f_res_47728;\n                cond_47730 = cond_47727 || y_47729;\n                cond_47731 = x_47718 == eta_p_47706;\n                cond_47732 = !cond_47731;\n                cond_t_res_f_res_47733 = sle64(w2_38000, x_47717);\n                y_47734 = cond_47731 && cond_t_res_f_res_47733;\n                cond_t_res_47735 = cond_47732 || y_47734;\n                x_47736 = cond_47730 && cond_t_res_47735;\n                if (x_47736) {\n                    lifted_lambda_res_47737 = w2_38000;\n                    lifted_lambda_res_47738 = eta_p_47706;\n                    lifted_lambda_res_47739 = (int64_t) 0;\n                } else {\n                    int64_t x_47719;\n                    bool x_47740;\n                    bool y_47741;\n                    bool cond_47742;\n                    int64_t lifted_lambda_res_f_res_47743;\n                    int32_t lifted_lambda_res_f_res_47744;\n                    int64_t lifted_lambda_res_f_res_47745;\n                    \n                    x_47719", " = ((__local int64_t *) color_48097)[i_47805];\n                    x_47740 = !cond_f_res_47728;\n                    y_47741 = cond_47727 && x_47740;\n                    cond_47742 = cond_f_res_47728 || y_47741;\n                    if (cond_47742) {\n                        lifted_lambda_res_f_res_47743 = x_47717;\n                        lifted_lambda_res_f_res_47744 = x_47718;\n                        lifted_lambda_res_f_res_47745 = x_47719;\n                    } else {\n                        bool x_47746;\n                        bool y_47747;\n                        bool cond_47748;\n                        int32_t lifted_lambda_res_f_res_f_res_47749;\n                        int64_t lifted_lambda_res_f_res_f_res_47750;\n                        int64_t lifted_lambda_res_f_res_f_res_47751;\n                        \n                        x_47746 = !cond_t_res_f_res_47733;\n                        y_47747 = cond_47732 && x_47746;\n                        cond_47748 = cond_t_res_f_res_47733 || y_47747;\n                        if (cond_47748) {\n                            lifted_lambda_res_f_res_f_res_47749 = redout_47803;\n                        } else {\n                            lifted_lambda_res_f_res_f_res_47749 = eta_p_47706;\n                        }\n                        if (cond_47748) {\n                            lifted_lambda_res_f_res_f_res_47750 = redout_47802;\n                            lifted_lambda_res_f_res_f_res_47751 = redout_47804;\n                        } else {\n                            bool cond_47752;\n                            bool x_47753;\n                            bool y_47754;\n                            bool cond_47755;\n                            int64_t tmp_47756;\n                            int64_t tmp_47757;\n                            \n                            cond_47752 = slt64(redout_47802, x_47717);\n                            x_47753 = !cond_47752;\n                            y_47754 = cond_t_res_f_res_47733 && x_47753;\n   ", "                         cond_47755 = cond_47752 || y_47754;\n                            if (cond_47755) {\n                                tmp_47756 = redout_47802;\n                            } else {\n                                tmp_47756 = x_47717;\n                            }\n                            tmp_47757 = add64(x_47719, redout_47804);\n                            lifted_lambda_res_f_res_f_res_47750 = tmp_47756;\n                            lifted_lambda_res_f_res_f_res_47751 = tmp_47757;\n                        }\n                        lifted_lambda_res_f_res_47743 = lifted_lambda_res_f_res_f_res_47750;\n                        lifted_lambda_res_f_res_47744 = lifted_lambda_res_f_res_f_res_47749;\n                        lifted_lambda_res_f_res_47745 = lifted_lambda_res_f_res_f_res_47751;\n                    }\n                    lifted_lambda_res_47737 = lifted_lambda_res_f_res_47743;\n                    lifted_lambda_res_47738 = lifted_lambda_res_f_res_47744;\n                    lifted_lambda_res_47739 = lifted_lambda_res_f_res_47745;\n                }\n                redout_tmp_48154 = lifted_lambda_res_47737;\n                redout_tmp_48155 = lifted_lambda_res_47738;\n                redout_tmp_48156 = lifted_lambda_res_47739;\n                redout_47802 = redout_tmp_48154;\n                redout_47803 = redout_tmp_48155;\n                redout_47804 = redout_tmp_48156;\n            }\n            x_47714 = redout_47802;\n            x_47715 = redout_47803;\n            x_47716 = redout_47804;\n            acc_47711 = x_47714;\n            acc_47712 = x_47715;\n            acc_47713 = x_47716;\n        } else {\n            acc_47711 = acc_47707;\n            acc_47712 = acc_47708;\n            acc_47713 = acc_47709;\n        }\n        mem_47896[(int64_t) 0] = acc_47711;\n        mem_47900[(int64_t) 0] = acc_47712;\n        mem_47904[(int64_t) 0] = acc_47713;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_18 = 0; i_18 < 1; i_18++)\n            ext_",
                                    "mem_47907[i_18] = mem_47896[i_18];\n        for (int32_t i_19 = 0; i_19 < 1; i_19++)\n            ext_mem_47906[i_19] = mem_47900[i_19];\n        for (int32_t i_20 = 0; i_20 < 1; i_20++)\n            ext_mem_47905[i_20] = mem_47904[i_20];\n    }\n    if (slt64(sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137), w1_37999)) {\n        int64_t tmp_48157 = ext_mem_47907[(int64_t) 0];\n        \n        ((__global int64_t *) mem_47909)[sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137)] = tmp_48157;\n    }\n    if (slt64(sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137), w1_37999)) {\n        int32_t tmp_48158 = ext_mem_47906[(int64_t) 0];\n        \n        ((__global int32_t *) mem_47911)[sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137)] = tmp_48158;\n    }\n    if (slt64(sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137), w1_37999)) {\n        int64_t tmp_48159 = ext_mem_47905[(int64_t) 0];\n        \n        ((__global int64_t *) mem_47913)[sext_i32_i64(local_tid_48136) + tile_sizze_47384 * sext_i32_i64(block_id_48137)] = tmp_48159;\n    }\n    \n  error_8:\n    return;\n    #undef tile_sizze_47384\n    #undef bytes_47866\n    #undef bytes_47868\n}\nFUTHARK_KERNEL_SIZED(orderByIndices_doublezisegmap_44420_dim1, 1, 1)\nvoid orderByIndices_doublezisegmap_44420(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_36374, int64_t n_36375, int64_t incr_36376, __global unsigned char *is_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47848)\n{\n    #define segmap_tblock_sizze_44416 (orderByIndices_doublezisegmap_44420zisegmap_tblock_sizze_44416)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48106;\n    int32_t tblock_sizze_48109;\n    int32_t wave_sizze_48108;\n    int32_t block_id_48107;\n    int32_t global_tid_48105;\n    int64_t phys_tid_44420;\n    int64", "_t global_tid_48110;\n    int64_t slice_48111;\n    int64_t gtid_44419;\n    int64_t remnant_48112;\n    \n    local_tid_48106 = get_local_id(0);\n    tblock_sizze_48109 = get_local_size(0);\n    wave_sizze_48108 = LOCKSTEP_WIDTH;\n    block_id_48107 = get_tblock_id(0);\n    global_tid_48105 = block_id_48107 * tblock_sizze_48109 + local_tid_48106;\n    phys_tid_44420 = sext_i32_i64(global_tid_48105);\n    global_tid_48110 = sext_i32_i64(block_id_48107) * segmap_tblock_sizze_44416 + sext_i32_i64(local_tid_48106);\n    slice_48111 = ni_36374;\n    gtid_44419 = global_tid_48110;\n    remnant_48112 = global_tid_48110 - gtid_44419;\n    if (slt64(gtid_44419, ni_36374)) {\n        int64_t eta_p_44421;\n        int64_t lifted_lambda_res_44422;\n        bool x_44423;\n        bool y_44424;\n        bool bounds_check_44425;\n        bool index_certs_44426;\n        double lifted_lambda_res_44427;\n        \n        eta_p_44421 = ((__global int64_t *) is_mem_47844)[gtid_44419];\n        lifted_lambda_res_44422 = sub64(eta_p_44421, incr_36376);\n        x_44423 = sle64((int64_t) 0, lifted_lambda_res_44422);\n        y_44424 = slt64(lifted_lambda_res_44422, n_36375);\n        bounds_check_44425 = x_44423 && y_44424;\n        if (!bounds_check_44425) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 0) == -1) {\n                    global_failure_args[0] = (int64_t) lifted_lambda_res_44422;\n                    global_failure_args[1] = (int64_t) n_36375;\n                    ;\n                }\n                return;\n            }\n        }\n        lifted_lambda_res_44427 = ((__global double *) ys_mem_47845)[lifted_lambda_res_44422];\n        ((__global double *) mem_47848)[gtid_44419] = lifted_lambda_res_44427;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44416\n}\nFUTHARK_KERNEL_SIZED(orderByIndices_floatzisegmap_44392_dim1, 1, 1)\nvoid orderByIndices_floatzisegmap_44392(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_a", "rgs, int64_t ni_36220, int64_t n_36221, int64_t incr_36222, __global unsigned char *is_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47848)\n{\n    #define segmap_tblock_sizze_44388 (orderByIndices_floatzisegmap_44392zisegmap_tblock_sizze_44388)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48106;\n    int32_t tblock_sizze_48109;\n    int32_t wave_sizze_48108;\n    int32_t block_id_48107;\n    int32_t global_tid_48105;\n    int64_t phys_tid_44392;\n    int64_t global_tid_48110;\n    int64_t slice_48111;\n    int64_t gtid_44391;\n    int64_t remnant_48112;\n    \n    local_tid_48106 = get_local_id(0);\n    tblock_sizze_48109 = get_local_size(0);\n    wave_sizze_48108 = LOCKSTEP_WIDTH;\n    block_id_48107 = get_tblock_id(0);\n    global_tid_48105 = block_id_48107 * tblock_sizze_48109 + local_tid_48106;\n    phys_tid_44392 = sext_i32_i64(global_tid_48105);\n    global_tid_48110 = sext_i32_i64(block_id_48107) * segmap_tblock_sizze_44388 + sext_i32_i64(local_tid_48106);\n    slice_48111 = ni_36220;\n    gtid_44391 = global_tid_48110;\n    remnant_48112 = global_tid_48110 - gtid_44391;\n    if (slt64(gtid_44391, ni_36220)) {\n        int64_t eta_p_44393;\n        int64_t lifted_lambda_res_44394;\n        bool x_44395;\n        bool y_44396;\n        bool bounds_check_44397;\n        bool index_certs_44398;\n        float lifted_lambda_res_44399;\n        \n        eta_p_44393 = ((__global int64_t *) is_mem_47844)[gtid_44391];\n        lifted_lambda_res_44394 = sub64(eta_p_44393, incr_36222);\n        x_44395 = sle64((int64_t) 0, lifted_lambda_res_44394);\n        y_44396 = slt64(lifted_lambda_res_44394, n_36221);\n        bounds_check_44397 = x_44395 && y_44396;\n        if (!bounds_check_44397) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 1) == -1) {\n                    global_failure_args[0] = (int64_t) lifted_lambda_res_44394;\n                    global_failure_args[1] = (int64_t) n_36221;\n                    ;\n",
                                    "                }\n                return;\n            }\n        }\n        lifted_lambda_res_44399 = ((__global float *) ys_mem_47845)[lifted_lambda_res_44394];\n        ((__global float *) mem_47848)[gtid_44391] = lifted_lambda_res_44399;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44388\n}\nFUTHARK_KERNEL_SIZED(orderByIndices_intzisegmap_44336_dim1, 1, 1)\nvoid orderByIndices_intzisegmap_44336(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_35915, int64_t n_35916, int64_t incr_35917, __global unsigned char *is_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47848)\n{\n    #define segmap_tblock_sizze_44332 (orderByIndices_intzisegmap_44336zisegmap_tblock_sizze_44332)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48106;\n    int32_t tblock_sizze_48109;\n    int32_t wave_sizze_48108;\n    int32_t block_id_48107;\n    int32_t global_tid_48105;\n    int64_t phys_tid_44336;\n    int64_t global_tid_48110;\n    int64_t slice_48111;\n    int64_t gtid_44335;\n    int64_t remnant_48112;\n    \n    local_tid_48106 = get_local_id(0);\n    tblock_sizze_48109 = get_local_size(0);\n    wave_sizze_48108 = LOCKSTEP_WIDTH;\n    block_id_48107 = get_tblock_id(0);\n    global_tid_48105 = block_id_48107 * tblock_sizze_48109 + local_tid_48106;\n    phys_tid_44336 = sext_i32_i64(global_tid_48105);\n    global_tid_48110 = sext_i32_i64(block_id_48107) * segmap_tblock_sizze_44332 + sext_i32_i64(local_tid_48106);\n    slice_48111 = ni_35915;\n    gtid_44335 = global_tid_48110;\n    remnant_48112 = global_tid_48110 - gtid_44335;\n    if (slt64(gtid_44335, ni_35915)) {\n        int64_t eta_p_44337;\n        int64_t lifted_lambda_res_44338;\n        bool x_44339;\n        bool y_44340;\n        bool bounds_check_44341;\n        bool index_certs_44342;\n        int32_t lifted_lambda_res_44343;\n        \n        eta_p_44337 = ((__global int64_t *) is_mem_47844)[gtid_44335];\n        lifted_lambda_res", "_44338 = sub64(eta_p_44337, incr_35917);\n        x_44339 = sle64((int64_t) 0, lifted_lambda_res_44338);\n        y_44340 = slt64(lifted_lambda_res_44338, n_35916);\n        bounds_check_44341 = x_44339 && y_44340;\n        if (!bounds_check_44341) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 2) == -1) {\n                    global_failure_args[0] = (int64_t) lifted_lambda_res_44338;\n                    global_failure_args[1] = (int64_t) n_35916;\n                    ;\n                }\n                return;\n            }\n        }\n        lifted_lambda_res_44343 = ((__global int32_t *) ys_mem_47845)[lifted_lambda_res_44338];\n        ((__global int32_t *) mem_47848)[gtid_44335] = lifted_lambda_res_44343;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44332\n}\nFUTHARK_KERNEL_SIZED(orderByIndices_longzisegmap_44364_dim1, 1, 1)\nvoid orderByIndices_longzisegmap_44364(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_36066, int64_t n_36067, int64_t incr_36068, __global unsigned char *is_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47848)\n{\n    #define segmap_tblock_sizze_44360 (orderByIndices_longzisegmap_44364zisegmap_tblock_sizze_44360)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48106;\n    int32_t tblock_sizze_48109;\n    int32_t wave_sizze_48108;\n    int32_t block_id_48107;\n    int32_t global_tid_48105;\n    int64_t phys_tid_44364;\n    int64_t global_tid_48110;\n    int64_t slice_48111;\n    int64_t gtid_44363;\n    int64_t remnant_48112;\n    \n    local_tid_48106 = get_local_id(0);\n    tblock_sizze_48109 = get_local_size(0);\n    wave_sizze_48108 = LOCKSTEP_WIDTH;\n    block_id_48107 = get_tblock_id(0);\n    global_tid_48105 = block_id_48107 * tblock_sizze_48109 + local_tid_48106;\n    phys_tid_44364 = sext_i32_i64(global_tid_48105);\n    global_tid_48110 = sext_i32_i64(block_id_48107) * segmap_tblock_sizze_44360", " + sext_i32_i64(local_tid_48106);\n    slice_48111 = ni_36066;\n    gtid_44363 = global_tid_48110;\n    remnant_48112 = global_tid_48110 - gtid_44363;\n    if (slt64(gtid_44363, ni_36066)) {\n        int64_t eta_p_44365;\n        int64_t lifted_lambda_res_44366;\n        bool x_44367;\n        bool y_44368;\n        bool bounds_check_44369;\n        bool index_certs_44370;\n        int64_t lifted_lambda_res_44371;\n        \n        eta_p_44365 = ((__global int64_t *) is_mem_47844)[gtid_44363];\n        lifted_lambda_res_44366 = sub64(eta_p_44365, incr_36068);\n        x_44367 = sle64((int64_t) 0, lifted_lambda_res_44366);\n        y_44368 = slt64(lifted_lambda_res_44366, n_36067);\n        bounds_check_44369 = x_44367 && y_44368;\n        if (!bounds_check_44369) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 3) == -1) {\n                    global_failure_args[0] = (int64_t) lifted_lambda_res_44366;\n                    global_failure_args[1] = (int64_t) n_36067;\n                    ;\n                }\n                return;\n            }\n        }\n        lifted_lambda_res_44371 = ((__global int64_t *) ys_mem_47845)[lifted_lambda_res_44366];\n        ((__global int64_t *) mem_47848)[gtid_44363] = lifted_lambda_res_44371;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44360\n}\nFUTHARK_KERNEL_SIZED(orderByIndices_shortzisegmap_44308_dim1, 1, 1)\nvoid orderByIndices_shortzisegmap_44308(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t ni_35761, int64_t n_35762, int64_t incr_35763, __global unsigned char *is_mem_47844, __global unsigned char *ys_mem_47845, __global unsigned char *mem_47848)\n{\n    #define segmap_tblock_sizze_44304 (orderByIndices_shortzisegmap_44308zisegmap_tblock_sizze_44304)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48106;\n    int32_t tblock_sizze_48109;\n    int32_t wave_sizze_48108;\n    int32_t block_id_48107;\n    int32_t global_tid_48",
                                    "105;\n    int64_t phys_tid_44308;\n    int64_t global_tid_48110;\n    int64_t slice_48111;\n    int64_t gtid_44307;\n    int64_t remnant_48112;\n    \n    local_tid_48106 = get_local_id(0);\n    tblock_sizze_48109 = get_local_size(0);\n    wave_sizze_48108 = LOCKSTEP_WIDTH;\n    block_id_48107 = get_tblock_id(0);\n    global_tid_48105 = block_id_48107 * tblock_sizze_48109 + local_tid_48106;\n    phys_tid_44308 = sext_i32_i64(global_tid_48105);\n    global_tid_48110 = sext_i32_i64(block_id_48107) * segmap_tblock_sizze_44304 + sext_i32_i64(local_tid_48106);\n    slice_48111 = ni_35761;\n    gtid_44307 = global_tid_48110;\n    remnant_48112 = global_tid_48110 - gtid_44307;\n    if (slt64(gtid_44307, ni_35761)) {\n        int64_t eta_p_44309;\n        int64_t lifted_lambda_res_44310;\n        bool x_44311;\n        bool y_44312;\n        bool bounds_check_44313;\n        bool index_certs_44314;\n        int16_t lifted_lambda_res_44315;\n        \n        eta_p_44309 = ((__global int64_t *) is_mem_47844)[gtid_44307];\n        lifted_lambda_res_44310 = sub64(eta_p_44309, incr_35763);\n        x_44311 = sle64((int64_t) 0, lifted_lambda_res_44310);\n        y_44312 = slt64(lifted_lambda_res_44310, n_35762);\n        bounds_check_44313 = x_44311 && y_44312;\n        if (!bounds_check_44313) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 4) == -1) {\n                    global_failure_args[0] = (int64_t) lifted_lambda_res_44310;\n                    global_failure_args[1] = (int64_t) n_35762;\n                    ;\n                }\n                return;\n            }\n        }\n        lifted_lambda_res_44315 = ((__global int16_t *) ys_mem_47845)[lifted_lambda_res_44310];\n        ((__global int16_t *) mem_47848)[gtid_44307] = lifted_lambda_res_44315;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44304\n}\nFUTHARK_KERNEL_SIZED(partitionFunczisegmap_43943_dim1, 1, 1)\nvoid partitionFunczisegmap_43943(__global int *global_failure, int failure_is_an_option, __g", "lobal int64_t *global_failure_args, int64_t na_37612, int64_t nb_37613, int64_t threads_37614, int64_t zt_rhs_38587, __global unsigned char *as_mem_47844, __global unsigned char *bs_mem_47845, __global unsigned char *mem_47848, __global unsigned char *mem_47850)\n{\n    #define segmap_tblock_sizze_43938 (partitionFunczisegmap_43943zisegmap_tblock_sizze_43938)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48107;\n    int32_t tblock_sizze_48110;\n    int32_t wave_sizze_48109;\n    int32_t block_id_48108;\n    int32_t global_tid_48106;\n    int64_t phys_tid_43943;\n    int64_t global_tid_48111;\n    int64_t slice_48112;\n    int64_t gtid_43942;\n    int64_t remnant_48113;\n    \n    local_tid_48107 = get_local_id(0);\n    tblock_sizze_48110 = get_local_size(0);\n    wave_sizze_48109 = LOCKSTEP_WIDTH;\n    block_id_48108 = get_tblock_id(0);\n    global_tid_48106 = block_id_48108 * tblock_sizze_48110 + local_tid_48107;\n    phys_tid_43943 = sext_i32_i64(global_tid_48106);\n    global_tid_48111 = sext_i32_i64(block_id_48108) * segmap_tblock_sizze_43938 + sext_i32_i64(local_tid_48107);\n    slice_48112 = threads_37614;\n    gtid_43942 = global_tid_48111;\n    remnant_48113 = global_tid_48111 - gtid_43942;\n    if (slt64(gtid_43942, threads_37614)) {\n        int64_t zs_lhs_43945;\n        int64_t index_43946;\n        bool cond_43947;\n        int64_t atop_43948;\n        int64_t btop_43949;\n        bool lifted_lambda_res_43951;\n        int64_t lifted_lambda_res_43952;\n        int64_t lifted_lambda_res_43953;\n        int64_t lifted_lambda_res_43954;\n        int64_t lifted_lambda_res_43955;\n        int64_t lifted_lambda_res_43956;\n        bool loop_while_43957;\n        int64_t p_43958;\n        int64_t p_43959;\n        int64_t p_43960;\n        int64_t p_43961;\n        int64_t p_43962;\n        \n        zs_lhs_43945 = mul64(zt_rhs_38587, gtid_43942);\n        index_43946 = sdiv64(zs_lhs_43945, threads_37614);\n        cond_43947 = slt64(na_37612, index_43946);\n        if (cond_43", "947) {\n            atop_43948 = na_37612;\n        } else {\n            atop_43948 = index_43946;\n        }\n        if (cond_43947) {\n            int64_t btop_t_res_43950 = sub64(index_43946, na_37612);\n            \n            btop_43949 = btop_t_res_43950;\n        } else {\n            btop_43949 = (int64_t) 0;\n        }\n        loop_while_43957 = 1;\n        p_43958 = btop_43949;\n        p_43959 = na_37612;\n        p_43960 = atop_43948;\n        p_43961 = nb_37613;\n        p_43962 = btop_43949;\n        while (loop_while_43957) {\n            int64_t zs_lhs_43963;\n            int64_t offset_43964;\n            int64_t ai_43965;\n            int64_t bi_43966;\n            bool cond_43967;\n            bool cond_t_res_43968;\n            bool x_43969;\n            int32_t acur_43970;\n            bool cond_43975;\n            int32_t aprev_43976;\n            bool cond_43983;\n            bool cond_t_res_43984;\n            bool x_43985;\n            int32_t bcur_43986;\n            bool cond_43991;\n            int32_t bprev_43992;\n            bool cond_43999;\n            int64_t loopres_44000;\n            int64_t loopres_44001;\n            int64_t loopres_44002;\n            int64_t loopres_44003;\n            int64_t loopres_44004;\n            bool loopres_44005;\n            bool loop_while_tmp_48114;\n            int64_t p_tmp_48115;\n            int64_t p_tmp_48116;\n            int64_t p_tmp_48117;\n            int64_t p_tmp_48118;\n            int64_t p_tmp_48119;\n            \n            zs_lhs_43963 = sub64(p_43960, p_43958);\n            offset_43964 = sdiv64(zs_lhs_43963, (int64_t) 2);\n            ai_43965 = sub64(p_43960, offset_43964);\n            bi_43966 = add64(p_43962, offset_43964);\n            cond_43967 = sle64((int64_t) 0, ai_43965);\n            cond_t_res_43968 = slt64(ai_43965, na_37612);\n            x_43969 = cond_43967 && cond_t_res_43968;\n            if (x_43969) {\n                bool index_certs_43971;\n                int32_t acur_t_res_43972;\n                \n    ",
                                    "            if (!x_43969) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 5) == -1) {\n                            global_failure_args[0] = (int64_t) ai_43965;\n                            global_failure_args[1] = (int64_t) na_37612;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                acur_t_res_43972 = ((__global int32_t *) as_mem_47844)[ai_43965];\n                acur_43970 = acur_t_res_43972;\n            } else {\n                bool cond_43973;\n                int32_t acur_f_res_43974;\n                \n                cond_43973 = slt64(ai_43965, (int64_t) 0);\n                if (cond_43973) {\n                    acur_f_res_43974 = -2147483648;\n                } else {\n                    acur_f_res_43974 = 2147483647;\n                }\n                acur_43970 = acur_f_res_43974;\n            }\n            cond_43975 = slt64((int64_t) 0, ai_43965);\n            if (cond_43975) {\n                int64_t tmp_43977;\n                bool x_43978;\n                bool y_43979;\n                bool bounds_check_43980;\n                bool index_certs_43981;\n                int32_t aprev_t_res_43982;\n                \n                tmp_43977 = sub64(ai_43965, (int64_t) 1);\n                x_43978 = sle64((int64_t) 0, tmp_43977);\n                y_43979 = slt64(tmp_43977, na_37612);\n                bounds_check_43980 = x_43978 && y_43979;\n                if (!bounds_check_43980) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 6) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_43977;\n                            global_failure_args[1] = (int64_t) na_37612;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                aprev_t_res_43982 = ((__global int32_t *) as_mem_47844)[tmp", "_43977];\n                aprev_43976 = aprev_t_res_43982;\n            } else {\n                aprev_43976 = -2147483648;\n            }\n            cond_43983 = sle64((int64_t) 0, bi_43966);\n            cond_t_res_43984 = slt64(bi_43966, nb_37613);\n            x_43985 = cond_43983 && cond_t_res_43984;\n            if (x_43985) {\n                bool index_certs_43987;\n                int32_t bcur_t_res_43988;\n                \n                if (!x_43985) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 7) == -1) {\n                            global_failure_args[0] = (int64_t) bi_43966;\n                            global_failure_args[1] = (int64_t) nb_37613;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                bcur_t_res_43988 = ((__global int32_t *) bs_mem_47845)[bi_43966];\n                bcur_43986 = bcur_t_res_43988;\n            } else {\n                bool cond_43989;\n                int32_t bcur_f_res_43990;\n                \n                cond_43989 = slt64(bi_43966, (int64_t) 0);\n                if (cond_43989) {\n                    bcur_f_res_43990 = -2147483648;\n                } else {\n                    bcur_f_res_43990 = 2147483647;\n                }\n                bcur_43986 = bcur_f_res_43990;\n            }\n            cond_43991 = slt64((int64_t) 0, bi_43966);\n            if (cond_43991) {\n                int64_t tmp_43993;\n                bool x_43994;\n                bool y_43995;\n                bool bounds_check_43996;\n                bool index_certs_43997;\n                int32_t bprev_t_res_43998;\n                \n                tmp_43993 = sub64(bi_43966, (int64_t) 1);\n                x_43994 = sle64((int64_t) 0, tmp_43993);\n                y_43995 = slt64(tmp_43993, nb_37613);\n                bounds_check_43996 = x_43994 && y_43995;\n                if (!bounds_check_43996) {\n                    {\n   ", "                     if (atomic_cmpxchg_i32_global(global_failure, -1, 8) == -1) {\n                            global_failure_args[0] = (int64_t) tmp_43993;\n                            global_failure_args[1] = (int64_t) nb_37613;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                bprev_t_res_43998 = ((__global int32_t *) bs_mem_47845)[tmp_43993];\n                bprev_43992 = bprev_t_res_43998;\n            } else {\n                bprev_43992 = -2147483648;\n            }\n            cond_43999 = slt32(bprev_43992, acur_43970);\n            if (cond_43999) {\n                bool cond_44006;\n                int64_t loopres_t_res_44007;\n                int64_t loopres_t_res_44008;\n                bool x_44009;\n                int64_t loopres_t_res_44010;\n                int64_t loopres_t_res_44011;\n                \n                cond_44006 = sle32(aprev_43976, bcur_43986);\n                if (cond_44006) {\n                    loopres_t_res_44007 = ai_43965;\n                } else {\n                    loopres_t_res_44007 = na_37612;\n                }\n                if (cond_44006) {\n                    loopres_t_res_44008 = bi_43966;\n                } else {\n                    loopres_t_res_44008 = nb_37613;\n                }\n                x_44009 = !cond_44006;\n                if (cond_44006) {\n                    loopres_t_res_44010 = p_43960;\n                    loopres_t_res_44011 = p_43962;\n                } else {\n                    int64_t tmp_44012;\n                    int64_t tmp_44013;\n                    \n                    tmp_44012 = sub64(ai_43965, (int64_t) 1);\n                    tmp_44013 = add64((int64_t) 1, bi_43966);\n                    loopres_t_res_44010 = tmp_44012;\n                    loopres_t_res_44011 = tmp_44013;\n                }\n                loopres_44000 = p_43958;\n                loopres_44001 = loopres_t_res_44007;\n                loop",
                                    "res_44002 = loopres_t_res_44010;\n                loopres_44003 = loopres_t_res_44008;\n                loopres_44004 = loopres_t_res_44011;\n                loopres_44005 = x_44009;\n            } else {\n                int64_t tmp_44014 = add64((int64_t) 1, ai_43965);\n                \n                loopres_44000 = tmp_44014;\n                loopres_44001 = na_37612;\n                loopres_44002 = p_43960;\n                loopres_44003 = nb_37613;\n                loopres_44004 = p_43962;\n                loopres_44005 = 1;\n            }\n            loop_while_tmp_48114 = loopres_44005;\n            p_tmp_48115 = loopres_44000;\n            p_tmp_48116 = loopres_44001;\n            p_tmp_48117 = loopres_44002;\n            p_tmp_48118 = loopres_44003;\n            p_tmp_48119 = loopres_44004;\n            loop_while_43957 = loop_while_tmp_48114;\n            p_43958 = p_tmp_48115;\n            p_43959 = p_tmp_48116;\n            p_43960 = p_tmp_48117;\n            p_43961 = p_tmp_48118;\n            p_43962 = p_tmp_48119;\n        }\n        lifted_lambda_res_43951 = loop_while_43957;\n        lifted_lambda_res_43952 = p_43958;\n        lifted_lambda_res_43953 = p_43959;\n        lifted_lambda_res_43954 = p_43960;\n        lifted_lambda_res_43955 = p_43961;\n        lifted_lambda_res_43956 = p_43962;\n        ((__global int64_t *) mem_47848)[gtid_43942] = lifted_lambda_res_43953;\n        ((__global int64_t *) mem_47850)[gtid_43942] = lifted_lambda_res_43955;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_43938\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezigpuseq_48446_dim1, 1, 1)\nvoid sortColumn_doublezigpuseq_48446(__global int *global_failure, int64_t m_43253, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47866, __global unsigned char *mem_47867, __global unsigned char *mem_47868, __global unsigned char *mem_47869)\n{\n    if (*global_failure >= 0)\n    ", "    return;\n    \n    int32_t local_tid_48448;\n    int32_t tblock_sizze_48451;\n    int32_t wave_sizze_48450;\n    int32_t block_id_48449;\n    int32_t global_tid_48447;\n    int64_t tid_48446;\n    int16_t last_res_47806;\n    int16_t last_res_47808;\n    int16_t last_res_47810;\n    int16_t last_res_47812;\n    \n    local_tid_48448 = get_local_id(0);\n    tblock_sizze_48451 = get_local_size(0);\n    wave_sizze_48450 = LOCKSTEP_WIDTH;\n    block_id_48449 = get_tblock_id(0);\n    global_tid_48447 = block_id_48449 * tblock_sizze_48451 + local_tid_48448;\n    tid_48446 = sext_i32_i64(global_tid_48447);\n    last_res_47806 = ((__global int16_t *) mem_47857)[m_43253];\n    last_res_47808 = ((__global int16_t *) mem_47859)[m_43253];\n    last_res_47810 = ((__global int16_t *) mem_47861)[m_43253];\n    last_res_47812 = ((__global int16_t *) mem_47863)[m_43253];\n    ((__global int16_t *) mem_47866)[(int64_t) 0] = last_res_47806;\n    ((__global int16_t *) mem_47867)[(int64_t) 0] = last_res_47808;\n    ((__global int16_t *) mem_47868)[(int64_t) 0] = last_res_47810;\n    ((__global int16_t *) mem_47869)[(int64_t) 0] = last_res_47812;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezigpuseq_48854_dim1, 1, 1)\nvoid sortColumn_doublezigpuseq_48854(__global int *global_failure, __global unsigned char *ext_mem_47871, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47984, __global unsigned char *mem_47985, __global unsigned char *mem_47986, __global unsigned char *mem_47987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48856;\n    int32_t tblock_sizze_48859;\n    int32_t wave_sizze_48858;\n    int32_t block_id_48857;\n    int32_t global_tid_48855;\n    int64_t tid_48854;\n    int16_t defunc_0_radix_sort_step_i16_res_47825;\n    int16_t defunc_0_radix_sort_step_i16_res_47826;\n    int16_t defunc_0_radix_sort_step_i16_res_47827;\n    int16_t defunc_0_radix_sort_step_i16", "_res_47828;\n    int16_t tmp_47833;\n    int16_t tmp_47837;\n    \n    local_tid_48856 = get_local_id(0);\n    tblock_sizze_48859 = get_local_size(0);\n    wave_sizze_48858 = LOCKSTEP_WIDTH;\n    block_id_48857 = get_tblock_id(0);\n    global_tid_48855 = block_id_48857 * tblock_sizze_48859 + local_tid_48856;\n    tid_48854 = sext_i32_i64(global_tid_48855);\n    defunc_0_radix_sort_step_i16_res_47825 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47826 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47827 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47828 = ((__global int16_t *) ext_mem_47871)[(int64_t) 0];\n    ((__global int16_t *) mem_47984)[(int64_t) 0] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47984)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47826;\n    ((__global int16_t *) mem_47984)[(int64_t) 2] = defunc_0_radix_sort_step_i16_res_47827;\n    ((__global int16_t *) mem_47984)[(int64_t) 3] = defunc_0_radix_sort_step_i16_res_47828;\n    tmp_47833 = add16(defunc_0_radix_sort_step_i16_res_47825, defunc_0_radix_sort_step_i16_res_47826);\n    tmp_47837 = add16(defunc_0_radix_sort_step_i16_res_47827, tmp_47833);\n    ((__global int16_t *) mem_47985)[(int64_t) 0] = (int16_t) 0;\n    ((__global int16_t *) mem_47985)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47985)[(int64_t) 2] = tmp_47833;\n    ((__global int16_t *) mem_47985)[(int64_t) 3] = tmp_47837;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47986)[i_0] = ((__global int16_t *) mem_47984)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47987)[i_0] = ((__global int16_t *) mem_47985)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_45919_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_45919(__global int",
                                    " *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_43230, int64_t arg_43231, int64_t num_tblocks_45924, int32_t virt_num_tblocks_48452, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47876, __global unsigned char *mem_47878)\n{\n    #define segmap_tblock_sizze_45922 (sortColumn_doublezisegmap_45919zisegmap_tblock_sizze_45922)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48454;\n    int32_t tblock_sizze_48457;\n    int32_t wave_sizze_48456;\n    int32_t block_id_48455;\n    int32_t global_tid_48453;\n    int64_t phys_tid_45919;\n    int32_t phys_tblock_id_48458;\n    int32_t iterations_48459;\n    \n    local_tid_48454 = get_local_id(0);\n    tblock_sizze_48457 = get_local_size(0);\n    wave_sizze_48456 = LOCKSTEP_WIDTH;\n    block_id_48455 = get_tblock_id(0);\n    global_tid_48453 = block_id_48455 * tblock_sizze_48457 + local_tid_48454;\n    phys_tid_45919 = sext_i32_i64(global_tid_48453);\n    phys_tblock_id_48458 = get_tblock_id(0);\n    iterations_48459 = sdiv_up32(virt_num_tblocks_48452 - phys_tblock_id_48458, sext_i64_i32(num_tblocks_45924));\n    for (int32_t i_48460 = 0; i_48460 < iterations_48459; i_48460++) {\n        int32_t virt_tblock_id_48461;\n        int64_t global_tid_48462;\n        int64_t slice_48463;\n        int64_t write_i_45918;\n        int64_t remnant_48464;\n        \n        virt_tblock_id_48461 = phys_tblock_id_48458 + i_48460 * sext_i64_i32(num_tblocks_45924);\n        global_tid_48462 = sext_i32_i64(virt_tblock_id_48461) * segmap_tblock_sizze_45922 + sext_i32_i64(local_tid_48454);\n ", "       slice_48463 = rest_43230;\n        write_i_45918 = global_tid_48462;\n        remnant_48464 = global_tid_48462 - write_i_45918;\n        if (slt64(write_i_45918, rest_43230)) {\n            int16_t defunc_0_radix_sort_step_i16_res_47822;\n            int16_t defunc_0_radix_sort_step_i16_res_47823;\n            int16_t defunc_0_radix_sort_step_i16_res_47824;\n            int16_t eta_p_43656;\n            int16_t eta_p_43657;\n            int16_t eta_p_43658;\n            int16_t eta_p_43659;\n            int16_t eta_p_43660;\n            int64_t slice_46965;\n            double write_value_43661;\n            int64_t write_value_43662;\n            int64_t defunc_0_f_res_43663;\n            \n            defunc_0_radix_sort_step_i16_res_47822 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47823 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47824 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n            eta_p_43656 = ((__global int16_t *) mem_47865)[write_i_45918];\n            eta_p_43657 = ((__global int16_t *) mem_47857)[write_i_45918];\n            eta_p_43658 = ((__global int16_t *) mem_47859)[write_i_45918];\n            eta_p_43659 = ((__global int16_t *) mem_47861)[write_i_45918];\n            eta_p_43660 = ((__global int16_t *) mem_47863)[write_i_45918];\n            slice_46965 = arg_43231 + write_i_45918;\n            write_value_43661 = ((__global double *) mem_47846)[slice_46965];\n            write_value_43662 = ((__global int64_t *) mem_47848)[slice_46965];\n            futrts_lifted_f_7536(&defunc_0_f_res_43663, defunc_0_radix_sort_step_i16_res_47822, defunc_0_radix_sort_step_i16_res_47823, defunc_0_radix_sort_step_i16_res_47824, eta_p_43656, eta_p_43657, eta_p_43658, eta_p_43659, eta_p_43660);\n            if (sle64((int64_t) 0, defunc_0_f_res_43663) && slt64(defunc_0_f_res_43663, rest_43230)) {\n                ((__global double *) mem_47878)[defunc_0_f_res_4366", "3] = write_value_43661;\n            }\n            if (sle64((int64_t) 0, defunc_0_f_res_43663) && slt64(defunc_0_f_res_43663, rest_43230)) {\n                ((__global int64_t *) mem_47876)[defunc_0_f_res_43663] = write_value_43662;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45922\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_45941_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_45941(__global int *global_failure, __global unsigned char *mem_47986, __global unsigned char *mem_47989)\n{\n    #define segmap_tblock_sizze_45937 (sortColumn_doublezisegmap_45941zisegmap_tblock_sizze_45937)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48862;\n    int32_t tblock_sizze_48865;\n    int32_t wave_sizze_48864;\n    int32_t block_id_48863;\n    int32_t global_tid_48861;\n    int64_t phys_tid_45941;\n    int64_t global_tid_48866;\n    int64_t slice_48867;\n    int64_t gtid_45940;\n    int64_t remnant_48868;\n    \n    local_tid_48862 = get_local_id(0);\n    tblock_sizze_48865 = get_local_size(0);\n    wave_sizze_48864 = LOCKSTEP_WIDTH;\n    block_id_48863 = get_tblock_id(0);\n    global_tid_48861 = block_id_48863 * tblock_sizze_48865 + local_tid_48862;\n    phys_tid_45941 = sext_i32_i64(global_tid_48861);\n    global_tid_48866 = sext_i32_i64(block_id_48863) * segmap_tblock_sizze_45937 + sext_i32_i64(local_tid_48862);\n    slice_48867 = (int64_t) 4;\n    gtid_45940 = global_tid_48866;\n    remnant_48868 = global_tid_48866 - gtid_45940;\n    if (slt64(gtid_45940, (int64_t) 4)) {\n        int16_t eta_p_45942;\n        int64_t i16_res_45943;\n        \n        eta_p_45942 = ((__global int16_t *) mem_47986)[gtid_45940];\n        i16_res_45943 = sext_i16_i64(eta_p_45942);\n        ((__global int64_t *) mem_47989)[gtid_45940] = i16_res_45943;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45937\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46290_dim1, 1, 1)\nvoid so",
                                    "rtColumn_doublezisegmap_46290(__global int *global_failure, int64_t i16_res_43225, unsigned char zzero_43226_bits, unsigned char nonzzero_43227_bits, int64_t n_blocks_43229, int64_t tmp_43268, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    bool zzero_43226 = zzero_43226_bits;\n    bool nonzzero_43227 = nonzzero_43227_bits;\n    \n    #define segmap_tblock_sizze_46283 (sortColumn_doublezisegmap_46290zisegmap_tblock_sizze_46283)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48794;\n    int32_t tblock_sizze_48797;\n    int32_t wave_sizze_48796;\n    int32_t block_id_48795;\n    int32_t global_tid_48793;\n    int64_t phys_tid_46290;\n    int64_t global_tid_48798;\n    int64_t slice_48799;\n    int64_t gtid_46289;\n    int64_t remnant_48800;\n    \n    local_tid_48794 = get_local_id(0);\n    tblock_sizze_48797 = get_local_size(0);\n    wave_sizze_48796 = LOCKSTEP_WIDTH;\n    block_id_48795 = get_tblock_id(0);\n    global_tid_48793 = block_id_48795 * tblock_sizze_48797 + local_tid_48794;\n    phys_tid_46290 = sext_i32_i64(global_tid_48793);\n    global_tid_48798 = sext_i32_i64(block_id_48795) * segmap_tblock_sizze_46283 + sext_i32_i64(local_tid_48794);\n    slice_48799 = n_blocks_43229;\n    gtid_46289 = global_tid_48798;\n    remnant_48800 = global_tid_48798 - gtid_46289;\n    if (slt64(gtid_46289, n_blocks_43229)) {\n        int16_t last_res_46299;\n        int16_t last_res_46300;\n        int16_t last_res_46301;\n        int16_t last_res_46302;\n        int16_t defunc_0_f_res_46295;\n        int16_t defunc_0_f_res_46296;\n        int16_t defunc_0_f_res_46297;\n        int16_t defunc_0_f_res_46298;\n        \n        if (nonzzero_43227) {\n            int16_t x_46956 = ((__global int16_t *) mem_47889)[gtid_46289 * i16_res_43225 + tmp_43268];\n ", "           \n            last_res_46299 = x_46956;\n        } else {\n            last_res_46299 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46958 = ((__global int16_t *) mem_47892)[gtid_46289 * i16_res_43225 + tmp_43268];\n            \n            last_res_46300 = x_46958;\n        } else {\n            last_res_46300 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46960 = ((__global int16_t *) mem_47895)[gtid_46289 * i16_res_43225 + tmp_43268];\n            \n            last_res_46301 = x_46960;\n        } else {\n            last_res_46301 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46962 = ((__global int16_t *) mem_47898)[gtid_46289 * i16_res_43225 + tmp_43268];\n            \n            last_res_46302 = x_46962;\n        } else {\n            last_res_46302 = (int16_t) 0;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_46295 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46295 = last_res_46299;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_46296 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46296 = last_res_46300;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_46297 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46297 = last_res_46301;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_46298 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46298 = last_res_46302;\n        }\n        ((__global int16_t *) mem_47904)[gtid_46289] = defunc_0_f_res_46298;\n        ((__global int16_t *) mem_47906)[gtid_46289] = defunc_0_f_res_46295;\n        ((__global int16_t *) mem_47908)[gtid_46289] = defunc_0_f_res_46296;\n        ((__global int16_t *) mem_47910)[gtid_46289] = defunc_0_f_res_46297;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46283\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46312_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46312(__global int *global_fai", "lure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int64_t num_tblocks_46306, int32_t virt_num_tblocks_48801, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47882, __global unsigned char *mem_47885, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    #define segmap_tblock_sizze_46305 (sortColumn_doublezisegmap_46312zisegmap_tblock_sizze_46305)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48803;\n    int32_t tblock_sizze_48806;\n    int32_t wave_sizze_48805;\n    int32_t block_id_48804;\n    int32_t global_tid_48802;\n    int64_t phys_tid_46312;\n    int32_t phys_tblock_id_48807;\n    int32_t iterations_48808;\n    \n    local_tid_48803 = get_local_id(0);\n    tblock_sizze_48806 = get_local_size(0);\n    wave_sizze_48805 = LOCKSTEP_WIDTH;\n    block_id_48804 = get_tblock_id(0);\n    global_tid_48802 = block_id_48804 * tblock_sizze_48806 + local_tid_48803;\n    phys_tid_46312 = sext_i32_i64(global_tid_48802);\n    phys_tblock_id_48807 = get_tblock_id(0);\n    iterations_48808 = sdiv_up32(virt_num_tblocks_48801 - phys_tblock_id_48807, sext_i64_i32(num_tblocks_46306));\n    for (int32_t i_48809 = 0; i_48809 < iterations_48808; i_48809++) {\n        int32_t virt_tblock_id_48810;\n        int64_t global_tid_48811;\n        int64_t slice_48812;\n        int64_t slice_48813;\n        int64_t gtid_46310;\n        int64_t remnant_48814;\n        int64_t gtid_46311;\n        int64_t remnant_48815;\n        \n        virt_tblock_id_48810 = phys_tblock_id_48807 + i_48809 * sext_i64_i32(num_tblocks_46306);\n        global_tid_48811 = sext_i32_i64(virt_tblock_id_",
                                    "48810) * segmap_tblock_sizze_46305 + sext_i32_i64(local_tid_48803);\n        slice_48812 = i16_res_43225;\n        slice_48813 = n_blocks_43229 * slice_48812;\n        gtid_46310 = squot64(global_tid_48811, slice_48812);\n        remnant_48814 = global_tid_48811 - gtid_46310 * slice_48812;\n        gtid_46311 = remnant_48814;\n        remnant_48815 = remnant_48814 - gtid_46311;\n        if (slt64(gtid_46310, n_blocks_43229) && slt64(gtid_46311, i16_res_43225)) {\n            int16_t defunc_0_f_res_46313;\n            int16_t defunc_0_f_res_46314;\n            int16_t defunc_0_f_res_46315;\n            int16_t eta_p_46316;\n            int16_t eta_p_46317;\n            int16_t eta_p_46318;\n            int16_t eta_p_46319;\n            int16_t eta_p_46320;\n            int64_t binop_x_46950;\n            int64_t new_index_46951;\n            double write_value_46321;\n            int64_t write_value_46322;\n            int64_t defunc_0_f_res_46323;\n            \n            defunc_0_f_res_46313 = ((__global int16_t *) mem_47906)[gtid_46310];\n            defunc_0_f_res_46314 = ((__global int16_t *) mem_47908)[gtid_46310];\n            defunc_0_f_res_46315 = ((__global int16_t *) mem_47910)[gtid_46310];\n            eta_p_46316 = ((__global int16_t *) mem_47901)[gtid_46310 * i16_res_43225 + gtid_46311];\n            eta_p_46317 = ((__global int16_t *) mem_47889)[gtid_46310 * i16_res_43225 + gtid_46311];\n            eta_p_46318 = ((__global int16_t *) mem_47892)[gtid_46310 * i16_res_43225 + gtid_46311];\n            eta_p_46319 = ((__global int16_t *) mem_47895)[gtid_46310 * i16_res_43225 + gtid_46311];\n            eta_p_46320 = ((__global int16_t *) mem_47898)[gtid_46310 * i16_res_43225 + gtid_46311];\n            binop_x_46950 = i16_res_43225 * gtid_46310;\n            new_index_46951 = gtid_46311 + binop_x_46950;\n            write_value_46321 = ((__global double *) mem_47846)[new_index_46951];\n            write_value_46322 = ((__global int64_t *) mem_47848)[new_index_46951];\n            futrts", "_lifted_f_7536(&defunc_0_f_res_46323, defunc_0_f_res_46313, defunc_0_f_res_46314, defunc_0_f_res_46315, eta_p_46316, eta_p_46317, eta_p_46318, eta_p_46319, eta_p_46320);\n            if ((sle64((int64_t) 0, gtid_46310) && slt64(gtid_46310, n_blocks_43229)) && (sle64((int64_t) 0, defunc_0_f_res_46323) && slt64(defunc_0_f_res_46323, i16_res_43225))) {\n                ((__global double *) mem_47882)[gtid_46310 * i16_res_43225 + defunc_0_f_res_46323] = write_value_46321;\n            }\n            if ((sle64((int64_t) 0, gtid_46310) && slt64(gtid_46310, n_blocks_43229)) && (sle64((int64_t) 0, defunc_0_f_res_46323) && slt64(defunc_0_f_res_46323, i16_res_43225))) {\n                ((__global int64_t *) mem_47885)[gtid_46310 * i16_res_43225 + defunc_0_f_res_46323] = write_value_46322;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46305\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46330_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46330(__global int *global_failure, int64_t n_blocks_43229, int64_t num_tblocks_46326, int32_t virt_num_tblocks_48816, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47927)\n{\n    #define segmap_tblock_sizze_46325 (sortColumn_doublezisegmap_46330zisegmap_tblock_sizze_46325)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48818;\n    int32_t tblock_sizze_48821;\n    int32_t wave_sizze_48820;\n    int32_t block_id_48819;\n    int32_t global_tid_48817;\n    int64_t phys_tid_46330;\n    int32_t phys_tblock_id_48822;\n    int32_t iterations_48823;\n    \n    local_tid_48818 = get_local_id(0);\n    tblock_sizze_48821 = get_local_size(0);\n    wave_sizze_48820 = LOCKSTEP_WIDTH;\n    block_id_48819 = get_tblock_id(0);\n    global_tid_48817 = block_id_48819 * tblock_sizze_48821 + local_tid_48818;\n    phys_tid_46330 = sext_i3", "2_i64(global_tid_48817);\n    phys_tblock_id_48822 = get_tblock_id(0);\n    iterations_48823 = sdiv_up32(virt_num_tblocks_48816 - phys_tblock_id_48822, sext_i64_i32(num_tblocks_46326));\n    for (int32_t i_48824 = 0; i_48824 < iterations_48823; i_48824++) {\n        int32_t virt_tblock_id_48825;\n        int64_t global_tid_48826;\n        int64_t slice_48827;\n        int64_t gtid_46329;\n        int64_t remnant_48828;\n        \n        virt_tblock_id_48825 = phys_tblock_id_48822 + i_48824 * sext_i64_i32(num_tblocks_46326);\n        global_tid_48826 = sext_i32_i64(virt_tblock_id_48825) * segmap_tblock_sizze_46325 + sext_i32_i64(local_tid_48818);\n        slice_48827 = n_blocks_43229;\n        gtid_46329 = global_tid_48826;\n        remnant_48828 = global_tid_48826 - gtid_46329;\n        if (slt64(gtid_46329, n_blocks_43229)) {\n            int16_t defunc_0_f_res_46331;\n            int16_t defunc_0_f_res_46332;\n            int16_t defunc_0_f_res_46333;\n            int16_t defunc_0_f_res_46334;\n            int16_t mem_47917[(int64_t) 4];\n            \n            defunc_0_f_res_46331 = ((__global int16_t *) mem_47906)[gtid_46329];\n            defunc_0_f_res_46332 = ((__global int16_t *) mem_47908)[gtid_46329];\n            defunc_0_f_res_46333 = ((__global int16_t *) mem_47910)[gtid_46329];\n            defunc_0_f_res_46334 = ((__global int16_t *) mem_47904)[gtid_46329];\n            mem_47917[(int64_t) 0] = defunc_0_f_res_46331;\n            mem_47917[(int64_t) 1] = defunc_0_f_res_46332;\n            mem_47917[(int64_t) 2] = defunc_0_f_res_46333;\n            mem_47917[(int64_t) 3] = defunc_0_f_res_46334;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47927)[gtid_46329 + i_0 * n_blocks_43229] = mem_47917[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46325\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46347_dim1, 1, 1)\nvoi",
                                    "d sortColumn_doublezisegmap_46347(__global int *global_failure, int64_t n_blocks_43229, __global unsigned char *mem_47927, __global unsigned char *mem_47931)\n{\n    #define segmap_tblock_sizze_46342 (sortColumn_doublezisegmap_46347zisegmap_tblock_sizze_46342)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48831;\n    int32_t tblock_sizze_48834;\n    int32_t wave_sizze_48833;\n    int32_t block_id_48832;\n    int32_t global_tid_48830;\n    int64_t phys_tid_46347;\n    int64_t global_tid_48835;\n    int64_t slice_48836;\n    int64_t slice_48837;\n    int64_t gtid_46345;\n    int64_t remnant_48838;\n    int64_t gtid_46346;\n    int64_t remnant_48839;\n    \n    local_tid_48831 = get_local_id(0);\n    tblock_sizze_48834 = get_local_size(0);\n    wave_sizze_48833 = LOCKSTEP_WIDTH;\n    block_id_48832 = get_tblock_id(0);\n    global_tid_48830 = block_id_48832 * tblock_sizze_48834 + local_tid_48831;\n    phys_tid_46347 = sext_i32_i64(global_tid_48830);\n    global_tid_48835 = sext_i32_i64(block_id_48832) * segmap_tblock_sizze_46342 + sext_i32_i64(local_tid_48831);\n    slice_48836 = (int64_t) 4;\n    slice_48837 = n_blocks_43229 * slice_48836;\n    gtid_46345 = squot64(global_tid_48835, slice_48836);\n    remnant_48838 = global_tid_48835 - gtid_46345 * slice_48836;\n    gtid_46346 = remnant_48838;\n    remnant_48839 = remnant_48838 - gtid_46346;\n    if (slt64(gtid_46345, n_blocks_43229) && slt64(gtid_46346, (int64_t) 4)) {\n        int16_t eta_p_46348;\n        int64_t i16_res_46349;\n        \n        eta_p_46348 = ((__global int16_t *) mem_47927)[gtid_46345 + gtid_46346 * n_blocks_43229];\n        i16_res_46349 = sext_i16_i64(eta_p_46348);\n        ((__global int64_t *) mem_47931)[gtid_46345 * (int64_t) 4 + gtid_46346] = i16_res_46349;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46342\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46357_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46357(__global int *global_failure, int64_t n_blocks_43229, int64_t num_tbloc", "ks_46353, int32_t virt_num_tblocks_48840, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47947)\n{\n    #define segmap_tblock_sizze_46352 (sortColumn_doublezisegmap_46357zisegmap_tblock_sizze_46352)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48842;\n    int32_t tblock_sizze_48845;\n    int32_t wave_sizze_48844;\n    int32_t block_id_48843;\n    int32_t global_tid_48841;\n    int64_t phys_tid_46357;\n    int32_t phys_tblock_id_48846;\n    int32_t iterations_48847;\n    \n    local_tid_48842 = get_local_id(0);\n    tblock_sizze_48845 = get_local_size(0);\n    wave_sizze_48844 = LOCKSTEP_WIDTH;\n    block_id_48843 = get_tblock_id(0);\n    global_tid_48841 = block_id_48843 * tblock_sizze_48845 + local_tid_48842;\n    phys_tid_46357 = sext_i32_i64(global_tid_48841);\n    phys_tblock_id_48846 = get_tblock_id(0);\n    iterations_48847 = sdiv_up32(virt_num_tblocks_48840 - phys_tblock_id_48846, sext_i64_i32(num_tblocks_46353));\n    for (int32_t i_48848 = 0; i_48848 < iterations_48847; i_48848++) {\n        int32_t virt_tblock_id_48849;\n        int64_t global_tid_48850;\n        int64_t slice_48851;\n        int64_t gtid_46356;\n        int64_t remnant_48852;\n        \n        virt_tblock_id_48849 = phys_tblock_id_48846 + i_48848 * sext_i64_i32(num_tblocks_46353);\n        global_tid_48850 = sext_i32_i64(virt_tblock_id_48849) * segmap_tblock_sizze_46352 + sext_i32_i64(local_tid_48842);\n        slice_48851 = n_blocks_43229;\n        gtid_46356 = global_tid_48850;\n        remnant_48852 = global_tid_48850 - gtid_46356;\n        if (slt64(gtid_46356, n_blocks_43229)) {\n            int16_t defunc_0_f_res_46358;\n            int16_t defunc_0_f_res_46359;\n            int16_t defunc_0_f_res_46360;\n            int16_t tmp_46361;\n            int16_t tmp_46362;\n            int16_t mem_47937[(int64_t) 4];\n            \n            defunc_0_f_res_46358 = ((__global int16_t *) mem_47906)[gtid_46356];\n  ", "          defunc_0_f_res_46359 = ((__global int16_t *) mem_47908)[gtid_46356];\n            defunc_0_f_res_46360 = ((__global int16_t *) mem_47910)[gtid_46356];\n            tmp_46361 = add16(defunc_0_f_res_46358, defunc_0_f_res_46359);\n            tmp_46362 = add16(defunc_0_f_res_46360, tmp_46361);\n            mem_47937[(int64_t) 0] = (int16_t) 0;\n            mem_47937[(int64_t) 1] = defunc_0_f_res_46358;\n            mem_47937[(int64_t) 2] = tmp_46361;\n            mem_47937[(int64_t) 3] = tmp_46362;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47947)[gtid_46356 + i_0 * n_blocks_43229] = mem_47937[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46352\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46393_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46393(__global int *global_failure, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, __global unsigned char *mem_47992, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_46389 (sortColumn_doublezisegmap_46393zisegmap_tblock_sizze_46389)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48973;\n    int32_t tblock_sizze_48976;\n    int32_t wave_sizze_48975;\n    int32_t block_id_48974;\n    int32_t global_tid_48972;\n    int64_t phys_tid_46393;\n    int64_t global_tid_48977;\n    int64_t slice_48978;\n    int64_t gtid_46392;\n    int64_t remnant_48979;\n    \n    local_tid_48973 = get_local_id(0);\n    tblock_sizze_48976 = get_local_size(0);\n    wave_sizze_48975 = LOCKSTEP_WIDTH;\n    block_id_48974 = get_tblock_id(0);\n    global_tid_48972 = block_id_48974 * tblock_sizze_48976 + local_tid_48973;\n    phys_tid_46393 = sext_i32_i64(global_tid_48972);\n    global_tid_48977 = sext_i32_i64(block_id_48974) * segmap_tblock_sizze_46389 + sext_i32_i64(local_tid_48973);\n    slice_48978 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7d",
                                    "Uzg_43240;\n    gtid_46392 = global_tid_48977;\n    remnant_48979 = global_tid_48977 - gtid_46392;\n    if (slt64(gtid_46392, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n        int64_t zv_lhs_46395;\n        int64_t tmp_46396;\n        int64_t lifted_lambda_res_46397;\n        \n        zv_lhs_46395 = add64((int64_t) -1, gtid_46392);\n        tmp_46396 = smod64(zv_lhs_46395, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);\n        lifted_lambda_res_46397 = ((__global int64_t *) mem_47992)[tmp_46396];\n        ((__global int64_t *) mem_47995)[gtid_46392] = lifted_lambda_res_46397;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46389\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46399_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46399(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int64_t arg_43231, int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, int32_t blocked_radix_sort_step_arg1_43293, int64_t num_tblocks_46404, int64_t ext_47978, int64_t ext_47979, int32_t virt_num_tblocks_48980, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47876, __global unsigned char *mem_47878, __global unsigned char *ext_mem_47980, __global unsigned char *ext_mem_47982, __global unsigned char *ext_mem_47983, __global unsigned char *mem_47987, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_46402 (sortColumn_doublezisegmap_46399zisegmap_tblock_sizze_46402)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_48982;\n    int32_t tblock_sizze_48985;\n    int32_t wave_sizze_48984;\n    int32_t block_id_48983;\n    int32", "_t global_tid_48981;\n    int64_t phys_tid_46399;\n    int32_t phys_tblock_id_48986;\n    int32_t iterations_48987;\n    \n    local_tid_48982 = get_local_id(0);\n    tblock_sizze_48985 = get_local_size(0);\n    wave_sizze_48984 = LOCKSTEP_WIDTH;\n    block_id_48983 = get_tblock_id(0);\n    global_tid_48981 = block_id_48983 * tblock_sizze_48985 + local_tid_48982;\n    phys_tid_46399 = sext_i32_i64(global_tid_48981);\n    phys_tblock_id_48986 = get_tblock_id(0);\n    iterations_48987 = sdiv_up32(virt_num_tblocks_48980 - phys_tblock_id_48986, sext_i64_i32(num_tblocks_46404));\n    for (int32_t i_48988 = 0; i_48988 < iterations_48987; i_48988++) {\n        int32_t virt_tblock_id_48989;\n        int64_t global_tid_48990;\n        int64_t slice_48991;\n        int64_t write_i_46398;\n        int64_t remnant_48992;\n        \n        virt_tblock_id_48989 = phys_tblock_id_48986 + i_48988 * sext_i64_i32(num_tblocks_46404);\n        global_tid_48990 = sext_i32_i64(virt_tblock_id_48989) * segmap_tblock_sizze_46402 + sext_i32_i64(local_tid_48982);\n        slice_48991 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;\n        write_i_46398 = global_tid_48990;\n        remnant_48992 = global_tid_48990 - write_i_46398;\n        if (slt64(write_i_46398, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n            bool index_concat_cmp_46931;\n            double index_concat_branch_43604;\n            int64_t i64_arg0_43611;\n            int64_t unsign_arg0_43612;\n            int64_t unsign_arg0_43613;\n            int32_t to_i32_res_43614;\n            bool cond_43615;\n            bool x_43616;\n            int32_t zlzb_rhs_43617;\n            int32_t acc_43619;\n            int64_t i32_res_43632;\n            int64_t block_idx_43633;\n            bool x_43634;\n            bool y_43635;\n            bool bounds_check_43636;\n            bool index_certs_43637;\n            bool x_43638;\n            bool y_43639;\n            bool bounds_check_43640;\n            bool index_", "certs_43641;\n            double index_concat_branch_46935;\n            int64_t index_concat_branch_46929;\n            int64_t binop_x_43642;\n            int64_t new_index_43643;\n            int64_t new_offset_43644;\n            bool index_concat_cmp_43645;\n            int16_t index_concat_branch_43646;\n            int64_t i16_res_43649;\n            int64_t zp_lhs_43650;\n            int64_t old_offset_43651;\n            int64_t zp_lhs_43652;\n            int64_t idx_43653;\n            \n            index_concat_cmp_46931 = sle64(arg_43231, write_i_46398);\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_43833;\n                double index_concat_43834;\n                \n                index_concat_i_43833 = sub64(write_i_46398, arg_43231);\n                index_concat_43834 = ((__global double *) mem_47878)[index_concat_i_43833];\n                index_concat_branch_43604 = index_concat_43834;\n            } else {\n                int64_t new_index_43607;\n                int64_t binop_y_43608;\n                int64_t new_index_43609;\n                double index_concat_43610;\n                \n                new_index_43607 = squot64(write_i_46398, i16_res_43225);\n                binop_y_43608 = i16_res_43225 * new_index_43607;\n                new_index_43609 = write_i_46398 - binop_y_43608;\n                index_concat_43610 = ((__global double *) ext_mem_47983)[new_index_43607 * i16_res_43225 + new_index_43609];\n                index_concat_branch_43604 = index_concat_43610;\n            }\n            i64_arg0_43611 = futrts_to_bits64(index_concat_branch_43604);\n            unsign_arg0_43612 = ashr64(i64_arg0_43611, (int64_t) 63);\n            unsign_arg0_43613 = (int64_t) 1 & unsign_arg0_43612;\n            to_i32_res_43614 = zext_i64_i32(unsign_arg0_43613);\n            cond_43615 = to_i32_res_43614 == 1;\n            x_43616 = !cond_43615;\n            acc_43619 = 0;\n            for (int32_t i_43618 = 0; i_43618 < 2; i_43618++) {\n          ",
                                    "      int32_t get_bit_arg0_43620;\n                int64_t unsign_arg0_43621;\n                int64_t unsign_arg0_43622;\n                int64_t unsign_arg0_43623;\n                int32_t to_i32_res_43624;\n                bool cond_f_res_43625;\n                bool y_43626;\n                bool cond_43627;\n                int32_t defunc_0_get_bit_res_43628;\n                int32_t zp_rhs_43630;\n                int32_t loopres_43631;\n                int32_t acc_tmp_48993;\n                \n                get_bit_arg0_43620 = add32(blocked_radix_sort_step_arg1_43293, i_43618);\n                unsign_arg0_43621 = zext_i32_i64(get_bit_arg0_43620);\n                unsign_arg0_43622 = ashr64(i64_arg0_43611, unsign_arg0_43621);\n                unsign_arg0_43623 = (int64_t) 1 & unsign_arg0_43622;\n                to_i32_res_43624 = zext_i64_i32(unsign_arg0_43623);\n                cond_f_res_43625 = get_bit_arg0_43620 == 63;\n                y_43626 = x_43616 && cond_f_res_43625;\n                cond_43627 = cond_43615 || y_43626;\n                if (cond_43627) {\n                    int32_t defunc_0_get_bit_res_t_res_43835 = 1 ^ to_i32_res_43624;\n                    \n                    defunc_0_get_bit_res_43628 = defunc_0_get_bit_res_t_res_43835;\n                } else {\n                    defunc_0_get_bit_res_43628 = to_i32_res_43624;\n                }\n                zp_rhs_43630 = shl32(defunc_0_get_bit_res_43628, i_43618);\n                loopres_43631 = add32(acc_43619, zp_rhs_43630);\n                acc_tmp_48993 = loopres_43631;\n                acc_43619 = acc_tmp_48993;\n            }\n            zlzb_rhs_43617 = acc_43619;\n            i32_res_43632 = sext_i32_i64(zlzb_rhs_43617);\n            block_idx_43633 = sdiv64(write_i_46398, i16_res_43225);\n            x_43634 = sle64((int64_t) 0, block_idx_43633);\n            y_43635 = slt64(block_idx_43633, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);\n            bounds_check_43636 = x_43634 && y_43635;\n            if (!bounds_chec", "k_43636) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                        global_failure_args[0] = (int64_t) block_idx_43633;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_43638 = sle64((int64_t) 0, i32_res_43632);\n            y_43639 = slt64(i32_res_43632, (int64_t) 4);\n            bounds_check_43640 = x_43638 && y_43639;\n            if (!bounds_check_43640) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 10) == -1) {\n                        global_failure_args[0] = (int64_t) i32_res_43632;\n                        global_failure_args[1] = (int64_t) (int64_t) 4;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46932;\n                double index_concat_46933;\n                \n                index_concat_i_46932 = sub64(write_i_46398, arg_43231);\n                index_concat_46933 = ((__global double *) mem_47878)[index_concat_i_46932];\n                index_concat_branch_46935 = index_concat_46933;\n            } else {\n                int64_t new_index_46972;\n                int64_t binop_y_46974;\n                int64_t new_index_46975;\n                double index_concat_46934;\n                \n                new_index_46972 = squot64(write_i_46398, i16_res_43225);\n                binop_y_46974 = i16_res_43225 * new_index_46972;\n                new_index_46975 = write_i_46398 - binop_y_46974;\n                index_concat_46934 = ((__global double *) ext_mem_47983)[new_index_46972 * i16_res_43225 + new_index_46975];\n                index_concat_branch_46935 = index_co", "ncat_46934;\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46926;\n                int64_t index_concat_46927;\n                \n                index_concat_i_46926 = sub64(write_i_46398, arg_43231);\n                index_concat_46927 = ((__global int64_t *) mem_47876)[index_concat_i_46926];\n                index_concat_branch_46929 = index_concat_46927;\n            } else {\n                int64_t new_index_46968;\n                int64_t binop_y_46970;\n                int64_t new_index_46971;\n                int64_t index_concat_46928;\n                \n                new_index_46968 = squot64(write_i_46398, i16_res_43225);\n                binop_y_46970 = i16_res_43225 * new_index_46968;\n                new_index_46971 = write_i_46398 - binop_y_46970;\n                index_concat_46928 = ((__global int64_t *) ext_mem_47982)[new_index_46968 * i16_res_43225 + new_index_46971];\n                index_concat_branch_46929 = index_concat_46928;\n            }\n            binop_x_43642 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 * i32_res_43632;\n            new_index_43643 = block_idx_43633 + binop_x_43642;\n            new_offset_43644 = ((__global int64_t *) mem_47995)[new_index_43643];\n            index_concat_cmp_43645 = sle64(n_blocks_43229, block_idx_43633);\n            if (index_concat_cmp_43645) {\n                int16_t index_concat_43836 = ((__global int16_t *) mem_47987)[i32_res_43632];\n                \n                index_concat_branch_43646 = index_concat_43836;\n            } else {\n                int16_t index_concat_43648 = ((__global int16_t *) ext_mem_47980)[block_idx_43633 * ext_47979 + i32_res_43632 * ext_47978];\n                \n                index_concat_branch_43646 = index_concat_43648;\n            }\n            i16_res_43649 = sext_i16_i64(index_concat_branch_43646);\n            zp_lhs_43650 = mul64(i16_res_43225, block_idx_43633);\n            old_offset_43651 = add64(i16_res_43649, zp_lhs_43650);\n        ",
                                    "    zp_lhs_43652 = sub64(write_i_46398, old_offset_43651);\n            idx_43653 = add64(new_offset_43644, zp_lhs_43652);\n            if (sle64((int64_t) 0, idx_43653) && slt64(idx_43653, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n                ((__global double *) mem_47846)[idx_43653] = index_concat_branch_46935;\n            }\n            if (sle64((int64_t) 0, idx_43653) && slt64(idx_43653, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n                ((__global int64_t *) mem_47848)[idx_43653] = index_concat_branch_46929;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46402\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegmap_46427_dim1, 1, 1)\nvoid sortColumn_doublezisegmap_46427(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_35607, int64_t incr_35608, __global unsigned char *xs_mem_47844, __global unsigned char *mem_47848, __global unsigned char *mem_48005, __global unsigned char *mem_48007)\n{\n    #define segmap_tblock_sizze_46422 (sortColumn_doublezisegmap_46427zisegmap_tblock_sizze_46422)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48996;\n    int32_t tblock_sizze_48999;\n    int32_t wave_sizze_48998;\n    int32_t block_id_48997;\n    int32_t global_tid_48995;\n    int64_t phys_tid_46427;\n    int64_t global_tid_49000;\n    int64_t slice_49001;\n    int64_t gtid_46426;\n    int64_t remnant_49002;\n    \n    local_tid_48996 = get_local_id(0);\n    tblock_sizze_48999 = get_local_size(0);\n    wave_sizze_48998 = LOCKSTEP_WIDTH;\n    block_id_48997 = get_tblock_id(0);\n    global_tid_48995 = block_id_48997 * tblock_sizze_48999 + local_tid_48996;\n    phys_tid_46427 = sext_i32_i64(global_tid_48995);\n    global", "_tid_49000 = sext_i32_i64(block_id_48997) * segmap_tblock_sizze_46422 + sext_i32_i64(local_tid_48996);\n    slice_49001 = n_35607;\n    gtid_46426 = global_tid_49000;\n    remnant_49002 = global_tid_49000 - gtid_46426;\n    if (slt64(gtid_46426, n_35607)) {\n        int64_t eta_p_46428;\n        bool x_46429;\n        bool y_46430;\n        bool bounds_check_46431;\n        bool index_certs_46432;\n        int64_t index_primexp_46433;\n        double lifted_lambda_res_46434;\n        \n        eta_p_46428 = ((__global int64_t *) mem_47848)[gtid_46426];\n        x_46429 = sle64((int64_t) 0, eta_p_46428);\n        y_46430 = slt64(eta_p_46428, n_35607);\n        bounds_check_46431 = x_46429 && y_46430;\n        if (!bounds_check_46431) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 11) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_46428;\n                    global_failure_args[1] = (int64_t) n_35607;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_46433 = add64(incr_35608, eta_p_46428);\n        lifted_lambda_res_46434 = ((__global double *) xs_mem_47844)[eta_p_46428];\n        ((__global int64_t *) mem_48005)[gtid_46426] = index_primexp_46433;\n        ((__global double *) mem_48007)[gtid_46426] = lifted_lambda_res_46434;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46422\n}\nFUTHARK_KERNEL\nvoid sortColumn_doublezisegmap_intrablock_45973(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, unsigned char zzero_43226_bits, int64_t n_blocks_43229, int64_t tmp_43268, int64_t unsign_arg0_43299, unsigned char cond_f_res_43300_bits, int64_t unsign_arg0_43301, unsigned char cond_f_res_43302_bits, int64_t computed_tblock_sizze_45946, int64_t bytes_47949, int64_t bytes_47953, int64_t maxSubHelper_48094, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *m", "em_47968, __global unsigned char *mem_47971, __global unsigned char *mem_47974, __global unsigned char *mem_47977)\n{\n    bool zzero_43226 = zzero_43226_bits;\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    bool cond_f_res_43302 = cond_f_res_43302_bits;\n    volatile __local unsigned char *color_48102_backing_7 = &shared_mem[0];\n    const int64_t color_48102_backing_7_offset = 0 + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48101_backing_6 = &shared_mem[color_48102_backing_7_offset];\n    const int64_t color_48101_backing_6_offset = color_48102_backing_7_offset + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48100_backing_5 = &shared_mem[color_48101_backing_6_offset];\n    const int64_t color_48100_backing_5_offset = color_48101_backing_6_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48099_backing_4 = &shared_mem[color_48100_backing_5_offset];\n    const int64_t color_48099_backing_4_offset = color_48100_backing_5_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_3 = &shared_mem[color_48099_backing_4_offset];\n    const int64_t color_48098_backing_3_offset = color_48099_backing_4_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48097_backing_2 = &shared_mem[color_48098_backing_3_offset];\n    const int64_t color_48097_backing_2_offset = color_48098_backing_3_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48096_backing_1 = &shared_mem[color_48097_backing_2_offset];\n    const int64_t color_48096_backing_1_offset = color_48097_backing_2_offset + (in",
                                    "t64_t) 32;\n    volatile __local unsigned char *color_48095_backing_0 = &shared_mem[color_48096_backing_1_offset];\n    const int64_t color_48095_backing_0_offset = color_48096_backing_1_offset + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48469;\n    int32_t tblock_sizze_48472;\n    int32_t wave_sizze_48471;\n    int32_t block_id_48470;\n    int32_t global_tid_48468;\n    int64_t phys_tblock_id_45973;\n    int64_t slice_48474;\n    int64_t ltid_pre_48473;\n    int64_t remnant_48475;\n    int64_t slice_48477;\n    int64_t ltid_pre_48476;\n    int64_t remnant_48478;\n    int64_t slice_48479;\n    int64_t gtid_45972;\n    int64_t remnant_48480;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    __local unsigned char *color_48100;\n    __local unsigned char *color_48101;\n    __local unsigned char *color_48102;\n    int32_t num_chunks_48481;\n    int32_t num_chunks_48484;\n    int64_t binop_x_46980;\n    int64_t phys_tid_45988;\n    int64_t gtid_45987;\n    int64_t dims_flat_48487;\n    int16_t eta_p_45989;\n    int16_t eta_p_45990;\n    int16_t eta_p_45991;\n    int16_t eta_p_45992;\n    int16_t eta_p_45993;\n    int16_t eta_p_45994;\n    int16_t eta_p_45995;\n    int16_t eta_p_45996;\n    int16_t eta_p_48492;\n    int16_t eta_p_48493;\n    int16_t eta_p_48494;\n    int16_t eta_p_48495;\n    int16_t eta_p_48496;\n    int16_t eta_p_48497;\n    int16_t eta_p_48498;\n    int16_t eta_p_48499;\n    bool ltid_in_bounds_48504;\n    int32_t skip_threads_48505;\n    bool no_carry_in_48511;\n    int16_t defunc_0_f_res_46029;\n    int16_t defunc_0_f_res_46030;\n    int16_t defunc_0_f_res_46031;\n    int16_t defunc_0_f_res_46032;\n    int64_t phys_tid_46040;\n    int64_t write_i_46039", ";\n    int64_t phys_tid_46052;\n    int64_t gtid_46051;\n    int16_t tmp_46055;\n    int16_t tmp_46056;\n    int32_t num_chunks_48513;\n    int32_t num_chunks_48516;\n    int32_t num_chunks_48519;\n    int32_t num_chunks_48522;\n    \n    local_tid_48469 = get_local_id(0);\n    tblock_sizze_48472 = get_local_size(0);\n    wave_sizze_48471 = LOCKSTEP_WIDTH;\n    block_id_48470 = get_tblock_id(0);\n    global_tid_48468 = block_id_48470 * tblock_sizze_48472 + local_tid_48469;\n    phys_tblock_id_45973 = sext_i32_i64(block_id_48470);\n    slice_48474 = (int64_t) 4;\n    ltid_pre_48473 = sext_i32_i64(local_tid_48469);\n    remnant_48475 = sext_i32_i64(local_tid_48469) - ltid_pre_48473;\n    slice_48477 = i16_res_43225;\n    ltid_pre_48476 = sext_i32_i64(local_tid_48469);\n    remnant_48478 = sext_i32_i64(local_tid_48469) - ltid_pre_48476;\n    slice_48479 = n_blocks_43229;\n    gtid_45972 = sext_i32_i64(block_id_48470);\n    remnant_48480 = sext_i32_i64(block_id_48470) - gtid_45972;\n    color_48095 = (__local unsigned char *) color_48095_backing_0;\n    color_48096 = (__local unsigned char *) color_48096_backing_1;\n    color_48097 = (__local unsigned char *) color_48097_backing_2;\n    color_48098 = (__local unsigned char *) color_48098_backing_3;\n    color_48099 = (__local unsigned char *) color_48099_backing_4;\n    color_48100 = (__local unsigned char *) color_48100_backing_5;\n    color_48101 = (__local unsigned char *) color_48101_backing_6;\n    color_48102 = (__local unsigned char *) color_48102_backing_7;\n    num_chunks_48481 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48482 = 0; chunk_i_48482 < num_chunks_48481; chunk_i_48482++) {\n        int32_t i_48483 = chunk_i_48482 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n        if (slt32(i_48483, sext_i64_i32(i16_res_43225))) {\n            ((__local double *) color_48102)[sext_i32_i64(i_48483)] = ((__global double *) mem_47846)[(int64_t) 0 + gtid_45972 * ", "((int64_t) 1 * i16_res_43225) + sext_i32_i64(i_48483)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48484 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48485 = 0; chunk_i_48485 < num_chunks_48484; chunk_i_48485++) {\n        int32_t i_48486 = chunk_i_48485 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n        if (slt32(i_48486, sext_i64_i32(i16_res_43225))) {\n            ((__local int64_t *) color_48101)[sext_i32_i64(i_48486)] = ((__global int64_t *) mem_47848)[(int64_t) 0 + gtid_45972 * ((int64_t) 1 * i16_res_43225) + sext_i32_i64(i_48486)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    binop_x_46980 = i16_res_43225 * gtid_45972;\n    phys_tid_45988 = sext_i32_i64(local_tid_48469);\n    gtid_45987 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(gtid_45987, i16_res_43225)) {\n        int64_t new_index_46981;\n        double eta_p_46001;\n        int64_t i64_arg0_46002;\n        int64_t unsign_arg0_46003;\n        int64_t unsign_arg0_46004;\n        int32_t to_i32_res_46005;\n        int64_t unsign_arg0_46006;\n        int64_t unsign_arg0_46007;\n        int32_t to_i32_res_46008;\n        bool cond_46009;\n        bool x_46010;\n        bool y_46011;\n        bool cond_46012;\n        int32_t defunc_0_get_bit_res_46013;\n        int32_t zp_lhs_46015;\n        int64_t unsign_arg0_46016;\n        int64_t unsign_arg0_46017;\n        int32_t to_i32_res_46018;\n        bool y_46019;\n        bool cond_46020;\n        int32_t defunc_0_get_bit_res_46021;\n        int32_t i32_arg0_46023;\n        int16_t i32_res_46024;\n        int16_t defunc_0_f_res_46025;\n        int16_t defunc_0_f_res_46026;\n        int16_t defunc_0_f_res_46027;\n        int16_t defunc_0_f_res_46028;\n        \n        new_index_46981 = gtid_45987 + binop_x_46980;\n        eta_p_46001 = ((__global double *) mem_47846)[new_index_46981];\n        i64_arg0_46002 = futrts_to_bits64(eta_p_46001);\n        unsign_a",
                                    "rg0_46003 = ashr64(i64_arg0_46002, unsign_arg0_43299);\n        unsign_arg0_46004 = (int64_t) 1 & unsign_arg0_46003;\n        to_i32_res_46005 = zext_i64_i32(unsign_arg0_46004);\n        unsign_arg0_46006 = ashr64(i64_arg0_46002, (int64_t) 63);\n        unsign_arg0_46007 = (int64_t) 1 & unsign_arg0_46006;\n        to_i32_res_46008 = zext_i64_i32(unsign_arg0_46007);\n        cond_46009 = to_i32_res_46008 == 1;\n        x_46010 = !cond_46009;\n        y_46011 = cond_f_res_43300 && x_46010;\n        cond_46012 = cond_46009 || y_46011;\n        if (cond_46012) {\n            int32_t defunc_0_get_bit_res_t_res_46014 = 1 ^ to_i32_res_46005;\n            \n            defunc_0_get_bit_res_46013 = defunc_0_get_bit_res_t_res_46014;\n        } else {\n            defunc_0_get_bit_res_46013 = to_i32_res_46005;\n        }\n        zp_lhs_46015 = mul32(2, defunc_0_get_bit_res_46013);\n        unsign_arg0_46016 = ashr64(i64_arg0_46002, unsign_arg0_43301);\n        unsign_arg0_46017 = (int64_t) 1 & unsign_arg0_46016;\n        to_i32_res_46018 = zext_i64_i32(unsign_arg0_46017);\n        y_46019 = cond_f_res_43302 && x_46010;\n        cond_46020 = cond_46009 || y_46019;\n        if (cond_46020) {\n            int32_t defunc_0_get_bit_res_t_res_46022 = 1 ^ to_i32_res_46018;\n            \n            defunc_0_get_bit_res_46021 = defunc_0_get_bit_res_t_res_46022;\n        } else {\n            defunc_0_get_bit_res_46021 = to_i32_res_46018;\n        }\n        i32_arg0_46023 = add32(zp_lhs_46015, defunc_0_get_bit_res_46021);\n        i32_res_46024 = sext_i32_i16(i32_arg0_46023);\n        futrts_lifted_lambda_7535(&defunc_0_f_res_46025, &defunc_0_f_res_46026, &defunc_0_f_res_46027, &defunc_0_f_res_46028, i32_res_46024);\n        ((__local int16_t *) color_48100)[gtid_45987] = defunc_0_f_res_46025;\n        ((__local int16_t *) color_48099)[gtid_45987] = defunc_0_f_res_46026;\n        ((__local int16_t *) color_48098)[gtid_45987] = defunc_0_f_res_46027;\n        ((__local int16_t *) color_48097)[gtid_45987] = defunc_0_f_re", "s_46028;\n        ((__local int16_t *) color_48095)[gtid_45987] = i32_res_46024;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dims_flat_48487 = i16_res_43225;\n    ltid_in_bounds_48504 = slt64(sext_i32_i64(local_tid_48469), i16_res_43225);\n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_48504) {\n            eta_p_45993 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n            eta_p_45994 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n            eta_p_45995 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n            eta_p_45996 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n            if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                eta_p_45989 = eta_p_45993;\n                eta_p_45990 = eta_p_45994;\n                eta_p_45991 = eta_p_45995;\n                eta_p_45992 = eta_p_45996;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_48505 = 1;\n        while (slt32(skip_threads_48505, 32)) {\n            bool thread_active_48506 = sle32(skip_threads_48505, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && ltid_in_bounds_48504;\n            \n            if (thread_active_48506) {\n                // read operands\n                {\n                    eta_p_45989 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45990 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45991 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45992 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                }\n            }\n         ", "   // perform operation\n            {\n                bool inactive_48507 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_43225), sext_i32_i64(local_tid_48469) - sext_i32_i64(local_tid_48469 - skip_threads_48505));\n                \n                if (thread_active_48506 && inactive_48507) {\n                    eta_p_45989 = eta_p_45993;\n                    eta_p_45990 = eta_p_45994;\n                    eta_p_45991 = eta_p_45995;\n                    eta_p_45992 = eta_p_45996;\n                }\n                if (thread_active_48506) {\n                    if (!inactive_48507) {\n                        int16_t defunc_0_op_res_45997 = add16(eta_p_45989, eta_p_45993);\n                        int16_t defunc_0_op_res_45998 = add16(eta_p_45990, eta_p_45994);\n                        int16_t defunc_0_op_res_45999 = add16(eta_p_45991, eta_p_45995);\n                        int16_t defunc_0_op_res_46000 = add16(eta_p_45992, eta_p_45996);\n                        \n                        eta_p_45989 = defunc_0_op_res_45997;\n                        eta_p_45990 = defunc_0_op_res_45998;\n                        eta_p_45991 = defunc_0_op_res_45999;\n                        eta_p_45992 = defunc_0_op_res_46000;\n                    }\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (thread_active_48506) {\n                // write result\n                {\n                    ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_45989;\n                    eta_p_45993 = eta_p_45989;\n                    ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45990;\n                    eta_p_45994 = eta_p_45990;\n                    ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45991;\n                    eta_p_45995 = eta_p_45991;\n                    ((volatile __local int16_t *) ",
                                    "color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45992;\n                    eta_p_45996 = eta_p_45992;\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_48505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 31 && ltid_in_bounds_48504) {\n            ((volatile __local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45989;\n            ((volatile __local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45990;\n            ((volatile __local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45991;\n            ((volatile __local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45992;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_48508;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n                eta_p_48496 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n                eta_p_48497 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n                eta_p_48498 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n                eta_p_48499 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n                if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                    eta_p_48492 = eta_p_48496;\n                    eta_p_48493 = eta_p_48497;\n                    eta_p_48494 = eta_p_48498;\n                    eta_p_48495 = eta_p_48499;\n                }\n     ", "       }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_48508 = 1;\n            while (slt32(skip_threads_48508, 32)) {\n                bool thread_active_48509 = sle32(skip_threads_48508, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504);\n                \n                if (thread_active_48509) {\n                    // read operands\n                    {\n                        eta_p_48492 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48493 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48494 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48495 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48510 = slt64(srem64(sext_i32_i64(local_tid_48469 * 32 + 32 - 1), i16_res_43225), sext_i32_i64(local_tid_48469 * 32 + 32 - 1) - sext_i32_i64((local_tid_48469 - skip_threads_48508) * 32 + 32 - 1));\n                    \n                    if (thread_active_48509 && inactive_48510) {\n                        eta_p_48492 = eta_p_48496;\n                        eta_p_48493 = eta_p_48497;\n                        eta_p_48494 = eta_p_48498;\n                        eta_p_48495 = eta_p_48499;\n                    }\n                    if (thread_active_48509) {\n                        if (!inactive_48510) {\n                            int16_t defunc_0_op_res_48500 = add16(eta_p_48492, eta_p_48496);\n                            int16_t defunc_0_op_res_48501 = add16(eta_p_48493, eta_p_48497);\n            ", "                int16_t defunc_0_op_res_48502 = add16(eta_p_48494, eta_p_48498);\n                            int16_t defunc_0_op_res_48503 = add16(eta_p_48495, eta_p_48499);\n                            \n                            eta_p_48492 = defunc_0_op_res_48500;\n                            eta_p_48493 = defunc_0_op_res_48501;\n                            eta_p_48494 = defunc_0_op_res_48502;\n                            eta_p_48495 = defunc_0_op_res_48503;\n                        }\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (thread_active_48509) {\n                    // write result\n                    {\n                        ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_48492;\n                        eta_p_48496 = eta_p_48492;\n                        ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_48493;\n                        eta_p_48497 = eta_p_48493;\n                        ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_48494;\n                        eta_p_48498 = eta_p_48494;\n                        ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_48495;\n                        eta_p_48499 = eta_p_48495;\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_48508 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    no_carry_in_48511 = squot32(local_tid_48469, 32) == 0 || !ltid_in_bounds_48504;\n    // carry-in for every block except the first\n    {\n        // read operands\n        {\n            if (!no_carry_in_48511) {\n                eta_p_45993 = eta_p_45989;\n                eta_p_45994 = eta_p_45990;\n ",
                                    "               eta_p_45995 = eta_p_45991;\n                eta_p_45996 = eta_p_45992;\n                eta_p_45989 = ((__local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_45990 = ((__local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_45991 = ((__local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_45992 = ((__local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n            }\n        }\n        // perform operation\n        {\n            bool inactive_48512 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_43225), sext_i32_i64(local_tid_48469) - sext_i32_i64(squot32(local_tid_48469, 32) * 32 - 1));\n            \n            if (!no_carry_in_48511) {\n                if (inactive_48512) {\n                    eta_p_45989 = eta_p_45993;\n                    eta_p_45990 = eta_p_45994;\n                    eta_p_45991 = eta_p_45995;\n                    eta_p_45992 = eta_p_45996;\n                }\n            }\n            if (!no_carry_in_48511) {\n                if (!inactive_48512) {\n                    int16_t defunc_0_op_res_45997 = add16(eta_p_45989, eta_p_45993);\n                    int16_t defunc_0_op_res_45998 = add16(eta_p_45990, eta_p_45994);\n                    int16_t defunc_0_op_res_45999 = add16(eta_p_45991, eta_p_45995);\n                    int16_t defunc_0_op_res_46000 = add16(eta_p_45992, eta_p_45996);\n                    \n                    eta_p_45989 = defunc_0_op_res_45997;\n                    eta_p_45990 = defunc_0_op_res_45998;\n                    eta_p_45991 = defunc_0_op_res_45999;\n                    eta_p_45992 = defunc_0_op_res_46000;\n                }\n            }\n        }\n        // write final result\n        {\n            if (!no_carry_in_48511) {\n                ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = et", "a_p_45989;\n                ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45990;\n                ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45991;\n                ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45992;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n            ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_45993;\n            ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45994;\n            ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45995;\n            ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45996;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (zzero_43226) {\n        defunc_0_f_res_46029 = (int16_t) 0;\n        defunc_0_f_res_46030 = (int16_t) 0;\n        defunc_0_f_res_46031 = (int16_t) 0;\n        defunc_0_f_res_46032 = (int16_t) 0;\n    } else {\n        int16_t last_res_46033;\n        int16_t last_res_46034;\n        int16_t last_res_46035;\n        int16_t last_res_46036;\n        \n        last_res_46033 = ((__local int16_t *) color_48100)[tmp_43268];\n        last_res_46034 = ((__local int16_t *) color_48099)[tmp_43268];\n        last_res_46035 = ((__local int16_t *) color_48098)[tmp_43268];\n        last_res_46036 = ((__local int16_t *) color_48097)[tmp_43268];\n        defunc_0_f_res_46029 = last_res_46033;\n        defunc_0_f_res_46030 = last_res_46034;\n        defunc_0_f_res_46031 = last_res_46035;\n        defunc_0_f_res_46032 = last_res_46036;\n    }\n    phys_tid_46040 = sext_i32_i64(local_tid_48469);\n    write_i_46039 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(write_i_46039, i16_res_43225)) {\n        int16_t eta_p_46041;\n        int16_t eta_p_46042;\n        int1", "6_t eta_p_46043;\n        int16_t eta_p_46044;\n        int16_t eta_p_46045;\n        int64_t new_index_46977;\n        double write_value_46046;\n        int64_t write_value_46047;\n        int64_t defunc_0_f_res_46048;\n        \n        eta_p_46041 = ((__local int16_t *) color_48095)[write_i_46039];\n        eta_p_46042 = ((__local int16_t *) color_48100)[write_i_46039];\n        eta_p_46043 = ((__local int16_t *) color_48099)[write_i_46039];\n        eta_p_46044 = ((__local int16_t *) color_48098)[write_i_46039];\n        eta_p_46045 = ((__local int16_t *) color_48097)[write_i_46039];\n        new_index_46977 = write_i_46039 + binop_x_46980;\n        write_value_46046 = ((__global double *) mem_47846)[new_index_46977];\n        write_value_46047 = ((__global int64_t *) mem_47848)[new_index_46977];\n        futrts_lifted_f_7536(&defunc_0_f_res_46048, defunc_0_f_res_46029, defunc_0_f_res_46030, defunc_0_f_res_46031, eta_p_46041, eta_p_46042, eta_p_46043, eta_p_46044, eta_p_46045);\n        if (sle64((int64_t) 0, defunc_0_f_res_46048) && slt64(defunc_0_f_res_46048, i16_res_43225)) {\n            ((__local double *) color_48102)[defunc_0_f_res_46048] = write_value_46046;\n        }\n        if (sle64((int64_t) 0, defunc_0_f_res_46048) && slt64(defunc_0_f_res_46048, i16_res_43225)) {\n            ((__local int64_t *) color_48101)[defunc_0_f_res_46048] = write_value_46047;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = defunc_0_f_res_46029;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_46030;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = defunc_0_f_res_46031;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = defunc_0_f_res_46032;\n    phys_tid_46052 = sext_i32_i64(local_tid_48469);\n    gtid_46051 = sext_i32_i64(sext_i64_i32(ltid_pre_48473));\n    if (slt64(gtid_46051, (int64_t) 4)) {\n        int16_t eta_p_46053;\n        int64_t i16_res_46054;\n        \n        eta_p_46053 = ((__local int16_t *) color_4809",
                                    "5)[gtid_46051];\n        i16_res_46054 = sext_i16_i64(eta_p_46053);\n        ((__local int64_t *) color_48096)[gtid_46051] = i16_res_46054;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    tmp_46055 = add16(defunc_0_f_res_46029, defunc_0_f_res_46030);\n    tmp_46056 = add16(defunc_0_f_res_46031, tmp_46055);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = (int16_t) 0;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_46029;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = tmp_46055;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = tmp_46056;\n    num_chunks_48513 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48514 = 0; chunk_i_48514 < num_chunks_48513; chunk_i_48514++) {\n        int32_t i_48515 = chunk_i_48514 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n        if (slt32(i_48515, sext_i64_i32(i16_res_43225))) {\n            ((__global double *) mem_47968)[gtid_45972 * i16_res_43225 + sext_i32_i64(i_48515)] = ((__local double *) color_48102)[sext_i32_i64(i_48515)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48516 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48517 = 0; chunk_i_48517 < num_chunks_48516; chunk_i_48517++) {\n        int32_t i_48518 = chunk_i_48517 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n        if (slt32(i_48518, sext_i64_i32(i16_res_43225))) {\n            ((__global int64_t *) mem_47971)[gtid_45972 * i16_res_43225 + sext_i32_i64(i_48518)] = ((__local int64_t *) color_48101)[sext_i32_i64(i_48518)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48519 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48520 = 0; chunk_i_48520 < num_chunks_48519; chunk_i_48520++) {\n        int32_t i_48521 = chunk_i_48520 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n     ", "   if (slt32(i_48521, 4)) {\n            ((__global int64_t *) mem_47974)[gtid_45972 * (int64_t) 4 + sext_i32_i64(i_48521)] = ((__local int64_t *) color_48096)[sext_i32_i64(i_48521)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48522 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_45946));\n    for (int32_t chunk_i_48523 = 0; chunk_i_48523 < num_chunks_48522; chunk_i_48523++) {\n        int32_t i_48524 = chunk_i_48523 * sext_i64_i32(computed_tblock_sizze_45946) + local_tid_48469;\n        \n        if (slt32(i_48524, 4)) {\n            ((__global int16_t *) mem_47977)[gtid_45972 * (int64_t) 4 + sext_i32_i64(i_48524)] = ((__local int16_t *) color_48095)[sext_i32_i64(i_48524)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegscan_45917_dim1, 1, 1)\nvoid sortColumn_doublezisegscan_45917(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_43230, int64_t arg_43231, int64_t unsign_arg0_43299, unsigned char cond_f_res_43300_bits, int64_t unsign_arg0_43301, unsigned char cond_f_res_43302_bits, int64_t num_tblocks_45914, int64_t num_virt_blocks_48139, int64_t num_virt_threads_48140, __global unsigned char *mem_47846, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *status_flags_mem_48141, __global unsigned char *aggregates_mem_48163, __global unsigned char *incprefixes_mem_48165, __global unsigned char *aggregates_mem_48167, __global unsigned char *incprefixes_mem_48169, __global unsigned char *aggregates_mem_48171, __global unsigned char *incprefixes_mem_48173, __global unsigned char *aggregates_mem_48175, __global unsigned char *incprefixes_mem_48177, __global unsigned char *global_dynid_mem_48179)\n{\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    bool cond_f_res_43302 = con", "d_f_res_43302_bits;\n    \n    #define segscan_tblock_sizze_45912 (sortColumn_doublezisegscan_45917zisegscan_tblock_sizze_45912)\n    #define chunk_sizze_48138 (sortColumn_doublezisegscan_45917zichunk_sizze_48138)\n    \n    volatile __local unsigned char *local_mem_48215_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48215_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48202;\n    int32_t tblock_sizze_48205;\n    int32_t wave_sizze_48204;\n    int32_t block_id_48203;\n    int32_t global_tid_48201;\n    int64_t phys_tid_45917;\n    int32_t chunk_sizze_32b_48206;\n    int64_t byte_offsets_48207;\n    int64_t byte_offsets_48208;\n    int64_t byte",
                                    "_offsets_48209;\n    int64_t byte_offsets_48210;\n    int64_t warp_byte_offset_48211;\n    int64_t warp_byte_offset_48212;\n    int64_t warp_byte_offset_48213;\n    int64_t warp_byte_offset_48214;\n    __local unsigned char *local_mem_48215;\n    int64_t trans_arr_len_48216;\n    int64_t phys_block_id_48231;\n    int64_t virtloop_bound_48232;\n    \n    local_tid_48202 = get_local_id(0);\n    tblock_sizze_48205 = get_local_size(0);\n    wave_sizze_48204 = LOCKSTEP_WIDTH;\n    block_id_48203 = get_tblock_id(0);\n    global_tid_48201 = block_id_48203 * tblock_sizze_48205 + local_tid_48202;\n    phys_tid_45917 = sext_i32_i64(global_tid_48201);\n    chunk_sizze_32b_48206 = sext_i64_i32(chunk_sizze_48138);\n    byte_offsets_48207 = segscan_tblock_sizze_45912 * (int64_t) 2;\n    byte_offsets_48208 = sdiv_up64(byte_offsets_48207, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45912 * (int64_t) 2;\n    byte_offsets_48209 = sdiv_up64(byte_offsets_48208, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45912 * (int64_t) 2;\n    byte_offsets_48210 = sdiv_up64(byte_offsets_48209, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45912 * (int64_t) 2;\n    warp_byte_offset_48211 = (int64_t) 96;\n    warp_byte_offset_48212 = sdiv_up64(warp_byte_offset_48211, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48213 = sdiv_up64(warp_byte_offset_48212, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48214 = sdiv_up64(warp_byte_offset_48213, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48215 = (__local unsigned char *) local_mem_48215_backing_0;\n    trans_arr_len_48216 = chunk_sizze_48138 * segscan_tblock_sizze_45912;\n    phys_block_id_48231 = get_tblock_id(0);\n    virtloop_bound_48232 = sdiv_up64(num_virt_blocks_48139 - phys_block_id_48231, num_tblocks_45914);\n    for (int64_t virtloop_i_48233 = 0; virtloop_i_48233 < virtloop_bound_48232; virtloop_i_48233++) {\n        int64_t dynamic_id_48234;\n        int64_t block_", "offset_48235;\n        int64_t sgm_idx_48236;\n        int32_t boundary_48237;\n        int32_t segsizze_compact_48238;\n        int16_t private_mem_48239[chunk_sizze_48138];\n        int16_t private_mem_48241[chunk_sizze_48138];\n        int16_t private_mem_48243[chunk_sizze_48138];\n        int16_t private_mem_48245[chunk_sizze_48138];\n        int64_t thd_offset_48247;\n        int16_t acc_48293;\n        int16_t acc_48294;\n        int16_t acc_48295;\n        int16_t acc_48296;\n        int16_t prefix_48315;\n        int16_t prefix_48316;\n        int16_t prefix_48317;\n        int16_t prefix_48318;\n        bool block_new_sgm_48319;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48202 == 0) {\n                dynamic_id_48234 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48179)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48215)[(int64_t) 0] = dynamic_id_48234;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48234 == num_virt_blocks_48139 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48179)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48234 = ((__local int32_t *) local_mem_48215)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48235 = dynamic_id_48234 * chunk_sizze_48138 * segscan_tblock_sizze_45912;\n        sgm_idx_48236 = smod64(block_offset_48235, rest_43230);\n        boundary_48237 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_45912, rest_43230 - sgm_idx_48236));\n        segsizze_compact_48238 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_45912, rest_43230));\n        thd_offset_48247 = block_offset_48235 + sex", "t_i32_i64(local_tid_48202);\n        // Load and map\n        {\n            for (int64_t i_48248 = 0; i_48248 < chunk_sizze_48138; i_48248++) {\n                int64_t virt_tid_48249 = thd_offset_48247 + i_48248 * segscan_tblock_sizze_45912;\n                int64_t slice_48250 = rest_43230;\n                int64_t gtid_45916 = virt_tid_48249;\n                int64_t remnant_48251 = virt_tid_48249 - gtid_45916;\n                \n                if (slt64(virt_tid_48249, rest_43230)) {\n                    int64_t slice_46966 = arg_43231 + gtid_45916;\n                    double eta_p_43679 = ((__global double *) mem_47846)[slice_46966];\n                    int64_t i64_arg0_43680 = futrts_to_bits64(eta_p_43679);\n                    int64_t unsign_arg0_43681 = ashr64(i64_arg0_43680, unsign_arg0_43299);\n                    int64_t unsign_arg0_43682 = (int64_t) 1 & unsign_arg0_43681;\n                    int32_t to_i32_res_43683 = zext_i64_i32(unsign_arg0_43682);\n                    int64_t unsign_arg0_43684 = ashr64(i64_arg0_43680, (int64_t) 63);\n                    int64_t unsign_arg0_43685 = (int64_t) 1 & unsign_arg0_43684;\n                    int32_t to_i32_res_43686 = zext_i64_i32(unsign_arg0_43685);\n                    bool cond_43687 = to_i32_res_43686 == 1;\n                    bool x_43688 = !cond_43687;\n                    bool y_43689 = cond_f_res_43300 && x_43688;\n                    bool cond_43690 = cond_43687 || y_43689;\n                    int32_t defunc_0_get_bit_res_43691;\n                    \n                    if (cond_43690) {\n                        int32_t defunc_0_get_bit_res_t_res_43821 = 1 ^ to_i32_res_43683;\n                        \n                        defunc_0_get_bit_res_43691 = defunc_0_get_bit_res_t_res_43821;\n                    } else {\n                        defunc_0_get_bit_res_43691 = to_i32_res_43683;\n                    }\n                    \n                    int32_t zp_lhs_43693 = mul32(2, defunc_0_get_bit_res_43691);\n            ",
                                    "        int64_t unsign_arg0_43694 = ashr64(i64_arg0_43680, unsign_arg0_43301);\n                    int64_t unsign_arg0_43695 = (int64_t) 1 & unsign_arg0_43694;\n                    int32_t to_i32_res_43696 = zext_i64_i32(unsign_arg0_43695);\n                    bool y_43697 = cond_f_res_43302 && x_43688;\n                    bool cond_43698 = cond_43687 || y_43697;\n                    int32_t defunc_0_get_bit_res_43699;\n                    \n                    if (cond_43698) {\n                        int32_t defunc_0_get_bit_res_t_res_43822 = 1 ^ to_i32_res_43696;\n                        \n                        defunc_0_get_bit_res_43699 = defunc_0_get_bit_res_t_res_43822;\n                    } else {\n                        defunc_0_get_bit_res_43699 = to_i32_res_43696;\n                    }\n                    \n                    int32_t i32_arg0_43701 = add32(zp_lhs_43693, defunc_0_get_bit_res_43699);\n                    int16_t i32_res_43702 = sext_i32_i16(i32_arg0_43701);\n                    int16_t defunc_0_f_res_43704;\n                    int16_t defunc_0_f_res_43705;\n                    int16_t defunc_0_f_res_43706;\n                    int16_t defunc_0_f_res_43707;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_43704, &defunc_0_f_res_43705, &defunc_0_f_res_43706, &defunc_0_f_res_43707, i32_res_43702);\n                    ((__global int16_t *) mem_47865)[gtid_45916] = i32_res_43702;\n                    private_mem_48239[i_48248] = defunc_0_f_res_43704;\n                    private_mem_48241[i_48248] = defunc_0_f_res_43705;\n                    private_mem_48243[i_48248] = defunc_0_f_res_43706;\n                    private_mem_48245[i_48248] = defunc_0_f_res_43707;\n                } else {\n                    private_mem_48239[i_48248] = (int16_t) 0;\n                    private_mem_48241[i_48248] = (int16_t) 0;\n                    private_mem_48243[i_48248] = (int16_t) 0;\n                    private_mem_48245[i_48248] = (int16_", "t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48252 = 0; i_48252 < chunk_sizze_48138; i_48252++) {\n                int64_t sharedIdx_48253 = sext_i32_i64(local_tid_48202) + i_48252 * segscan_tblock_sizze_45912;\n                int16_t tmp_48254 = private_mem_48239[i_48252];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48253] = tmp_48254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48255 = 0; i_48255 < chunk_sizze_48138; i_48255++) {\n                int64_t sharedIdx_48256 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48255;\n                int16_t tmp_48257 = ((__local int16_t *) local_mem_48215)[sharedIdx_48256];\n                \n                private_mem_48239[i_48255] = tmp_48257;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48258 = 0; i_48258 < chunk_sizze_48138; i_48258++) {\n                int64_t sharedIdx_48259 = sext_i32_i64(local_tid_48202) + i_48258 * segscan_tblock_sizze_45912;\n                int16_t tmp_48260 = private_mem_48241[i_48258];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48259] = tmp_48260;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48261 = 0; i_48261 < chunk_sizze_48138; i_48261++) {\n                int64_t sharedIdx_48262 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48261;\n                int16_t tmp_48263 = ((__local int16_t *) local_mem_48215)[sharedIdx_48262];\n                \n                private_mem_48241[i_48261] = tmp_48263;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48264 = 0; i_48264 < chunk_sizze_48138; i_48264++) {\n                int64_t sharedIdx_48265 = sext_i32_i64(local_tid_48202) + i_48264 * segscan_tblock_sizze_45912;\n                int16_t tmp_48266 = private_m", "em_48243[i_48264];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48265] = tmp_48266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48267 = 0; i_48267 < chunk_sizze_48138; i_48267++) {\n                int64_t sharedIdx_48268 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48267;\n                int16_t tmp_48269 = ((__local int16_t *) local_mem_48215)[sharedIdx_48268];\n                \n                private_mem_48243[i_48267] = tmp_48269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48270 = 0; i_48270 < chunk_sizze_48138; i_48270++) {\n                int64_t sharedIdx_48271 = sext_i32_i64(local_tid_48202) + i_48270 * segscan_tblock_sizze_45912;\n                int16_t tmp_48272 = private_mem_48245[i_48270];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48271] = tmp_48272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48273 = 0; i_48273 < chunk_sizze_48138; i_48273++) {\n                int64_t sharedIdx_48274 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48273;\n                int16_t tmp_48275 = ((__local int16_t *) local_mem_48215)[sharedIdx_48274];\n                \n                private_mem_48245[i_48273] = tmp_48275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48276 = 0; i_48276 < chunk_sizze_48138 - (int64_t) 1; i_48276++) {\n                int16_t eta_p_43345;\n                int16_t eta_p_43349;\n                \n                eta_p_43345 = private_mem_48239[i_48276];\n                eta_p_43349 = private_mem_48239[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_43346;\n                int16_t eta_p_43350;\n                \n                eta_p_43346 = private_mem_48241[i_48276];\n                eta_p_43350 = private_mem_48241[i_48276 + (int64_t) 1];\n   ",
                                    "             \n                int16_t eta_p_43347;\n                int16_t eta_p_43351;\n                \n                eta_p_43347 = private_mem_48243[i_48276];\n                eta_p_43351 = private_mem_48243[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_43348;\n                int16_t eta_p_43352;\n                \n                eta_p_43348 = private_mem_48245[i_48276];\n                eta_p_43352 = private_mem_48245[i_48276 + (int64_t) 1];\n                \n                int16_t defunc_0_op_res_43353 = add16(eta_p_43345, eta_p_43349);\n                int16_t defunc_0_op_res_43354 = add16(eta_p_43346, eta_p_43350);\n                int16_t defunc_0_op_res_43355 = add16(eta_p_43347, eta_p_43351);\n                int16_t defunc_0_op_res_43356 = add16(eta_p_43348, eta_p_43352);\n                \n                private_mem_48239[i_48276 + (int64_t) 1] = defunc_0_op_res_43353;\n                private_mem_48241[i_48276 + (int64_t) 1] = defunc_0_op_res_43354;\n                private_mem_48243[i_48276 + (int64_t) 1] = defunc_0_op_res_43355;\n                private_mem_48245[i_48276 + (int64_t) 1] = defunc_0_op_res_43356;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48277 = private_mem_48239[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = tmp_48277;\n            \n            int16_t tmp_48278 = private_mem_48241[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48278;\n            \n            int16_t tmp_48279 = private_mem_48243[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48279;\n            \n            int16_t tmp_48280 = private_mem_48245[chunk_sizze_481", "38 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48280;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48281;\n            int16_t eta_p_48282;\n            int16_t eta_p_48283;\n            int16_t eta_p_48284;\n            int16_t eta_p_48285;\n            int16_t eta_p_48286;\n            int16_t eta_p_48287;\n            int16_t eta_p_48288;\n            int16_t eta_p_48297;\n            int16_t eta_p_48298;\n            int16_t eta_p_48299;\n            int16_t eta_p_48300;\n            int16_t eta_p_48301;\n            int16_t eta_p_48302;\n            int16_t eta_p_48303;\n            int16_t eta_p_48304;\n            bool ltid_in_bounds_48309 = slt64(sext_i32_i64(local_tid_48202), num_virt_threads_48140);\n            int32_t skip_threads_48310;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48309) {\n                    eta_p_48285 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                    eta_p_48286 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48287 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48288 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                        eta_p_48281 = eta_p_48285;\n                        eta_p_48282 = eta_p_48286;\n                        eta_p_48283 = eta_p_48287;\n                        eta_p_48284 = eta_p_48288;\n                    }\n                }\n            }\n            // in-", "block scan (hopefully no barriers needed)\n            {\n                skip_threads_48310 = 1;\n                while (slt32(skip_threads_48310, 32)) {\n                    bool thread_active_48311 = sle32(skip_threads_48310, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && ltid_in_bounds_48309;\n                    \n                    if (thread_active_48311) {\n                        // read operands\n                        {\n                            eta_p_48281 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310)];\n                            eta_p_48282 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48283 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48284 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48311) {\n                            int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                            int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                            int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                            int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                            \n                            eta_p_48281 = defunc_0_op_res_48289;\n                            eta_p_48282 = defunc_0_op_res_48290;\n                            eta_p_48283 = defunc_0_op_res_48291;\n                            eta_p_48284 = def",
                                    "unc_0_op_res_48292;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48311) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                            eta_p_48285 = eta_p_48281;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                            eta_p_48286 = eta_p_48282;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                            eta_p_48287 = eta_p_48283;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                            eta_p_48288 = eta_p_48284;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48310 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 31 && ltid_in_bounds_48309) {\n                    ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48281;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48282;\n                    ((volatile __loca", "l int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48283;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48284;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48312;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                        eta_p_48301 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                        eta_p_48302 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48303 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48304 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                            eta_p_48297 = eta_p_48301;\n                            eta_p_48298 = eta_p_48302;\n                            eta_p_48299 = eta_p_48303;\n                            eta_p_48300 = eta_p_48304;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48312 = 1;\n                    while (slt32(skip_threads_48312, 32)) {\n                        bool thread_active_48313 = sle32(skip_threads_48312, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && (squot32(loca", "l_tid_48202, 32) == 0 && ltid_in_bounds_48309);\n                        \n                        if (thread_active_48313) {\n                            // read operands\n                            {\n                                eta_p_48297 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312)];\n                                eta_p_48298 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48299 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48300 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48313) {\n                                int16_t defunc_0_op_res_48305 = add16(eta_p_48297, eta_p_48301);\n                                int16_t defunc_0_op_res_48306 = add16(eta_p_48298, eta_p_48302);\n                                int16_t defunc_0_op_res_48307 = add16(eta_p_48299, eta_p_48303);\n                                int16_t defunc_0_op_res_48308 = add16(eta_p_48300, eta_p_48304);\n                                \n                                eta_p_48297 = defunc_0_op_res_48305;\n                                eta_p_48298 = defunc_0_op_res_48306;\n                                eta_p_48299 = defunc_0_op_res_48307;\n                                eta_p_48300 = defunc_0_op_res_48308;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                ",
                                    "            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48313) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48297;\n                                eta_p_48301 = eta_p_48297;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48298;\n                                eta_p_48302 = eta_p_48298;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48299;\n                                eta_p_48303 = eta_p_48299;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48300;\n                                eta_p_48304 = eta_p_48300;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48312 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48314 = squot32(local_tid_48202, 32) == 0 || !ltid_in_bounds_48309;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48314) {\n                        eta_p_48285 = eta_p_48281;\n                        eta_p_48286 = eta_p_48282;\n                        eta_p_48287 = eta_p_48283;\n                        eta_p_48288 = eta_p_48284;\n                        eta_p_48281 = ((__local int16_t *) local_mem_48215)[sext_i32_i6", "4(squot32(local_tid_48202, 32)) - (int64_t) 1];\n                        eta_p_48282 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48283 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48284 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48314) {\n                        int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                        int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                        int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                        int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                        \n                        eta_p_48281 = defunc_0_op_res_48289;\n                        eta_p_48282 = defunc_0_op_res_48290;\n                        eta_p_48283 = defunc_0_op_res_48291;\n                        eta_p_48284 = defunc_0_op_res_48292;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48314) {\n                        ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int", "64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                    ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48285;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48286;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48287;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48202 == 0) {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[segscan_tblock_sizze_45912 - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (segscan_tblock_sizze_45912 - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (segscan_tblock_sizze_45912 - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (segscan_tblock_sizze_45912 - (int64_t) 1)];\n            } else {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_482",
                                    "02) - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48315 = (int16_t) 0;\n        prefix_48316 = (int16_t) 0;\n        prefix_48317 = (int16_t) 0;\n        prefix_48318 = (int16_t) 0;\n        block_new_sgm_48319 = sgm_idx_48236 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48319 && local_tid_48202 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = acc_48293;\n                ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = acc_48294;\n                ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = acc_48295;\n                ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = acc_48296;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                acc_48293 = (int16_t) 0;\n                acc_48294 = (int16_t) 0;\n                acc_48295 = (int16_t) 0;\n                acc_48296 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48319 && slt32(local_tid_48202, wave_sizze_48204)) {\n                if (local_tid_48202 == 0) {\n                    ((volatile __global int16_t *) aggregates_mem_48163)[dynamic_id_48234] = acc_48293;\n                    ((volatile __global int16_t *) aggregates_mem_48167)[dynamic_id_48234] = acc_48294;\n                    ((volatile __global int16_t *) aggregates_mem_48171)[dynamic_id_48234] = acc_48295;\n                    ((volatile __global int16_t *) aggregates_mem_48175)[dynamic_id_48234] = acc_48296;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 1;\n                    \n                    ", "int8_t tmp_48320 = ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48215)[(int64_t) 0] = tmp_48320;\n                }\n                mem_fence_local();\n                \n                int8_t status_48321 = ((__local int8_t *) local_mem_48215)[(int64_t) 0];\n                \n                if (status_48321 == (int8_t) 2) {\n                    if (local_tid_48202 == 0) {\n                        prefix_48315 = ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48316 = ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48317 = ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48318 = ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48322 = sext_i64_i32(dynamic_id_48234 - sext_i32_i64(wave_sizze_48204));\n                    \n                    while (slt32(wave_sizze_48204 * -1, readOffset_48322)) {\n                        int32_t read_i_48323 = readOffset_48322 + local_tid_48202;\n                        int16_t aggr_48324 = (int16_t) 0;\n                        int16_t aggr_48325 = (int16_t) 0;\n                        int16_t aggr_48326 = (int16_t) 0;\n                        int16_t aggr_48327 = (int16_t) 0;\n                        int8_t flag_48328 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48323)) {\n                            flag_48328 = ((volatile __global int8_t *) status_flags_mem_48141)[sext_i32_i64(read_i_48323)];\n                            if (flag_48328 == (int8_t) 2) {\n                                aggr_48324 = ((volatile __global int16_t *) incprefixes_mem_48165)[sext_i32_i64(", "read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) incprefixes_mem_48169)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) incprefixes_mem_48173)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) incprefixes_mem_48177)[sext_i32_i64(read_i_48323)];\n                            } else if (flag_48328 == (int8_t) 1) {\n                                aggr_48324 = ((volatile __global int16_t *) aggregates_mem_48163)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) aggregates_mem_48167)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) aggregates_mem_48171)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) aggregates_mem_48175)[sext_i32_i64(read_i_48323)];\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = aggr_48324;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48325;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48326;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48327;\n                        ((__local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flag_48328;\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        if (slt8(flag_48328, (int8_t) 2)) {\n                            int8_t flg_x_48341;\n                            int8_t flg_y_48342;\n  ",
                                    "                          int16_t eta_p_48329;\n                            int16_t eta_p_48330;\n                            int16_t eta_p_48331;\n                            int16_t eta_p_48332;\n                            int16_t eta_p_48333;\n                            int16_t eta_p_48334;\n                            int16_t eta_p_48335;\n                            int16_t eta_p_48336;\n                            int32_t skip_threads_48343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48342 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                                eta_p_48333 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)];\n                                eta_p_48334 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48335 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48336 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                                    eta_p_48329 = eta_p_48333;\n                                    eta_p_48330 = eta_p_48334;\n                                    eta_p_48331 = eta_p_48335;\n                                    eta_p_48332 = eta_p_48336;\n                                    flg_x_48341 = flg_y_48342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48343 = 1;\n                ", "                while (slt32(skip_threads_48343, 32)) {\n                                    if (sle32(skip_threads_48343, local_tid_48202 - squot32(local_tid_48202, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48341 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343)];\n                                            eta_p_48329 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48330 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48331 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48332 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48342 == (int8_t) 2 || flg_y_48342 == (int8_t) 0) {\n                                                flg_x_48341 = flg_y_48342;\n                                                eta_p_48329 = eta_p_48333;\n                                                eta_p_48330 = eta_p_48334;\n                                                eta_p_48331 = eta_p_48335;\n                                                eta_p_48332 = eta_p_48336;\n                                            } else {\n                     ", "                           int16_t defunc_0_op_res_48337 = add16(eta_p_48329, eta_p_48333);\n                                                int16_t defunc_0_op_res_48338 = add16(eta_p_48330, eta_p_48334);\n                                                int16_t defunc_0_op_res_48339 = add16(eta_p_48331, eta_p_48335);\n                                                int16_t defunc_0_op_res_48340 = add16(eta_p_48332, eta_p_48336);\n                                                \n                                                eta_p_48329 = defunc_0_op_res_48337;\n                                                eta_p_48330 = defunc_0_op_res_48338;\n                                                eta_p_48331 = defunc_0_op_res_48339;\n                                                eta_p_48332 = defunc_0_op_res_48340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flg_x_48341;\n                                            flg_y_48342 = flg_x_48341;\n                                            ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = eta_p_48329;\n                                            eta_p_48333 = eta_p_48329;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48330;\n                                            eta_p_48334 = eta_p_48330;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48331;\n                                            eta_p_48335 = eta_p_48331;\n                                            ((volatile",
                                    " __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48332;\n                                            eta_p_48336 = eta_p_48332;\n                                        }\n                                    }\n                                    skip_threads_48343 *= 2;\n                                }\n                            }\n                        }\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        aggr_48324 = ((__local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48325 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48326 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48327 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        if (flag_48328 == (int8_t) 2) {\n                            readOffset_48322 = wave_sizze_48204 * -1;\n                        } else if (flag_48328 == (int8_t) 1) {\n                            readOffset_48322 -= wave_sizze_48204;\n                        }\n                        if (slt8((int8_t) 0, flag_48328)) {\n                            int16_t eta_p_48344 = aggr_48324;\n                            int16_t eta_p_48345 = aggr_48325;\n                            int16_t eta_p_48346 = aggr_48326;\n                            int16_t eta_p_48347 = aggr_48327;\n                            int16_t eta_p_48348 = prefix_48315;\n                            int16_t eta_p_48349 = prefix_48316;\n                            int16_t eta_p_48350 = prefix_48317;\n              ", "              int16_t eta_p_48351 = prefix_48318;\n                            int16_t defunc_0_op_res_48352 = add16(eta_p_48344, eta_p_48348);\n                            int16_t defunc_0_op_res_48353 = add16(eta_p_48345, eta_p_48349);\n                            int16_t defunc_0_op_res_48354 = add16(eta_p_48346, eta_p_48350);\n                            int16_t defunc_0_op_res_48355 = add16(eta_p_48347, eta_p_48351);\n                            \n                            prefix_48315 = defunc_0_op_res_48352;\n                            prefix_48316 = defunc_0_op_res_48353;\n                            prefix_48317 = defunc_0_op_res_48354;\n                            prefix_48318 = defunc_0_op_res_48355;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48202 == 0) {\n                    if (boundary_48237 == sext_i64_i32(segscan_tblock_sizze_45912 * chunk_sizze_48138)) {\n                        int16_t eta_p_48356 = prefix_48315;\n                        int16_t eta_p_48357 = prefix_48316;\n                        int16_t eta_p_48358 = prefix_48317;\n                        int16_t eta_p_48359 = prefix_48318;\n                        int16_t eta_p_48360 = acc_48293;\n                        int16_t eta_p_48361 = acc_48294;\n                        int16_t eta_p_48362 = acc_48295;\n                        int16_t eta_p_48363 = acc_48296;\n                        int16_t defunc_0_op_res_48364 = add16(eta_p_48356, eta_p_48360);\n                        int16_t defunc_0_op_res_48365 = add16(eta_p_48357, eta_p_48361);\n                        int16_t defunc_0_op_res_48366 = add16(eta_p_48358, eta_p_48362);\n                        int16_t defunc_0_op_res_48367 = add16(eta_p_48359, eta_p_48363);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = defunc_0_op_res_48364;\n                        ((volatile __global int16_t *) i", "ncprefixes_mem_48169)[dynamic_id_48234] = defunc_0_op_res_48365;\n                        ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = defunc_0_op_res_48366;\n                        ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = defunc_0_op_res_48367;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48215)[(int64_t) 16] = prefix_48315;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)] = prefix_48316;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)] = prefix_48317;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)] = prefix_48318;\n                    acc_48293 = (int16_t) 0;\n                    acc_48294 = (int16_t) 0;\n                    acc_48295 = (int16_t) 0;\n                    acc_48296 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48234 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48315 = ((__local int16_t *) local_mem_48215)[(int64_t) 16];\n                prefix_48316 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)];\n                prefix_48317 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)];\n                prefix_48318 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48368;\n            int16_t eta_p_48372;\n            int16_t eta_p_48380 = prefix_48315;\n            int16_t eta_p_48384 = acc_48293;\n            int16_t eta_p_48369;\n            int16_t eta",
                                    "_p_48373;\n            int16_t eta_p_48381 = prefix_48316;\n            int16_t eta_p_48385 = acc_48294;\n            int16_t eta_p_48370;\n            int16_t eta_p_48374;\n            int16_t eta_p_48382 = prefix_48317;\n            int16_t eta_p_48386 = acc_48295;\n            int16_t eta_p_48371;\n            int16_t eta_p_48375;\n            int16_t eta_p_48383 = prefix_48318;\n            int16_t eta_p_48387 = acc_48296;\n            \n            if (slt32(local_tid_48202 * chunk_sizze_32b_48206, boundary_48237) && !block_new_sgm_48319) {\n                int16_t defunc_0_op_res_48388 = add16(eta_p_48380, eta_p_48384);\n                int16_t defunc_0_op_res_48389 = add16(eta_p_48381, eta_p_48385);\n                int16_t defunc_0_op_res_48390 = add16(eta_p_48382, eta_p_48386);\n                int16_t defunc_0_op_res_48391 = add16(eta_p_48383, eta_p_48387);\n                \n                eta_p_48368 = defunc_0_op_res_48388;\n                eta_p_48369 = defunc_0_op_res_48389;\n                eta_p_48370 = defunc_0_op_res_48390;\n                eta_p_48371 = defunc_0_op_res_48391;\n            } else {\n                eta_p_48368 = acc_48293;\n                eta_p_48369 = acc_48294;\n                eta_p_48370 = acc_48295;\n                eta_p_48371 = acc_48296;\n            }\n            \n            int32_t stopping_point_48392 = segsizze_compact_48238 - srem32(local_tid_48202 * chunk_sizze_32b_48206 - 1 + segsizze_compact_48238 - boundary_48237, segsizze_compact_48238);\n            \n            for (int64_t i_48393 = 0; i_48393 < chunk_sizze_48138; i_48393++) {\n                if (slt32(sext_i64_i32(i_48393), stopping_point_48392 - 1)) {\n                    eta_p_48372 = private_mem_48239[i_48393];\n                    eta_p_48373 = private_mem_48241[i_48393];\n                    eta_p_48374 = private_mem_48243[i_48393];\n                    eta_p_48375 = private_mem_48245[i_48393];\n                    \n                    int16_t defunc_0_op_res_48376 = add16(eta_p_4836", "8, eta_p_48372);\n                    int16_t defunc_0_op_res_48377 = add16(eta_p_48369, eta_p_48373);\n                    int16_t defunc_0_op_res_48378 = add16(eta_p_48370, eta_p_48374);\n                    int16_t defunc_0_op_res_48379 = add16(eta_p_48371, eta_p_48375);\n                    \n                    private_mem_48239[i_48393] = defunc_0_op_res_48376;\n                    private_mem_48241[i_48393] = defunc_0_op_res_48377;\n                    private_mem_48243[i_48393] = defunc_0_op_res_48378;\n                    private_mem_48245[i_48393] = defunc_0_op_res_48379;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48394 = 0; i_48394 < chunk_sizze_48138; i_48394++) {\n                int64_t sharedIdx_48395 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48394;\n                int16_t tmp_48396 = private_mem_48239[i_48394];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48395] = tmp_48396;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48397 = 0; i_48397 < chunk_sizze_48138; i_48397++) {\n                int64_t flat_idx_48398 = thd_offset_48247 + i_48397 * segscan_tblock_sizze_45912;\n                int64_t slice_48399 = rest_43230;\n                int64_t gtid_45916 = flat_idx_48398;\n                int64_t remnant_48400 = flat_idx_48398 - gtid_45916;\n                \n                if (slt64(flat_idx_48398, rest_43230)) {\n                    int16_t tmp_48401 = ((__local int16_t *) local_mem_48215)[flat_idx_48398 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47857)[gtid_45916] = tmp_48401;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48402 = 0; i_48402 < chunk_sizze_48138; i_48402++) {\n                int64_t sharedIdx_48403 = sext_i32_i64(local_tid_48202) * chunk_sizze_", "48138 + i_48402;\n                int16_t tmp_48404 = private_mem_48241[i_48402];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48403] = tmp_48404;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48405 = 0; i_48405 < chunk_sizze_48138; i_48405++) {\n                int64_t flat_idx_48406 = thd_offset_48247 + i_48405 * segscan_tblock_sizze_45912;\n                int64_t slice_48407 = rest_43230;\n                int64_t gtid_45916 = flat_idx_48406;\n                int64_t remnant_48408 = flat_idx_48406 - gtid_45916;\n                \n                if (slt64(flat_idx_48406, rest_43230)) {\n                    int16_t tmp_48409 = ((__local int16_t *) local_mem_48215)[flat_idx_48406 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47859)[gtid_45916] = tmp_48409;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48410 = 0; i_48410 < chunk_sizze_48138; i_48410++) {\n                int64_t sharedIdx_48411 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48410;\n                int16_t tmp_48412 = private_mem_48243[i_48410];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48411] = tmp_48412;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48413 = 0; i_48413 < chunk_sizze_48138; i_48413++) {\n                int64_t flat_idx_48414 = thd_offset_48247 + i_48413 * segscan_tblock_sizze_45912;\n                int64_t slice_48415 = rest_43230;\n                int64_t gtid_45916 = flat_idx_48414;\n                int64_t remnant_48416 = flat_idx_48414 - gtid_45916;\n                \n                if (slt64(flat_idx_48414, rest_43230)) {\n                    int16_t tmp_48417 = ((__local int16_t *) local_mem_48215)[flat_idx_48414 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47861)[gtid_45916] = tmp_48417;\n      ",
                                    "          }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48418 = 0; i_48418 < chunk_sizze_48138; i_48418++) {\n                int64_t sharedIdx_48419 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48418;\n                int16_t tmp_48420 = private_mem_48245[i_48418];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48419] = tmp_48420;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48421 = 0; i_48421 < chunk_sizze_48138; i_48421++) {\n                int64_t flat_idx_48422 = thd_offset_48247 + i_48421 * segscan_tblock_sizze_45912;\n                int64_t slice_48423 = rest_43230;\n                int64_t gtid_45916 = flat_idx_48422;\n                int64_t remnant_48424 = flat_idx_48422 - gtid_45916;\n                \n                if (slt64(flat_idx_48422, rest_43230)) {\n                    int16_t tmp_48425 = ((__local int16_t *) local_mem_48215)[flat_idx_48422 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47863)[gtid_45916] = tmp_48425;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45912\n    #undef chunk_sizze_48138\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegscan_46240_dim1, 1, 1)\nvoid sortColumn_doublezisegscan_46240(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int64_t unsign_arg0_43299, unsigned char cond_f_res_43300_bits, int64_t unsign_arg0_43301, unsigned char cond_f_res_43302_bits, int64_t num_tblocks_46231, int64_t num_virt_blocks_48530, int64_t num_virt_threads_48531, __global unsigned char *mem_47846, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *stat", "us_flags_mem_48532, __global unsigned char *aggregates_mem_48534, __global unsigned char *incprefixes_mem_48536, __global unsigned char *aggregates_mem_48538, __global unsigned char *incprefixes_mem_48540, __global unsigned char *aggregates_mem_48542, __global unsigned char *incprefixes_mem_48544, __global unsigned char *aggregates_mem_48546, __global unsigned char *incprefixes_mem_48548, __global unsigned char *global_dynid_mem_48550)\n{\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    bool cond_f_res_43302 = cond_f_res_43302_bits;\n    \n    #define segscan_tblock_sizze_46230 (sortColumn_doublezisegscan_46240zisegscan_tblock_sizze_46230)\n    #define chunk_sizze_48529 (sortColumn_doublezisegscan_46240zichunk_sizze_48529)\n    \n    volatile __local unsigned char *local_mem_48566_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48566_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_462", "30 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48553;\n    int32_t tblock_sizze_48556;\n    int32_t wave_sizze_48555;\n    int32_t block_id_48554;\n    int32_t global_tid_48552;\n    int64_t phys_tid_46240;\n    int32_t chunk_sizze_32b_48557;\n    int64_t byte_offsets_48558;\n    int64_t byte_offsets_48559;\n    int64_t byte_offsets_48560;\n    int64_t byte_offsets_48561;\n    int64_t warp_byte_offset_48562;\n    int64_t warp_byte_offset_48563;\n    int64_t warp_byte_offset_48564;\n    int64_t warp_byte_offset_48565;\n    __local unsigned char *local_mem_48566;\n    int64_t trans_arr_len_48567;\n    int64_t phys_block_id_48582;\n    int64_t virtloop_bound_48583;\n    \n    local_tid_48553 = get_local_id(0);\n    tblock_sizze_48556 = get_local_size(0);\n    wave_sizze_48555 = LOCKSTEP_WIDTH;\n    block_id_48554 = get_tblock_id(0);\n    global_tid_48552 = block_id_48554 * tblock_sizze_48556 + local_tid_48553;\n    phys_tid_46240 = sext_i32_i64(global_tid_48552);\n    chunk_sizze_32b_48557 = sext_i64_i32(chunk_sizze_48529);\n    byte_offsets_48558 = segscan_tblock_sizze_46230 * (int64_t) 2;\n    byte_offsets_48559 = sdiv_up64(byte_offsets_48558, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46230 * (int64_t) 2;\n    byte_offsets_48560 = sdiv_up64(byte_offsets_48559, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46230 * (int64_t) 2;\n    byte_offsets_48561 = sdiv_up64(byte_offsets_48560, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46230 * (int64_t) 2;\n    warp_byte_offset_48562 = (int64_t) 96;\n    warp_byte_offset_48563 = sdiv_up64(warp_byte_offset_48562, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48564 = sdiv_up64(warp_byte_offset_48563, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48565 = sdiv_up64(warp_byte_offset_48564, (int64_t) 2) * (int",
                                    "64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48566 = (__local unsigned char *) local_mem_48566_backing_0;\n    trans_arr_len_48567 = chunk_sizze_48529 * segscan_tblock_sizze_46230;\n    phys_block_id_48582 = get_tblock_id(0);\n    virtloop_bound_48583 = sdiv_up64(num_virt_blocks_48530 - phys_block_id_48582, num_tblocks_46231);\n    for (int64_t virtloop_i_48584 = 0; virtloop_i_48584 < virtloop_bound_48583; virtloop_i_48584++) {\n        int64_t dynamic_id_48585;\n        int64_t block_offset_48586;\n        int64_t sgm_idx_48587;\n        int32_t boundary_48588;\n        int32_t segsizze_compact_48589;\n        int16_t private_mem_48590[chunk_sizze_48529];\n        int16_t private_mem_48592[chunk_sizze_48529];\n        int16_t private_mem_48594[chunk_sizze_48529];\n        int16_t private_mem_48596[chunk_sizze_48529];\n        int64_t thd_offset_48598;\n        int16_t acc_48648;\n        int16_t acc_48649;\n        int16_t acc_48650;\n        int16_t acc_48651;\n        int16_t prefix_48673;\n        int16_t prefix_48674;\n        int16_t prefix_48675;\n        int16_t prefix_48676;\n        bool block_new_sgm_48677;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48553 == 0) {\n                dynamic_id_48585 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48550)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48566)[(int64_t) 0] = dynamic_id_48585;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48585 == num_virt_blocks_48530 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48550)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48585 = ((__local int32", "_t *) local_mem_48566)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48586 = dynamic_id_48585 * chunk_sizze_48529 * segscan_tblock_sizze_46230;\n        sgm_idx_48587 = smod64(block_offset_48586, i16_res_43225);\n        boundary_48588 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_46230, i16_res_43225 - sgm_idx_48587));\n        segsizze_compact_48589 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_46230, i16_res_43225));\n        thd_offset_48598 = block_offset_48586 + sext_i32_i64(local_tid_48553);\n        // Load and map\n        {\n            for (int64_t i_48599 = 0; i_48599 < chunk_sizze_48529; i_48599++) {\n                int64_t virt_tid_48600 = thd_offset_48598 + i_48599 * segscan_tblock_sizze_46230;\n                int64_t slice_48601 = i16_res_43225;\n                int64_t slice_48602 = n_blocks_43229 * slice_48601;\n                int64_t gtid_46238 = squot64(virt_tid_48600, slice_48601);\n                int64_t remnant_48603 = virt_tid_48600 - gtid_46238 * slice_48601;\n                int64_t gtid_46239 = remnant_48603;\n                int64_t remnant_48604 = remnant_48603 - gtid_46239;\n                \n                if (slt64(virt_tid_48600, n_blocks_43229 * i16_res_43225)) {\n                    int64_t binop_x_46982 = i16_res_43225 * gtid_46238;\n                    int64_t new_index_46983 = gtid_46239 + binop_x_46982;\n                    double eta_p_46254 = ((__global double *) mem_47846)[new_index_46983];\n                    int64_t i64_arg0_46255 = futrts_to_bits64(eta_p_46254);\n                    int64_t unsign_arg0_46256 = ashr64(i64_arg0_46255, unsign_arg0_43299);\n                    int64_t unsign_arg0_46257 = (int64_t) 1 & unsign_arg0_46256;\n                    int32_t to_i32_res_46258 = zext_i64_i32(unsign_arg0_46257);\n                    int64_t unsign_arg0_46259 = ashr64(i64_arg0_46255, (int64_t) 63);\n                    int64_t unsign_arg0_46260 = (int64_t) 1 & unsign_arg0_46259;\n  ", "                  int32_t to_i32_res_46261 = zext_i64_i32(unsign_arg0_46260);\n                    bool cond_46262 = to_i32_res_46261 == 1;\n                    bool x_46263 = !cond_46262;\n                    bool y_46264 = cond_f_res_43300 && x_46263;\n                    bool cond_46265 = cond_46262 || y_46264;\n                    int32_t defunc_0_get_bit_res_46266;\n                    \n                    if (cond_46265) {\n                        int32_t defunc_0_get_bit_res_t_res_46267 = 1 ^ to_i32_res_46258;\n                        \n                        defunc_0_get_bit_res_46266 = defunc_0_get_bit_res_t_res_46267;\n                    } else {\n                        defunc_0_get_bit_res_46266 = to_i32_res_46258;\n                    }\n                    \n                    int32_t zp_lhs_46268 = mul32(2, defunc_0_get_bit_res_46266);\n                    int64_t unsign_arg0_46269 = ashr64(i64_arg0_46255, unsign_arg0_43301);\n                    int64_t unsign_arg0_46270 = (int64_t) 1 & unsign_arg0_46269;\n                    int32_t to_i32_res_46271 = zext_i64_i32(unsign_arg0_46270);\n                    bool y_46272 = cond_f_res_43302 && x_46263;\n                    bool cond_46273 = cond_46262 || y_46272;\n                    int32_t defunc_0_get_bit_res_46274;\n                    \n                    if (cond_46273) {\n                        int32_t defunc_0_get_bit_res_t_res_46275 = 1 ^ to_i32_res_46271;\n                        \n                        defunc_0_get_bit_res_46274 = defunc_0_get_bit_res_t_res_46275;\n                    } else {\n                        defunc_0_get_bit_res_46274 = to_i32_res_46271;\n                    }\n                    \n                    int32_t i32_arg0_46276 = add32(zp_lhs_46268, defunc_0_get_bit_res_46274);\n                    int16_t i32_res_46277 = sext_i32_i16(i32_arg0_46276);\n                    int16_t defunc_0_f_res_46278;\n                    int16_t defunc_0_f_res_46279;\n                    int16_t defunc_0_f_res_4",
                                    "6280;\n                    int16_t defunc_0_f_res_46281;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_46278, &defunc_0_f_res_46279, &defunc_0_f_res_46280, &defunc_0_f_res_46281, i32_res_46277);\n                    ((__global int16_t *) mem_47901)[gtid_46238 * i16_res_43225 + gtid_46239] = i32_res_46277;\n                    private_mem_48590[i_48599] = defunc_0_f_res_46278;\n                    private_mem_48592[i_48599] = defunc_0_f_res_46279;\n                    private_mem_48594[i_48599] = defunc_0_f_res_46280;\n                    private_mem_48596[i_48599] = defunc_0_f_res_46281;\n                } else {\n                    private_mem_48590[i_48599] = (int16_t) 0;\n                    private_mem_48592[i_48599] = (int16_t) 0;\n                    private_mem_48594[i_48599] = (int16_t) 0;\n                    private_mem_48596[i_48599] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48605 = 0; i_48605 < chunk_sizze_48529; i_48605++) {\n                int64_t sharedIdx_48606 = sext_i32_i64(local_tid_48553) + i_48605 * segscan_tblock_sizze_46230;\n                int16_t tmp_48607 = private_mem_48590[i_48605];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48606] = tmp_48607;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48608 = 0; i_48608 < chunk_sizze_48529; i_48608++) {\n                int64_t sharedIdx_48609 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48608;\n                int16_t tmp_48610 = ((__local int16_t *) local_mem_48566)[sharedIdx_48609];\n                \n                private_mem_48590[i_48608] = tmp_48610;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48611 = 0; i_48611 < chunk_sizze_48529; i_48611++) {\n                int64_t sharedIdx_48612 = sext_i32_i64(local_tid_48553) + i_48611", " * segscan_tblock_sizze_46230;\n                int16_t tmp_48613 = private_mem_48592[i_48611];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48612] = tmp_48613;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48614 = 0; i_48614 < chunk_sizze_48529; i_48614++) {\n                int64_t sharedIdx_48615 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48614;\n                int16_t tmp_48616 = ((__local int16_t *) local_mem_48566)[sharedIdx_48615];\n                \n                private_mem_48592[i_48614] = tmp_48616;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48617 = 0; i_48617 < chunk_sizze_48529; i_48617++) {\n                int64_t sharedIdx_48618 = sext_i32_i64(local_tid_48553) + i_48617 * segscan_tblock_sizze_46230;\n                int16_t tmp_48619 = private_mem_48594[i_48617];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48618] = tmp_48619;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48620 = 0; i_48620 < chunk_sizze_48529; i_48620++) {\n                int64_t sharedIdx_48621 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48620;\n                int16_t tmp_48622 = ((__local int16_t *) local_mem_48566)[sharedIdx_48621];\n                \n                private_mem_48594[i_48620] = tmp_48622;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48623 = 0; i_48623 < chunk_sizze_48529; i_48623++) {\n                int64_t sharedIdx_48624 = sext_i32_i64(local_tid_48553) + i_48623 * segscan_tblock_sizze_46230;\n                int16_t tmp_48625 = private_mem_48596[i_48623];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48624] = tmp_48625;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48626 = 0; i_48626 < chunk_sizze_48529; i_48626++) {\n                int64_t sharedIdx_", "48627 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48626;\n                int16_t tmp_48628 = ((__local int16_t *) local_mem_48566)[sharedIdx_48627];\n                \n                private_mem_48596[i_48626] = tmp_48628;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48629 = 0; i_48629 < chunk_sizze_48529 - (int64_t) 1; i_48629++) {\n                int32_t gidx_48630 = local_tid_48553 * chunk_sizze_32b_48557 + 1;\n                bool new_sgm_48631 = smod32(gidx_48630 + sext_i64_i32(i_48629) - boundary_48588, segsizze_compact_48589) == 0;\n                \n                if (!new_sgm_48631) {\n                    int16_t eta_p_46241;\n                    int16_t eta_p_46245;\n                    \n                    eta_p_46241 = private_mem_48590[i_48629];\n                    eta_p_46245 = private_mem_48590[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46242;\n                    int16_t eta_p_46246;\n                    \n                    eta_p_46242 = private_mem_48592[i_48629];\n                    eta_p_46246 = private_mem_48592[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46243;\n                    int16_t eta_p_46247;\n                    \n                    eta_p_46243 = private_mem_48594[i_48629];\n                    eta_p_46247 = private_mem_48594[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46244;\n                    int16_t eta_p_46248;\n                    \n                    eta_p_46244 = private_mem_48596[i_48629];\n                    eta_p_46248 = private_mem_48596[i_48629 + (int64_t) 1];\n                    \n                    int16_t defunc_0_op_res_46249 = add16(eta_p_46241, eta_p_46245);\n                    int16_t defunc_0_op_res_46250 = add16(eta_p_46242, eta_p_46246);\n                    int16_t defunc_0_op_res_46251 = add16(eta_p_46243, eta_p_46247);\n  ",
                                    "                  int16_t defunc_0_op_res_46252 = add16(eta_p_46244, eta_p_46248);\n                    \n                    private_mem_48590[i_48629 + (int64_t) 1] = defunc_0_op_res_46249;\n                    private_mem_48592[i_48629 + (int64_t) 1] = defunc_0_op_res_46250;\n                    private_mem_48594[i_48629 + (int64_t) 1] = defunc_0_op_res_46251;\n                    private_mem_48596[i_48629 + (int64_t) 1] = defunc_0_op_res_46252;\n                }\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48632 = private_mem_48590[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = tmp_48632;\n            \n            int16_t tmp_48633 = private_mem_48592[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48633;\n            \n            int16_t tmp_48634 = private_mem_48594[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48634;\n            \n            int16_t tmp_48635 = private_mem_48596[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48635;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48636;\n            int16_t eta_p_48637;\n            int16_t eta_p_48638;\n            int16_t eta_p_48639;\n            int16_t eta_p_48640;\n            int16_t eta_p_48641;\n            int16_t eta_p_48642;\n            int16_t eta_p_48643;\n            int16_t eta_p_48652;\n            int16_t eta_p_48653;\n            int16_t eta_p_48654;\n            int16_t eta_p_48655;\n            int16_t eta_p", "_48656;\n            int16_t eta_p_48657;\n            int16_t eta_p_48658;\n            int16_t eta_p_48659;\n            bool ltid_in_bounds_48664 = slt64(sext_i32_i64(local_tid_48553), num_virt_threads_48531);\n            int32_t skip_threads_48665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48664) {\n                    eta_p_48640 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                    eta_p_48641 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48642 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48643 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                        eta_p_48636 = eta_p_48640;\n                        eta_p_48637 = eta_p_48641;\n                        eta_p_48638 = eta_p_48642;\n                        eta_p_48639 = eta_p_48643;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48665 = 1;\n                while (slt32(skip_threads_48665, 32)) {\n                    bool thread_active_48666 = sle32(skip_threads_48665, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && ltid_in_bounds_48664;\n                    \n                    if (thread_active_48666) {\n                        // read operands\n                        {\n                            eta_p_48636 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665)];\n                            eta_p_48637 = ((volatile __local int16_t *) local_mem_48566)[squot64(by", "te_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48638 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48639 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_48667 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((local_tid_48553 - skip_threads_48665 + 1) * chunk_sizze_32b_48557 - 1));\n                        \n                        if (thread_active_48666 && inactive_48667) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                        if (thread_active_48666) {\n                            if (!inactive_48667) {\n                                int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                                int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                                int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                                int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                                \n                                eta_p_48636 = defunc_0_op_res_48644;\n                                eta_p_48637 = defunc_0_op_res_48645;\n                                eta_p_48638 = defunc_0_op_res_48646;\n           ",
                                    "                     eta_p_48639 = defunc_0_op_res_48647;\n                            }\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48666) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                            eta_p_48640 = eta_p_48636;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                            eta_p_48641 = eta_p_48637;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                            eta_p_48642 = eta_p_48638;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                            eta_p_48643 = eta_p_48639;\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 31 && ltid_in_bounds_48664) {\n                    ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48636;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(squot32(local_t", "id_48553, 32))] = eta_p_48637;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48638;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48668;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                        eta_p_48656 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                        eta_p_48657 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48658 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48659 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                            eta_p_48652 = eta_p_48656;\n                            eta_p_48653 = eta_p_48657;\n                            eta_p_48654 = eta_p_48658;\n                            eta_p_48655 = eta_p_48659;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48668 = 1;\n                    while (slt32(skip_threads_48668, 32)) {\n                        bool thread_active_48669 = sle32(skip_threads_48668, l", "ocal_tid_48553 - squot32(local_tid_48553, 32) * 32) && (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664);\n                        \n                        if (thread_active_48669) {\n                            // read operands\n                            {\n                                eta_p_48652 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668)];\n                                eta_p_48653 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48654 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48655 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_48670 = slt32(smod32((local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 - (((local_tid_48553 - skip_threads_48668) * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                            \n                            if (thread_active_48669 && inactive_48670) {\n                                eta_p_48652 = eta_p_48656;\n                                eta_p_48653 = eta_p_48657;\n                                eta_p_48654 = eta_p_48658;\n                                eta_p_48655 = eta_p_48659;\n                            }\n                            if (thread_active_48669) {\n                                if (!inactive_48670) {\n ",
                                    "                                   int16_t defunc_0_op_res_48660 = add16(eta_p_48652, eta_p_48656);\n                                    int16_t defunc_0_op_res_48661 = add16(eta_p_48653, eta_p_48657);\n                                    int16_t defunc_0_op_res_48662 = add16(eta_p_48654, eta_p_48658);\n                                    int16_t defunc_0_op_res_48663 = add16(eta_p_48655, eta_p_48659);\n                                    \n                                    eta_p_48652 = defunc_0_op_res_48660;\n                                    eta_p_48653 = defunc_0_op_res_48661;\n                                    eta_p_48654 = defunc_0_op_res_48662;\n                                    eta_p_48655 = defunc_0_op_res_48663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48669) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48652;\n                                eta_p_48656 = eta_p_48652;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48653;\n                                eta_p_48657 = eta_p_48653;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48654;\n                                eta_p_48658 = eta_p_48654;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48655;\n                                eta_p_48659 = eta_p_48655;\n                            }", "\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48668 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48671 = squot32(local_tid_48553, 32) == 0 || !ltid_in_bounds_48664;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48671) {\n                        eta_p_48640 = eta_p_48636;\n                        eta_p_48641 = eta_p_48637;\n                        eta_p_48642 = eta_p_48638;\n                        eta_p_48643 = eta_p_48639;\n                        eta_p_48636 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1];\n                        eta_p_48637 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48638 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48639 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48672 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((squot32(local_tid_48553, 32) * 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                    \n                    if (!no_carry_in_48671) {\n                        if (inactive", "_48672) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                    }\n                    if (!no_carry_in_48671) {\n                        if (!inactive_48672) {\n                            int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                            int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                            int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                            int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                            \n                            eta_p_48636 = defunc_0_op_res_48644;\n                            eta_p_48637 = defunc_0_op_res_48645;\n                            eta_p_48638 = defunc_0_op_res_48646;\n                            eta_p_48639 = defunc_0_op_res_48647;\n                        }\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48671) {\n                        ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_486",
                                    "64) {\n                    ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48640;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48641;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48642;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48643;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48553 == 0) {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[segscan_tblock_sizze_46230 - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (segscan_tblock_sizze_46230 - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (segscan_tblock_sizze_46230 - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (segscan_tblock_sizze_46230 - (int64_t) 1)];\n            } else {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48673 = (int16_t) 0;\n        prefix_4", "8674 = (int16_t) 0;\n        prefix_48675 = (int16_t) 0;\n        prefix_48676 = (int16_t) 0;\n        block_new_sgm_48677 = sgm_idx_48587 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48677 && local_tid_48553 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                acc_48648 = (int16_t) 0;\n                acc_48649 = (int16_t) 0;\n                acc_48650 = (int16_t) 0;\n                acc_48651 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48677 && slt32(local_tid_48553, wave_sizze_48555)) {\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_46230 * chunk_sizze_48529)) {\n                        ((volatile __global int16_t *) aggregates_mem_48534)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) aggregates_mem_48538)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) aggregates_mem_48542)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) aggregates_mem_48546)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 1;\n                    } else {\n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) incprefixes_me", "m_48540)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    \n                    int8_t tmp_48678 = ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48566)[(int64_t) 0] = tmp_48678;\n                }\n                mem_fence_local();\n                \n                int8_t status_48679 = ((__local int8_t *) local_mem_48566)[(int64_t) 0];\n                \n                if (status_48679 == (int8_t) 2) {\n                    if (local_tid_48553 == 0) {\n                        prefix_48673 = ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48674 = ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48675 = ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48676 = ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48680 = sext_i64_i32(dynamic_id_48585 - sext_i32_i64(wave_sizze_48555));\n                    \n                    while (slt32(wave_sizze_48555 * -1, readOffset_48680)) {\n                        int32_t read_i_48681 = readOffset_48680 + local_tid_48553;\n                        int16_t aggr_48682 = (int16_t) 0;\n                        int16_t aggr_48683 = (int16_t) 0;\n                        int16_t aggr_48684 = (int16_t) 0;\n              ",
                                    "          int16_t aggr_48685 = (int16_t) 0;\n                        int8_t flag_48686 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48681)) {\n                            if (sle64(block_offset_48586 - (sext_i32_i64(read_i_48681 + 1) * segscan_tblock_sizze_46230 * chunk_sizze_48529 - (int64_t) 1), sgm_idx_48587)) {\n                                flag_48686 = ((volatile __global int8_t *) status_flags_mem_48532)[sext_i32_i64(read_i_48681)];\n                                if (flag_48686 == (int8_t) 2) {\n                                    aggr_48682 = ((volatile __global int16_t *) incprefixes_mem_48536)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) incprefixes_mem_48540)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) incprefixes_mem_48544)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) incprefixes_mem_48548)[sext_i32_i64(read_i_48681)];\n                                } else if (flag_48686 == (int8_t) 1) {\n                                    aggr_48682 = ((volatile __global int16_t *) aggregates_mem_48534)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) aggregates_mem_48538)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) aggregates_mem_48542)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) aggregates_mem_48546)[sext_i32_i64(read_i_48681)];\n                                }\n                            } else {\n                                flag_48686 = (int8_t) 2;\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = aggr_48682;\n                        ((", "__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48683;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48684;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48685;\n                        ((__local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flag_48686;\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        if (slt8(flag_48686, (int8_t) 2)) {\n                            int8_t flg_x_48699;\n                            int8_t flg_y_48700;\n                            int16_t eta_p_48687;\n                            int16_t eta_p_48688;\n                            int16_t eta_p_48689;\n                            int16_t eta_p_48690;\n                            int16_t eta_p_48691;\n                            int16_t eta_p_48692;\n                            int16_t eta_p_48693;\n                            int16_t eta_p_48694;\n                            int32_t skip_threads_48701;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48700 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                                eta_p_48691 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)];\n                                eta_p_48692 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48693 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n      ", "                          eta_p_48694 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                                    eta_p_48687 = eta_p_48691;\n                                    eta_p_48688 = eta_p_48692;\n                                    eta_p_48689 = eta_p_48693;\n                                    eta_p_48690 = eta_p_48694;\n                                    flg_x_48699 = flg_y_48700;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48701 = 1;\n                                while (slt32(skip_threads_48701, 32)) {\n                                    if (sle32(skip_threads_48701, local_tid_48553 - squot32(local_tid_48553, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48699 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701)];\n                                            eta_p_48687 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48688 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48689 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48690 = ((volatile __local int16_t *) local_mem_48",
                                    "566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48700 == (int8_t) 2 || flg_y_48700 == (int8_t) 0) {\n                                                flg_x_48699 = flg_y_48700;\n                                                eta_p_48687 = eta_p_48691;\n                                                eta_p_48688 = eta_p_48692;\n                                                eta_p_48689 = eta_p_48693;\n                                                eta_p_48690 = eta_p_48694;\n                                            } else {\n                                                int16_t defunc_0_op_res_48695 = add16(eta_p_48687, eta_p_48691);\n                                                int16_t defunc_0_op_res_48696 = add16(eta_p_48688, eta_p_48692);\n                                                int16_t defunc_0_op_res_48697 = add16(eta_p_48689, eta_p_48693);\n                                                int16_t defunc_0_op_res_48698 = add16(eta_p_48690, eta_p_48694);\n                                                \n                                                eta_p_48687 = defunc_0_op_res_48695;\n                                                eta_p_48688 = defunc_0_op_res_48696;\n                                                eta_p_48689 = defunc_0_op_res_48697;\n                                                eta_p_48690 = defunc_0_op_res_48698;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flg_x_48699;\n                                     ", "       flg_y_48700 = flg_x_48699;\n                                            ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = eta_p_48687;\n                                            eta_p_48691 = eta_p_48687;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48688;\n                                            eta_p_48692 = eta_p_48688;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48689;\n                                            eta_p_48693 = eta_p_48689;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48690;\n                                            eta_p_48694 = eta_p_48690;\n                                        }\n                                    }\n                                    skip_threads_48701 *= 2;\n                                }\n                            }\n                        }\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        aggr_48682 = ((__local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48683 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48684 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48685 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(wave_sizz", "e_48555) - (int64_t) 1)];\n                        if (flag_48686 == (int8_t) 2) {\n                            readOffset_48680 = wave_sizze_48555 * -1;\n                        } else if (flag_48686 == (int8_t) 1) {\n                            readOffset_48680 -= wave_sizze_48555;\n                        }\n                        if (slt8((int8_t) 0, flag_48686)) {\n                            int16_t eta_p_48702 = aggr_48682;\n                            int16_t eta_p_48703 = aggr_48683;\n                            int16_t eta_p_48704 = aggr_48684;\n                            int16_t eta_p_48705 = aggr_48685;\n                            int16_t eta_p_48706 = prefix_48673;\n                            int16_t eta_p_48707 = prefix_48674;\n                            int16_t eta_p_48708 = prefix_48675;\n                            int16_t eta_p_48709 = prefix_48676;\n                            int16_t defunc_0_op_res_48710 = add16(eta_p_48702, eta_p_48706);\n                            int16_t defunc_0_op_res_48711 = add16(eta_p_48703, eta_p_48707);\n                            int16_t defunc_0_op_res_48712 = add16(eta_p_48704, eta_p_48708);\n                            int16_t defunc_0_op_res_48713 = add16(eta_p_48705, eta_p_48709);\n                            \n                            prefix_48673 = defunc_0_op_res_48710;\n                            prefix_48674 = defunc_0_op_res_48711;\n                            prefix_48675 = defunc_0_op_res_48712;\n                            prefix_48676 = defunc_0_op_res_48713;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_46230 * chunk_sizze_48529)) {\n                        int16_t eta_p_48714 = prefix_48673;\n                        int16_t eta_p_48715 = prefix_48674;\n                        int16_t eta_p_48716 = prefix_48675;\n                        i",
                                    "nt16_t eta_p_48717 = prefix_48676;\n                        int16_t eta_p_48718 = acc_48648;\n                        int16_t eta_p_48719 = acc_48649;\n                        int16_t eta_p_48720 = acc_48650;\n                        int16_t eta_p_48721 = acc_48651;\n                        int16_t defunc_0_op_res_48722 = add16(eta_p_48714, eta_p_48718);\n                        int16_t defunc_0_op_res_48723 = add16(eta_p_48715, eta_p_48719);\n                        int16_t defunc_0_op_res_48724 = add16(eta_p_48716, eta_p_48720);\n                        int16_t defunc_0_op_res_48725 = add16(eta_p_48717, eta_p_48721);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = defunc_0_op_res_48722;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = defunc_0_op_res_48723;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = defunc_0_op_res_48724;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = defunc_0_op_res_48725;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48566)[(int64_t) 16] = prefix_48673;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)] = prefix_48674;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)] = prefix_48675;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)] = prefix_48676;\n                    acc_48648 = (int16_t) 0;\n                    acc_48649 = (int16_t) 0;\n                    acc_48650 = (int16_t) 0;\n                    acc_48651 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48585 =", "= (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48673 = ((__local int16_t *) local_mem_48566)[(int64_t) 16];\n                prefix_48674 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)];\n                prefix_48675 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)];\n                prefix_48676 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48726;\n            int16_t eta_p_48730;\n            int16_t eta_p_48738 = prefix_48673;\n            int16_t eta_p_48742 = acc_48648;\n            int16_t eta_p_48727;\n            int16_t eta_p_48731;\n            int16_t eta_p_48739 = prefix_48674;\n            int16_t eta_p_48743 = acc_48649;\n            int16_t eta_p_48728;\n            int16_t eta_p_48732;\n            int16_t eta_p_48740 = prefix_48675;\n            int16_t eta_p_48744 = acc_48650;\n            int16_t eta_p_48729;\n            int16_t eta_p_48733;\n            int16_t eta_p_48741 = prefix_48676;\n            int16_t eta_p_48745 = acc_48651;\n            \n            if (slt32(local_tid_48553 * chunk_sizze_32b_48557, boundary_48588) && !block_new_sgm_48677) {\n                int16_t defunc_0_op_res_48746 = add16(eta_p_48738, eta_p_48742);\n                int16_t defunc_0_op_res_48747 = add16(eta_p_48739, eta_p_48743);\n                int16_t defunc_0_op_res_48748 = add16(eta_p_48740, eta_p_48744);\n                int16_t defunc_0_op_res_48749 = add16(eta_p_48741, eta_p_48745);\n                \n                eta_p_48726 = defunc_0_op_res_48746;\n                eta_p_48727 = defunc_0_op_res_48747;\n                eta_p_48728 = defunc_0_op_res_48748;\n                eta_p_48729 = defunc_0_op_res_48749;\n            } else {\n                eta_p_48726 = acc_48648;\n                eta_p_48", "727 = acc_48649;\n                eta_p_48728 = acc_48650;\n                eta_p_48729 = acc_48651;\n            }\n            \n            int32_t stopping_point_48750 = segsizze_compact_48589 - srem32(local_tid_48553 * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589);\n            \n            for (int64_t i_48751 = 0; i_48751 < chunk_sizze_48529; i_48751++) {\n                if (slt32(sext_i64_i32(i_48751), stopping_point_48750 - 1)) {\n                    eta_p_48730 = private_mem_48590[i_48751];\n                    eta_p_48731 = private_mem_48592[i_48751];\n                    eta_p_48732 = private_mem_48594[i_48751];\n                    eta_p_48733 = private_mem_48596[i_48751];\n                    \n                    int16_t defunc_0_op_res_48734 = add16(eta_p_48726, eta_p_48730);\n                    int16_t defunc_0_op_res_48735 = add16(eta_p_48727, eta_p_48731);\n                    int16_t defunc_0_op_res_48736 = add16(eta_p_48728, eta_p_48732);\n                    int16_t defunc_0_op_res_48737 = add16(eta_p_48729, eta_p_48733);\n                    \n                    private_mem_48590[i_48751] = defunc_0_op_res_48734;\n                    private_mem_48592[i_48751] = defunc_0_op_res_48735;\n                    private_mem_48594[i_48751] = defunc_0_op_res_48736;\n                    private_mem_48596[i_48751] = defunc_0_op_res_48737;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48752 = 0; i_48752 < chunk_sizze_48529; i_48752++) {\n                int64_t sharedIdx_48753 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48752;\n                int16_t tmp_48754 = private_mem_48590[i_48752];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48753] = tmp_48754;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48755 = 0; i_48755 < chunk_sizz",
                                    "e_48529; i_48755++) {\n                int64_t flat_idx_48756 = thd_offset_48598 + i_48755 * segscan_tblock_sizze_46230;\n                int64_t slice_48757 = i16_res_43225;\n                int64_t slice_48758 = n_blocks_43229 * slice_48757;\n                int64_t gtid_46238 = squot64(flat_idx_48756, slice_48757);\n                int64_t remnant_48759 = flat_idx_48756 - gtid_46238 * slice_48757;\n                int64_t gtid_46239 = remnant_48759;\n                int64_t remnant_48760 = remnant_48759 - gtid_46239;\n                \n                if (slt64(flat_idx_48756, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48761 = ((__local int16_t *) local_mem_48566)[flat_idx_48756 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47889)[gtid_46238 * i16_res_43225 + gtid_46239] = tmp_48761;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48762 = 0; i_48762 < chunk_sizze_48529; i_48762++) {\n                int64_t sharedIdx_48763 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48762;\n                int16_t tmp_48764 = private_mem_48592[i_48762];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48763] = tmp_48764;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48765 = 0; i_48765 < chunk_sizze_48529; i_48765++) {\n                int64_t flat_idx_48766 = thd_offset_48598 + i_48765 * segscan_tblock_sizze_46230;\n                int64_t slice_48767 = i16_res_43225;\n                int64_t slice_48768 = n_blocks_43229 * slice_48767;\n                int64_t gtid_46238 = squot64(flat_idx_48766, slice_48767);\n                int64_t remnant_48769 = flat_idx_48766 - gtid_46238 * slice_48767;\n                int64_t gtid_46239 = remnant_48769;\n                int64_t remnant_48770 = remnant_48769 - gtid_46239;\n                \n                if (slt64(flat_idx_48766, n_blocks_43229 * i16_res_4322", "5)) {\n                    int16_t tmp_48771 = ((__local int16_t *) local_mem_48566)[flat_idx_48766 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47892)[gtid_46238 * i16_res_43225 + gtid_46239] = tmp_48771;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48772 = 0; i_48772 < chunk_sizze_48529; i_48772++) {\n                int64_t sharedIdx_48773 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48772;\n                int16_t tmp_48774 = private_mem_48594[i_48772];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48773] = tmp_48774;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48775 = 0; i_48775 < chunk_sizze_48529; i_48775++) {\n                int64_t flat_idx_48776 = thd_offset_48598 + i_48775 * segscan_tblock_sizze_46230;\n                int64_t slice_48777 = i16_res_43225;\n                int64_t slice_48778 = n_blocks_43229 * slice_48777;\n                int64_t gtid_46238 = squot64(flat_idx_48776, slice_48777);\n                int64_t remnant_48779 = flat_idx_48776 - gtid_46238 * slice_48777;\n                int64_t gtid_46239 = remnant_48779;\n                int64_t remnant_48780 = remnant_48779 - gtid_46239;\n                \n                if (slt64(flat_idx_48776, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48781 = ((__local int16_t *) local_mem_48566)[flat_idx_48776 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47895)[gtid_46238 * i16_res_43225 + gtid_46239] = tmp_48781;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48782 = 0; i_48782 < chunk_sizze_48529; i_48782++) {\n                int64_t sharedIdx_48783 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48782;\n                int16_t tmp_48784 = private_mem_48596[i_48782];\n                \n                ((_", "_local int16_t *) local_mem_48566)[sharedIdx_48783] = tmp_48784;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48785 = 0; i_48785 < chunk_sizze_48529; i_48785++) {\n                int64_t flat_idx_48786 = thd_offset_48598 + i_48785 * segscan_tblock_sizze_46230;\n                int64_t slice_48787 = i16_res_43225;\n                int64_t slice_48788 = n_blocks_43229 * slice_48787;\n                int64_t gtid_46238 = squot64(flat_idx_48786, slice_48787);\n                int64_t remnant_48789 = flat_idx_48786 - gtid_46238 * slice_48787;\n                int64_t gtid_46239 = remnant_48789;\n                int64_t remnant_48790 = remnant_48789 - gtid_46239;\n                \n                if (slt64(flat_idx_48786, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48791 = ((__local int16_t *) local_mem_48566)[flat_idx_48786 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47898)[gtid_46238 * i16_res_43225 + gtid_46239] = tmp_48791;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_46230\n    #undef chunk_sizze_48529\n}\nFUTHARK_KERNEL_SIZED(sortColumn_doublezisegscan_46375_dim1, 1, 1)\nvoid sortColumn_doublezisegscan_46375(__global int *global_failure, int64_t n_blocks_43229, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, int64_t num_tblocks_46372, int64_t num_virt_blocks_48874, int64_t num_virt_threads_48875, __global unsigned char *ext_mem_47981, __global unsigned char *mem_47989, __global unsigned char *mem_47992, __global unsigned char *status_flags_mem_48876, __global unsigned char *aggregates_mem_48878, __global unsigned char *incprefixes_mem_48880, __global unsigned char *global_dynid_mem_48882)\n{\n    #define segscan_tblock_sizze_46370 (sortColumn_doublezisegscan_46375zisegscan_tblock_sizze_46370)\n    #define chunk_",
                                    "sizze_48873 (sortColumn_doublezisegscan_46375zichunk_sizze_48873)\n    \n    volatile __local unsigned char *local_mem_48892_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48892_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46370), chunk_sizze_48873 * segscan_tblock_sizze_46370 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46370), chunk_sizze_48873 * segscan_tblock_sizze_46370 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48885;\n    int32_t tblock_sizze_48888;\n    int32_t wave_sizze_48887;\n    int32_t block_id_48886;\n    int32_t global_tid_48884;\n    int64_t phys_tid_46375;\n    int32_t chunk_sizze_32b_48889;\n    int64_t byte_offsets_48890;\n    int64_t warp_byte_offset_48891;\n    __local unsigned char *local_mem_48892;\n    int64_t trans_arr_len_48893;\n    int64_t phys_block_id_48899;\n    int64_t virtloop_bound_48900;\n    \n    local_tid_48885 = get_local_id(0);\n    tblock_sizze_48888 = get_local_size(0);\n    wave_sizze_48887 = LOCKSTEP_WIDTH;\n    block_id_48886 = get_tblock_id(0);\n    global_tid_48884 = block_id_48886 * tblock_sizze_48888 + local_tid_48885;\n    phys_tid_46375 = sext_i32_i64(global_tid_48884);\n    chunk_sizze_32b_48889 = sext_i64_i32(chunk_sizze_48873);\n    byte_offsets_48890 = segscan_tblock_sizze_46370 * (int64_t) 8;\n    warp_byte_offset_48891 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48892 = (__local unsigned char *) local_mem_48892_backing_0;\n    trans_arr_len_48893 = chunk_sizze_48873 * segscan_tblock_sizze_46370;\n    phys_block_id_48899 = get_tblock_id(0);\n    virtloop_bound_48900 = sdiv_up64(num_virt_blocks_48874 - phys_block_id_48899, num_tblocks_46372);\n    for (int64_t virtloop_i_48901 = 0; virtloop_i_48901 < virtloop_bound_48900; virtloop_i_48901++) {\n        int64_t dynamic_id_48902;\n        int64_t block_offset_48903;\n", "        int64_t sgm_idx_48904;\n        int32_t boundary_48905;\n        int32_t segsizze_compact_48906;\n        int64_t private_mem_48907[chunk_sizze_48873];\n        int64_t thd_offset_48909;\n        int64_t acc_48925;\n        int64_t prefix_48935;\n        bool block_new_sgm_48936;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48885 == 0) {\n                dynamic_id_48902 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48882)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 0] = dynamic_id_48902;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48902 == num_virt_blocks_48874 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48882)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48902 = ((__local int32_t *) local_mem_48892)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48903 = dynamic_id_48902 * chunk_sizze_48873 * segscan_tblock_sizze_46370;\n        sgm_idx_48904 = smod64(block_offset_48903, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);\n        boundary_48905 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_46370, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240 - sgm_idx_48904));\n        segsizze_compact_48906 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_46370, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240));\n        thd_offset_48909 = block_offset_48903 + sext_i32_i64(local_tid_48885);\n        // Load and map\n        {\n            for (int64_t i_48910 = 0; i_48910 < chunk_sizze_48873; i_48910++) {\n                int64_t virt_tid_48911 = thd_offset_48909 + i_48910 * seg", "scan_tblock_sizze_46370;\n                int64_t slice_48912 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240;\n                int64_t gtid_46374 = virt_tid_48911;\n                int64_t remnant_48913 = virt_tid_48911 - gtid_46374;\n                \n                if (slt64(virt_tid_48911, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n                    int64_t new_index_46940 = squot64(gtid_46374, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);\n                    int64_t binop_y_46942 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 * new_index_46940;\n                    int64_t new_index_46943 = gtid_46374 - binop_y_46942;\n                    bool index_concat_cmp_46945 = sle64(n_blocks_43229, new_index_46943);\n                    int64_t index_concat_branch_46949;\n                    \n                    if (index_concat_cmp_46945) {\n                        int64_t index_concat_46947 = ((__global int64_t *) mem_47989)[new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46947;\n                    } else {\n                        int64_t index_concat_46948 = ((__global int64_t *) ext_mem_47981)[new_index_46943 * (int64_t) 4 + new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46948;\n                    }\n                    private_mem_48907[i_48910] = index_concat_branch_46949;\n                } else {\n                    private_mem_48907[i_48910] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48914 = 0; i_48914 < chunk_sizze_48873; i_48914++) {\n                int64_t sharedIdx_48915 = sext_i32_i64(local_tid_48885) + i_48914 * segscan_tblock_sizze_46370;\n                int64_t tmp_48916 = private_mem_48907[i_48914];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48915] = tmp_48916;\n            }\n  ",
                                    "          barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48917 = 0; i_48917 < chunk_sizze_48873; i_48917++) {\n                int64_t sharedIdx_48918 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48917;\n                int64_t tmp_48919 = ((__local int64_t *) local_mem_48892)[sharedIdx_48918];\n                \n                private_mem_48907[i_48917] = tmp_48919;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48920 = 0; i_48920 < chunk_sizze_48873 - (int64_t) 1; i_48920++) {\n                int64_t eta_p_43489;\n                int64_t eta_p_43490;\n                \n                eta_p_43489 = private_mem_48907[i_48920];\n                eta_p_43490 = private_mem_48907[i_48920 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_43491 = add64(eta_p_43489, eta_p_43490);\n                \n                private_mem_48907[i_48920 + (int64_t) 1] = defunc_0_op_res_43491;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_48921 = private_mem_48907[chunk_sizze_48873 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = tmp_48921;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_48922;\n            int64_t eta_p_48923;\n            int64_t eta_p_48926;\n            int64_t eta_p_48927;\n            bool ltid_in_bounds_48929 = slt64(sext_i32_i64(local_tid_48885), num_virt_threads_48875);\n            int32_t skip_threads_48930;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48929) {\n                    eta_p_48923 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                    if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                        eta_p_48922 =", " eta_p_48923;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48930 = 1;\n                while (slt32(skip_threads_48930, 32)) {\n                    bool thread_active_48931 = sle32(skip_threads_48930, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && ltid_in_bounds_48929;\n                    \n                    if (thread_active_48931) {\n                        // read operands\n                        {\n                            eta_p_48922 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48930)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48931) {\n                            int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                            \n                            eta_p_48922 = defunc_0_op_res_48924;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48931) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                            eta_p_48923 = eta_p_48922;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48930 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 31 && ltid", "_in_bounds_48929) {\n                    ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32))] = eta_p_48922;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48932;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                        eta_p_48927 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                        if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                            eta_p_48926 = eta_p_48927;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48932 = 1;\n                    while (slt32(skip_threads_48932, 32)) {\n                        bool thread_active_48933 = sle32(skip_threads_48932, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929);\n                        \n                        if (thread_active_48933) {\n                            // read operands\n                            {\n                                eta_p_48926 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48932)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48933) {\n                                int64_t defunc_0_op_res_48928 = add64(eta_p_48926, eta_p_48927);\n                                \n                                eta_p_48926 = defunc_0_op_res_48928;\n                            }\n                        }\n    ",
                                    "                    if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48933) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48926;\n                                eta_p_48927 = eta_p_48926;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48932 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48934 = squot32(local_tid_48885, 32) == 0 || !ltid_in_bounds_48929;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48934) {\n                        eta_p_48923 = eta_p_48922;\n                        eta_p_48922 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48934) {\n                        int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                        \n                        eta_p_48922 = defunc_0_op_res_48924;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48934) {\n                        ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values", " for first block\n            {\n                if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                    ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48923;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48885 == 0) {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[segscan_tblock_sizze_46370 - (int64_t) 1];\n            } else {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48935 = (int64_t) 0;\n        block_new_sgm_48936 = sgm_idx_48904 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48936 && local_tid_48885 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = acc_48925;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                acc_48925 = (int64_t) 0;\n            }\n            if (!block_new_sgm_48936 && slt32(local_tid_48885, wave_sizze_48887)) {\n                if (local_tid_48885 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_48878)[dynamic_id_48902] = acc_48925;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 1;\n                    \n                    int8_t tmp_48937 = ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48892)[(int64_t) 0] = tmp_48937;\n                }\n                mem_fence_local();\n                \n                int8_t status_48938 = ((__local int8_t *) local_mem_48892)[(int64_t) 0];\n                \n               ", " if (status_48938 == (int8_t) 2) {\n                    if (local_tid_48885 == 0) {\n                        prefix_48935 = ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48939 = sext_i64_i32(dynamic_id_48902 - sext_i32_i64(wave_sizze_48887));\n                    \n                    while (slt32(wave_sizze_48887 * -1, readOffset_48939)) {\n                        int32_t read_i_48940 = readOffset_48939 + local_tid_48885;\n                        int64_t aggr_48941 = (int64_t) 0;\n                        int8_t flag_48942 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48940)) {\n                            flag_48942 = ((volatile __global int8_t *) status_flags_mem_48876)[sext_i32_i64(read_i_48940)];\n                            if (flag_48942 == (int8_t) 2) {\n                                aggr_48941 = ((volatile __global int64_t *) incprefixes_mem_48880)[sext_i32_i64(read_i_48940)];\n                            } else if (flag_48942 == (int8_t) 1) {\n                                aggr_48941 = ((volatile __global int64_t *) aggregates_mem_48878)[sext_i32_i64(read_i_48940)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = aggr_48941;\n                        ((__local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flag_48942;\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        if (slt8(flag_48942, (int8_t) 2)) {\n                            int8_t flg_x_48946;\n                            int8_t flg_y_48947;\n                            int64_t eta_p_48943;\n                            int64_t eta_p_48944;\n                            int32_t skip_threads_48948;\n                            \n         ",
                                    "                   // read input for in-block scan\n                            {\n                                flg_y_48947 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                                eta_p_48944 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)];\n                                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                                    eta_p_48943 = eta_p_48944;\n                                    flg_x_48946 = flg_y_48947;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48948 = 1;\n                                while (slt32(skip_threads_48948, 32)) {\n                                    if (sle32(skip_threads_48948, local_tid_48885 - squot32(local_tid_48885, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48946 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948)];\n                                            eta_p_48943 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48947 == (int8_t) 2 || flg_y_48947 == (int8_t) 0) {\n                                                flg_x_48946 = flg_y_48947;\n                                                eta_p_48943 = eta_p_48944;\n                                            } else {\n                                                int64_t defunc_0_op_res_48945 = add64(eta_p_48943, e", "ta_p_48944);\n                                                \n                                                eta_p_48943 = defunc_0_op_res_48945;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flg_x_48946;\n                                            flg_y_48947 = flg_x_48946;\n                                            ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = eta_p_48943;\n                                            eta_p_48944 = eta_p_48943;\n                                        }\n                                    }\n                                    skip_threads_48948 *= 2;\n                                }\n                            }\n                        }\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        aggr_48941 = ((__local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(wave_sizze_48887) - (int64_t) 1)];\n                        if (flag_48942 == (int8_t) 2) {\n                            readOffset_48939 = wave_sizze_48887 * -1;\n                        } else if (flag_48942 == (int8_t) 1) {\n                            readOffset_48939 -= wave_sizze_48887;\n                        }\n                        if (slt8((int8_t) 0, flag_48942)) {\n                            int64_t eta_p_48949 = aggr_48941;\n                            int64_t eta_p_48950 = prefix_48935;\n                            int64_t defunc_0_op_res_48951 = add64(eta_p_48949, eta_p_48950);\n                            \n                            prefix_48935 = defunc_0_op_res_48951;\n                        }\n                        mem_fence_local();\n                    }\n  ", "              }\n                if (local_tid_48885 == 0) {\n                    if (boundary_48905 == sext_i64_i32(segscan_tblock_sizze_46370 * chunk_sizze_48873)) {\n                        int64_t eta_p_48952 = prefix_48935;\n                        int64_t eta_p_48953 = acc_48925;\n                        int64_t defunc_0_op_res_48954 = add64(eta_p_48952, eta_p_48953);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = defunc_0_op_res_48954;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 4] = prefix_48935;\n                    acc_48925 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_48902 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48935 = ((__local int64_t *) local_mem_48892)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_48955;\n            int64_t eta_p_48956;\n            int64_t eta_p_48958 = prefix_48935;\n            int64_t eta_p_48959 = acc_48925;\n            \n            if (slt32(local_tid_48885 * chunk_sizze_32b_48889, boundary_48905) && !block_new_sgm_48936) {\n                int64_t defunc_0_op_res_48960 = add64(eta_p_48958, eta_p_48959);\n                \n                eta_p_48955 = defunc_0_op_res_48960;\n            } else {\n                eta_p_48955 = acc_48925;\n            }\n            \n            int32_t stopping_point_48961 = segsizze_compact_48906 - srem32(local_tid_48885 * chunk_sizze_32b_48889 - 1 + segsizze_compact_48906 - boundary_48905, segsizze_compact_48906);\n            \n            for (int64_t i_48962 = 0; i_48962 < chunk_sizze_48873; i_48962++) {\n                if (slt32(sext_i64_i32(i_48962), st",
                                    "opping_point_48961 - 1)) {\n                    eta_p_48956 = private_mem_48907[i_48962];\n                    \n                    int64_t defunc_0_op_res_48957 = add64(eta_p_48955, eta_p_48956);\n                    \n                    private_mem_48907[i_48962] = defunc_0_op_res_48957;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48963 = 0; i_48963 < chunk_sizze_48873; i_48963++) {\n                int64_t sharedIdx_48964 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48963;\n                int64_t tmp_48965 = private_mem_48907[i_48963];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48964] = tmp_48965;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48966 = 0; i_48966 < chunk_sizze_48873; i_48966++) {\n                int64_t flat_idx_48967 = thd_offset_48909 + i_48966 * segscan_tblock_sizze_46370;\n                int64_t slice_48968 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240;\n                int64_t gtid_46374 = flat_idx_48967;\n                int64_t remnant_48969 = flat_idx_48967 - gtid_46374;\n                \n                if (slt64(flat_idx_48967, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n                    int64_t tmp_48970 = ((__local int64_t *) local_mem_48892)[flat_idx_48967 - block_offset_48903];\n                    \n                    ((__global int64_t *) mem_47992)[gtid_46374] = tmp_48970;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_46370\n    #undef chunk_sizze_48873\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzigpuseq_48446_dim1, 1, 1)\nvoid sortColumn_floatzigpuseq_48446(__global int *global_failure, int64_t m_43253, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __glob", "al unsigned char *mem_47863, __global unsigned char *mem_47866, __global unsigned char *mem_47867, __global unsigned char *mem_47868, __global unsigned char *mem_47869)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48448;\n    int32_t tblock_sizze_48451;\n    int32_t wave_sizze_48450;\n    int32_t block_id_48449;\n    int32_t global_tid_48447;\n    int64_t tid_48446;\n    int16_t last_res_47806;\n    int16_t last_res_47808;\n    int16_t last_res_47810;\n    int16_t last_res_47812;\n    \n    local_tid_48448 = get_local_id(0);\n    tblock_sizze_48451 = get_local_size(0);\n    wave_sizze_48450 = LOCKSTEP_WIDTH;\n    block_id_48449 = get_tblock_id(0);\n    global_tid_48447 = block_id_48449 * tblock_sizze_48451 + local_tid_48448;\n    tid_48446 = sext_i32_i64(global_tid_48447);\n    last_res_47806 = ((__global int16_t *) mem_47857)[m_43253];\n    last_res_47808 = ((__global int16_t *) mem_47859)[m_43253];\n    last_res_47810 = ((__global int16_t *) mem_47861)[m_43253];\n    last_res_47812 = ((__global int16_t *) mem_47863)[m_43253];\n    ((__global int16_t *) mem_47866)[(int64_t) 0] = last_res_47806;\n    ((__global int16_t *) mem_47867)[(int64_t) 0] = last_res_47808;\n    ((__global int16_t *) mem_47868)[(int64_t) 0] = last_res_47810;\n    ((__global int16_t *) mem_47869)[(int64_t) 0] = last_res_47812;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzigpuseq_48854_dim1, 1, 1)\nvoid sortColumn_floatzigpuseq_48854(__global int *global_failure, __global unsigned char *ext_mem_47871, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47984, __global unsigned char *mem_47985, __global unsigned char *mem_47986, __global unsigned char *mem_47987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48856;\n    int32_t tblock_sizze_48859;\n    int32_t wave_sizze_48858;\n    int32_t block_id_48857;\n    int32_t global_tid_48855;\n    int64_t tid_", "48854;\n    int16_t defunc_0_radix_sort_step_i16_res_47825;\n    int16_t defunc_0_radix_sort_step_i16_res_47826;\n    int16_t defunc_0_radix_sort_step_i16_res_47827;\n    int16_t defunc_0_radix_sort_step_i16_res_47828;\n    int16_t tmp_47833;\n    int16_t tmp_47837;\n    \n    local_tid_48856 = get_local_id(0);\n    tblock_sizze_48859 = get_local_size(0);\n    wave_sizze_48858 = LOCKSTEP_WIDTH;\n    block_id_48857 = get_tblock_id(0);\n    global_tid_48855 = block_id_48857 * tblock_sizze_48859 + local_tid_48856;\n    tid_48854 = sext_i32_i64(global_tid_48855);\n    defunc_0_radix_sort_step_i16_res_47825 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47826 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47827 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47828 = ((__global int16_t *) ext_mem_47871)[(int64_t) 0];\n    ((__global int16_t *) mem_47984)[(int64_t) 0] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47984)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47826;\n    ((__global int16_t *) mem_47984)[(int64_t) 2] = defunc_0_radix_sort_step_i16_res_47827;\n    ((__global int16_t *) mem_47984)[(int64_t) 3] = defunc_0_radix_sort_step_i16_res_47828;\n    tmp_47833 = add16(defunc_0_radix_sort_step_i16_res_47825, defunc_0_radix_sort_step_i16_res_47826);\n    tmp_47837 = add16(defunc_0_radix_sort_step_i16_res_47827, tmp_47833);\n    ((__global int16_t *) mem_47985)[(int64_t) 0] = (int16_t) 0;\n    ((__global int16_t *) mem_47985)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47985)[(int64_t) 2] = tmp_47833;\n    ((__global int16_t *) mem_47985)[(int64_t) 3] = tmp_47837;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47986)[i_0] = ((__global int16_t *) mem_47984)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_",
                                    "47987)[i_0] = ((__global int16_t *) mem_47985)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45403_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45403(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_43230, int64_t arg_43231, int64_t num_tblocks_45408, int32_t virt_num_tblocks_48452, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47876, __global unsigned char *mem_47878)\n{\n    #define segmap_tblock_sizze_45406 (sortColumn_floatzisegmap_45403zisegmap_tblock_sizze_45406)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48454;\n    int32_t tblock_sizze_48457;\n    int32_t wave_sizze_48456;\n    int32_t block_id_48455;\n    int32_t global_tid_48453;\n    int64_t phys_tid_45403;\n    int32_t phys_tblock_id_48458;\n    int32_t iterations_48459;\n    \n    local_tid_48454 = get_local_id(0);\n    tblock_sizze_48457 = get_local_size(0);\n    wave_sizze_48456 = LOCKSTEP_WIDTH;\n    block_id_48455 = get_tblock_id(0);\n    global_tid_48453 = block_id_48455 * tblock_sizze_48457 + local_tid_48454;\n    phys_tid_45403 = sext_i32_i64(global_tid_48453);\n    phys_tblock_id_48458 = get_tblock_id(0);\n    iterations_48459 = sdiv_up32(virt_num_tblocks_48452 - phys_tblock_id_48458, sext_i64_i32(num_tblocks_45408));\n    for (int32_t i_48460 = 0; i_48460 < iterations_48459; i_48460++) {\n        int32_t virt_tblock_id_48461;\n        int64_t global_tid_48462;\n        int64_t slice_48463;\n        int64_t write_i_45402;\n        int64_t remnant_48464;\n        \n        virt_tblock_i", "d_48461 = phys_tblock_id_48458 + i_48460 * sext_i64_i32(num_tblocks_45408);\n        global_tid_48462 = sext_i32_i64(virt_tblock_id_48461) * segmap_tblock_sizze_45406 + sext_i32_i64(local_tid_48454);\n        slice_48463 = rest_43230;\n        write_i_45402 = global_tid_48462;\n        remnant_48464 = global_tid_48462 - write_i_45402;\n        if (slt64(write_i_45402, rest_43230)) {\n            int16_t defunc_0_radix_sort_step_i16_res_47822;\n            int16_t defunc_0_radix_sort_step_i16_res_47823;\n            int16_t defunc_0_radix_sort_step_i16_res_47824;\n            int16_t eta_p_43653;\n            int16_t eta_p_43654;\n            int16_t eta_p_43655;\n            int16_t eta_p_43656;\n            int16_t eta_p_43657;\n            int64_t slice_46965;\n            float write_value_43658;\n            int64_t write_value_43659;\n            int64_t defunc_0_f_res_43660;\n            \n            defunc_0_radix_sort_step_i16_res_47822 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47823 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47824 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n            eta_p_43653 = ((__global int16_t *) mem_47865)[write_i_45402];\n            eta_p_43654 = ((__global int16_t *) mem_47857)[write_i_45402];\n            eta_p_43655 = ((__global int16_t *) mem_47859)[write_i_45402];\n            eta_p_43656 = ((__global int16_t *) mem_47861)[write_i_45402];\n            eta_p_43657 = ((__global int16_t *) mem_47863)[write_i_45402];\n            slice_46965 = arg_43231 + write_i_45402;\n            write_value_43658 = ((__global float *) mem_47846)[slice_46965];\n            write_value_43659 = ((__global int64_t *) mem_47848)[slice_46965];\n            futrts_lifted_f_7536(&defunc_0_f_res_43660, defunc_0_radix_sort_step_i16_res_47822, defunc_0_radix_sort_step_i16_res_47823, defunc_0_radix_sort_step_i16_res_47824, eta_p_43653, eta_p_43654, eta_p_43655,", " eta_p_43656, eta_p_43657);\n            if (sle64((int64_t) 0, defunc_0_f_res_43660) && slt64(defunc_0_f_res_43660, rest_43230)) {\n                ((__global float *) mem_47878)[defunc_0_f_res_43660] = write_value_43658;\n            }\n            if (sle64((int64_t) 0, defunc_0_f_res_43660) && slt64(defunc_0_f_res_43660, rest_43230)) {\n                ((__global int64_t *) mem_47876)[defunc_0_f_res_43660] = write_value_43659;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45406\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45425_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45425(__global int *global_failure, __global unsigned char *mem_47986, __global unsigned char *mem_47989)\n{\n    #define segmap_tblock_sizze_45421 (sortColumn_floatzisegmap_45425zisegmap_tblock_sizze_45421)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48862;\n    int32_t tblock_sizze_48865;\n    int32_t wave_sizze_48864;\n    int32_t block_id_48863;\n    int32_t global_tid_48861;\n    int64_t phys_tid_45425;\n    int64_t global_tid_48866;\n    int64_t slice_48867;\n    int64_t gtid_45424;\n    int64_t remnant_48868;\n    \n    local_tid_48862 = get_local_id(0);\n    tblock_sizze_48865 = get_local_size(0);\n    wave_sizze_48864 = LOCKSTEP_WIDTH;\n    block_id_48863 = get_tblock_id(0);\n    global_tid_48861 = block_id_48863 * tblock_sizze_48865 + local_tid_48862;\n    phys_tid_45425 = sext_i32_i64(global_tid_48861);\n    global_tid_48866 = sext_i32_i64(block_id_48863) * segmap_tblock_sizze_45421 + sext_i32_i64(local_tid_48862);\n    slice_48867 = (int64_t) 4;\n    gtid_45424 = global_tid_48866;\n    remnant_48868 = global_tid_48866 - gtid_45424;\n    if (slt64(gtid_45424, (int64_t) 4)) {\n        int16_t eta_p_45426;\n        int64_t i16_res_45427;\n        \n        eta_p_45426 = ((__global int16_t *) mem_47986)[gtid_45424];\n        i16_res_45427 = sext_i16_i64(eta_p_45426);\n        ((__global in",
                                    "t64_t *) mem_47989)[gtid_45424] = i16_res_45427;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45421\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45765_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45765(__global int *global_failure, int64_t i16_res_43225, unsigned char zzero_43226_bits, unsigned char nonzzero_43227_bits, int64_t n_blocks_43229, int64_t tmp_43268, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    bool zzero_43226 = zzero_43226_bits;\n    bool nonzzero_43227 = nonzzero_43227_bits;\n    \n    #define segmap_tblock_sizze_45758 (sortColumn_floatzisegmap_45765zisegmap_tblock_sizze_45758)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48794;\n    int32_t tblock_sizze_48797;\n    int32_t wave_sizze_48796;\n    int32_t block_id_48795;\n    int32_t global_tid_48793;\n    int64_t phys_tid_45765;\n    int64_t global_tid_48798;\n    int64_t slice_48799;\n    int64_t gtid_45764;\n    int64_t remnant_48800;\n    \n    local_tid_48794 = get_local_id(0);\n    tblock_sizze_48797 = get_local_size(0);\n    wave_sizze_48796 = LOCKSTEP_WIDTH;\n    block_id_48795 = get_tblock_id(0);\n    global_tid_48793 = block_id_48795 * tblock_sizze_48797 + local_tid_48794;\n    phys_tid_45765 = sext_i32_i64(global_tid_48793);\n    global_tid_48798 = sext_i32_i64(block_id_48795) * segmap_tblock_sizze_45758 + sext_i32_i64(local_tid_48794);\n    slice_48799 = n_blocks_43229;\n    gtid_45764 = global_tid_48798;\n    remnant_48800 = global_tid_48798 - gtid_45764;\n    if (slt64(gtid_45764, n_blocks_43229)) {\n        int16_t last_res_45774;\n        int16_t last_res_45775;\n        int16_t last_res_45776;\n        int16_t last_res_45777;\n        int16_t defunc_0_f_res_45770;\n        int16_t defunc_0_f_res_45771;\n        int16_t defunc_0_f_re", "s_45772;\n        int16_t defunc_0_f_res_45773;\n        \n        if (nonzzero_43227) {\n            int16_t x_46956 = ((__global int16_t *) mem_47889)[gtid_45764 * i16_res_43225 + tmp_43268];\n            \n            last_res_45774 = x_46956;\n        } else {\n            last_res_45774 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46958 = ((__global int16_t *) mem_47892)[gtid_45764 * i16_res_43225 + tmp_43268];\n            \n            last_res_45775 = x_46958;\n        } else {\n            last_res_45775 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46960 = ((__global int16_t *) mem_47895)[gtid_45764 * i16_res_43225 + tmp_43268];\n            \n            last_res_45776 = x_46960;\n        } else {\n            last_res_45776 = (int16_t) 0;\n        }\n        if (nonzzero_43227) {\n            int16_t x_46962 = ((__global int16_t *) mem_47898)[gtid_45764 * i16_res_43225 + tmp_43268];\n            \n            last_res_45777 = x_46962;\n        } else {\n            last_res_45777 = (int16_t) 0;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_45770 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45770 = last_res_45774;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_45771 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45771 = last_res_45775;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_45772 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45772 = last_res_45776;\n        }\n        if (zzero_43226) {\n            defunc_0_f_res_45773 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45773 = last_res_45777;\n        }\n        ((__global int16_t *) mem_47904)[gtid_45764] = defunc_0_f_res_45773;\n        ((__global int16_t *) mem_47906)[gtid_45764] = defunc_0_f_res_45770;\n        ((__global int16_t *) mem_47908)[gtid_45764] = defunc_0_f_res_45771;\n        ((__global int16_t *) mem_47910)[gtid_45764] = defunc_0_f_res_45772;\n    }\n  ", "  \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45758\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45787_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45787(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int64_t num_tblocks_45781, int32_t virt_num_tblocks_48801, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47882, __global unsigned char *mem_47885, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    #define segmap_tblock_sizze_45780 (sortColumn_floatzisegmap_45787zisegmap_tblock_sizze_45780)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48803;\n    int32_t tblock_sizze_48806;\n    int32_t wave_sizze_48805;\n    int32_t block_id_48804;\n    int32_t global_tid_48802;\n    int64_t phys_tid_45787;\n    int32_t phys_tblock_id_48807;\n    int32_t iterations_48808;\n    \n    local_tid_48803 = get_local_id(0);\n    tblock_sizze_48806 = get_local_size(0);\n    wave_sizze_48805 = LOCKSTEP_WIDTH;\n    block_id_48804 = get_tblock_id(0);\n    global_tid_48802 = block_id_48804 * tblock_sizze_48806 + local_tid_48803;\n    phys_tid_45787 = sext_i32_i64(global_tid_48802);\n    phys_tblock_id_48807 = get_tblock_id(0);\n    iterations_48808 = sdiv_up32(virt_num_tblocks_48801 - phys_tblock_id_48807, sext_i64_i32(num_tblocks_45781));\n    for (int32_t i_48809 = 0; i_48809 < iterations_48808; i_48809++) {\n        int32_t virt_tblock_id_48810;\n        int64_t global_tid_48811;\n        int64_t slice_48812;\n        int64_t slice_48813;\n        int64_t gtid_45785;\n        int64_t remnant_48814;\n        int64_t gtid_45786;\n    ",
                                    "    int64_t remnant_48815;\n        \n        virt_tblock_id_48810 = phys_tblock_id_48807 + i_48809 * sext_i64_i32(num_tblocks_45781);\n        global_tid_48811 = sext_i32_i64(virt_tblock_id_48810) * segmap_tblock_sizze_45780 + sext_i32_i64(local_tid_48803);\n        slice_48812 = i16_res_43225;\n        slice_48813 = n_blocks_43229 * slice_48812;\n        gtid_45785 = squot64(global_tid_48811, slice_48812);\n        remnant_48814 = global_tid_48811 - gtid_45785 * slice_48812;\n        gtid_45786 = remnant_48814;\n        remnant_48815 = remnant_48814 - gtid_45786;\n        if (slt64(gtid_45785, n_blocks_43229) && slt64(gtid_45786, i16_res_43225)) {\n            int16_t defunc_0_f_res_45788;\n            int16_t defunc_0_f_res_45789;\n            int16_t defunc_0_f_res_45790;\n            int16_t eta_p_45791;\n            int16_t eta_p_45792;\n            int16_t eta_p_45793;\n            int16_t eta_p_45794;\n            int16_t eta_p_45795;\n            int64_t binop_x_46950;\n            int64_t new_index_46951;\n            float write_value_45796;\n            int64_t write_value_45797;\n            int64_t defunc_0_f_res_45798;\n            \n            defunc_0_f_res_45788 = ((__global int16_t *) mem_47906)[gtid_45785];\n            defunc_0_f_res_45789 = ((__global int16_t *) mem_47908)[gtid_45785];\n            defunc_0_f_res_45790 = ((__global int16_t *) mem_47910)[gtid_45785];\n            eta_p_45791 = ((__global int16_t *) mem_47901)[gtid_45785 * i16_res_43225 + gtid_45786];\n            eta_p_45792 = ((__global int16_t *) mem_47889)[gtid_45785 * i16_res_43225 + gtid_45786];\n            eta_p_45793 = ((__global int16_t *) mem_47892)[gtid_45785 * i16_res_43225 + gtid_45786];\n            eta_p_45794 = ((__global int16_t *) mem_47895)[gtid_45785 * i16_res_43225 + gtid_45786];\n            eta_p_45795 = ((__global int16_t *) mem_47898)[gtid_45785 * i16_res_43225 + gtid_45786];\n            binop_x_46950 = i16_res_43225 * gtid_45785;\n            new_index_46951 = gtid_45786 + binop_x_469", "50;\n            write_value_45796 = ((__global float *) mem_47846)[new_index_46951];\n            write_value_45797 = ((__global int64_t *) mem_47848)[new_index_46951];\n            futrts_lifted_f_7536(&defunc_0_f_res_45798, defunc_0_f_res_45788, defunc_0_f_res_45789, defunc_0_f_res_45790, eta_p_45791, eta_p_45792, eta_p_45793, eta_p_45794, eta_p_45795);\n            if ((sle64((int64_t) 0, gtid_45785) && slt64(gtid_45785, n_blocks_43229)) && (sle64((int64_t) 0, defunc_0_f_res_45798) && slt64(defunc_0_f_res_45798, i16_res_43225))) {\n                ((__global float *) mem_47882)[gtid_45785 * i16_res_43225 + defunc_0_f_res_45798] = write_value_45796;\n            }\n            if ((sle64((int64_t) 0, gtid_45785) && slt64(gtid_45785, n_blocks_43229)) && (sle64((int64_t) 0, defunc_0_f_res_45798) && slt64(defunc_0_f_res_45798, i16_res_43225))) {\n                ((__global int64_t *) mem_47885)[gtid_45785 * i16_res_43225 + defunc_0_f_res_45798] = write_value_45797;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45780\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45805_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45805(__global int *global_failure, int64_t n_blocks_43229, int64_t num_tblocks_45801, int32_t virt_num_tblocks_48816, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47927)\n{\n    #define segmap_tblock_sizze_45800 (sortColumn_floatzisegmap_45805zisegmap_tblock_sizze_45800)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48818;\n    int32_t tblock_sizze_48821;\n    int32_t wave_sizze_48820;\n    int32_t block_id_48819;\n    int32_t global_tid_48817;\n    int64_t phys_tid_45805;\n    int32_t phys_tblock_id_48822;\n    int32_t iterations_48823;\n    \n    local_tid_48818 = get_local_id(0);\n    tblock_sizze_48821 = get_local_size(0);\n  ", "  wave_sizze_48820 = LOCKSTEP_WIDTH;\n    block_id_48819 = get_tblock_id(0);\n    global_tid_48817 = block_id_48819 * tblock_sizze_48821 + local_tid_48818;\n    phys_tid_45805 = sext_i32_i64(global_tid_48817);\n    phys_tblock_id_48822 = get_tblock_id(0);\n    iterations_48823 = sdiv_up32(virt_num_tblocks_48816 - phys_tblock_id_48822, sext_i64_i32(num_tblocks_45801));\n    for (int32_t i_48824 = 0; i_48824 < iterations_48823; i_48824++) {\n        int32_t virt_tblock_id_48825;\n        int64_t global_tid_48826;\n        int64_t slice_48827;\n        int64_t gtid_45804;\n        int64_t remnant_48828;\n        \n        virt_tblock_id_48825 = phys_tblock_id_48822 + i_48824 * sext_i64_i32(num_tblocks_45801);\n        global_tid_48826 = sext_i32_i64(virt_tblock_id_48825) * segmap_tblock_sizze_45800 + sext_i32_i64(local_tid_48818);\n        slice_48827 = n_blocks_43229;\n        gtid_45804 = global_tid_48826;\n        remnant_48828 = global_tid_48826 - gtid_45804;\n        if (slt64(gtid_45804, n_blocks_43229)) {\n            int16_t defunc_0_f_res_45806;\n            int16_t defunc_0_f_res_45807;\n            int16_t defunc_0_f_res_45808;\n            int16_t defunc_0_f_res_45809;\n            int16_t mem_47917[(int64_t) 4];\n            \n            defunc_0_f_res_45806 = ((__global int16_t *) mem_47906)[gtid_45804];\n            defunc_0_f_res_45807 = ((__global int16_t *) mem_47908)[gtid_45804];\n            defunc_0_f_res_45808 = ((__global int16_t *) mem_47910)[gtid_45804];\n            defunc_0_f_res_45809 = ((__global int16_t *) mem_47904)[gtid_45804];\n            mem_47917[(int64_t) 0] = defunc_0_f_res_45806;\n            mem_47917[(int64_t) 1] = defunc_0_f_res_45807;\n            mem_47917[(int64_t) 2] = defunc_0_f_res_45808;\n            mem_47917[(int64_t) 3] = defunc_0_f_res_45809;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47927)[gtid_45804 + i_0 * n_blocks_43229] = mem_47917[i_0];\n            }\n        }\n        barrier(CLK_",
                                    "GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45800\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45822_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45822(__global int *global_failure, int64_t n_blocks_43229, __global unsigned char *mem_47927, __global unsigned char *mem_47931)\n{\n    #define segmap_tblock_sizze_45817 (sortColumn_floatzisegmap_45822zisegmap_tblock_sizze_45817)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48831;\n    int32_t tblock_sizze_48834;\n    int32_t wave_sizze_48833;\n    int32_t block_id_48832;\n    int32_t global_tid_48830;\n    int64_t phys_tid_45822;\n    int64_t global_tid_48835;\n    int64_t slice_48836;\n    int64_t slice_48837;\n    int64_t gtid_45820;\n    int64_t remnant_48838;\n    int64_t gtid_45821;\n    int64_t remnant_48839;\n    \n    local_tid_48831 = get_local_id(0);\n    tblock_sizze_48834 = get_local_size(0);\n    wave_sizze_48833 = LOCKSTEP_WIDTH;\n    block_id_48832 = get_tblock_id(0);\n    global_tid_48830 = block_id_48832 * tblock_sizze_48834 + local_tid_48831;\n    phys_tid_45822 = sext_i32_i64(global_tid_48830);\n    global_tid_48835 = sext_i32_i64(block_id_48832) * segmap_tblock_sizze_45817 + sext_i32_i64(local_tid_48831);\n    slice_48836 = (int64_t) 4;\n    slice_48837 = n_blocks_43229 * slice_48836;\n    gtid_45820 = squot64(global_tid_48835, slice_48836);\n    remnant_48838 = global_tid_48835 - gtid_45820 * slice_48836;\n    gtid_45821 = remnant_48838;\n    remnant_48839 = remnant_48838 - gtid_45821;\n    if (slt64(gtid_45820, n_blocks_43229) && slt64(gtid_45821, (int64_t) 4)) {\n        int16_t eta_p_45823;\n        int64_t i16_res_45824;\n        \n        eta_p_45823 = ((__global int16_t *) mem_47927)[gtid_45820 + gtid_45821 * n_blocks_43229];\n        i16_res_45824 = sext_i16_i64(eta_p_45823);\n        ((__global int64_t *) mem_47931)[gtid_45820 * (int64_t) 4 + gtid_45821] = i16_res_45824;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45", "817\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45832_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45832(__global int *global_failure, int64_t n_blocks_43229, int64_t num_tblocks_45828, int32_t virt_num_tblocks_48840, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47947)\n{\n    #define segmap_tblock_sizze_45827 (sortColumn_floatzisegmap_45832zisegmap_tblock_sizze_45827)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48842;\n    int32_t tblock_sizze_48845;\n    int32_t wave_sizze_48844;\n    int32_t block_id_48843;\n    int32_t global_tid_48841;\n    int64_t phys_tid_45832;\n    int32_t phys_tblock_id_48846;\n    int32_t iterations_48847;\n    \n    local_tid_48842 = get_local_id(0);\n    tblock_sizze_48845 = get_local_size(0);\n    wave_sizze_48844 = LOCKSTEP_WIDTH;\n    block_id_48843 = get_tblock_id(0);\n    global_tid_48841 = block_id_48843 * tblock_sizze_48845 + local_tid_48842;\n    phys_tid_45832 = sext_i32_i64(global_tid_48841);\n    phys_tblock_id_48846 = get_tblock_id(0);\n    iterations_48847 = sdiv_up32(virt_num_tblocks_48840 - phys_tblock_id_48846, sext_i64_i32(num_tblocks_45828));\n    for (int32_t i_48848 = 0; i_48848 < iterations_48847; i_48848++) {\n        int32_t virt_tblock_id_48849;\n        int64_t global_tid_48850;\n        int64_t slice_48851;\n        int64_t gtid_45831;\n        int64_t remnant_48852;\n        \n        virt_tblock_id_48849 = phys_tblock_id_48846 + i_48848 * sext_i64_i32(num_tblocks_45828);\n        global_tid_48850 = sext_i32_i64(virt_tblock_id_48849) * segmap_tblock_sizze_45827 + sext_i32_i64(local_tid_48842);\n        slice_48851 = n_blocks_43229;\n        gtid_45831 = global_tid_48850;\n        remnant_48852 = global_tid_48850 - gtid_45831;\n        if (slt64(gtid_45831, n_blocks_43229)) {\n            int16_t defunc_0_f_res_45833;\n            int16_t defunc_0_f_res_45834;\n            int16_t defunc_0_f_res_45835;\n            int16_t tmp_45", "836;\n            int16_t tmp_45837;\n            int16_t mem_47937[(int64_t) 4];\n            \n            defunc_0_f_res_45833 = ((__global int16_t *) mem_47906)[gtid_45831];\n            defunc_0_f_res_45834 = ((__global int16_t *) mem_47908)[gtid_45831];\n            defunc_0_f_res_45835 = ((__global int16_t *) mem_47910)[gtid_45831];\n            tmp_45836 = add16(defunc_0_f_res_45833, defunc_0_f_res_45834);\n            tmp_45837 = add16(defunc_0_f_res_45835, tmp_45836);\n            mem_47937[(int64_t) 0] = (int16_t) 0;\n            mem_47937[(int64_t) 1] = defunc_0_f_res_45833;\n            mem_47937[(int64_t) 2] = tmp_45836;\n            mem_47937[(int64_t) 3] = tmp_45837;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47947)[gtid_45831 + i_0 * n_blocks_43229] = mem_47937[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45827\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45868_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45868(__global int *global_failure, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, __global unsigned char *mem_47992, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_45864 (sortColumn_floatzisegmap_45868zisegmap_tblock_sizze_45864)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48973;\n    int32_t tblock_sizze_48976;\n    int32_t wave_sizze_48975;\n    int32_t block_id_48974;\n    int32_t global_tid_48972;\n    int64_t phys_tid_45868;\n    int64_t global_tid_48977;\n    int64_t slice_48978;\n    int64_t gtid_45867;\n    int64_t remnant_48979;\n    \n    local_tid_48973 = get_local_id(0);\n    tblock_sizze_48976 = get_local_size(0);\n    wave_sizze_48975 = LOCKSTEP_WIDTH;\n    block_id_48974 = get_tblock_id(0);\n    global_tid_48972 = block_id_48974 * tblock_sizze_48976 + local_tid_48973;\n    phys_tid_45868 = sext_i32_i64(global_tid_48972);\n   ",
                                    " global_tid_48977 = sext_i32_i64(block_id_48974) * segmap_tblock_sizze_45864 + sext_i32_i64(local_tid_48973);\n    slice_48978 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240;\n    gtid_45867 = global_tid_48977;\n    remnant_48979 = global_tid_48977 - gtid_45867;\n    if (slt64(gtid_45867, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n        int64_t zv_lhs_45870;\n        int64_t tmp_45871;\n        int64_t lifted_lambda_res_45872;\n        \n        zv_lhs_45870 = add64((int64_t) -1, gtid_45867);\n        tmp_45871 = smod64(zv_lhs_45870, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);\n        lifted_lambda_res_45872 = ((__global int64_t *) mem_47992)[tmp_45871];\n        ((__global int64_t *) mem_47995)[gtid_45867] = lifted_lambda_res_45872;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45864\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45874_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45874(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int64_t arg_43231, int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, int32_t blocked_radix_sort_step_arg1_43293, int64_t num_tblocks_45879, int64_t ext_47978, int64_t ext_47979, int32_t virt_num_tblocks_48980, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47876, __global unsigned char *mem_47878, __global unsigned char *ext_mem_47980, __global unsigned char *ext_mem_47982, __global unsigned char *ext_mem_47983, __global unsigned char *mem_47987, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_45877 (sortColumn_floatzisegmap_45874zisegmap_tblock_sizze_45877)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = ", "0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_48982;\n    int32_t tblock_sizze_48985;\n    int32_t wave_sizze_48984;\n    int32_t block_id_48983;\n    int32_t global_tid_48981;\n    int64_t phys_tid_45874;\n    int32_t phys_tblock_id_48986;\n    int32_t iterations_48987;\n    \n    local_tid_48982 = get_local_id(0);\n    tblock_sizze_48985 = get_local_size(0);\n    wave_sizze_48984 = LOCKSTEP_WIDTH;\n    block_id_48983 = get_tblock_id(0);\n    global_tid_48981 = block_id_48983 * tblock_sizze_48985 + local_tid_48982;\n    phys_tid_45874 = sext_i32_i64(global_tid_48981);\n    phys_tblock_id_48986 = get_tblock_id(0);\n    iterations_48987 = sdiv_up32(virt_num_tblocks_48980 - phys_tblock_id_48986, sext_i64_i32(num_tblocks_45879));\n    for (int32_t i_48988 = 0; i_48988 < iterations_48987; i_48988++) {\n        int32_t virt_tblock_id_48989;\n        int64_t global_tid_48990;\n        int64_t slice_48991;\n        int64_t write_i_45873;\n        int64_t remnant_48992;\n        \n        virt_tblock_id_48989 = phys_tblock_id_48986 + i_48988 * sext_i64_i32(num_tblocks_45879);\n        global_tid_48990 = sext_i32_i64(virt_tblock_id_48989) * segmap_tblock_sizze_45877 + sext_i32_i64(local_tid_48982);\n        slice_48991 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;\n        write_i_45873 = global_tid_48990;\n        remnant_48992 = global_tid_48990 - write_i_45873;\n        if (slt64(write_i_45873, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n            bool index_concat_cmp_46931;\n            float index_concat_branch_43604;\n            int32_t i32_arg0_43611;\n            int32_t unsign_arg0_43612;\n            int32_t unsign_arg0_43613;\n            bool cond_43614;\n            bool x_43615;\n            int32_t zlzb_rhs_43616;\n            int32_t acc_43618;\n            int64_t i32_res_43629;\n            int64_t block_idx_43630;\n            bool x_43631;\n            bool y_43632;\n            bool bounds_check_43633;\n            bool ", "index_certs_43634;\n            bool x_43635;\n            bool y_43636;\n            bool bounds_check_43637;\n            bool index_certs_43638;\n            float index_concat_branch_46935;\n            int64_t index_concat_branch_46929;\n            int64_t binop_x_43639;\n            int64_t new_index_43640;\n            int64_t new_offset_43641;\n            bool index_concat_cmp_43642;\n            int16_t index_concat_branch_43643;\n            int64_t i16_res_43646;\n            int64_t zp_lhs_43647;\n            int64_t old_offset_43648;\n            int64_t zp_lhs_43649;\n            int64_t idx_43650;\n            \n            index_concat_cmp_46931 = sle64(arg_43231, write_i_45873);\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_43824;\n                float index_concat_43825;\n                \n                index_concat_i_43824 = sub64(write_i_45873, arg_43231);\n                index_concat_43825 = ((__global float *) mem_47878)[index_concat_i_43824];\n                index_concat_branch_43604 = index_concat_43825;\n            } else {\n                int64_t new_index_43607;\n                int64_t binop_y_43608;\n                int64_t new_index_43609;\n                float index_concat_43610;\n                \n                new_index_43607 = squot64(write_i_45873, i16_res_43225);\n                binop_y_43608 = i16_res_43225 * new_index_43607;\n                new_index_43609 = write_i_45873 - binop_y_43608;\n                index_concat_43610 = ((__global float *) ext_mem_47983)[new_index_43607 * i16_res_43225 + new_index_43609];\n                index_concat_branch_43604 = index_concat_43610;\n            }\n            i32_arg0_43611 = futrts_to_bits32(index_concat_branch_43604);\n            unsign_arg0_43612 = ashr32(i32_arg0_43611, 31);\n            unsign_arg0_43613 = 1 & unsign_arg0_43612;\n            cond_43614 = unsign_arg0_43613 == 1;\n            x_43615 = !cond_43614;\n            acc_43618 = 0;\n            for (int32_t i_4361",
                                    "7 = 0; i_43617 < 2; i_43617++) {\n                int32_t get_bit_arg0_43619;\n                int32_t unsign_arg0_43620;\n                int32_t unsign_arg0_43621;\n                bool cond_f_res_43622;\n                bool y_43623;\n                bool cond_43624;\n                int32_t defunc_0_get_bit_res_43625;\n                int32_t zp_rhs_43627;\n                int32_t loopres_43628;\n                int32_t acc_tmp_48993;\n                \n                get_bit_arg0_43619 = add32(blocked_radix_sort_step_arg1_43293, i_43617);\n                unsign_arg0_43620 = ashr32(i32_arg0_43611, get_bit_arg0_43619);\n                unsign_arg0_43621 = 1 & unsign_arg0_43620;\n                cond_f_res_43622 = get_bit_arg0_43619 == 31;\n                y_43623 = x_43615 && cond_f_res_43622;\n                cond_43624 = cond_43614 || y_43623;\n                if (cond_43624) {\n                    int32_t defunc_0_get_bit_res_t_res_43826 = 1 ^ unsign_arg0_43621;\n                    \n                    defunc_0_get_bit_res_43625 = defunc_0_get_bit_res_t_res_43826;\n                } else {\n                    defunc_0_get_bit_res_43625 = unsign_arg0_43621;\n                }\n                zp_rhs_43627 = shl32(defunc_0_get_bit_res_43625, i_43617);\n                loopres_43628 = add32(acc_43618, zp_rhs_43627);\n                acc_tmp_48993 = loopres_43628;\n                acc_43618 = acc_tmp_48993;\n            }\n            zlzb_rhs_43616 = acc_43618;\n            i32_res_43629 = sext_i32_i64(zlzb_rhs_43616);\n            block_idx_43630 = sdiv64(write_i_45873, i16_res_43225);\n            x_43631 = sle64((int64_t) 0, block_idx_43630);\n            y_43632 = slt64(block_idx_43630, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);\n            bounds_check_43633 = x_43631 && y_43632;\n            if (!bounds_check_43633) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 12) == -1) {\n                        global_failure_args[0] = (int64_t) block_idx_43630;", "\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_43635 = sle64((int64_t) 0, i32_res_43629);\n            y_43636 = slt64(i32_res_43629, (int64_t) 4);\n            bounds_check_43637 = x_43635 && y_43636;\n            if (!bounds_check_43637) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 13) == -1) {\n                        global_failure_args[0] = (int64_t) i32_res_43629;\n                        global_failure_args[1] = (int64_t) (int64_t) 4;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46932;\n                float index_concat_46933;\n                \n                index_concat_i_46932 = sub64(write_i_45873, arg_43231);\n                index_concat_46933 = ((__global float *) mem_47878)[index_concat_i_46932];\n                index_concat_branch_46935 = index_concat_46933;\n            } else {\n                int64_t new_index_46972;\n                int64_t binop_y_46974;\n                int64_t new_index_46975;\n                float index_concat_46934;\n                \n                new_index_46972 = squot64(write_i_45873, i16_res_43225);\n                binop_y_46974 = i16_res_43225 * new_index_46972;\n                new_index_46975 = write_i_45873 - binop_y_46974;\n                index_concat_46934 = ((__global float *) ext_mem_47983)[new_index_46972 * i16_res_43225 + new_index_46975];\n                index_concat_branch_46935 = index_concat_46934;\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46926;\n                int64_t index_concat_46927;\n                \n               ", " index_concat_i_46926 = sub64(write_i_45873, arg_43231);\n                index_concat_46927 = ((__global int64_t *) mem_47876)[index_concat_i_46926];\n                index_concat_branch_46929 = index_concat_46927;\n            } else {\n                int64_t new_index_46968;\n                int64_t binop_y_46970;\n                int64_t new_index_46971;\n                int64_t index_concat_46928;\n                \n                new_index_46968 = squot64(write_i_45873, i16_res_43225);\n                binop_y_46970 = i16_res_43225 * new_index_46968;\n                new_index_46971 = write_i_45873 - binop_y_46970;\n                index_concat_46928 = ((__global int64_t *) ext_mem_47982)[new_index_46968 * i16_res_43225 + new_index_46971];\n                index_concat_branch_46929 = index_concat_46928;\n            }\n            binop_x_43639 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 * i32_res_43629;\n            new_index_43640 = block_idx_43630 + binop_x_43639;\n            new_offset_43641 = ((__global int64_t *) mem_47995)[new_index_43640];\n            index_concat_cmp_43642 = sle64(n_blocks_43229, block_idx_43630);\n            if (index_concat_cmp_43642) {\n                int16_t index_concat_43827 = ((__global int16_t *) mem_47987)[i32_res_43629];\n                \n                index_concat_branch_43643 = index_concat_43827;\n            } else {\n                int16_t index_concat_43645 = ((__global int16_t *) ext_mem_47980)[block_idx_43630 * ext_47979 + i32_res_43629 * ext_47978];\n                \n                index_concat_branch_43643 = index_concat_43645;\n            }\n            i16_res_43646 = sext_i16_i64(index_concat_branch_43643);\n            zp_lhs_43647 = mul64(i16_res_43225, block_idx_43630);\n            old_offset_43648 = add64(i16_res_43646, zp_lhs_43647);\n            zp_lhs_43649 = sub64(write_i_45873, old_offset_43648);\n            idx_43650 = add64(new_offset_43641, zp_lhs_43649);\n            if (sle64((int64_t) 0, idx_43650) && slt64(idx_43650, dz",
                                    "lz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n                ((__global float *) mem_47846)[idx_43650] = index_concat_branch_46935;\n            }\n            if (sle64((int64_t) 0, idx_43650) && slt64(idx_43650, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232)) {\n                ((__global int64_t *) mem_47848)[idx_43650] = index_concat_branch_46929;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45877\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegmap_45902_dim1, 1, 1)\nvoid sortColumn_floatzisegmap_45902(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_32852, int64_t incr_32853, __global unsigned char *xs_mem_47844, __global unsigned char *mem_47848, __global unsigned char *mem_48005, __global unsigned char *mem_48007)\n{\n    #define segmap_tblock_sizze_45897 (sortColumn_floatzisegmap_45902zisegmap_tblock_sizze_45897)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48996;\n    int32_t tblock_sizze_48999;\n    int32_t wave_sizze_48998;\n    int32_t block_id_48997;\n    int32_t global_tid_48995;\n    int64_t phys_tid_45902;\n    int64_t global_tid_49000;\n    int64_t slice_49001;\n    int64_t gtid_45901;\n    int64_t remnant_49002;\n    \n    local_tid_48996 = get_local_id(0);\n    tblock_sizze_48999 = get_local_size(0);\n    wave_sizze_48998 = LOCKSTEP_WIDTH;\n    block_id_48997 = get_tblock_id(0);\n    global_tid_48995 = block_id_48997 * tblock_sizze_48999 + local_tid_48996;\n    phys_tid_45902 = sext_i32_i64(global_tid_48995);\n    global_tid_49000 = sext_i32_i64(block_id_48997) * segmap_tblock_sizze_45897 + sext_i32_i64(local_tid_48996);\n    slice_49001 = n_32852;\n    gtid_45901 = global_tid_49000;\n    remnant_49002 = global_ti", "d_49000 - gtid_45901;\n    if (slt64(gtid_45901, n_32852)) {\n        int64_t eta_p_45903;\n        bool x_45904;\n        bool y_45905;\n        bool bounds_check_45906;\n        bool index_certs_45907;\n        int64_t index_primexp_45908;\n        float lifted_lambda_res_45909;\n        \n        eta_p_45903 = ((__global int64_t *) mem_47848)[gtid_45901];\n        x_45904 = sle64((int64_t) 0, eta_p_45903);\n        y_45905 = slt64(eta_p_45903, n_32852);\n        bounds_check_45906 = x_45904 && y_45905;\n        if (!bounds_check_45906) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_45903;\n                    global_failure_args[1] = (int64_t) n_32852;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_45908 = add64(incr_32853, eta_p_45903);\n        lifted_lambda_res_45909 = ((__global float *) xs_mem_47844)[eta_p_45903];\n        ((__global int64_t *) mem_48005)[gtid_45901] = index_primexp_45908;\n        ((__global float *) mem_48007)[gtid_45901] = lifted_lambda_res_45909;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45897\n}\nFUTHARK_KERNEL\nvoid sortColumn_floatzisegmap_intrablock_45457(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, unsigned char zzero_43226_bits, int64_t n_blocks_43229, int64_t tmp_43268, int32_t blocked_radix_sort_step_arg1_43293, int32_t get_bit_arg0_43298, unsigned char cond_f_res_43299_bits, unsigned char cond_f_res_43300_bits, int64_t computed_tblock_sizze_45430, int64_t bytes_47949, int64_t bytes_47951, int64_t bytes_47953, int64_t maxSubHelper_48094, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47968, __global unsigned char *mem_47971, __global unsigned char *mem_47974, __global unsigned char *mem_47977)\n{\n    bool zzero_43226 = zzero_43226_bits;\n ", "   bool cond_f_res_43299 = cond_f_res_43299_bits;\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    volatile __local unsigned char *color_48102_backing_7 = &shared_mem[0];\n    const int64_t color_48102_backing_7_offset = 0 + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48101_backing_6 = &shared_mem[color_48102_backing_7_offset];\n    const int64_t color_48101_backing_6_offset = color_48102_backing_7_offset + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48100_backing_5 = &shared_mem[color_48101_backing_6_offset];\n    const int64_t color_48100_backing_5_offset = color_48101_backing_6_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48099_backing_4 = &shared_mem[color_48100_backing_5_offset];\n    const int64_t color_48099_backing_4_offset = color_48100_backing_5_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_3 = &shared_mem[color_48099_backing_4_offset];\n    const int64_t color_48098_backing_3_offset = color_48099_backing_4_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48097_backing_2 = &shared_mem[color_48098_backing_3_offset];\n    const int64_t color_48097_backing_2_offset = color_48098_backing_3_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48096_backing_1 = &shared_mem[color_48097_backing_2_offset];\n    const int64_t color_48096_backing_1_offset = color_48097_backing_2_offset + (int64_t) 32;\n    volatile __local unsigned char *color_48095_backing_0 = &shared_mem[color_48096_backing_1_offset];\n    const int64_t color_48095_backing_0_offse",
                                    "t = color_48096_backing_1_offset + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48469;\n    int32_t tblock_sizze_48472;\n    int32_t wave_sizze_48471;\n    int32_t block_id_48470;\n    int32_t global_tid_48468;\n    int64_t phys_tblock_id_45457;\n    int64_t slice_48474;\n    int64_t ltid_pre_48473;\n    int64_t remnant_48475;\n    int64_t slice_48477;\n    int64_t ltid_pre_48476;\n    int64_t remnant_48478;\n    int64_t slice_48479;\n    int64_t gtid_45456;\n    int64_t remnant_48480;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    __local unsigned char *color_48100;\n    __local unsigned char *color_48101;\n    __local unsigned char *color_48102;\n    int32_t num_chunks_48481;\n    int32_t num_chunks_48484;\n    int64_t binop_x_46980;\n    int64_t phys_tid_45472;\n    int64_t gtid_45471;\n    int64_t dims_flat_48487;\n    int16_t eta_p_45473;\n    int16_t eta_p_45474;\n    int16_t eta_p_45475;\n    int16_t eta_p_45476;\n    int16_t eta_p_45477;\n    int16_t eta_p_45478;\n    int16_t eta_p_45479;\n    int16_t eta_p_45480;\n    int16_t eta_p_48492;\n    int16_t eta_p_48493;\n    int16_t eta_p_48494;\n    int16_t eta_p_48495;\n    int16_t eta_p_48496;\n    int16_t eta_p_48497;\n    int16_t eta_p_48498;\n    int16_t eta_p_48499;\n    bool ltid_in_bounds_48504;\n    int32_t skip_threads_48505;\n    bool no_carry_in_48511;\n    int16_t defunc_0_f_res_45510;\n    int16_t defunc_0_f_res_45511;\n    int16_t defunc_0_f_res_45512;\n    int16_t defunc_0_f_res_45513;\n    int64_t phys_tid_45521;\n    int64_t write_i_45520;\n    int64_t phys_tid_45533;\n    int64_t gtid_45532;\n    int16_t tmp_45536;\n    int16_t tmp_45537;\n    int32_t num_chunks_48513;\n    int32_t num_chunks_48516;", "\n    int32_t num_chunks_48519;\n    int32_t num_chunks_48522;\n    \n    local_tid_48469 = get_local_id(0);\n    tblock_sizze_48472 = get_local_size(0);\n    wave_sizze_48471 = LOCKSTEP_WIDTH;\n    block_id_48470 = get_tblock_id(0);\n    global_tid_48468 = block_id_48470 * tblock_sizze_48472 + local_tid_48469;\n    phys_tblock_id_45457 = sext_i32_i64(block_id_48470);\n    slice_48474 = (int64_t) 4;\n    ltid_pre_48473 = sext_i32_i64(local_tid_48469);\n    remnant_48475 = sext_i32_i64(local_tid_48469) - ltid_pre_48473;\n    slice_48477 = i16_res_43225;\n    ltid_pre_48476 = sext_i32_i64(local_tid_48469);\n    remnant_48478 = sext_i32_i64(local_tid_48469) - ltid_pre_48476;\n    slice_48479 = n_blocks_43229;\n    gtid_45456 = sext_i32_i64(block_id_48470);\n    remnant_48480 = sext_i32_i64(block_id_48470) - gtid_45456;\n    color_48095 = (__local unsigned char *) color_48095_backing_0;\n    color_48096 = (__local unsigned char *) color_48096_backing_1;\n    color_48097 = (__local unsigned char *) color_48097_backing_2;\n    color_48098 = (__local unsigned char *) color_48098_backing_3;\n    color_48099 = (__local unsigned char *) color_48099_backing_4;\n    color_48100 = (__local unsigned char *) color_48100_backing_5;\n    color_48101 = (__local unsigned char *) color_48101_backing_6;\n    color_48102 = (__local unsigned char *) color_48102_backing_7;\n    num_chunks_48481 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48482 = 0; chunk_i_48482 < num_chunks_48481; chunk_i_48482++) {\n        int32_t i_48483 = chunk_i_48482 * sext_i64_i32(computed_tblock_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48483, sext_i64_i32(i16_res_43225))) {\n            ((__local float *) color_48102)[sext_i32_i64(i_48483)] = ((__global float *) mem_47846)[(int64_t) 0 + gtid_45456 * ((int64_t) 1 * i16_res_43225) + sext_i32_i64(i_48483)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48484 = sdiv_up32(sext_i64_i32(i16_res_4", "3225), sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48485 = 0; chunk_i_48485 < num_chunks_48484; chunk_i_48485++) {\n        int32_t i_48486 = chunk_i_48485 * sext_i64_i32(computed_tblock_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48486, sext_i64_i32(i16_res_43225))) {\n            ((__local int64_t *) color_48101)[sext_i32_i64(i_48486)] = ((__global int64_t *) mem_47848)[(int64_t) 0 + gtid_45456 * ((int64_t) 1 * i16_res_43225) + sext_i32_i64(i_48486)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    binop_x_46980 = i16_res_43225 * gtid_45456;\n    phys_tid_45472 = sext_i32_i64(local_tid_48469);\n    gtid_45471 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(gtid_45471, i16_res_43225)) {\n        int64_t new_index_46981;\n        float eta_p_45485;\n        int32_t i32_arg0_45486;\n        int32_t unsign_arg0_45487;\n        int32_t unsign_arg0_45488;\n        int32_t unsign_arg0_45489;\n        int32_t unsign_arg0_45490;\n        bool cond_45491;\n        bool x_45492;\n        bool y_45493;\n        bool cond_45494;\n        int32_t defunc_0_get_bit_res_45495;\n        int32_t zp_lhs_45497;\n        int32_t unsign_arg0_45498;\n        int32_t unsign_arg0_45499;\n        bool y_45500;\n        bool cond_45501;\n        int32_t defunc_0_get_bit_res_45502;\n        int32_t i32_arg0_45504;\n        int16_t i32_res_45505;\n        int16_t defunc_0_f_res_45506;\n        int16_t defunc_0_f_res_45507;\n        int16_t defunc_0_f_res_45508;\n        int16_t defunc_0_f_res_45509;\n        \n        new_index_46981 = gtid_45471 + binop_x_46980;\n        eta_p_45485 = ((__global float *) mem_47846)[new_index_46981];\n        i32_arg0_45486 = futrts_to_bits32(eta_p_45485);\n        unsign_arg0_45487 = ashr32(i32_arg0_45486, get_bit_arg0_43298);\n        unsign_arg0_45488 = 1 & unsign_arg0_45487;\n        unsign_arg0_45489 = ashr32(i32_arg0_45486, 31);\n        unsign_arg0_45490 = 1 & unsign_arg0_45489;\n        cond_45491 = unsign_arg0_45490 == 1;\n      ",
                                    "  x_45492 = !cond_45491;\n        y_45493 = cond_f_res_43299 && x_45492;\n        cond_45494 = cond_45491 || y_45493;\n        if (cond_45494) {\n            int32_t defunc_0_get_bit_res_t_res_45496 = 1 ^ unsign_arg0_45488;\n            \n            defunc_0_get_bit_res_45495 = defunc_0_get_bit_res_t_res_45496;\n        } else {\n            defunc_0_get_bit_res_45495 = unsign_arg0_45488;\n        }\n        zp_lhs_45497 = mul32(2, defunc_0_get_bit_res_45495);\n        unsign_arg0_45498 = ashr32(i32_arg0_45486, blocked_radix_sort_step_arg1_43293);\n        unsign_arg0_45499 = 1 & unsign_arg0_45498;\n        y_45500 = cond_f_res_43300 && x_45492;\n        cond_45501 = cond_45491 || y_45500;\n        if (cond_45501) {\n            int32_t defunc_0_get_bit_res_t_res_45503 = 1 ^ unsign_arg0_45499;\n            \n            defunc_0_get_bit_res_45502 = defunc_0_get_bit_res_t_res_45503;\n        } else {\n            defunc_0_get_bit_res_45502 = unsign_arg0_45499;\n        }\n        i32_arg0_45504 = add32(zp_lhs_45497, defunc_0_get_bit_res_45502);\n        i32_res_45505 = sext_i32_i16(i32_arg0_45504);\n        futrts_lifted_lambda_7535(&defunc_0_f_res_45506, &defunc_0_f_res_45507, &defunc_0_f_res_45508, &defunc_0_f_res_45509, i32_res_45505);\n        ((__local int16_t *) color_48100)[gtid_45471] = defunc_0_f_res_45506;\n        ((__local int16_t *) color_48099)[gtid_45471] = defunc_0_f_res_45507;\n        ((__local int16_t *) color_48098)[gtid_45471] = defunc_0_f_res_45508;\n        ((__local int16_t *) color_48097)[gtid_45471] = defunc_0_f_res_45509;\n        ((__local int16_t *) color_48095)[gtid_45471] = i32_res_45505;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dims_flat_48487 = i16_res_43225;\n    ltid_in_bounds_48504 = slt64(sext_i32_i64(local_tid_48469), i16_res_43225);\n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_48504) {\n            eta_p_45477 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n            eta_p_45478 = ((volatile __local i", "nt16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n            eta_p_45479 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n            eta_p_45480 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n            if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                eta_p_45473 = eta_p_45477;\n                eta_p_45474 = eta_p_45478;\n                eta_p_45475 = eta_p_45479;\n                eta_p_45476 = eta_p_45480;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_48505 = 1;\n        while (slt32(skip_threads_48505, 32)) {\n            bool thread_active_48506 = sle32(skip_threads_48505, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && ltid_in_bounds_48504;\n            \n            if (thread_active_48506) {\n                // read operands\n                {\n                    eta_p_45473 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45474 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45475 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_45476 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                }\n            }\n            // perform operation\n            {\n                bool inactive_48507 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_43225), sext_i32_i64(local_tid_48469) - sext_i32_i64(local_tid_48469 - skip_threads_48505));\n                \n                if (thread_active_48506 && inactive_48507) {\n                    eta_p_45473 = eta_p_45477;\n                    eta_p_45474 = eta_p_45478;\n                    eta_p_45475 = eta_p_45479;\n                    et", "a_p_45476 = eta_p_45480;\n                }\n                if (thread_active_48506) {\n                    if (!inactive_48507) {\n                        int16_t defunc_0_op_res_45481 = add16(eta_p_45473, eta_p_45477);\n                        int16_t defunc_0_op_res_45482 = add16(eta_p_45474, eta_p_45478);\n                        int16_t defunc_0_op_res_45483 = add16(eta_p_45475, eta_p_45479);\n                        int16_t defunc_0_op_res_45484 = add16(eta_p_45476, eta_p_45480);\n                        \n                        eta_p_45473 = defunc_0_op_res_45481;\n                        eta_p_45474 = defunc_0_op_res_45482;\n                        eta_p_45475 = defunc_0_op_res_45483;\n                        eta_p_45476 = defunc_0_op_res_45484;\n                    }\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (thread_active_48506) {\n                // write result\n                {\n                    ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_45473;\n                    eta_p_45477 = eta_p_45473;\n                    ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45474;\n                    eta_p_45478 = eta_p_45474;\n                    ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45475;\n                    eta_p_45479 = eta_p_45475;\n                    ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45476;\n                    eta_p_45480 = eta_p_45476;\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_48505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_48469 - squot32(local",
                                    "_tid_48469, 32) * 32) == 31 && ltid_in_bounds_48504) {\n            ((volatile __local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45473;\n            ((volatile __local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45474;\n            ((volatile __local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45475;\n            ((volatile __local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_45476;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_48508;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n                eta_p_48496 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n                eta_p_48497 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n                eta_p_48498 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n                eta_p_48499 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n                if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                    eta_p_48492 = eta_p_48496;\n                    eta_p_48493 = eta_p_48497;\n                    eta_p_48494 = eta_p_48498;\n                    eta_p_48495 = eta_p_48499;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_48508 = 1;\n            while (slt32(skip_threads_48508, 32)) {\n                bool thread_active_48509 = sle32(skip_threads_48508, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504);\n                \n                if (thread_active_48509) {\n                    // read operands\n      ", "              {\n                        eta_p_48492 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48493 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48494 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48495 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48510 = slt64(srem64(sext_i32_i64(local_tid_48469 * 32 + 32 - 1), i16_res_43225), sext_i32_i64(local_tid_48469 * 32 + 32 - 1) - sext_i32_i64((local_tid_48469 - skip_threads_48508) * 32 + 32 - 1));\n                    \n                    if (thread_active_48509 && inactive_48510) {\n                        eta_p_48492 = eta_p_48496;\n                        eta_p_48493 = eta_p_48497;\n                        eta_p_48494 = eta_p_48498;\n                        eta_p_48495 = eta_p_48499;\n                    }\n                    if (thread_active_48509) {\n                        if (!inactive_48510) {\n                            int16_t defunc_0_op_res_48500 = add16(eta_p_48492, eta_p_48496);\n                            int16_t defunc_0_op_res_48501 = add16(eta_p_48493, eta_p_48497);\n                            int16_t defunc_0_op_res_48502 = add16(eta_p_48494, eta_p_48498);\n                            int16_t defunc_0_op_res_48503 = add16(eta_p_48495, eta_p_48499);\n                            \n                            eta_p_48492 = defunc_0_op_res_48500;\n                            eta_p_48493 = defunc_0_op_res_48501;\n                            eta_p_48494 = defunc_0_op_res_48502;\n                            eta_p_48495 = defunc_0_op_res_48503;", "\n                        }\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (thread_active_48509) {\n                    // write result\n                    {\n                        ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_48492;\n                        eta_p_48496 = eta_p_48492;\n                        ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_48493;\n                        eta_p_48497 = eta_p_48493;\n                        ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_48494;\n                        eta_p_48498 = eta_p_48494;\n                        ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_48495;\n                        eta_p_48499 = eta_p_48495;\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_48508 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    no_carry_in_48511 = squot32(local_tid_48469, 32) == 0 || !ltid_in_bounds_48504;\n    // carry-in for every block except the first\n    {\n        // read operands\n        {\n            if (!no_carry_in_48511) {\n                eta_p_45477 = eta_p_45473;\n                eta_p_45478 = eta_p_45474;\n                eta_p_45479 = eta_p_45475;\n                eta_p_45480 = eta_p_45476;\n                eta_p_45473 = ((__local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_45474 = ((__local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_45475 = ((__local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n        ",
                                    "        eta_p_45476 = ((__local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n            }\n        }\n        // perform operation\n        {\n            bool inactive_48512 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_43225), sext_i32_i64(local_tid_48469) - sext_i32_i64(squot32(local_tid_48469, 32) * 32 - 1));\n            \n            if (!no_carry_in_48511) {\n                if (inactive_48512) {\n                    eta_p_45473 = eta_p_45477;\n                    eta_p_45474 = eta_p_45478;\n                    eta_p_45475 = eta_p_45479;\n                    eta_p_45476 = eta_p_45480;\n                }\n            }\n            if (!no_carry_in_48511) {\n                if (!inactive_48512) {\n                    int16_t defunc_0_op_res_45481 = add16(eta_p_45473, eta_p_45477);\n                    int16_t defunc_0_op_res_45482 = add16(eta_p_45474, eta_p_45478);\n                    int16_t defunc_0_op_res_45483 = add16(eta_p_45475, eta_p_45479);\n                    int16_t defunc_0_op_res_45484 = add16(eta_p_45476, eta_p_45480);\n                    \n                    eta_p_45473 = defunc_0_op_res_45481;\n                    eta_p_45474 = defunc_0_op_res_45482;\n                    eta_p_45475 = defunc_0_op_res_45483;\n                    eta_p_45476 = defunc_0_op_res_45484;\n                }\n            }\n        }\n        // write final result\n        {\n            if (!no_carry_in_48511) {\n                ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_45473;\n                ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45474;\n                ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45475;\n                ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45476;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_48469, 32) == 0 &", "& ltid_in_bounds_48504) {\n            ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_45477;\n            ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_45478;\n            ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_45479;\n            ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_45480;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (zzero_43226) {\n        defunc_0_f_res_45510 = (int16_t) 0;\n        defunc_0_f_res_45511 = (int16_t) 0;\n        defunc_0_f_res_45512 = (int16_t) 0;\n        defunc_0_f_res_45513 = (int16_t) 0;\n    } else {\n        int16_t last_res_45514;\n        int16_t last_res_45515;\n        int16_t last_res_45516;\n        int16_t last_res_45517;\n        \n        last_res_45514 = ((__local int16_t *) color_48100)[tmp_43268];\n        last_res_45515 = ((__local int16_t *) color_48099)[tmp_43268];\n        last_res_45516 = ((__local int16_t *) color_48098)[tmp_43268];\n        last_res_45517 = ((__local int16_t *) color_48097)[tmp_43268];\n        defunc_0_f_res_45510 = last_res_45514;\n        defunc_0_f_res_45511 = last_res_45515;\n        defunc_0_f_res_45512 = last_res_45516;\n        defunc_0_f_res_45513 = last_res_45517;\n    }\n    phys_tid_45521 = sext_i32_i64(local_tid_48469);\n    write_i_45520 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(write_i_45520, i16_res_43225)) {\n        int16_t eta_p_45522;\n        int16_t eta_p_45523;\n        int16_t eta_p_45524;\n        int16_t eta_p_45525;\n        int16_t eta_p_45526;\n        int64_t new_index_46977;\n        float write_value_45527;\n        int64_t write_value_45528;\n        int64_t defunc_0_f_res_45529;\n        \n        eta_p_45522 = ((__local int16_t *) color_48095)[write_i_45520];\n        eta_p_45523 = ((__local int16_t *) color_48100)[write_i_45520];\n        eta_p_45524 = ((__local int16_t *) color_48099)[write_i_45520];\n        eta_p_45525 = (", "(__local int16_t *) color_48098)[write_i_45520];\n        eta_p_45526 = ((__local int16_t *) color_48097)[write_i_45520];\n        new_index_46977 = write_i_45520 + binop_x_46980;\n        write_value_45527 = ((__global float *) mem_47846)[new_index_46977];\n        write_value_45528 = ((__global int64_t *) mem_47848)[new_index_46977];\n        futrts_lifted_f_7536(&defunc_0_f_res_45529, defunc_0_f_res_45510, defunc_0_f_res_45511, defunc_0_f_res_45512, eta_p_45522, eta_p_45523, eta_p_45524, eta_p_45525, eta_p_45526);\n        if (sle64((int64_t) 0, defunc_0_f_res_45529) && slt64(defunc_0_f_res_45529, i16_res_43225)) {\n            ((__local float *) color_48102)[defunc_0_f_res_45529] = write_value_45527;\n        }\n        if (sle64((int64_t) 0, defunc_0_f_res_45529) && slt64(defunc_0_f_res_45529, i16_res_43225)) {\n            ((__local int64_t *) color_48101)[defunc_0_f_res_45529] = write_value_45528;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = defunc_0_f_res_45510;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_45511;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = defunc_0_f_res_45512;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = defunc_0_f_res_45513;\n    phys_tid_45533 = sext_i32_i64(local_tid_48469);\n    gtid_45532 = sext_i32_i64(sext_i64_i32(ltid_pre_48473));\n    if (slt64(gtid_45532, (int64_t) 4)) {\n        int16_t eta_p_45534;\n        int64_t i16_res_45535;\n        \n        eta_p_45534 = ((__local int16_t *) color_48095)[gtid_45532];\n        i16_res_45535 = sext_i16_i64(eta_p_45534);\n        ((__local int64_t *) color_48096)[gtid_45532] = i16_res_45535;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    tmp_45536 = add16(defunc_0_f_res_45510, defunc_0_f_res_45511);\n    tmp_45537 = add16(defunc_0_f_res_45512, tmp_45536);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = (int16_t) 0;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_45510;\n    ((__local int16_t *",
                                    ") color_48095)[(int64_t) 2] = tmp_45536;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = tmp_45537;\n    num_chunks_48513 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48514 = 0; chunk_i_48514 < num_chunks_48513; chunk_i_48514++) {\n        int32_t i_48515 = chunk_i_48514 * sext_i64_i32(computed_tblock_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48515, sext_i64_i32(i16_res_43225))) {\n            ((__global float *) mem_47968)[gtid_45456 * i16_res_43225 + sext_i32_i64(i_48515)] = ((__local float *) color_48102)[sext_i32_i64(i_48515)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48516 = sdiv_up32(sext_i64_i32(i16_res_43225), sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48517 = 0; chunk_i_48517 < num_chunks_48516; chunk_i_48517++) {\n        int32_t i_48518 = chunk_i_48517 * sext_i64_i32(computed_tblock_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48518, sext_i64_i32(i16_res_43225))) {\n            ((__global int64_t *) mem_47971)[gtid_45456 * i16_res_43225 + sext_i32_i64(i_48518)] = ((__local int64_t *) color_48101)[sext_i32_i64(i_48518)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48519 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48520 = 0; chunk_i_48520 < num_chunks_48519; chunk_i_48520++) {\n        int32_t i_48521 = chunk_i_48520 * sext_i64_i32(computed_tblock_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48521, 4)) {\n            ((__global int64_t *) mem_47974)[gtid_45456 * (int64_t) 4 + sext_i32_i64(i_48521)] = ((__local int64_t *) color_48096)[sext_i32_i64(i_48521)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48522 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_45430));\n    for (int32_t chunk_i_48523 = 0; chunk_i_48523 < num_chunks_48522; chunk_i_48523++) {\n        int32_t i_48524 = chunk_i_48523 * sext_i64_i32(computed_t", "block_sizze_45430) + local_tid_48469;\n        \n        if (slt32(i_48524, 4)) {\n            ((__global int16_t *) mem_47977)[gtid_45456 * (int64_t) 4 + sext_i32_i64(i_48524)] = ((__local int16_t *) color_48095)[sext_i32_i64(i_48524)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegscan_45401_dim1, 1, 1)\nvoid sortColumn_floatzisegscan_45401(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_43230, int64_t arg_43231, int32_t blocked_radix_sort_step_arg1_43293, int32_t get_bit_arg0_43298, unsigned char cond_f_res_43299_bits, unsigned char cond_f_res_43300_bits, int64_t num_tblocks_45398, int64_t num_virt_blocks_48139, int64_t num_virt_threads_48140, __global unsigned char *mem_47846, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *status_flags_mem_48141, __global unsigned char *aggregates_mem_48163, __global unsigned char *incprefixes_mem_48165, __global unsigned char *aggregates_mem_48167, __global unsigned char *incprefixes_mem_48169, __global unsigned char *aggregates_mem_48171, __global unsigned char *incprefixes_mem_48173, __global unsigned char *aggregates_mem_48175, __global unsigned char *incprefixes_mem_48177, __global unsigned char *global_dynid_mem_48179)\n{\n    bool cond_f_res_43299 = cond_f_res_43299_bits;\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    \n    #define segscan_tblock_sizze_45396 (sortColumn_floatzisegscan_45401zisegscan_tblock_sizze_45396)\n    #define chunk_sizze_48138 (sortColumn_floatzisegscan_45401zichunk_sizze_48138)\n    \n    volatile __local unsigned char *local_mem_48215_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48215_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45396", ", (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48202;\n    int32_t tblock_sizze_48205;\n    int32_t wave_sizze_48204;\n    int32_t block_id_48203;\n    int32_t global_tid_48201;\n    int64_t phys_tid_45401;\n    int32_t chunk_sizze_32b_48206;\n    int64_t byte_offsets_48207;\n    int64_t byte_offsets_48208;\n    int64_t byte_offsets_48209;\n    int64_t byte_offsets_48210;\n    int64_t warp_byte_offset_48211;\n    int64_t warp_byte_offset_48212;\n    int64_t warp_byte_offset_48213;\n    int64_t warp_byte_offset_48214;\n    __local unsigned char *local_mem_48215;\n    int64_t trans_arr_len_48216;\n    int64_t phys_block_id_48231;\n    int64_t virtloop_bound_48232;\n    \n    local_tid_48202 = get_local_id(0);\n    tblock_sizze_48205 = get_local_size(0);\n    wave_sizze_48204 = LOCKST",
                                    "EP_WIDTH;\n    block_id_48203 = get_tblock_id(0);\n    global_tid_48201 = block_id_48203 * tblock_sizze_48205 + local_tid_48202;\n    phys_tid_45401 = sext_i32_i64(global_tid_48201);\n    chunk_sizze_32b_48206 = sext_i64_i32(chunk_sizze_48138);\n    byte_offsets_48207 = segscan_tblock_sizze_45396 * (int64_t) 2;\n    byte_offsets_48208 = sdiv_up64(byte_offsets_48207, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45396 * (int64_t) 2;\n    byte_offsets_48209 = sdiv_up64(byte_offsets_48208, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45396 * (int64_t) 2;\n    byte_offsets_48210 = sdiv_up64(byte_offsets_48209, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45396 * (int64_t) 2;\n    warp_byte_offset_48211 = (int64_t) 96;\n    warp_byte_offset_48212 = sdiv_up64(warp_byte_offset_48211, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48213 = sdiv_up64(warp_byte_offset_48212, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48214 = sdiv_up64(warp_byte_offset_48213, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48215 = (__local unsigned char *) local_mem_48215_backing_0;\n    trans_arr_len_48216 = chunk_sizze_48138 * segscan_tblock_sizze_45396;\n    phys_block_id_48231 = get_tblock_id(0);\n    virtloop_bound_48232 = sdiv_up64(num_virt_blocks_48139 - phys_block_id_48231, num_tblocks_45398);\n    for (int64_t virtloop_i_48233 = 0; virtloop_i_48233 < virtloop_bound_48232; virtloop_i_48233++) {\n        int64_t dynamic_id_48234;\n        int64_t block_offset_48235;\n        int64_t sgm_idx_48236;\n        int32_t boundary_48237;\n        int32_t segsizze_compact_48238;\n        int16_t private_mem_48239[chunk_sizze_48138];\n        int16_t private_mem_48241[chunk_sizze_48138];\n        int16_t private_mem_48243[chunk_sizze_48138];\n        int16_t private_mem_48245[chunk_sizze_48138];\n        int64_t thd_offset_48247;\n        int16_t acc_48293;\n        int16_t acc_48294;\n        int16_t acc_48295;\n     ", "   int16_t acc_48296;\n        int16_t prefix_48315;\n        int16_t prefix_48316;\n        int16_t prefix_48317;\n        int16_t prefix_48318;\n        bool block_new_sgm_48319;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48202 == 0) {\n                dynamic_id_48234 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48179)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48215)[(int64_t) 0] = dynamic_id_48234;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48234 == num_virt_blocks_48139 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48179)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48234 = ((__local int32_t *) local_mem_48215)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48235 = dynamic_id_48234 * chunk_sizze_48138 * segscan_tblock_sizze_45396;\n        sgm_idx_48236 = smod64(block_offset_48235, rest_43230);\n        boundary_48237 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_45396, rest_43230 - sgm_idx_48236));\n        segsizze_compact_48238 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_45396, rest_43230));\n        thd_offset_48247 = block_offset_48235 + sext_i32_i64(local_tid_48202);\n        // Load and map\n        {\n            for (int64_t i_48248 = 0; i_48248 < chunk_sizze_48138; i_48248++) {\n                int64_t virt_tid_48249 = thd_offset_48247 + i_48248 * segscan_tblock_sizze_45396;\n                int64_t slice_48250 = rest_43230;\n                int64_t gtid_45400 = virt_tid_48249;\n                int64_t remnant_48251 = virt_tid_48249 - gtid_45400;\n                \n                if (slt6", "4(virt_tid_48249, rest_43230)) {\n                    int64_t slice_46966 = arg_43231 + gtid_45400;\n                    float eta_p_43676 = ((__global float *) mem_47846)[slice_46966];\n                    int32_t i32_arg0_43677 = futrts_to_bits32(eta_p_43676);\n                    int32_t unsign_arg0_43678 = ashr32(i32_arg0_43677, get_bit_arg0_43298);\n                    int32_t unsign_arg0_43679 = 1 & unsign_arg0_43678;\n                    int32_t unsign_arg0_43680 = ashr32(i32_arg0_43677, 31);\n                    int32_t unsign_arg0_43681 = 1 & unsign_arg0_43680;\n                    bool cond_43682 = unsign_arg0_43681 == 1;\n                    bool x_43683 = !cond_43682;\n                    bool y_43684 = cond_f_res_43299 && x_43683;\n                    bool cond_43685 = cond_43682 || y_43684;\n                    int32_t defunc_0_get_bit_res_43686;\n                    \n                    if (cond_43685) {\n                        int32_t defunc_0_get_bit_res_t_res_43812 = 1 ^ unsign_arg0_43679;\n                        \n                        defunc_0_get_bit_res_43686 = defunc_0_get_bit_res_t_res_43812;\n                    } else {\n                        defunc_0_get_bit_res_43686 = unsign_arg0_43679;\n                    }\n                    \n                    int32_t zp_lhs_43688 = mul32(2, defunc_0_get_bit_res_43686);\n                    int32_t unsign_arg0_43689 = ashr32(i32_arg0_43677, blocked_radix_sort_step_arg1_43293);\n                    int32_t unsign_arg0_43690 = 1 & unsign_arg0_43689;\n                    bool y_43691 = cond_f_res_43300 && x_43683;\n                    bool cond_43692 = cond_43682 || y_43691;\n                    int32_t defunc_0_get_bit_res_43693;\n                    \n                    if (cond_43692) {\n                        int32_t defunc_0_get_bit_res_t_res_43813 = 1 ^ unsign_arg0_43690;\n                        \n                        defunc_0_get_bit_res_43693 = defunc_0_get_bit_res_t_res_43813;\n                    } else {\n   ",
                                    "                     defunc_0_get_bit_res_43693 = unsign_arg0_43690;\n                    }\n                    \n                    int32_t i32_arg0_43695 = add32(zp_lhs_43688, defunc_0_get_bit_res_43693);\n                    int16_t i32_res_43696 = sext_i32_i16(i32_arg0_43695);\n                    int16_t defunc_0_f_res_43698;\n                    int16_t defunc_0_f_res_43699;\n                    int16_t defunc_0_f_res_43700;\n                    int16_t defunc_0_f_res_43701;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_43698, &defunc_0_f_res_43699, &defunc_0_f_res_43700, &defunc_0_f_res_43701, i32_res_43696);\n                    ((__global int16_t *) mem_47865)[gtid_45400] = i32_res_43696;\n                    private_mem_48239[i_48248] = defunc_0_f_res_43698;\n                    private_mem_48241[i_48248] = defunc_0_f_res_43699;\n                    private_mem_48243[i_48248] = defunc_0_f_res_43700;\n                    private_mem_48245[i_48248] = defunc_0_f_res_43701;\n                } else {\n                    private_mem_48239[i_48248] = (int16_t) 0;\n                    private_mem_48241[i_48248] = (int16_t) 0;\n                    private_mem_48243[i_48248] = (int16_t) 0;\n                    private_mem_48245[i_48248] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48252 = 0; i_48252 < chunk_sizze_48138; i_48252++) {\n                int64_t sharedIdx_48253 = sext_i32_i64(local_tid_48202) + i_48252 * segscan_tblock_sizze_45396;\n                int16_t tmp_48254 = private_mem_48239[i_48252];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48253] = tmp_48254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48255 = 0; i_48255 < chunk_sizze_48138; i_48255++) {\n                int64_t sharedIdx_48256 = sext_i32_i64(local_tid_48202) * chunk_sizze_4813", "8 + i_48255;\n                int16_t tmp_48257 = ((__local int16_t *) local_mem_48215)[sharedIdx_48256];\n                \n                private_mem_48239[i_48255] = tmp_48257;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48258 = 0; i_48258 < chunk_sizze_48138; i_48258++) {\n                int64_t sharedIdx_48259 = sext_i32_i64(local_tid_48202) + i_48258 * segscan_tblock_sizze_45396;\n                int16_t tmp_48260 = private_mem_48241[i_48258];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48259] = tmp_48260;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48261 = 0; i_48261 < chunk_sizze_48138; i_48261++) {\n                int64_t sharedIdx_48262 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48261;\n                int16_t tmp_48263 = ((__local int16_t *) local_mem_48215)[sharedIdx_48262];\n                \n                private_mem_48241[i_48261] = tmp_48263;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48264 = 0; i_48264 < chunk_sizze_48138; i_48264++) {\n                int64_t sharedIdx_48265 = sext_i32_i64(local_tid_48202) + i_48264 * segscan_tblock_sizze_45396;\n                int16_t tmp_48266 = private_mem_48243[i_48264];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48265] = tmp_48266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48267 = 0; i_48267 < chunk_sizze_48138; i_48267++) {\n                int64_t sharedIdx_48268 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48267;\n                int16_t tmp_48269 = ((__local int16_t *) local_mem_48215)[sharedIdx_48268];\n                \n                private_mem_48243[i_48267] = tmp_48269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48270 = 0; i_48270 < chunk_sizze_48138; i_48270++) {\n                int64_t sharedIdx_48271 = sext_i32_i", "64(local_tid_48202) + i_48270 * segscan_tblock_sizze_45396;\n                int16_t tmp_48272 = private_mem_48245[i_48270];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48271] = tmp_48272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48273 = 0; i_48273 < chunk_sizze_48138; i_48273++) {\n                int64_t sharedIdx_48274 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48273;\n                int16_t tmp_48275 = ((__local int16_t *) local_mem_48215)[sharedIdx_48274];\n                \n                private_mem_48245[i_48273] = tmp_48275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48276 = 0; i_48276 < chunk_sizze_48138 - (int64_t) 1; i_48276++) {\n                int16_t eta_p_43340;\n                int16_t eta_p_43344;\n                \n                eta_p_43340 = private_mem_48239[i_48276];\n                eta_p_43344 = private_mem_48239[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_43341;\n                int16_t eta_p_43345;\n                \n                eta_p_43341 = private_mem_48241[i_48276];\n                eta_p_43345 = private_mem_48241[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_43342;\n                int16_t eta_p_43346;\n                \n                eta_p_43342 = private_mem_48243[i_48276];\n                eta_p_43346 = private_mem_48243[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_43343;\n                int16_t eta_p_43347;\n                \n                eta_p_43343 = private_mem_48245[i_48276];\n                eta_p_43347 = private_mem_48245[i_48276 + (int64_t) 1];\n                \n                int16_t defunc_0_op_res_43348 = add16(eta_p_43340, eta_p_43344);\n                int16_t defunc_0_op_res_43349 = add16(eta_p_43341, eta_p_43345);\n                int16_t defunc_0_op_res_43350 = add16(eta_p_",
                                    "43342, eta_p_43346);\n                int16_t defunc_0_op_res_43351 = add16(eta_p_43343, eta_p_43347);\n                \n                private_mem_48239[i_48276 + (int64_t) 1] = defunc_0_op_res_43348;\n                private_mem_48241[i_48276 + (int64_t) 1] = defunc_0_op_res_43349;\n                private_mem_48243[i_48276 + (int64_t) 1] = defunc_0_op_res_43350;\n                private_mem_48245[i_48276 + (int64_t) 1] = defunc_0_op_res_43351;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48277 = private_mem_48239[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = tmp_48277;\n            \n            int16_t tmp_48278 = private_mem_48241[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48278;\n            \n            int16_t tmp_48279 = private_mem_48243[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48279;\n            \n            int16_t tmp_48280 = private_mem_48245[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48280;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48281;\n            int16_t eta_p_48282;\n            int16_t eta_p_48283;\n            int16_t eta_p_48284;\n            int16_t eta_p_48285;\n            int16_t eta_p_48286;\n            int16_t eta_p_48287;\n            int16_t eta_p_48288;\n            int16_t eta_p_48297;\n            int16_t eta_p_48298;\n            int16_t eta_p_48299;\n            int16_t eta_p_48300;\n            int16_t eta_p_48301;\n           ", " int16_t eta_p_48302;\n            int16_t eta_p_48303;\n            int16_t eta_p_48304;\n            bool ltid_in_bounds_48309 = slt64(sext_i32_i64(local_tid_48202), num_virt_threads_48140);\n            int32_t skip_threads_48310;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48309) {\n                    eta_p_48285 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                    eta_p_48286 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48287 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48288 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                        eta_p_48281 = eta_p_48285;\n                        eta_p_48282 = eta_p_48286;\n                        eta_p_48283 = eta_p_48287;\n                        eta_p_48284 = eta_p_48288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48310 = 1;\n                while (slt32(skip_threads_48310, 32)) {\n                    bool thread_active_48311 = sle32(skip_threads_48310, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && ltid_in_bounds_48309;\n                    \n                    if (thread_active_48311) {\n                        // read operands\n                        {\n                            eta_p_48281 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310)];\n                            eta_p_48282 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (", "int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48283 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48284 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48311) {\n                            int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                            int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                            int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                            int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                            \n                            eta_p_48281 = defunc_0_op_res_48289;\n                            eta_p_48282 = defunc_0_op_res_48290;\n                            eta_p_48283 = defunc_0_op_res_48291;\n                            eta_p_48284 = defunc_0_op_res_48292;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48311) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                            eta_p_48285 = eta_p_48281;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                            eta_p_48286 = et",
                                    "a_p_48282;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                            eta_p_48287 = eta_p_48283;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                            eta_p_48288 = eta_p_48284;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48310 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 31 && ltid_in_bounds_48309) {\n                    ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48281;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48282;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48283;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48284;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48312;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                 ", "       eta_p_48301 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                        eta_p_48302 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48303 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48304 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                            eta_p_48297 = eta_p_48301;\n                            eta_p_48298 = eta_p_48302;\n                            eta_p_48299 = eta_p_48303;\n                            eta_p_48300 = eta_p_48304;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48312 = 1;\n                    while (slt32(skip_threads_48312, 32)) {\n                        bool thread_active_48313 = sle32(skip_threads_48312, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309);\n                        \n                        if (thread_active_48313) {\n                            // read operands\n                            {\n                                eta_p_48297 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312)];\n                                eta_p_48298 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48299 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i6", "4(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48300 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48313) {\n                                int16_t defunc_0_op_res_48305 = add16(eta_p_48297, eta_p_48301);\n                                int16_t defunc_0_op_res_48306 = add16(eta_p_48298, eta_p_48302);\n                                int16_t defunc_0_op_res_48307 = add16(eta_p_48299, eta_p_48303);\n                                int16_t defunc_0_op_res_48308 = add16(eta_p_48300, eta_p_48304);\n                                \n                                eta_p_48297 = defunc_0_op_res_48305;\n                                eta_p_48298 = defunc_0_op_res_48306;\n                                eta_p_48299 = defunc_0_op_res_48307;\n                                eta_p_48300 = defunc_0_op_res_48308;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48313) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48297;\n                                eta_p_48301 = eta_p_48297;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48298;\n                                eta_p_48302 = eta_p_48298;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (",
                                    "int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48299;\n                                eta_p_48303 = eta_p_48299;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48300;\n                                eta_p_48304 = eta_p_48300;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48312 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48314 = squot32(local_tid_48202, 32) == 0 || !ltid_in_bounds_48309;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48314) {\n                        eta_p_48285 = eta_p_48281;\n                        eta_p_48286 = eta_p_48282;\n                        eta_p_48287 = eta_p_48283;\n                        eta_p_48288 = eta_p_48284;\n                        eta_p_48281 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1];\n                        eta_p_48282 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48283 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48284 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_c", "arry_in_48314) {\n                        int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                        int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                        int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                        int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                        \n                        eta_p_48281 = defunc_0_op_res_48289;\n                        eta_p_48282 = defunc_0_op_res_48290;\n                        eta_p_48283 = defunc_0_op_res_48291;\n                        eta_p_48284 = defunc_0_op_res_48292;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48314) {\n                        ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                    ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48285;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48286;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48287;\n            ", "        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48202 == 0) {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[segscan_tblock_sizze_45396 - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (segscan_tblock_sizze_45396 - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (segscan_tblock_sizze_45396 - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (segscan_tblock_sizze_45396 - (int64_t) 1)];\n            } else {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48315 = (int16_t) 0;\n        prefix_48316 = (int16_t) 0;\n        prefix_48317 = (int16_t) 0;\n        prefix_48318 = (int16_t) 0;\n        block_new_sgm_48319 = sgm_idx_48236 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48319 && local_tid_48202 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = acc_48293;\n                ((volatile __global int16_t *) incprefixes_mem",
                                    "_48169)[dynamic_id_48234] = acc_48294;\n                ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = acc_48295;\n                ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = acc_48296;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                acc_48293 = (int16_t) 0;\n                acc_48294 = (int16_t) 0;\n                acc_48295 = (int16_t) 0;\n                acc_48296 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48319 && slt32(local_tid_48202, wave_sizze_48204)) {\n                if (local_tid_48202 == 0) {\n                    ((volatile __global int16_t *) aggregates_mem_48163)[dynamic_id_48234] = acc_48293;\n                    ((volatile __global int16_t *) aggregates_mem_48167)[dynamic_id_48234] = acc_48294;\n                    ((volatile __global int16_t *) aggregates_mem_48171)[dynamic_id_48234] = acc_48295;\n                    ((volatile __global int16_t *) aggregates_mem_48175)[dynamic_id_48234] = acc_48296;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 1;\n                    \n                    int8_t tmp_48320 = ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48215)[(int64_t) 0] = tmp_48320;\n                }\n                mem_fence_local();\n                \n                int8_t status_48321 = ((__local int8_t *) local_mem_48215)[(int64_t) 0];\n                \n                if (status_48321 == (int8_t) 2) {\n                    if (local_tid_48202 == 0) {\n                        prefix_48315 = ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48316 = ((volatile __global int16_t *) incprefixes_mem_48169)[", "dynamic_id_48234 - (int64_t) 1];\n                        prefix_48317 = ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48318 = ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48322 = sext_i64_i32(dynamic_id_48234 - sext_i32_i64(wave_sizze_48204));\n                    \n                    while (slt32(wave_sizze_48204 * -1, readOffset_48322)) {\n                        int32_t read_i_48323 = readOffset_48322 + local_tid_48202;\n                        int16_t aggr_48324 = (int16_t) 0;\n                        int16_t aggr_48325 = (int16_t) 0;\n                        int16_t aggr_48326 = (int16_t) 0;\n                        int16_t aggr_48327 = (int16_t) 0;\n                        int8_t flag_48328 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48323)) {\n                            flag_48328 = ((volatile __global int8_t *) status_flags_mem_48141)[sext_i32_i64(read_i_48323)];\n                            if (flag_48328 == (int8_t) 2) {\n                                aggr_48324 = ((volatile __global int16_t *) incprefixes_mem_48165)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) incprefixes_mem_48169)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) incprefixes_mem_48173)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) incprefixes_mem_48177)[sext_i32_i64(read_i_48323)];\n                            } else if (flag_48328 == (int8_t) 1) {\n                                aggr_48324 = ((volatile __global int16_t *) aggregates_mem_48163)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) aggregates_mem_48167)[sext_i32_i64(read_i_", "48323)];\n                                aggr_48326 = ((volatile __global int16_t *) aggregates_mem_48171)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) aggregates_mem_48175)[sext_i32_i64(read_i_48323)];\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = aggr_48324;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48325;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48326;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48327;\n                        ((__local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flag_48328;\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        if (slt8(flag_48328, (int8_t) 2)) {\n                            int8_t flg_x_48341;\n                            int8_t flg_y_48342;\n                            int16_t eta_p_48329;\n                            int16_t eta_p_48330;\n                            int16_t eta_p_48331;\n                            int16_t eta_p_48332;\n                            int16_t eta_p_48333;\n                            int16_t eta_p_48334;\n                            int16_t eta_p_48335;\n                            int16_t eta_p_48336;\n                            int32_t skip_threads_48343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48342 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                       ",
                                    "         eta_p_48333 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)];\n                                eta_p_48334 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48335 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48336 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                                    eta_p_48329 = eta_p_48333;\n                                    eta_p_48330 = eta_p_48334;\n                                    eta_p_48331 = eta_p_48335;\n                                    eta_p_48332 = eta_p_48336;\n                                    flg_x_48341 = flg_y_48342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48343 = 1;\n                                while (slt32(skip_threads_48343, 32)) {\n                                    if (sle32(skip_threads_48343, local_tid_48202 - squot32(local_tid_48202, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48341 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343)];\n                                            eta_p_48329 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48330 = ((volatile __loca", "l int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48331 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48332 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48342 == (int8_t) 2 || flg_y_48342 == (int8_t) 0) {\n                                                flg_x_48341 = flg_y_48342;\n                                                eta_p_48329 = eta_p_48333;\n                                                eta_p_48330 = eta_p_48334;\n                                                eta_p_48331 = eta_p_48335;\n                                                eta_p_48332 = eta_p_48336;\n                                            } else {\n                                                int16_t defunc_0_op_res_48337 = add16(eta_p_48329, eta_p_48333);\n                                                int16_t defunc_0_op_res_48338 = add16(eta_p_48330, eta_p_48334);\n                                                int16_t defunc_0_op_res_48339 = add16(eta_p_48331, eta_p_48335);\n                                                int16_t defunc_0_op_res_48340 = add16(eta_p_48332, eta_p_48336);\n                                                \n                                                eta_p_48329 = defunc_0_op_res_48337;\n                                                eta_p_48330 = defunc_0_op_res_48338;\n                                                eta_p_48331 = ", "defunc_0_op_res_48339;\n                                                eta_p_48332 = defunc_0_op_res_48340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flg_x_48341;\n                                            flg_y_48342 = flg_x_48341;\n                                            ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = eta_p_48329;\n                                            eta_p_48333 = eta_p_48329;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48330;\n                                            eta_p_48334 = eta_p_48330;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48331;\n                                            eta_p_48335 = eta_p_48331;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48332;\n                                            eta_p_48336 = eta_p_48332;\n                                        }\n                                    }\n                                    skip_threads_48343 *= 2;\n                                }\n                            }\n                        }\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        aggr_48324 = ((__local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                    ",
                                    "    aggr_48325 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48326 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48327 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        if (flag_48328 == (int8_t) 2) {\n                            readOffset_48322 = wave_sizze_48204 * -1;\n                        } else if (flag_48328 == (int8_t) 1) {\n                            readOffset_48322 -= wave_sizze_48204;\n                        }\n                        if (slt8((int8_t) 0, flag_48328)) {\n                            int16_t eta_p_48344 = aggr_48324;\n                            int16_t eta_p_48345 = aggr_48325;\n                            int16_t eta_p_48346 = aggr_48326;\n                            int16_t eta_p_48347 = aggr_48327;\n                            int16_t eta_p_48348 = prefix_48315;\n                            int16_t eta_p_48349 = prefix_48316;\n                            int16_t eta_p_48350 = prefix_48317;\n                            int16_t eta_p_48351 = prefix_48318;\n                            int16_t defunc_0_op_res_48352 = add16(eta_p_48344, eta_p_48348);\n                            int16_t defunc_0_op_res_48353 = add16(eta_p_48345, eta_p_48349);\n                            int16_t defunc_0_op_res_48354 = add16(eta_p_48346, eta_p_48350);\n                            int16_t defunc_0_op_res_48355 = add16(eta_p_48347, eta_p_48351);\n                            \n                            prefix_48315 = defunc_0_op_res_48352;\n                            prefix_48316 = defunc_0_op_res_48353;\n                            prefix_48317 = defunc_0_op_res_48354;\n                            prefix_48318 = defunc_0_op_res_4835", "5;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48202 == 0) {\n                    if (boundary_48237 == sext_i64_i32(segscan_tblock_sizze_45396 * chunk_sizze_48138)) {\n                        int16_t eta_p_48356 = prefix_48315;\n                        int16_t eta_p_48357 = prefix_48316;\n                        int16_t eta_p_48358 = prefix_48317;\n                        int16_t eta_p_48359 = prefix_48318;\n                        int16_t eta_p_48360 = acc_48293;\n                        int16_t eta_p_48361 = acc_48294;\n                        int16_t eta_p_48362 = acc_48295;\n                        int16_t eta_p_48363 = acc_48296;\n                        int16_t defunc_0_op_res_48364 = add16(eta_p_48356, eta_p_48360);\n                        int16_t defunc_0_op_res_48365 = add16(eta_p_48357, eta_p_48361);\n                        int16_t defunc_0_op_res_48366 = add16(eta_p_48358, eta_p_48362);\n                        int16_t defunc_0_op_res_48367 = add16(eta_p_48359, eta_p_48363);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = defunc_0_op_res_48364;\n                        ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = defunc_0_op_res_48365;\n                        ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = defunc_0_op_res_48366;\n                        ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = defunc_0_op_res_48367;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48215)[(int64_t) 16] = prefix_48315;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)] = prefix_48316;\n                    (", "(__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)] = prefix_48317;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)] = prefix_48318;\n                    acc_48293 = (int16_t) 0;\n                    acc_48294 = (int16_t) 0;\n                    acc_48295 = (int16_t) 0;\n                    acc_48296 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48234 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48315 = ((__local int16_t *) local_mem_48215)[(int64_t) 16];\n                prefix_48316 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)];\n                prefix_48317 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)];\n                prefix_48318 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48368;\n            int16_t eta_p_48372;\n            int16_t eta_p_48380 = prefix_48315;\n            int16_t eta_p_48384 = acc_48293;\n            int16_t eta_p_48369;\n            int16_t eta_p_48373;\n            int16_t eta_p_48381 = prefix_48316;\n            int16_t eta_p_48385 = acc_48294;\n            int16_t eta_p_48370;\n            int16_t eta_p_48374;\n            int16_t eta_p_48382 = prefix_48317;\n            int16_t eta_p_48386 = acc_48295;\n            int16_t eta_p_48371;\n            int16_t eta_p_48375;\n            int16_t eta_p_48383 = prefix_48318;\n            int16_t eta_p_48387 = acc_48296;\n            \n            if (slt32(local_tid_48202 * chunk_sizze_32b_48206, boundary_48237) && !block_new_sgm_48319) {\n                int16_t defunc_0_op_res_48388 = add16(eta_p_48380, eta_p_48384);\n                int16_t defunc_0_op_res_48389 = add16(eta_p_48381, eta_p_48385);\n          ",
                                    "      int16_t defunc_0_op_res_48390 = add16(eta_p_48382, eta_p_48386);\n                int16_t defunc_0_op_res_48391 = add16(eta_p_48383, eta_p_48387);\n                \n                eta_p_48368 = defunc_0_op_res_48388;\n                eta_p_48369 = defunc_0_op_res_48389;\n                eta_p_48370 = defunc_0_op_res_48390;\n                eta_p_48371 = defunc_0_op_res_48391;\n            } else {\n                eta_p_48368 = acc_48293;\n                eta_p_48369 = acc_48294;\n                eta_p_48370 = acc_48295;\n                eta_p_48371 = acc_48296;\n            }\n            \n            int32_t stopping_point_48392 = segsizze_compact_48238 - srem32(local_tid_48202 * chunk_sizze_32b_48206 - 1 + segsizze_compact_48238 - boundary_48237, segsizze_compact_48238);\n            \n            for (int64_t i_48393 = 0; i_48393 < chunk_sizze_48138; i_48393++) {\n                if (slt32(sext_i64_i32(i_48393), stopping_point_48392 - 1)) {\n                    eta_p_48372 = private_mem_48239[i_48393];\n                    eta_p_48373 = private_mem_48241[i_48393];\n                    eta_p_48374 = private_mem_48243[i_48393];\n                    eta_p_48375 = private_mem_48245[i_48393];\n                    \n                    int16_t defunc_0_op_res_48376 = add16(eta_p_48368, eta_p_48372);\n                    int16_t defunc_0_op_res_48377 = add16(eta_p_48369, eta_p_48373);\n                    int16_t defunc_0_op_res_48378 = add16(eta_p_48370, eta_p_48374);\n                    int16_t defunc_0_op_res_48379 = add16(eta_p_48371, eta_p_48375);\n                    \n                    private_mem_48239[i_48393] = defunc_0_op_res_48376;\n                    private_mem_48241[i_48393] = defunc_0_op_res_48377;\n                    private_mem_48243[i_48393] = defunc_0_op_res_48378;\n                    private_mem_48245[i_48393] = defunc_0_op_res_48379;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n     ", "   {\n            for (int64_t i_48394 = 0; i_48394 < chunk_sizze_48138; i_48394++) {\n                int64_t sharedIdx_48395 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48394;\n                int16_t tmp_48396 = private_mem_48239[i_48394];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48395] = tmp_48396;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48397 = 0; i_48397 < chunk_sizze_48138; i_48397++) {\n                int64_t flat_idx_48398 = thd_offset_48247 + i_48397 * segscan_tblock_sizze_45396;\n                int64_t slice_48399 = rest_43230;\n                int64_t gtid_45400 = flat_idx_48398;\n                int64_t remnant_48400 = flat_idx_48398 - gtid_45400;\n                \n                if (slt64(flat_idx_48398, rest_43230)) {\n                    int16_t tmp_48401 = ((__local int16_t *) local_mem_48215)[flat_idx_48398 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47857)[gtid_45400] = tmp_48401;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48402 = 0; i_48402 < chunk_sizze_48138; i_48402++) {\n                int64_t sharedIdx_48403 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48402;\n                int16_t tmp_48404 = private_mem_48241[i_48402];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48403] = tmp_48404;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48405 = 0; i_48405 < chunk_sizze_48138; i_48405++) {\n                int64_t flat_idx_48406 = thd_offset_48247 + i_48405 * segscan_tblock_sizze_45396;\n                int64_t slice_48407 = rest_43230;\n                int64_t gtid_45400 = flat_idx_48406;\n                int64_t remnant_48408 = flat_idx_48406 - gtid_45400;\n                \n                if (slt64(flat_idx_48406, rest_43230)) {\n                    int16_t tmp_48409 = ((__local ", "int16_t *) local_mem_48215)[flat_idx_48406 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47859)[gtid_45400] = tmp_48409;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48410 = 0; i_48410 < chunk_sizze_48138; i_48410++) {\n                int64_t sharedIdx_48411 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48410;\n                int16_t tmp_48412 = private_mem_48243[i_48410];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48411] = tmp_48412;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48413 = 0; i_48413 < chunk_sizze_48138; i_48413++) {\n                int64_t flat_idx_48414 = thd_offset_48247 + i_48413 * segscan_tblock_sizze_45396;\n                int64_t slice_48415 = rest_43230;\n                int64_t gtid_45400 = flat_idx_48414;\n                int64_t remnant_48416 = flat_idx_48414 - gtid_45400;\n                \n                if (slt64(flat_idx_48414, rest_43230)) {\n                    int16_t tmp_48417 = ((__local int16_t *) local_mem_48215)[flat_idx_48414 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47861)[gtid_45400] = tmp_48417;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48418 = 0; i_48418 < chunk_sizze_48138; i_48418++) {\n                int64_t sharedIdx_48419 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48418;\n                int16_t tmp_48420 = private_mem_48245[i_48418];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48419] = tmp_48420;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48421 = 0; i_48421 < chunk_sizze_48138; i_48421++) {\n                int64_t flat_idx_48422 = thd_offset_48247 + i_48421 * segscan_tblock_sizze_45396;\n                int64_t slice_48423 = rest_43230;\n            ",
                                    "    int64_t gtid_45400 = flat_idx_48422;\n                int64_t remnant_48424 = flat_idx_48422 - gtid_45400;\n                \n                if (slt64(flat_idx_48422, rest_43230)) {\n                    int16_t tmp_48425 = ((__local int16_t *) local_mem_48215)[flat_idx_48422 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47863)[gtid_45400] = tmp_48425;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45396\n    #undef chunk_sizze_48138\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegscan_45718_dim1, 1, 1)\nvoid sortColumn_floatzisegscan_45718(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_43225, int64_t n_blocks_43229, int32_t blocked_radix_sort_step_arg1_43293, int32_t get_bit_arg0_43298, unsigned char cond_f_res_43299_bits, unsigned char cond_f_res_43300_bits, int64_t num_tblocks_45709, int64_t num_virt_blocks_48530, int64_t num_virt_threads_48531, __global unsigned char *mem_47846, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *status_flags_mem_48532, __global unsigned char *aggregates_mem_48534, __global unsigned char *incprefixes_mem_48536, __global unsigned char *aggregates_mem_48538, __global unsigned char *incprefixes_mem_48540, __global unsigned char *aggregates_mem_48542, __global unsigned char *incprefixes_mem_48544, __global unsigned char *aggregates_mem_48546, __global unsigned char *incprefixes_mem_48548, __global unsigned char *global_dynid_mem_48550)\n{\n    bool cond_f_res_43299 = cond_f_res_43299_bits;\n    bool cond_f_res_43300 = cond_f_res_43300_bits;\n    \n    #define segscan_tblock_sizze_45708 (sortColumn_floatzisegscan_45718zisegscan_tblock_sizze_45708)\n    #define chunk_sizze_48529 (sortColumn_floa", "tzisegscan_45718zichunk_sizze_48529)\n    \n    volatile __local unsigned char *local_mem_48566_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48566_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48553;\n    int32_t tblock_sizze_48556;\n    int32_t wave_sizze_48555;\n    int32_t block_id_48554;\n    int32_t global_tid_48552;\n    int64_t phys_tid_45718;\n    int32_t chunk_sizze_32b_48557;\n    int64_t byte_offsets_48558;\n    int64_t byte_offsets_48559;\n    int64_t byte_offsets_48560;\n    int64_t byte_offsets_48561;\n    int64_t warp_byte_offset_48562;\n    int64_t warp_byte_offset_48563;\n    int64_t warp_byte_offset_48564;\n    int64_t warp_b", "yte_offset_48565;\n    __local unsigned char *local_mem_48566;\n    int64_t trans_arr_len_48567;\n    int64_t phys_block_id_48582;\n    int64_t virtloop_bound_48583;\n    \n    local_tid_48553 = get_local_id(0);\n    tblock_sizze_48556 = get_local_size(0);\n    wave_sizze_48555 = LOCKSTEP_WIDTH;\n    block_id_48554 = get_tblock_id(0);\n    global_tid_48552 = block_id_48554 * tblock_sizze_48556 + local_tid_48553;\n    phys_tid_45718 = sext_i32_i64(global_tid_48552);\n    chunk_sizze_32b_48557 = sext_i64_i32(chunk_sizze_48529);\n    byte_offsets_48558 = segscan_tblock_sizze_45708 * (int64_t) 2;\n    byte_offsets_48559 = sdiv_up64(byte_offsets_48558, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45708 * (int64_t) 2;\n    byte_offsets_48560 = sdiv_up64(byte_offsets_48559, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45708 * (int64_t) 2;\n    byte_offsets_48561 = sdiv_up64(byte_offsets_48560, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45708 * (int64_t) 2;\n    warp_byte_offset_48562 = (int64_t) 96;\n    warp_byte_offset_48563 = sdiv_up64(warp_byte_offset_48562, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48564 = sdiv_up64(warp_byte_offset_48563, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48565 = sdiv_up64(warp_byte_offset_48564, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48566 = (__local unsigned char *) local_mem_48566_backing_0;\n    trans_arr_len_48567 = chunk_sizze_48529 * segscan_tblock_sizze_45708;\n    phys_block_id_48582 = get_tblock_id(0);\n    virtloop_bound_48583 = sdiv_up64(num_virt_blocks_48530 - phys_block_id_48582, num_tblocks_45709);\n    for (int64_t virtloop_i_48584 = 0; virtloop_i_48584 < virtloop_bound_48583; virtloop_i_48584++) {\n        int64_t dynamic_id_48585;\n        int64_t block_offset_48586;\n        int64_t sgm_idx_48587;\n        int32_t boundary_48588;\n        int32_t segsizze_compact_48589;\n        int16_t private_mem_48590[chunk_sizze_48529];\n   ",
                                    "     int16_t private_mem_48592[chunk_sizze_48529];\n        int16_t private_mem_48594[chunk_sizze_48529];\n        int16_t private_mem_48596[chunk_sizze_48529];\n        int64_t thd_offset_48598;\n        int16_t acc_48648;\n        int16_t acc_48649;\n        int16_t acc_48650;\n        int16_t acc_48651;\n        int16_t prefix_48673;\n        int16_t prefix_48674;\n        int16_t prefix_48675;\n        int16_t prefix_48676;\n        bool block_new_sgm_48677;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48553 == 0) {\n                dynamic_id_48585 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48550)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48566)[(int64_t) 0] = dynamic_id_48585;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48585 == num_virt_blocks_48530 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48550)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48585 = ((__local int32_t *) local_mem_48566)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48586 = dynamic_id_48585 * chunk_sizze_48529 * segscan_tblock_sizze_45708;\n        sgm_idx_48587 = smod64(block_offset_48586, i16_res_43225);\n        boundary_48588 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_45708, i16_res_43225 - sgm_idx_48587));\n        segsizze_compact_48589 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_45708, i16_res_43225));\n        thd_offset_48598 = block_offset_48586 + sext_i32_i64(local_tid_48553);\n        // Load and map\n        {\n            for (int64_t i_48599 = 0; i_48599 < chunk_sizze_48529; i_48599++) {\n                int64_t", " virt_tid_48600 = thd_offset_48598 + i_48599 * segscan_tblock_sizze_45708;\n                int64_t slice_48601 = i16_res_43225;\n                int64_t slice_48602 = n_blocks_43229 * slice_48601;\n                int64_t gtid_45716 = squot64(virt_tid_48600, slice_48601);\n                int64_t remnant_48603 = virt_tid_48600 - gtid_45716 * slice_48601;\n                int64_t gtid_45717 = remnant_48603;\n                int64_t remnant_48604 = remnant_48603 - gtid_45717;\n                \n                if (slt64(virt_tid_48600, n_blocks_43229 * i16_res_43225)) {\n                    int64_t binop_x_46982 = i16_res_43225 * gtid_45716;\n                    int64_t new_index_46983 = gtid_45717 + binop_x_46982;\n                    float eta_p_45732 = ((__global float *) mem_47846)[new_index_46983];\n                    int32_t i32_arg0_45733 = futrts_to_bits32(eta_p_45732);\n                    int32_t unsign_arg0_45734 = ashr32(i32_arg0_45733, get_bit_arg0_43298);\n                    int32_t unsign_arg0_45735 = 1 & unsign_arg0_45734;\n                    int32_t unsign_arg0_45736 = ashr32(i32_arg0_45733, 31);\n                    int32_t unsign_arg0_45737 = 1 & unsign_arg0_45736;\n                    bool cond_45738 = unsign_arg0_45737 == 1;\n                    bool x_45739 = !cond_45738;\n                    bool y_45740 = cond_f_res_43299 && x_45739;\n                    bool cond_45741 = cond_45738 || y_45740;\n                    int32_t defunc_0_get_bit_res_45742;\n                    \n                    if (cond_45741) {\n                        int32_t defunc_0_get_bit_res_t_res_45743 = 1 ^ unsign_arg0_45735;\n                        \n                        defunc_0_get_bit_res_45742 = defunc_0_get_bit_res_t_res_45743;\n                    } else {\n                        defunc_0_get_bit_res_45742 = unsign_arg0_45735;\n                    }\n                    \n                    int32_t zp_lhs_45744 = mul32(2, defunc_0_get_bit_res_45742);\n                    int32_t unsign", "_arg0_45745 = ashr32(i32_arg0_45733, blocked_radix_sort_step_arg1_43293);\n                    int32_t unsign_arg0_45746 = 1 & unsign_arg0_45745;\n                    bool y_45747 = cond_f_res_43300 && x_45739;\n                    bool cond_45748 = cond_45738 || y_45747;\n                    int32_t defunc_0_get_bit_res_45749;\n                    \n                    if (cond_45748) {\n                        int32_t defunc_0_get_bit_res_t_res_45750 = 1 ^ unsign_arg0_45746;\n                        \n                        defunc_0_get_bit_res_45749 = defunc_0_get_bit_res_t_res_45750;\n                    } else {\n                        defunc_0_get_bit_res_45749 = unsign_arg0_45746;\n                    }\n                    \n                    int32_t i32_arg0_45751 = add32(zp_lhs_45744, defunc_0_get_bit_res_45749);\n                    int16_t i32_res_45752 = sext_i32_i16(i32_arg0_45751);\n                    int16_t defunc_0_f_res_45753;\n                    int16_t defunc_0_f_res_45754;\n                    int16_t defunc_0_f_res_45755;\n                    int16_t defunc_0_f_res_45756;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_45753, &defunc_0_f_res_45754, &defunc_0_f_res_45755, &defunc_0_f_res_45756, i32_res_45752);\n                    ((__global int16_t *) mem_47901)[gtid_45716 * i16_res_43225 + gtid_45717] = i32_res_45752;\n                    private_mem_48590[i_48599] = defunc_0_f_res_45753;\n                    private_mem_48592[i_48599] = defunc_0_f_res_45754;\n                    private_mem_48594[i_48599] = defunc_0_f_res_45755;\n                    private_mem_48596[i_48599] = defunc_0_f_res_45756;\n                } else {\n                    private_mem_48590[i_48599] = (int16_t) 0;\n                    private_mem_48592[i_48599] = (int16_t) 0;\n                    private_mem_48594[i_48599] = (int16_t) 0;\n                    private_mem_48596[i_48599] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(",
                                    "CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48605 = 0; i_48605 < chunk_sizze_48529; i_48605++) {\n                int64_t sharedIdx_48606 = sext_i32_i64(local_tid_48553) + i_48605 * segscan_tblock_sizze_45708;\n                int16_t tmp_48607 = private_mem_48590[i_48605];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48606] = tmp_48607;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48608 = 0; i_48608 < chunk_sizze_48529; i_48608++) {\n                int64_t sharedIdx_48609 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48608;\n                int16_t tmp_48610 = ((__local int16_t *) local_mem_48566)[sharedIdx_48609];\n                \n                private_mem_48590[i_48608] = tmp_48610;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48611 = 0; i_48611 < chunk_sizze_48529; i_48611++) {\n                int64_t sharedIdx_48612 = sext_i32_i64(local_tid_48553) + i_48611 * segscan_tblock_sizze_45708;\n                int16_t tmp_48613 = private_mem_48592[i_48611];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48612] = tmp_48613;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48614 = 0; i_48614 < chunk_sizze_48529; i_48614++) {\n                int64_t sharedIdx_48615 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48614;\n                int16_t tmp_48616 = ((__local int16_t *) local_mem_48566)[sharedIdx_48615];\n                \n                private_mem_48592[i_48614] = tmp_48616;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48617 = 0; i_48617 < chunk_sizze_48529; i_48617++) {\n                int64_t sharedIdx_48618 = sext_i32_i64(local_tid_48553) + i_48617 * segscan_tblock_sizze_45708;\n                int16_t tmp_48619 = private_mem_48594[i_48617];\n                \n                ((__local in", "t16_t *) local_mem_48566)[sharedIdx_48618] = tmp_48619;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48620 = 0; i_48620 < chunk_sizze_48529; i_48620++) {\n                int64_t sharedIdx_48621 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48620;\n                int16_t tmp_48622 = ((__local int16_t *) local_mem_48566)[sharedIdx_48621];\n                \n                private_mem_48594[i_48620] = tmp_48622;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48623 = 0; i_48623 < chunk_sizze_48529; i_48623++) {\n                int64_t sharedIdx_48624 = sext_i32_i64(local_tid_48553) + i_48623 * segscan_tblock_sizze_45708;\n                int16_t tmp_48625 = private_mem_48596[i_48623];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48624] = tmp_48625;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48626 = 0; i_48626 < chunk_sizze_48529; i_48626++) {\n                int64_t sharedIdx_48627 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48626;\n                int16_t tmp_48628 = ((__local int16_t *) local_mem_48566)[sharedIdx_48627];\n                \n                private_mem_48596[i_48626] = tmp_48628;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48629 = 0; i_48629 < chunk_sizze_48529 - (int64_t) 1; i_48629++) {\n                int32_t gidx_48630 = local_tid_48553 * chunk_sizze_32b_48557 + 1;\n                bool new_sgm_48631 = smod32(gidx_48630 + sext_i64_i32(i_48629) - boundary_48588, segsizze_compact_48589) == 0;\n                \n                if (!new_sgm_48631) {\n                    int16_t eta_p_45719;\n                    int16_t eta_p_45723;\n                    \n                    eta_p_45719 = private_mem_48590[i_48629];\n                    eta_p_45723 = private_mem_48590[i_48629 + (int64_t) 1];\n                    \n", "                    int16_t eta_p_45720;\n                    int16_t eta_p_45724;\n                    \n                    eta_p_45720 = private_mem_48592[i_48629];\n                    eta_p_45724 = private_mem_48592[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_45721;\n                    int16_t eta_p_45725;\n                    \n                    eta_p_45721 = private_mem_48594[i_48629];\n                    eta_p_45725 = private_mem_48594[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_45722;\n                    int16_t eta_p_45726;\n                    \n                    eta_p_45722 = private_mem_48596[i_48629];\n                    eta_p_45726 = private_mem_48596[i_48629 + (int64_t) 1];\n                    \n                    int16_t defunc_0_op_res_45727 = add16(eta_p_45719, eta_p_45723);\n                    int16_t defunc_0_op_res_45728 = add16(eta_p_45720, eta_p_45724);\n                    int16_t defunc_0_op_res_45729 = add16(eta_p_45721, eta_p_45725);\n                    int16_t defunc_0_op_res_45730 = add16(eta_p_45722, eta_p_45726);\n                    \n                    private_mem_48590[i_48629 + (int64_t) 1] = defunc_0_op_res_45727;\n                    private_mem_48592[i_48629 + (int64_t) 1] = defunc_0_op_res_45728;\n                    private_mem_48594[i_48629 + (int64_t) 1] = defunc_0_op_res_45729;\n                    private_mem_48596[i_48629 + (int64_t) 1] = defunc_0_op_res_45730;\n                }\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48632 = private_mem_48590[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = tmp_48632;\n            \n            int16_t tmp_48633 = private_mem_48592[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_",
                                    "tid_48553)] = tmp_48633;\n            \n            int16_t tmp_48634 = private_mem_48594[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48634;\n            \n            int16_t tmp_48635 = private_mem_48596[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48635;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48636;\n            int16_t eta_p_48637;\n            int16_t eta_p_48638;\n            int16_t eta_p_48639;\n            int16_t eta_p_48640;\n            int16_t eta_p_48641;\n            int16_t eta_p_48642;\n            int16_t eta_p_48643;\n            int16_t eta_p_48652;\n            int16_t eta_p_48653;\n            int16_t eta_p_48654;\n            int16_t eta_p_48655;\n            int16_t eta_p_48656;\n            int16_t eta_p_48657;\n            int16_t eta_p_48658;\n            int16_t eta_p_48659;\n            bool ltid_in_bounds_48664 = slt64(sext_i32_i64(local_tid_48553), num_virt_threads_48531);\n            int32_t skip_threads_48665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48664) {\n                    eta_p_48640 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                    eta_p_48641 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48642 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48643 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n            ", "        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                        eta_p_48636 = eta_p_48640;\n                        eta_p_48637 = eta_p_48641;\n                        eta_p_48638 = eta_p_48642;\n                        eta_p_48639 = eta_p_48643;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48665 = 1;\n                while (slt32(skip_threads_48665, 32)) {\n                    bool thread_active_48666 = sle32(skip_threads_48665, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && ltid_in_bounds_48664;\n                    \n                    if (thread_active_48666) {\n                        // read operands\n                        {\n                            eta_p_48636 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665)];\n                            eta_p_48637 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48638 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48639 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_48667 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((local_tid_48553 - skip_threads_48665 + 1) * chunk_sizze_32b_48557 - 1));\n                        \n             ", "           if (thread_active_48666 && inactive_48667) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                        if (thread_active_48666) {\n                            if (!inactive_48667) {\n                                int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                                int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                                int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                                int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                                \n                                eta_p_48636 = defunc_0_op_res_48644;\n                                eta_p_48637 = defunc_0_op_res_48645;\n                                eta_p_48638 = defunc_0_op_res_48646;\n                                eta_p_48639 = defunc_0_op_res_48647;\n                            }\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48666) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                            eta_p_48640 = eta_p_48636;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                            eta_p_48641 = eta_p_48637;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n  ",
                                    "                          eta_p_48642 = eta_p_48638;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                            eta_p_48643 = eta_p_48639;\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 31 && ltid_in_bounds_48664) {\n                    ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48636;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48637;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48638;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48668;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                        eta_p_48656 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                        eta_p_48657 = ((volatile __local int16_t *) local_mem", "_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48658 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48659 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                            eta_p_48652 = eta_p_48656;\n                            eta_p_48653 = eta_p_48657;\n                            eta_p_48654 = eta_p_48658;\n                            eta_p_48655 = eta_p_48659;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48668 = 1;\n                    while (slt32(skip_threads_48668, 32)) {\n                        bool thread_active_48669 = sle32(skip_threads_48668, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664);\n                        \n                        if (thread_active_48669) {\n                            // read operands\n                            {\n                                eta_p_48652 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668)];\n                                eta_p_48653 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48654 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48655 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560,", " (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_48670 = slt32(smod32((local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 - (((local_tid_48553 - skip_threads_48668) * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                            \n                            if (thread_active_48669 && inactive_48670) {\n                                eta_p_48652 = eta_p_48656;\n                                eta_p_48653 = eta_p_48657;\n                                eta_p_48654 = eta_p_48658;\n                                eta_p_48655 = eta_p_48659;\n                            }\n                            if (thread_active_48669) {\n                                if (!inactive_48670) {\n                                    int16_t defunc_0_op_res_48660 = add16(eta_p_48652, eta_p_48656);\n                                    int16_t defunc_0_op_res_48661 = add16(eta_p_48653, eta_p_48657);\n                                    int16_t defunc_0_op_res_48662 = add16(eta_p_48654, eta_p_48658);\n                                    int16_t defunc_0_op_res_48663 = add16(eta_p_48655, eta_p_48659);\n                                    \n                                    eta_p_48652 = defunc_0_op_res_48660;\n                                    eta_p_48653 = defunc_0_op_res_48661;\n                                    eta_p_48654 = defunc_0_op_res_48662;\n                                    eta_p_48655 = defunc_0_op_res_48663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n  ",
                                    "                      }\n                        if (thread_active_48669) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48652;\n                                eta_p_48656 = eta_p_48652;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48653;\n                                eta_p_48657 = eta_p_48653;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48654;\n                                eta_p_48658 = eta_p_48654;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48655;\n                                eta_p_48659 = eta_p_48655;\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48668 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48671 = squot32(local_tid_48553, 32) == 0 || !ltid_in_bounds_48664;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48671) {\n                        eta_p_48640 = eta_p_48636;\n                        eta_p_48641 = eta_p_48637;\n                        eta_p_48642 = eta_p_48638;\n                        eta_p_48643 = eta_p_48639;\n                        eta_p_48636 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) ", "1];\n                        eta_p_48637 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48638 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48639 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48672 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((squot32(local_tid_48553, 32) * 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                    \n                    if (!no_carry_in_48671) {\n                        if (inactive_48672) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                    }\n                    if (!no_carry_in_48671) {\n                        if (!inactive_48672) {\n                            int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                            int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                            int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                            int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                            \n                            eta_p_48636 = defunc_0_op_res_48644;\n                            eta_p_48637 = defunc_0_op_res_48645;\n                            eta_p_48638 = defunc_0_op_r", "es_48646;\n                            eta_p_48639 = defunc_0_op_res_48647;\n                        }\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48671) {\n                        ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                    ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48640;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48641;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48642;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48643;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48553 == 0) {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[segscan_tblock_sizze_45708 - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (segscan_tblock_sizze_45708 - (i",
                                    "nt64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (segscan_tblock_sizze_45708 - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (segscan_tblock_sizze_45708 - (int64_t) 1)];\n            } else {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48673 = (int16_t) 0;\n        prefix_48674 = (int16_t) 0;\n        prefix_48675 = (int16_t) 0;\n        prefix_48676 = (int16_t) 0;\n        block_new_sgm_48677 = sgm_idx_48587 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48677 && local_tid_48553 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                acc_48648 = (int16_t) 0;\n                acc_48649 = (int16_t) 0;\n                acc_48650 = (int16_t) 0;\n                acc_48651 = (int16_t) 0", ";\n            }\n            if (!block_new_sgm_48677 && slt32(local_tid_48553, wave_sizze_48555)) {\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_45708 * chunk_sizze_48529)) {\n                        ((volatile __global int16_t *) aggregates_mem_48534)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) aggregates_mem_48538)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) aggregates_mem_48542)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) aggregates_mem_48546)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 1;\n                    } else {\n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    \n                    int8_t tmp_48678 = ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48566)[(int64_t) 0] = tmp_48678;\n                }\n                mem_fence_local();\n                \n                int8_t status_48679 = ((__local int8_t *) local_mem_48566)[(int64_t) 0];\n                \n                if (status_48679 == (int8_t) 2) {\n                    if (local_tid_485", "53 == 0) {\n                        prefix_48673 = ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48674 = ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48675 = ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48676 = ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48680 = sext_i64_i32(dynamic_id_48585 - sext_i32_i64(wave_sizze_48555));\n                    \n                    while (slt32(wave_sizze_48555 * -1, readOffset_48680)) {\n                        int32_t read_i_48681 = readOffset_48680 + local_tid_48553;\n                        int16_t aggr_48682 = (int16_t) 0;\n                        int16_t aggr_48683 = (int16_t) 0;\n                        int16_t aggr_48684 = (int16_t) 0;\n                        int16_t aggr_48685 = (int16_t) 0;\n                        int8_t flag_48686 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48681)) {\n                            if (sle64(block_offset_48586 - (sext_i32_i64(read_i_48681 + 1) * segscan_tblock_sizze_45708 * chunk_sizze_48529 - (int64_t) 1), sgm_idx_48587)) {\n                                flag_48686 = ((volatile __global int8_t *) status_flags_mem_48532)[sext_i32_i64(read_i_48681)];\n                                if (flag_48686 == (int8_t) 2) {\n                                    aggr_48682 = ((volatile __global int16_t *) incprefixes_mem_48536)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) incprefixes_mem_48540)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) incprefixes_mem_48544)[sext_i32_i64(read_i_48681)];\n                ",
                                    "                    aggr_48685 = ((volatile __global int16_t *) incprefixes_mem_48548)[sext_i32_i64(read_i_48681)];\n                                } else if (flag_48686 == (int8_t) 1) {\n                                    aggr_48682 = ((volatile __global int16_t *) aggregates_mem_48534)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) aggregates_mem_48538)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) aggregates_mem_48542)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) aggregates_mem_48546)[sext_i32_i64(read_i_48681)];\n                                }\n                            } else {\n                                flag_48686 = (int8_t) 2;\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = aggr_48682;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48683;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48684;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48685;\n                        ((__local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flag_48686;\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        if (slt8(flag_48686, (int8_t) 2)) {\n                            int8_t flg_x_48699;\n                            int8_t flg_y_48700;\n                            int16_t eta_p_48687;\n                            int16_t eta_p_48688;\n                            int16_t eta_", "p_48689;\n                            int16_t eta_p_48690;\n                            int16_t eta_p_48691;\n                            int16_t eta_p_48692;\n                            int16_t eta_p_48693;\n                            int16_t eta_p_48694;\n                            int32_t skip_threads_48701;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48700 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                                eta_p_48691 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)];\n                                eta_p_48692 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48693 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48694 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                                    eta_p_48687 = eta_p_48691;\n                                    eta_p_48688 = eta_p_48692;\n                                    eta_p_48689 = eta_p_48693;\n                                    eta_p_48690 = eta_p_48694;\n                                    flg_x_48699 = flg_y_48700;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48701 = 1;\n                                while (slt32(skip_threads_48701, 32)) {\n                                    if (sle32(skip_threads_48701, local_tid_4855", "3 - squot32(local_tid_48553, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48699 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701)];\n                                            eta_p_48687 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48688 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48689 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48690 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48700 == (int8_t) 2 || flg_y_48700 == (int8_t) 0) {\n                                                flg_x_48699 = flg_y_48700;\n                                                eta_p_48687 = eta_p_48691;\n                                                eta_p_48688 = eta_p_48692;\n                                                eta_p_48689 = eta_p_48693;\n                                                eta_p_48690 = eta_p_48694;\n                                            } else {\n                                                int16_t defunc_0_op_res_48695 = add16(eta_p_48687, eta_p_48691);\n                                            ",
                                    "    int16_t defunc_0_op_res_48696 = add16(eta_p_48688, eta_p_48692);\n                                                int16_t defunc_0_op_res_48697 = add16(eta_p_48689, eta_p_48693);\n                                                int16_t defunc_0_op_res_48698 = add16(eta_p_48690, eta_p_48694);\n                                                \n                                                eta_p_48687 = defunc_0_op_res_48695;\n                                                eta_p_48688 = defunc_0_op_res_48696;\n                                                eta_p_48689 = defunc_0_op_res_48697;\n                                                eta_p_48690 = defunc_0_op_res_48698;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flg_x_48699;\n                                            flg_y_48700 = flg_x_48699;\n                                            ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = eta_p_48687;\n                                            eta_p_48691 = eta_p_48687;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48688;\n                                            eta_p_48692 = eta_p_48688;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48689;\n                                            eta_p_48693 = eta_p_48689;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48690;\n      ", "                                      eta_p_48694 = eta_p_48690;\n                                        }\n                                    }\n                                    skip_threads_48701 *= 2;\n                                }\n                            }\n                        }\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        aggr_48682 = ((__local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48683 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48684 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48685 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        if (flag_48686 == (int8_t) 2) {\n                            readOffset_48680 = wave_sizze_48555 * -1;\n                        } else if (flag_48686 == (int8_t) 1) {\n                            readOffset_48680 -= wave_sizze_48555;\n                        }\n                        if (slt8((int8_t) 0, flag_48686)) {\n                            int16_t eta_p_48702 = aggr_48682;\n                            int16_t eta_p_48703 = aggr_48683;\n                            int16_t eta_p_48704 = aggr_48684;\n                            int16_t eta_p_48705 = aggr_48685;\n                            int16_t eta_p_48706 = prefix_48673;\n                            int16_t eta_p_48707 = prefix_48674;\n                            int16_t eta_p_48708 = prefix_48675;\n                            int16_t eta_p_48709 = prefix_48676;\n                            int16_t defunc_0_op_res_48710 = add16(eta_p_48702, eta_p_4", "8706);\n                            int16_t defunc_0_op_res_48711 = add16(eta_p_48703, eta_p_48707);\n                            int16_t defunc_0_op_res_48712 = add16(eta_p_48704, eta_p_48708);\n                            int16_t defunc_0_op_res_48713 = add16(eta_p_48705, eta_p_48709);\n                            \n                            prefix_48673 = defunc_0_op_res_48710;\n                            prefix_48674 = defunc_0_op_res_48711;\n                            prefix_48675 = defunc_0_op_res_48712;\n                            prefix_48676 = defunc_0_op_res_48713;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_45708 * chunk_sizze_48529)) {\n                        int16_t eta_p_48714 = prefix_48673;\n                        int16_t eta_p_48715 = prefix_48674;\n                        int16_t eta_p_48716 = prefix_48675;\n                        int16_t eta_p_48717 = prefix_48676;\n                        int16_t eta_p_48718 = acc_48648;\n                        int16_t eta_p_48719 = acc_48649;\n                        int16_t eta_p_48720 = acc_48650;\n                        int16_t eta_p_48721 = acc_48651;\n                        int16_t defunc_0_op_res_48722 = add16(eta_p_48714, eta_p_48718);\n                        int16_t defunc_0_op_res_48723 = add16(eta_p_48715, eta_p_48719);\n                        int16_t defunc_0_op_res_48724 = add16(eta_p_48716, eta_p_48720);\n                        int16_t defunc_0_op_res_48725 = add16(eta_p_48717, eta_p_48721);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = defunc_0_op_res_48722;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = defunc_0_op_res_48723;\n                        ((volatile __global int16_t *) incprefixes_mem_",
                                    "48544)[dynamic_id_48585] = defunc_0_op_res_48724;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = defunc_0_op_res_48725;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48566)[(int64_t) 16] = prefix_48673;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)] = prefix_48674;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)] = prefix_48675;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)] = prefix_48676;\n                    acc_48648 = (int16_t) 0;\n                    acc_48649 = (int16_t) 0;\n                    acc_48650 = (int16_t) 0;\n                    acc_48651 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48585 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48673 = ((__local int16_t *) local_mem_48566)[(int64_t) 16];\n                prefix_48674 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)];\n                prefix_48675 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)];\n                prefix_48676 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48726;\n            int16_t eta_p_48730;\n            int16_t eta_p_48738 = prefix_48673;\n            int16_t eta_p_48742 = acc_48648;\n            int16_t eta_p_48727;\n            int16_t eta_p_48731;\n            int16_t eta_p_48739 = prefix_48674;\n            int16_t eta_p_48743 = acc_48649;\n            int16_t eta_p_48728;\n", "            int16_t eta_p_48732;\n            int16_t eta_p_48740 = prefix_48675;\n            int16_t eta_p_48744 = acc_48650;\n            int16_t eta_p_48729;\n            int16_t eta_p_48733;\n            int16_t eta_p_48741 = prefix_48676;\n            int16_t eta_p_48745 = acc_48651;\n            \n            if (slt32(local_tid_48553 * chunk_sizze_32b_48557, boundary_48588) && !block_new_sgm_48677) {\n                int16_t defunc_0_op_res_48746 = add16(eta_p_48738, eta_p_48742);\n                int16_t defunc_0_op_res_48747 = add16(eta_p_48739, eta_p_48743);\n                int16_t defunc_0_op_res_48748 = add16(eta_p_48740, eta_p_48744);\n                int16_t defunc_0_op_res_48749 = add16(eta_p_48741, eta_p_48745);\n                \n                eta_p_48726 = defunc_0_op_res_48746;\n                eta_p_48727 = defunc_0_op_res_48747;\n                eta_p_48728 = defunc_0_op_res_48748;\n                eta_p_48729 = defunc_0_op_res_48749;\n            } else {\n                eta_p_48726 = acc_48648;\n                eta_p_48727 = acc_48649;\n                eta_p_48728 = acc_48650;\n                eta_p_48729 = acc_48651;\n            }\n            \n            int32_t stopping_point_48750 = segsizze_compact_48589 - srem32(local_tid_48553 * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589);\n            \n            for (int64_t i_48751 = 0; i_48751 < chunk_sizze_48529; i_48751++) {\n                if (slt32(sext_i64_i32(i_48751), stopping_point_48750 - 1)) {\n                    eta_p_48730 = private_mem_48590[i_48751];\n                    eta_p_48731 = private_mem_48592[i_48751];\n                    eta_p_48732 = private_mem_48594[i_48751];\n                    eta_p_48733 = private_mem_48596[i_48751];\n                    \n                    int16_t defunc_0_op_res_48734 = add16(eta_p_48726, eta_p_48730);\n                    int16_t defunc_0_op_res_48735 = add16(eta_p_48727, eta_p_48731);\n                    int16_t defunc", "_0_op_res_48736 = add16(eta_p_48728, eta_p_48732);\n                    int16_t defunc_0_op_res_48737 = add16(eta_p_48729, eta_p_48733);\n                    \n                    private_mem_48590[i_48751] = defunc_0_op_res_48734;\n                    private_mem_48592[i_48751] = defunc_0_op_res_48735;\n                    private_mem_48594[i_48751] = defunc_0_op_res_48736;\n                    private_mem_48596[i_48751] = defunc_0_op_res_48737;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48752 = 0; i_48752 < chunk_sizze_48529; i_48752++) {\n                int64_t sharedIdx_48753 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48752;\n                int16_t tmp_48754 = private_mem_48590[i_48752];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48753] = tmp_48754;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48755 = 0; i_48755 < chunk_sizze_48529; i_48755++) {\n                int64_t flat_idx_48756 = thd_offset_48598 + i_48755 * segscan_tblock_sizze_45708;\n                int64_t slice_48757 = i16_res_43225;\n                int64_t slice_48758 = n_blocks_43229 * slice_48757;\n                int64_t gtid_45716 = squot64(flat_idx_48756, slice_48757);\n                int64_t remnant_48759 = flat_idx_48756 - gtid_45716 * slice_48757;\n                int64_t gtid_45717 = remnant_48759;\n                int64_t remnant_48760 = remnant_48759 - gtid_45717;\n                \n                if (slt64(flat_idx_48756, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48761 = ((__local int16_t *) local_mem_48566)[flat_idx_48756 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47889)[gtid_45716 * i16_res_43225 + gtid_45717] = tmp_48761;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i",
                                    "_48762 = 0; i_48762 < chunk_sizze_48529; i_48762++) {\n                int64_t sharedIdx_48763 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48762;\n                int16_t tmp_48764 = private_mem_48592[i_48762];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48763] = tmp_48764;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48765 = 0; i_48765 < chunk_sizze_48529; i_48765++) {\n                int64_t flat_idx_48766 = thd_offset_48598 + i_48765 * segscan_tblock_sizze_45708;\n                int64_t slice_48767 = i16_res_43225;\n                int64_t slice_48768 = n_blocks_43229 * slice_48767;\n                int64_t gtid_45716 = squot64(flat_idx_48766, slice_48767);\n                int64_t remnant_48769 = flat_idx_48766 - gtid_45716 * slice_48767;\n                int64_t gtid_45717 = remnant_48769;\n                int64_t remnant_48770 = remnant_48769 - gtid_45717;\n                \n                if (slt64(flat_idx_48766, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48771 = ((__local int16_t *) local_mem_48566)[flat_idx_48766 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47892)[gtid_45716 * i16_res_43225 + gtid_45717] = tmp_48771;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48772 = 0; i_48772 < chunk_sizze_48529; i_48772++) {\n                int64_t sharedIdx_48773 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48772;\n                int16_t tmp_48774 = private_mem_48594[i_48772];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48773] = tmp_48774;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48775 = 0; i_48775 < chunk_sizze_48529; i_48775++) {\n                int64_t flat_idx_48776 = thd_offset_48598 + i_48775 * segscan_tblock_sizze_45708;\n                int64_t slice_48777 = i16_res_43225", ";\n                int64_t slice_48778 = n_blocks_43229 * slice_48777;\n                int64_t gtid_45716 = squot64(flat_idx_48776, slice_48777);\n                int64_t remnant_48779 = flat_idx_48776 - gtid_45716 * slice_48777;\n                int64_t gtid_45717 = remnant_48779;\n                int64_t remnant_48780 = remnant_48779 - gtid_45717;\n                \n                if (slt64(flat_idx_48776, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48781 = ((__local int16_t *) local_mem_48566)[flat_idx_48776 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47895)[gtid_45716 * i16_res_43225 + gtid_45717] = tmp_48781;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48782 = 0; i_48782 < chunk_sizze_48529; i_48782++) {\n                int64_t sharedIdx_48783 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48782;\n                int16_t tmp_48784 = private_mem_48596[i_48782];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48783] = tmp_48784;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48785 = 0; i_48785 < chunk_sizze_48529; i_48785++) {\n                int64_t flat_idx_48786 = thd_offset_48598 + i_48785 * segscan_tblock_sizze_45708;\n                int64_t slice_48787 = i16_res_43225;\n                int64_t slice_48788 = n_blocks_43229 * slice_48787;\n                int64_t gtid_45716 = squot64(flat_idx_48786, slice_48787);\n                int64_t remnant_48789 = flat_idx_48786 - gtid_45716 * slice_48787;\n                int64_t gtid_45717 = remnant_48789;\n                int64_t remnant_48790 = remnant_48789 - gtid_45717;\n                \n                if (slt64(flat_idx_48786, n_blocks_43229 * i16_res_43225)) {\n                    int16_t tmp_48791 = ((__local int16_t *) local_mem_48566)[flat_idx_48786 - block_offset_48586];\n                    \n                    ((__glob", "al int16_t *) mem_47898)[gtid_45716 * i16_res_43225 + gtid_45717] = tmp_48791;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45708\n    #undef chunk_sizze_48529\n}\nFUTHARK_KERNEL_SIZED(sortColumn_floatzisegscan_45850_dim1, 1, 1)\nvoid sortColumn_floatzisegscan_45850(__global int *global_failure, int64_t n_blocks_43229, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, int64_t num_tblocks_45847, int64_t num_virt_blocks_48874, int64_t num_virt_threads_48875, __global unsigned char *ext_mem_47981, __global unsigned char *mem_47989, __global unsigned char *mem_47992, __global unsigned char *status_flags_mem_48876, __global unsigned char *aggregates_mem_48878, __global unsigned char *incprefixes_mem_48880, __global unsigned char *global_dynid_mem_48882)\n{\n    #define segscan_tblock_sizze_45845 (sortColumn_floatzisegscan_45850zisegscan_tblock_sizze_45845)\n    #define chunk_sizze_48873 (sortColumn_floatzisegscan_45850zichunk_sizze_48873)\n    \n    volatile __local unsigned char *local_mem_48892_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48892_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45845), chunk_sizze_48873 * segscan_tblock_sizze_45845 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45845), chunk_sizze_48873 * segscan_tblock_sizze_45845 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48885;\n    int32_t tblock_sizze_48888;\n    int32_t wave_sizze_48887;\n    int32_t block_id_48886;\n    int32_t global_tid_48884;\n    int64_t phys_tid_45850;\n    int32_t chunk_sizze_32b_48889;\n    int64_t byte_offsets_48890;\n    int64_t warp_byte_offset_48891;\n    __local unsigned char *local_mem_48892;\n    int64_t trans_arr_len_48893;\n    int64_t",
                                    " phys_block_id_48899;\n    int64_t virtloop_bound_48900;\n    \n    local_tid_48885 = get_local_id(0);\n    tblock_sizze_48888 = get_local_size(0);\n    wave_sizze_48887 = LOCKSTEP_WIDTH;\n    block_id_48886 = get_tblock_id(0);\n    global_tid_48884 = block_id_48886 * tblock_sizze_48888 + local_tid_48885;\n    phys_tid_45850 = sext_i32_i64(global_tid_48884);\n    chunk_sizze_32b_48889 = sext_i64_i32(chunk_sizze_48873);\n    byte_offsets_48890 = segscan_tblock_sizze_45845 * (int64_t) 8;\n    warp_byte_offset_48891 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48892 = (__local unsigned char *) local_mem_48892_backing_0;\n    trans_arr_len_48893 = chunk_sizze_48873 * segscan_tblock_sizze_45845;\n    phys_block_id_48899 = get_tblock_id(0);\n    virtloop_bound_48900 = sdiv_up64(num_virt_blocks_48874 - phys_block_id_48899, num_tblocks_45847);\n    for (int64_t virtloop_i_48901 = 0; virtloop_i_48901 < virtloop_bound_48900; virtloop_i_48901++) {\n        int64_t dynamic_id_48902;\n        int64_t block_offset_48903;\n        int64_t sgm_idx_48904;\n        int32_t boundary_48905;\n        int32_t segsizze_compact_48906;\n        int64_t private_mem_48907[chunk_sizze_48873];\n        int64_t thd_offset_48909;\n        int64_t acc_48925;\n        int64_t prefix_48935;\n        bool block_new_sgm_48936;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48885 == 0) {\n                dynamic_id_48902 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48882)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 0] = dynamic_id_48902;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48902 == num_virt_blocks_48874 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_4", "8882)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48902 = ((__local int32_t *) local_mem_48892)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48903 = dynamic_id_48902 * chunk_sizze_48873 * segscan_tblock_sizze_45845;\n        sgm_idx_48904 = smod64(block_offset_48903, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);\n        boundary_48905 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_45845, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240 - sgm_idx_48904));\n        segsizze_compact_48906 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_45845, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240));\n        thd_offset_48909 = block_offset_48903 + sext_i32_i64(local_tid_48885);\n        // Load and map\n        {\n            for (int64_t i_48910 = 0; i_48910 < chunk_sizze_48873; i_48910++) {\n                int64_t virt_tid_48911 = thd_offset_48909 + i_48910 * segscan_tblock_sizze_45845;\n                int64_t slice_48912 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240;\n                int64_t gtid_45849 = virt_tid_48911;\n                int64_t remnant_48913 = virt_tid_48911 - gtid_45849;\n                \n                if (slt64(virt_tid_48911, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n                    int64_t new_index_46940 = squot64(gtid_45849, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);\n                    int64_t binop_y_46942 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 * new_index_46940;\n                    int64_t new_index_46943 = gtid_45849 - binop_y_46942;\n                    bool index_concat_cmp_46945 = sle64(n_blocks_43229, new_index_46943);\n                    int64_t index_concat_branch_46949;\n                    \n                    if (index_concat_cmp_46945) {\n                        int64_t index_concat_46947 = ((__global int64_t *) mem_47989)[new_index_46940];\n     ", "                   \n                        index_concat_branch_46949 = index_concat_46947;\n                    } else {\n                        int64_t index_concat_46948 = ((__global int64_t *) ext_mem_47981)[new_index_46943 * (int64_t) 4 + new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46948;\n                    }\n                    private_mem_48907[i_48910] = index_concat_branch_46949;\n                } else {\n                    private_mem_48907[i_48910] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48914 = 0; i_48914 < chunk_sizze_48873; i_48914++) {\n                int64_t sharedIdx_48915 = sext_i32_i64(local_tid_48885) + i_48914 * segscan_tblock_sizze_45845;\n                int64_t tmp_48916 = private_mem_48907[i_48914];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48915] = tmp_48916;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48917 = 0; i_48917 < chunk_sizze_48873; i_48917++) {\n                int64_t sharedIdx_48918 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48917;\n                int64_t tmp_48919 = ((__local int64_t *) local_mem_48892)[sharedIdx_48918];\n                \n                private_mem_48907[i_48917] = tmp_48919;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48920 = 0; i_48920 < chunk_sizze_48873 - (int64_t) 1; i_48920++) {\n                int64_t eta_p_43481;\n                int64_t eta_p_43482;\n                \n                eta_p_43481 = private_mem_48907[i_48920];\n                eta_p_43482 = private_mem_48907[i_48920 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_43483 = add64(eta_p_43481, eta_p_43482);\n                \n                private_mem_48907[i_4892",
                                    "0 + (int64_t) 1] = defunc_0_op_res_43483;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_48921 = private_mem_48907[chunk_sizze_48873 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = tmp_48921;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_48922;\n            int64_t eta_p_48923;\n            int64_t eta_p_48926;\n            int64_t eta_p_48927;\n            bool ltid_in_bounds_48929 = slt64(sext_i32_i64(local_tid_48885), num_virt_threads_48875);\n            int32_t skip_threads_48930;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48929) {\n                    eta_p_48923 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                    if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                        eta_p_48922 = eta_p_48923;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48930 = 1;\n                while (slt32(skip_threads_48930, 32)) {\n                    bool thread_active_48931 = sle32(skip_threads_48930, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && ltid_in_bounds_48929;\n                    \n                    if (thread_active_48931) {\n                        // read operands\n                        {\n                            eta_p_48922 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48930)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48931) {\n                            int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                          ", "  \n                            eta_p_48922 = defunc_0_op_res_48924;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48931) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                            eta_p_48923 = eta_p_48922;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48930 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 31 && ltid_in_bounds_48929) {\n                    ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32))] = eta_p_48922;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48932;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                        eta_p_48927 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                        if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                            eta_p_48926 = eta_p_48927;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n           ", "         skip_threads_48932 = 1;\n                    while (slt32(skip_threads_48932, 32)) {\n                        bool thread_active_48933 = sle32(skip_threads_48932, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929);\n                        \n                        if (thread_active_48933) {\n                            // read operands\n                            {\n                                eta_p_48926 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48932)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48933) {\n                                int64_t defunc_0_op_res_48928 = add64(eta_p_48926, eta_p_48927);\n                                \n                                eta_p_48926 = defunc_0_op_res_48928;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48933) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48926;\n                                eta_p_48927 = eta_p_48926;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48932 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48934 = squot32(local_tid_48885, 32) == 0 || !ltid_in_bounds_48929;\n            \n            //",
                                    " carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48934) {\n                        eta_p_48923 = eta_p_48922;\n                        eta_p_48922 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48934) {\n                        int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                        \n                        eta_p_48922 = defunc_0_op_res_48924;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48934) {\n                        ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                    ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48923;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48885 == 0) {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[segscan_tblock_sizze_45845 - (int64_t) 1];\n            } else {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48935 = (int64_t) 0;\n        block_new_sgm_48936 = sgm_idx_48904 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48936 && local_tid_48885 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_489", "02] = acc_48925;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                acc_48925 = (int64_t) 0;\n            }\n            if (!block_new_sgm_48936 && slt32(local_tid_48885, wave_sizze_48887)) {\n                if (local_tid_48885 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_48878)[dynamic_id_48902] = acc_48925;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 1;\n                    \n                    int8_t tmp_48937 = ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48892)[(int64_t) 0] = tmp_48937;\n                }\n                mem_fence_local();\n                \n                int8_t status_48938 = ((__local int8_t *) local_mem_48892)[(int64_t) 0];\n                \n                if (status_48938 == (int8_t) 2) {\n                    if (local_tid_48885 == 0) {\n                        prefix_48935 = ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48939 = sext_i64_i32(dynamic_id_48902 - sext_i32_i64(wave_sizze_48887));\n                    \n                    while (slt32(wave_sizze_48887 * -1, readOffset_48939)) {\n                        int32_t read_i_48940 = readOffset_48939 + local_tid_48885;\n                        int64_t aggr_48941 = (int64_t) 0;\n                        int8_t flag_48942 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48940)) {\n                            flag_48942 = ((volatile __global int8_t *) status_flags_mem_48876)[sext_i32_i64(read_i_48940)];\n                            if (flag_48942 == (int8_t) 2) {\n                                agg", "r_48941 = ((volatile __global int64_t *) incprefixes_mem_48880)[sext_i32_i64(read_i_48940)];\n                            } else if (flag_48942 == (int8_t) 1) {\n                                aggr_48941 = ((volatile __global int64_t *) aggregates_mem_48878)[sext_i32_i64(read_i_48940)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = aggr_48941;\n                        ((__local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flag_48942;\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        if (slt8(flag_48942, (int8_t) 2)) {\n                            int8_t flg_x_48946;\n                            int8_t flg_y_48947;\n                            int64_t eta_p_48943;\n                            int64_t eta_p_48944;\n                            int32_t skip_threads_48948;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48947 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                                eta_p_48944 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)];\n                                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                                    eta_p_48943 = eta_p_48944;\n                                    flg_x_48946 = flg_y_48947;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48948 = 1;\n                                while (slt32(skip_threads_48948, 32)) {\n                                    if (sle32(skip_threads_48948, local_tid_48885 - squot32(loc",
                                    "al_tid_48885, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48946 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948)];\n                                            eta_p_48943 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48947 == (int8_t) 2 || flg_y_48947 == (int8_t) 0) {\n                                                flg_x_48946 = flg_y_48947;\n                                                eta_p_48943 = eta_p_48944;\n                                            } else {\n                                                int64_t defunc_0_op_res_48945 = add64(eta_p_48943, eta_p_48944);\n                                                \n                                                eta_p_48943 = defunc_0_op_res_48945;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flg_x_48946;\n                                            flg_y_48947 = flg_x_48946;\n                                            ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = eta_p_48943;\n                                            eta_p_48944 = eta_p_48943;\n                                        }\n                                    }\n                                    skip_threads_48948 *= 2;\n                                }\n                        ", "    }\n                        }\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        aggr_48941 = ((__local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(wave_sizze_48887) - (int64_t) 1)];\n                        if (flag_48942 == (int8_t) 2) {\n                            readOffset_48939 = wave_sizze_48887 * -1;\n                        } else if (flag_48942 == (int8_t) 1) {\n                            readOffset_48939 -= wave_sizze_48887;\n                        }\n                        if (slt8((int8_t) 0, flag_48942)) {\n                            int64_t eta_p_48949 = aggr_48941;\n                            int64_t eta_p_48950 = prefix_48935;\n                            int64_t defunc_0_op_res_48951 = add64(eta_p_48949, eta_p_48950);\n                            \n                            prefix_48935 = defunc_0_op_res_48951;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48885 == 0) {\n                    if (boundary_48905 == sext_i64_i32(segscan_tblock_sizze_45845 * chunk_sizze_48873)) {\n                        int64_t eta_p_48952 = prefix_48935;\n                        int64_t eta_p_48953 = acc_48925;\n                        int64_t defunc_0_op_res_48954 = add64(eta_p_48952, eta_p_48953);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = defunc_0_op_res_48954;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 4] = prefix_48935;\n                    acc_48925 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_48902 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n   ", "             prefix_48935 = ((__local int64_t *) local_mem_48892)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_48955;\n            int64_t eta_p_48956;\n            int64_t eta_p_48958 = prefix_48935;\n            int64_t eta_p_48959 = acc_48925;\n            \n            if (slt32(local_tid_48885 * chunk_sizze_32b_48889, boundary_48905) && !block_new_sgm_48936) {\n                int64_t defunc_0_op_res_48960 = add64(eta_p_48958, eta_p_48959);\n                \n                eta_p_48955 = defunc_0_op_res_48960;\n            } else {\n                eta_p_48955 = acc_48925;\n            }\n            \n            int32_t stopping_point_48961 = segsizze_compact_48906 - srem32(local_tid_48885 * chunk_sizze_32b_48889 - 1 + segsizze_compact_48906 - boundary_48905, segsizze_compact_48906);\n            \n            for (int64_t i_48962 = 0; i_48962 < chunk_sizze_48873; i_48962++) {\n                if (slt32(sext_i64_i32(i_48962), stopping_point_48961 - 1)) {\n                    eta_p_48956 = private_mem_48907[i_48962];\n                    \n                    int64_t defunc_0_op_res_48957 = add64(eta_p_48955, eta_p_48956);\n                    \n                    private_mem_48907[i_48962] = defunc_0_op_res_48957;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48963 = 0; i_48963 < chunk_sizze_48873; i_48963++) {\n                int64_t sharedIdx_48964 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48963;\n                int64_t tmp_48965 = private_mem_48907[i_48963];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48964] = tmp_48965;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48966 = 0; i_48966 < chunk_sizze_48873; i_48966++) {\n                int64_t flat_idx_48967 = thd_offset_4",
                                    "8909 + i_48966 * segscan_tblock_sizze_45845;\n                int64_t slice_48968 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240;\n                int64_t gtid_45849 = flat_idx_48967;\n                int64_t remnant_48969 = flat_idx_48967 - gtid_45849;\n                \n                if (slt64(flat_idx_48967, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {\n                    int64_t tmp_48970 = ((__local int64_t *) local_mem_48892)[flat_idx_48967 - block_offset_48903];\n                    \n                    ((__global int64_t *) mem_47992)[gtid_45849] = tmp_48970;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45845\n    #undef chunk_sizze_48873\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzigpuseq_48446_dim1, 1, 1)\nvoid sortColumn_intzigpuseq_48446(__global int *global_failure, int64_t m_41736, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47866, __global unsigned char *mem_47867, __global unsigned char *mem_47868, __global unsigned char *mem_47869)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48448;\n    int32_t tblock_sizze_48451;\n    int32_t wave_sizze_48450;\n    int32_t block_id_48449;\n    int32_t global_tid_48447;\n    int64_t tid_48446;\n    int16_t last_res_47806;\n    int16_t last_res_47808;\n    int16_t last_res_47810;\n    int16_t last_res_47812;\n    \n    local_tid_48448 = get_local_id(0);\n    tblock_sizze_48451 = get_local_size(0);\n    wave_sizze_48450 = LOCKSTEP_WIDTH;\n    block_id_48449 = get_tblock_id(0);\n    global_tid_48447 = block_id_48449 * tblock_sizze_48451 + local_tid_48448;\n    tid_48446 = sext_i32_i64(global_tid_48447);\n    last_res_47806 = ((__global int16_t *) mem_47857)[m_41736];\n    last_res_47808 = ((__global int16_t *) mem_47859)[m_41736];\n    last_res_47810 = ((__global int16_t", " *) mem_47861)[m_41736];\n    last_res_47812 = ((__global int16_t *) mem_47863)[m_41736];\n    ((__global int16_t *) mem_47866)[(int64_t) 0] = last_res_47806;\n    ((__global int16_t *) mem_47867)[(int64_t) 0] = last_res_47808;\n    ((__global int16_t *) mem_47868)[(int64_t) 0] = last_res_47810;\n    ((__global int16_t *) mem_47869)[(int64_t) 0] = last_res_47812;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzigpuseq_48854_dim1, 1, 1)\nvoid sortColumn_intzigpuseq_48854(__global int *global_failure, __global unsigned char *ext_mem_47871, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47984, __global unsigned char *mem_47985, __global unsigned char *mem_47986, __global unsigned char *mem_47987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48856;\n    int32_t tblock_sizze_48859;\n    int32_t wave_sizze_48858;\n    int32_t block_id_48857;\n    int32_t global_tid_48855;\n    int64_t tid_48854;\n    int16_t defunc_0_radix_sort_step_i16_res_47825;\n    int16_t defunc_0_radix_sort_step_i16_res_47826;\n    int16_t defunc_0_radix_sort_step_i16_res_47827;\n    int16_t defunc_0_radix_sort_step_i16_res_47828;\n    int16_t tmp_47833;\n    int16_t tmp_47837;\n    \n    local_tid_48856 = get_local_id(0);\n    tblock_sizze_48859 = get_local_size(0);\n    wave_sizze_48858 = LOCKSTEP_WIDTH;\n    block_id_48857 = get_tblock_id(0);\n    global_tid_48855 = block_id_48857 * tblock_sizze_48859 + local_tid_48856;\n    tid_48854 = sext_i32_i64(global_tid_48855);\n    defunc_0_radix_sort_step_i16_res_47825 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47826 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47827 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47828 = ((__global int16_t *) ext_mem_47871)[(int64_t) 0];\n    ((__global int16_t *) mem_47", "984)[(int64_t) 0] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47984)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47826;\n    ((__global int16_t *) mem_47984)[(int64_t) 2] = defunc_0_radix_sort_step_i16_res_47827;\n    ((__global int16_t *) mem_47984)[(int64_t) 3] = defunc_0_radix_sort_step_i16_res_47828;\n    tmp_47833 = add16(defunc_0_radix_sort_step_i16_res_47825, defunc_0_radix_sort_step_i16_res_47826);\n    tmp_47837 = add16(defunc_0_radix_sort_step_i16_res_47827, tmp_47833);\n    ((__global int16_t *) mem_47985)[(int64_t) 0] = (int16_t) 0;\n    ((__global int16_t *) mem_47985)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47985)[(int64_t) 2] = tmp_47833;\n    ((__global int16_t *) mem_47985)[(int64_t) 3] = tmp_47837;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47986)[i_0] = ((__global int16_t *) mem_47984)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47987)[i_0] = ((__global int16_t *) mem_47985)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46444_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46444(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int64_t num_tblocks_46449, int32_t virt_num_tblocks_48452, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47876, __global unsigned char *mem_47878)\n{\n    #define segmap_tblock_sizze_46447 (sortColumn_intzisegmap_46444zisegmap_tblock_sizze_46447)\n    \n    volatile __local int local_failure;\n    \n    // Harm",
                                    "less for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48454;\n    int32_t tblock_sizze_48457;\n    int32_t wave_sizze_48456;\n    int32_t block_id_48455;\n    int32_t global_tid_48453;\n    int64_t phys_tid_46444;\n    int32_t phys_tblock_id_48458;\n    int32_t iterations_48459;\n    \n    local_tid_48454 = get_local_id(0);\n    tblock_sizze_48457 = get_local_size(0);\n    wave_sizze_48456 = LOCKSTEP_WIDTH;\n    block_id_48455 = get_tblock_id(0);\n    global_tid_48453 = block_id_48455 * tblock_sizze_48457 + local_tid_48454;\n    phys_tid_46444 = sext_i32_i64(global_tid_48453);\n    phys_tblock_id_48458 = get_tblock_id(0);\n    iterations_48459 = sdiv_up32(virt_num_tblocks_48452 - phys_tblock_id_48458, sext_i64_i32(num_tblocks_46449));\n    for (int32_t i_48460 = 0; i_48460 < iterations_48459; i_48460++) {\n        int32_t virt_tblock_id_48461;\n        int64_t global_tid_48462;\n        int64_t slice_48463;\n        int64_t write_i_46443;\n        int64_t remnant_48464;\n        \n        virt_tblock_id_48461 = phys_tblock_id_48458 + i_48460 * sext_i64_i32(num_tblocks_46449);\n        global_tid_48462 = sext_i32_i64(virt_tblock_id_48461) * segmap_tblock_sizze_46447 + sext_i32_i64(local_tid_48454);\n        slice_48463 = rest_41713;\n        write_i_46443 = global_tid_48462;\n        remnant_48464 = global_tid_48462 - write_i_46443;\n        if (slt64(write_i_46443, rest_41713)) {\n            int16_t defunc_0_radix_sort_step_i16_res_47822;\n            int16_t defunc_0_radix_sort_step_i16_res_47823;\n            int16_t defunc_0_radix_sort_step_i16_res_47824;\n            int16_t eta_p_43646;\n            int16_t eta_p_43647;\n            int16_t eta_p_43648;\n            int16_t eta_p_43649;\n            int16_t eta_p_43650;\n            int64_t slice_46965;\n            int32_t write_value_43651;\n            int64_t write_value_43652;\n            int64_t defunc_0_f_res_43653;\n            \n            defunc_0_radix_sort_step_i16_res_47822 = ((__global int16_t *) ext_mem_", "47874)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47823 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47824 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n            eta_p_43646 = ((__global int16_t *) mem_47865)[write_i_46443];\n            eta_p_43647 = ((__global int16_t *) mem_47857)[write_i_46443];\n            eta_p_43648 = ((__global int16_t *) mem_47859)[write_i_46443];\n            eta_p_43649 = ((__global int16_t *) mem_47861)[write_i_46443];\n            eta_p_43650 = ((__global int16_t *) mem_47863)[write_i_46443];\n            slice_46965 = arg_41714 + write_i_46443;\n            write_value_43651 = ((__global int32_t *) mem_47846)[slice_46965];\n            write_value_43652 = ((__global int64_t *) mem_47848)[slice_46965];\n            futrts_lifted_f_7536(&defunc_0_f_res_43653, defunc_0_radix_sort_step_i16_res_47822, defunc_0_radix_sort_step_i16_res_47823, defunc_0_radix_sort_step_i16_res_47824, eta_p_43646, eta_p_43647, eta_p_43648, eta_p_43649, eta_p_43650);\n            if (sle64((int64_t) 0, defunc_0_f_res_43653) && slt64(defunc_0_f_res_43653, rest_41713)) {\n                ((__global int32_t *) mem_47878)[defunc_0_f_res_43653] = write_value_43651;\n            }\n            if (sle64((int64_t) 0, defunc_0_f_res_43653) && slt64(defunc_0_f_res_43653, rest_41713)) {\n                ((__global int64_t *) mem_47876)[defunc_0_f_res_43653] = write_value_43652;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46447\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46466_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46466(__global int *global_failure, __global unsigned char *mem_47986, __global unsigned char *mem_47989)\n{\n    #define segmap_tblock_sizze_46462 (sortColumn_intzisegmap_46466zisegmap_tblock_sizze_46462)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48862;\n    int", "32_t tblock_sizze_48865;\n    int32_t wave_sizze_48864;\n    int32_t block_id_48863;\n    int32_t global_tid_48861;\n    int64_t phys_tid_46466;\n    int64_t global_tid_48866;\n    int64_t slice_48867;\n    int64_t gtid_46465;\n    int64_t remnant_48868;\n    \n    local_tid_48862 = get_local_id(0);\n    tblock_sizze_48865 = get_local_size(0);\n    wave_sizze_48864 = LOCKSTEP_WIDTH;\n    block_id_48863 = get_tblock_id(0);\n    global_tid_48861 = block_id_48863 * tblock_sizze_48865 + local_tid_48862;\n    phys_tid_46466 = sext_i32_i64(global_tid_48861);\n    global_tid_48866 = sext_i32_i64(block_id_48863) * segmap_tblock_sizze_46462 + sext_i32_i64(local_tid_48862);\n    slice_48867 = (int64_t) 4;\n    gtid_46465 = global_tid_48866;\n    remnant_48868 = global_tid_48866 - gtid_46465;\n    if (slt64(gtid_46465, (int64_t) 4)) {\n        int16_t eta_p_46467;\n        int64_t i16_res_46468;\n        \n        eta_p_46467 = ((__global int16_t *) mem_47986)[gtid_46465];\n        i16_res_46468 = sext_i16_i64(eta_p_46467);\n        ((__global int64_t *) mem_47989)[gtid_46465] = i16_res_46468;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46462\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46779_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46779(__global int *global_failure, int64_t i16_res_41708, unsigned char zzero_41709_bits, unsigned char nonzzero_41710_bits, int64_t n_blocks_41712, int64_t tmp_41751, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    bool zzero_41709 = zzero_41709_bits;\n    bool nonzzero_41710 = nonzzero_41710_bits;\n    \n    #define segmap_tblock_sizze_46772 (sortColumn_intzisegmap_46779zisegmap_tblock_sizze_46772)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48794;\n    int32_t tblock_sizze_48797;\n    int32_t",
                                    " wave_sizze_48796;\n    int32_t block_id_48795;\n    int32_t global_tid_48793;\n    int64_t phys_tid_46779;\n    int64_t global_tid_48798;\n    int64_t slice_48799;\n    int64_t gtid_46778;\n    int64_t remnant_48800;\n    \n    local_tid_48794 = get_local_id(0);\n    tblock_sizze_48797 = get_local_size(0);\n    wave_sizze_48796 = LOCKSTEP_WIDTH;\n    block_id_48795 = get_tblock_id(0);\n    global_tid_48793 = block_id_48795 * tblock_sizze_48797 + local_tid_48794;\n    phys_tid_46779 = sext_i32_i64(global_tid_48793);\n    global_tid_48798 = sext_i32_i64(block_id_48795) * segmap_tblock_sizze_46772 + sext_i32_i64(local_tid_48794);\n    slice_48799 = n_blocks_41712;\n    gtid_46778 = global_tid_48798;\n    remnant_48800 = global_tid_48798 - gtid_46778;\n    if (slt64(gtid_46778, n_blocks_41712)) {\n        int16_t last_res_46788;\n        int16_t last_res_46789;\n        int16_t last_res_46790;\n        int16_t last_res_46791;\n        int16_t defunc_0_f_res_46784;\n        int16_t defunc_0_f_res_46785;\n        int16_t defunc_0_f_res_46786;\n        int16_t defunc_0_f_res_46787;\n        \n        if (nonzzero_41710) {\n            int16_t x_46956 = ((__global int16_t *) mem_47889)[gtid_46778 * i16_res_41708 + tmp_41751];\n            \n            last_res_46788 = x_46956;\n        } else {\n            last_res_46788 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46958 = ((__global int16_t *) mem_47892)[gtid_46778 * i16_res_41708 + tmp_41751];\n            \n            last_res_46789 = x_46958;\n        } else {\n            last_res_46789 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46960 = ((__global int16_t *) mem_47895)[gtid_46778 * i16_res_41708 + tmp_41751];\n            \n            last_res_46790 = x_46960;\n        } else {\n            last_res_46790 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46962 = ((__global int16_t *) mem_47898)[gtid_46778 * i16_res_41708 + tmp_41751];\n            \n            last", "_res_46791 = x_46962;\n        } else {\n            last_res_46791 = (int16_t) 0;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_46784 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46784 = last_res_46788;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_46785 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46785 = last_res_46789;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_46786 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46786 = last_res_46790;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_46787 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_46787 = last_res_46791;\n        }\n        ((__global int16_t *) mem_47904)[gtid_46778] = defunc_0_f_res_46787;\n        ((__global int16_t *) mem_47906)[gtid_46778] = defunc_0_f_res_46784;\n        ((__global int16_t *) mem_47908)[gtid_46778] = defunc_0_f_res_46785;\n        ((__global int16_t *) mem_47910)[gtid_46778] = defunc_0_f_res_46786;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46772\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46801_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46801(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t num_tblocks_46795, int32_t virt_num_tblocks_48801, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47882, __global unsigned char *mem_47885, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    #define segmap_tblock_sizze_46794 (sortColumn_intzisegmap_46801zisegmap_tblock_sizze_46794)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    ", "local_failure = 0;\n    \n    int32_t local_tid_48803;\n    int32_t tblock_sizze_48806;\n    int32_t wave_sizze_48805;\n    int32_t block_id_48804;\n    int32_t global_tid_48802;\n    int64_t phys_tid_46801;\n    int32_t phys_tblock_id_48807;\n    int32_t iterations_48808;\n    \n    local_tid_48803 = get_local_id(0);\n    tblock_sizze_48806 = get_local_size(0);\n    wave_sizze_48805 = LOCKSTEP_WIDTH;\n    block_id_48804 = get_tblock_id(0);\n    global_tid_48802 = block_id_48804 * tblock_sizze_48806 + local_tid_48803;\n    phys_tid_46801 = sext_i32_i64(global_tid_48802);\n    phys_tblock_id_48807 = get_tblock_id(0);\n    iterations_48808 = sdiv_up32(virt_num_tblocks_48801 - phys_tblock_id_48807, sext_i64_i32(num_tblocks_46795));\n    for (int32_t i_48809 = 0; i_48809 < iterations_48808; i_48809++) {\n        int32_t virt_tblock_id_48810;\n        int64_t global_tid_48811;\n        int64_t slice_48812;\n        int64_t slice_48813;\n        int64_t gtid_46799;\n        int64_t remnant_48814;\n        int64_t gtid_46800;\n        int64_t remnant_48815;\n        \n        virt_tblock_id_48810 = phys_tblock_id_48807 + i_48809 * sext_i64_i32(num_tblocks_46795);\n        global_tid_48811 = sext_i32_i64(virt_tblock_id_48810) * segmap_tblock_sizze_46794 + sext_i32_i64(local_tid_48803);\n        slice_48812 = i16_res_41708;\n        slice_48813 = n_blocks_41712 * slice_48812;\n        gtid_46799 = squot64(global_tid_48811, slice_48812);\n        remnant_48814 = global_tid_48811 - gtid_46799 * slice_48812;\n        gtid_46800 = remnant_48814;\n        remnant_48815 = remnant_48814 - gtid_46800;\n        if (slt64(gtid_46799, n_blocks_41712) && slt64(gtid_46800, i16_res_41708)) {\n            int16_t defunc_0_f_res_46802;\n            int16_t defunc_0_f_res_46803;\n            int16_t defunc_0_f_res_46804;\n            int16_t eta_p_46805;\n            int16_t eta_p_46806;\n            int16_t eta_p_46807;\n            int16_t eta_p_46808;\n            int16_t eta_p_46809;\n            int64_t binop_x_46950;\n            i",
                                    "nt64_t new_index_46951;\n            int32_t write_value_46810;\n            int64_t write_value_46811;\n            int64_t defunc_0_f_res_46812;\n            \n            defunc_0_f_res_46802 = ((__global int16_t *) mem_47906)[gtid_46799];\n            defunc_0_f_res_46803 = ((__global int16_t *) mem_47908)[gtid_46799];\n            defunc_0_f_res_46804 = ((__global int16_t *) mem_47910)[gtid_46799];\n            eta_p_46805 = ((__global int16_t *) mem_47901)[gtid_46799 * i16_res_41708 + gtid_46800];\n            eta_p_46806 = ((__global int16_t *) mem_47889)[gtid_46799 * i16_res_41708 + gtid_46800];\n            eta_p_46807 = ((__global int16_t *) mem_47892)[gtid_46799 * i16_res_41708 + gtid_46800];\n            eta_p_46808 = ((__global int16_t *) mem_47895)[gtid_46799 * i16_res_41708 + gtid_46800];\n            eta_p_46809 = ((__global int16_t *) mem_47898)[gtid_46799 * i16_res_41708 + gtid_46800];\n            binop_x_46950 = i16_res_41708 * gtid_46799;\n            new_index_46951 = gtid_46800 + binop_x_46950;\n            write_value_46810 = ((__global int32_t *) mem_47846)[new_index_46951];\n            write_value_46811 = ((__global int64_t *) mem_47848)[new_index_46951];\n            futrts_lifted_f_7536(&defunc_0_f_res_46812, defunc_0_f_res_46802, defunc_0_f_res_46803, defunc_0_f_res_46804, eta_p_46805, eta_p_46806, eta_p_46807, eta_p_46808, eta_p_46809);\n            if ((sle64((int64_t) 0, gtid_46799) && slt64(gtid_46799, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_46812) && slt64(defunc_0_f_res_46812, i16_res_41708))) {\n                ((__global int32_t *) mem_47882)[gtid_46799 * i16_res_41708 + defunc_0_f_res_46812] = write_value_46810;\n            }\n            if ((sle64((int64_t) 0, gtid_46799) && slt64(gtid_46799, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_46812) && slt64(defunc_0_f_res_46812, i16_res_41708))) {\n                ((__global int64_t *) mem_47885)[gtid_46799 * i16_res_41708 + defunc_0_f_res_46812] = write_value_46811;\n         ", "   }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46794\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46819_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46819(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_46815, int32_t virt_num_tblocks_48816, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47927)\n{\n    #define segmap_tblock_sizze_46814 (sortColumn_intzisegmap_46819zisegmap_tblock_sizze_46814)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48818;\n    int32_t tblock_sizze_48821;\n    int32_t wave_sizze_48820;\n    int32_t block_id_48819;\n    int32_t global_tid_48817;\n    int64_t phys_tid_46819;\n    int32_t phys_tblock_id_48822;\n    int32_t iterations_48823;\n    \n    local_tid_48818 = get_local_id(0);\n    tblock_sizze_48821 = get_local_size(0);\n    wave_sizze_48820 = LOCKSTEP_WIDTH;\n    block_id_48819 = get_tblock_id(0);\n    global_tid_48817 = block_id_48819 * tblock_sizze_48821 + local_tid_48818;\n    phys_tid_46819 = sext_i32_i64(global_tid_48817);\n    phys_tblock_id_48822 = get_tblock_id(0);\n    iterations_48823 = sdiv_up32(virt_num_tblocks_48816 - phys_tblock_id_48822, sext_i64_i32(num_tblocks_46815));\n    for (int32_t i_48824 = 0; i_48824 < iterations_48823; i_48824++) {\n        int32_t virt_tblock_id_48825;\n        int64_t global_tid_48826;\n        int64_t slice_48827;\n        int64_t gtid_46818;\n        int64_t remnant_48828;\n        \n        virt_tblock_id_48825 = phys_tblock_id_48822 + i_48824 * sext_i64_i32(num_tblocks_46815);\n        global_tid_48826 = sext_i32_i64(virt_tblock_id_48825) * segmap_tblock_sizze_46814 + sext_i32_i64(local_tid_48818);\n        slice_48827 = n_blocks_41712;\n        gtid_46818 = global_tid_48826;\n        remnant_48828 = global_tid_48826 - gtid_46818;\n        if (slt64(gtid_46818,", " n_blocks_41712)) {\n            int16_t defunc_0_f_res_46820;\n            int16_t defunc_0_f_res_46821;\n            int16_t defunc_0_f_res_46822;\n            int16_t defunc_0_f_res_46823;\n            int16_t mem_47917[(int64_t) 4];\n            \n            defunc_0_f_res_46820 = ((__global int16_t *) mem_47906)[gtid_46818];\n            defunc_0_f_res_46821 = ((__global int16_t *) mem_47908)[gtid_46818];\n            defunc_0_f_res_46822 = ((__global int16_t *) mem_47910)[gtid_46818];\n            defunc_0_f_res_46823 = ((__global int16_t *) mem_47904)[gtid_46818];\n            mem_47917[(int64_t) 0] = defunc_0_f_res_46820;\n            mem_47917[(int64_t) 1] = defunc_0_f_res_46821;\n            mem_47917[(int64_t) 2] = defunc_0_f_res_46822;\n            mem_47917[(int64_t) 3] = defunc_0_f_res_46823;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47927)[gtid_46818 + i_0 * n_blocks_41712] = mem_47917[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46814\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46836_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46836(__global int *global_failure, int64_t n_blocks_41712, __global unsigned char *mem_47927, __global unsigned char *mem_47931)\n{\n    #define segmap_tblock_sizze_46831 (sortColumn_intzisegmap_46836zisegmap_tblock_sizze_46831)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48831;\n    int32_t tblock_sizze_48834;\n    int32_t wave_sizze_48833;\n    int32_t block_id_48832;\n    int32_t global_tid_48830;\n    int64_t phys_tid_46836;\n    int64_t global_tid_48835;\n    int64_t slice_48836;\n    int64_t slice_48837;\n    int64_t gtid_46834;\n    int64_t remnant_48838;\n    int64_t gtid_46835;\n    int64_t remnant_48839;\n    \n    local_tid_48831 = get_local_id(0);\n    tblock_sizze_48834 = get_local_size(0);\n    wave_sizze_48833 = LOCKSTEP_WIDTH;\n    block_id_48832",
                                    " = get_tblock_id(0);\n    global_tid_48830 = block_id_48832 * tblock_sizze_48834 + local_tid_48831;\n    phys_tid_46836 = sext_i32_i64(global_tid_48830);\n    global_tid_48835 = sext_i32_i64(block_id_48832) * segmap_tblock_sizze_46831 + sext_i32_i64(local_tid_48831);\n    slice_48836 = (int64_t) 4;\n    slice_48837 = n_blocks_41712 * slice_48836;\n    gtid_46834 = squot64(global_tid_48835, slice_48836);\n    remnant_48838 = global_tid_48835 - gtid_46834 * slice_48836;\n    gtid_46835 = remnant_48838;\n    remnant_48839 = remnant_48838 - gtid_46835;\n    if (slt64(gtid_46834, n_blocks_41712) && slt64(gtid_46835, (int64_t) 4)) {\n        int16_t eta_p_46837;\n        int64_t i16_res_46838;\n        \n        eta_p_46837 = ((__global int16_t *) mem_47927)[gtid_46834 + gtid_46835 * n_blocks_41712];\n        i16_res_46838 = sext_i16_i64(eta_p_46837);\n        ((__global int64_t *) mem_47931)[gtid_46834 * (int64_t) 4 + gtid_46835] = i16_res_46838;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46831\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46846_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46846(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_46842, int32_t virt_num_tblocks_48840, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47947)\n{\n    #define segmap_tblock_sizze_46841 (sortColumn_intzisegmap_46846zisegmap_tblock_sizze_46841)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48842;\n    int32_t tblock_sizze_48845;\n    int32_t wave_sizze_48844;\n    int32_t block_id_48843;\n    int32_t global_tid_48841;\n    int64_t phys_tid_46846;\n    int32_t phys_tblock_id_48846;\n    int32_t iterations_48847;\n    \n    local_tid_48842 = get_local_id(0);\n    tblock_sizze_48845 = get_local_size(0);\n    wave_sizze_48844 = LOCKSTEP_WIDTH;\n    block_id_48843 = get_tblock_id(0);\n    global_tid_48841 = block_id_48843 * tblock_sizze_48845 + local_tid_48842;\n    ", "phys_tid_46846 = sext_i32_i64(global_tid_48841);\n    phys_tblock_id_48846 = get_tblock_id(0);\n    iterations_48847 = sdiv_up32(virt_num_tblocks_48840 - phys_tblock_id_48846, sext_i64_i32(num_tblocks_46842));\n    for (int32_t i_48848 = 0; i_48848 < iterations_48847; i_48848++) {\n        int32_t virt_tblock_id_48849;\n        int64_t global_tid_48850;\n        int64_t slice_48851;\n        int64_t gtid_46845;\n        int64_t remnant_48852;\n        \n        virt_tblock_id_48849 = phys_tblock_id_48846 + i_48848 * sext_i64_i32(num_tblocks_46842);\n        global_tid_48850 = sext_i32_i64(virt_tblock_id_48849) * segmap_tblock_sizze_46841 + sext_i32_i64(local_tid_48842);\n        slice_48851 = n_blocks_41712;\n        gtid_46845 = global_tid_48850;\n        remnant_48852 = global_tid_48850 - gtid_46845;\n        if (slt64(gtid_46845, n_blocks_41712)) {\n            int16_t defunc_0_f_res_46847;\n            int16_t defunc_0_f_res_46848;\n            int16_t defunc_0_f_res_46849;\n            int16_t tmp_46850;\n            int16_t tmp_46851;\n            int16_t mem_47937[(int64_t) 4];\n            \n            defunc_0_f_res_46847 = ((__global int16_t *) mem_47906)[gtid_46845];\n            defunc_0_f_res_46848 = ((__global int16_t *) mem_47908)[gtid_46845];\n            defunc_0_f_res_46849 = ((__global int16_t *) mem_47910)[gtid_46845];\n            tmp_46850 = add16(defunc_0_f_res_46847, defunc_0_f_res_46848);\n            tmp_46851 = add16(defunc_0_f_res_46849, tmp_46850);\n            mem_47937[(int64_t) 0] = (int16_t) 0;\n            mem_47937[(int64_t) 1] = defunc_0_f_res_46847;\n            mem_47937[(int64_t) 2] = tmp_46850;\n            mem_47937[(int64_t) 3] = tmp_46851;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47947)[gtid_46845 + i_0 * n_blocks_41712] = mem_47937[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46841", "\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46882_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46882(__global int *global_failure, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, __global unsigned char *mem_47992, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_46878 (sortColumn_intzisegmap_46882zisegmap_tblock_sizze_46878)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48973;\n    int32_t tblock_sizze_48976;\n    int32_t wave_sizze_48975;\n    int32_t block_id_48974;\n    int32_t global_tid_48972;\n    int64_t phys_tid_46882;\n    int64_t global_tid_48977;\n    int64_t slice_48978;\n    int64_t gtid_46881;\n    int64_t remnant_48979;\n    \n    local_tid_48973 = get_local_id(0);\n    tblock_sizze_48976 = get_local_size(0);\n    wave_sizze_48975 = LOCKSTEP_WIDTH;\n    block_id_48974 = get_tblock_id(0);\n    global_tid_48972 = block_id_48974 * tblock_sizze_48976 + local_tid_48973;\n    phys_tid_46882 = sext_i32_i64(global_tid_48972);\n    global_tid_48977 = sext_i32_i64(block_id_48974) * segmap_tblock_sizze_46878 + sext_i32_i64(local_tid_48973);\n    slice_48978 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n    gtid_46881 = global_tid_48977;\n    remnant_48979 = global_tid_48977 - gtid_46881;\n    if (slt64(gtid_46881, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n        int64_t zv_lhs_46884;\n        int64_t tmp_46885;\n        int64_t lifted_lambda_res_46886;\n        \n        zv_lhs_46884 = add64((int64_t) -1, gtid_46881);\n        tmp_46885 = smod64(zv_lhs_46884, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        lifted_lambda_res_46886 = ((__global int64_t *) mem_47992)[tmp_46885];\n        ((__global int64_t *) mem_47995)[gtid_46881] = lifted_lambda_res_46886;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46878\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46888_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46888(__global int *global_failure, int failure_is_an_option, __glo",
                                    "bal int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t arg_41714, int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int32_t blocked_radix_sort_step_arg1_41776, int64_t num_tblocks_46893, int64_t ext_47978, int64_t ext_47979, int32_t virt_num_tblocks_48980, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47876, __global unsigned char *mem_47878, __global unsigned char *ext_mem_47980, __global unsigned char *ext_mem_47982, __global unsigned char *ext_mem_47983, __global unsigned char *mem_47987, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_46891 (sortColumn_intzisegmap_46888zisegmap_tblock_sizze_46891)\n    \n    volatile __local int local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = 0;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t local_tid_48982;\n    int32_t tblock_sizze_48985;\n    int32_t wave_sizze_48984;\n    int32_t block_id_48983;\n    int32_t global_tid_48981;\n    int64_t phys_tid_46888;\n    int32_t phys_tblock_id_48986;\n    int32_t iterations_48987;\n    \n    local_tid_48982 = get_local_id(0);\n    tblock_sizze_48985 = get_local_size(0);\n    wave_sizze_48984 = LOCKSTEP_WIDTH;\n    block_id_48983 = get_tblock_id(0);\n    global_tid_48981 = block_id_48983 * tblock_sizze_48985 + local_tid_48982;\n    phys_tid_46888 = sext_i32_i64(global_tid_48981);\n    phys_tblock_id_48986 = get_tblock_id(0);\n    iterations_48987 = sdiv_up32(virt_num_tblocks_48980 - phys_tblock_id_48986, sext_i64_i32(num_tblocks_46893));\n    for (int32_t i_48988 = 0; i_48988 < iterations_48987; i_48988++) {\n        int32_t virt_tblock_id_48989;\n        int64_t global_tid_48990;\n        int64_t slice_48991;\n        int64_t write_i_46887;\n        int64_t remnant_48992;\n        \n        virt_tblock_id_48989 ", "= phys_tblock_id_48986 + i_48988 * sext_i64_i32(num_tblocks_46893);\n        global_tid_48990 = sext_i32_i64(virt_tblock_id_48989) * segmap_tblock_sizze_46891 + sext_i32_i64(local_tid_48982);\n        slice_48991 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;\n        write_i_46887 = global_tid_48990;\n        remnant_48992 = global_tid_48990 - write_i_46887;\n        if (slt64(write_i_46887, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n            bool index_concat_cmp_46931;\n            int32_t index_concat_branch_43604;\n            int32_t zlzb_rhs_43611;\n            int32_t acc_43613;\n            int64_t i32_res_43622;\n            int64_t block_idx_43623;\n            bool x_43624;\n            bool y_43625;\n            bool bounds_check_43626;\n            bool index_certs_43627;\n            bool x_43628;\n            bool y_43629;\n            bool bounds_check_43630;\n            bool index_certs_43631;\n            int32_t index_concat_branch_46935;\n            int64_t index_concat_branch_46929;\n            int64_t binop_x_43632;\n            int64_t new_index_43633;\n            int64_t new_offset_43634;\n            bool index_concat_cmp_43635;\n            int16_t index_concat_branch_43636;\n            int64_t i16_res_43639;\n            int64_t zp_lhs_43640;\n            int64_t old_offset_43641;\n            int64_t zp_lhs_43642;\n            int64_t idx_43643;\n            \n            index_concat_cmp_46931 = sle64(arg_41714, write_i_46887);\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_43799;\n                int32_t index_concat_43800;\n                \n                index_concat_i_43799 = sub64(write_i_46887, arg_41714);\n                index_concat_43800 = ((__global int32_t *) mem_47878)[index_concat_i_43799];\n                index_concat_branch_43604 = index_concat_43800;\n            } else {\n                int64_t new_index_43607;\n                int64_t binop_y_43608;\n        ", "        int64_t new_index_43609;\n                int32_t index_concat_43610;\n                \n                new_index_43607 = squot64(write_i_46887, i16_res_41708);\n                binop_y_43608 = i16_res_41708 * new_index_43607;\n                new_index_43609 = write_i_46887 - binop_y_43608;\n                index_concat_43610 = ((__global int32_t *) ext_mem_47983)[new_index_43607 * i16_res_41708 + new_index_43609];\n                index_concat_branch_43604 = index_concat_43610;\n            }\n            acc_43613 = 0;\n            for (int32_t i_43612 = 0; i_43612 < 2; i_43612++) {\n                int32_t get_bit_arg0_43614;\n                int32_t zgzg_res_43615;\n                int32_t za_res_43616;\n                bool cond_43617;\n                int32_t defunc_0_get_bit_res_43618;\n                int32_t zp_rhs_43620;\n                int32_t loopres_43621;\n                int32_t acc_tmp_48993;\n                \n                get_bit_arg0_43614 = add32(blocked_radix_sort_step_arg1_41776, i_43612);\n                zgzg_res_43615 = ashr32(index_concat_branch_43604, get_bit_arg0_43614);\n                za_res_43616 = 1 & zgzg_res_43615;\n                cond_43617 = get_bit_arg0_43614 == 31;\n                if (cond_43617) {\n                    int32_t defunc_0_get_bit_res_t_res_43801 = 1 ^ za_res_43616;\n                    \n                    defunc_0_get_bit_res_43618 = defunc_0_get_bit_res_t_res_43801;\n                } else {\n                    defunc_0_get_bit_res_43618 = za_res_43616;\n                }\n                zp_rhs_43620 = shl32(defunc_0_get_bit_res_43618, i_43612);\n                loopres_43621 = add32(acc_43613, zp_rhs_43620);\n                acc_tmp_48993 = loopres_43621;\n                acc_43613 = acc_tmp_48993;\n            }\n            zlzb_rhs_43611 = acc_43613;\n            i32_res_43622 = sext_i32_i64(zlzb_rhs_43611);\n            block_idx_43623 = sdiv64(write_i_46887, i16_res_41708);\n            x_43624 = sle64((int64_t) 0, block_idx_",
                                    "43623);\n            y_43625 = slt64(block_idx_43623, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n            bounds_check_43626 = x_43624 && y_43625;\n            if (!bounds_check_43626) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 15) == -1) {\n                        global_failure_args[0] = (int64_t) block_idx_43623;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_43628 = sle64((int64_t) 0, i32_res_43622);\n            y_43629 = slt64(i32_res_43622, (int64_t) 4);\n            bounds_check_43630 = x_43628 && y_43629;\n            if (!bounds_check_43630) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 16) == -1) {\n                        global_failure_args[0] = (int64_t) i32_res_43622;\n                        global_failure_args[1] = (int64_t) (int64_t) 4;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46932;\n                int32_t index_concat_46933;\n                \n                index_concat_i_46932 = sub64(write_i_46887, arg_41714);\n                index_concat_46933 = ((__global int32_t *) mem_47878)[index_concat_i_46932];\n                index_concat_branch_46935 = index_concat_46933;\n            } else {\n                int64_t new_index_46972;\n                int64_t binop_y_46974;\n                int64_t new_index_46975;\n                int32_t index_concat_46934;\n                \n                new_index_46972 = squot64(write_i_46887, i16_res_41708);\n                binop_y_46974 = i16_res_41708 * new_index_46972;\n                new_index_46975 = write_i_46887 - binop_y_46974;\n ", "               index_concat_46934 = ((__global int32_t *) ext_mem_47983)[new_index_46972 * i16_res_41708 + new_index_46975];\n                index_concat_branch_46935 = index_concat_46934;\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46926;\n                int64_t index_concat_46927;\n                \n                index_concat_i_46926 = sub64(write_i_46887, arg_41714);\n                index_concat_46927 = ((__global int64_t *) mem_47876)[index_concat_i_46926];\n                index_concat_branch_46929 = index_concat_46927;\n            } else {\n                int64_t new_index_46968;\n                int64_t binop_y_46970;\n                int64_t new_index_46971;\n                int64_t index_concat_46928;\n                \n                new_index_46968 = squot64(write_i_46887, i16_res_41708);\n                binop_y_46970 = i16_res_41708 * new_index_46968;\n                new_index_46971 = write_i_46887 - binop_y_46970;\n                index_concat_46928 = ((__global int64_t *) ext_mem_47982)[new_index_46968 * i16_res_41708 + new_index_46971];\n                index_concat_branch_46929 = index_concat_46928;\n            }\n            binop_x_43632 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * i32_res_43622;\n            new_index_43633 = block_idx_43623 + binop_x_43632;\n            new_offset_43634 = ((__global int64_t *) mem_47995)[new_index_43633];\n            index_concat_cmp_43635 = sle64(n_blocks_41712, block_idx_43623);\n            if (index_concat_cmp_43635) {\n                int16_t index_concat_43802 = ((__global int16_t *) mem_47987)[i32_res_43622];\n                \n                index_concat_branch_43636 = index_concat_43802;\n            } else {\n                int16_t index_concat_43638 = ((__global int16_t *) ext_mem_47980)[block_idx_43623 * ext_47979 + i32_res_43622 * ext_47978];\n                \n                index_concat_branch_43636 = index_concat_43638;\n            }\n            i16_res_43639 = sext_", "i16_i64(index_concat_branch_43636);\n            zp_lhs_43640 = mul64(i16_res_41708, block_idx_43623);\n            old_offset_43641 = add64(i16_res_43639, zp_lhs_43640);\n            zp_lhs_43642 = sub64(write_i_46887, old_offset_43641);\n            idx_43643 = add64(new_offset_43634, zp_lhs_43642);\n            if (sle64((int64_t) 0, idx_43643) && slt64(idx_43643, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int32_t *) mem_47846)[idx_43643] = index_concat_branch_46935;\n            }\n            if (sle64((int64_t) 0, idx_43643) && slt64(idx_43643, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int64_t *) mem_47848)[idx_43643] = index_concat_branch_46929;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_46891\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegmap_46916_dim1, 1, 1)\nvoid sortColumn_intzisegmap_46916(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_27501, int64_t incr_27502, __global unsigned char *xs_mem_47844, __global unsigned char *mem_47848, __global unsigned char *mem_48005, __global unsigned char *mem_48007)\n{\n    #define segmap_tblock_sizze_46911 (sortColumn_intzisegmap_46916zisegmap_tblock_sizze_46911)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48996;\n    int32_t tblock_sizze_48999;\n    int32_t wave_sizze_48998;\n    int32_t block_id_48997;\n    int32_t global_tid_48995;\n    int64_t phys_tid_46916;\n    int64_t global_tid_49000;\n    int64_t slice_49001;\n    int64_t gtid_46915;\n    int64_t remnant_49002;\n    \n    local_tid_48996 = get_local_id(0);\n    tblock_sizze_48999 = get_local_size(0);\n    wave_sizze_48998 = LOCKSTEP_WIDTH;\n    block_i",
                                    "d_48997 = get_tblock_id(0);\n    global_tid_48995 = block_id_48997 * tblock_sizze_48999 + local_tid_48996;\n    phys_tid_46916 = sext_i32_i64(global_tid_48995);\n    global_tid_49000 = sext_i32_i64(block_id_48997) * segmap_tblock_sizze_46911 + sext_i32_i64(local_tid_48996);\n    slice_49001 = n_27501;\n    gtid_46915 = global_tid_49000;\n    remnant_49002 = global_tid_49000 - gtid_46915;\n    if (slt64(gtid_46915, n_27501)) {\n        int64_t eta_p_46917;\n        bool x_46918;\n        bool y_46919;\n        bool bounds_check_46920;\n        bool index_certs_46921;\n        int64_t index_primexp_46922;\n        int32_t lifted_lambda_res_46923;\n        \n        eta_p_46917 = ((__global int64_t *) mem_47848)[gtid_46915];\n        x_46918 = sle64((int64_t) 0, eta_p_46917);\n        y_46919 = slt64(eta_p_46917, n_27501);\n        bounds_check_46920 = x_46918 && y_46919;\n        if (!bounds_check_46920) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 17) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_46917;\n                    global_failure_args[1] = (int64_t) n_27501;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_46922 = add64(incr_27502, eta_p_46917);\n        lifted_lambda_res_46923 = ((__global int32_t *) xs_mem_47844)[eta_p_46917];\n        ((__global int64_t *) mem_48005)[gtid_46915] = index_primexp_46922;\n        ((__global int32_t *) mem_48007)[gtid_46915] = lifted_lambda_res_46923;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_46911\n}\nFUTHARK_KERNEL\nvoid sortColumn_intzisegmap_intrablock_46498(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, unsigned char zzero_41709_bits, int64_t n_blocks_41712, int64_t tmp_41751, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t computed_tblock_siz", "ze_46471, int64_t bytes_47949, int64_t bytes_47951, int64_t bytes_47953, int64_t maxSubHelper_48094, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47968, __global unsigned char *mem_47971, __global unsigned char *mem_47974, __global unsigned char *mem_47977)\n{\n    bool zzero_41709 = zzero_41709_bits;\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    volatile __local unsigned char *color_48102_backing_7 = &shared_mem[0];\n    const int64_t color_48102_backing_7_offset = 0 + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48101_backing_6 = &shared_mem[color_48102_backing_7_offset];\n    const int64_t color_48101_backing_6_offset = color_48102_backing_7_offset + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48100_backing_5 = &shared_mem[color_48101_backing_6_offset];\n    const int64_t color_48100_backing_5_offset = color_48101_backing_6_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48099_backing_4 = &shared_mem[color_48100_backing_5_offset];\n    const int64_t color_48099_backing_4_offset = color_48100_backing_5_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_3 = &shared_mem[color_48099_backing_4_offset];\n    const int64_t color_48098_backing_3_offset = color_48099_backing_4_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48097_backing_2 = &shared_mem[color_48098_backing_3_offset];\n    const int64_t color_48097_backing_2_offset = color_48098_backing_3_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile _", "_local unsigned char *color_48096_backing_1 = &shared_mem[color_48097_backing_2_offset];\n    const int64_t color_48096_backing_1_offset = color_48097_backing_2_offset + (int64_t) 32;\n    volatile __local unsigned char *color_48095_backing_0 = &shared_mem[color_48096_backing_1_offset];\n    const int64_t color_48095_backing_0_offset = color_48096_backing_1_offset + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48469;\n    int32_t tblock_sizze_48472;\n    int32_t wave_sizze_48471;\n    int32_t block_id_48470;\n    int32_t global_tid_48468;\n    int64_t phys_tblock_id_46498;\n    int64_t slice_48474;\n    int64_t ltid_pre_48473;\n    int64_t remnant_48475;\n    int64_t slice_48477;\n    int64_t ltid_pre_48476;\n    int64_t remnant_48478;\n    int64_t slice_48479;\n    int64_t gtid_46497;\n    int64_t remnant_48480;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    __local unsigned char *color_48100;\n    __local unsigned char *color_48101;\n    __local unsigned char *color_48102;\n    int32_t num_chunks_48481;\n    int32_t num_chunks_48484;\n    int64_t binop_x_46980;\n    int64_t phys_tid_46513;\n    int64_t gtid_46512;\n    int64_t dims_flat_48487;\n    int16_t eta_p_46514;\n    int16_t eta_p_46515;\n    int16_t eta_p_46516;\n    int16_t eta_p_46517;\n    int16_t eta_p_46518;\n    int16_t eta_p_46519;\n    int16_t eta_p_46520;\n    int16_t eta_p_46521;\n    int16_t eta_p_48492;\n    int16_t eta_p_48493;\n    int16_t eta_p_48494;\n    int16_t eta_p_48495;\n    int16_t eta_p_48496;\n    int16_t eta_p_48497;\n    int16_t eta_p_48498;\n    int16_t eta_p_48499;\n    bool ltid_in_bounds_48504;\n    int32_t skip_threads_48505;\n    bool no_carry_in_48511;\n    int16_t defun",
                                    "c_0_f_res_46542;\n    int16_t defunc_0_f_res_46543;\n    int16_t defunc_0_f_res_46544;\n    int16_t defunc_0_f_res_46545;\n    int64_t phys_tid_46553;\n    int64_t write_i_46552;\n    int64_t phys_tid_46565;\n    int64_t gtid_46564;\n    int16_t tmp_46568;\n    int16_t tmp_46569;\n    int32_t num_chunks_48513;\n    int32_t num_chunks_48516;\n    int32_t num_chunks_48519;\n    int32_t num_chunks_48522;\n    \n    local_tid_48469 = get_local_id(0);\n    tblock_sizze_48472 = get_local_size(0);\n    wave_sizze_48471 = LOCKSTEP_WIDTH;\n    block_id_48470 = get_tblock_id(0);\n    global_tid_48468 = block_id_48470 * tblock_sizze_48472 + local_tid_48469;\n    phys_tblock_id_46498 = sext_i32_i64(block_id_48470);\n    slice_48474 = (int64_t) 4;\n    ltid_pre_48473 = sext_i32_i64(local_tid_48469);\n    remnant_48475 = sext_i32_i64(local_tid_48469) - ltid_pre_48473;\n    slice_48477 = i16_res_41708;\n    ltid_pre_48476 = sext_i32_i64(local_tid_48469);\n    remnant_48478 = sext_i32_i64(local_tid_48469) - ltid_pre_48476;\n    slice_48479 = n_blocks_41712;\n    gtid_46497 = sext_i32_i64(block_id_48470);\n    remnant_48480 = sext_i32_i64(block_id_48470) - gtid_46497;\n    color_48095 = (__local unsigned char *) color_48095_backing_0;\n    color_48096 = (__local unsigned char *) color_48096_backing_1;\n    color_48097 = (__local unsigned char *) color_48097_backing_2;\n    color_48098 = (__local unsigned char *) color_48098_backing_3;\n    color_48099 = (__local unsigned char *) color_48099_backing_4;\n    color_48100 = (__local unsigned char *) color_48100_backing_5;\n    color_48101 = (__local unsigned char *) color_48101_backing_6;\n    color_48102 = (__local unsigned char *) color_48102_backing_7;\n    num_chunks_48481 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48482 = 0; chunk_i_48482 < num_chunks_48481; chunk_i_48482++) {\n        int32_t i_48483 = chunk_i_48482 * sext_i64_i32(computed_tblock_sizze_46471) + local_tid_48469;\n        \n        if (slt3", "2(i_48483, sext_i64_i32(i16_res_41708))) {\n            ((__local int32_t *) color_48102)[sext_i32_i64(i_48483)] = ((__global int32_t *) mem_47846)[(int64_t) 0 + gtid_46497 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48483)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48484 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48485 = 0; chunk_i_48485 < num_chunks_48484; chunk_i_48485++) {\n        int32_t i_48486 = chunk_i_48485 * sext_i64_i32(computed_tblock_sizze_46471) + local_tid_48469;\n        \n        if (slt32(i_48486, sext_i64_i32(i16_res_41708))) {\n            ((__local int64_t *) color_48101)[sext_i32_i64(i_48486)] = ((__global int64_t *) mem_47848)[(int64_t) 0 + gtid_46497 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48486)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    binop_x_46980 = i16_res_41708 * gtid_46497;\n    phys_tid_46513 = sext_i32_i64(local_tid_48469);\n    gtid_46512 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(gtid_46512, i16_res_41708)) {\n        int64_t new_index_46981;\n        int32_t eta_p_46526;\n        int32_t zgzg_res_46527;\n        int32_t za_res_46528;\n        int32_t defunc_0_get_bit_res_46529;\n        int32_t zp_lhs_46531;\n        int32_t zgzg_res_46532;\n        int32_t za_res_46533;\n        int32_t defunc_0_get_bit_res_46534;\n        int32_t i32_arg0_46536;\n        int16_t i32_res_46537;\n        int16_t defunc_0_f_res_46538;\n        int16_t defunc_0_f_res_46539;\n        int16_t defunc_0_f_res_46540;\n        int16_t defunc_0_f_res_46541;\n        \n        new_index_46981 = gtid_46512 + binop_x_46980;\n        eta_p_46526 = ((__global int32_t *) mem_47846)[new_index_46981];\n        zgzg_res_46527 = ashr32(eta_p_46526, get_bit_arg0_41781);\n        za_res_46528 = 1 & zgzg_res_46527;\n        if (cond_41782) {\n            int32_t defunc_0_get_bit_res_t_res_46530 = 1 ^ za_res_46528;\n            \n            defunc_0_get_bit_res_465", "29 = defunc_0_get_bit_res_t_res_46530;\n        } else {\n            defunc_0_get_bit_res_46529 = za_res_46528;\n        }\n        zp_lhs_46531 = mul32(2, defunc_0_get_bit_res_46529);\n        zgzg_res_46532 = ashr32(eta_p_46526, blocked_radix_sort_step_arg1_41776);\n        za_res_46533 = 1 & zgzg_res_46532;\n        if (cond_41783) {\n            int32_t defunc_0_get_bit_res_t_res_46535 = 1 ^ za_res_46533;\n            \n            defunc_0_get_bit_res_46534 = defunc_0_get_bit_res_t_res_46535;\n        } else {\n            defunc_0_get_bit_res_46534 = za_res_46533;\n        }\n        i32_arg0_46536 = add32(zp_lhs_46531, defunc_0_get_bit_res_46534);\n        i32_res_46537 = sext_i32_i16(i32_arg0_46536);\n        futrts_lifted_lambda_7535(&defunc_0_f_res_46538, &defunc_0_f_res_46539, &defunc_0_f_res_46540, &defunc_0_f_res_46541, i32_res_46537);\n        ((__local int16_t *) color_48100)[gtid_46512] = defunc_0_f_res_46538;\n        ((__local int16_t *) color_48099)[gtid_46512] = defunc_0_f_res_46539;\n        ((__local int16_t *) color_48098)[gtid_46512] = defunc_0_f_res_46540;\n        ((__local int16_t *) color_48097)[gtid_46512] = defunc_0_f_res_46541;\n        ((__local int16_t *) color_48095)[gtid_46512] = i32_res_46537;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dims_flat_48487 = i16_res_41708;\n    ltid_in_bounds_48504 = slt64(sext_i32_i64(local_tid_48469), i16_res_41708);\n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_48504) {\n            eta_p_46518 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n            eta_p_46519 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n            eta_p_46520 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n            eta_p_46521 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n            if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                eta_p_46514 = eta_p_46518;\n           ",
                                    "     eta_p_46515 = eta_p_46519;\n                eta_p_46516 = eta_p_46520;\n                eta_p_46517 = eta_p_46521;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_48505 = 1;\n        while (slt32(skip_threads_48505, 32)) {\n            bool thread_active_48506 = sle32(skip_threads_48505, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && ltid_in_bounds_48504;\n            \n            if (thread_active_48506) {\n                // read operands\n                {\n                    eta_p_46514 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_46515 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_46516 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_46517 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                }\n            }\n            // perform operation\n            {\n                bool inactive_48507 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(local_tid_48469 - skip_threads_48505));\n                \n                if (thread_active_48506 && inactive_48507) {\n                    eta_p_46514 = eta_p_46518;\n                    eta_p_46515 = eta_p_46519;\n                    eta_p_46516 = eta_p_46520;\n                    eta_p_46517 = eta_p_46521;\n                }\n                if (thread_active_48506) {\n                    if (!inactive_48507) {\n                        int16_t defunc_0_op_res_46522 = add16(eta_p_46514, eta_p_46518);\n                        int16_t defunc_0_op_res_46523 = add16(eta_p_46515, eta_p_46519);\n                        int16_t defunc_0_op_res_46524 = add16(eta_p_46516, eta_p_4", "6520);\n                        int16_t defunc_0_op_res_46525 = add16(eta_p_46517, eta_p_46521);\n                        \n                        eta_p_46514 = defunc_0_op_res_46522;\n                        eta_p_46515 = defunc_0_op_res_46523;\n                        eta_p_46516 = defunc_0_op_res_46524;\n                        eta_p_46517 = defunc_0_op_res_46525;\n                    }\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (thread_active_48506) {\n                // write result\n                {\n                    ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_46514;\n                    eta_p_46518 = eta_p_46514;\n                    ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_46515;\n                    eta_p_46519 = eta_p_46515;\n                    ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_46516;\n                    eta_p_46520 = eta_p_46516;\n                    ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_46517;\n                    eta_p_46521 = eta_p_46517;\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_48505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 31 && ltid_in_bounds_48504) {\n            ((volatile __local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_46514;\n            ((volatile __local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_46515;\n            ((volatile __local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p", "_46516;\n            ((volatile __local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_46517;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_48508;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n                eta_p_48496 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n                eta_p_48497 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n                eta_p_48498 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n                eta_p_48499 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n                if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                    eta_p_48492 = eta_p_48496;\n                    eta_p_48493 = eta_p_48497;\n                    eta_p_48494 = eta_p_48498;\n                    eta_p_48495 = eta_p_48499;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_48508 = 1;\n            while (slt32(skip_threads_48508, 32)) {\n                bool thread_active_48509 = sle32(skip_threads_48508, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504);\n                \n                if (thread_active_48509) {\n                    // read operands\n                    {\n                        eta_p_48492 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48493 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48494 = ((volatile __local int16_t *) color_480",
                                    "98)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48495 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48510 = slt64(srem64(sext_i32_i64(local_tid_48469 * 32 + 32 - 1), i16_res_41708), sext_i32_i64(local_tid_48469 * 32 + 32 - 1) - sext_i32_i64((local_tid_48469 - skip_threads_48508) * 32 + 32 - 1));\n                    \n                    if (thread_active_48509 && inactive_48510) {\n                        eta_p_48492 = eta_p_48496;\n                        eta_p_48493 = eta_p_48497;\n                        eta_p_48494 = eta_p_48498;\n                        eta_p_48495 = eta_p_48499;\n                    }\n                    if (thread_active_48509) {\n                        if (!inactive_48510) {\n                            int16_t defunc_0_op_res_48500 = add16(eta_p_48492, eta_p_48496);\n                            int16_t defunc_0_op_res_48501 = add16(eta_p_48493, eta_p_48497);\n                            int16_t defunc_0_op_res_48502 = add16(eta_p_48494, eta_p_48498);\n                            int16_t defunc_0_op_res_48503 = add16(eta_p_48495, eta_p_48499);\n                            \n                            eta_p_48492 = defunc_0_op_res_48500;\n                            eta_p_48493 = defunc_0_op_res_48501;\n                            eta_p_48494 = defunc_0_op_res_48502;\n                            eta_p_48495 = defunc_0_op_res_48503;\n                        }\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (thread_active_48509) {\n                    // write result\n                    {\n                        ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_", "tid_48469)] = eta_p_48492;\n                        eta_p_48496 = eta_p_48492;\n                        ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_48493;\n                        eta_p_48497 = eta_p_48493;\n                        ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_48494;\n                        eta_p_48498 = eta_p_48494;\n                        ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_48495;\n                        eta_p_48499 = eta_p_48495;\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_48508 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    no_carry_in_48511 = squot32(local_tid_48469, 32) == 0 || !ltid_in_bounds_48504;\n    // carry-in for every block except the first\n    {\n        // read operands\n        {\n            if (!no_carry_in_48511) {\n                eta_p_46518 = eta_p_46514;\n                eta_p_46519 = eta_p_46515;\n                eta_p_46520 = eta_p_46516;\n                eta_p_46521 = eta_p_46517;\n                eta_p_46514 = ((__local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_46515 = ((__local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_46516 = ((__local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_46517 = ((__local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n            }\n        }\n        // perform operation\n        {\n            bool inactive_48512 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(squot32(local_tid_48469, 32) * 32 - 1));\n            \n            if (!n", "o_carry_in_48511) {\n                if (inactive_48512) {\n                    eta_p_46514 = eta_p_46518;\n                    eta_p_46515 = eta_p_46519;\n                    eta_p_46516 = eta_p_46520;\n                    eta_p_46517 = eta_p_46521;\n                }\n            }\n            if (!no_carry_in_48511) {\n                if (!inactive_48512) {\n                    int16_t defunc_0_op_res_46522 = add16(eta_p_46514, eta_p_46518);\n                    int16_t defunc_0_op_res_46523 = add16(eta_p_46515, eta_p_46519);\n                    int16_t defunc_0_op_res_46524 = add16(eta_p_46516, eta_p_46520);\n                    int16_t defunc_0_op_res_46525 = add16(eta_p_46517, eta_p_46521);\n                    \n                    eta_p_46514 = defunc_0_op_res_46522;\n                    eta_p_46515 = defunc_0_op_res_46523;\n                    eta_p_46516 = defunc_0_op_res_46524;\n                    eta_p_46517 = defunc_0_op_res_46525;\n                }\n            }\n        }\n        // write final result\n        {\n            if (!no_carry_in_48511) {\n                ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_46514;\n                ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_46515;\n                ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_46516;\n                ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_46517;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n            ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_46518;\n            ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_46519;\n            ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_46520;\n            ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_46",
                                    "521;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (zzero_41709) {\n        defunc_0_f_res_46542 = (int16_t) 0;\n        defunc_0_f_res_46543 = (int16_t) 0;\n        defunc_0_f_res_46544 = (int16_t) 0;\n        defunc_0_f_res_46545 = (int16_t) 0;\n    } else {\n        int16_t last_res_46546;\n        int16_t last_res_46547;\n        int16_t last_res_46548;\n        int16_t last_res_46549;\n        \n        last_res_46546 = ((__local int16_t *) color_48100)[tmp_41751];\n        last_res_46547 = ((__local int16_t *) color_48099)[tmp_41751];\n        last_res_46548 = ((__local int16_t *) color_48098)[tmp_41751];\n        last_res_46549 = ((__local int16_t *) color_48097)[tmp_41751];\n        defunc_0_f_res_46542 = last_res_46546;\n        defunc_0_f_res_46543 = last_res_46547;\n        defunc_0_f_res_46544 = last_res_46548;\n        defunc_0_f_res_46545 = last_res_46549;\n    }\n    phys_tid_46553 = sext_i32_i64(local_tid_48469);\n    write_i_46552 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(write_i_46552, i16_res_41708)) {\n        int16_t eta_p_46554;\n        int16_t eta_p_46555;\n        int16_t eta_p_46556;\n        int16_t eta_p_46557;\n        int16_t eta_p_46558;\n        int64_t new_index_46977;\n        int32_t write_value_46559;\n        int64_t write_value_46560;\n        int64_t defunc_0_f_res_46561;\n        \n        eta_p_46554 = ((__local int16_t *) color_48095)[write_i_46552];\n        eta_p_46555 = ((__local int16_t *) color_48100)[write_i_46552];\n        eta_p_46556 = ((__local int16_t *) color_48099)[write_i_46552];\n        eta_p_46557 = ((__local int16_t *) color_48098)[write_i_46552];\n        eta_p_46558 = ((__local int16_t *) color_48097)[write_i_46552];\n        new_index_46977 = write_i_46552 + binop_x_46980;\n        write_value_46559 = ((__global int32_t *) mem_47846)[new_index_46977];\n        write_value_46560 = ((__global int64_t *) mem_47848)[new_index_46977];\n        futrts_lifted_f_7536(&defunc_0_f_res_46561,", " defunc_0_f_res_46542, defunc_0_f_res_46543, defunc_0_f_res_46544, eta_p_46554, eta_p_46555, eta_p_46556, eta_p_46557, eta_p_46558);\n        if (sle64((int64_t) 0, defunc_0_f_res_46561) && slt64(defunc_0_f_res_46561, i16_res_41708)) {\n            ((__local int32_t *) color_48102)[defunc_0_f_res_46561] = write_value_46559;\n        }\n        if (sle64((int64_t) 0, defunc_0_f_res_46561) && slt64(defunc_0_f_res_46561, i16_res_41708)) {\n            ((__local int64_t *) color_48101)[defunc_0_f_res_46561] = write_value_46560;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = defunc_0_f_res_46542;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_46543;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = defunc_0_f_res_46544;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = defunc_0_f_res_46545;\n    phys_tid_46565 = sext_i32_i64(local_tid_48469);\n    gtid_46564 = sext_i32_i64(sext_i64_i32(ltid_pre_48473));\n    if (slt64(gtid_46564, (int64_t) 4)) {\n        int16_t eta_p_46566;\n        int64_t i16_res_46567;\n        \n        eta_p_46566 = ((__local int16_t *) color_48095)[gtid_46564];\n        i16_res_46567 = sext_i16_i64(eta_p_46566);\n        ((__local int64_t *) color_48096)[gtid_46564] = i16_res_46567;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    tmp_46568 = add16(defunc_0_f_res_46542, defunc_0_f_res_46543);\n    tmp_46569 = add16(defunc_0_f_res_46544, tmp_46568);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = (int16_t) 0;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_46542;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = tmp_46568;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = tmp_46569;\n    num_chunks_48513 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48514 = 0; chunk_i_48514 < num_chunks_48513; chunk_i_48514++) {\n        int32_t i_48515 = chunk_i_48514 * sext_i64_i32(computed_tblock_sizze_46471)", " + local_tid_48469;\n        \n        if (slt32(i_48515, sext_i64_i32(i16_res_41708))) {\n            ((__global int32_t *) mem_47968)[gtid_46497 * i16_res_41708 + sext_i32_i64(i_48515)] = ((__local int32_t *) color_48102)[sext_i32_i64(i_48515)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48516 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48517 = 0; chunk_i_48517 < num_chunks_48516; chunk_i_48517++) {\n        int32_t i_48518 = chunk_i_48517 * sext_i64_i32(computed_tblock_sizze_46471) + local_tid_48469;\n        \n        if (slt32(i_48518, sext_i64_i32(i16_res_41708))) {\n            ((__global int64_t *) mem_47971)[gtid_46497 * i16_res_41708 + sext_i32_i64(i_48518)] = ((__local int64_t *) color_48101)[sext_i32_i64(i_48518)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48519 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48520 = 0; chunk_i_48520 < num_chunks_48519; chunk_i_48520++) {\n        int32_t i_48521 = chunk_i_48520 * sext_i64_i32(computed_tblock_sizze_46471) + local_tid_48469;\n        \n        if (slt32(i_48521, 4)) {\n            ((__global int64_t *) mem_47974)[gtid_46497 * (int64_t) 4 + sext_i32_i64(i_48521)] = ((__local int64_t *) color_48096)[sext_i32_i64(i_48521)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48522 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_46471));\n    for (int32_t chunk_i_48523 = 0; chunk_i_48523 < num_chunks_48522; chunk_i_48523++) {\n        int32_t i_48524 = chunk_i_48523 * sext_i64_i32(computed_tblock_sizze_46471) + local_tid_48469;\n        \n        if (slt32(i_48524, 4)) {\n            ((__global int16_t *) mem_47977)[gtid_46497 * (int64_t) 4 + sext_i32_i64(i_48524)] = ((__local int16_t *) color_48095)[sext_i32_i64(i_48524)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegscan_46442_dim1, 1, 1)\nv",
                                    "oid sortColumn_intzisegscan_46442(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_46439, int64_t num_virt_blocks_48139, int64_t num_virt_threads_48140, __global unsigned char *mem_47846, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *status_flags_mem_48141, __global unsigned char *aggregates_mem_48163, __global unsigned char *incprefixes_mem_48165, __global unsigned char *aggregates_mem_48167, __global unsigned char *incprefixes_mem_48169, __global unsigned char *aggregates_mem_48171, __global unsigned char *incprefixes_mem_48173, __global unsigned char *aggregates_mem_48175, __global unsigned char *incprefixes_mem_48177, __global unsigned char *global_dynid_mem_48179)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_46437 (sortColumn_intzisegscan_46442zisegscan_tblock_sizze_46437)\n    #define chunk_sizze_48138 (sortColumn_intzisegscan_46442zichunk_sizze_48138)\n    \n    volatile __local unsigned char *local_mem_48215_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48215_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2)", ", chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48202;\n    int32_t tblock_sizze_48205;\n    int32_t wave_sizze_48204;\n    int32_t block_id_48203;\n    int32_t global_tid_48201;\n    int64_t phys_tid_46442;\n    int32_t chunk_sizze_32b_48206;\n    int64_t byte_offsets_48207;\n    int64_t byte_offsets_48208;\n    int64_t byte_offsets_48209;\n    int64_t byte_offsets_48210;\n    int64_t warp_byte_offset_48211;\n    int64_t warp_byte_offset_48212;\n    int64_t warp_byte_offset_48213;\n    int64_t warp_byte_offset_48214;\n    __local unsigned char *local_mem_48215;\n    int64_t trans_arr_len_48216;\n    int64_t phys_block_id_48231;\n    int64_t virtloop_bound_48232;\n    \n    local_tid_48202 = get_local_id(0);\n    tblock_sizze_48205 = get_local_size(0);\n    wave_sizze_48204 = LOCKSTEP_WIDTH;\n    block_id_48203 = get_tblock_id(0);\n    global_tid_48201 = block_id_48203 * tblock_sizze_48205 + local_tid_48202;\n    phys_tid_46442 = sext_i32_i64(global_tid_48201);\n    chunk_sizze_32b_48206 = sext_i64_i32(chunk_sizze_48138);\n    byte_offsets_48207 = segscan_tblock_sizze_46437 * (int64_t) 2;\n    byte_offsets_48208 = sdiv_up64(byte_offsets_48207, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46437 * (i", "nt64_t) 2;\n    byte_offsets_48209 = sdiv_up64(byte_offsets_48208, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46437 * (int64_t) 2;\n    byte_offsets_48210 = sdiv_up64(byte_offsets_48209, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46437 * (int64_t) 2;\n    warp_byte_offset_48211 = (int64_t) 96;\n    warp_byte_offset_48212 = sdiv_up64(warp_byte_offset_48211, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48213 = sdiv_up64(warp_byte_offset_48212, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48214 = sdiv_up64(warp_byte_offset_48213, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48215 = (__local unsigned char *) local_mem_48215_backing_0;\n    trans_arr_len_48216 = chunk_sizze_48138 * segscan_tblock_sizze_46437;\n    phys_block_id_48231 = get_tblock_id(0);\n    virtloop_bound_48232 = sdiv_up64(num_virt_blocks_48139 - phys_block_id_48231, num_tblocks_46439);\n    for (int64_t virtloop_i_48233 = 0; virtloop_i_48233 < virtloop_bound_48232; virtloop_i_48233++) {\n        int64_t dynamic_id_48234;\n        int64_t block_offset_48235;\n        int64_t sgm_idx_48236;\n        int32_t boundary_48237;\n        int32_t segsizze_compact_48238;\n        int16_t private_mem_48239[chunk_sizze_48138];\n        int16_t private_mem_48241[chunk_sizze_48138];\n        int16_t private_mem_48243[chunk_sizze_48138];\n        int16_t private_mem_48245[chunk_sizze_48138];\n        int64_t thd_offset_48247;\n        int16_t acc_48293;\n        int16_t acc_48294;\n        int16_t acc_48295;\n        int16_t acc_48296;\n        int16_t prefix_48315;\n        int16_t prefix_48316;\n        int16_t prefix_48317;\n        int16_t prefix_48318;\n        bool block_new_sgm_48319;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48202 == 0) {\n                dynamic_id_48234 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48179)[(int64_t) 0], ",
                                    "(int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48215)[(int64_t) 0] = dynamic_id_48234;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48234 == num_virt_blocks_48139 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48179)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48234 = ((__local int32_t *) local_mem_48215)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48235 = dynamic_id_48234 * chunk_sizze_48138 * segscan_tblock_sizze_46437;\n        sgm_idx_48236 = smod64(block_offset_48235, rest_41713);\n        boundary_48237 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_46437, rest_41713 - sgm_idx_48236));\n        segsizze_compact_48238 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_46437, rest_41713));\n        thd_offset_48247 = block_offset_48235 + sext_i32_i64(local_tid_48202);\n        // Load and map\n        {\n            for (int64_t i_48248 = 0; i_48248 < chunk_sizze_48138; i_48248++) {\n                int64_t virt_tid_48249 = thd_offset_48247 + i_48248 * segscan_tblock_sizze_46437;\n                int64_t slice_48250 = rest_41713;\n                int64_t gtid_46441 = virt_tid_48249;\n                int64_t remnant_48251 = virt_tid_48249 - gtid_46441;\n                \n                if (slt64(virt_tid_48249, rest_41713)) {\n                    int64_t slice_46966 = arg_41714 + gtid_46441;\n                    int32_t eta_p_43669 = ((__global int32_t *) mem_47846)[slice_46966];\n                    int32_t zgzg_res_43670 = ashr32(eta_p_43669, get_bit_arg0_41781);\n                    int32_t za_res_43671 = 1 & zgzg_res_43670;\n                    int32_t defunc_0_get_bit_res_43672;\n                    \n         ", "           if (cond_41782) {\n                        int32_t defunc_0_get_bit_res_t_res_43787 = 1 ^ za_res_43671;\n                        \n                        defunc_0_get_bit_res_43672 = defunc_0_get_bit_res_t_res_43787;\n                    } else {\n                        defunc_0_get_bit_res_43672 = za_res_43671;\n                    }\n                    \n                    int32_t zp_lhs_43674 = mul32(2, defunc_0_get_bit_res_43672);\n                    int32_t zgzg_res_43675 = ashr32(eta_p_43669, blocked_radix_sort_step_arg1_41776);\n                    int32_t za_res_43676 = 1 & zgzg_res_43675;\n                    int32_t defunc_0_get_bit_res_43677;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_43788 = 1 ^ za_res_43676;\n                        \n                        defunc_0_get_bit_res_43677 = defunc_0_get_bit_res_t_res_43788;\n                    } else {\n                        defunc_0_get_bit_res_43677 = za_res_43676;\n                    }\n                    \n                    int32_t i32_arg0_43679 = add32(zp_lhs_43674, defunc_0_get_bit_res_43677);\n                    int16_t i32_res_43680 = sext_i32_i16(i32_arg0_43679);\n                    int16_t defunc_0_f_res_43682;\n                    int16_t defunc_0_f_res_43683;\n                    int16_t defunc_0_f_res_43684;\n                    int16_t defunc_0_f_res_43685;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_43682, &defunc_0_f_res_43683, &defunc_0_f_res_43684, &defunc_0_f_res_43685, i32_res_43680);\n                    ((__global int16_t *) mem_47865)[gtid_46441] = i32_res_43680;\n                    private_mem_48239[i_48248] = defunc_0_f_res_43682;\n                    private_mem_48241[i_48248] = defunc_0_f_res_43683;\n                    private_mem_48243[i_48248] = defunc_0_f_res_43684;\n                    private_mem_48245[i_48248] = defunc_0_f_res_43685;\n                } else {\n    ", "                private_mem_48239[i_48248] = (int16_t) 0;\n                    private_mem_48241[i_48248] = (int16_t) 0;\n                    private_mem_48243[i_48248] = (int16_t) 0;\n                    private_mem_48245[i_48248] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48252 = 0; i_48252 < chunk_sizze_48138; i_48252++) {\n                int64_t sharedIdx_48253 = sext_i32_i64(local_tid_48202) + i_48252 * segscan_tblock_sizze_46437;\n                int16_t tmp_48254 = private_mem_48239[i_48252];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48253] = tmp_48254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48255 = 0; i_48255 < chunk_sizze_48138; i_48255++) {\n                int64_t sharedIdx_48256 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48255;\n                int16_t tmp_48257 = ((__local int16_t *) local_mem_48215)[sharedIdx_48256];\n                \n                private_mem_48239[i_48255] = tmp_48257;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48258 = 0; i_48258 < chunk_sizze_48138; i_48258++) {\n                int64_t sharedIdx_48259 = sext_i32_i64(local_tid_48202) + i_48258 * segscan_tblock_sizze_46437;\n                int16_t tmp_48260 = private_mem_48241[i_48258];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48259] = tmp_48260;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48261 = 0; i_48261 < chunk_sizze_48138; i_48261++) {\n                int64_t sharedIdx_48262 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48261;\n                int16_t tmp_48263 = ((__local int16_t *) local_mem_48215)[sharedIdx_48262];\n                \n                private_mem_48241[i_48261] = tmp_48263;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);",
                                    "\n            for (int64_t i_48264 = 0; i_48264 < chunk_sizze_48138; i_48264++) {\n                int64_t sharedIdx_48265 = sext_i32_i64(local_tid_48202) + i_48264 * segscan_tblock_sizze_46437;\n                int16_t tmp_48266 = private_mem_48243[i_48264];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48265] = tmp_48266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48267 = 0; i_48267 < chunk_sizze_48138; i_48267++) {\n                int64_t sharedIdx_48268 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48267;\n                int16_t tmp_48269 = ((__local int16_t *) local_mem_48215)[sharedIdx_48268];\n                \n                private_mem_48243[i_48267] = tmp_48269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48270 = 0; i_48270 < chunk_sizze_48138; i_48270++) {\n                int64_t sharedIdx_48271 = sext_i32_i64(local_tid_48202) + i_48270 * segscan_tblock_sizze_46437;\n                int16_t tmp_48272 = private_mem_48245[i_48270];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48271] = tmp_48272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48273 = 0; i_48273 < chunk_sizze_48138; i_48273++) {\n                int64_t sharedIdx_48274 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48273;\n                int16_t tmp_48275 = ((__local int16_t *) local_mem_48215)[sharedIdx_48274];\n                \n                private_mem_48245[i_48273] = tmp_48275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48276 = 0; i_48276 < chunk_sizze_48138 - (int64_t) 1; i_48276++) {\n                int16_t eta_p_41812;\n                int16_t eta_p_41816;\n                \n                eta_p_41812 = private_mem_48239[i_48276];\n                eta_p_41816 = private_mem_48239[i_48276 + (int64_t) 1];\n   ", "             \n                int16_t eta_p_41813;\n                int16_t eta_p_41817;\n                \n                eta_p_41813 = private_mem_48241[i_48276];\n                eta_p_41817 = private_mem_48241[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41814;\n                int16_t eta_p_41818;\n                \n                eta_p_41814 = private_mem_48243[i_48276];\n                eta_p_41818 = private_mem_48243[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41815;\n                int16_t eta_p_41819;\n                \n                eta_p_41815 = private_mem_48245[i_48276];\n                eta_p_41819 = private_mem_48245[i_48276 + (int64_t) 1];\n                \n                int16_t defunc_0_op_res_41820 = add16(eta_p_41812, eta_p_41816);\n                int16_t defunc_0_op_res_41821 = add16(eta_p_41813, eta_p_41817);\n                int16_t defunc_0_op_res_41822 = add16(eta_p_41814, eta_p_41818);\n                int16_t defunc_0_op_res_41823 = add16(eta_p_41815, eta_p_41819);\n                \n                private_mem_48239[i_48276 + (int64_t) 1] = defunc_0_op_res_41820;\n                private_mem_48241[i_48276 + (int64_t) 1] = defunc_0_op_res_41821;\n                private_mem_48243[i_48276 + (int64_t) 1] = defunc_0_op_res_41822;\n                private_mem_48245[i_48276 + (int64_t) 1] = defunc_0_op_res_41823;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48277 = private_mem_48239[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = tmp_48277;\n            \n            int16_t tmp_48278 = private_mem_48241[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48278;\n            \n            int16_t tmp_48279 = private_mem_48243[chunk_sizze_48138 - (int", "64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48279;\n            \n            int16_t tmp_48280 = private_mem_48245[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48280;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48281;\n            int16_t eta_p_48282;\n            int16_t eta_p_48283;\n            int16_t eta_p_48284;\n            int16_t eta_p_48285;\n            int16_t eta_p_48286;\n            int16_t eta_p_48287;\n            int16_t eta_p_48288;\n            int16_t eta_p_48297;\n            int16_t eta_p_48298;\n            int16_t eta_p_48299;\n            int16_t eta_p_48300;\n            int16_t eta_p_48301;\n            int16_t eta_p_48302;\n            int16_t eta_p_48303;\n            int16_t eta_p_48304;\n            bool ltid_in_bounds_48309 = slt64(sext_i32_i64(local_tid_48202), num_virt_threads_48140);\n            int32_t skip_threads_48310;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48309) {\n                    eta_p_48285 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                    eta_p_48286 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48287 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48288 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                        eta_p_48281 = ",
                                    "eta_p_48285;\n                        eta_p_48282 = eta_p_48286;\n                        eta_p_48283 = eta_p_48287;\n                        eta_p_48284 = eta_p_48288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48310 = 1;\n                while (slt32(skip_threads_48310, 32)) {\n                    bool thread_active_48311 = sle32(skip_threads_48310, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && ltid_in_bounds_48309;\n                    \n                    if (thread_active_48311) {\n                        // read operands\n                        {\n                            eta_p_48281 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310)];\n                            eta_p_48282 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48283 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48284 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48311) {\n                            int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                            int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                            int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                            int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                            \n  ", "                          eta_p_48281 = defunc_0_op_res_48289;\n                            eta_p_48282 = defunc_0_op_res_48290;\n                            eta_p_48283 = defunc_0_op_res_48291;\n                            eta_p_48284 = defunc_0_op_res_48292;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48311) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                            eta_p_48285 = eta_p_48281;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                            eta_p_48286 = eta_p_48282;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                            eta_p_48287 = eta_p_48283;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                            eta_p_48288 = eta_p_48284;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48310 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 31 && ltid_in_bounds_48309) {\n                    ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_", "tid_48202, 32))] = eta_p_48281;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48282;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48283;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48284;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48312;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                        eta_p_48301 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                        eta_p_48302 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48303 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48304 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                            eta_p_48297 = eta_p_48301;\n                            eta_p_48298 = eta_p_48302;\n                            eta_p_48299 = eta_p_48303;\n                            eta_p_48300 = eta_p_48304;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n            ",
                                    "        skip_threads_48312 = 1;\n                    while (slt32(skip_threads_48312, 32)) {\n                        bool thread_active_48313 = sle32(skip_threads_48312, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309);\n                        \n                        if (thread_active_48313) {\n                            // read operands\n                            {\n                                eta_p_48297 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312)];\n                                eta_p_48298 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48299 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48300 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48313) {\n                                int16_t defunc_0_op_res_48305 = add16(eta_p_48297, eta_p_48301);\n                                int16_t defunc_0_op_res_48306 = add16(eta_p_48298, eta_p_48302);\n                                int16_t defunc_0_op_res_48307 = add16(eta_p_48299, eta_p_48303);\n                                int16_t defunc_0_op_res_48308 = add16(eta_p_48300, eta_p_48304);\n                                \n                                eta_p_48297 = defunc_0_op_res_48305;\n                                eta_p_48298 = defunc_0_op_res_48306;\n                                eta_p_48299 = d", "efunc_0_op_res_48307;\n                                eta_p_48300 = defunc_0_op_res_48308;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48313) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48297;\n                                eta_p_48301 = eta_p_48297;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48298;\n                                eta_p_48302 = eta_p_48298;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48299;\n                                eta_p_48303 = eta_p_48299;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48300;\n                                eta_p_48304 = eta_p_48300;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48312 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48314 = squot32(local_tid_48202, 32) == 0 || !ltid_in_bounds_48309;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48314) {\n                        eta_p_48285 = eta_p_48281;\n  ", "                      eta_p_48286 = eta_p_48282;\n                        eta_p_48287 = eta_p_48283;\n                        eta_p_48288 = eta_p_48284;\n                        eta_p_48281 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1];\n                        eta_p_48282 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48283 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48284 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48314) {\n                        int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                        int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                        int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                        int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                        \n                        eta_p_48281 = defunc_0_op_res_48289;\n                        eta_p_48282 = defunc_0_op_res_48290;\n                        eta_p_48283 = defunc_0_op_res_48291;\n                        eta_p_48284 = defunc_0_op_res_48292;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48314) {\n                        ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n       ",
                                    "                 ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                    ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48285;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48286;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48287;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48202 == 0) {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[segscan_tblock_sizze_46437 - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (segscan_tblock_sizze_46437 - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (segscan_tblock_sizze_46437 - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (segscan_tblock_sizze_46437 - (int64_t) 1)];\n            } else {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_", "mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48315 = (int16_t) 0;\n        prefix_48316 = (int16_t) 0;\n        prefix_48317 = (int16_t) 0;\n        prefix_48318 = (int16_t) 0;\n        block_new_sgm_48319 = sgm_idx_48236 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48319 && local_tid_48202 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = acc_48293;\n                ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = acc_48294;\n                ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = acc_48295;\n                ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = acc_48296;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                acc_48293 = (int16_t) 0;\n                acc_48294 = (int16_t) 0;\n                acc_48295 = (int16_t) 0;\n                acc_48296 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48319 && slt32(local_tid_48202, wave_sizze_48204)) {\n                if (local_tid_48202 == 0) {\n                    ((volatile __global int16_t *) aggregates_mem_48163)[dynamic_id_48234] = acc_48293;\n                    ((volatile __global int16_t *) aggregates_mem_48167)[dynamic_id_48234] = acc_48294;\n                    ((volatile __global int16_t *) aggregates_mem_48171)[dynamic_id_48234] = acc_48295;\n                    ((volatile __global int16_t *) ag", "gregates_mem_48175)[dynamic_id_48234] = acc_48296;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 1;\n                    \n                    int8_t tmp_48320 = ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48215)[(int64_t) 0] = tmp_48320;\n                }\n                mem_fence_local();\n                \n                int8_t status_48321 = ((__local int8_t *) local_mem_48215)[(int64_t) 0];\n                \n                if (status_48321 == (int8_t) 2) {\n                    if (local_tid_48202 == 0) {\n                        prefix_48315 = ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48316 = ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48317 = ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48318 = ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48322 = sext_i64_i32(dynamic_id_48234 - sext_i32_i64(wave_sizze_48204));\n                    \n                    while (slt32(wave_sizze_48204 * -1, readOffset_48322)) {\n                        int32_t read_i_48323 = readOffset_48322 + local_tid_48202;\n                        int16_t aggr_48324 = (int16_t) 0;\n                        int16_t aggr_48325 = (int16_t) 0;\n                        int16_t aggr_48326 = (int16_t) 0;\n                        int16_t aggr_48327 = (int16_t) 0;\n                        int8_t flag_48328 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48323)) {\n                            flag_48328 = ((volatile __glob",
                                    "al int8_t *) status_flags_mem_48141)[sext_i32_i64(read_i_48323)];\n                            if (flag_48328 == (int8_t) 2) {\n                                aggr_48324 = ((volatile __global int16_t *) incprefixes_mem_48165)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) incprefixes_mem_48169)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) incprefixes_mem_48173)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) incprefixes_mem_48177)[sext_i32_i64(read_i_48323)];\n                            } else if (flag_48328 == (int8_t) 1) {\n                                aggr_48324 = ((volatile __global int16_t *) aggregates_mem_48163)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) aggregates_mem_48167)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) aggregates_mem_48171)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) aggregates_mem_48175)[sext_i32_i64(read_i_48323)];\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = aggr_48324;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48325;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48326;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48327;\n                        ((__local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flag_48328;\n                        flag_48328 = ((__", "local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        if (slt8(flag_48328, (int8_t) 2)) {\n                            int8_t flg_x_48341;\n                            int8_t flg_y_48342;\n                            int16_t eta_p_48329;\n                            int16_t eta_p_48330;\n                            int16_t eta_p_48331;\n                            int16_t eta_p_48332;\n                            int16_t eta_p_48333;\n                            int16_t eta_p_48334;\n                            int16_t eta_p_48335;\n                            int16_t eta_p_48336;\n                            int32_t skip_threads_48343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48342 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                                eta_p_48333 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)];\n                                eta_p_48334 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48335 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48336 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                                    eta_p_48329 = eta_p_48333;\n                                    eta_p_48330 = eta_p_48334;\n                                    eta_p_48331 = eta_p_48335;\n                                    eta_p_48332 = eta_p_48336;\n                                    flg_x_48341 = flg_y_48342;\n    ", "                            }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48343 = 1;\n                                while (slt32(skip_threads_48343, 32)) {\n                                    if (sle32(skip_threads_48343, local_tid_48202 - squot32(local_tid_48202, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48341 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343)];\n                                            eta_p_48329 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48330 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48331 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48332 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48342 == (int8_t) 2 || flg_y_48342 == (int8_t) 0) {\n                                                flg_x_48341 = flg_y_48342;\n                                                eta_p_48329 = eta_p_48333;\n                                                eta_p_48330 =",
                                    " eta_p_48334;\n                                                eta_p_48331 = eta_p_48335;\n                                                eta_p_48332 = eta_p_48336;\n                                            } else {\n                                                int16_t defunc_0_op_res_48337 = add16(eta_p_48329, eta_p_48333);\n                                                int16_t defunc_0_op_res_48338 = add16(eta_p_48330, eta_p_48334);\n                                                int16_t defunc_0_op_res_48339 = add16(eta_p_48331, eta_p_48335);\n                                                int16_t defunc_0_op_res_48340 = add16(eta_p_48332, eta_p_48336);\n                                                \n                                                eta_p_48329 = defunc_0_op_res_48337;\n                                                eta_p_48330 = defunc_0_op_res_48338;\n                                                eta_p_48331 = defunc_0_op_res_48339;\n                                                eta_p_48332 = defunc_0_op_res_48340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flg_x_48341;\n                                            flg_y_48342 = flg_x_48341;\n                                            ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = eta_p_48329;\n                                            eta_p_48333 = eta_p_48329;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48330;\n                                            eta_p_48334 = eta_p_48330;\n                                            ((volatile __local int16_t ", "*) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48331;\n                                            eta_p_48335 = eta_p_48331;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48332;\n                                            eta_p_48336 = eta_p_48332;\n                                        }\n                                    }\n                                    skip_threads_48343 *= 2;\n                                }\n                            }\n                        }\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        aggr_48324 = ((__local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48325 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48326 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48327 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        if (flag_48328 == (int8_t) 2) {\n                            readOffset_48322 = wave_sizze_48204 * -1;\n                        } else if (flag_48328 == (int8_t) 1) {\n                            readOffset_48322 -= wave_sizze_48204;\n                        }\n                        if (slt8((int8_t) 0, flag_48328)) {\n                            int16_t eta_p_48344 = aggr_48324;\n                            int16_t eta_p_48345 = aggr_48325;\n                            int16_t eta_p_48346 = aggr_48326;\n                            in", "t16_t eta_p_48347 = aggr_48327;\n                            int16_t eta_p_48348 = prefix_48315;\n                            int16_t eta_p_48349 = prefix_48316;\n                            int16_t eta_p_48350 = prefix_48317;\n                            int16_t eta_p_48351 = prefix_48318;\n                            int16_t defunc_0_op_res_48352 = add16(eta_p_48344, eta_p_48348);\n                            int16_t defunc_0_op_res_48353 = add16(eta_p_48345, eta_p_48349);\n                            int16_t defunc_0_op_res_48354 = add16(eta_p_48346, eta_p_48350);\n                            int16_t defunc_0_op_res_48355 = add16(eta_p_48347, eta_p_48351);\n                            \n                            prefix_48315 = defunc_0_op_res_48352;\n                            prefix_48316 = defunc_0_op_res_48353;\n                            prefix_48317 = defunc_0_op_res_48354;\n                            prefix_48318 = defunc_0_op_res_48355;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48202 == 0) {\n                    if (boundary_48237 == sext_i64_i32(segscan_tblock_sizze_46437 * chunk_sizze_48138)) {\n                        int16_t eta_p_48356 = prefix_48315;\n                        int16_t eta_p_48357 = prefix_48316;\n                        int16_t eta_p_48358 = prefix_48317;\n                        int16_t eta_p_48359 = prefix_48318;\n                        int16_t eta_p_48360 = acc_48293;\n                        int16_t eta_p_48361 = acc_48294;\n                        int16_t eta_p_48362 = acc_48295;\n                        int16_t eta_p_48363 = acc_48296;\n                        int16_t defunc_0_op_res_48364 = add16(eta_p_48356, eta_p_48360);\n                        int16_t defunc_0_op_res_48365 = add16(eta_p_48357, eta_p_48361);\n                        int16_t defunc_0_op_res_48366 = add16(eta_p_48358, eta_p_48362);\n                        int16_t defunc_0_op_res_48367",
                                    " = add16(eta_p_48359, eta_p_48363);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = defunc_0_op_res_48364;\n                        ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = defunc_0_op_res_48365;\n                        ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = defunc_0_op_res_48366;\n                        ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = defunc_0_op_res_48367;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48215)[(int64_t) 16] = prefix_48315;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)] = prefix_48316;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)] = prefix_48317;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)] = prefix_48318;\n                    acc_48293 = (int16_t) 0;\n                    acc_48294 = (int16_t) 0;\n                    acc_48295 = (int16_t) 0;\n                    acc_48296 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48234 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48315 = ((__local int16_t *) local_mem_48215)[(int64_t) 16];\n                prefix_48316 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)];\n                prefix_48317 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)];\n                prefix_48318 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distri", "bute results\n        {\n            int16_t eta_p_48368;\n            int16_t eta_p_48372;\n            int16_t eta_p_48380 = prefix_48315;\n            int16_t eta_p_48384 = acc_48293;\n            int16_t eta_p_48369;\n            int16_t eta_p_48373;\n            int16_t eta_p_48381 = prefix_48316;\n            int16_t eta_p_48385 = acc_48294;\n            int16_t eta_p_48370;\n            int16_t eta_p_48374;\n            int16_t eta_p_48382 = prefix_48317;\n            int16_t eta_p_48386 = acc_48295;\n            int16_t eta_p_48371;\n            int16_t eta_p_48375;\n            int16_t eta_p_48383 = prefix_48318;\n            int16_t eta_p_48387 = acc_48296;\n            \n            if (slt32(local_tid_48202 * chunk_sizze_32b_48206, boundary_48237) && !block_new_sgm_48319) {\n                int16_t defunc_0_op_res_48388 = add16(eta_p_48380, eta_p_48384);\n                int16_t defunc_0_op_res_48389 = add16(eta_p_48381, eta_p_48385);\n                int16_t defunc_0_op_res_48390 = add16(eta_p_48382, eta_p_48386);\n                int16_t defunc_0_op_res_48391 = add16(eta_p_48383, eta_p_48387);\n                \n                eta_p_48368 = defunc_0_op_res_48388;\n                eta_p_48369 = defunc_0_op_res_48389;\n                eta_p_48370 = defunc_0_op_res_48390;\n                eta_p_48371 = defunc_0_op_res_48391;\n            } else {\n                eta_p_48368 = acc_48293;\n                eta_p_48369 = acc_48294;\n                eta_p_48370 = acc_48295;\n                eta_p_48371 = acc_48296;\n            }\n            \n            int32_t stopping_point_48392 = segsizze_compact_48238 - srem32(local_tid_48202 * chunk_sizze_32b_48206 - 1 + segsizze_compact_48238 - boundary_48237, segsizze_compact_48238);\n            \n            for (int64_t i_48393 = 0; i_48393 < chunk_sizze_48138; i_48393++) {\n                if (slt32(sext_i64_i32(i_48393), stopping_point_48392 - 1)) {\n                    eta_p_48372 = private_mem_48239[i_48393];\n                    eta_p_48373 = pri", "vate_mem_48241[i_48393];\n                    eta_p_48374 = private_mem_48243[i_48393];\n                    eta_p_48375 = private_mem_48245[i_48393];\n                    \n                    int16_t defunc_0_op_res_48376 = add16(eta_p_48368, eta_p_48372);\n                    int16_t defunc_0_op_res_48377 = add16(eta_p_48369, eta_p_48373);\n                    int16_t defunc_0_op_res_48378 = add16(eta_p_48370, eta_p_48374);\n                    int16_t defunc_0_op_res_48379 = add16(eta_p_48371, eta_p_48375);\n                    \n                    private_mem_48239[i_48393] = defunc_0_op_res_48376;\n                    private_mem_48241[i_48393] = defunc_0_op_res_48377;\n                    private_mem_48243[i_48393] = defunc_0_op_res_48378;\n                    private_mem_48245[i_48393] = defunc_0_op_res_48379;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48394 = 0; i_48394 < chunk_sizze_48138; i_48394++) {\n                int64_t sharedIdx_48395 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48394;\n                int16_t tmp_48396 = private_mem_48239[i_48394];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48395] = tmp_48396;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48397 = 0; i_48397 < chunk_sizze_48138; i_48397++) {\n                int64_t flat_idx_48398 = thd_offset_48247 + i_48397 * segscan_tblock_sizze_46437;\n                int64_t slice_48399 = rest_41713;\n                int64_t gtid_46441 = flat_idx_48398;\n                int64_t remnant_48400 = flat_idx_48398 - gtid_46441;\n                \n                if (slt64(flat_idx_48398, rest_41713)) {\n                    int16_t tmp_48401 = ((__local int16_t *) local_mem_48215)[flat_idx_48398 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47857)[gtid_46441] = tmp_48401;\n  ",
                                    "              }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48402 = 0; i_48402 < chunk_sizze_48138; i_48402++) {\n                int64_t sharedIdx_48403 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48402;\n                int16_t tmp_48404 = private_mem_48241[i_48402];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48403] = tmp_48404;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48405 = 0; i_48405 < chunk_sizze_48138; i_48405++) {\n                int64_t flat_idx_48406 = thd_offset_48247 + i_48405 * segscan_tblock_sizze_46437;\n                int64_t slice_48407 = rest_41713;\n                int64_t gtid_46441 = flat_idx_48406;\n                int64_t remnant_48408 = flat_idx_48406 - gtid_46441;\n                \n                if (slt64(flat_idx_48406, rest_41713)) {\n                    int16_t tmp_48409 = ((__local int16_t *) local_mem_48215)[flat_idx_48406 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47859)[gtid_46441] = tmp_48409;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48410 = 0; i_48410 < chunk_sizze_48138; i_48410++) {\n                int64_t sharedIdx_48411 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48410;\n                int16_t tmp_48412 = private_mem_48243[i_48410];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48411] = tmp_48412;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48413 = 0; i_48413 < chunk_sizze_48138; i_48413++) {\n                int64_t flat_idx_48414 = thd_offset_48247 + i_48413 * segscan_tblock_sizze_46437;\n                int64_t slice_48415 = rest_41713;\n                int64_t gtid_46441 = flat_idx_48414;\n                int64_t remnant_48416 = flat_idx_48414 - gtid_46441;\n                \n                if (slt64(flat_idx_48414", ", rest_41713)) {\n                    int16_t tmp_48417 = ((__local int16_t *) local_mem_48215)[flat_idx_48414 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47861)[gtid_46441] = tmp_48417;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48418 = 0; i_48418 < chunk_sizze_48138; i_48418++) {\n                int64_t sharedIdx_48419 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48418;\n                int16_t tmp_48420 = private_mem_48245[i_48418];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48419] = tmp_48420;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48421 = 0; i_48421 < chunk_sizze_48138; i_48421++) {\n                int64_t flat_idx_48422 = thd_offset_48247 + i_48421 * segscan_tblock_sizze_46437;\n                int64_t slice_48423 = rest_41713;\n                int64_t gtid_46441 = flat_idx_48422;\n                int64_t remnant_48424 = flat_idx_48422 - gtid_46441;\n                \n                if (slt64(flat_idx_48422, rest_41713)) {\n                    int16_t tmp_48425 = ((__local int16_t *) local_mem_48215)[flat_idx_48422 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47863)[gtid_46441] = tmp_48425;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_46437\n    #undef chunk_sizze_48138\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegscan_46741_dim1, 1, 1)\nvoid sortColumn_intzisegscan_46741(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_46732, int64_t num_virt_blocks_48530, int64_t num_virt_threads_48531, ", "__global unsigned char *mem_47846, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *status_flags_mem_48532, __global unsigned char *aggregates_mem_48534, __global unsigned char *incprefixes_mem_48536, __global unsigned char *aggregates_mem_48538, __global unsigned char *incprefixes_mem_48540, __global unsigned char *aggregates_mem_48542, __global unsigned char *incprefixes_mem_48544, __global unsigned char *aggregates_mem_48546, __global unsigned char *incprefixes_mem_48548, __global unsigned char *global_dynid_mem_48550)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_46731 (sortColumn_intzisegscan_46741zisegscan_tblock_sizze_46731)\n    #define chunk_sizze_48529 (sortColumn_intzisegscan_46741zichunk_sizze_48529)\n    \n    volatile __local unsigned char *local_mem_48566_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48566_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tbl",
                                    "ock_sizze_46731), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48553;\n    int32_t tblock_sizze_48556;\n    int32_t wave_sizze_48555;\n    int32_t block_id_48554;\n    int32_t global_tid_48552;\n    int64_t phys_tid_46741;\n    int32_t chunk_sizze_32b_48557;\n    int64_t byte_offsets_48558;\n    int64_t byte_offsets_48559;\n    int64_t byte_offsets_48560;\n    int64_t byte_offsets_48561;\n    int64_t warp_byte_offset_48562;\n    int64_t warp_byte_offset_48563;\n    int64_t warp_byte_offset_48564;\n    int64_t warp_byte_offset_48565;\n    __local unsigned char *local_mem_48566;\n    int64_t trans_arr_len_48567;\n    int64_t phys_block_id_48582;\n    int64_t virtloop_bound_48583;\n    \n    local_tid_48553 = get_local_id(0);\n    tblock_sizze_48556 = get_local_size(0);\n    wave_sizze_48555 = LOCKSTEP_WIDTH;\n    block_id_48554 = get_tblock_id(0);\n    global_tid_48552 = block_id_48554 * tblock_sizze_48556 + local_tid_48553;\n    phys_tid_46741 = sext_i32_i64(global_tid_48552);\n    chunk_sizze_32b_48557 = sext_i64_i32(chunk_sizze_48529);\n    byte_offsets_48558 = segscan_tblock_sizze_46731 * (int64_t) 2;\n    byte_offsets_48559 = sdiv_up64(byte_offsets_48558, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46731 * (int64_t) 2;\n    byte_offsets_48560 = sdiv_up64(byte_offsets_48559, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46731 * (int64_t) 2;\n    byte_offsets_48561 = sdiv_up64(byte_offsets_48560, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_46731 * (int64_t) 2;\n    warp_byte_offset_48562 = (int64_t) 96;\n    warp_byte_offset_48563 = sdiv_up64(warp_byte_offset_48562, (int64_t) 2) * (int64_t", ") 2 + (int64_t) 64;\n    warp_byte_offset_48564 = sdiv_up64(warp_byte_offset_48563, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48565 = sdiv_up64(warp_byte_offset_48564, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48566 = (__local unsigned char *) local_mem_48566_backing_0;\n    trans_arr_len_48567 = chunk_sizze_48529 * segscan_tblock_sizze_46731;\n    phys_block_id_48582 = get_tblock_id(0);\n    virtloop_bound_48583 = sdiv_up64(num_virt_blocks_48530 - phys_block_id_48582, num_tblocks_46732);\n    for (int64_t virtloop_i_48584 = 0; virtloop_i_48584 < virtloop_bound_48583; virtloop_i_48584++) {\n        int64_t dynamic_id_48585;\n        int64_t block_offset_48586;\n        int64_t sgm_idx_48587;\n        int32_t boundary_48588;\n        int32_t segsizze_compact_48589;\n        int16_t private_mem_48590[chunk_sizze_48529];\n        int16_t private_mem_48592[chunk_sizze_48529];\n        int16_t private_mem_48594[chunk_sizze_48529];\n        int16_t private_mem_48596[chunk_sizze_48529];\n        int64_t thd_offset_48598;\n        int16_t acc_48648;\n        int16_t acc_48649;\n        int16_t acc_48650;\n        int16_t acc_48651;\n        int16_t prefix_48673;\n        int16_t prefix_48674;\n        int16_t prefix_48675;\n        int16_t prefix_48676;\n        bool block_new_sgm_48677;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48553 == 0) {\n                dynamic_id_48585 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48550)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48566)[(int64_t) 0] = dynamic_id_48585;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48585 == num_virt_blocks_48530 - (int64_t) 1) {\n                        ", "((__global int32_t *) global_dynid_mem_48550)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48585 = ((__local int32_t *) local_mem_48566)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48586 = dynamic_id_48585 * chunk_sizze_48529 * segscan_tblock_sizze_46731;\n        sgm_idx_48587 = smod64(block_offset_48586, i16_res_41708);\n        boundary_48588 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_46731, i16_res_41708 - sgm_idx_48587));\n        segsizze_compact_48589 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_46731, i16_res_41708));\n        thd_offset_48598 = block_offset_48586 + sext_i32_i64(local_tid_48553);\n        // Load and map\n        {\n            for (int64_t i_48599 = 0; i_48599 < chunk_sizze_48529; i_48599++) {\n                int64_t virt_tid_48600 = thd_offset_48598 + i_48599 * segscan_tblock_sizze_46731;\n                int64_t slice_48601 = i16_res_41708;\n                int64_t slice_48602 = n_blocks_41712 * slice_48601;\n                int64_t gtid_46739 = squot64(virt_tid_48600, slice_48601);\n                int64_t remnant_48603 = virt_tid_48600 - gtid_46739 * slice_48601;\n                int64_t gtid_46740 = remnant_48603;\n                int64_t remnant_48604 = remnant_48603 - gtid_46740;\n                \n                if (slt64(virt_tid_48600, n_blocks_41712 * i16_res_41708)) {\n                    int64_t binop_x_46982 = i16_res_41708 * gtid_46739;\n                    int64_t new_index_46983 = gtid_46740 + binop_x_46982;\n                    int32_t eta_p_46755 = ((__global int32_t *) mem_47846)[new_index_46983];\n                    int32_t zgzg_res_46756 = ashr32(eta_p_46755, get_bit_arg0_41781);\n                    int32_t za_res_46757 = 1 & zgzg_res_46756;\n                    int32_t defunc_0_get_bit_res_46758;\n                    \n                    if (cond_41782) {\n                       ",
                                    " int32_t defunc_0_get_bit_res_t_res_46759 = 1 ^ za_res_46757;\n                        \n                        defunc_0_get_bit_res_46758 = defunc_0_get_bit_res_t_res_46759;\n                    } else {\n                        defunc_0_get_bit_res_46758 = za_res_46757;\n                    }\n                    \n                    int32_t zp_lhs_46760 = mul32(2, defunc_0_get_bit_res_46758);\n                    int32_t zgzg_res_46761 = ashr32(eta_p_46755, blocked_radix_sort_step_arg1_41776);\n                    int32_t za_res_46762 = 1 & zgzg_res_46761;\n                    int32_t defunc_0_get_bit_res_46763;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_46764 = 1 ^ za_res_46762;\n                        \n                        defunc_0_get_bit_res_46763 = defunc_0_get_bit_res_t_res_46764;\n                    } else {\n                        defunc_0_get_bit_res_46763 = za_res_46762;\n                    }\n                    \n                    int32_t i32_arg0_46765 = add32(zp_lhs_46760, defunc_0_get_bit_res_46763);\n                    int16_t i32_res_46766 = sext_i32_i16(i32_arg0_46765);\n                    int16_t defunc_0_f_res_46767;\n                    int16_t defunc_0_f_res_46768;\n                    int16_t defunc_0_f_res_46769;\n                    int16_t defunc_0_f_res_46770;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_46767, &defunc_0_f_res_46768, &defunc_0_f_res_46769, &defunc_0_f_res_46770, i32_res_46766);\n                    ((__global int16_t *) mem_47901)[gtid_46739 * i16_res_41708 + gtid_46740] = i32_res_46766;\n                    private_mem_48590[i_48599] = defunc_0_f_res_46767;\n                    private_mem_48592[i_48599] = defunc_0_f_res_46768;\n                    private_mem_48594[i_48599] = defunc_0_f_res_46769;\n                    private_mem_48596[i_48599] = defunc_0_f_res_46770;\n                } else {\n                    private", "_mem_48590[i_48599] = (int16_t) 0;\n                    private_mem_48592[i_48599] = (int16_t) 0;\n                    private_mem_48594[i_48599] = (int16_t) 0;\n                    private_mem_48596[i_48599] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48605 = 0; i_48605 < chunk_sizze_48529; i_48605++) {\n                int64_t sharedIdx_48606 = sext_i32_i64(local_tid_48553) + i_48605 * segscan_tblock_sizze_46731;\n                int16_t tmp_48607 = private_mem_48590[i_48605];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48606] = tmp_48607;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48608 = 0; i_48608 < chunk_sizze_48529; i_48608++) {\n                int64_t sharedIdx_48609 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48608;\n                int16_t tmp_48610 = ((__local int16_t *) local_mem_48566)[sharedIdx_48609];\n                \n                private_mem_48590[i_48608] = tmp_48610;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48611 = 0; i_48611 < chunk_sizze_48529; i_48611++) {\n                int64_t sharedIdx_48612 = sext_i32_i64(local_tid_48553) + i_48611 * segscan_tblock_sizze_46731;\n                int16_t tmp_48613 = private_mem_48592[i_48611];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48612] = tmp_48613;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48614 = 0; i_48614 < chunk_sizze_48529; i_48614++) {\n                int64_t sharedIdx_48615 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48614;\n                int16_t tmp_48616 = ((__local int16_t *) local_mem_48566)[sharedIdx_48615];\n                \n                private_mem_48592[i_48614] = tmp_48616;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64", "_t i_48617 = 0; i_48617 < chunk_sizze_48529; i_48617++) {\n                int64_t sharedIdx_48618 = sext_i32_i64(local_tid_48553) + i_48617 * segscan_tblock_sizze_46731;\n                int16_t tmp_48619 = private_mem_48594[i_48617];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48618] = tmp_48619;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48620 = 0; i_48620 < chunk_sizze_48529; i_48620++) {\n                int64_t sharedIdx_48621 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48620;\n                int16_t tmp_48622 = ((__local int16_t *) local_mem_48566)[sharedIdx_48621];\n                \n                private_mem_48594[i_48620] = tmp_48622;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48623 = 0; i_48623 < chunk_sizze_48529; i_48623++) {\n                int64_t sharedIdx_48624 = sext_i32_i64(local_tid_48553) + i_48623 * segscan_tblock_sizze_46731;\n                int16_t tmp_48625 = private_mem_48596[i_48623];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48624] = tmp_48625;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48626 = 0; i_48626 < chunk_sizze_48529; i_48626++) {\n                int64_t sharedIdx_48627 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48626;\n                int16_t tmp_48628 = ((__local int16_t *) local_mem_48566)[sharedIdx_48627];\n                \n                private_mem_48596[i_48626] = tmp_48628;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48629 = 0; i_48629 < chunk_sizze_48529 - (int64_t) 1; i_48629++) {\n                int32_t gidx_48630 = local_tid_48553 * chunk_sizze_32b_48557 + 1;\n                bool new_sgm_48631 = smod32(gidx_48630 + sext_i64_i32(i_48629) - boundary_48588, segsizze_compact_48589) == 0;\n                \n                if (!",
                                    "new_sgm_48631) {\n                    int16_t eta_p_46742;\n                    int16_t eta_p_46746;\n                    \n                    eta_p_46742 = private_mem_48590[i_48629];\n                    eta_p_46746 = private_mem_48590[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46743;\n                    int16_t eta_p_46747;\n                    \n                    eta_p_46743 = private_mem_48592[i_48629];\n                    eta_p_46747 = private_mem_48592[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46744;\n                    int16_t eta_p_46748;\n                    \n                    eta_p_46744 = private_mem_48594[i_48629];\n                    eta_p_46748 = private_mem_48594[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_46745;\n                    int16_t eta_p_46749;\n                    \n                    eta_p_46745 = private_mem_48596[i_48629];\n                    eta_p_46749 = private_mem_48596[i_48629 + (int64_t) 1];\n                    \n                    int16_t defunc_0_op_res_46750 = add16(eta_p_46742, eta_p_46746);\n                    int16_t defunc_0_op_res_46751 = add16(eta_p_46743, eta_p_46747);\n                    int16_t defunc_0_op_res_46752 = add16(eta_p_46744, eta_p_46748);\n                    int16_t defunc_0_op_res_46753 = add16(eta_p_46745, eta_p_46749);\n                    \n                    private_mem_48590[i_48629 + (int64_t) 1] = defunc_0_op_res_46750;\n                    private_mem_48592[i_48629 + (int64_t) 1] = defunc_0_op_res_46751;\n                    private_mem_48594[i_48629 + (int64_t) 1] = defunc_0_op_res_46752;\n                    private_mem_48596[i_48629 + (int64_t) 1] = defunc_0_op_res_46753;\n                }\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48632 = private_mem_48590[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) loca", "l_mem_48566)[sext_i32_i64(local_tid_48553)] = tmp_48632;\n            \n            int16_t tmp_48633 = private_mem_48592[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48633;\n            \n            int16_t tmp_48634 = private_mem_48594[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48634;\n            \n            int16_t tmp_48635 = private_mem_48596[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48635;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48636;\n            int16_t eta_p_48637;\n            int16_t eta_p_48638;\n            int16_t eta_p_48639;\n            int16_t eta_p_48640;\n            int16_t eta_p_48641;\n            int16_t eta_p_48642;\n            int16_t eta_p_48643;\n            int16_t eta_p_48652;\n            int16_t eta_p_48653;\n            int16_t eta_p_48654;\n            int16_t eta_p_48655;\n            int16_t eta_p_48656;\n            int16_t eta_p_48657;\n            int16_t eta_p_48658;\n            int16_t eta_p_48659;\n            bool ltid_in_bounds_48664 = slt64(sext_i32_i64(local_tid_48553), num_virt_threads_48531);\n            int32_t skip_threads_48665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48664) {\n                    eta_p_48640 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                    eta_p_48641 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48642 = ((volatile ", "__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48643 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                        eta_p_48636 = eta_p_48640;\n                        eta_p_48637 = eta_p_48641;\n                        eta_p_48638 = eta_p_48642;\n                        eta_p_48639 = eta_p_48643;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48665 = 1;\n                while (slt32(skip_threads_48665, 32)) {\n                    bool thread_active_48666 = sle32(skip_threads_48665, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && ltid_in_bounds_48664;\n                    \n                    if (thread_active_48666) {\n                        // read operands\n                        {\n                            eta_p_48636 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665)];\n                            eta_p_48637 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48638 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48639 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_48667 = slt32(smod32((loc",
                                    "al_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((local_tid_48553 - skip_threads_48665 + 1) * chunk_sizze_32b_48557 - 1));\n                        \n                        if (thread_active_48666 && inactive_48667) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                        if (thread_active_48666) {\n                            if (!inactive_48667) {\n                                int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                                int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                                int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                                int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                                \n                                eta_p_48636 = defunc_0_op_res_48644;\n                                eta_p_48637 = defunc_0_op_res_48645;\n                                eta_p_48638 = defunc_0_op_res_48646;\n                                eta_p_48639 = defunc_0_op_res_48647;\n                            }\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48666) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                            eta_p_48640 = eta_p_48636;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (in", "t64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                            eta_p_48641 = eta_p_48637;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                            eta_p_48642 = eta_p_48638;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                            eta_p_48643 = eta_p_48639;\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 31 && ltid_in_bounds_48664) {\n                    ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48636;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48637;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48638;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48668;\n                \n                // read input for in-block scan\n                {\n", "                    if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                        eta_p_48656 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                        eta_p_48657 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48658 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48659 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                            eta_p_48652 = eta_p_48656;\n                            eta_p_48653 = eta_p_48657;\n                            eta_p_48654 = eta_p_48658;\n                            eta_p_48655 = eta_p_48659;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48668 = 1;\n                    while (slt32(skip_threads_48668, 32)) {\n                        bool thread_active_48669 = sle32(skip_threads_48668, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664);\n                        \n                        if (thread_active_48669) {\n                            // read operands\n                            {\n                                eta_p_48652 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668)];\n                                eta_p_48653 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48654 = ",
                                    "((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48655 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_48670 = slt32(smod32((local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 - (((local_tid_48553 - skip_threads_48668) * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                            \n                            if (thread_active_48669 && inactive_48670) {\n                                eta_p_48652 = eta_p_48656;\n                                eta_p_48653 = eta_p_48657;\n                                eta_p_48654 = eta_p_48658;\n                                eta_p_48655 = eta_p_48659;\n                            }\n                            if (thread_active_48669) {\n                                if (!inactive_48670) {\n                                    int16_t defunc_0_op_res_48660 = add16(eta_p_48652, eta_p_48656);\n                                    int16_t defunc_0_op_res_48661 = add16(eta_p_48653, eta_p_48657);\n                                    int16_t defunc_0_op_res_48662 = add16(eta_p_48654, eta_p_48658);\n                                    int16_t defunc_0_op_res_48663 = add16(eta_p_48655, eta_p_48659);\n                                    \n                                    eta_p_48652 = defunc_0_op_res_48660;\n                                    eta_p_48653 = defunc_0_op_res_48661;\n                                    eta_p_48654 = defunc_0_op_res_48662;\n                   ", "                 eta_p_48655 = defunc_0_op_res_48663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48669) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48652;\n                                eta_p_48656 = eta_p_48652;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48653;\n                                eta_p_48657 = eta_p_48653;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48654;\n                                eta_p_48658 = eta_p_48654;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48655;\n                                eta_p_48659 = eta_p_48655;\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48668 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48671 = squot32(local_tid_48553, 32) == 0 || !ltid_in_bounds_48664;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48671) {\n                        eta_p_48640 = eta_p_48636;\n     ", "                   eta_p_48641 = eta_p_48637;\n                        eta_p_48642 = eta_p_48638;\n                        eta_p_48643 = eta_p_48639;\n                        eta_p_48636 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1];\n                        eta_p_48637 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48638 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48639 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48672 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((squot32(local_tid_48553, 32) * 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                    \n                    if (!no_carry_in_48671) {\n                        if (inactive_48672) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                    }\n                    if (!no_carry_in_48671) {\n                        if (!inactive_48672) {\n                            int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                            int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                            int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                            ",
                                    "int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                            \n                            eta_p_48636 = defunc_0_op_res_48644;\n                            eta_p_48637 = defunc_0_op_res_48645;\n                            eta_p_48638 = defunc_0_op_res_48646;\n                            eta_p_48639 = defunc_0_op_res_48647;\n                        }\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48671) {\n                        ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                    ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48640;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48641;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48642;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48643;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n           ", " if (local_tid_48553 == 0) {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[segscan_tblock_sizze_46731 - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (segscan_tblock_sizze_46731 - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (segscan_tblock_sizze_46731 - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (segscan_tblock_sizze_46731 - (int64_t) 1)];\n            } else {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48673 = (int16_t) 0;\n        prefix_48674 = (int16_t) 0;\n        prefix_48675 = (int16_t) 0;\n        prefix_48676 = (int16_t) 0;\n        block_new_sgm_48677 = sgm_idx_48587 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48677 && local_tid_48553 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                mem_f", "ence_global();\n                ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                acc_48648 = (int16_t) 0;\n                acc_48649 = (int16_t) 0;\n                acc_48650 = (int16_t) 0;\n                acc_48651 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48677 && slt32(local_tid_48553, wave_sizze_48555)) {\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_46731 * chunk_sizze_48529)) {\n                        ((volatile __global int16_t *) aggregates_mem_48534)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) aggregates_mem_48538)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) aggregates_mem_48542)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) aggregates_mem_48546)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 1;\n                    } else {\n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    \n                    int8_t tmp_48678 = ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48566)[(int64_t) ",
                                    "0] = tmp_48678;\n                }\n                mem_fence_local();\n                \n                int8_t status_48679 = ((__local int8_t *) local_mem_48566)[(int64_t) 0];\n                \n                if (status_48679 == (int8_t) 2) {\n                    if (local_tid_48553 == 0) {\n                        prefix_48673 = ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48674 = ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48675 = ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48676 = ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48680 = sext_i64_i32(dynamic_id_48585 - sext_i32_i64(wave_sizze_48555));\n                    \n                    while (slt32(wave_sizze_48555 * -1, readOffset_48680)) {\n                        int32_t read_i_48681 = readOffset_48680 + local_tid_48553;\n                        int16_t aggr_48682 = (int16_t) 0;\n                        int16_t aggr_48683 = (int16_t) 0;\n                        int16_t aggr_48684 = (int16_t) 0;\n                        int16_t aggr_48685 = (int16_t) 0;\n                        int8_t flag_48686 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48681)) {\n                            if (sle64(block_offset_48586 - (sext_i32_i64(read_i_48681 + 1) * segscan_tblock_sizze_46731 * chunk_sizze_48529 - (int64_t) 1), sgm_idx_48587)) {\n                                flag_48686 = ((volatile __global int8_t *) status_flags_mem_48532)[sext_i32_i64(read_i_48681)];\n                                if (flag_48686 == (int8_t) 2) {\n                                    aggr_48682 = ((volatile __global int16_t *) incprefixes_mem_48536)[sext_i32_i64(read_i_48681)];\n ", "                                   aggr_48683 = ((volatile __global int16_t *) incprefixes_mem_48540)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) incprefixes_mem_48544)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) incprefixes_mem_48548)[sext_i32_i64(read_i_48681)];\n                                } else if (flag_48686 == (int8_t) 1) {\n                                    aggr_48682 = ((volatile __global int16_t *) aggregates_mem_48534)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) aggregates_mem_48538)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) aggregates_mem_48542)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) aggregates_mem_48546)[sext_i32_i64(read_i_48681)];\n                                }\n                            } else {\n                                flag_48686 = (int8_t) 2;\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = aggr_48682;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48683;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48684;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48685;\n                        ((__local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flag_48686;\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n               ", "         if (slt8(flag_48686, (int8_t) 2)) {\n                            int8_t flg_x_48699;\n                            int8_t flg_y_48700;\n                            int16_t eta_p_48687;\n                            int16_t eta_p_48688;\n                            int16_t eta_p_48689;\n                            int16_t eta_p_48690;\n                            int16_t eta_p_48691;\n                            int16_t eta_p_48692;\n                            int16_t eta_p_48693;\n                            int16_t eta_p_48694;\n                            int32_t skip_threads_48701;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48700 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                                eta_p_48691 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)];\n                                eta_p_48692 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48693 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48694 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                                    eta_p_48687 = eta_p_48691;\n                                    eta_p_48688 = eta_p_48692;\n                                    eta_p_48689 = eta_p_48693;\n                                    eta_p_48690 = eta_p_48694;\n                                    flg_x_48699 = flg_y_48700;\n                                }\n                            }\n                            // in-b",
                                    "lock scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48701 = 1;\n                                while (slt32(skip_threads_48701, 32)) {\n                                    if (sle32(skip_threads_48701, local_tid_48553 - squot32(local_tid_48553, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48699 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701)];\n                                            eta_p_48687 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48688 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48689 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48690 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48700 == (int8_t) 2 || flg_y_48700 == (int8_t) 0) {\n                                                flg_x_48699 = flg_y_48700;\n                                                eta_p_48687 = eta_p_48691;\n                                                eta_p_48688 = eta_p_48692;\n                                                eta_p_48689 = eta_p_48693;\n      ", "                                          eta_p_48690 = eta_p_48694;\n                                            } else {\n                                                int16_t defunc_0_op_res_48695 = add16(eta_p_48687, eta_p_48691);\n                                                int16_t defunc_0_op_res_48696 = add16(eta_p_48688, eta_p_48692);\n                                                int16_t defunc_0_op_res_48697 = add16(eta_p_48689, eta_p_48693);\n                                                int16_t defunc_0_op_res_48698 = add16(eta_p_48690, eta_p_48694);\n                                                \n                                                eta_p_48687 = defunc_0_op_res_48695;\n                                                eta_p_48688 = defunc_0_op_res_48696;\n                                                eta_p_48689 = defunc_0_op_res_48697;\n                                                eta_p_48690 = defunc_0_op_res_48698;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flg_x_48699;\n                                            flg_y_48700 = flg_x_48699;\n                                            ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = eta_p_48687;\n                                            eta_p_48691 = eta_p_48687;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48688;\n                                            eta_p_48692 = eta_p_48688;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553", ")] = eta_p_48689;\n                                            eta_p_48693 = eta_p_48689;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48690;\n                                            eta_p_48694 = eta_p_48690;\n                                        }\n                                    }\n                                    skip_threads_48701 *= 2;\n                                }\n                            }\n                        }\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        aggr_48682 = ((__local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48683 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48684 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48685 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        if (flag_48686 == (int8_t) 2) {\n                            readOffset_48680 = wave_sizze_48555 * -1;\n                        } else if (flag_48686 == (int8_t) 1) {\n                            readOffset_48680 -= wave_sizze_48555;\n                        }\n                        if (slt8((int8_t) 0, flag_48686)) {\n                            int16_t eta_p_48702 = aggr_48682;\n                            int16_t eta_p_48703 = aggr_48683;\n                            int16_t eta_p_48704 = aggr_48684;\n                            int16_t eta_p_48705 = aggr_48685;\n                            int16_t eta_p_48706 = prefix_48673;",
                                    "\n                            int16_t eta_p_48707 = prefix_48674;\n                            int16_t eta_p_48708 = prefix_48675;\n                            int16_t eta_p_48709 = prefix_48676;\n                            int16_t defunc_0_op_res_48710 = add16(eta_p_48702, eta_p_48706);\n                            int16_t defunc_0_op_res_48711 = add16(eta_p_48703, eta_p_48707);\n                            int16_t defunc_0_op_res_48712 = add16(eta_p_48704, eta_p_48708);\n                            int16_t defunc_0_op_res_48713 = add16(eta_p_48705, eta_p_48709);\n                            \n                            prefix_48673 = defunc_0_op_res_48710;\n                            prefix_48674 = defunc_0_op_res_48711;\n                            prefix_48675 = defunc_0_op_res_48712;\n                            prefix_48676 = defunc_0_op_res_48713;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_46731 * chunk_sizze_48529)) {\n                        int16_t eta_p_48714 = prefix_48673;\n                        int16_t eta_p_48715 = prefix_48674;\n                        int16_t eta_p_48716 = prefix_48675;\n                        int16_t eta_p_48717 = prefix_48676;\n                        int16_t eta_p_48718 = acc_48648;\n                        int16_t eta_p_48719 = acc_48649;\n                        int16_t eta_p_48720 = acc_48650;\n                        int16_t eta_p_48721 = acc_48651;\n                        int16_t defunc_0_op_res_48722 = add16(eta_p_48714, eta_p_48718);\n                        int16_t defunc_0_op_res_48723 = add16(eta_p_48715, eta_p_48719);\n                        int16_t defunc_0_op_res_48724 = add16(eta_p_48716, eta_p_48720);\n                        int16_t defunc_0_op_res_48725 = add16(eta_p_48717, eta_p_48721);\n                        \n                        ((volatile", " __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = defunc_0_op_res_48722;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = defunc_0_op_res_48723;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = defunc_0_op_res_48724;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = defunc_0_op_res_48725;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48566)[(int64_t) 16] = prefix_48673;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)] = prefix_48674;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)] = prefix_48675;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)] = prefix_48676;\n                    acc_48648 = (int16_t) 0;\n                    acc_48649 = (int16_t) 0;\n                    acc_48650 = (int16_t) 0;\n                    acc_48651 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48585 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48673 = ((__local int16_t *) local_mem_48566)[(int64_t) 16];\n                prefix_48674 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)];\n                prefix_48675 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)];\n                prefix_48676 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48726;\n            int16_t eta_p_48730;\n      ", "      int16_t eta_p_48738 = prefix_48673;\n            int16_t eta_p_48742 = acc_48648;\n            int16_t eta_p_48727;\n            int16_t eta_p_48731;\n            int16_t eta_p_48739 = prefix_48674;\n            int16_t eta_p_48743 = acc_48649;\n            int16_t eta_p_48728;\n            int16_t eta_p_48732;\n            int16_t eta_p_48740 = prefix_48675;\n            int16_t eta_p_48744 = acc_48650;\n            int16_t eta_p_48729;\n            int16_t eta_p_48733;\n            int16_t eta_p_48741 = prefix_48676;\n            int16_t eta_p_48745 = acc_48651;\n            \n            if (slt32(local_tid_48553 * chunk_sizze_32b_48557, boundary_48588) && !block_new_sgm_48677) {\n                int16_t defunc_0_op_res_48746 = add16(eta_p_48738, eta_p_48742);\n                int16_t defunc_0_op_res_48747 = add16(eta_p_48739, eta_p_48743);\n                int16_t defunc_0_op_res_48748 = add16(eta_p_48740, eta_p_48744);\n                int16_t defunc_0_op_res_48749 = add16(eta_p_48741, eta_p_48745);\n                \n                eta_p_48726 = defunc_0_op_res_48746;\n                eta_p_48727 = defunc_0_op_res_48747;\n                eta_p_48728 = defunc_0_op_res_48748;\n                eta_p_48729 = defunc_0_op_res_48749;\n            } else {\n                eta_p_48726 = acc_48648;\n                eta_p_48727 = acc_48649;\n                eta_p_48728 = acc_48650;\n                eta_p_48729 = acc_48651;\n            }\n            \n            int32_t stopping_point_48750 = segsizze_compact_48589 - srem32(local_tid_48553 * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589);\n            \n            for (int64_t i_48751 = 0; i_48751 < chunk_sizze_48529; i_48751++) {\n                if (slt32(sext_i64_i32(i_48751), stopping_point_48750 - 1)) {\n                    eta_p_48730 = private_mem_48590[i_48751];\n                    eta_p_48731 = private_mem_48592[i_48751];\n                    eta_p_48732 = private_mem_48594[i_48751];\n        ",
                                    "            eta_p_48733 = private_mem_48596[i_48751];\n                    \n                    int16_t defunc_0_op_res_48734 = add16(eta_p_48726, eta_p_48730);\n                    int16_t defunc_0_op_res_48735 = add16(eta_p_48727, eta_p_48731);\n                    int16_t defunc_0_op_res_48736 = add16(eta_p_48728, eta_p_48732);\n                    int16_t defunc_0_op_res_48737 = add16(eta_p_48729, eta_p_48733);\n                    \n                    private_mem_48590[i_48751] = defunc_0_op_res_48734;\n                    private_mem_48592[i_48751] = defunc_0_op_res_48735;\n                    private_mem_48594[i_48751] = defunc_0_op_res_48736;\n                    private_mem_48596[i_48751] = defunc_0_op_res_48737;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48752 = 0; i_48752 < chunk_sizze_48529; i_48752++) {\n                int64_t sharedIdx_48753 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48752;\n                int16_t tmp_48754 = private_mem_48590[i_48752];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48753] = tmp_48754;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48755 = 0; i_48755 < chunk_sizze_48529; i_48755++) {\n                int64_t flat_idx_48756 = thd_offset_48598 + i_48755 * segscan_tblock_sizze_46731;\n                int64_t slice_48757 = i16_res_41708;\n                int64_t slice_48758 = n_blocks_41712 * slice_48757;\n                int64_t gtid_46739 = squot64(flat_idx_48756, slice_48757);\n                int64_t remnant_48759 = flat_idx_48756 - gtid_46739 * slice_48757;\n                int64_t gtid_46740 = remnant_48759;\n                int64_t remnant_48760 = remnant_48759 - gtid_46740;\n                \n                if (slt64(flat_idx_48756, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48761 = ((__local int16_t *) loca", "l_mem_48566)[flat_idx_48756 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47889)[gtid_46739 * i16_res_41708 + gtid_46740] = tmp_48761;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48762 = 0; i_48762 < chunk_sizze_48529; i_48762++) {\n                int64_t sharedIdx_48763 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48762;\n                int16_t tmp_48764 = private_mem_48592[i_48762];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48763] = tmp_48764;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48765 = 0; i_48765 < chunk_sizze_48529; i_48765++) {\n                int64_t flat_idx_48766 = thd_offset_48598 + i_48765 * segscan_tblock_sizze_46731;\n                int64_t slice_48767 = i16_res_41708;\n                int64_t slice_48768 = n_blocks_41712 * slice_48767;\n                int64_t gtid_46739 = squot64(flat_idx_48766, slice_48767);\n                int64_t remnant_48769 = flat_idx_48766 - gtid_46739 * slice_48767;\n                int64_t gtid_46740 = remnant_48769;\n                int64_t remnant_48770 = remnant_48769 - gtid_46740;\n                \n                if (slt64(flat_idx_48766, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48771 = ((__local int16_t *) local_mem_48566)[flat_idx_48766 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47892)[gtid_46739 * i16_res_41708 + gtid_46740] = tmp_48771;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48772 = 0; i_48772 < chunk_sizze_48529; i_48772++) {\n                int64_t sharedIdx_48773 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48772;\n                int16_t tmp_48774 = private_mem_48594[i_48772];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48773] = tmp_48774;\n      ", "      }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48775 = 0; i_48775 < chunk_sizze_48529; i_48775++) {\n                int64_t flat_idx_48776 = thd_offset_48598 + i_48775 * segscan_tblock_sizze_46731;\n                int64_t slice_48777 = i16_res_41708;\n                int64_t slice_48778 = n_blocks_41712 * slice_48777;\n                int64_t gtid_46739 = squot64(flat_idx_48776, slice_48777);\n                int64_t remnant_48779 = flat_idx_48776 - gtid_46739 * slice_48777;\n                int64_t gtid_46740 = remnant_48779;\n                int64_t remnant_48780 = remnant_48779 - gtid_46740;\n                \n                if (slt64(flat_idx_48776, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48781 = ((__local int16_t *) local_mem_48566)[flat_idx_48776 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47895)[gtid_46739 * i16_res_41708 + gtid_46740] = tmp_48781;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48782 = 0; i_48782 < chunk_sizze_48529; i_48782++) {\n                int64_t sharedIdx_48783 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48782;\n                int16_t tmp_48784 = private_mem_48596[i_48782];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48783] = tmp_48784;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48785 = 0; i_48785 < chunk_sizze_48529; i_48785++) {\n                int64_t flat_idx_48786 = thd_offset_48598 + i_48785 * segscan_tblock_sizze_46731;\n                int64_t slice_48787 = i16_res_41708;\n                int64_t slice_48788 = n_blocks_41712 * slice_48787;\n                int64_t gtid_46739 = squot64(flat_idx_48786, slice_48787);\n                int64_t remnant_48789 = flat_idx_48786 - gtid_46739 * slice_48787;\n                int64_t gtid_46740 = remnant_48789;\n                int64_t remnant_48790 = remnant_",
                                    "48789 - gtid_46740;\n                \n                if (slt64(flat_idx_48786, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48791 = ((__local int16_t *) local_mem_48566)[flat_idx_48786 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47898)[gtid_46739 * i16_res_41708 + gtid_46740] = tmp_48791;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_46731\n    #undef chunk_sizze_48529\n}\nFUTHARK_KERNEL_SIZED(sortColumn_intzisegscan_46864_dim1, 1, 1)\nvoid sortColumn_intzisegscan_46864(__global int *global_failure, int64_t n_blocks_41712, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, int64_t num_tblocks_46861, int64_t num_virt_blocks_48874, int64_t num_virt_threads_48875, __global unsigned char *ext_mem_47981, __global unsigned char *mem_47989, __global unsigned char *mem_47992, __global unsigned char *status_flags_mem_48876, __global unsigned char *aggregates_mem_48878, __global unsigned char *incprefixes_mem_48880, __global unsigned char *global_dynid_mem_48882)\n{\n    #define segscan_tblock_sizze_46859 (sortColumn_intzisegscan_46864zisegscan_tblock_sizze_46859)\n    #define chunk_sizze_48873 (sortColumn_intzisegscan_46864zichunk_sizze_48873)\n    \n    volatile __local unsigned char *local_mem_48892_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48892_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46859), chunk_sizze_48873 * segscan_tblock_sizze_46859 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46859), chunk_sizze_48873 * segscan_tblock_sizze_46859 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48885;\n    int32_t tblock_sizze_48888;\n    int32_t wave_sizze_48887;\n    in", "t32_t block_id_48886;\n    int32_t global_tid_48884;\n    int64_t phys_tid_46864;\n    int32_t chunk_sizze_32b_48889;\n    int64_t byte_offsets_48890;\n    int64_t warp_byte_offset_48891;\n    __local unsigned char *local_mem_48892;\n    int64_t trans_arr_len_48893;\n    int64_t phys_block_id_48899;\n    int64_t virtloop_bound_48900;\n    \n    local_tid_48885 = get_local_id(0);\n    tblock_sizze_48888 = get_local_size(0);\n    wave_sizze_48887 = LOCKSTEP_WIDTH;\n    block_id_48886 = get_tblock_id(0);\n    global_tid_48884 = block_id_48886 * tblock_sizze_48888 + local_tid_48885;\n    phys_tid_46864 = sext_i32_i64(global_tid_48884);\n    chunk_sizze_32b_48889 = sext_i64_i32(chunk_sizze_48873);\n    byte_offsets_48890 = segscan_tblock_sizze_46859 * (int64_t) 8;\n    warp_byte_offset_48891 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48892 = (__local unsigned char *) local_mem_48892_backing_0;\n    trans_arr_len_48893 = chunk_sizze_48873 * segscan_tblock_sizze_46859;\n    phys_block_id_48899 = get_tblock_id(0);\n    virtloop_bound_48900 = sdiv_up64(num_virt_blocks_48874 - phys_block_id_48899, num_tblocks_46861);\n    for (int64_t virtloop_i_48901 = 0; virtloop_i_48901 < virtloop_bound_48900; virtloop_i_48901++) {\n        int64_t dynamic_id_48902;\n        int64_t block_offset_48903;\n        int64_t sgm_idx_48904;\n        int32_t boundary_48905;\n        int32_t segsizze_compact_48906;\n        int64_t private_mem_48907[chunk_sizze_48873];\n        int64_t thd_offset_48909;\n        int64_t acc_48925;\n        int64_t prefix_48935;\n        bool block_new_sgm_48936;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48885 == 0) {\n                dynamic_id_48902 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48882)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 0] = dynamic_id_", "48902;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48902 == num_virt_blocks_48874 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48882)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48902 = ((__local int32_t *) local_mem_48892)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48903 = dynamic_id_48902 * chunk_sizze_48873 * segscan_tblock_sizze_46859;\n        sgm_idx_48904 = smod64(block_offset_48903, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        boundary_48905 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_46859, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 - sgm_idx_48904));\n        segsizze_compact_48906 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_46859, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723));\n        thd_offset_48909 = block_offset_48903 + sext_i32_i64(local_tid_48885);\n        // Load and map\n        {\n            for (int64_t i_48910 = 0; i_48910 < chunk_sizze_48873; i_48910++) {\n                int64_t virt_tid_48911 = thd_offset_48909 + i_48910 * segscan_tblock_sizze_46859;\n                int64_t slice_48912 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_46863 = virt_tid_48911;\n                int64_t remnant_48913 = virt_tid_48911 - gtid_46863;\n                \n                if (slt64(virt_tid_48911, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t new_index_46940 = squot64(gtid_46863, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n                    int64_t binop_y_46942 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * new_index_46940;\n                    int64_t new_index_46943 = gtid_46863 - binop_y_46942;\n                    bool index_concat_cmp_46945 = sle6",
                                    "4(n_blocks_41712, new_index_46943);\n                    int64_t index_concat_branch_46949;\n                    \n                    if (index_concat_cmp_46945) {\n                        int64_t index_concat_46947 = ((__global int64_t *) mem_47989)[new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46947;\n                    } else {\n                        int64_t index_concat_46948 = ((__global int64_t *) ext_mem_47981)[new_index_46943 * (int64_t) 4 + new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46948;\n                    }\n                    private_mem_48907[i_48910] = index_concat_branch_46949;\n                } else {\n                    private_mem_48907[i_48910] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48914 = 0; i_48914 < chunk_sizze_48873; i_48914++) {\n                int64_t sharedIdx_48915 = sext_i32_i64(local_tid_48885) + i_48914 * segscan_tblock_sizze_46859;\n                int64_t tmp_48916 = private_mem_48907[i_48914];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48915] = tmp_48916;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48917 = 0; i_48917 < chunk_sizze_48873; i_48917++) {\n                int64_t sharedIdx_48918 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48917;\n                int64_t tmp_48919 = ((__local int64_t *) local_mem_48892)[sharedIdx_48918];\n                \n                private_mem_48907[i_48917] = tmp_48919;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48920 = 0; i_48920 < chunk_sizze_48873 - (int64_t) 1; i_48920++) {\n                int64_t eta_p_41940;\n                int64_t eta_p_41941;\n                \n              ", "  eta_p_41940 = private_mem_48907[i_48920];\n                eta_p_41941 = private_mem_48907[i_48920 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_41942 = add64(eta_p_41940, eta_p_41941);\n                \n                private_mem_48907[i_48920 + (int64_t) 1] = defunc_0_op_res_41942;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_48921 = private_mem_48907[chunk_sizze_48873 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = tmp_48921;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_48922;\n            int64_t eta_p_48923;\n            int64_t eta_p_48926;\n            int64_t eta_p_48927;\n            bool ltid_in_bounds_48929 = slt64(sext_i32_i64(local_tid_48885), num_virt_threads_48875);\n            int32_t skip_threads_48930;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48929) {\n                    eta_p_48923 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                    if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                        eta_p_48922 = eta_p_48923;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48930 = 1;\n                while (slt32(skip_threads_48930, 32)) {\n                    bool thread_active_48931 = sle32(skip_threads_48930, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && ltid_in_bounds_48929;\n                    \n                    if (thread_active_48931) {\n                        // read operands\n                        {\n                            eta_p_48922 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48930)];\n          ", "              }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48931) {\n                            int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                            \n                            eta_p_48922 = defunc_0_op_res_48924;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48931) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                            eta_p_48923 = eta_p_48922;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48930 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 31 && ltid_in_bounds_48929) {\n                    ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32))] = eta_p_48922;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48932;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                        eta_p_48927 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                        if ((loca",
                                    "l_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                            eta_p_48926 = eta_p_48927;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48932 = 1;\n                    while (slt32(skip_threads_48932, 32)) {\n                        bool thread_active_48933 = sle32(skip_threads_48932, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929);\n                        \n                        if (thread_active_48933) {\n                            // read operands\n                            {\n                                eta_p_48926 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48932)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48933) {\n                                int64_t defunc_0_op_res_48928 = add64(eta_p_48926, eta_p_48927);\n                                \n                                eta_p_48926 = defunc_0_op_res_48928;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48933) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48926;\n                                eta_p_48927 = eta_p_48926;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n           ", "             skip_threads_48932 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48934 = squot32(local_tid_48885, 32) == 0 || !ltid_in_bounds_48929;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48934) {\n                        eta_p_48923 = eta_p_48922;\n                        eta_p_48922 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48934) {\n                        int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                        \n                        eta_p_48922 = defunc_0_op_res_48924;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48934) {\n                        ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                    ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48923;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48885 == 0) {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[segscan_tblock_sizze_46859 - (int64_t) 1];\n            } else {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        pr", "efix_48935 = (int64_t) 0;\n        block_new_sgm_48936 = sgm_idx_48904 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48936 && local_tid_48885 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = acc_48925;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                acc_48925 = (int64_t) 0;\n            }\n            if (!block_new_sgm_48936 && slt32(local_tid_48885, wave_sizze_48887)) {\n                if (local_tid_48885 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_48878)[dynamic_id_48902] = acc_48925;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 1;\n                    \n                    int8_t tmp_48937 = ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48892)[(int64_t) 0] = tmp_48937;\n                }\n                mem_fence_local();\n                \n                int8_t status_48938 = ((__local int8_t *) local_mem_48892)[(int64_t) 0];\n                \n                if (status_48938 == (int8_t) 2) {\n                    if (local_tid_48885 == 0) {\n                        prefix_48935 = ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48939 = sext_i64_i32(dynamic_id_48902 - sext_i32_i64(wave_sizze_48887));\n                    \n                    while (slt32(wave_sizze_48887 * -1, readOffset_48939)) {\n                        int32_t read_i_48940 = readOffset_48939 + local_tid_48885;\n                        int64_t aggr_48941 = (int64_t) 0;\n                        int8_t flag_48942 = (int8_t) 0;\n                        \n  ",
                                    "                      if (sle32(0, read_i_48940)) {\n                            flag_48942 = ((volatile __global int8_t *) status_flags_mem_48876)[sext_i32_i64(read_i_48940)];\n                            if (flag_48942 == (int8_t) 2) {\n                                aggr_48941 = ((volatile __global int64_t *) incprefixes_mem_48880)[sext_i32_i64(read_i_48940)];\n                            } else if (flag_48942 == (int8_t) 1) {\n                                aggr_48941 = ((volatile __global int64_t *) aggregates_mem_48878)[sext_i32_i64(read_i_48940)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = aggr_48941;\n                        ((__local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flag_48942;\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        if (slt8(flag_48942, (int8_t) 2)) {\n                            int8_t flg_x_48946;\n                            int8_t flg_y_48947;\n                            int64_t eta_p_48943;\n                            int64_t eta_p_48944;\n                            int32_t skip_threads_48948;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48947 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                                eta_p_48944 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)];\n                                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                                    eta_p_48943 = eta_p_48944;\n                                    flg_x_48946 = flg_y_48947;\n                                }\n                            }\n                            // in-block scan (hopefully no", " barriers needed)\n                            {\n                                skip_threads_48948 = 1;\n                                while (slt32(skip_threads_48948, 32)) {\n                                    if (sle32(skip_threads_48948, local_tid_48885 - squot32(local_tid_48885, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48946 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948)];\n                                            eta_p_48943 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48947 == (int8_t) 2 || flg_y_48947 == (int8_t) 0) {\n                                                flg_x_48946 = flg_y_48947;\n                                                eta_p_48943 = eta_p_48944;\n                                            } else {\n                                                int64_t defunc_0_op_res_48945 = add64(eta_p_48943, eta_p_48944);\n                                                \n                                                eta_p_48943 = defunc_0_op_res_48945;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flg_x_48946;\n                                            flg_y_48947 = flg_x_48946;\n                                            ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = eta_p_48943;", "\n                                            eta_p_48944 = eta_p_48943;\n                                        }\n                                    }\n                                    skip_threads_48948 *= 2;\n                                }\n                            }\n                        }\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        aggr_48941 = ((__local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(wave_sizze_48887) - (int64_t) 1)];\n                        if (flag_48942 == (int8_t) 2) {\n                            readOffset_48939 = wave_sizze_48887 * -1;\n                        } else if (flag_48942 == (int8_t) 1) {\n                            readOffset_48939 -= wave_sizze_48887;\n                        }\n                        if (slt8((int8_t) 0, flag_48942)) {\n                            int64_t eta_p_48949 = aggr_48941;\n                            int64_t eta_p_48950 = prefix_48935;\n                            int64_t defunc_0_op_res_48951 = add64(eta_p_48949, eta_p_48950);\n                            \n                            prefix_48935 = defunc_0_op_res_48951;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48885 == 0) {\n                    if (boundary_48905 == sext_i64_i32(segscan_tblock_sizze_46859 * chunk_sizze_48873)) {\n                        int64_t eta_p_48952 = prefix_48935;\n                        int64_t eta_p_48953 = acc_48925;\n                        int64_t defunc_0_op_res_48954 = add64(eta_p_48952, eta_p_48953);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = defunc_0_op_res_48954;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                  ",
                                    "  }\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 4] = prefix_48935;\n                    acc_48925 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_48902 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48935 = ((__local int64_t *) local_mem_48892)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_48955;\n            int64_t eta_p_48956;\n            int64_t eta_p_48958 = prefix_48935;\n            int64_t eta_p_48959 = acc_48925;\n            \n            if (slt32(local_tid_48885 * chunk_sizze_32b_48889, boundary_48905) && !block_new_sgm_48936) {\n                int64_t defunc_0_op_res_48960 = add64(eta_p_48958, eta_p_48959);\n                \n                eta_p_48955 = defunc_0_op_res_48960;\n            } else {\n                eta_p_48955 = acc_48925;\n            }\n            \n            int32_t stopping_point_48961 = segsizze_compact_48906 - srem32(local_tid_48885 * chunk_sizze_32b_48889 - 1 + segsizze_compact_48906 - boundary_48905, segsizze_compact_48906);\n            \n            for (int64_t i_48962 = 0; i_48962 < chunk_sizze_48873; i_48962++) {\n                if (slt32(sext_i64_i32(i_48962), stopping_point_48961 - 1)) {\n                    eta_p_48956 = private_mem_48907[i_48962];\n                    \n                    int64_t defunc_0_op_res_48957 = add64(eta_p_48955, eta_p_48956);\n                    \n                    private_mem_48907[i_48962] = defunc_0_op_res_48957;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48963 = 0; i_48963 < chunk_sizze_48873; i_48963++) {\n                int64_t sharedIdx_48964 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48963;\n                int64_t tmp_48965 = private_mem_48907[i_48963];\n                \n  ", "              ((__local int64_t *) local_mem_48892)[sharedIdx_48964] = tmp_48965;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48966 = 0; i_48966 < chunk_sizze_48873; i_48966++) {\n                int64_t flat_idx_48967 = thd_offset_48909 + i_48966 * segscan_tblock_sizze_46859;\n                int64_t slice_48968 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_46863 = flat_idx_48967;\n                int64_t remnant_48969 = flat_idx_48967 - gtid_46863;\n                \n                if (slt64(flat_idx_48967, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t tmp_48970 = ((__local int64_t *) local_mem_48892)[flat_idx_48967 - block_offset_48903];\n                    \n                    ((__global int64_t *) mem_47992)[gtid_46863] = tmp_48970;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_46859\n    #undef chunk_sizze_48873\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzigpuseq_48446_dim1, 1, 1)\nvoid sortColumn_longzigpuseq_48446(__global int *global_failure, int64_t m_41736, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47866, __global unsigned char *mem_47867, __global unsigned char *mem_47868, __global unsigned char *mem_47869)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48448;\n    int32_t tblock_sizze_48451;\n    int32_t wave_sizze_48450;\n    int32_t block_id_48449;\n    int32_t global_tid_48447;\n    int64_t tid_48446;\n    int16_t last_res_47806;\n    int16_t last_res_47808;\n    int16_t last_res_47810;\n    int16_t last_res_47812;\n    \n    local_tid_48448 = get_local_id(0);\n    tblock_sizze_48451 = get_local_size(0);\n    wave_sizze_48450 = LOCKSTEP_WIDTH;\n    block_id_48449 = get_tblock_id(0);\n    global_tid_48447", " = block_id_48449 * tblock_sizze_48451 + local_tid_48448;\n    tid_48446 = sext_i32_i64(global_tid_48447);\n    last_res_47806 = ((__global int16_t *) mem_47857)[m_41736];\n    last_res_47808 = ((__global int16_t *) mem_47859)[m_41736];\n    last_res_47810 = ((__global int16_t *) mem_47861)[m_41736];\n    last_res_47812 = ((__global int16_t *) mem_47863)[m_41736];\n    ((__global int16_t *) mem_47866)[(int64_t) 0] = last_res_47806;\n    ((__global int16_t *) mem_47867)[(int64_t) 0] = last_res_47808;\n    ((__global int16_t *) mem_47868)[(int64_t) 0] = last_res_47810;\n    ((__global int16_t *) mem_47869)[(int64_t) 0] = last_res_47812;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzigpuseq_48854_dim1, 1, 1)\nvoid sortColumn_longzigpuseq_48854(__global int *global_failure, __global unsigned char *ext_mem_47871, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47984, __global unsigned char *mem_47985, __global unsigned char *mem_47986, __global unsigned char *mem_47987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48856;\n    int32_t tblock_sizze_48859;\n    int32_t wave_sizze_48858;\n    int32_t block_id_48857;\n    int32_t global_tid_48855;\n    int64_t tid_48854;\n    int16_t defunc_0_radix_sort_step_i16_res_47825;\n    int16_t defunc_0_radix_sort_step_i16_res_47826;\n    int16_t defunc_0_radix_sort_step_i16_res_47827;\n    int16_t defunc_0_radix_sort_step_i16_res_47828;\n    int16_t tmp_47833;\n    int16_t tmp_47837;\n    \n    local_tid_48856 = get_local_id(0);\n    tblock_sizze_48859 = get_local_size(0);\n    wave_sizze_48858 = LOCKSTEP_WIDTH;\n    block_id_48857 = get_tblock_id(0);\n    global_tid_48855 = block_id_48857 * tblock_sizze_48859 + local_tid_48856;\n    tid_48854 = sext_i32_i64(global_tid_48855);\n    defunc_0_radix_sort_step_i16_res_47825 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47826 = ",
                                    "((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47827 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47828 = ((__global int16_t *) ext_mem_47871)[(int64_t) 0];\n    ((__global int16_t *) mem_47984)[(int64_t) 0] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47984)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47826;\n    ((__global int16_t *) mem_47984)[(int64_t) 2] = defunc_0_radix_sort_step_i16_res_47827;\n    ((__global int16_t *) mem_47984)[(int64_t) 3] = defunc_0_radix_sort_step_i16_res_47828;\n    tmp_47833 = add16(defunc_0_radix_sort_step_i16_res_47825, defunc_0_radix_sort_step_i16_res_47826);\n    tmp_47837 = add16(defunc_0_radix_sort_step_i16_res_47827, tmp_47833);\n    ((__global int16_t *) mem_47985)[(int64_t) 0] = (int16_t) 0;\n    ((__global int16_t *) mem_47985)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47985)[(int64_t) 2] = tmp_47833;\n    ((__global int16_t *) mem_47985)[(int64_t) 3] = tmp_47837;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47986)[i_0] = ((__global int16_t *) mem_47984)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47987)[i_0] = ((__global int16_t *) mem_47985)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_44920_dim1, 1, 1)\nvoid sortColumn_longzisegmap_44920(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int64_t num_tblocks_44925, int32_t virt_num_tblocks_48452, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *ext_mem_47872, __global unsigned char *ext_me", "m_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47876, __global unsigned char *mem_47878)\n{\n    #define segmap_tblock_sizze_44923 (sortColumn_longzisegmap_44920zisegmap_tblock_sizze_44923)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48454;\n    int32_t tblock_sizze_48457;\n    int32_t wave_sizze_48456;\n    int32_t block_id_48455;\n    int32_t global_tid_48453;\n    int64_t phys_tid_44920;\n    int32_t phys_tblock_id_48458;\n    int32_t iterations_48459;\n    \n    local_tid_48454 = get_local_id(0);\n    tblock_sizze_48457 = get_local_size(0);\n    wave_sizze_48456 = LOCKSTEP_WIDTH;\n    block_id_48455 = get_tblock_id(0);\n    global_tid_48453 = block_id_48455 * tblock_sizze_48457 + local_tid_48454;\n    phys_tid_44920 = sext_i32_i64(global_tid_48453);\n    phys_tblock_id_48458 = get_tblock_id(0);\n    iterations_48459 = sdiv_up32(virt_num_tblocks_48452 - phys_tblock_id_48458, sext_i64_i32(num_tblocks_44925));\n    for (int32_t i_48460 = 0; i_48460 < iterations_48459; i_48460++) {\n        int32_t virt_tblock_id_48461;\n        int64_t global_tid_48462;\n        int64_t slice_48463;\n        int64_t write_i_44919;\n        int64_t remnant_48464;\n        \n        virt_tblock_id_48461 = phys_tblock_id_48458 + i_48460 * sext_i64_i32(num_tblocks_44925);\n        global_tid_48462 = sext_i32_i64(virt_tblock_id_48461) * segmap_tblock_sizze_44923 + sext_i32_i64(local_tid_48454);\n        slice_48463 = rest_41713;\n        write_i_44919 = global_tid_48462;\n        remnant_48464 = global_tid_48462 - write_i_44919;\n        if (slt64(write_i_44919, rest_41713)) {\n            int16_t defunc_0_radix_sort_step_i16_res_47822;\n            int16_t defunc_0_radix_sort_step_i16_res_47823;\n            int16_t defunc_0_radix_sort_step_i16_res_47824;\n            int16_t eta_p_43645;\n            int16_t eta_p_43646;\n            int16_t eta_p_43647;\n            int16_t eta_p_43648;\n    ", "        int16_t eta_p_43649;\n            int64_t slice_46965;\n            int64_t write_value_43650;\n            int64_t write_value_43651;\n            int64_t defunc_0_f_res_43652;\n            \n            defunc_0_radix_sort_step_i16_res_47822 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47823 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47824 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n            eta_p_43645 = ((__global int16_t *) mem_47865)[write_i_44919];\n            eta_p_43646 = ((__global int16_t *) mem_47857)[write_i_44919];\n            eta_p_43647 = ((__global int16_t *) mem_47859)[write_i_44919];\n            eta_p_43648 = ((__global int16_t *) mem_47861)[write_i_44919];\n            eta_p_43649 = ((__global int16_t *) mem_47863)[write_i_44919];\n            slice_46965 = arg_41714 + write_i_44919;\n            write_value_43650 = ((__global int64_t *) mem_47846)[slice_46965];\n            write_value_43651 = ((__global int64_t *) mem_47848)[slice_46965];\n            futrts_lifted_f_7536(&defunc_0_f_res_43652, defunc_0_radix_sort_step_i16_res_47822, defunc_0_radix_sort_step_i16_res_47823, defunc_0_radix_sort_step_i16_res_47824, eta_p_43645, eta_p_43646, eta_p_43647, eta_p_43648, eta_p_43649);\n            if (sle64((int64_t) 0, defunc_0_f_res_43652) && slt64(defunc_0_f_res_43652, rest_41713)) {\n                ((__global int64_t *) mem_47878)[defunc_0_f_res_43652] = write_value_43650;\n            }\n            if (sle64((int64_t) 0, defunc_0_f_res_43652) && slt64(defunc_0_f_res_43652, rest_41713)) {\n                ((__global int64_t *) mem_47876)[defunc_0_f_res_43652] = write_value_43651;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44923\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_44942_dim1, 1, 1)\nvoid sortColumn_longzisegmap_44942(__glo",
                                    "bal int *global_failure, __global unsigned char *mem_47986, __global unsigned char *mem_47989)\n{\n    #define segmap_tblock_sizze_44938 (sortColumn_longzisegmap_44942zisegmap_tblock_sizze_44938)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48862;\n    int32_t tblock_sizze_48865;\n    int32_t wave_sizze_48864;\n    int32_t block_id_48863;\n    int32_t global_tid_48861;\n    int64_t phys_tid_44942;\n    int64_t global_tid_48866;\n    int64_t slice_48867;\n    int64_t gtid_44941;\n    int64_t remnant_48868;\n    \n    local_tid_48862 = get_local_id(0);\n    tblock_sizze_48865 = get_local_size(0);\n    wave_sizze_48864 = LOCKSTEP_WIDTH;\n    block_id_48863 = get_tblock_id(0);\n    global_tid_48861 = block_id_48863 * tblock_sizze_48865 + local_tid_48862;\n    phys_tid_44942 = sext_i32_i64(global_tid_48861);\n    global_tid_48866 = sext_i32_i64(block_id_48863) * segmap_tblock_sizze_44938 + sext_i32_i64(local_tid_48862);\n    slice_48867 = (int64_t) 4;\n    gtid_44941 = global_tid_48866;\n    remnant_48868 = global_tid_48866 - gtid_44941;\n    if (slt64(gtid_44941, (int64_t) 4)) {\n        int16_t eta_p_44943;\n        int64_t i16_res_44944;\n        \n        eta_p_44943 = ((__global int16_t *) mem_47986)[gtid_44941];\n        i16_res_44944 = sext_i16_i64(eta_p_44943);\n        ((__global int64_t *) mem_47989)[gtid_44941] = i16_res_44944;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44938\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45249_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45249(__global int *global_failure, int64_t i16_res_41708, unsigned char zzero_41709_bits, unsigned char nonzzero_41710_bits, int64_t n_blocks_41712, int64_t tmp_41751, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    bool zzero_41709 = zzero_", "41709_bits;\n    bool nonzzero_41710 = nonzzero_41710_bits;\n    \n    #define segmap_tblock_sizze_45242 (sortColumn_longzisegmap_45249zisegmap_tblock_sizze_45242)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48794;\n    int32_t tblock_sizze_48797;\n    int32_t wave_sizze_48796;\n    int32_t block_id_48795;\n    int32_t global_tid_48793;\n    int64_t phys_tid_45249;\n    int64_t global_tid_48798;\n    int64_t slice_48799;\n    int64_t gtid_45248;\n    int64_t remnant_48800;\n    \n    local_tid_48794 = get_local_id(0);\n    tblock_sizze_48797 = get_local_size(0);\n    wave_sizze_48796 = LOCKSTEP_WIDTH;\n    block_id_48795 = get_tblock_id(0);\n    global_tid_48793 = block_id_48795 * tblock_sizze_48797 + local_tid_48794;\n    phys_tid_45249 = sext_i32_i64(global_tid_48793);\n    global_tid_48798 = sext_i32_i64(block_id_48795) * segmap_tblock_sizze_45242 + sext_i32_i64(local_tid_48794);\n    slice_48799 = n_blocks_41712;\n    gtid_45248 = global_tid_48798;\n    remnant_48800 = global_tid_48798 - gtid_45248;\n    if (slt64(gtid_45248, n_blocks_41712)) {\n        int16_t last_res_45258;\n        int16_t last_res_45259;\n        int16_t last_res_45260;\n        int16_t last_res_45261;\n        int16_t defunc_0_f_res_45254;\n        int16_t defunc_0_f_res_45255;\n        int16_t defunc_0_f_res_45256;\n        int16_t defunc_0_f_res_45257;\n        \n        if (nonzzero_41710) {\n            int16_t x_46956 = ((__global int16_t *) mem_47889)[gtid_45248 * i16_res_41708 + tmp_41751];\n            \n            last_res_45258 = x_46956;\n        } else {\n            last_res_45258 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46958 = ((__global int16_t *) mem_47892)[gtid_45248 * i16_res_41708 + tmp_41751];\n            \n            last_res_45259 = x_46958;\n        } else {\n            last_res_45259 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46960 = ((__global int16_t *) mem_47895)[gtid_45248 * i16_res_41708 + tmp_41751];", "\n            \n            last_res_45260 = x_46960;\n        } else {\n            last_res_45260 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46962 = ((__global int16_t *) mem_47898)[gtid_45248 * i16_res_41708 + tmp_41751];\n            \n            last_res_45261 = x_46962;\n        } else {\n            last_res_45261 = (int16_t) 0;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_45254 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45254 = last_res_45258;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_45255 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45255 = last_res_45259;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_45256 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45256 = last_res_45260;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_45257 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_45257 = last_res_45261;\n        }\n        ((__global int16_t *) mem_47904)[gtid_45248] = defunc_0_f_res_45257;\n        ((__global int16_t *) mem_47906)[gtid_45248] = defunc_0_f_res_45254;\n        ((__global int16_t *) mem_47908)[gtid_45248] = defunc_0_f_res_45255;\n        ((__global int16_t *) mem_47910)[gtid_45248] = defunc_0_f_res_45256;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45242\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45271_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45271(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t num_tblocks_45265, int32_t virt_num_tblocks_48801, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47882, __global unsigned char *mem_47885, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned ",
                                    "char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    #define segmap_tblock_sizze_45264 (sortColumn_longzisegmap_45271zisegmap_tblock_sizze_45264)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48803;\n    int32_t tblock_sizze_48806;\n    int32_t wave_sizze_48805;\n    int32_t block_id_48804;\n    int32_t global_tid_48802;\n    int64_t phys_tid_45271;\n    int32_t phys_tblock_id_48807;\n    int32_t iterations_48808;\n    \n    local_tid_48803 = get_local_id(0);\n    tblock_sizze_48806 = get_local_size(0);\n    wave_sizze_48805 = LOCKSTEP_WIDTH;\n    block_id_48804 = get_tblock_id(0);\n    global_tid_48802 = block_id_48804 * tblock_sizze_48806 + local_tid_48803;\n    phys_tid_45271 = sext_i32_i64(global_tid_48802);\n    phys_tblock_id_48807 = get_tblock_id(0);\n    iterations_48808 = sdiv_up32(virt_num_tblocks_48801 - phys_tblock_id_48807, sext_i64_i32(num_tblocks_45265));\n    for (int32_t i_48809 = 0; i_48809 < iterations_48808; i_48809++) {\n        int32_t virt_tblock_id_48810;\n        int64_t global_tid_48811;\n        int64_t slice_48812;\n        int64_t slice_48813;\n        int64_t gtid_45269;\n        int64_t remnant_48814;\n        int64_t gtid_45270;\n        int64_t remnant_48815;\n        \n        virt_tblock_id_48810 = phys_tblock_id_48807 + i_48809 * sext_i64_i32(num_tblocks_45265);\n        global_tid_48811 = sext_i32_i64(virt_tblock_id_48810) * segmap_tblock_sizze_45264 + sext_i32_i64(local_tid_48803);\n        slice_48812 = i16_res_41708;\n        slice_48813 = n_blocks_41712 * slice_48812;\n        gtid_45269 = squot64(global_tid_48811, slice_48812);\n        remnant_48814 = global_tid_48811 - gtid_45269 * slice_48812;\n        gtid_45270 = remnant_48814;\n        remnant_48815 = remnant_48814 - gtid_45270;\n        if (slt64(gtid_45269, n_blocks_41712) && slt64(gtid_45270, i16_res_41708)) {\n            int16_t defunc_0_f_res_45272;\n          ", "  int16_t defunc_0_f_res_45273;\n            int16_t defunc_0_f_res_45274;\n            int16_t eta_p_45275;\n            int16_t eta_p_45276;\n            int16_t eta_p_45277;\n            int16_t eta_p_45278;\n            int16_t eta_p_45279;\n            int64_t binop_x_46950;\n            int64_t new_index_46951;\n            int64_t write_value_45280;\n            int64_t write_value_45281;\n            int64_t defunc_0_f_res_45282;\n            \n            defunc_0_f_res_45272 = ((__global int16_t *) mem_47906)[gtid_45269];\n            defunc_0_f_res_45273 = ((__global int16_t *) mem_47908)[gtid_45269];\n            defunc_0_f_res_45274 = ((__global int16_t *) mem_47910)[gtid_45269];\n            eta_p_45275 = ((__global int16_t *) mem_47901)[gtid_45269 * i16_res_41708 + gtid_45270];\n            eta_p_45276 = ((__global int16_t *) mem_47889)[gtid_45269 * i16_res_41708 + gtid_45270];\n            eta_p_45277 = ((__global int16_t *) mem_47892)[gtid_45269 * i16_res_41708 + gtid_45270];\n            eta_p_45278 = ((__global int16_t *) mem_47895)[gtid_45269 * i16_res_41708 + gtid_45270];\n            eta_p_45279 = ((__global int16_t *) mem_47898)[gtid_45269 * i16_res_41708 + gtid_45270];\n            binop_x_46950 = i16_res_41708 * gtid_45269;\n            new_index_46951 = gtid_45270 + binop_x_46950;\n            write_value_45280 = ((__global int64_t *) mem_47846)[new_index_46951];\n            write_value_45281 = ((__global int64_t *) mem_47848)[new_index_46951];\n            futrts_lifted_f_7536(&defunc_0_f_res_45282, defunc_0_f_res_45272, defunc_0_f_res_45273, defunc_0_f_res_45274, eta_p_45275, eta_p_45276, eta_p_45277, eta_p_45278, eta_p_45279);\n            if ((sle64((int64_t) 0, gtid_45269) && slt64(gtid_45269, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_45282) && slt64(defunc_0_f_res_45282, i16_res_41708))) {\n                ((__global int64_t *) mem_47882)[gtid_45269 * i16_res_41708 + defunc_0_f_res_45282] = write_value_45280;\n            }\n            if ((sle64((", "int64_t) 0, gtid_45269) && slt64(gtid_45269, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_45282) && slt64(defunc_0_f_res_45282, i16_res_41708))) {\n                ((__global int64_t *) mem_47885)[gtid_45269 * i16_res_41708 + defunc_0_f_res_45282] = write_value_45281;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45264\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45289_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45289(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_45285, int32_t virt_num_tblocks_48816, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47927)\n{\n    #define segmap_tblock_sizze_45284 (sortColumn_longzisegmap_45289zisegmap_tblock_sizze_45284)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48818;\n    int32_t tblock_sizze_48821;\n    int32_t wave_sizze_48820;\n    int32_t block_id_48819;\n    int32_t global_tid_48817;\n    int64_t phys_tid_45289;\n    int32_t phys_tblock_id_48822;\n    int32_t iterations_48823;\n    \n    local_tid_48818 = get_local_id(0);\n    tblock_sizze_48821 = get_local_size(0);\n    wave_sizze_48820 = LOCKSTEP_WIDTH;\n    block_id_48819 = get_tblock_id(0);\n    global_tid_48817 = block_id_48819 * tblock_sizze_48821 + local_tid_48818;\n    phys_tid_45289 = sext_i32_i64(global_tid_48817);\n    phys_tblock_id_48822 = get_tblock_id(0);\n    iterations_48823 = sdiv_up32(virt_num_tblocks_48816 - phys_tblock_id_48822, sext_i64_i32(num_tblocks_45285));\n    for (int32_t i_48824 = 0; i_48824 < iterations_48823; i_48824++) {\n        int32_t virt_tblock_id_48825;\n        int64_t global_tid_48826;\n        int64_t slice_48827;\n        int64_t gtid_45288;\n        int64_t remnant_48828;\n        \n        virt_tblock_id_48825 = phys_tblock_id_48822 + i_48824 * sext_i64_i32(num_tblocks_45",
                                    "285);\n        global_tid_48826 = sext_i32_i64(virt_tblock_id_48825) * segmap_tblock_sizze_45284 + sext_i32_i64(local_tid_48818);\n        slice_48827 = n_blocks_41712;\n        gtid_45288 = global_tid_48826;\n        remnant_48828 = global_tid_48826 - gtid_45288;\n        if (slt64(gtid_45288, n_blocks_41712)) {\n            int16_t defunc_0_f_res_45290;\n            int16_t defunc_0_f_res_45291;\n            int16_t defunc_0_f_res_45292;\n            int16_t defunc_0_f_res_45293;\n            int16_t mem_47917[(int64_t) 4];\n            \n            defunc_0_f_res_45290 = ((__global int16_t *) mem_47906)[gtid_45288];\n            defunc_0_f_res_45291 = ((__global int16_t *) mem_47908)[gtid_45288];\n            defunc_0_f_res_45292 = ((__global int16_t *) mem_47910)[gtid_45288];\n            defunc_0_f_res_45293 = ((__global int16_t *) mem_47904)[gtid_45288];\n            mem_47917[(int64_t) 0] = defunc_0_f_res_45290;\n            mem_47917[(int64_t) 1] = defunc_0_f_res_45291;\n            mem_47917[(int64_t) 2] = defunc_0_f_res_45292;\n            mem_47917[(int64_t) 3] = defunc_0_f_res_45293;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47927)[gtid_45288 + i_0 * n_blocks_41712] = mem_47917[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45284\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45306_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45306(__global int *global_failure, int64_t n_blocks_41712, __global unsigned char *mem_47927, __global unsigned char *mem_47931)\n{\n    #define segmap_tblock_sizze_45301 (sortColumn_longzisegmap_45306zisegmap_tblock_sizze_45301)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48831;\n    int32_t tblock_sizze_48834;\n    int32_t wave_sizze_48833;\n    int32_t block_id_48832;\n    int32_t global_tid_48830;\n    int64_t phys_tid_45306;\n    int64_t global_tid_48835;\n    ", "int64_t slice_48836;\n    int64_t slice_48837;\n    int64_t gtid_45304;\n    int64_t remnant_48838;\n    int64_t gtid_45305;\n    int64_t remnant_48839;\n    \n    local_tid_48831 = get_local_id(0);\n    tblock_sizze_48834 = get_local_size(0);\n    wave_sizze_48833 = LOCKSTEP_WIDTH;\n    block_id_48832 = get_tblock_id(0);\n    global_tid_48830 = block_id_48832 * tblock_sizze_48834 + local_tid_48831;\n    phys_tid_45306 = sext_i32_i64(global_tid_48830);\n    global_tid_48835 = sext_i32_i64(block_id_48832) * segmap_tblock_sizze_45301 + sext_i32_i64(local_tid_48831);\n    slice_48836 = (int64_t) 4;\n    slice_48837 = n_blocks_41712 * slice_48836;\n    gtid_45304 = squot64(global_tid_48835, slice_48836);\n    remnant_48838 = global_tid_48835 - gtid_45304 * slice_48836;\n    gtid_45305 = remnant_48838;\n    remnant_48839 = remnant_48838 - gtid_45305;\n    if (slt64(gtid_45304, n_blocks_41712) && slt64(gtid_45305, (int64_t) 4)) {\n        int16_t eta_p_45307;\n        int64_t i16_res_45308;\n        \n        eta_p_45307 = ((__global int16_t *) mem_47927)[gtid_45304 + gtid_45305 * n_blocks_41712];\n        i16_res_45308 = sext_i16_i64(eta_p_45307);\n        ((__global int64_t *) mem_47931)[gtid_45304 * (int64_t) 4 + gtid_45305] = i16_res_45308;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45301\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45316_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45316(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_45312, int32_t virt_num_tblocks_48840, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47947)\n{\n    #define segmap_tblock_sizze_45311 (sortColumn_longzisegmap_45316zisegmap_tblock_sizze_45311)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48842;\n    int32_t tblock_sizze_48845;\n    int32_t wave_sizze_48844;\n    int32_t block_id_48843;\n    int32_t global_tid_48841;\n    int64_t phys_tid_45316;\n    int32_t phys", "_tblock_id_48846;\n    int32_t iterations_48847;\n    \n    local_tid_48842 = get_local_id(0);\n    tblock_sizze_48845 = get_local_size(0);\n    wave_sizze_48844 = LOCKSTEP_WIDTH;\n    block_id_48843 = get_tblock_id(0);\n    global_tid_48841 = block_id_48843 * tblock_sizze_48845 + local_tid_48842;\n    phys_tid_45316 = sext_i32_i64(global_tid_48841);\n    phys_tblock_id_48846 = get_tblock_id(0);\n    iterations_48847 = sdiv_up32(virt_num_tblocks_48840 - phys_tblock_id_48846, sext_i64_i32(num_tblocks_45312));\n    for (int32_t i_48848 = 0; i_48848 < iterations_48847; i_48848++) {\n        int32_t virt_tblock_id_48849;\n        int64_t global_tid_48850;\n        int64_t slice_48851;\n        int64_t gtid_45315;\n        int64_t remnant_48852;\n        \n        virt_tblock_id_48849 = phys_tblock_id_48846 + i_48848 * sext_i64_i32(num_tblocks_45312);\n        global_tid_48850 = sext_i32_i64(virt_tblock_id_48849) * segmap_tblock_sizze_45311 + sext_i32_i64(local_tid_48842);\n        slice_48851 = n_blocks_41712;\n        gtid_45315 = global_tid_48850;\n        remnant_48852 = global_tid_48850 - gtid_45315;\n        if (slt64(gtid_45315, n_blocks_41712)) {\n            int16_t defunc_0_f_res_45317;\n            int16_t defunc_0_f_res_45318;\n            int16_t defunc_0_f_res_45319;\n            int16_t tmp_45320;\n            int16_t tmp_45321;\n            int16_t mem_47937[(int64_t) 4];\n            \n            defunc_0_f_res_45317 = ((__global int16_t *) mem_47906)[gtid_45315];\n            defunc_0_f_res_45318 = ((__global int16_t *) mem_47908)[gtid_45315];\n            defunc_0_f_res_45319 = ((__global int16_t *) mem_47910)[gtid_45315];\n            tmp_45320 = add16(defunc_0_f_res_45317, defunc_0_f_res_45318);\n            tmp_45321 = add16(defunc_0_f_res_45319, tmp_45320);\n            mem_47937[(int64_t) 0] = (int16_t) 0;\n            mem_47937[(int64_t) 1] = defunc_0_f_res_45317;\n            mem_47937[(int64_t) 2] = tmp_45320;\n            mem_47937[(int64_t) 3] = tmp_45321;\n            for (int64_",
                                    "t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47947)[gtid_45315 + i_0 * n_blocks_41712] = mem_47937[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45311\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45352_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45352(__global int *global_failure, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, __global unsigned char *mem_47992, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_45348 (sortColumn_longzisegmap_45352zisegmap_tblock_sizze_45348)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48973;\n    int32_t tblock_sizze_48976;\n    int32_t wave_sizze_48975;\n    int32_t block_id_48974;\n    int32_t global_tid_48972;\n    int64_t phys_tid_45352;\n    int64_t global_tid_48977;\n    int64_t slice_48978;\n    int64_t gtid_45351;\n    int64_t remnant_48979;\n    \n    local_tid_48973 = get_local_id(0);\n    tblock_sizze_48976 = get_local_size(0);\n    wave_sizze_48975 = LOCKSTEP_WIDTH;\n    block_id_48974 = get_tblock_id(0);\n    global_tid_48972 = block_id_48974 * tblock_sizze_48976 + local_tid_48973;\n    phys_tid_45352 = sext_i32_i64(global_tid_48972);\n    global_tid_48977 = sext_i32_i64(block_id_48974) * segmap_tblock_sizze_45348 + sext_i32_i64(local_tid_48973);\n    slice_48978 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n    gtid_45351 = global_tid_48977;\n    remnant_48979 = global_tid_48977 - gtid_45351;\n    if (slt64(gtid_45351, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n        int64_t zv_lhs_45354;\n        int64_t tmp_45355;\n        int64_t lifted_lambda_res_45356;\n        \n        zv_lhs_45354 = add64((int64_t) -1, gtid_45351);\n        tmp_45355 = smod64(zv_lhs_45354, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        lifted_lambda_res_45356 = ((__global int64_t *) mem_47992)[tmp_45355];\n        ((_", "_global int64_t *) mem_47995)[gtid_45351] = lifted_lambda_res_45356;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45348\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45358_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45358(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t arg_41714, int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int32_t blocked_radix_sort_step_arg1_41776, int64_t num_tblocks_45363, int64_t ext_47978, int64_t ext_47979, int32_t virt_num_tblocks_48980, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47876, __global unsigned char *mem_47878, __global unsigned char *ext_mem_47980, __global unsigned char *ext_mem_47982, __global unsigned char *ext_mem_47983, __global unsigned char *mem_47987, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_45361 (sortColumn_longzisegmap_45358zisegmap_tblock_sizze_45361)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48982;\n    int32_t tblock_sizze_48985;\n    int32_t wave_sizze_48984;\n    int32_t block_id_48983;\n    int32_t global_tid_48981;\n    int64_t phys_tid_45358;\n    int32_t phys_tblock_id_48986;\n    int32_t iterations_48987;\n    \n    local_tid_48982 = get_local_id(0);\n    tblock_sizze_48985 = get_local_size(0);\n    wave_sizze_48984 = LOCKSTEP_WIDTH;\n    block_id_48983 = get_tblock_id(0);\n    global_tid_48981 = block_id_48983 * tblock_sizze_48985 + local_tid_48982;\n    phys_tid_45358 = sext_i32_i64(global_tid_48981);\n    phys_tblock_id_48986 = get_tblock_id(0);\n    iterations_48987 = sdiv_up32(virt_num_tblocks_48980 - phys_tblock_id_48986, sext_i64_i32(num_tblocks_45363));\n    for (int32_t i_48988 = 0; i_48988 < iterations_48987; i_48988++) {\n        int32_t ", "virt_tblock_id_48989;\n        int64_t global_tid_48990;\n        int64_t slice_48991;\n        int64_t write_i_45357;\n        int64_t remnant_48992;\n        \n        virt_tblock_id_48989 = phys_tblock_id_48986 + i_48988 * sext_i64_i32(num_tblocks_45363);\n        global_tid_48990 = sext_i32_i64(virt_tblock_id_48989) * segmap_tblock_sizze_45361 + sext_i32_i64(local_tid_48982);\n        slice_48991 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;\n        write_i_45357 = global_tid_48990;\n        remnant_48992 = global_tid_48990 - write_i_45357;\n        if (slt64(write_i_45357, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n            bool index_concat_cmp_46931;\n            int64_t index_concat_branch_43604;\n            int32_t zlzb_rhs_43611;\n            int32_t acc_43613;\n            int64_t i32_res_43621;\n            int64_t block_idx_43622;\n            bool x_43623;\n            bool y_43624;\n            bool bounds_check_43625;\n            bool index_certs_43626;\n            bool x_43627;\n            bool y_43628;\n            bool bounds_check_43629;\n            bool index_certs_43630;\n            int64_t index_concat_branch_46935;\n            int64_t index_concat_branch_46929;\n            int64_t binop_x_43631;\n            int64_t new_index_43632;\n            int64_t new_offset_43633;\n            bool index_concat_cmp_43634;\n            int16_t index_concat_branch_43635;\n            int64_t i16_res_43638;\n            int64_t zp_lhs_43639;\n            int64_t old_offset_43640;\n            int64_t zp_lhs_43641;\n            int64_t idx_43642;\n            \n            index_concat_cmp_46931 = sle64(arg_41714, write_i_45357);\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_43794;\n                int64_t index_concat_43795;\n                \n                index_concat_i_43794 = sub64(write_i_45357, arg_41714);\n                index_concat_43795 = ((__global int64_t *) mem_47878)[index_conca",
                                    "t_i_43794];\n                index_concat_branch_43604 = index_concat_43795;\n            } else {\n                int64_t new_index_43607;\n                int64_t binop_y_43608;\n                int64_t new_index_43609;\n                int64_t index_concat_43610;\n                \n                new_index_43607 = squot64(write_i_45357, i16_res_41708);\n                binop_y_43608 = i16_res_41708 * new_index_43607;\n                new_index_43609 = write_i_45357 - binop_y_43608;\n                index_concat_43610 = ((__global int64_t *) ext_mem_47983)[new_index_43607 * i16_res_41708 + new_index_43609];\n                index_concat_branch_43604 = index_concat_43610;\n            }\n            acc_43613 = 0;\n            for (int32_t i_43612 = 0; i_43612 < 2; i_43612++) {\n                int32_t get_bit_arg0_43614;\n                int32_t defunc_0_get_bit_res_43615;\n                bool cond_43616;\n                int32_t defunc_0_get_bit_res_43617;\n                int32_t zp_rhs_43619;\n                int32_t loopres_43620;\n                int32_t acc_tmp_48993;\n                \n                get_bit_arg0_43614 = add32(blocked_radix_sort_step_arg1_41776, i_43612);\n                futrts_get_bit_2253(&defunc_0_get_bit_res_43615, get_bit_arg0_43614, index_concat_branch_43604);\n                cond_43616 = get_bit_arg0_43614 == 63;\n                if (cond_43616) {\n                    int32_t defunc_0_get_bit_res_t_res_43796 = 1 ^ defunc_0_get_bit_res_43615;\n                    \n                    defunc_0_get_bit_res_43617 = defunc_0_get_bit_res_t_res_43796;\n                } else {\n                    defunc_0_get_bit_res_43617 = defunc_0_get_bit_res_43615;\n                }\n                zp_rhs_43619 = shl32(defunc_0_get_bit_res_43617, i_43612);\n                loopres_43620 = add32(acc_43613, zp_rhs_43619);\n                acc_tmp_48993 = loopres_43620;\n                acc_43613 = acc_tmp_48993;\n            }\n            zlzb_rhs_43611 = acc_43613;\n            i32_", "res_43621 = sext_i32_i64(zlzb_rhs_43611);\n            block_idx_43622 = sdiv64(write_i_45357, i16_res_41708);\n            x_43623 = sle64((int64_t) 0, block_idx_43622);\n            y_43624 = slt64(block_idx_43622, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n            bounds_check_43625 = x_43623 && y_43624;\n            if (!bounds_check_43625) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 18) == -1) {\n                        global_failure_args[0] = (int64_t) block_idx_43622;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_43627 = sle64((int64_t) 0, i32_res_43621);\n            y_43628 = slt64(i32_res_43621, (int64_t) 4);\n            bounds_check_43629 = x_43627 && y_43628;\n            if (!bounds_check_43629) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 19) == -1) {\n                        global_failure_args[0] = (int64_t) i32_res_43621;\n                        global_failure_args[1] = (int64_t) (int64_t) 4;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46932;\n                int64_t index_concat_46933;\n                \n                index_concat_i_46932 = sub64(write_i_45357, arg_41714);\n                index_concat_46933 = ((__global int64_t *) mem_47878)[index_concat_i_46932];\n                index_concat_branch_46935 = index_concat_46933;\n            } else {\n                int64_t new_index_46972;\n                int64_t binop_y_46974;\n                int64_t new_index_46975;\n                int64_t index_concat_46934;\n                \n                new_index_46972 = squot64(w", "rite_i_45357, i16_res_41708);\n                binop_y_46974 = i16_res_41708 * new_index_46972;\n                new_index_46975 = write_i_45357 - binop_y_46974;\n                index_concat_46934 = ((__global int64_t *) ext_mem_47983)[new_index_46972 * i16_res_41708 + new_index_46975];\n                index_concat_branch_46935 = index_concat_46934;\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46926;\n                int64_t index_concat_46927;\n                \n                index_concat_i_46926 = sub64(write_i_45357, arg_41714);\n                index_concat_46927 = ((__global int64_t *) mem_47876)[index_concat_i_46926];\n                index_concat_branch_46929 = index_concat_46927;\n            } else {\n                int64_t new_index_46968;\n                int64_t binop_y_46970;\n                int64_t new_index_46971;\n                int64_t index_concat_46928;\n                \n                new_index_46968 = squot64(write_i_45357, i16_res_41708);\n                binop_y_46970 = i16_res_41708 * new_index_46968;\n                new_index_46971 = write_i_45357 - binop_y_46970;\n                index_concat_46928 = ((__global int64_t *) ext_mem_47982)[new_index_46968 * i16_res_41708 + new_index_46971];\n                index_concat_branch_46929 = index_concat_46928;\n            }\n            binop_x_43631 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * i32_res_43621;\n            new_index_43632 = block_idx_43622 + binop_x_43631;\n            new_offset_43633 = ((__global int64_t *) mem_47995)[new_index_43632];\n            index_concat_cmp_43634 = sle64(n_blocks_41712, block_idx_43622);\n            if (index_concat_cmp_43634) {\n                int16_t index_concat_43797 = ((__global int16_t *) mem_47987)[i32_res_43621];\n                \n                index_concat_branch_43635 = index_concat_43797;\n            } else {\n                int16_t index_concat_43637 = ((__global int16_t *) ext_mem_47980)[block_idx_43622 * ext_479",
                                    "79 + i32_res_43621 * ext_47978];\n                \n                index_concat_branch_43635 = index_concat_43637;\n            }\n            i16_res_43638 = sext_i16_i64(index_concat_branch_43635);\n            zp_lhs_43639 = mul64(i16_res_41708, block_idx_43622);\n            old_offset_43640 = add64(i16_res_43638, zp_lhs_43639);\n            zp_lhs_43641 = sub64(write_i_45357, old_offset_43640);\n            idx_43642 = add64(new_offset_43633, zp_lhs_43641);\n            if (sle64((int64_t) 0, idx_43642) && slt64(idx_43642, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int64_t *) mem_47846)[idx_43642] = index_concat_branch_46935;\n            }\n            if (sle64((int64_t) 0, idx_43642) && slt64(idx_43642, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int64_t *) mem_47848)[idx_43642] = index_concat_branch_46929;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_45361\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegmap_45386_dim1, 1, 1)\nvoid sortColumn_longzisegmap_45386(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_30101, int64_t incr_30102, __global unsigned char *xs_mem_47844, __global unsigned char *mem_47848, __global unsigned char *mem_48005, __global unsigned char *mem_48007)\n{\n    #define segmap_tblock_sizze_45381 (sortColumn_longzisegmap_45386zisegmap_tblock_sizze_45381)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48996;\n    int32_t tblock_sizze_48999;\n    int32_t wave_sizze_48998;\n    int32_t block_id_48997;\n    int32_t global_tid_48995;\n    int64_t phys_tid_45386;\n    int64_t global_tid_49000;\n    int64_t slice_49001;\n    int64_t gtid_45385;\n ", "   int64_t remnant_49002;\n    \n    local_tid_48996 = get_local_id(0);\n    tblock_sizze_48999 = get_local_size(0);\n    wave_sizze_48998 = LOCKSTEP_WIDTH;\n    block_id_48997 = get_tblock_id(0);\n    global_tid_48995 = block_id_48997 * tblock_sizze_48999 + local_tid_48996;\n    phys_tid_45386 = sext_i32_i64(global_tid_48995);\n    global_tid_49000 = sext_i32_i64(block_id_48997) * segmap_tblock_sizze_45381 + sext_i32_i64(local_tid_48996);\n    slice_49001 = n_30101;\n    gtid_45385 = global_tid_49000;\n    remnant_49002 = global_tid_49000 - gtid_45385;\n    if (slt64(gtid_45385, n_30101)) {\n        int64_t eta_p_45387;\n        bool x_45388;\n        bool y_45389;\n        bool bounds_check_45390;\n        bool index_certs_45391;\n        int64_t index_primexp_45392;\n        int64_t lifted_lambda_res_45393;\n        \n        eta_p_45387 = ((__global int64_t *) mem_47848)[gtid_45385];\n        x_45388 = sle64((int64_t) 0, eta_p_45387);\n        y_45389 = slt64(eta_p_45387, n_30101);\n        bounds_check_45390 = x_45388 && y_45389;\n        if (!bounds_check_45390) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 20) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_45387;\n                    global_failure_args[1] = (int64_t) n_30101;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_45392 = add64(incr_30102, eta_p_45387);\n        lifted_lambda_res_45393 = ((__global int64_t *) xs_mem_47844)[eta_p_45387];\n        ((__global int64_t *) mem_48005)[gtid_45385] = index_primexp_45392;\n        ((__global int64_t *) mem_48007)[gtid_45385] = lifted_lambda_res_45393;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_45381\n}\nFUTHARK_KERNEL\nvoid sortColumn_longzisegmap_intrablock_44974(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, unsigned char zzero_41709_bits, int64_t n_blocks_41712, int64_t tmp_417", "51, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t computed_tblock_sizze_44947, int64_t bytes_47949, int64_t bytes_47953, int64_t maxSubHelper_48094, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47968, __global unsigned char *mem_47971, __global unsigned char *mem_47974, __global unsigned char *mem_47977)\n{\n    bool zzero_41709 = zzero_41709_bits;\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    volatile __local unsigned char *color_48102_backing_7 = &shared_mem[0];\n    const int64_t color_48102_backing_7_offset = 0 + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48101_backing_6 = &shared_mem[color_48102_backing_7_offset];\n    const int64_t color_48101_backing_6_offset = color_48102_backing_7_offset + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48100_backing_5 = &shared_mem[color_48101_backing_6_offset];\n    const int64_t color_48100_backing_5_offset = color_48101_backing_6_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48099_backing_4 = &shared_mem[color_48100_backing_5_offset];\n    const int64_t color_48099_backing_4_offset = color_48100_backing_5_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_3 = &shared_mem[color_48099_backing_4_offset];\n    const int64_t color_48098_backing_3_offset = color_48099_backing_4_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48097_backing_2 = &shared_mem[color_48098_backing_3_offset];\n    const int64_t color_48097_backi",
                                    "ng_2_offset = color_48098_backing_3_offset + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48096_backing_1 = &shared_mem[color_48097_backing_2_offset];\n    const int64_t color_48096_backing_1_offset = color_48097_backing_2_offset + (int64_t) 32;\n    volatile __local unsigned char *color_48095_backing_0 = &shared_mem[color_48096_backing_1_offset];\n    const int64_t color_48095_backing_0_offset = color_48096_backing_1_offset + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48469;\n    int32_t tblock_sizze_48472;\n    int32_t wave_sizze_48471;\n    int32_t block_id_48470;\n    int32_t global_tid_48468;\n    int64_t phys_tblock_id_44974;\n    int64_t slice_48474;\n    int64_t ltid_pre_48473;\n    int64_t remnant_48475;\n    int64_t slice_48477;\n    int64_t ltid_pre_48476;\n    int64_t remnant_48478;\n    int64_t slice_48479;\n    int64_t gtid_44973;\n    int64_t remnant_48480;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    __local unsigned char *color_48100;\n    __local unsigned char *color_48101;\n    __local unsigned char *color_48102;\n    int32_t num_chunks_48481;\n    int32_t num_chunks_48484;\n    int64_t binop_x_46980;\n    int64_t phys_tid_44989;\n    int64_t gtid_44988;\n    int64_t dims_flat_48487;\n    int16_t eta_p_44990;\n    int16_t eta_p_44991;\n    int16_t eta_p_44992;\n    int16_t eta_p_44993;\n    int16_t eta_p_44994;\n    int16_t eta_p_44995;\n    int16_t eta_p_44996;\n    int16_t eta_p_44997;\n    int16_t eta_p_48492;\n    int16_t eta_p_48493;\n    int16_t eta_p_48494;\n    int16_t eta_p_48495;\n    int16_t eta_p_48496;\n    int16_t eta_p_48497;\n    int16_t et", "a_p_48498;\n    int16_t eta_p_48499;\n    bool ltid_in_bounds_48504;\n    int32_t skip_threads_48505;\n    bool no_carry_in_48511;\n    int16_t defunc_0_f_res_45016;\n    int16_t defunc_0_f_res_45017;\n    int16_t defunc_0_f_res_45018;\n    int16_t defunc_0_f_res_45019;\n    int64_t phys_tid_45027;\n    int64_t write_i_45026;\n    int64_t phys_tid_45039;\n    int64_t gtid_45038;\n    int16_t tmp_45042;\n    int16_t tmp_45043;\n    int32_t num_chunks_48513;\n    int32_t num_chunks_48516;\n    int32_t num_chunks_48519;\n    int32_t num_chunks_48522;\n    \n    local_tid_48469 = get_local_id(0);\n    tblock_sizze_48472 = get_local_size(0);\n    wave_sizze_48471 = LOCKSTEP_WIDTH;\n    block_id_48470 = get_tblock_id(0);\n    global_tid_48468 = block_id_48470 * tblock_sizze_48472 + local_tid_48469;\n    phys_tblock_id_44974 = sext_i32_i64(block_id_48470);\n    slice_48474 = (int64_t) 4;\n    ltid_pre_48473 = sext_i32_i64(local_tid_48469);\n    remnant_48475 = sext_i32_i64(local_tid_48469) - ltid_pre_48473;\n    slice_48477 = i16_res_41708;\n    ltid_pre_48476 = sext_i32_i64(local_tid_48469);\n    remnant_48478 = sext_i32_i64(local_tid_48469) - ltid_pre_48476;\n    slice_48479 = n_blocks_41712;\n    gtid_44973 = sext_i32_i64(block_id_48470);\n    remnant_48480 = sext_i32_i64(block_id_48470) - gtid_44973;\n    color_48095 = (__local unsigned char *) color_48095_backing_0;\n    color_48096 = (__local unsigned char *) color_48096_backing_1;\n    color_48097 = (__local unsigned char *) color_48097_backing_2;\n    color_48098 = (__local unsigned char *) color_48098_backing_3;\n    color_48099 = (__local unsigned char *) color_48099_backing_4;\n    color_48100 = (__local unsigned char *) color_48100_backing_5;\n    color_48101 = (__local unsigned char *) color_48101_backing_6;\n    color_48102 = (__local unsigned char *) color_48102_backing_7;\n    num_chunks_48481 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48482 = 0; chunk_i_48482 < num_chunks_48481; chu", "nk_i_48482++) {\n        int32_t i_48483 = chunk_i_48482 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48483, sext_i64_i32(i16_res_41708))) {\n            ((__local int64_t *) color_48102)[sext_i32_i64(i_48483)] = ((__global int64_t *) mem_47846)[(int64_t) 0 + gtid_44973 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48483)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48484 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48485 = 0; chunk_i_48485 < num_chunks_48484; chunk_i_48485++) {\n        int32_t i_48486 = chunk_i_48485 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48486, sext_i64_i32(i16_res_41708))) {\n            ((__local int64_t *) color_48101)[sext_i32_i64(i_48486)] = ((__global int64_t *) mem_47848)[(int64_t) 0 + gtid_44973 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48486)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    binop_x_46980 = i16_res_41708 * gtid_44973;\n    phys_tid_44989 = sext_i32_i64(local_tid_48469);\n    gtid_44988 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(gtid_44988, i16_res_41708)) {\n        int64_t new_index_46981;\n        int64_t eta_p_45002;\n        int32_t defunc_0_get_bit_res_45003;\n        int32_t defunc_0_get_bit_res_45004;\n        int32_t zp_lhs_45006;\n        int32_t defunc_0_get_bit_res_45007;\n        int32_t defunc_0_get_bit_res_45008;\n        int32_t i32_arg0_45010;\n        int16_t i32_res_45011;\n        int16_t defunc_0_f_res_45012;\n        int16_t defunc_0_f_res_45013;\n        int16_t defunc_0_f_res_45014;\n        int16_t defunc_0_f_res_45015;\n        \n        new_index_46981 = gtid_44988 + binop_x_46980;\n        eta_p_45002 = ((__global int64_t *) mem_47846)[new_index_46981];\n        futrts_get_bit_2253(&defunc_0_get_bit_res_45003, get_bit_arg0_41781, eta_p_45002);\n        if (cond_41782) {\n            int32_t defunc_0_get",
                                    "_bit_res_t_res_45005 = 1 ^ defunc_0_get_bit_res_45003;\n            \n            defunc_0_get_bit_res_45004 = defunc_0_get_bit_res_t_res_45005;\n        } else {\n            defunc_0_get_bit_res_45004 = defunc_0_get_bit_res_45003;\n        }\n        zp_lhs_45006 = mul32(2, defunc_0_get_bit_res_45004);\n        futrts_get_bit_2253(&defunc_0_get_bit_res_45007, blocked_radix_sort_step_arg1_41776, eta_p_45002);\n        if (cond_41783) {\n            int32_t defunc_0_get_bit_res_t_res_45009 = 1 ^ defunc_0_get_bit_res_45007;\n            \n            defunc_0_get_bit_res_45008 = defunc_0_get_bit_res_t_res_45009;\n        } else {\n            defunc_0_get_bit_res_45008 = defunc_0_get_bit_res_45007;\n        }\n        i32_arg0_45010 = add32(zp_lhs_45006, defunc_0_get_bit_res_45008);\n        i32_res_45011 = sext_i32_i16(i32_arg0_45010);\n        futrts_lifted_lambda_7535(&defunc_0_f_res_45012, &defunc_0_f_res_45013, &defunc_0_f_res_45014, &defunc_0_f_res_45015, i32_res_45011);\n        ((__local int16_t *) color_48100)[gtid_44988] = defunc_0_f_res_45012;\n        ((__local int16_t *) color_48099)[gtid_44988] = defunc_0_f_res_45013;\n        ((__local int16_t *) color_48098)[gtid_44988] = defunc_0_f_res_45014;\n        ((__local int16_t *) color_48097)[gtid_44988] = defunc_0_f_res_45015;\n        ((__local int16_t *) color_48095)[gtid_44988] = i32_res_45011;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dims_flat_48487 = i16_res_41708;\n    ltid_in_bounds_48504 = slt64(sext_i32_i64(local_tid_48469), i16_res_41708);\n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_48504) {\n            eta_p_44994 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n            eta_p_44995 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n            eta_p_44996 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n            eta_p_44997 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n    ", "        if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                eta_p_44990 = eta_p_44994;\n                eta_p_44991 = eta_p_44995;\n                eta_p_44992 = eta_p_44996;\n                eta_p_44993 = eta_p_44997;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_48505 = 1;\n        while (slt32(skip_threads_48505, 32)) {\n            bool thread_active_48506 = sle32(skip_threads_48505, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && ltid_in_bounds_48504;\n            \n            if (thread_active_48506) {\n                // read operands\n                {\n                    eta_p_44990 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44991 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44992 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44993 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                }\n            }\n            // perform operation\n            {\n                bool inactive_48507 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(local_tid_48469 - skip_threads_48505));\n                \n                if (thread_active_48506 && inactive_48507) {\n                    eta_p_44990 = eta_p_44994;\n                    eta_p_44991 = eta_p_44995;\n                    eta_p_44992 = eta_p_44996;\n                    eta_p_44993 = eta_p_44997;\n                }\n                if (thread_active_48506) {\n                    if (!inactive_48507) {\n                        int16_t defunc_0_op_res_44998 = add16(eta_p_44990, eta_p_44994);\n                        int16_t defunc_0_op", "_res_44999 = add16(eta_p_44991, eta_p_44995);\n                        int16_t defunc_0_op_res_45000 = add16(eta_p_44992, eta_p_44996);\n                        int16_t defunc_0_op_res_45001 = add16(eta_p_44993, eta_p_44997);\n                        \n                        eta_p_44990 = defunc_0_op_res_44998;\n                        eta_p_44991 = defunc_0_op_res_44999;\n                        eta_p_44992 = defunc_0_op_res_45000;\n                        eta_p_44993 = defunc_0_op_res_45001;\n                    }\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (thread_active_48506) {\n                // write result\n                {\n                    ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44990;\n                    eta_p_44994 = eta_p_44990;\n                    ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44991;\n                    eta_p_44995 = eta_p_44991;\n                    ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_44992;\n                    eta_p_44996 = eta_p_44992;\n                    ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44993;\n                    eta_p_44997 = eta_p_44993;\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            skip_threads_48505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 31 && ltid_in_bounds_48504) {\n            ((volatile __local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44990;\n            ((volatile __local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469,",
                                    " 32))] = eta_p_44991;\n            ((volatile __local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44992;\n            ((volatile __local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44993;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_48508;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n                eta_p_48496 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n                eta_p_48497 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n                eta_p_48498 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n                eta_p_48499 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n                if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                    eta_p_48492 = eta_p_48496;\n                    eta_p_48493 = eta_p_48497;\n                    eta_p_48494 = eta_p_48498;\n                    eta_p_48495 = eta_p_48499;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_48508 = 1;\n            while (slt32(skip_threads_48508, 32)) {\n                bool thread_active_48509 = sle32(skip_threads_48508, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504);\n                \n                if (thread_active_48509) {\n                    // read operands\n                    {\n                        eta_p_48492 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48493 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(loc", "al_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48494 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48495 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48510 = slt64(srem64(sext_i32_i64(local_tid_48469 * 32 + 32 - 1), i16_res_41708), sext_i32_i64(local_tid_48469 * 32 + 32 - 1) - sext_i32_i64((local_tid_48469 - skip_threads_48508) * 32 + 32 - 1));\n                    \n                    if (thread_active_48509 && inactive_48510) {\n                        eta_p_48492 = eta_p_48496;\n                        eta_p_48493 = eta_p_48497;\n                        eta_p_48494 = eta_p_48498;\n                        eta_p_48495 = eta_p_48499;\n                    }\n                    if (thread_active_48509) {\n                        if (!inactive_48510) {\n                            int16_t defunc_0_op_res_48500 = add16(eta_p_48492, eta_p_48496);\n                            int16_t defunc_0_op_res_48501 = add16(eta_p_48493, eta_p_48497);\n                            int16_t defunc_0_op_res_48502 = add16(eta_p_48494, eta_p_48498);\n                            int16_t defunc_0_op_res_48503 = add16(eta_p_48495, eta_p_48499);\n                            \n                            eta_p_48492 = defunc_0_op_res_48500;\n                            eta_p_48493 = defunc_0_op_res_48501;\n                            eta_p_48494 = defunc_0_op_res_48502;\n                            eta_p_48495 = defunc_0_op_res_48503;\n                        }\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (thread_active_48509) {\n                ", "    // write result\n                    {\n                        ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_48492;\n                        eta_p_48496 = eta_p_48492;\n                        ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_48493;\n                        eta_p_48497 = eta_p_48493;\n                        ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_48494;\n                        eta_p_48498 = eta_p_48494;\n                        ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_48495;\n                        eta_p_48499 = eta_p_48495;\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_48508 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    no_carry_in_48511 = squot32(local_tid_48469, 32) == 0 || !ltid_in_bounds_48504;\n    // carry-in for every block except the first\n    {\n        // read operands\n        {\n            if (!no_carry_in_48511) {\n                eta_p_44994 = eta_p_44990;\n                eta_p_44995 = eta_p_44991;\n                eta_p_44996 = eta_p_44992;\n                eta_p_44997 = eta_p_44993;\n                eta_p_44990 = ((__local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_44991 = ((__local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_44992 = ((__local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_44993 = ((__local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n            }\n        }\n        // perform operation\n        {\n            bool inactive_48512 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_r",
                                    "es_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(squot32(local_tid_48469, 32) * 32 - 1));\n            \n            if (!no_carry_in_48511) {\n                if (inactive_48512) {\n                    eta_p_44990 = eta_p_44994;\n                    eta_p_44991 = eta_p_44995;\n                    eta_p_44992 = eta_p_44996;\n                    eta_p_44993 = eta_p_44997;\n                }\n            }\n            if (!no_carry_in_48511) {\n                if (!inactive_48512) {\n                    int16_t defunc_0_op_res_44998 = add16(eta_p_44990, eta_p_44994);\n                    int16_t defunc_0_op_res_44999 = add16(eta_p_44991, eta_p_44995);\n                    int16_t defunc_0_op_res_45000 = add16(eta_p_44992, eta_p_44996);\n                    int16_t defunc_0_op_res_45001 = add16(eta_p_44993, eta_p_44997);\n                    \n                    eta_p_44990 = defunc_0_op_res_44998;\n                    eta_p_44991 = defunc_0_op_res_44999;\n                    eta_p_44992 = defunc_0_op_res_45000;\n                    eta_p_44993 = defunc_0_op_res_45001;\n                }\n            }\n        }\n        // write final result\n        {\n            if (!no_carry_in_48511) {\n                ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44990;\n                ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44991;\n                ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_44992;\n                ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44993;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n            ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44994;\n            ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44995;\n            ((__local int16_t *) color_48098)[sext_", "i32_i64(local_tid_48469)] = eta_p_44996;\n            ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44997;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (zzero_41709) {\n        defunc_0_f_res_45016 = (int16_t) 0;\n        defunc_0_f_res_45017 = (int16_t) 0;\n        defunc_0_f_res_45018 = (int16_t) 0;\n        defunc_0_f_res_45019 = (int16_t) 0;\n    } else {\n        int16_t last_res_45020;\n        int16_t last_res_45021;\n        int16_t last_res_45022;\n        int16_t last_res_45023;\n        \n        last_res_45020 = ((__local int16_t *) color_48100)[tmp_41751];\n        last_res_45021 = ((__local int16_t *) color_48099)[tmp_41751];\n        last_res_45022 = ((__local int16_t *) color_48098)[tmp_41751];\n        last_res_45023 = ((__local int16_t *) color_48097)[tmp_41751];\n        defunc_0_f_res_45016 = last_res_45020;\n        defunc_0_f_res_45017 = last_res_45021;\n        defunc_0_f_res_45018 = last_res_45022;\n        defunc_0_f_res_45019 = last_res_45023;\n    }\n    phys_tid_45027 = sext_i32_i64(local_tid_48469);\n    write_i_45026 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(write_i_45026, i16_res_41708)) {\n        int16_t eta_p_45028;\n        int16_t eta_p_45029;\n        int16_t eta_p_45030;\n        int16_t eta_p_45031;\n        int16_t eta_p_45032;\n        int64_t new_index_46977;\n        int64_t write_value_45033;\n        int64_t write_value_45034;\n        int64_t defunc_0_f_res_45035;\n        \n        eta_p_45028 = ((__local int16_t *) color_48095)[write_i_45026];\n        eta_p_45029 = ((__local int16_t *) color_48100)[write_i_45026];\n        eta_p_45030 = ((__local int16_t *) color_48099)[write_i_45026];\n        eta_p_45031 = ((__local int16_t *) color_48098)[write_i_45026];\n        eta_p_45032 = ((__local int16_t *) color_48097)[write_i_45026];\n        new_index_46977 = write_i_45026 + binop_x_46980;\n        write_value_45033 = ((__global int64_t *) mem_47846)[new_index_46977];\n  ", "      write_value_45034 = ((__global int64_t *) mem_47848)[new_index_46977];\n        futrts_lifted_f_7536(&defunc_0_f_res_45035, defunc_0_f_res_45016, defunc_0_f_res_45017, defunc_0_f_res_45018, eta_p_45028, eta_p_45029, eta_p_45030, eta_p_45031, eta_p_45032);\n        if (sle64((int64_t) 0, defunc_0_f_res_45035) && slt64(defunc_0_f_res_45035, i16_res_41708)) {\n            ((__local int64_t *) color_48102)[defunc_0_f_res_45035] = write_value_45033;\n        }\n        if (sle64((int64_t) 0, defunc_0_f_res_45035) && slt64(defunc_0_f_res_45035, i16_res_41708)) {\n            ((__local int64_t *) color_48101)[defunc_0_f_res_45035] = write_value_45034;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = defunc_0_f_res_45016;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_45017;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = defunc_0_f_res_45018;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = defunc_0_f_res_45019;\n    phys_tid_45039 = sext_i32_i64(local_tid_48469);\n    gtid_45038 = sext_i32_i64(sext_i64_i32(ltid_pre_48473));\n    if (slt64(gtid_45038, (int64_t) 4)) {\n        int16_t eta_p_45040;\n        int64_t i16_res_45041;\n        \n        eta_p_45040 = ((__local int16_t *) color_48095)[gtid_45038];\n        i16_res_45041 = sext_i16_i64(eta_p_45040);\n        ((__local int64_t *) color_48096)[gtid_45038] = i16_res_45041;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    tmp_45042 = add16(defunc_0_f_res_45016, defunc_0_f_res_45017);\n    tmp_45043 = add16(defunc_0_f_res_45018, tmp_45042);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = (int16_t) 0;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_45016;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = tmp_45042;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = tmp_45043;\n    num_chunks_48513 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48514 = 0; chunk_i_",
                                    "48514 < num_chunks_48513; chunk_i_48514++) {\n        int32_t i_48515 = chunk_i_48514 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48515, sext_i64_i32(i16_res_41708))) {\n            ((__global int64_t *) mem_47968)[gtid_44973 * i16_res_41708 + sext_i32_i64(i_48515)] = ((__local int64_t *) color_48102)[sext_i32_i64(i_48515)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48516 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48517 = 0; chunk_i_48517 < num_chunks_48516; chunk_i_48517++) {\n        int32_t i_48518 = chunk_i_48517 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48518, sext_i64_i32(i16_res_41708))) {\n            ((__global int64_t *) mem_47971)[gtid_44973 * i16_res_41708 + sext_i32_i64(i_48518)] = ((__local int64_t *) color_48101)[sext_i32_i64(i_48518)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48519 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48520 = 0; chunk_i_48520 < num_chunks_48519; chunk_i_48520++) {\n        int32_t i_48521 = chunk_i_48520 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48521, 4)) {\n            ((__global int64_t *) mem_47974)[gtid_44973 * (int64_t) 4 + sext_i32_i64(i_48521)] = ((__local int64_t *) color_48096)[sext_i32_i64(i_48521)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48522 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_44947));\n    for (int32_t chunk_i_48523 = 0; chunk_i_48523 < num_chunks_48522; chunk_i_48523++) {\n        int32_t i_48524 = chunk_i_48523 * sext_i64_i32(computed_tblock_sizze_44947) + local_tid_48469;\n        \n        if (slt32(i_48524, 4)) {\n            ((__global int16_t *) mem_47977)[gtid_44973 * (int64_t) 4 + sext_i32_i64(i_48524)] = ((__local int16_t *) color_48095)[sext_i32_i64(i_48524)];\n        }\n    }\n", "    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegscan_44918_dim1, 1, 1)\nvoid sortColumn_longzisegscan_44918(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_44915, int64_t num_virt_blocks_48139, int64_t num_virt_threads_48140, __global unsigned char *mem_47846, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *status_flags_mem_48141, __global unsigned char *aggregates_mem_48163, __global unsigned char *incprefixes_mem_48165, __global unsigned char *aggregates_mem_48167, __global unsigned char *incprefixes_mem_48169, __global unsigned char *aggregates_mem_48171, __global unsigned char *incprefixes_mem_48173, __global unsigned char *aggregates_mem_48175, __global unsigned char *incprefixes_mem_48177, __global unsigned char *global_dynid_mem_48179)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_44913 (sortColumn_longzisegscan_44918zisegscan_tblock_sizze_44913)\n    #define chunk_sizze_48138 (sortColumn_longzisegscan_44918zichunk_sizze_48138)\n    \n    volatile __local unsigned char *local_mem_48215_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48215_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int6", "4_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48202;\n    int32_t tblock_sizze_48205;\n    int32_t wave_sizze_48204;\n    int32_t block_id_48203;\n    int32_t global_tid_48201;\n    int64_t phys_tid_44918;\n    int32_t chunk_sizze_32b_48206;\n    int64_t byte_offsets_48207;\n    int64_t byte_offsets_48208;\n    int64_t byte_offsets_48209;\n    int64_t byte_offsets_48210;\n    int64_t warp_byte_offset_48211;\n    int64_t warp_byte_offset_48212;\n    int64_t warp_byte_offset_48213;\n    int64_t warp_byte_offset_48214;\n    __local unsigned char *local_mem_48215;\n    int64_t trans_arr_len_48216;\n    int64_t phys_block_id_48231;\n    int64_t virtloop_bound_48232;\n    \n    local_tid_48202 = get_local_id(0);\n    tblock_sizze_48205 = get_local_size(0);\n    wave_sizze_48204 = LOCKSTEP_WIDTH;\n    block_id_48203 = get_tblock_id(0);\n    global_tid_48201 = block_id_48203 * tblock_sizze_48205 + local_tid_48202;\n    phys_tid_44918 = sext_i32_i64(global_tid_48201);\n    chunk_sizze_32b_48206 = sext_i64_i32(chunk_sizze_48138);\n    byte_offsets_48207 = segscan_tblock_sizze_4491",
                                    "3 * (int64_t) 2;\n    byte_offsets_48208 = sdiv_up64(byte_offsets_48207, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44913 * (int64_t) 2;\n    byte_offsets_48209 = sdiv_up64(byte_offsets_48208, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44913 * (int64_t) 2;\n    byte_offsets_48210 = sdiv_up64(byte_offsets_48209, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44913 * (int64_t) 2;\n    warp_byte_offset_48211 = (int64_t) 96;\n    warp_byte_offset_48212 = sdiv_up64(warp_byte_offset_48211, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48213 = sdiv_up64(warp_byte_offset_48212, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48214 = sdiv_up64(warp_byte_offset_48213, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48215 = (__local unsigned char *) local_mem_48215_backing_0;\n    trans_arr_len_48216 = chunk_sizze_48138 * segscan_tblock_sizze_44913;\n    phys_block_id_48231 = get_tblock_id(0);\n    virtloop_bound_48232 = sdiv_up64(num_virt_blocks_48139 - phys_block_id_48231, num_tblocks_44915);\n    for (int64_t virtloop_i_48233 = 0; virtloop_i_48233 < virtloop_bound_48232; virtloop_i_48233++) {\n        int64_t dynamic_id_48234;\n        int64_t block_offset_48235;\n        int64_t sgm_idx_48236;\n        int32_t boundary_48237;\n        int32_t segsizze_compact_48238;\n        int16_t private_mem_48239[chunk_sizze_48138];\n        int16_t private_mem_48241[chunk_sizze_48138];\n        int16_t private_mem_48243[chunk_sizze_48138];\n        int16_t private_mem_48245[chunk_sizze_48138];\n        int64_t thd_offset_48247;\n        int16_t acc_48293;\n        int16_t acc_48294;\n        int16_t acc_48295;\n        int16_t acc_48296;\n        int16_t prefix_48315;\n        int16_t prefix_48316;\n        int16_t prefix_48317;\n        int16_t prefix_48318;\n        bool block_new_sgm_48319;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48202", " == 0) {\n                dynamic_id_48234 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48179)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48215)[(int64_t) 0] = dynamic_id_48234;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48234 == num_virt_blocks_48139 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48179)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48234 = ((__local int32_t *) local_mem_48215)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48235 = dynamic_id_48234 * chunk_sizze_48138 * segscan_tblock_sizze_44913;\n        sgm_idx_48236 = smod64(block_offset_48235, rest_41713);\n        boundary_48237 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_44913, rest_41713 - sgm_idx_48236));\n        segsizze_compact_48238 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_44913, rest_41713));\n        thd_offset_48247 = block_offset_48235 + sext_i32_i64(local_tid_48202);\n        // Load and map\n        {\n            for (int64_t i_48248 = 0; i_48248 < chunk_sizze_48138; i_48248++) {\n                int64_t virt_tid_48249 = thd_offset_48247 + i_48248 * segscan_tblock_sizze_44913;\n                int64_t slice_48250 = rest_41713;\n                int64_t gtid_44917 = virt_tid_48249;\n                int64_t remnant_48251 = virt_tid_48249 - gtid_44917;\n                \n                if (slt64(virt_tid_48249, rest_41713)) {\n                    int64_t slice_46966 = arg_41714 + gtid_44917;\n                    int64_t eta_p_43668 = ((__global int64_t *) mem_47846)[slice_46966];\n                    int32_t defunc_0_get_bit_res_43669;\n                    \n                    futrts", "_get_bit_2253(&defunc_0_get_bit_res_43669, get_bit_arg0_41781, eta_p_43668);\n                    \n                    int32_t defunc_0_get_bit_res_43670;\n                    \n                    if (cond_41782) {\n                        int32_t defunc_0_get_bit_res_t_res_43782 = 1 ^ defunc_0_get_bit_res_43669;\n                        \n                        defunc_0_get_bit_res_43670 = defunc_0_get_bit_res_t_res_43782;\n                    } else {\n                        defunc_0_get_bit_res_43670 = defunc_0_get_bit_res_43669;\n                    }\n                    \n                    int32_t zp_lhs_43672 = mul32(2, defunc_0_get_bit_res_43670);\n                    int32_t defunc_0_get_bit_res_43673;\n                    \n                    futrts_get_bit_2253(&defunc_0_get_bit_res_43673, blocked_radix_sort_step_arg1_41776, eta_p_43668);\n                    \n                    int32_t defunc_0_get_bit_res_43674;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_43783 = 1 ^ defunc_0_get_bit_res_43673;\n                        \n                        defunc_0_get_bit_res_43674 = defunc_0_get_bit_res_t_res_43783;\n                    } else {\n                        defunc_0_get_bit_res_43674 = defunc_0_get_bit_res_43673;\n                    }\n                    \n                    int32_t i32_arg0_43676 = add32(zp_lhs_43672, defunc_0_get_bit_res_43674);\n                    int16_t i32_res_43677 = sext_i32_i16(i32_arg0_43676);\n                    int16_t defunc_0_f_res_43679;\n                    int16_t defunc_0_f_res_43680;\n                    int16_t defunc_0_f_res_43681;\n                    int16_t defunc_0_f_res_43682;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_43679, &defunc_0_f_res_43680, &defunc_0_f_res_43681, &defunc_0_f_res_43682, i32_res_43677);\n                    ((__global int16_t *) mem_47865)[gtid_44917] = i32_res_43677;\n                    p",
                                    "rivate_mem_48239[i_48248] = defunc_0_f_res_43679;\n                    private_mem_48241[i_48248] = defunc_0_f_res_43680;\n                    private_mem_48243[i_48248] = defunc_0_f_res_43681;\n                    private_mem_48245[i_48248] = defunc_0_f_res_43682;\n                } else {\n                    private_mem_48239[i_48248] = (int16_t) 0;\n                    private_mem_48241[i_48248] = (int16_t) 0;\n                    private_mem_48243[i_48248] = (int16_t) 0;\n                    private_mem_48245[i_48248] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48252 = 0; i_48252 < chunk_sizze_48138; i_48252++) {\n                int64_t sharedIdx_48253 = sext_i32_i64(local_tid_48202) + i_48252 * segscan_tblock_sizze_44913;\n                int16_t tmp_48254 = private_mem_48239[i_48252];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48253] = tmp_48254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48255 = 0; i_48255 < chunk_sizze_48138; i_48255++) {\n                int64_t sharedIdx_48256 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48255;\n                int16_t tmp_48257 = ((__local int16_t *) local_mem_48215)[sharedIdx_48256];\n                \n                private_mem_48239[i_48255] = tmp_48257;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48258 = 0; i_48258 < chunk_sizze_48138; i_48258++) {\n                int64_t sharedIdx_48259 = sext_i32_i64(local_tid_48202) + i_48258 * segscan_tblock_sizze_44913;\n                int16_t tmp_48260 = private_mem_48241[i_48258];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48259] = tmp_48260;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48261 = 0; i_48261 < chunk_sizze_48138; i_48261++) {\n                int64_t sharedI", "dx_48262 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48261;\n                int16_t tmp_48263 = ((__local int16_t *) local_mem_48215)[sharedIdx_48262];\n                \n                private_mem_48241[i_48261] = tmp_48263;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48264 = 0; i_48264 < chunk_sizze_48138; i_48264++) {\n                int64_t sharedIdx_48265 = sext_i32_i64(local_tid_48202) + i_48264 * segscan_tblock_sizze_44913;\n                int16_t tmp_48266 = private_mem_48243[i_48264];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48265] = tmp_48266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48267 = 0; i_48267 < chunk_sizze_48138; i_48267++) {\n                int64_t sharedIdx_48268 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48267;\n                int16_t tmp_48269 = ((__local int16_t *) local_mem_48215)[sharedIdx_48268];\n                \n                private_mem_48243[i_48267] = tmp_48269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48270 = 0; i_48270 < chunk_sizze_48138; i_48270++) {\n                int64_t sharedIdx_48271 = sext_i32_i64(local_tid_48202) + i_48270 * segscan_tblock_sizze_44913;\n                int16_t tmp_48272 = private_mem_48245[i_48270];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48271] = tmp_48272;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48273 = 0; i_48273 < chunk_sizze_48138; i_48273++) {\n                int64_t sharedIdx_48274 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48273;\n                int16_t tmp_48275 = ((__local int16_t *) local_mem_48215)[sharedIdx_48274];\n                \n                private_mem_48245[i_48273] = tmp_48275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i", "_48276 = 0; i_48276 < chunk_sizze_48138 - (int64_t) 1; i_48276++) {\n                int16_t eta_p_41812;\n                int16_t eta_p_41816;\n                \n                eta_p_41812 = private_mem_48239[i_48276];\n                eta_p_41816 = private_mem_48239[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41813;\n                int16_t eta_p_41817;\n                \n                eta_p_41813 = private_mem_48241[i_48276];\n                eta_p_41817 = private_mem_48241[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41814;\n                int16_t eta_p_41818;\n                \n                eta_p_41814 = private_mem_48243[i_48276];\n                eta_p_41818 = private_mem_48243[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41815;\n                int16_t eta_p_41819;\n                \n                eta_p_41815 = private_mem_48245[i_48276];\n                eta_p_41819 = private_mem_48245[i_48276 + (int64_t) 1];\n                \n                int16_t defunc_0_op_res_41820 = add16(eta_p_41812, eta_p_41816);\n                int16_t defunc_0_op_res_41821 = add16(eta_p_41813, eta_p_41817);\n                int16_t defunc_0_op_res_41822 = add16(eta_p_41814, eta_p_41818);\n                int16_t defunc_0_op_res_41823 = add16(eta_p_41815, eta_p_41819);\n                \n                private_mem_48239[i_48276 + (int64_t) 1] = defunc_0_op_res_41820;\n                private_mem_48241[i_48276 + (int64_t) 1] = defunc_0_op_res_41821;\n                private_mem_48243[i_48276 + (int64_t) 1] = defunc_0_op_res_41822;\n                private_mem_48245[i_48276 + (int64_t) 1] = defunc_0_op_res_41823;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48277 = private_mem_48239[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = tmp_48277;\n            \n            int16_t tmp_48278",
                                    " = private_mem_48241[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48278;\n            \n            int16_t tmp_48279 = private_mem_48243[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48279;\n            \n            int16_t tmp_48280 = private_mem_48245[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48280;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48281;\n            int16_t eta_p_48282;\n            int16_t eta_p_48283;\n            int16_t eta_p_48284;\n            int16_t eta_p_48285;\n            int16_t eta_p_48286;\n            int16_t eta_p_48287;\n            int16_t eta_p_48288;\n            int16_t eta_p_48297;\n            int16_t eta_p_48298;\n            int16_t eta_p_48299;\n            int16_t eta_p_48300;\n            int16_t eta_p_48301;\n            int16_t eta_p_48302;\n            int16_t eta_p_48303;\n            int16_t eta_p_48304;\n            bool ltid_in_bounds_48309 = slt64(sext_i32_i64(local_tid_48202), num_virt_threads_48140);\n            int32_t skip_threads_48310;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48309) {\n                    eta_p_48285 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                    eta_p_48286 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48287 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_t", "id_48202)];\n                    eta_p_48288 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                        eta_p_48281 = eta_p_48285;\n                        eta_p_48282 = eta_p_48286;\n                        eta_p_48283 = eta_p_48287;\n                        eta_p_48284 = eta_p_48288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48310 = 1;\n                while (slt32(skip_threads_48310, 32)) {\n                    bool thread_active_48311 = sle32(skip_threads_48310, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && ltid_in_bounds_48309;\n                    \n                    if (thread_active_48311) {\n                        // read operands\n                        {\n                            eta_p_48281 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310)];\n                            eta_p_48282 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48283 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48284 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48311) {\n                            int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                  ", "          int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                            int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                            int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                            \n                            eta_p_48281 = defunc_0_op_res_48289;\n                            eta_p_48282 = defunc_0_op_res_48290;\n                            eta_p_48283 = defunc_0_op_res_48291;\n                            eta_p_48284 = defunc_0_op_res_48292;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48311) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                            eta_p_48285 = eta_p_48281;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                            eta_p_48286 = eta_p_48282;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                            eta_p_48287 = eta_p_48283;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                            eta_p_48288 = eta_p_48284;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48310 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FEN",
                                    "CE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 31 && ltid_in_bounds_48309) {\n                    ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48281;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48282;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48283;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48284;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48312;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                        eta_p_48301 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                        eta_p_48302 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48303 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48304 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                            eta_p_48297 = eta_p_48301;\n                            eta_p", "_48298 = eta_p_48302;\n                            eta_p_48299 = eta_p_48303;\n                            eta_p_48300 = eta_p_48304;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48312 = 1;\n                    while (slt32(skip_threads_48312, 32)) {\n                        bool thread_active_48313 = sle32(skip_threads_48312, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309);\n                        \n                        if (thread_active_48313) {\n                            // read operands\n                            {\n                                eta_p_48297 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312)];\n                                eta_p_48298 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48299 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48300 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48313) {\n                                int16_t defunc_0_op_res_48305 = add16(eta_p_48297, eta_p_48301);\n                                int16_t defunc_0_op_res_48306 = add16(eta_p_48298, eta_p_48302);\n                                int16_t defunc_0_op_res_48307 = add16(eta_p_48299, eta_p_48303);\n                       ", "         int16_t defunc_0_op_res_48308 = add16(eta_p_48300, eta_p_48304);\n                                \n                                eta_p_48297 = defunc_0_op_res_48305;\n                                eta_p_48298 = defunc_0_op_res_48306;\n                                eta_p_48299 = defunc_0_op_res_48307;\n                                eta_p_48300 = defunc_0_op_res_48308;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48313) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48297;\n                                eta_p_48301 = eta_p_48297;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48298;\n                                eta_p_48302 = eta_p_48298;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48299;\n                                eta_p_48303 = eta_p_48299;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48300;\n                                eta_p_48304 = eta_p_48300;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48312 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48314 = sq",
                                    "uot32(local_tid_48202, 32) == 0 || !ltid_in_bounds_48309;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48314) {\n                        eta_p_48285 = eta_p_48281;\n                        eta_p_48286 = eta_p_48282;\n                        eta_p_48287 = eta_p_48283;\n                        eta_p_48288 = eta_p_48284;\n                        eta_p_48281 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1];\n                        eta_p_48282 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48283 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48284 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48314) {\n                        int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                        int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                        int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                        int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                        \n                        eta_p_48281 = defunc_0_op_res_48289;\n                        eta_p_48282 = defunc_0_op_res_48290;\n                        eta_p_48283 = defunc_0_op_res_48291;\n                        eta_p_48284 = defunc_0_op_res_48292;\n                    }\n                }\n                // write final result\n                {\n                    ", "if (!no_carry_in_48314) {\n                        ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                    ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48285;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48286;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48287;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48202 == 0) {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[segscan_tblock_sizze_44913 - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (segscan_tblock_sizze_44913 - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (segscan_tblock_sizze_44913 - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) l", "ocal_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (segscan_tblock_sizze_44913 - (int64_t) 1)];\n            } else {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48315 = (int16_t) 0;\n        prefix_48316 = (int16_t) 0;\n        prefix_48317 = (int16_t) 0;\n        prefix_48318 = (int16_t) 0;\n        block_new_sgm_48319 = sgm_idx_48236 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48319 && local_tid_48202 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = acc_48293;\n                ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = acc_48294;\n                ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = acc_48295;\n                ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = acc_48296;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                acc_48293 = (int16_t) 0;\n                acc_48294 = (int16_t) 0;\n                acc_48295 = (int16_t) 0;\n                acc_48296 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48319 && slt32(local_tid_48202, wave_sizze_48204)) {\n                if (local_tid_48202 == 0) {\n                    ((volatile __global int16_t *) aggregates_mem_48163)[",
                                    "dynamic_id_48234] = acc_48293;\n                    ((volatile __global int16_t *) aggregates_mem_48167)[dynamic_id_48234] = acc_48294;\n                    ((volatile __global int16_t *) aggregates_mem_48171)[dynamic_id_48234] = acc_48295;\n                    ((volatile __global int16_t *) aggregates_mem_48175)[dynamic_id_48234] = acc_48296;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 1;\n                    \n                    int8_t tmp_48320 = ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48215)[(int64_t) 0] = tmp_48320;\n                }\n                mem_fence_local();\n                \n                int8_t status_48321 = ((__local int8_t *) local_mem_48215)[(int64_t) 0];\n                \n                if (status_48321 == (int8_t) 2) {\n                    if (local_tid_48202 == 0) {\n                        prefix_48315 = ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48316 = ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48317 = ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48318 = ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48322 = sext_i64_i32(dynamic_id_48234 - sext_i32_i64(wave_sizze_48204));\n                    \n                    while (slt32(wave_sizze_48204 * -1, readOffset_48322)) {\n                        int32_t read_i_48323 = readOffset_48322 + local_tid_48202;\n                        int16_t aggr_48324 = (int16_t) 0;\n                        int16_t aggr_48325 = (int16_t) 0;\n                 ", "       int16_t aggr_48326 = (int16_t) 0;\n                        int16_t aggr_48327 = (int16_t) 0;\n                        int8_t flag_48328 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48323)) {\n                            flag_48328 = ((volatile __global int8_t *) status_flags_mem_48141)[sext_i32_i64(read_i_48323)];\n                            if (flag_48328 == (int8_t) 2) {\n                                aggr_48324 = ((volatile __global int16_t *) incprefixes_mem_48165)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) incprefixes_mem_48169)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) incprefixes_mem_48173)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) incprefixes_mem_48177)[sext_i32_i64(read_i_48323)];\n                            } else if (flag_48328 == (int8_t) 1) {\n                                aggr_48324 = ((volatile __global int16_t *) aggregates_mem_48163)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) aggregates_mem_48167)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) aggregates_mem_48171)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) aggregates_mem_48175)[sext_i32_i64(read_i_48323)];\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = aggr_48324;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48325;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48326;\n         ", "               ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48327;\n                        ((__local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flag_48328;\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        if (slt8(flag_48328, (int8_t) 2)) {\n                            int8_t flg_x_48341;\n                            int8_t flg_y_48342;\n                            int16_t eta_p_48329;\n                            int16_t eta_p_48330;\n                            int16_t eta_p_48331;\n                            int16_t eta_p_48332;\n                            int16_t eta_p_48333;\n                            int16_t eta_p_48334;\n                            int16_t eta_p_48335;\n                            int16_t eta_p_48336;\n                            int32_t skip_threads_48343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48342 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                                eta_p_48333 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)];\n                                eta_p_48334 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48335 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48336 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                           ",
                                    "         eta_p_48329 = eta_p_48333;\n                                    eta_p_48330 = eta_p_48334;\n                                    eta_p_48331 = eta_p_48335;\n                                    eta_p_48332 = eta_p_48336;\n                                    flg_x_48341 = flg_y_48342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48343 = 1;\n                                while (slt32(skip_threads_48343, 32)) {\n                                    if (sle32(skip_threads_48343, local_tid_48202 - squot32(local_tid_48202, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48341 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343)];\n                                            eta_p_48329 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48330 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48331 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48332 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                        }\n                                        // perform operation\n                                        {\n                         ", "                   if (flg_y_48342 == (int8_t) 2 || flg_y_48342 == (int8_t) 0) {\n                                                flg_x_48341 = flg_y_48342;\n                                                eta_p_48329 = eta_p_48333;\n                                                eta_p_48330 = eta_p_48334;\n                                                eta_p_48331 = eta_p_48335;\n                                                eta_p_48332 = eta_p_48336;\n                                            } else {\n                                                int16_t defunc_0_op_res_48337 = add16(eta_p_48329, eta_p_48333);\n                                                int16_t defunc_0_op_res_48338 = add16(eta_p_48330, eta_p_48334);\n                                                int16_t defunc_0_op_res_48339 = add16(eta_p_48331, eta_p_48335);\n                                                int16_t defunc_0_op_res_48340 = add16(eta_p_48332, eta_p_48336);\n                                                \n                                                eta_p_48329 = defunc_0_op_res_48337;\n                                                eta_p_48330 = defunc_0_op_res_48338;\n                                                eta_p_48331 = defunc_0_op_res_48339;\n                                                eta_p_48332 = defunc_0_op_res_48340;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flg_x_48341;\n                                            flg_y_48342 = flg_x_48341;\n                                            ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = eta_p_48329;\n                                            eta_p_48333 = eta_p_48329;\n                                  ", "          ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48330;\n                                            eta_p_48334 = eta_p_48330;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48331;\n                                            eta_p_48335 = eta_p_48331;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48332;\n                                            eta_p_48336 = eta_p_48332;\n                                        }\n                                    }\n                                    skip_threads_48343 *= 2;\n                                }\n                            }\n                        }\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        aggr_48324 = ((__local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48325 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48326 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48327 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        if (flag_48328 == (int8_t) 2) {\n                            readOffset_48322 = wave_sizze_48204 * -1;\n                        } else if (flag_48328 == (int8_t) 1) {\n                            readOffset_48322 -= wave_sizze_48204;\n          ",
                                    "              }\n                        if (slt8((int8_t) 0, flag_48328)) {\n                            int16_t eta_p_48344 = aggr_48324;\n                            int16_t eta_p_48345 = aggr_48325;\n                            int16_t eta_p_48346 = aggr_48326;\n                            int16_t eta_p_48347 = aggr_48327;\n                            int16_t eta_p_48348 = prefix_48315;\n                            int16_t eta_p_48349 = prefix_48316;\n                            int16_t eta_p_48350 = prefix_48317;\n                            int16_t eta_p_48351 = prefix_48318;\n                            int16_t defunc_0_op_res_48352 = add16(eta_p_48344, eta_p_48348);\n                            int16_t defunc_0_op_res_48353 = add16(eta_p_48345, eta_p_48349);\n                            int16_t defunc_0_op_res_48354 = add16(eta_p_48346, eta_p_48350);\n                            int16_t defunc_0_op_res_48355 = add16(eta_p_48347, eta_p_48351);\n                            \n                            prefix_48315 = defunc_0_op_res_48352;\n                            prefix_48316 = defunc_0_op_res_48353;\n                            prefix_48317 = defunc_0_op_res_48354;\n                            prefix_48318 = defunc_0_op_res_48355;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48202 == 0) {\n                    if (boundary_48237 == sext_i64_i32(segscan_tblock_sizze_44913 * chunk_sizze_48138)) {\n                        int16_t eta_p_48356 = prefix_48315;\n                        int16_t eta_p_48357 = prefix_48316;\n                        int16_t eta_p_48358 = prefix_48317;\n                        int16_t eta_p_48359 = prefix_48318;\n                        int16_t eta_p_48360 = acc_48293;\n                        int16_t eta_p_48361 = acc_48294;\n                        int16_t eta_p_48362 = acc_48295;\n                        int16_t eta_p_48363 = acc_48296;\n                        int1", "6_t defunc_0_op_res_48364 = add16(eta_p_48356, eta_p_48360);\n                        int16_t defunc_0_op_res_48365 = add16(eta_p_48357, eta_p_48361);\n                        int16_t defunc_0_op_res_48366 = add16(eta_p_48358, eta_p_48362);\n                        int16_t defunc_0_op_res_48367 = add16(eta_p_48359, eta_p_48363);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = defunc_0_op_res_48364;\n                        ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = defunc_0_op_res_48365;\n                        ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = defunc_0_op_res_48366;\n                        ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = defunc_0_op_res_48367;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48215)[(int64_t) 16] = prefix_48315;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)] = prefix_48316;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)] = prefix_48317;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)] = prefix_48318;\n                    acc_48293 = (int16_t) 0;\n                    acc_48294 = (int16_t) 0;\n                    acc_48295 = (int16_t) 0;\n                    acc_48296 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48234 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48315 = ((__local int16_t *) local_mem_48215)[(int64_t) 16];\n                prefix_48316 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)];\n                prefix_4831", "7 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)];\n                prefix_48318 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48368;\n            int16_t eta_p_48372;\n            int16_t eta_p_48380 = prefix_48315;\n            int16_t eta_p_48384 = acc_48293;\n            int16_t eta_p_48369;\n            int16_t eta_p_48373;\n            int16_t eta_p_48381 = prefix_48316;\n            int16_t eta_p_48385 = acc_48294;\n            int16_t eta_p_48370;\n            int16_t eta_p_48374;\n            int16_t eta_p_48382 = prefix_48317;\n            int16_t eta_p_48386 = acc_48295;\n            int16_t eta_p_48371;\n            int16_t eta_p_48375;\n            int16_t eta_p_48383 = prefix_48318;\n            int16_t eta_p_48387 = acc_48296;\n            \n            if (slt32(local_tid_48202 * chunk_sizze_32b_48206, boundary_48237) && !block_new_sgm_48319) {\n                int16_t defunc_0_op_res_48388 = add16(eta_p_48380, eta_p_48384);\n                int16_t defunc_0_op_res_48389 = add16(eta_p_48381, eta_p_48385);\n                int16_t defunc_0_op_res_48390 = add16(eta_p_48382, eta_p_48386);\n                int16_t defunc_0_op_res_48391 = add16(eta_p_48383, eta_p_48387);\n                \n                eta_p_48368 = defunc_0_op_res_48388;\n                eta_p_48369 = defunc_0_op_res_48389;\n                eta_p_48370 = defunc_0_op_res_48390;\n                eta_p_48371 = defunc_0_op_res_48391;\n            } else {\n                eta_p_48368 = acc_48293;\n                eta_p_48369 = acc_48294;\n                eta_p_48370 = acc_48295;\n                eta_p_48371 = acc_48296;\n            }\n            \n            int32_t stopping_point_48392 = segsizze_compact_48238 - srem32(local_tid_48202 * chunk_sizze_32b_48206 - 1 + segsizze_compact_48238 - boundary_48237, seg",
                                    "sizze_compact_48238);\n            \n            for (int64_t i_48393 = 0; i_48393 < chunk_sizze_48138; i_48393++) {\n                if (slt32(sext_i64_i32(i_48393), stopping_point_48392 - 1)) {\n                    eta_p_48372 = private_mem_48239[i_48393];\n                    eta_p_48373 = private_mem_48241[i_48393];\n                    eta_p_48374 = private_mem_48243[i_48393];\n                    eta_p_48375 = private_mem_48245[i_48393];\n                    \n                    int16_t defunc_0_op_res_48376 = add16(eta_p_48368, eta_p_48372);\n                    int16_t defunc_0_op_res_48377 = add16(eta_p_48369, eta_p_48373);\n                    int16_t defunc_0_op_res_48378 = add16(eta_p_48370, eta_p_48374);\n                    int16_t defunc_0_op_res_48379 = add16(eta_p_48371, eta_p_48375);\n                    \n                    private_mem_48239[i_48393] = defunc_0_op_res_48376;\n                    private_mem_48241[i_48393] = defunc_0_op_res_48377;\n                    private_mem_48243[i_48393] = defunc_0_op_res_48378;\n                    private_mem_48245[i_48393] = defunc_0_op_res_48379;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48394 = 0; i_48394 < chunk_sizze_48138; i_48394++) {\n                int64_t sharedIdx_48395 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48394;\n                int16_t tmp_48396 = private_mem_48239[i_48394];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48395] = tmp_48396;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48397 = 0; i_48397 < chunk_sizze_48138; i_48397++) {\n                int64_t flat_idx_48398 = thd_offset_48247 + i_48397 * segscan_tblock_sizze_44913;\n                int64_t slice_48399 = rest_41713;\n                int64_t gtid_44917 = flat_idx_48398;\n                int64_t remnant_48400 = flat_idx_48398 - gtid_44917;", "\n                \n                if (slt64(flat_idx_48398, rest_41713)) {\n                    int16_t tmp_48401 = ((__local int16_t *) local_mem_48215)[flat_idx_48398 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47857)[gtid_44917] = tmp_48401;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48402 = 0; i_48402 < chunk_sizze_48138; i_48402++) {\n                int64_t sharedIdx_48403 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48402;\n                int16_t tmp_48404 = private_mem_48241[i_48402];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48403] = tmp_48404;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48405 = 0; i_48405 < chunk_sizze_48138; i_48405++) {\n                int64_t flat_idx_48406 = thd_offset_48247 + i_48405 * segscan_tblock_sizze_44913;\n                int64_t slice_48407 = rest_41713;\n                int64_t gtid_44917 = flat_idx_48406;\n                int64_t remnant_48408 = flat_idx_48406 - gtid_44917;\n                \n                if (slt64(flat_idx_48406, rest_41713)) {\n                    int16_t tmp_48409 = ((__local int16_t *) local_mem_48215)[flat_idx_48406 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47859)[gtid_44917] = tmp_48409;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48410 = 0; i_48410 < chunk_sizze_48138; i_48410++) {\n                int64_t sharedIdx_48411 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48410;\n                int16_t tmp_48412 = private_mem_48243[i_48410];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48411] = tmp_48412;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48413 = 0; i_48413 < chunk_sizze_48138; i_48413++) {\n                int64_t flat_idx_48", "414 = thd_offset_48247 + i_48413 * segscan_tblock_sizze_44913;\n                int64_t slice_48415 = rest_41713;\n                int64_t gtid_44917 = flat_idx_48414;\n                int64_t remnant_48416 = flat_idx_48414 - gtid_44917;\n                \n                if (slt64(flat_idx_48414, rest_41713)) {\n                    int16_t tmp_48417 = ((__local int16_t *) local_mem_48215)[flat_idx_48414 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47861)[gtid_44917] = tmp_48417;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48418 = 0; i_48418 < chunk_sizze_48138; i_48418++) {\n                int64_t sharedIdx_48419 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48418;\n                int16_t tmp_48420 = private_mem_48245[i_48418];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48419] = tmp_48420;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48421 = 0; i_48421 < chunk_sizze_48138; i_48421++) {\n                int64_t flat_idx_48422 = thd_offset_48247 + i_48421 * segscan_tblock_sizze_44913;\n                int64_t slice_48423 = rest_41713;\n                int64_t gtid_44917 = flat_idx_48422;\n                int64_t remnant_48424 = flat_idx_48422 - gtid_44917;\n                \n                if (slt64(flat_idx_48422, rest_41713)) {\n                    int16_t tmp_48425 = ((__local int16_t *) local_mem_48215)[flat_idx_48422 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47863)[gtid_44917] = tmp_48425;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_44913\n    #undef chunk_sizze_48138\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegscan_45213_dim1, 1, 1)\nvoid sortColumn_longzisegscan_45213(__global int *global_failure, int failure_is_an_option, __global int64_t",
                                    " *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_45204, int64_t num_virt_blocks_48530, int64_t num_virt_threads_48531, __global unsigned char *mem_47846, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *status_flags_mem_48532, __global unsigned char *aggregates_mem_48534, __global unsigned char *incprefixes_mem_48536, __global unsigned char *aggregates_mem_48538, __global unsigned char *incprefixes_mem_48540, __global unsigned char *aggregates_mem_48542, __global unsigned char *incprefixes_mem_48544, __global unsigned char *aggregates_mem_48546, __global unsigned char *incprefixes_mem_48548, __global unsigned char *global_dynid_mem_48550)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_45203 (sortColumn_longzisegscan_45213zisegscan_tblock_sizze_45203)\n    #define chunk_sizze_48529 (sortColumn_longzisegscan_45213zichunk_sizze_48529)\n    \n    volatile __local unsigned char *local_mem_48566_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48566_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(s", "max64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48553;\n    int32_t tblock_sizze_48556;\n    int32_t wave_sizze_48555;\n    int32_t block_id_48554;\n    int32_t global_tid_48552;\n    int64_t phys_tid_45213;\n    int32_t chunk_sizze_32b_48557;\n    int64_t byte_offsets_48558;\n    int64_t byte_offsets_48559;\n    int64_t byte_offsets_48560;\n    int64_t byte_offsets_48561;\n    int64_t warp_byte_offset_48562;\n    int64_t warp_byte_offset_48563;\n    int64_t warp_byte_offset_48564;\n    int64_t warp_byte_offset_48565;\n    __local unsigned char *local_mem_48566;\n    int64_t trans_arr_len_48567;\n    int64_t phys_block_id_48582;\n    int64_t virtloop_bound_48583;\n    \n    local_tid_48553 = get_local_id(0);\n    tblock_sizze_48556 = get_local_size(0);\n    wave_sizze_48555 = LOCKSTEP_WIDTH;\n    block_id_48554 = get_tblock_id(0);\n    global_tid_48552 = block_id_48554 * tblock_sizze_48556 + local_tid_48553;\n    phys_tid_45213 = sext_i32_i64(global_tid_48552);\n    chunk_sizze_32b_48557 = sext_i64_i32(chunk_sizze_48529);\n    byte_offsets_48558 = segscan_tblock_sizze_45203 * (int64_t) 2;\n    byte_offsets_48559 = sdiv_up64(byte_offsets_48558, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45203 * (int64_t) 2;\n    byte_offsets_48560 = sdiv_up64(byte_offsets_48559, (int64_t) 2) * (int64_t) 2 + s", "egscan_tblock_sizze_45203 * (int64_t) 2;\n    byte_offsets_48561 = sdiv_up64(byte_offsets_48560, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_45203 * (int64_t) 2;\n    warp_byte_offset_48562 = (int64_t) 96;\n    warp_byte_offset_48563 = sdiv_up64(warp_byte_offset_48562, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48564 = sdiv_up64(warp_byte_offset_48563, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48565 = sdiv_up64(warp_byte_offset_48564, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48566 = (__local unsigned char *) local_mem_48566_backing_0;\n    trans_arr_len_48567 = chunk_sizze_48529 * segscan_tblock_sizze_45203;\n    phys_block_id_48582 = get_tblock_id(0);\n    virtloop_bound_48583 = sdiv_up64(num_virt_blocks_48530 - phys_block_id_48582, num_tblocks_45204);\n    for (int64_t virtloop_i_48584 = 0; virtloop_i_48584 < virtloop_bound_48583; virtloop_i_48584++) {\n        int64_t dynamic_id_48585;\n        int64_t block_offset_48586;\n        int64_t sgm_idx_48587;\n        int32_t boundary_48588;\n        int32_t segsizze_compact_48589;\n        int16_t private_mem_48590[chunk_sizze_48529];\n        int16_t private_mem_48592[chunk_sizze_48529];\n        int16_t private_mem_48594[chunk_sizze_48529];\n        int16_t private_mem_48596[chunk_sizze_48529];\n        int64_t thd_offset_48598;\n        int16_t acc_48648;\n        int16_t acc_48649;\n        int16_t acc_48650;\n        int16_t acc_48651;\n        int16_t prefix_48673;\n        int16_t prefix_48674;\n        int16_t prefix_48675;\n        int16_t prefix_48676;\n        bool block_new_sgm_48677;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48553 == 0) {\n                dynamic_id_48585 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48550)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                   ",
                                    " ((__local int64_t *) local_mem_48566)[(int64_t) 0] = dynamic_id_48585;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48585 == num_virt_blocks_48530 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48550)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48585 = ((__local int32_t *) local_mem_48566)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48586 = dynamic_id_48585 * chunk_sizze_48529 * segscan_tblock_sizze_45203;\n        sgm_idx_48587 = smod64(block_offset_48586, i16_res_41708);\n        boundary_48588 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_45203, i16_res_41708 - sgm_idx_48587));\n        segsizze_compact_48589 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_45203, i16_res_41708));\n        thd_offset_48598 = block_offset_48586 + sext_i32_i64(local_tid_48553);\n        // Load and map\n        {\n            for (int64_t i_48599 = 0; i_48599 < chunk_sizze_48529; i_48599++) {\n                int64_t virt_tid_48600 = thd_offset_48598 + i_48599 * segscan_tblock_sizze_45203;\n                int64_t slice_48601 = i16_res_41708;\n                int64_t slice_48602 = n_blocks_41712 * slice_48601;\n                int64_t gtid_45211 = squot64(virt_tid_48600, slice_48601);\n                int64_t remnant_48603 = virt_tid_48600 - gtid_45211 * slice_48601;\n                int64_t gtid_45212 = remnant_48603;\n                int64_t remnant_48604 = remnant_48603 - gtid_45212;\n                \n                if (slt64(virt_tid_48600, n_blocks_41712 * i16_res_41708)) {\n                    int64_t binop_x_46982 = i16_res_41708 * gtid_45211;\n                    int64_t new_index_46983 = gtid_45212 + binop_x_46982;\n                    int64_t eta_p_45227 = ((__global int64_t *) mem_47846)[new_index", "_46983];\n                    int32_t defunc_0_get_bit_res_45228;\n                    \n                    futrts_get_bit_2253(&defunc_0_get_bit_res_45228, get_bit_arg0_41781, eta_p_45227);\n                    \n                    int32_t defunc_0_get_bit_res_45229;\n                    \n                    if (cond_41782) {\n                        int32_t defunc_0_get_bit_res_t_res_45230 = 1 ^ defunc_0_get_bit_res_45228;\n                        \n                        defunc_0_get_bit_res_45229 = defunc_0_get_bit_res_t_res_45230;\n                    } else {\n                        defunc_0_get_bit_res_45229 = defunc_0_get_bit_res_45228;\n                    }\n                    \n                    int32_t zp_lhs_45231 = mul32(2, defunc_0_get_bit_res_45229);\n                    int32_t defunc_0_get_bit_res_45232;\n                    \n                    futrts_get_bit_2253(&defunc_0_get_bit_res_45232, blocked_radix_sort_step_arg1_41776, eta_p_45227);\n                    \n                    int32_t defunc_0_get_bit_res_45233;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_45234 = 1 ^ defunc_0_get_bit_res_45232;\n                        \n                        defunc_0_get_bit_res_45233 = defunc_0_get_bit_res_t_res_45234;\n                    } else {\n                        defunc_0_get_bit_res_45233 = defunc_0_get_bit_res_45232;\n                    }\n                    \n                    int32_t i32_arg0_45235 = add32(zp_lhs_45231, defunc_0_get_bit_res_45233);\n                    int16_t i32_res_45236 = sext_i32_i16(i32_arg0_45235);\n                    int16_t defunc_0_f_res_45237;\n                    int16_t defunc_0_f_res_45238;\n                    int16_t defunc_0_f_res_45239;\n                    int16_t defunc_0_f_res_45240;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_45237, &defunc_0_f_res_45238, &defunc_0_f_res_45239, &defunc_0_f_res_45240, i32_res", "_45236);\n                    ((__global int16_t *) mem_47901)[gtid_45211 * i16_res_41708 + gtid_45212] = i32_res_45236;\n                    private_mem_48590[i_48599] = defunc_0_f_res_45237;\n                    private_mem_48592[i_48599] = defunc_0_f_res_45238;\n                    private_mem_48594[i_48599] = defunc_0_f_res_45239;\n                    private_mem_48596[i_48599] = defunc_0_f_res_45240;\n                } else {\n                    private_mem_48590[i_48599] = (int16_t) 0;\n                    private_mem_48592[i_48599] = (int16_t) 0;\n                    private_mem_48594[i_48599] = (int16_t) 0;\n                    private_mem_48596[i_48599] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48605 = 0; i_48605 < chunk_sizze_48529; i_48605++) {\n                int64_t sharedIdx_48606 = sext_i32_i64(local_tid_48553) + i_48605 * segscan_tblock_sizze_45203;\n                int16_t tmp_48607 = private_mem_48590[i_48605];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48606] = tmp_48607;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48608 = 0; i_48608 < chunk_sizze_48529; i_48608++) {\n                int64_t sharedIdx_48609 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48608;\n                int16_t tmp_48610 = ((__local int16_t *) local_mem_48566)[sharedIdx_48609];\n                \n                private_mem_48590[i_48608] = tmp_48610;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48611 = 0; i_48611 < chunk_sizze_48529; i_48611++) {\n                int64_t sharedIdx_48612 = sext_i32_i64(local_tid_48553) + i_48611 * segscan_tblock_sizze_45203;\n                int16_t tmp_48613 = private_mem_48592[i_48611];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48612] = tmp_48613;\n            }\n            ",
                                    "barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48614 = 0; i_48614 < chunk_sizze_48529; i_48614++) {\n                int64_t sharedIdx_48615 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48614;\n                int16_t tmp_48616 = ((__local int16_t *) local_mem_48566)[sharedIdx_48615];\n                \n                private_mem_48592[i_48614] = tmp_48616;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48617 = 0; i_48617 < chunk_sizze_48529; i_48617++) {\n                int64_t sharedIdx_48618 = sext_i32_i64(local_tid_48553) + i_48617 * segscan_tblock_sizze_45203;\n                int16_t tmp_48619 = private_mem_48594[i_48617];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48618] = tmp_48619;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48620 = 0; i_48620 < chunk_sizze_48529; i_48620++) {\n                int64_t sharedIdx_48621 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48620;\n                int16_t tmp_48622 = ((__local int16_t *) local_mem_48566)[sharedIdx_48621];\n                \n                private_mem_48594[i_48620] = tmp_48622;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48623 = 0; i_48623 < chunk_sizze_48529; i_48623++) {\n                int64_t sharedIdx_48624 = sext_i32_i64(local_tid_48553) + i_48623 * segscan_tblock_sizze_45203;\n                int16_t tmp_48625 = private_mem_48596[i_48623];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48624] = tmp_48625;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48626 = 0; i_48626 < chunk_sizze_48529; i_48626++) {\n                int64_t sharedIdx_48627 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48626;\n                int16_t tmp_48628 = ((__local int16_t *) local_mem_48566)[sharedIdx_48627];\n                \n                private_mem_48596[i_48626] =", " tmp_48628;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48629 = 0; i_48629 < chunk_sizze_48529 - (int64_t) 1; i_48629++) {\n                int32_t gidx_48630 = local_tid_48553 * chunk_sizze_32b_48557 + 1;\n                bool new_sgm_48631 = smod32(gidx_48630 + sext_i64_i32(i_48629) - boundary_48588, segsizze_compact_48589) == 0;\n                \n                if (!new_sgm_48631) {\n                    int16_t eta_p_45214;\n                    int16_t eta_p_45218;\n                    \n                    eta_p_45214 = private_mem_48590[i_48629];\n                    eta_p_45218 = private_mem_48590[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_45215;\n                    int16_t eta_p_45219;\n                    \n                    eta_p_45215 = private_mem_48592[i_48629];\n                    eta_p_45219 = private_mem_48592[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_45216;\n                    int16_t eta_p_45220;\n                    \n                    eta_p_45216 = private_mem_48594[i_48629];\n                    eta_p_45220 = private_mem_48594[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_45217;\n                    int16_t eta_p_45221;\n                    \n                    eta_p_45217 = private_mem_48596[i_48629];\n                    eta_p_45221 = private_mem_48596[i_48629 + (int64_t) 1];\n                    \n                    int16_t defunc_0_op_res_45222 = add16(eta_p_45214, eta_p_45218);\n                    int16_t defunc_0_op_res_45223 = add16(eta_p_45215, eta_p_45219);\n                    int16_t defunc_0_op_res_45224 = add16(eta_p_45216, eta_p_45220);\n                    int16_t defunc_0_op_res_45225 = add16(eta_p_45217, eta_p_45221);\n                    \n                    private_mem_48590[i_48629 + (int64_t) 1] = defunc_0_op_res_45222;\n                    private_mem_", "48592[i_48629 + (int64_t) 1] = defunc_0_op_res_45223;\n                    private_mem_48594[i_48629 + (int64_t) 1] = defunc_0_op_res_45224;\n                    private_mem_48596[i_48629 + (int64_t) 1] = defunc_0_op_res_45225;\n                }\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48632 = private_mem_48590[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = tmp_48632;\n            \n            int16_t tmp_48633 = private_mem_48592[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48633;\n            \n            int16_t tmp_48634 = private_mem_48594[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48634;\n            \n            int16_t tmp_48635 = private_mem_48596[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48635;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48636;\n            int16_t eta_p_48637;\n            int16_t eta_p_48638;\n            int16_t eta_p_48639;\n            int16_t eta_p_48640;\n            int16_t eta_p_48641;\n            int16_t eta_p_48642;\n            int16_t eta_p_48643;\n            int16_t eta_p_48652;\n            int16_t eta_p_48653;\n            int16_t eta_p_48654;\n            int16_t eta_p_48655;\n            int16_t eta_p_48656;\n            int16_t eta_p_48657;\n            int16_t eta_p_48658;\n            int16_t eta_p_48659;\n            bool ltid_in_bounds_48664 = slt64(sext_i32_i64(local_tid_48553), num_virt_threads_48531);\n            i",
                                    "nt32_t skip_threads_48665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48664) {\n                    eta_p_48640 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                    eta_p_48641 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48642 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48643 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                        eta_p_48636 = eta_p_48640;\n                        eta_p_48637 = eta_p_48641;\n                        eta_p_48638 = eta_p_48642;\n                        eta_p_48639 = eta_p_48643;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48665 = 1;\n                while (slt32(skip_threads_48665, 32)) {\n                    bool thread_active_48666 = sle32(skip_threads_48665, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && ltid_in_bounds_48664;\n                    \n                    if (thread_active_48666) {\n                        // read operands\n                        {\n                            eta_p_48636 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665)];\n                            eta_p_48637 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48638 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (in", "t64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48639 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_48667 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((local_tid_48553 - skip_threads_48665 + 1) * chunk_sizze_32b_48557 - 1));\n                        \n                        if (thread_active_48666 && inactive_48667) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                        if (thread_active_48666) {\n                            if (!inactive_48667) {\n                                int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                                int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                                int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                                int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                                \n                                eta_p_48636 = defunc_0_op_res_48644;\n                                eta_p_48637 = defunc_0_op_res_48645;\n                                eta_p_48638 = defunc_0_op_res_48646;\n                                eta_p_48639 = defunc_0_op_res_48647;\n                            }\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n               ", "         barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48666) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                            eta_p_48640 = eta_p_48636;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                            eta_p_48641 = eta_p_48637;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                            eta_p_48642 = eta_p_48638;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                            eta_p_48643 = eta_p_48639;\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 31 && ltid_in_bounds_48664) {\n                    ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48636;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48637;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48638;\n                    ((",
                                    "volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48668;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                        eta_p_48656 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                        eta_p_48657 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48658 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48659 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                            eta_p_48652 = eta_p_48656;\n                            eta_p_48653 = eta_p_48657;\n                            eta_p_48654 = eta_p_48658;\n                            eta_p_48655 = eta_p_48659;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48668 = 1;\n                    while (slt32(skip_threads_48668, 32)) {\n                        bool thread_active_48669 = sle32(skip_threads_48668, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664);\n                        \n                        if (thread_active_48669) {\n                            //", " read operands\n                            {\n                                eta_p_48652 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668)];\n                                eta_p_48653 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48654 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48655 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_48670 = slt32(smod32((local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 - (((local_tid_48553 - skip_threads_48668) * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                            \n                            if (thread_active_48669 && inactive_48670) {\n                                eta_p_48652 = eta_p_48656;\n                                eta_p_48653 = eta_p_48657;\n                                eta_p_48654 = eta_p_48658;\n                                eta_p_48655 = eta_p_48659;\n                            }\n                            if (thread_active_48669) {\n                                if (!inactive_48670) {\n                                    int16_t defunc_0_op_res_48660 = add16(eta_p_48652, eta_p_48656);\n                                    int16_t defunc_0_op_res_48661 = add16(eta_p_48653, eta_p_48657);\n                     ", "               int16_t defunc_0_op_res_48662 = add16(eta_p_48654, eta_p_48658);\n                                    int16_t defunc_0_op_res_48663 = add16(eta_p_48655, eta_p_48659);\n                                    \n                                    eta_p_48652 = defunc_0_op_res_48660;\n                                    eta_p_48653 = defunc_0_op_res_48661;\n                                    eta_p_48654 = defunc_0_op_res_48662;\n                                    eta_p_48655 = defunc_0_op_res_48663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48669) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48652;\n                                eta_p_48656 = eta_p_48652;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48653;\n                                eta_p_48657 = eta_p_48653;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48654;\n                                eta_p_48658 = eta_p_48654;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48655;\n                                eta_p_48659 = eta_p_48655;\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads",
                                    "_48668 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48671 = squot32(local_tid_48553, 32) == 0 || !ltid_in_bounds_48664;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48671) {\n                        eta_p_48640 = eta_p_48636;\n                        eta_p_48641 = eta_p_48637;\n                        eta_p_48642 = eta_p_48638;\n                        eta_p_48643 = eta_p_48639;\n                        eta_p_48636 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1];\n                        eta_p_48637 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48638 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48639 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48672 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((squot32(local_tid_48553, 32) * 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                    \n                    if (!no_carry_in_48671) {\n                        if (inactive_48672) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p", "_48643;\n                        }\n                    }\n                    if (!no_carry_in_48671) {\n                        if (!inactive_48672) {\n                            int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                            int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                            int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                            int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                            \n                            eta_p_48636 = defunc_0_op_res_48644;\n                            eta_p_48637 = defunc_0_op_res_48645;\n                            eta_p_48638 = defunc_0_op_res_48646;\n                            eta_p_48639 = defunc_0_op_res_48647;\n                        }\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48671) {\n                        ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                    ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48640;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i6", "4(local_tid_48553)] = eta_p_48641;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48642;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48643;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48553 == 0) {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[segscan_tblock_sizze_45203 - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (segscan_tblock_sizze_45203 - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (segscan_tblock_sizze_45203 - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (segscan_tblock_sizze_45203 - (int64_t) 1)];\n            } else {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48673 = (int16_t) 0;\n        prefix_48674 = (int16_t) 0;\n        prefix_48675 = (int16_t) 0;\n        prefix_48676 = (int16_t) 0;\n        block_new_sgm_48677 = sgm_idx_48587 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48",
                                    "677 && local_tid_48553 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                acc_48648 = (int16_t) 0;\n                acc_48649 = (int16_t) 0;\n                acc_48650 = (int16_t) 0;\n                acc_48651 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48677 && slt32(local_tid_48553, wave_sizze_48555)) {\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_45203 * chunk_sizze_48529)) {\n                        ((volatile __global int16_t *) aggregates_mem_48534)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) aggregates_mem_48538)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) aggregates_mem_48542)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) aggregates_mem_48546)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 1;\n                    } else {\n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) incprefixes_mem_48", "548)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    \n                    int8_t tmp_48678 = ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48566)[(int64_t) 0] = tmp_48678;\n                }\n                mem_fence_local();\n                \n                int8_t status_48679 = ((__local int8_t *) local_mem_48566)[(int64_t) 0];\n                \n                if (status_48679 == (int8_t) 2) {\n                    if (local_tid_48553 == 0) {\n                        prefix_48673 = ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48674 = ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48675 = ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48676 = ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48680 = sext_i64_i32(dynamic_id_48585 - sext_i32_i64(wave_sizze_48555));\n                    \n                    while (slt32(wave_sizze_48555 * -1, readOffset_48680)) {\n                        int32_t read_i_48681 = readOffset_48680 + local_tid_48553;\n                        int16_t aggr_48682 = (int16_t) 0;\n                        int16_t aggr_48683 = (int16_t) 0;\n                        int16_t aggr_48684 = (int16_t) 0;\n                        int16_t aggr_48685 = (int16_t) 0;\n                        int8_t flag_48686 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48681)) {\n                            if (sle64(block", "_offset_48586 - (sext_i32_i64(read_i_48681 + 1) * segscan_tblock_sizze_45203 * chunk_sizze_48529 - (int64_t) 1), sgm_idx_48587)) {\n                                flag_48686 = ((volatile __global int8_t *) status_flags_mem_48532)[sext_i32_i64(read_i_48681)];\n                                if (flag_48686 == (int8_t) 2) {\n                                    aggr_48682 = ((volatile __global int16_t *) incprefixes_mem_48536)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) incprefixes_mem_48540)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) incprefixes_mem_48544)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) incprefixes_mem_48548)[sext_i32_i64(read_i_48681)];\n                                } else if (flag_48686 == (int8_t) 1) {\n                                    aggr_48682 = ((volatile __global int16_t *) aggregates_mem_48534)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) aggregates_mem_48538)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) aggregates_mem_48542)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) aggregates_mem_48546)[sext_i32_i64(read_i_48681)];\n                                }\n                            } else {\n                                flag_48686 = (int8_t) 2;\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = aggr_48682;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48683;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, ",
                                    "(int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48684;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48685;\n                        ((__local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flag_48686;\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        if (slt8(flag_48686, (int8_t) 2)) {\n                            int8_t flg_x_48699;\n                            int8_t flg_y_48700;\n                            int16_t eta_p_48687;\n                            int16_t eta_p_48688;\n                            int16_t eta_p_48689;\n                            int16_t eta_p_48690;\n                            int16_t eta_p_48691;\n                            int16_t eta_p_48692;\n                            int16_t eta_p_48693;\n                            int16_t eta_p_48694;\n                            int32_t skip_threads_48701;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48700 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                                eta_p_48691 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)];\n                                eta_p_48692 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48693 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48694 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                if ((local_tid_48553 - s", "quot32(local_tid_48553, 32) * 32) == 0) {\n                                    eta_p_48687 = eta_p_48691;\n                                    eta_p_48688 = eta_p_48692;\n                                    eta_p_48689 = eta_p_48693;\n                                    eta_p_48690 = eta_p_48694;\n                                    flg_x_48699 = flg_y_48700;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48701 = 1;\n                                while (slt32(skip_threads_48701, 32)) {\n                                    if (sle32(skip_threads_48701, local_tid_48553 - squot32(local_tid_48553, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48699 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701)];\n                                            eta_p_48687 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48688 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48689 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48690 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        }\n                                        // perform operatio", "n\n                                        {\n                                            if (flg_y_48700 == (int8_t) 2 || flg_y_48700 == (int8_t) 0) {\n                                                flg_x_48699 = flg_y_48700;\n                                                eta_p_48687 = eta_p_48691;\n                                                eta_p_48688 = eta_p_48692;\n                                                eta_p_48689 = eta_p_48693;\n                                                eta_p_48690 = eta_p_48694;\n                                            } else {\n                                                int16_t defunc_0_op_res_48695 = add16(eta_p_48687, eta_p_48691);\n                                                int16_t defunc_0_op_res_48696 = add16(eta_p_48688, eta_p_48692);\n                                                int16_t defunc_0_op_res_48697 = add16(eta_p_48689, eta_p_48693);\n                                                int16_t defunc_0_op_res_48698 = add16(eta_p_48690, eta_p_48694);\n                                                \n                                                eta_p_48687 = defunc_0_op_res_48695;\n                                                eta_p_48688 = defunc_0_op_res_48696;\n                                                eta_p_48689 = defunc_0_op_res_48697;\n                                                eta_p_48690 = defunc_0_op_res_48698;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flg_x_48699;\n                                            flg_y_48700 = flg_x_48699;\n                                            ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = eta_p_48687;\n                                    ",
                                    "        eta_p_48691 = eta_p_48687;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48688;\n                                            eta_p_48692 = eta_p_48688;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48689;\n                                            eta_p_48693 = eta_p_48689;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48690;\n                                            eta_p_48694 = eta_p_48690;\n                                        }\n                                    }\n                                    skip_threads_48701 *= 2;\n                                }\n                            }\n                        }\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        aggr_48682 = ((__local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48683 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48684 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48685 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        if (flag_48686 == (int8_t) 2) {\n                            readOffset_48680 = wave_sizze_48555 * -1;\n                        } else if (flag_48686 == (int8_t) 1) {\n       ", "                     readOffset_48680 -= wave_sizze_48555;\n                        }\n                        if (slt8((int8_t) 0, flag_48686)) {\n                            int16_t eta_p_48702 = aggr_48682;\n                            int16_t eta_p_48703 = aggr_48683;\n                            int16_t eta_p_48704 = aggr_48684;\n                            int16_t eta_p_48705 = aggr_48685;\n                            int16_t eta_p_48706 = prefix_48673;\n                            int16_t eta_p_48707 = prefix_48674;\n                            int16_t eta_p_48708 = prefix_48675;\n                            int16_t eta_p_48709 = prefix_48676;\n                            int16_t defunc_0_op_res_48710 = add16(eta_p_48702, eta_p_48706);\n                            int16_t defunc_0_op_res_48711 = add16(eta_p_48703, eta_p_48707);\n                            int16_t defunc_0_op_res_48712 = add16(eta_p_48704, eta_p_48708);\n                            int16_t defunc_0_op_res_48713 = add16(eta_p_48705, eta_p_48709);\n                            \n                            prefix_48673 = defunc_0_op_res_48710;\n                            prefix_48674 = defunc_0_op_res_48711;\n                            prefix_48675 = defunc_0_op_res_48712;\n                            prefix_48676 = defunc_0_op_res_48713;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_45203 * chunk_sizze_48529)) {\n                        int16_t eta_p_48714 = prefix_48673;\n                        int16_t eta_p_48715 = prefix_48674;\n                        int16_t eta_p_48716 = prefix_48675;\n                        int16_t eta_p_48717 = prefix_48676;\n                        int16_t eta_p_48718 = acc_48648;\n                        int16_t eta_p_48719 = acc_48649;\n                        int16_t eta_p_48720 = acc_48650;\n                ", "        int16_t eta_p_48721 = acc_48651;\n                        int16_t defunc_0_op_res_48722 = add16(eta_p_48714, eta_p_48718);\n                        int16_t defunc_0_op_res_48723 = add16(eta_p_48715, eta_p_48719);\n                        int16_t defunc_0_op_res_48724 = add16(eta_p_48716, eta_p_48720);\n                        int16_t defunc_0_op_res_48725 = add16(eta_p_48717, eta_p_48721);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = defunc_0_op_res_48722;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = defunc_0_op_res_48723;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = defunc_0_op_res_48724;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = defunc_0_op_res_48725;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48566)[(int64_t) 16] = prefix_48673;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)] = prefix_48674;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)] = prefix_48675;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)] = prefix_48676;\n                    acc_48648 = (int16_t) 0;\n                    acc_48649 = (int16_t) 0;\n                    acc_48650 = (int16_t) 0;\n                    acc_48651 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48585 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48673 = ((__local int16_t *) local_mem_48566)[(int64_t) 16];\n                prefix_48674 = ((__local int16_t *) local_mem_48566)[squot",
                                    "64(warp_byte_offset_48562, (int64_t) 2)];\n                prefix_48675 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)];\n                prefix_48676 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48726;\n            int16_t eta_p_48730;\n            int16_t eta_p_48738 = prefix_48673;\n            int16_t eta_p_48742 = acc_48648;\n            int16_t eta_p_48727;\n            int16_t eta_p_48731;\n            int16_t eta_p_48739 = prefix_48674;\n            int16_t eta_p_48743 = acc_48649;\n            int16_t eta_p_48728;\n            int16_t eta_p_48732;\n            int16_t eta_p_48740 = prefix_48675;\n            int16_t eta_p_48744 = acc_48650;\n            int16_t eta_p_48729;\n            int16_t eta_p_48733;\n            int16_t eta_p_48741 = prefix_48676;\n            int16_t eta_p_48745 = acc_48651;\n            \n            if (slt32(local_tid_48553 * chunk_sizze_32b_48557, boundary_48588) && !block_new_sgm_48677) {\n                int16_t defunc_0_op_res_48746 = add16(eta_p_48738, eta_p_48742);\n                int16_t defunc_0_op_res_48747 = add16(eta_p_48739, eta_p_48743);\n                int16_t defunc_0_op_res_48748 = add16(eta_p_48740, eta_p_48744);\n                int16_t defunc_0_op_res_48749 = add16(eta_p_48741, eta_p_48745);\n                \n                eta_p_48726 = defunc_0_op_res_48746;\n                eta_p_48727 = defunc_0_op_res_48747;\n                eta_p_48728 = defunc_0_op_res_48748;\n                eta_p_48729 = defunc_0_op_res_48749;\n            } else {\n                eta_p_48726 = acc_48648;\n                eta_p_48727 = acc_48649;\n                eta_p_48728 = acc_48650;\n                eta_p_48729 = acc_48651;\n            }\n            \n            int32_t stopping_point_48750 = segsizze_compact_48589 - srem32(local_tid_48553 * chu", "nk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589);\n            \n            for (int64_t i_48751 = 0; i_48751 < chunk_sizze_48529; i_48751++) {\n                if (slt32(sext_i64_i32(i_48751), stopping_point_48750 - 1)) {\n                    eta_p_48730 = private_mem_48590[i_48751];\n                    eta_p_48731 = private_mem_48592[i_48751];\n                    eta_p_48732 = private_mem_48594[i_48751];\n                    eta_p_48733 = private_mem_48596[i_48751];\n                    \n                    int16_t defunc_0_op_res_48734 = add16(eta_p_48726, eta_p_48730);\n                    int16_t defunc_0_op_res_48735 = add16(eta_p_48727, eta_p_48731);\n                    int16_t defunc_0_op_res_48736 = add16(eta_p_48728, eta_p_48732);\n                    int16_t defunc_0_op_res_48737 = add16(eta_p_48729, eta_p_48733);\n                    \n                    private_mem_48590[i_48751] = defunc_0_op_res_48734;\n                    private_mem_48592[i_48751] = defunc_0_op_res_48735;\n                    private_mem_48594[i_48751] = defunc_0_op_res_48736;\n                    private_mem_48596[i_48751] = defunc_0_op_res_48737;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48752 = 0; i_48752 < chunk_sizze_48529; i_48752++) {\n                int64_t sharedIdx_48753 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48752;\n                int16_t tmp_48754 = private_mem_48590[i_48752];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48753] = tmp_48754;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48755 = 0; i_48755 < chunk_sizze_48529; i_48755++) {\n                int64_t flat_idx_48756 = thd_offset_48598 + i_48755 * segscan_tblock_sizze_45203;\n                int64_t slice_48757 = i16_res_41708;\n                int64_t slice_48758 = n_blocks_41", "712 * slice_48757;\n                int64_t gtid_45211 = squot64(flat_idx_48756, slice_48757);\n                int64_t remnant_48759 = flat_idx_48756 - gtid_45211 * slice_48757;\n                int64_t gtid_45212 = remnant_48759;\n                int64_t remnant_48760 = remnant_48759 - gtid_45212;\n                \n                if (slt64(flat_idx_48756, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48761 = ((__local int16_t *) local_mem_48566)[flat_idx_48756 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47889)[gtid_45211 * i16_res_41708 + gtid_45212] = tmp_48761;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48762 = 0; i_48762 < chunk_sizze_48529; i_48762++) {\n                int64_t sharedIdx_48763 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48762;\n                int16_t tmp_48764 = private_mem_48592[i_48762];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48763] = tmp_48764;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48765 = 0; i_48765 < chunk_sizze_48529; i_48765++) {\n                int64_t flat_idx_48766 = thd_offset_48598 + i_48765 * segscan_tblock_sizze_45203;\n                int64_t slice_48767 = i16_res_41708;\n                int64_t slice_48768 = n_blocks_41712 * slice_48767;\n                int64_t gtid_45211 = squot64(flat_idx_48766, slice_48767);\n                int64_t remnant_48769 = flat_idx_48766 - gtid_45211 * slice_48767;\n                int64_t gtid_45212 = remnant_48769;\n                int64_t remnant_48770 = remnant_48769 - gtid_45212;\n                \n                if (slt64(flat_idx_48766, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48771 = ((__local int16_t *) local_mem_48566)[flat_idx_48766 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47892)[gtid_45211 * i16_res_41708",
                                    " + gtid_45212] = tmp_48771;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48772 = 0; i_48772 < chunk_sizze_48529; i_48772++) {\n                int64_t sharedIdx_48773 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48772;\n                int16_t tmp_48774 = private_mem_48594[i_48772];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48773] = tmp_48774;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48775 = 0; i_48775 < chunk_sizze_48529; i_48775++) {\n                int64_t flat_idx_48776 = thd_offset_48598 + i_48775 * segscan_tblock_sizze_45203;\n                int64_t slice_48777 = i16_res_41708;\n                int64_t slice_48778 = n_blocks_41712 * slice_48777;\n                int64_t gtid_45211 = squot64(flat_idx_48776, slice_48777);\n                int64_t remnant_48779 = flat_idx_48776 - gtid_45211 * slice_48777;\n                int64_t gtid_45212 = remnant_48779;\n                int64_t remnant_48780 = remnant_48779 - gtid_45212;\n                \n                if (slt64(flat_idx_48776, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48781 = ((__local int16_t *) local_mem_48566)[flat_idx_48776 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47895)[gtid_45211 * i16_res_41708 + gtid_45212] = tmp_48781;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48782 = 0; i_48782 < chunk_sizze_48529; i_48782++) {\n                int64_t sharedIdx_48783 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48782;\n                int16_t tmp_48784 = private_mem_48596[i_48782];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48783] = tmp_48784;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48785 = 0; i_48785 < chunk_sizze_48529; i_48785++) {\n                int64", "_t flat_idx_48786 = thd_offset_48598 + i_48785 * segscan_tblock_sizze_45203;\n                int64_t slice_48787 = i16_res_41708;\n                int64_t slice_48788 = n_blocks_41712 * slice_48787;\n                int64_t gtid_45211 = squot64(flat_idx_48786, slice_48787);\n                int64_t remnant_48789 = flat_idx_48786 - gtid_45211 * slice_48787;\n                int64_t gtid_45212 = remnant_48789;\n                int64_t remnant_48790 = remnant_48789 - gtid_45212;\n                \n                if (slt64(flat_idx_48786, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48791 = ((__local int16_t *) local_mem_48566)[flat_idx_48786 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47898)[gtid_45211 * i16_res_41708 + gtid_45212] = tmp_48791;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45203\n    #undef chunk_sizze_48529\n}\nFUTHARK_KERNEL_SIZED(sortColumn_longzisegscan_45334_dim1, 1, 1)\nvoid sortColumn_longzisegscan_45334(__global int *global_failure, int64_t n_blocks_41712, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, int64_t num_tblocks_45331, int64_t num_virt_blocks_48874, int64_t num_virt_threads_48875, __global unsigned char *ext_mem_47981, __global unsigned char *mem_47989, __global unsigned char *mem_47992, __global unsigned char *status_flags_mem_48876, __global unsigned char *aggregates_mem_48878, __global unsigned char *incprefixes_mem_48880, __global unsigned char *global_dynid_mem_48882)\n{\n    #define segscan_tblock_sizze_45329 (sortColumn_longzisegscan_45334zisegscan_tblock_sizze_45329)\n    #define chunk_sizze_48873 (sortColumn_longzisegscan_45334zichunk_sizze_48873)\n    \n    volatile __local unsigned char *local_mem_48892_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48892_backing_0_offset = 0 + (smax64(smax64((int64_", "t) 288, (int64_t) 8 * segscan_tblock_sizze_45329), chunk_sizze_48873 * segscan_tblock_sizze_45329 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45329), chunk_sizze_48873 * segscan_tblock_sizze_45329 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48885;\n    int32_t tblock_sizze_48888;\n    int32_t wave_sizze_48887;\n    int32_t block_id_48886;\n    int32_t global_tid_48884;\n    int64_t phys_tid_45334;\n    int32_t chunk_sizze_32b_48889;\n    int64_t byte_offsets_48890;\n    int64_t warp_byte_offset_48891;\n    __local unsigned char *local_mem_48892;\n    int64_t trans_arr_len_48893;\n    int64_t phys_block_id_48899;\n    int64_t virtloop_bound_48900;\n    \n    local_tid_48885 = get_local_id(0);\n    tblock_sizze_48888 = get_local_size(0);\n    wave_sizze_48887 = LOCKSTEP_WIDTH;\n    block_id_48886 = get_tblock_id(0);\n    global_tid_48884 = block_id_48886 * tblock_sizze_48888 + local_tid_48885;\n    phys_tid_45334 = sext_i32_i64(global_tid_48884);\n    chunk_sizze_32b_48889 = sext_i64_i32(chunk_sizze_48873);\n    byte_offsets_48890 = segscan_tblock_sizze_45329 * (int64_t) 8;\n    warp_byte_offset_48891 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48892 = (__local unsigned char *) local_mem_48892_backing_0;\n    trans_arr_len_48893 = chunk_sizze_48873 * segscan_tblock_sizze_45329;\n    phys_block_id_48899 = get_tblock_id(0);\n    virtloop_bound_48900 = sdiv_up64(num_virt_blocks_48874 - phys_block_id_48899, num_tblocks_45331);\n    for (int64_t virtloop_i_48901 = 0; virtloop_i_48901 < virtloop_bound_48900; virtloop_i_48901++) {\n        int64_t dynamic_id_48902;\n        int64_t block_offset_48903;\n        int64_t sgm_idx_48904;\n        int32_t boundary_48905;\n        int32_t segsizze_compact_48906;\n        int64_t private_mem_48907[chunk_sizze_48873];\n        int64_t thd_offset_48909;\n        int64_t acc_48925;\n        int6",
                                    "4_t prefix_48935;\n        bool block_new_sgm_48936;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48885 == 0) {\n                dynamic_id_48902 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48882)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 0] = dynamic_id_48902;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48902 == num_virt_blocks_48874 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48882)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48902 = ((__local int32_t *) local_mem_48892)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48903 = dynamic_id_48902 * chunk_sizze_48873 * segscan_tblock_sizze_45329;\n        sgm_idx_48904 = smod64(block_offset_48903, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        boundary_48905 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_45329, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 - sgm_idx_48904));\n        segsizze_compact_48906 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_45329, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723));\n        thd_offset_48909 = block_offset_48903 + sext_i32_i64(local_tid_48885);\n        // Load and map\n        {\n            for (int64_t i_48910 = 0; i_48910 < chunk_sizze_48873; i_48910++) {\n                int64_t virt_tid_48911 = thd_offset_48909 + i_48910 * segscan_tblock_sizze_45329;\n                int64_t slice_48912 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_45333 = virt_tid_48911;\n                int64_t remnant_48913 = virt_tid_48911 - g", "tid_45333;\n                \n                if (slt64(virt_tid_48911, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t new_index_46940 = squot64(gtid_45333, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n                    int64_t binop_y_46942 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * new_index_46940;\n                    int64_t new_index_46943 = gtid_45333 - binop_y_46942;\n                    bool index_concat_cmp_46945 = sle64(n_blocks_41712, new_index_46943);\n                    int64_t index_concat_branch_46949;\n                    \n                    if (index_concat_cmp_46945) {\n                        int64_t index_concat_46947 = ((__global int64_t *) mem_47989)[new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46947;\n                    } else {\n                        int64_t index_concat_46948 = ((__global int64_t *) ext_mem_47981)[new_index_46943 * (int64_t) 4 + new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46948;\n                    }\n                    private_mem_48907[i_48910] = index_concat_branch_46949;\n                } else {\n                    private_mem_48907[i_48910] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48914 = 0; i_48914 < chunk_sizze_48873; i_48914++) {\n                int64_t sharedIdx_48915 = sext_i32_i64(local_tid_48885) + i_48914 * segscan_tblock_sizze_45329;\n                int64_t tmp_48916 = private_mem_48907[i_48914];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48915] = tmp_48916;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48917 = 0; i_48917 < chunk_sizze_48873; i_48917++) {\n                int64_t sharedIdx_48918 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48917;\n       ", "         int64_t tmp_48919 = ((__local int64_t *) local_mem_48892)[sharedIdx_48918];\n                \n                private_mem_48907[i_48917] = tmp_48919;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48920 = 0; i_48920 < chunk_sizze_48873 - (int64_t) 1; i_48920++) {\n                int64_t eta_p_41940;\n                int64_t eta_p_41941;\n                \n                eta_p_41940 = private_mem_48907[i_48920];\n                eta_p_41941 = private_mem_48907[i_48920 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_41942 = add64(eta_p_41940, eta_p_41941);\n                \n                private_mem_48907[i_48920 + (int64_t) 1] = defunc_0_op_res_41942;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_48921 = private_mem_48907[chunk_sizze_48873 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = tmp_48921;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_48922;\n            int64_t eta_p_48923;\n            int64_t eta_p_48926;\n            int64_t eta_p_48927;\n            bool ltid_in_bounds_48929 = slt64(sext_i32_i64(local_tid_48885), num_virt_threads_48875);\n            int32_t skip_threads_48930;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48929) {\n                    eta_p_48923 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                    if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                        eta_p_48922 = eta_p_48923;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48930 = 1;\n                while (slt32(skip_threads_48930,",
                                    " 32)) {\n                    bool thread_active_48931 = sle32(skip_threads_48930, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && ltid_in_bounds_48929;\n                    \n                    if (thread_active_48931) {\n                        // read operands\n                        {\n                            eta_p_48922 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48930)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48931) {\n                            int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                            \n                            eta_p_48922 = defunc_0_op_res_48924;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48931) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                            eta_p_48923 = eta_p_48922;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48930 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 31 && ltid_in_bounds_48929) {\n                    ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32))] = eta_p_48922;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n          ", "  // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48932;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                        eta_p_48927 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                        if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                            eta_p_48926 = eta_p_48927;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48932 = 1;\n                    while (slt32(skip_threads_48932, 32)) {\n                        bool thread_active_48933 = sle32(skip_threads_48932, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929);\n                        \n                        if (thread_active_48933) {\n                            // read operands\n                            {\n                                eta_p_48926 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48932)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48933) {\n                                int64_t defunc_0_op_res_48928 = add64(eta_p_48926, eta_p_48927);\n                                \n                                eta_p_48926 = defunc_0_op_res_48928;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48933) {\n                        ", "    // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48926;\n                                eta_p_48927 = eta_p_48926;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48932 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48934 = squot32(local_tid_48885, 32) == 0 || !ltid_in_bounds_48929;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48934) {\n                        eta_p_48923 = eta_p_48922;\n                        eta_p_48922 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48934) {\n                        int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                        \n                        eta_p_48922 = defunc_0_op_res_48924;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48934) {\n                        ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                    ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48923;\n              ",
                                    "  }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48885 == 0) {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[segscan_tblock_sizze_45329 - (int64_t) 1];\n            } else {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48935 = (int64_t) 0;\n        block_new_sgm_48936 = sgm_idx_48904 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48936 && local_tid_48885 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = acc_48925;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                acc_48925 = (int64_t) 0;\n            }\n            if (!block_new_sgm_48936 && slt32(local_tid_48885, wave_sizze_48887)) {\n                if (local_tid_48885 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_48878)[dynamic_id_48902] = acc_48925;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 1;\n                    \n                    int8_t tmp_48937 = ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48892)[(int64_t) 0] = tmp_48937;\n                }\n                mem_fence_local();\n                \n                int8_t status_48938 = ((__local int8_t *) local_mem_48892)[(int64_t) 0];\n                \n                if (status_48938 == (int8_t) 2) {\n                    if (local_tid_48885 == 0) {\n                        prefix_48935 = ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902 - (int64_t) 1];\n                    }", "\n                } else {\n                    int32_t readOffset_48939 = sext_i64_i32(dynamic_id_48902 - sext_i32_i64(wave_sizze_48887));\n                    \n                    while (slt32(wave_sizze_48887 * -1, readOffset_48939)) {\n                        int32_t read_i_48940 = readOffset_48939 + local_tid_48885;\n                        int64_t aggr_48941 = (int64_t) 0;\n                        int8_t flag_48942 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48940)) {\n                            flag_48942 = ((volatile __global int8_t *) status_flags_mem_48876)[sext_i32_i64(read_i_48940)];\n                            if (flag_48942 == (int8_t) 2) {\n                                aggr_48941 = ((volatile __global int64_t *) incprefixes_mem_48880)[sext_i32_i64(read_i_48940)];\n                            } else if (flag_48942 == (int8_t) 1) {\n                                aggr_48941 = ((volatile __global int64_t *) aggregates_mem_48878)[sext_i32_i64(read_i_48940)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = aggr_48941;\n                        ((__local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flag_48942;\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        if (slt8(flag_48942, (int8_t) 2)) {\n                            int8_t flg_x_48946;\n                            int8_t flg_y_48947;\n                            int64_t eta_p_48943;\n                            int64_t eta_p_48944;\n                            int32_t skip_threads_48948;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48947 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                         ", "       eta_p_48944 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)];\n                                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                                    eta_p_48943 = eta_p_48944;\n                                    flg_x_48946 = flg_y_48947;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48948 = 1;\n                                while (slt32(skip_threads_48948, 32)) {\n                                    if (sle32(skip_threads_48948, local_tid_48885 - squot32(local_tid_48885, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48946 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948)];\n                                            eta_p_48943 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48947 == (int8_t) 2 || flg_y_48947 == (int8_t) 0) {\n                                                flg_x_48946 = flg_y_48947;\n                                                eta_p_48943 = eta_p_48944;\n                                            } else {\n                                                int64_t defunc_0_op_res_48945 = add64(eta_p_48943, eta_p_48944);\n                                                \n                                                eta_p_48943 = defunc_0_op_res_48945;\n                                            }\n                                     ",
                                    "   }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flg_x_48946;\n                                            flg_y_48947 = flg_x_48946;\n                                            ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = eta_p_48943;\n                                            eta_p_48944 = eta_p_48943;\n                                        }\n                                    }\n                                    skip_threads_48948 *= 2;\n                                }\n                            }\n                        }\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        aggr_48941 = ((__local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(wave_sizze_48887) - (int64_t) 1)];\n                        if (flag_48942 == (int8_t) 2) {\n                            readOffset_48939 = wave_sizze_48887 * -1;\n                        } else if (flag_48942 == (int8_t) 1) {\n                            readOffset_48939 -= wave_sizze_48887;\n                        }\n                        if (slt8((int8_t) 0, flag_48942)) {\n                            int64_t eta_p_48949 = aggr_48941;\n                            int64_t eta_p_48950 = prefix_48935;\n                            int64_t defunc_0_op_res_48951 = add64(eta_p_48949, eta_p_48950);\n                            \n                            prefix_48935 = defunc_0_op_res_48951;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48885 == 0) {\n                    if (boundary_48905 == sext_i64_i32(segscan_tblock_sizze_45329 * chunk_sizze_48873)) {\n                        int64_t eta_p_48952 = prefix_48935;\n    ", "                    int64_t eta_p_48953 = acc_48925;\n                        int64_t defunc_0_op_res_48954 = add64(eta_p_48952, eta_p_48953);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = defunc_0_op_res_48954;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 4] = prefix_48935;\n                    acc_48925 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_48902 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48935 = ((__local int64_t *) local_mem_48892)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_48955;\n            int64_t eta_p_48956;\n            int64_t eta_p_48958 = prefix_48935;\n            int64_t eta_p_48959 = acc_48925;\n            \n            if (slt32(local_tid_48885 * chunk_sizze_32b_48889, boundary_48905) && !block_new_sgm_48936) {\n                int64_t defunc_0_op_res_48960 = add64(eta_p_48958, eta_p_48959);\n                \n                eta_p_48955 = defunc_0_op_res_48960;\n            } else {\n                eta_p_48955 = acc_48925;\n            }\n            \n            int32_t stopping_point_48961 = segsizze_compact_48906 - srem32(local_tid_48885 * chunk_sizze_32b_48889 - 1 + segsizze_compact_48906 - boundary_48905, segsizze_compact_48906);\n            \n            for (int64_t i_48962 = 0; i_48962 < chunk_sizze_48873; i_48962++) {\n                if (slt32(sext_i64_i32(i_48962), stopping_point_48961 - 1)) {\n                    eta_p_48956 = private_mem_48907[i_48962];\n                    \n                    int64_t defunc_0_op_res_48957 = add64(eta_p_48955, eta_p_48956);\n                    \n              ", "      private_mem_48907[i_48962] = defunc_0_op_res_48957;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48963 = 0; i_48963 < chunk_sizze_48873; i_48963++) {\n                int64_t sharedIdx_48964 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48963;\n                int64_t tmp_48965 = private_mem_48907[i_48963];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48964] = tmp_48965;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48966 = 0; i_48966 < chunk_sizze_48873; i_48966++) {\n                int64_t flat_idx_48967 = thd_offset_48909 + i_48966 * segscan_tblock_sizze_45329;\n                int64_t slice_48968 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_45333 = flat_idx_48967;\n                int64_t remnant_48969 = flat_idx_48967 - gtid_45333;\n                \n                if (slt64(flat_idx_48967, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t tmp_48970 = ((__local int64_t *) local_mem_48892)[flat_idx_48967 - block_offset_48903];\n                    \n                    ((__global int64_t *) mem_47992)[gtid_45333] = tmp_48970;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_45329\n    #undef chunk_sizze_48873\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzigpuseq_48446_dim1, 1, 1)\nvoid sortColumn_shortzigpuseq_48446(__global int *global_failure, int64_t m_41736, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47866, __global unsigned char *mem_47867, __global unsigned char *mem_47868, __global unsigned char *mem_47869)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int3",
                                    "2_t local_tid_48448;\n    int32_t tblock_sizze_48451;\n    int32_t wave_sizze_48450;\n    int32_t block_id_48449;\n    int32_t global_tid_48447;\n    int64_t tid_48446;\n    int16_t last_res_47806;\n    int16_t last_res_47808;\n    int16_t last_res_47810;\n    int16_t last_res_47812;\n    \n    local_tid_48448 = get_local_id(0);\n    tblock_sizze_48451 = get_local_size(0);\n    wave_sizze_48450 = LOCKSTEP_WIDTH;\n    block_id_48449 = get_tblock_id(0);\n    global_tid_48447 = block_id_48449 * tblock_sizze_48451 + local_tid_48448;\n    tid_48446 = sext_i32_i64(global_tid_48447);\n    last_res_47806 = ((__global int16_t *) mem_47857)[m_41736];\n    last_res_47808 = ((__global int16_t *) mem_47859)[m_41736];\n    last_res_47810 = ((__global int16_t *) mem_47861)[m_41736];\n    last_res_47812 = ((__global int16_t *) mem_47863)[m_41736];\n    ((__global int16_t *) mem_47866)[(int64_t) 0] = last_res_47806;\n    ((__global int16_t *) mem_47867)[(int64_t) 0] = last_res_47808;\n    ((__global int16_t *) mem_47868)[(int64_t) 0] = last_res_47810;\n    ((__global int16_t *) mem_47869)[(int64_t) 0] = last_res_47812;\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzigpuseq_48854_dim1, 1, 1)\nvoid sortColumn_shortzigpuseq_48854(__global int *global_failure, __global unsigned char *ext_mem_47871, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47984, __global unsigned char *mem_47985, __global unsigned char *mem_47986, __global unsigned char *mem_47987)\n{\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48856;\n    int32_t tblock_sizze_48859;\n    int32_t wave_sizze_48858;\n    int32_t block_id_48857;\n    int32_t global_tid_48855;\n    int64_t tid_48854;\n    int16_t defunc_0_radix_sort_step_i16_res_47825;\n    int16_t defunc_0_radix_sort_step_i16_res_47826;\n    int16_t defunc_0_radix_sort_step_i16_res_47827;\n    int16_t defunc_0_radix_sort_step_i16_res_47828;\n    int16_t tmp", "_47833;\n    int16_t tmp_47837;\n    \n    local_tid_48856 = get_local_id(0);\n    tblock_sizze_48859 = get_local_size(0);\n    wave_sizze_48858 = LOCKSTEP_WIDTH;\n    block_id_48857 = get_tblock_id(0);\n    global_tid_48855 = block_id_48857 * tblock_sizze_48859 + local_tid_48856;\n    tid_48854 = sext_i32_i64(global_tid_48855);\n    defunc_0_radix_sort_step_i16_res_47825 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47826 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47827 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n    defunc_0_radix_sort_step_i16_res_47828 = ((__global int16_t *) ext_mem_47871)[(int64_t) 0];\n    ((__global int16_t *) mem_47984)[(int64_t) 0] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47984)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47826;\n    ((__global int16_t *) mem_47984)[(int64_t) 2] = defunc_0_radix_sort_step_i16_res_47827;\n    ((__global int16_t *) mem_47984)[(int64_t) 3] = defunc_0_radix_sort_step_i16_res_47828;\n    tmp_47833 = add16(defunc_0_radix_sort_step_i16_res_47825, defunc_0_radix_sort_step_i16_res_47826);\n    tmp_47837 = add16(defunc_0_radix_sort_step_i16_res_47827, tmp_47833);\n    ((__global int16_t *) mem_47985)[(int64_t) 0] = (int16_t) 0;\n    ((__global int16_t *) mem_47985)[(int64_t) 1] = defunc_0_radix_sort_step_i16_res_47825;\n    ((__global int16_t *) mem_47985)[(int64_t) 2] = tmp_47833;\n    ((__global int16_t *) mem_47985)[(int64_t) 3] = tmp_47837;\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47986)[i_0] = ((__global int16_t *) mem_47984)[i_0];\n    }\n    for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n        ((__global int16_t *) mem_47987)[i_0] = ((__global int16_t *) mem_47985)[i_0];\n    }\n    \n  error_0:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44437_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44437(__global int *global_failure, int failure", "_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int64_t num_tblocks_44442, int32_t virt_num_tblocks_48452, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *ext_mem_47872, __global unsigned char *ext_mem_47873, __global unsigned char *ext_mem_47874, __global unsigned char *mem_47876, __global unsigned char *mem_47878)\n{\n    #define segmap_tblock_sizze_44440 (sortColumn_shortzisegmap_44437zisegmap_tblock_sizze_44440)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48454;\n    int32_t tblock_sizze_48457;\n    int32_t wave_sizze_48456;\n    int32_t block_id_48455;\n    int32_t global_tid_48453;\n    int64_t phys_tid_44437;\n    int32_t phys_tblock_id_48458;\n    int32_t iterations_48459;\n    \n    local_tid_48454 = get_local_id(0);\n    tblock_sizze_48457 = get_local_size(0);\n    wave_sizze_48456 = LOCKSTEP_WIDTH;\n    block_id_48455 = get_tblock_id(0);\n    global_tid_48453 = block_id_48455 * tblock_sizze_48457 + local_tid_48454;\n    phys_tid_44437 = sext_i32_i64(global_tid_48453);\n    phys_tblock_id_48458 = get_tblock_id(0);\n    iterations_48459 = sdiv_up32(virt_num_tblocks_48452 - phys_tblock_id_48458, sext_i64_i32(num_tblocks_44442));\n    for (int32_t i_48460 = 0; i_48460 < iterations_48459; i_48460++) {\n        int32_t virt_tblock_id_48461;\n        int64_t global_tid_48462;\n        int64_t slice_48463;\n        int64_t write_i_44436;\n        int64_t remnant_48464;\n        \n        virt_tblock_id_48461 = phys_tblock_id_48458 + i_48460 * sext_i64_i32(num_tblocks_44442);\n        global_tid_48462 = sext_i32_i64(virt_tblock_id_48461) * segmap_tblock_sizze_44440 + sext_i32_i64(local_tid_48454);\n        slice_48463 = rest_4171",
                                    "3;\n        write_i_44436 = global_tid_48462;\n        remnant_48464 = global_tid_48462 - write_i_44436;\n        if (slt64(write_i_44436, rest_41713)) {\n            int16_t defunc_0_radix_sort_step_i16_res_47822;\n            int16_t defunc_0_radix_sort_step_i16_res_47823;\n            int16_t defunc_0_radix_sort_step_i16_res_47824;\n            int16_t eta_p_43645;\n            int16_t eta_p_43646;\n            int16_t eta_p_43647;\n            int16_t eta_p_43648;\n            int16_t eta_p_43649;\n            int64_t slice_46965;\n            int16_t write_value_43650;\n            int64_t write_value_43651;\n            int64_t defunc_0_f_res_43652;\n            \n            defunc_0_radix_sort_step_i16_res_47822 = ((__global int16_t *) ext_mem_47874)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47823 = ((__global int16_t *) ext_mem_47873)[(int64_t) 0];\n            defunc_0_radix_sort_step_i16_res_47824 = ((__global int16_t *) ext_mem_47872)[(int64_t) 0];\n            eta_p_43645 = ((__global int16_t *) mem_47865)[write_i_44436];\n            eta_p_43646 = ((__global int16_t *) mem_47857)[write_i_44436];\n            eta_p_43647 = ((__global int16_t *) mem_47859)[write_i_44436];\n            eta_p_43648 = ((__global int16_t *) mem_47861)[write_i_44436];\n            eta_p_43649 = ((__global int16_t *) mem_47863)[write_i_44436];\n            slice_46965 = arg_41714 + write_i_44436;\n            write_value_43650 = ((__global int16_t *) mem_47846)[slice_46965];\n            write_value_43651 = ((__global int64_t *) mem_47848)[slice_46965];\n            futrts_lifted_f_7536(&defunc_0_f_res_43652, defunc_0_radix_sort_step_i16_res_47822, defunc_0_radix_sort_step_i16_res_47823, defunc_0_radix_sort_step_i16_res_47824, eta_p_43645, eta_p_43646, eta_p_43647, eta_p_43648, eta_p_43649);\n            if (sle64((int64_t) 0, defunc_0_f_res_43652) && slt64(defunc_0_f_res_43652, rest_41713)) {\n                ((__global int16_t *) mem_47878)[defunc_0_f_res_43652] = write_value_43650;\n   ", "         }\n            if (sle64((int64_t) 0, defunc_0_f_res_43652) && slt64(defunc_0_f_res_43652, rest_41713)) {\n                ((__global int64_t *) mem_47876)[defunc_0_f_res_43652] = write_value_43651;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44440\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44459_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44459(__global int *global_failure, __global unsigned char *mem_47986, __global unsigned char *mem_47989)\n{\n    #define segmap_tblock_sizze_44455 (sortColumn_shortzisegmap_44459zisegmap_tblock_sizze_44455)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48862;\n    int32_t tblock_sizze_48865;\n    int32_t wave_sizze_48864;\n    int32_t block_id_48863;\n    int32_t global_tid_48861;\n    int64_t phys_tid_44459;\n    int64_t global_tid_48866;\n    int64_t slice_48867;\n    int64_t gtid_44458;\n    int64_t remnant_48868;\n    \n    local_tid_48862 = get_local_id(0);\n    tblock_sizze_48865 = get_local_size(0);\n    wave_sizze_48864 = LOCKSTEP_WIDTH;\n    block_id_48863 = get_tblock_id(0);\n    global_tid_48861 = block_id_48863 * tblock_sizze_48865 + local_tid_48862;\n    phys_tid_44459 = sext_i32_i64(global_tid_48861);\n    global_tid_48866 = sext_i32_i64(block_id_48863) * segmap_tblock_sizze_44455 + sext_i32_i64(local_tid_48862);\n    slice_48867 = (int64_t) 4;\n    gtid_44458 = global_tid_48866;\n    remnant_48868 = global_tid_48866 - gtid_44458;\n    if (slt64(gtid_44458, (int64_t) 4)) {\n        int16_t eta_p_44460;\n        int64_t i16_res_44461;\n        \n        eta_p_44460 = ((__global int16_t *) mem_47986)[gtid_44458];\n        i16_res_44461 = sext_i16_i64(eta_p_44460);\n        ((__global int64_t *) mem_47989)[gtid_44458] = i16_res_44461;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44455\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44766_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44766(__", "global int *global_failure, int64_t i16_res_41708, unsigned char zzero_41709_bits, unsigned char nonzzero_41710_bits, int64_t n_blocks_41712, int64_t tmp_41751, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    bool zzero_41709 = zzero_41709_bits;\n    bool nonzzero_41710 = nonzzero_41710_bits;\n    \n    #define segmap_tblock_sizze_44759 (sortColumn_shortzisegmap_44766zisegmap_tblock_sizze_44759)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48794;\n    int32_t tblock_sizze_48797;\n    int32_t wave_sizze_48796;\n    int32_t block_id_48795;\n    int32_t global_tid_48793;\n    int64_t phys_tid_44766;\n    int64_t global_tid_48798;\n    int64_t slice_48799;\n    int64_t gtid_44765;\n    int64_t remnant_48800;\n    \n    local_tid_48794 = get_local_id(0);\n    tblock_sizze_48797 = get_local_size(0);\n    wave_sizze_48796 = LOCKSTEP_WIDTH;\n    block_id_48795 = get_tblock_id(0);\n    global_tid_48793 = block_id_48795 * tblock_sizze_48797 + local_tid_48794;\n    phys_tid_44766 = sext_i32_i64(global_tid_48793);\n    global_tid_48798 = sext_i32_i64(block_id_48795) * segmap_tblock_sizze_44759 + sext_i32_i64(local_tid_48794);\n    slice_48799 = n_blocks_41712;\n    gtid_44765 = global_tid_48798;\n    remnant_48800 = global_tid_48798 - gtid_44765;\n    if (slt64(gtid_44765, n_blocks_41712)) {\n        int16_t last_res_44775;\n        int16_t last_res_44776;\n        int16_t last_res_44777;\n        int16_t last_res_44778;\n        int16_t defunc_0_f_res_44771;\n        int16_t defunc_0_f_res_44772;\n        int16_t defunc_0_f_res_44773;\n        int16_t defunc_0_f_res_44774;\n        \n        if (nonzzero_41710) {\n            int16_t x_46956 = ((__global int16_t *) mem_47889)[gtid_44765 * i16_res_41708 + tmp_41751];\n            \n            last_res_",
                                    "44775 = x_46956;\n        } else {\n            last_res_44775 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46958 = ((__global int16_t *) mem_47892)[gtid_44765 * i16_res_41708 + tmp_41751];\n            \n            last_res_44776 = x_46958;\n        } else {\n            last_res_44776 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46960 = ((__global int16_t *) mem_47895)[gtid_44765 * i16_res_41708 + tmp_41751];\n            \n            last_res_44777 = x_46960;\n        } else {\n            last_res_44777 = (int16_t) 0;\n        }\n        if (nonzzero_41710) {\n            int16_t x_46962 = ((__global int16_t *) mem_47898)[gtid_44765 * i16_res_41708 + tmp_41751];\n            \n            last_res_44778 = x_46962;\n        } else {\n            last_res_44778 = (int16_t) 0;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_44771 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_44771 = last_res_44775;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_44772 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_44772 = last_res_44776;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_44773 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_44773 = last_res_44777;\n        }\n        if (zzero_41709) {\n            defunc_0_f_res_44774 = (int16_t) 0;\n        } else {\n            defunc_0_f_res_44774 = last_res_44778;\n        }\n        ((__global int16_t *) mem_47904)[gtid_44765] = defunc_0_f_res_44774;\n        ((__global int16_t *) mem_47906)[gtid_44765] = defunc_0_f_res_44771;\n        ((__global int16_t *) mem_47908)[gtid_44765] = defunc_0_f_res_44772;\n        ((__global int16_t *) mem_47910)[gtid_44765] = defunc_0_f_res_44773;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44759\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44788_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44788(__global int *global_failure, int failure_is_an_option, __g", "lobal int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t num_tblocks_44782, int32_t virt_num_tblocks_48801, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47882, __global unsigned char *mem_47885, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910)\n{\n    #define segmap_tblock_sizze_44781 (sortColumn_shortzisegmap_44788zisegmap_tblock_sizze_44781)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48803;\n    int32_t tblock_sizze_48806;\n    int32_t wave_sizze_48805;\n    int32_t block_id_48804;\n    int32_t global_tid_48802;\n    int64_t phys_tid_44788;\n    int32_t phys_tblock_id_48807;\n    int32_t iterations_48808;\n    \n    local_tid_48803 = get_local_id(0);\n    tblock_sizze_48806 = get_local_size(0);\n    wave_sizze_48805 = LOCKSTEP_WIDTH;\n    block_id_48804 = get_tblock_id(0);\n    global_tid_48802 = block_id_48804 * tblock_sizze_48806 + local_tid_48803;\n    phys_tid_44788 = sext_i32_i64(global_tid_48802);\n    phys_tblock_id_48807 = get_tblock_id(0);\n    iterations_48808 = sdiv_up32(virt_num_tblocks_48801 - phys_tblock_id_48807, sext_i64_i32(num_tblocks_44782));\n    for (int32_t i_48809 = 0; i_48809 < iterations_48808; i_48809++) {\n        int32_t virt_tblock_id_48810;\n        int64_t global_tid_48811;\n        int64_t slice_48812;\n        int64_t slice_48813;\n        int64_t gtid_44786;\n        int64_t remnant_48814;\n        int64_t gtid_44787;\n        int64_t remnant_48815;\n        \n        virt_tblock_id_48810 = phys_tblock_id_48807 + i_48809 * sext_i64_i32(num_tblocks_44782);\n        global_tid_48811 = sext_i32_i64(virt_tblock_id_48810) * segmap_tblock_sizze_44781 +", " sext_i32_i64(local_tid_48803);\n        slice_48812 = i16_res_41708;\n        slice_48813 = n_blocks_41712 * slice_48812;\n        gtid_44786 = squot64(global_tid_48811, slice_48812);\n        remnant_48814 = global_tid_48811 - gtid_44786 * slice_48812;\n        gtid_44787 = remnant_48814;\n        remnant_48815 = remnant_48814 - gtid_44787;\n        if (slt64(gtid_44786, n_blocks_41712) && slt64(gtid_44787, i16_res_41708)) {\n            int16_t defunc_0_f_res_44789;\n            int16_t defunc_0_f_res_44790;\n            int16_t defunc_0_f_res_44791;\n            int16_t eta_p_44792;\n            int16_t eta_p_44793;\n            int16_t eta_p_44794;\n            int16_t eta_p_44795;\n            int16_t eta_p_44796;\n            int64_t binop_x_46950;\n            int64_t new_index_46951;\n            int16_t write_value_44797;\n            int64_t write_value_44798;\n            int64_t defunc_0_f_res_44799;\n            \n            defunc_0_f_res_44789 = ((__global int16_t *) mem_47906)[gtid_44786];\n            defunc_0_f_res_44790 = ((__global int16_t *) mem_47908)[gtid_44786];\n            defunc_0_f_res_44791 = ((__global int16_t *) mem_47910)[gtid_44786];\n            eta_p_44792 = ((__global int16_t *) mem_47901)[gtid_44786 * i16_res_41708 + gtid_44787];\n            eta_p_44793 = ((__global int16_t *) mem_47889)[gtid_44786 * i16_res_41708 + gtid_44787];\n            eta_p_44794 = ((__global int16_t *) mem_47892)[gtid_44786 * i16_res_41708 + gtid_44787];\n            eta_p_44795 = ((__global int16_t *) mem_47895)[gtid_44786 * i16_res_41708 + gtid_44787];\n            eta_p_44796 = ((__global int16_t *) mem_47898)[gtid_44786 * i16_res_41708 + gtid_44787];\n            binop_x_46950 = i16_res_41708 * gtid_44786;\n            new_index_46951 = gtid_44787 + binop_x_46950;\n            write_value_44797 = ((__global int16_t *) mem_47846)[new_index_46951];\n            write_value_44798 = ((__global int64_t *) mem_47848)[new_index_46951];\n            futrts_lifted_f_7536(&defunc_0_f_res_447",
                                    "99, defunc_0_f_res_44789, defunc_0_f_res_44790, defunc_0_f_res_44791, eta_p_44792, eta_p_44793, eta_p_44794, eta_p_44795, eta_p_44796);\n            if ((sle64((int64_t) 0, gtid_44786) && slt64(gtid_44786, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_44799) && slt64(defunc_0_f_res_44799, i16_res_41708))) {\n                ((__global int16_t *) mem_47882)[gtid_44786 * i16_res_41708 + defunc_0_f_res_44799] = write_value_44797;\n            }\n            if ((sle64((int64_t) 0, gtid_44786) && slt64(gtid_44786, n_blocks_41712)) && (sle64((int64_t) 0, defunc_0_f_res_44799) && slt64(defunc_0_f_res_44799, i16_res_41708))) {\n                ((__global int64_t *) mem_47885)[gtid_44786 * i16_res_41708 + defunc_0_f_res_44799] = write_value_44798;\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44781\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44806_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44806(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_44802, int32_t virt_num_tblocks_48816, __global unsigned char *mem_47904, __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47927)\n{\n    #define segmap_tblock_sizze_44801 (sortColumn_shortzisegmap_44806zisegmap_tblock_sizze_44801)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48818;\n    int32_t tblock_sizze_48821;\n    int32_t wave_sizze_48820;\n    int32_t block_id_48819;\n    int32_t global_tid_48817;\n    int64_t phys_tid_44806;\n    int32_t phys_tblock_id_48822;\n    int32_t iterations_48823;\n    \n    local_tid_48818 = get_local_id(0);\n    tblock_sizze_48821 = get_local_size(0);\n    wave_sizze_48820 = LOCKSTEP_WIDTH;\n    block_id_48819 = get_tblock_id(0);\n    global_tid_48817 = block_id_48819 * tblock_sizze_48821 + local_tid_48818;\n    phys_tid_44806 = sext_i32_i64(global_tid_48817);\n    phys_tb", "lock_id_48822 = get_tblock_id(0);\n    iterations_48823 = sdiv_up32(virt_num_tblocks_48816 - phys_tblock_id_48822, sext_i64_i32(num_tblocks_44802));\n    for (int32_t i_48824 = 0; i_48824 < iterations_48823; i_48824++) {\n        int32_t virt_tblock_id_48825;\n        int64_t global_tid_48826;\n        int64_t slice_48827;\n        int64_t gtid_44805;\n        int64_t remnant_48828;\n        \n        virt_tblock_id_48825 = phys_tblock_id_48822 + i_48824 * sext_i64_i32(num_tblocks_44802);\n        global_tid_48826 = sext_i32_i64(virt_tblock_id_48825) * segmap_tblock_sizze_44801 + sext_i32_i64(local_tid_48818);\n        slice_48827 = n_blocks_41712;\n        gtid_44805 = global_tid_48826;\n        remnant_48828 = global_tid_48826 - gtid_44805;\n        if (slt64(gtid_44805, n_blocks_41712)) {\n            int16_t defunc_0_f_res_44807;\n            int16_t defunc_0_f_res_44808;\n            int16_t defunc_0_f_res_44809;\n            int16_t defunc_0_f_res_44810;\n            int16_t mem_47917[(int64_t) 4];\n            \n            defunc_0_f_res_44807 = ((__global int16_t *) mem_47906)[gtid_44805];\n            defunc_0_f_res_44808 = ((__global int16_t *) mem_47908)[gtid_44805];\n            defunc_0_f_res_44809 = ((__global int16_t *) mem_47910)[gtid_44805];\n            defunc_0_f_res_44810 = ((__global int16_t *) mem_47904)[gtid_44805];\n            mem_47917[(int64_t) 0] = defunc_0_f_res_44807;\n            mem_47917[(int64_t) 1] = defunc_0_f_res_44808;\n            mem_47917[(int64_t) 2] = defunc_0_f_res_44809;\n            mem_47917[(int64_t) 3] = defunc_0_f_res_44810;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47927)[gtid_44805 + i_0 * n_blocks_41712] = mem_47917[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44801\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44823_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44823(__gl", "obal int *global_failure, int64_t n_blocks_41712, __global unsigned char *mem_47927, __global unsigned char *mem_47931)\n{\n    #define segmap_tblock_sizze_44818 (sortColumn_shortzisegmap_44823zisegmap_tblock_sizze_44818)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48831;\n    int32_t tblock_sizze_48834;\n    int32_t wave_sizze_48833;\n    int32_t block_id_48832;\n    int32_t global_tid_48830;\n    int64_t phys_tid_44823;\n    int64_t global_tid_48835;\n    int64_t slice_48836;\n    int64_t slice_48837;\n    int64_t gtid_44821;\n    int64_t remnant_48838;\n    int64_t gtid_44822;\n    int64_t remnant_48839;\n    \n    local_tid_48831 = get_local_id(0);\n    tblock_sizze_48834 = get_local_size(0);\n    wave_sizze_48833 = LOCKSTEP_WIDTH;\n    block_id_48832 = get_tblock_id(0);\n    global_tid_48830 = block_id_48832 * tblock_sizze_48834 + local_tid_48831;\n    phys_tid_44823 = sext_i32_i64(global_tid_48830);\n    global_tid_48835 = sext_i32_i64(block_id_48832) * segmap_tblock_sizze_44818 + sext_i32_i64(local_tid_48831);\n    slice_48836 = (int64_t) 4;\n    slice_48837 = n_blocks_41712 * slice_48836;\n    gtid_44821 = squot64(global_tid_48835, slice_48836);\n    remnant_48838 = global_tid_48835 - gtid_44821 * slice_48836;\n    gtid_44822 = remnant_48838;\n    remnant_48839 = remnant_48838 - gtid_44822;\n    if (slt64(gtid_44821, n_blocks_41712) && slt64(gtid_44822, (int64_t) 4)) {\n        int16_t eta_p_44824;\n        int64_t i16_res_44825;\n        \n        eta_p_44824 = ((__global int16_t *) mem_47927)[gtid_44821 + gtid_44822 * n_blocks_41712];\n        i16_res_44825 = sext_i16_i64(eta_p_44824);\n        ((__global int64_t *) mem_47931)[gtid_44821 * (int64_t) 4 + gtid_44822] = i16_res_44825;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44818\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44833_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44833(__global int *global_failure, int64_t n_blocks_41712, int64_t num_tblocks_44829, int32_t virt_num_tblocks_48840,",
                                    " __global unsigned char *mem_47906, __global unsigned char *mem_47908, __global unsigned char *mem_47910, __global unsigned char *mem_47947)\n{\n    #define segmap_tblock_sizze_44828 (sortColumn_shortzisegmap_44833zisegmap_tblock_sizze_44828)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48842;\n    int32_t tblock_sizze_48845;\n    int32_t wave_sizze_48844;\n    int32_t block_id_48843;\n    int32_t global_tid_48841;\n    int64_t phys_tid_44833;\n    int32_t phys_tblock_id_48846;\n    int32_t iterations_48847;\n    \n    local_tid_48842 = get_local_id(0);\n    tblock_sizze_48845 = get_local_size(0);\n    wave_sizze_48844 = LOCKSTEP_WIDTH;\n    block_id_48843 = get_tblock_id(0);\n    global_tid_48841 = block_id_48843 * tblock_sizze_48845 + local_tid_48842;\n    phys_tid_44833 = sext_i32_i64(global_tid_48841);\n    phys_tblock_id_48846 = get_tblock_id(0);\n    iterations_48847 = sdiv_up32(virt_num_tblocks_48840 - phys_tblock_id_48846, sext_i64_i32(num_tblocks_44829));\n    for (int32_t i_48848 = 0; i_48848 < iterations_48847; i_48848++) {\n        int32_t virt_tblock_id_48849;\n        int64_t global_tid_48850;\n        int64_t slice_48851;\n        int64_t gtid_44832;\n        int64_t remnant_48852;\n        \n        virt_tblock_id_48849 = phys_tblock_id_48846 + i_48848 * sext_i64_i32(num_tblocks_44829);\n        global_tid_48850 = sext_i32_i64(virt_tblock_id_48849) * segmap_tblock_sizze_44828 + sext_i32_i64(local_tid_48842);\n        slice_48851 = n_blocks_41712;\n        gtid_44832 = global_tid_48850;\n        remnant_48852 = global_tid_48850 - gtid_44832;\n        if (slt64(gtid_44832, n_blocks_41712)) {\n            int16_t defunc_0_f_res_44834;\n            int16_t defunc_0_f_res_44835;\n            int16_t defunc_0_f_res_44836;\n            int16_t tmp_44837;\n            int16_t tmp_44838;\n            int16_t mem_47937[(int64_t) 4];\n            \n            defunc_0_f_res_44834 = ((__global int16_t *) mem_47906)[gtid_44832];\n            defunc_0_f_res_44835 = ((__globa", "l int16_t *) mem_47908)[gtid_44832];\n            defunc_0_f_res_44836 = ((__global int16_t *) mem_47910)[gtid_44832];\n            tmp_44837 = add16(defunc_0_f_res_44834, defunc_0_f_res_44835);\n            tmp_44838 = add16(defunc_0_f_res_44836, tmp_44837);\n            mem_47937[(int64_t) 0] = (int16_t) 0;\n            mem_47937[(int64_t) 1] = defunc_0_f_res_44834;\n            mem_47937[(int64_t) 2] = tmp_44837;\n            mem_47937[(int64_t) 3] = tmp_44838;\n            for (int64_t i_0 = 0; i_0 < (int64_t) 4; i_0++) {\n                ((__global int16_t *) mem_47947)[gtid_44832 + i_0 * n_blocks_41712] = mem_47937[i_0];\n            }\n        }\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44828\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44869_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44869(__global int *global_failure, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, __global unsigned char *mem_47992, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_44865 (sortColumn_shortzisegmap_44869zisegmap_tblock_sizze_44865)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48973;\n    int32_t tblock_sizze_48976;\n    int32_t wave_sizze_48975;\n    int32_t block_id_48974;\n    int32_t global_tid_48972;\n    int64_t phys_tid_44869;\n    int64_t global_tid_48977;\n    int64_t slice_48978;\n    int64_t gtid_44868;\n    int64_t remnant_48979;\n    \n    local_tid_48973 = get_local_id(0);\n    tblock_sizze_48976 = get_local_size(0);\n    wave_sizze_48975 = LOCKSTEP_WIDTH;\n    block_id_48974 = get_tblock_id(0);\n    global_tid_48972 = block_id_48974 * tblock_sizze_48976 + local_tid_48973;\n    phys_tid_44869 = sext_i32_i64(global_tid_48972);\n    global_tid_48977 = sext_i32_i64(block_id_48974) * segmap_tblock_sizze_44865 + sext_i32_i64(local_tid_48973);\n    slice_48978 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n    gtid_44868 = global_tid_48977;", "\n    remnant_48979 = global_tid_48977 - gtid_44868;\n    if (slt64(gtid_44868, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n        int64_t zv_lhs_44871;\n        int64_t tmp_44872;\n        int64_t lifted_lambda_res_44873;\n        \n        zv_lhs_44871 = add64((int64_t) -1, gtid_44868);\n        tmp_44872 = smod64(zv_lhs_44871, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        lifted_lambda_res_44873 = ((__global int64_t *) mem_47992)[tmp_44872];\n        ((__global int64_t *) mem_47995)[gtid_44868] = lifted_lambda_res_44873;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44865\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44875_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44875(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int64_t arg_41714, int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int32_t blocked_radix_sort_step_arg1_41776, int64_t num_tblocks_44880, int64_t ext_47978, int64_t ext_47979, int32_t virt_num_tblocks_48980, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47876, __global unsigned char *mem_47878, __global unsigned char *ext_mem_47980, __global unsigned char *ext_mem_47982, __global unsigned char *ext_mem_47983, __global unsigned char *mem_47987, __global unsigned char *mem_47995)\n{\n    #define segmap_tblock_sizze_44878 (sortColumn_shortzisegmap_44875zisegmap_tblock_sizze_44878)\n    \n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48982;\n    int32_t tblock_sizze_48985;\n    int32_t wave_sizze_48984;\n    int32_t block_id_48983;\n    int32_t global_tid_48981;\n    int64_t phys_tid_44875;\n    int32_t phys_tblock_id_48986;\n    int32_t iterations_48987;\n    \n    local_tid_48982 = get_local_id(0);\n    tblo",
                                    "ck_sizze_48985 = get_local_size(0);\n    wave_sizze_48984 = LOCKSTEP_WIDTH;\n    block_id_48983 = get_tblock_id(0);\n    global_tid_48981 = block_id_48983 * tblock_sizze_48985 + local_tid_48982;\n    phys_tid_44875 = sext_i32_i64(global_tid_48981);\n    phys_tblock_id_48986 = get_tblock_id(0);\n    iterations_48987 = sdiv_up32(virt_num_tblocks_48980 - phys_tblock_id_48986, sext_i64_i32(num_tblocks_44880));\n    for (int32_t i_48988 = 0; i_48988 < iterations_48987; i_48988++) {\n        int32_t virt_tblock_id_48989;\n        int64_t global_tid_48990;\n        int64_t slice_48991;\n        int64_t write_i_44874;\n        int64_t remnant_48992;\n        \n        virt_tblock_id_48989 = phys_tblock_id_48986 + i_48988 * sext_i64_i32(num_tblocks_44880);\n        global_tid_48990 = sext_i32_i64(virt_tblock_id_48989) * segmap_tblock_sizze_44878 + sext_i32_i64(local_tid_48982);\n        slice_48991 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;\n        write_i_44874 = global_tid_48990;\n        remnant_48992 = global_tid_48990 - write_i_44874;\n        if (slt64(write_i_44874, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n            bool index_concat_cmp_46931;\n            int16_t index_concat_branch_43604;\n            int32_t zlzb_rhs_43611;\n            int32_t acc_43613;\n            int64_t i32_res_43621;\n            int64_t block_idx_43622;\n            bool x_43623;\n            bool y_43624;\n            bool bounds_check_43625;\n            bool index_certs_43626;\n            bool x_43627;\n            bool y_43628;\n            bool bounds_check_43629;\n            bool index_certs_43630;\n            int16_t index_concat_branch_46935;\n            int64_t index_concat_branch_46929;\n            int64_t binop_x_43631;\n            int64_t new_index_43632;\n            int64_t new_offset_43633;\n            bool index_concat_cmp_43634;\n            int16_t index_concat_branch_43635;\n            int64_t i16_res_43638;\n            int64_t zp_lhs_4363", "9;\n            int64_t old_offset_43640;\n            int64_t zp_lhs_43641;\n            int64_t idx_43642;\n            \n            index_concat_cmp_46931 = sle64(arg_41714, write_i_44874);\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_43794;\n                int16_t index_concat_43795;\n                \n                index_concat_i_43794 = sub64(write_i_44874, arg_41714);\n                index_concat_43795 = ((__global int16_t *) mem_47878)[index_concat_i_43794];\n                index_concat_branch_43604 = index_concat_43795;\n            } else {\n                int64_t new_index_43607;\n                int64_t binop_y_43608;\n                int64_t new_index_43609;\n                int16_t index_concat_43610;\n                \n                new_index_43607 = squot64(write_i_44874, i16_res_41708);\n                binop_y_43608 = i16_res_41708 * new_index_43607;\n                new_index_43609 = write_i_44874 - binop_y_43608;\n                index_concat_43610 = ((__global int16_t *) ext_mem_47983)[new_index_43607 * i16_res_41708 + new_index_43609];\n                index_concat_branch_43604 = index_concat_43610;\n            }\n            acc_43613 = 0;\n            for (int32_t i_43612 = 0; i_43612 < 2; i_43612++) {\n                int32_t get_bit_arg0_43614;\n                int32_t defunc_0_get_bit_res_43615;\n                bool cond_43616;\n                int32_t defunc_0_get_bit_res_43617;\n                int32_t zp_rhs_43619;\n                int32_t loopres_43620;\n                int32_t acc_tmp_48993;\n                \n                get_bit_arg0_43614 = add32(blocked_radix_sort_step_arg1_41776, i_43612);\n                futrts_get_bit_1844(&defunc_0_get_bit_res_43615, get_bit_arg0_43614, index_concat_branch_43604);\n                cond_43616 = get_bit_arg0_43614 == 15;\n                if (cond_43616) {\n                    int32_t defunc_0_get_bit_res_t_res_43796 = 1 ^ defunc_0_get_bit_res_43615;\n                    \n           ", "         defunc_0_get_bit_res_43617 = defunc_0_get_bit_res_t_res_43796;\n                } else {\n                    defunc_0_get_bit_res_43617 = defunc_0_get_bit_res_43615;\n                }\n                zp_rhs_43619 = shl32(defunc_0_get_bit_res_43617, i_43612);\n                loopres_43620 = add32(acc_43613, zp_rhs_43619);\n                acc_tmp_48993 = loopres_43620;\n                acc_43613 = acc_tmp_48993;\n            }\n            zlzb_rhs_43611 = acc_43613;\n            i32_res_43621 = sext_i32_i64(zlzb_rhs_43611);\n            block_idx_43622 = sdiv64(write_i_44874, i16_res_41708);\n            x_43623 = sle64((int64_t) 0, block_idx_43622);\n            y_43624 = slt64(block_idx_43622, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n            bounds_check_43625 = x_43623 && y_43624;\n            if (!bounds_check_43625) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 21) == -1) {\n                        global_failure_args[0] = (int64_t) block_idx_43622;\n                        global_failure_args[1] = (int64_t) dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            x_43627 = sle64((int64_t) 0, i32_res_43621);\n            y_43628 = slt64(i32_res_43621, (int64_t) 4);\n            bounds_check_43629 = x_43627 && y_43628;\n            if (!bounds_check_43629) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 22) == -1) {\n                        global_failure_args[0] = (int64_t) i32_res_43621;\n                        global_failure_args[1] = (int64_t) (int64_t) 4;\n                        ;\n                    }\n                    local_failure = 1;\n                    goto error_0;\n                }\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46932;\n                int16_t index_concat_46933;\n ",
                                    "               \n                index_concat_i_46932 = sub64(write_i_44874, arg_41714);\n                index_concat_46933 = ((__global int16_t *) mem_47878)[index_concat_i_46932];\n                index_concat_branch_46935 = index_concat_46933;\n            } else {\n                int64_t new_index_46972;\n                int64_t binop_y_46974;\n                int64_t new_index_46975;\n                int16_t index_concat_46934;\n                \n                new_index_46972 = squot64(write_i_44874, i16_res_41708);\n                binop_y_46974 = i16_res_41708 * new_index_46972;\n                new_index_46975 = write_i_44874 - binop_y_46974;\n                index_concat_46934 = ((__global int16_t *) ext_mem_47983)[new_index_46972 * i16_res_41708 + new_index_46975];\n                index_concat_branch_46935 = index_concat_46934;\n            }\n            if (index_concat_cmp_46931) {\n                int64_t index_concat_i_46926;\n                int64_t index_concat_46927;\n                \n                index_concat_i_46926 = sub64(write_i_44874, arg_41714);\n                index_concat_46927 = ((__global int64_t *) mem_47876)[index_concat_i_46926];\n                index_concat_branch_46929 = index_concat_46927;\n            } else {\n                int64_t new_index_46968;\n                int64_t binop_y_46970;\n                int64_t new_index_46971;\n                int64_t index_concat_46928;\n                \n                new_index_46968 = squot64(write_i_44874, i16_res_41708);\n                binop_y_46970 = i16_res_41708 * new_index_46968;\n                new_index_46971 = write_i_44874 - binop_y_46970;\n                index_concat_46928 = ((__global int64_t *) ext_mem_47982)[new_index_46968 * i16_res_41708 + new_index_46971];\n                index_concat_branch_46929 = index_concat_46928;\n            }\n            binop_x_43631 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * i32_res_43621;\n            new_index_43632 = block_idx_43622 + binop_x_43631;\n            n", "ew_offset_43633 = ((__global int64_t *) mem_47995)[new_index_43632];\n            index_concat_cmp_43634 = sle64(n_blocks_41712, block_idx_43622);\n            if (index_concat_cmp_43634) {\n                int16_t index_concat_43797 = ((__global int16_t *) mem_47987)[i32_res_43621];\n                \n                index_concat_branch_43635 = index_concat_43797;\n            } else {\n                int16_t index_concat_43637 = ((__global int16_t *) ext_mem_47980)[block_idx_43622 * ext_47979 + i32_res_43621 * ext_47978];\n                \n                index_concat_branch_43635 = index_concat_43637;\n            }\n            i16_res_43638 = sext_i16_i64(index_concat_branch_43635);\n            zp_lhs_43639 = mul64(i16_res_41708, block_idx_43622);\n            old_offset_43640 = add64(i16_res_43638, zp_lhs_43639);\n            zp_lhs_43641 = sub64(write_i_44874, old_offset_43640);\n            idx_43642 = add64(new_offset_43633, zp_lhs_43641);\n            if (sle64((int64_t) 0, idx_43642) && slt64(idx_43642, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int16_t *) mem_47846)[idx_43642] = index_concat_branch_46935;\n            }\n            if (sle64((int64_t) 0, idx_43642) && slt64(idx_43642, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715)) {\n                ((__global int64_t *) mem_47848)[idx_43642] = index_concat_branch_46929;\n            }\n        }\n        \n      error_0:\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n        if (local_failure)\n            return;\n        barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    }\n    \n  error_1:\n    return;\n    #undef segmap_tblock_sizze_44878\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegmap_44903_dim1, 1, 1)\nvoid sortColumn_shortzisegmap_44903(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t n_24884, int64_t incr_24885, __global unsigned char *xs_mem_47844, __global unsigned c", "har *mem_47848, __global unsigned char *mem_48005, __global unsigned char *mem_48007)\n{\n    #define segmap_tblock_sizze_44898 (sortColumn_shortzisegmap_44903zisegmap_tblock_sizze_44898)\n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48996;\n    int32_t tblock_sizze_48999;\n    int32_t wave_sizze_48998;\n    int32_t block_id_48997;\n    int32_t global_tid_48995;\n    int64_t phys_tid_44903;\n    int64_t global_tid_49000;\n    int64_t slice_49001;\n    int64_t gtid_44902;\n    int64_t remnant_49002;\n    \n    local_tid_48996 = get_local_id(0);\n    tblock_sizze_48999 = get_local_size(0);\n    wave_sizze_48998 = LOCKSTEP_WIDTH;\n    block_id_48997 = get_tblock_id(0);\n    global_tid_48995 = block_id_48997 * tblock_sizze_48999 + local_tid_48996;\n    phys_tid_44903 = sext_i32_i64(global_tid_48995);\n    global_tid_49000 = sext_i32_i64(block_id_48997) * segmap_tblock_sizze_44898 + sext_i32_i64(local_tid_48996);\n    slice_49001 = n_24884;\n    gtid_44902 = global_tid_49000;\n    remnant_49002 = global_tid_49000 - gtid_44902;\n    if (slt64(gtid_44902, n_24884)) {\n        int64_t eta_p_44904;\n        bool x_44905;\n        bool y_44906;\n        bool bounds_check_44907;\n        bool index_certs_44908;\n        int64_t index_primexp_44909;\n        int16_t lifted_lambda_res_44910;\n        \n        eta_p_44904 = ((__global int64_t *) mem_47848)[gtid_44902];\n        x_44905 = sle64((int64_t) 0, eta_p_44904);\n        y_44906 = slt64(eta_p_44904, n_24884);\n        bounds_check_44907 = x_44905 && y_44906;\n        if (!bounds_check_44907) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 23) == -1) {\n                    global_failure_args[0] = (int64_t) eta_p_44904;\n                    global_failure_args[1] = (int64_t) n_24884;\n                    ;\n                }\n                return;\n            }\n        }\n        index_primexp_44909 = add64(incr_24885, eta_p_44904);\n        lifted_lambda_res_44910 = ((__global int16_t *) xs_mem_47844)",
                                    "[eta_p_44904];\n        ((__global int64_t *) mem_48005)[gtid_44902] = index_primexp_44909;\n        ((__global int16_t *) mem_48007)[gtid_44902] = lifted_lambda_res_44910;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_tblock_sizze_44898\n}\nFUTHARK_KERNEL\nvoid sortColumn_shortzisegmap_intrablock_44491(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, unsigned char zzero_41709_bits, int64_t n_blocks_41712, int64_t tmp_41751, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t computed_tblock_sizze_44464, int64_t bytes_47949, int64_t bytes_47951, int64_t maxSubHelper_48094, __global unsigned char *mem_47846, __global unsigned char *mem_47848, __global unsigned char *mem_47968, __global unsigned char *mem_47971, __global unsigned char *mem_47974, __global unsigned char *mem_47977)\n{\n    bool zzero_41709 = zzero_41709_bits;\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    volatile __local unsigned char *color_48102_backing_7 = &shared_mem[0];\n    const int64_t color_48102_backing_7_offset = 0 + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48101_backing_6 = &shared_mem[color_48102_backing_7_offset];\n    const int64_t color_48101_backing_6_offset = color_48102_backing_7_offset + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48100_backing_5 = &shared_mem[color_48101_backing_6_offset];\n    const int64_t color_48100_backing_5_offset = color_48101_backing_6_offset + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48099_backing_4 = &shared_mem[color_48100_backing_5_offset];\n    const int64_t color_48099_backing_4_offset = color_48100_backing_5_offse", "t + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48098_backing_3 = &shared_mem[color_48099_backing_4_offset];\n    const int64_t color_48098_backing_3_offset = color_48099_backing_4_offset + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48097_backing_2 = &shared_mem[color_48098_backing_3_offset];\n    const int64_t color_48097_backing_2_offset = color_48098_backing_3_offset + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8));\n    volatile __local unsigned char *color_48096_backing_1 = &shared_mem[color_48097_backing_2_offset];\n    const int64_t color_48096_backing_1_offset = color_48097_backing_2_offset + (int64_t) 32;\n    volatile __local unsigned char *color_48095_backing_0 = &shared_mem[color_48096_backing_1_offset];\n    const int64_t color_48095_backing_0_offset = color_48096_backing_1_offset + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48469;\n    int32_t tblock_sizze_48472;\n    int32_t wave_sizze_48471;\n    int32_t block_id_48470;\n    int32_t global_tid_48468;\n    int64_t phys_tblock_id_44491;\n    int64_t slice_48474;\n    int64_t ltid_pre_48473;\n    int64_t remnant_48475;\n    int64_t slice_48477;\n    int64_t ltid_pre_48476;\n    int64_t remnant_48478;\n    int64_t slice_48479;\n    int64_t gtid_44490;\n    int64_t remnant_48480;\n    __local unsigned char *color_48095;\n    __local unsigned char *color_48096;\n    __local unsigned char *color_48097;\n    __local unsigned char *color_48098;\n    __local unsigned char *color_48099;\n    __local unsigned char *color_48100;\n    __local unsigned char *color_48101;\n    __local unsigned char *color_48102;\n    int32_t num_chunks_48481;\n    int", "32_t num_chunks_48484;\n    int64_t binop_x_46980;\n    int64_t phys_tid_44506;\n    int64_t gtid_44505;\n    int64_t dims_flat_48487;\n    int16_t eta_p_44507;\n    int16_t eta_p_44508;\n    int16_t eta_p_44509;\n    int16_t eta_p_44510;\n    int16_t eta_p_44511;\n    int16_t eta_p_44512;\n    int16_t eta_p_44513;\n    int16_t eta_p_44514;\n    int16_t eta_p_48492;\n    int16_t eta_p_48493;\n    int16_t eta_p_48494;\n    int16_t eta_p_48495;\n    int16_t eta_p_48496;\n    int16_t eta_p_48497;\n    int16_t eta_p_48498;\n    int16_t eta_p_48499;\n    bool ltid_in_bounds_48504;\n    int32_t skip_threads_48505;\n    bool no_carry_in_48511;\n    int16_t defunc_0_f_res_44533;\n    int16_t defunc_0_f_res_44534;\n    int16_t defunc_0_f_res_44535;\n    int16_t defunc_0_f_res_44536;\n    int64_t phys_tid_44544;\n    int64_t write_i_44543;\n    int64_t phys_tid_44556;\n    int64_t gtid_44555;\n    int16_t tmp_44559;\n    int16_t tmp_44560;\n    int32_t num_chunks_48513;\n    int32_t num_chunks_48516;\n    int32_t num_chunks_48519;\n    int32_t num_chunks_48522;\n    \n    local_tid_48469 = get_local_id(0);\n    tblock_sizze_48472 = get_local_size(0);\n    wave_sizze_48471 = LOCKSTEP_WIDTH;\n    block_id_48470 = get_tblock_id(0);\n    global_tid_48468 = block_id_48470 * tblock_sizze_48472 + local_tid_48469;\n    phys_tblock_id_44491 = sext_i32_i64(block_id_48470);\n    slice_48474 = (int64_t) 4;\n    ltid_pre_48473 = sext_i32_i64(local_tid_48469);\n    remnant_48475 = sext_i32_i64(local_tid_48469) - ltid_pre_48473;\n    slice_48477 = i16_res_41708;\n    ltid_pre_48476 = sext_i32_i64(local_tid_48469);\n    remnant_48478 = sext_i32_i64(local_tid_48469) - ltid_pre_48476;\n    slice_48479 = n_blocks_41712;\n    gtid_44490 = sext_i32_i64(block_id_48470);\n    remnant_48480 = sext_i32_i64(block_id_48470) - gtid_44490;\n    color_48095 = (__local unsigned char *) color_48095_backing_0;\n    color_48096 = (__local unsigned char *) color_48096_backing_1;\n    color_48097 = (__local unsigned char *) color_48097_backing_2;\n    color_48098 = (",
                                    "__local unsigned char *) color_48098_backing_3;\n    color_48099 = (__local unsigned char *) color_48099_backing_4;\n    color_48100 = (__local unsigned char *) color_48100_backing_5;\n    color_48101 = (__local unsigned char *) color_48101_backing_6;\n    color_48102 = (__local unsigned char *) color_48102_backing_7;\n    num_chunks_48481 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48482 = 0; chunk_i_48482 < num_chunks_48481; chunk_i_48482++) {\n        int32_t i_48483 = chunk_i_48482 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48483, sext_i64_i32(i16_res_41708))) {\n            ((__local int16_t *) color_48102)[sext_i32_i64(i_48483)] = ((__global int16_t *) mem_47846)[(int64_t) 0 + gtid_44490 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48483)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48484 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48485 = 0; chunk_i_48485 < num_chunks_48484; chunk_i_48485++) {\n        int32_t i_48486 = chunk_i_48485 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48486, sext_i64_i32(i16_res_41708))) {\n            ((__local int64_t *) color_48101)[sext_i32_i64(i_48486)] = ((__global int64_t *) mem_47848)[(int64_t) 0 + gtid_44490 * ((int64_t) 1 * i16_res_41708) + sext_i32_i64(i_48486)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    binop_x_46980 = i16_res_41708 * gtid_44490;\n    phys_tid_44506 = sext_i32_i64(local_tid_48469);\n    gtid_44505 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(gtid_44505, i16_res_41708)) {\n        int64_t new_index_46981;\n        int16_t eta_p_44519;\n        int32_t defunc_0_get_bit_res_44520;\n        int32_t defunc_0_get_bit_res_44521;\n        int32_t zp_lhs_44523;\n        int32_t defunc_0_get_bit_res_44524;\n        int32_t defunc_0_get_bit_res_44525;\n     ", "   int32_t i32_arg0_44527;\n        int16_t i32_res_44528;\n        int16_t defunc_0_f_res_44529;\n        int16_t defunc_0_f_res_44530;\n        int16_t defunc_0_f_res_44531;\n        int16_t defunc_0_f_res_44532;\n        \n        new_index_46981 = gtid_44505 + binop_x_46980;\n        eta_p_44519 = ((__global int16_t *) mem_47846)[new_index_46981];\n        futrts_get_bit_1844(&defunc_0_get_bit_res_44520, get_bit_arg0_41781, eta_p_44519);\n        if (cond_41782) {\n            int32_t defunc_0_get_bit_res_t_res_44522 = 1 ^ defunc_0_get_bit_res_44520;\n            \n            defunc_0_get_bit_res_44521 = defunc_0_get_bit_res_t_res_44522;\n        } else {\n            defunc_0_get_bit_res_44521 = defunc_0_get_bit_res_44520;\n        }\n        zp_lhs_44523 = mul32(2, defunc_0_get_bit_res_44521);\n        futrts_get_bit_1844(&defunc_0_get_bit_res_44524, blocked_radix_sort_step_arg1_41776, eta_p_44519);\n        if (cond_41783) {\n            int32_t defunc_0_get_bit_res_t_res_44526 = 1 ^ defunc_0_get_bit_res_44524;\n            \n            defunc_0_get_bit_res_44525 = defunc_0_get_bit_res_t_res_44526;\n        } else {\n            defunc_0_get_bit_res_44525 = defunc_0_get_bit_res_44524;\n        }\n        i32_arg0_44527 = add32(zp_lhs_44523, defunc_0_get_bit_res_44525);\n        i32_res_44528 = sext_i32_i16(i32_arg0_44527);\n        futrts_lifted_lambda_7535(&defunc_0_f_res_44529, &defunc_0_f_res_44530, &defunc_0_f_res_44531, &defunc_0_f_res_44532, i32_res_44528);\n        ((__local int16_t *) color_48100)[gtid_44505] = defunc_0_f_res_44529;\n        ((__local int16_t *) color_48099)[gtid_44505] = defunc_0_f_res_44530;\n        ((__local int16_t *) color_48098)[gtid_44505] = defunc_0_f_res_44531;\n        ((__local int16_t *) color_48097)[gtid_44505] = defunc_0_f_res_44532;\n        ((__local int16_t *) color_48095)[gtid_44505] = i32_res_44528;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dims_flat_48487 = i16_res_41708;\n    ltid_in_bounds_48504 = slt64(sext_i32_i64(local_tid_48469), i16_res", "_41708);\n    // read input for in-block scan\n    {\n        if (ltid_in_bounds_48504) {\n            eta_p_44511 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n            eta_p_44512 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n            eta_p_44513 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n            eta_p_44514 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n            if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                eta_p_44507 = eta_p_44511;\n                eta_p_44508 = eta_p_44512;\n                eta_p_44509 = eta_p_44513;\n                eta_p_44510 = eta_p_44514;\n            }\n        }\n    }\n    // in-block scan (hopefully no barriers needed)\n    {\n        skip_threads_48505 = 1;\n        while (slt32(skip_threads_48505, 32)) {\n            bool thread_active_48506 = sle32(skip_threads_48505, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && ltid_in_bounds_48504;\n            \n            if (thread_active_48506) {\n                // read operands\n                {\n                    eta_p_44507 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44508 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44509 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                    eta_p_44510 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48505)];\n                }\n            }\n            // perform operation\n            {\n                bool inactive_48507 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(local_tid_48469 - skip_threads_48505));\n       ",
                                    "         \n                if (thread_active_48506 && inactive_48507) {\n                    eta_p_44507 = eta_p_44511;\n                    eta_p_44508 = eta_p_44512;\n                    eta_p_44509 = eta_p_44513;\n                    eta_p_44510 = eta_p_44514;\n                }\n                if (thread_active_48506) {\n                    if (!inactive_48507) {\n                        int16_t defunc_0_op_res_44515 = add16(eta_p_44507, eta_p_44511);\n                        int16_t defunc_0_op_res_44516 = add16(eta_p_44508, eta_p_44512);\n                        int16_t defunc_0_op_res_44517 = add16(eta_p_44509, eta_p_44513);\n                        int16_t defunc_0_op_res_44518 = add16(eta_p_44510, eta_p_44514);\n                        \n                        eta_p_44507 = defunc_0_op_res_44515;\n                        eta_p_44508 = defunc_0_op_res_44516;\n                        eta_p_44509 = defunc_0_op_res_44517;\n                        eta_p_44510 = defunc_0_op_res_44518;\n                    }\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n            if (thread_active_48506) {\n                // write result\n                {\n                    ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44507;\n                    eta_p_44511 = eta_p_44507;\n                    ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44508;\n                    eta_p_44512 = eta_p_44508;\n                    ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_44509;\n                    eta_p_44513 = eta_p_44509;\n                    ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44510;\n                    eta_p_44514 = eta_p_44510;\n                }\n            }\n            if (sle32(wave_sizze_48471, skip_threads_48505)) {\n                barrier(CLK", "_LOCAL_MEM_FENCE);\n            }\n            skip_threads_48505 *= 2;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // last thread of block 'i' writes its result to offset 'i'\n    {\n        if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 31 && ltid_in_bounds_48504) {\n            ((volatile __local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44507;\n            ((volatile __local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44508;\n            ((volatile __local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44509;\n            ((volatile __local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32))] = eta_p_44510;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n    {\n        int32_t skip_threads_48508;\n        \n        // read input for in-block scan\n        {\n            if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n                eta_p_48496 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)];\n                eta_p_48497 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)];\n                eta_p_48498 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)];\n                eta_p_48499 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)];\n                if ((local_tid_48469 - squot32(local_tid_48469, 32) * 32) == 0) {\n                    eta_p_48492 = eta_p_48496;\n                    eta_p_48493 = eta_p_48497;\n                    eta_p_48494 = eta_p_48498;\n                    eta_p_48495 = eta_p_48499;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_48508 = 1;\n            while (slt32(skip_threads_48508, 32)) {\n                bool thread_active_48509 = sle32(skip_t", "hreads_48508, local_tid_48469 - squot32(local_tid_48469, 32) * 32) && (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504);\n                \n                if (thread_active_48509) {\n                    // read operands\n                    {\n                        eta_p_48492 = ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48493 = ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48494 = ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                        eta_p_48495 = ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469) - sext_i32_i64(skip_threads_48508)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48510 = slt64(srem64(sext_i32_i64(local_tid_48469 * 32 + 32 - 1), i16_res_41708), sext_i32_i64(local_tid_48469 * 32 + 32 - 1) - sext_i32_i64((local_tid_48469 - skip_threads_48508) * 32 + 32 - 1));\n                    \n                    if (thread_active_48509 && inactive_48510) {\n                        eta_p_48492 = eta_p_48496;\n                        eta_p_48493 = eta_p_48497;\n                        eta_p_48494 = eta_p_48498;\n                        eta_p_48495 = eta_p_48499;\n                    }\n                    if (thread_active_48509) {\n                        if (!inactive_48510) {\n                            int16_t defunc_0_op_res_48500 = add16(eta_p_48492, eta_p_48496);\n                            int16_t defunc_0_op_res_48501 = add16(eta_p_48493, eta_p_48497);\n                            int16_t defunc_0_op_res_48502 = add16(eta_p_48494, eta_p_48498);\n                            int16_t defunc_0_op_res_48503 = add16(eta_p_48495, eta_p_48499);\n                            \n                         ",
                                    "   eta_p_48492 = defunc_0_op_res_48500;\n                            eta_p_48493 = defunc_0_op_res_48501;\n                            eta_p_48494 = defunc_0_op_res_48502;\n                            eta_p_48495 = defunc_0_op_res_48503;\n                        }\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (thread_active_48509) {\n                    // write result\n                    {\n                        ((volatile __local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_48492;\n                        eta_p_48496 = eta_p_48492;\n                        ((volatile __local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_48493;\n                        eta_p_48497 = eta_p_48493;\n                        ((volatile __local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_48494;\n                        eta_p_48498 = eta_p_48494;\n                        ((volatile __local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_48495;\n                        eta_p_48499 = eta_p_48495;\n                    }\n                }\n                if (sle32(wave_sizze_48471, skip_threads_48508)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_48508 *= 2;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    no_carry_in_48511 = squot32(local_tid_48469, 32) == 0 || !ltid_in_bounds_48504;\n    // carry-in for every block except the first\n    {\n        // read operands\n        {\n            if (!no_carry_in_48511) {\n                eta_p_44511 = eta_p_44507;\n                eta_p_44512 = eta_p_44508;\n                eta_p_44513 = eta_p_44509;\n                eta_p_44514 = eta_p_44510;\n                eta_p_44507 = ((__local int16_t *) color_48100)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_", "p_44508 = ((__local int16_t *) color_48099)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_44509 = ((__local int16_t *) color_48098)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n                eta_p_44510 = ((__local int16_t *) color_48097)[sext_i32_i64(squot32(local_tid_48469, 32)) - (int64_t) 1];\n            }\n        }\n        // perform operation\n        {\n            bool inactive_48512 = slt64(srem64(sext_i32_i64(local_tid_48469), i16_res_41708), sext_i32_i64(local_tid_48469) - sext_i32_i64(squot32(local_tid_48469, 32) * 32 - 1));\n            \n            if (!no_carry_in_48511) {\n                if (inactive_48512) {\n                    eta_p_44507 = eta_p_44511;\n                    eta_p_44508 = eta_p_44512;\n                    eta_p_44509 = eta_p_44513;\n                    eta_p_44510 = eta_p_44514;\n                }\n            }\n            if (!no_carry_in_48511) {\n                if (!inactive_48512) {\n                    int16_t defunc_0_op_res_44515 = add16(eta_p_44507, eta_p_44511);\n                    int16_t defunc_0_op_res_44516 = add16(eta_p_44508, eta_p_44512);\n                    int16_t defunc_0_op_res_44517 = add16(eta_p_44509, eta_p_44513);\n                    int16_t defunc_0_op_res_44518 = add16(eta_p_44510, eta_p_44514);\n                    \n                    eta_p_44507 = defunc_0_op_res_44515;\n                    eta_p_44508 = defunc_0_op_res_44516;\n                    eta_p_44509 = defunc_0_op_res_44517;\n                    eta_p_44510 = defunc_0_op_res_44518;\n                }\n            }\n        }\n        // write final result\n        {\n            if (!no_carry_in_48511) {\n                ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44507;\n                ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44508;\n                ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_44509;\n                ((__local", " int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44510;\n            }\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // restore correct values for first block\n    {\n        if (squot32(local_tid_48469, 32) == 0 && ltid_in_bounds_48504) {\n            ((__local int16_t *) color_48100)[sext_i32_i64(local_tid_48469)] = eta_p_44511;\n            ((__local int16_t *) color_48099)[sext_i32_i64(local_tid_48469)] = eta_p_44512;\n            ((__local int16_t *) color_48098)[sext_i32_i64(local_tid_48469)] = eta_p_44513;\n            ((__local int16_t *) color_48097)[sext_i32_i64(local_tid_48469)] = eta_p_44514;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (zzero_41709) {\n        defunc_0_f_res_44533 = (int16_t) 0;\n        defunc_0_f_res_44534 = (int16_t) 0;\n        defunc_0_f_res_44535 = (int16_t) 0;\n        defunc_0_f_res_44536 = (int16_t) 0;\n    } else {\n        int16_t last_res_44537;\n        int16_t last_res_44538;\n        int16_t last_res_44539;\n        int16_t last_res_44540;\n        \n        last_res_44537 = ((__local int16_t *) color_48100)[tmp_41751];\n        last_res_44538 = ((__local int16_t *) color_48099)[tmp_41751];\n        last_res_44539 = ((__local int16_t *) color_48098)[tmp_41751];\n        last_res_44540 = ((__local int16_t *) color_48097)[tmp_41751];\n        defunc_0_f_res_44533 = last_res_44537;\n        defunc_0_f_res_44534 = last_res_44538;\n        defunc_0_f_res_44535 = last_res_44539;\n        defunc_0_f_res_44536 = last_res_44540;\n    }\n    phys_tid_44544 = sext_i32_i64(local_tid_48469);\n    write_i_44543 = sext_i32_i64(sext_i64_i32(ltid_pre_48476));\n    if (slt64(write_i_44543, i16_res_41708)) {\n        int16_t eta_p_44545;\n        int16_t eta_p_44546;\n        int16_t eta_p_44547;\n        int16_t eta_p_44548;\n        int16_t eta_p_44549;\n        int64_t new_index_46977;\n        int16_t write_value_44550;\n        int64_t write_value_44551;\n        int64_t defunc_0_f_res_44552;\n        \n   ",
                                    "     eta_p_44545 = ((__local int16_t *) color_48095)[write_i_44543];\n        eta_p_44546 = ((__local int16_t *) color_48100)[write_i_44543];\n        eta_p_44547 = ((__local int16_t *) color_48099)[write_i_44543];\n        eta_p_44548 = ((__local int16_t *) color_48098)[write_i_44543];\n        eta_p_44549 = ((__local int16_t *) color_48097)[write_i_44543];\n        new_index_46977 = write_i_44543 + binop_x_46980;\n        write_value_44550 = ((__global int16_t *) mem_47846)[new_index_46977];\n        write_value_44551 = ((__global int64_t *) mem_47848)[new_index_46977];\n        futrts_lifted_f_7536(&defunc_0_f_res_44552, defunc_0_f_res_44533, defunc_0_f_res_44534, defunc_0_f_res_44535, eta_p_44545, eta_p_44546, eta_p_44547, eta_p_44548, eta_p_44549);\n        if (sle64((int64_t) 0, defunc_0_f_res_44552) && slt64(defunc_0_f_res_44552, i16_res_41708)) {\n            ((__local int16_t *) color_48102)[defunc_0_f_res_44552] = write_value_44550;\n        }\n        if (sle64((int64_t) 0, defunc_0_f_res_44552) && slt64(defunc_0_f_res_44552, i16_res_41708)) {\n            ((__local int64_t *) color_48101)[defunc_0_f_res_44552] = write_value_44551;\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = defunc_0_f_res_44533;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_44534;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = defunc_0_f_res_44535;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = defunc_0_f_res_44536;\n    phys_tid_44556 = sext_i32_i64(local_tid_48469);\n    gtid_44555 = sext_i32_i64(sext_i64_i32(ltid_pre_48473));\n    if (slt64(gtid_44555, (int64_t) 4)) {\n        int16_t eta_p_44557;\n        int64_t i16_res_44558;\n        \n        eta_p_44557 = ((__local int16_t *) color_48095)[gtid_44555];\n        i16_res_44558 = sext_i16_i64(eta_p_44557);\n        ((__local int64_t *) color_48096)[gtid_44555] = i16_res_44558;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    tmp_44559 = add16(defunc_0_f_res_44533, def", "unc_0_f_res_44534);\n    tmp_44560 = add16(defunc_0_f_res_44535, tmp_44559);\n    ((__local int16_t *) color_48095)[(int64_t) 0] = (int16_t) 0;\n    ((__local int16_t *) color_48095)[(int64_t) 1] = defunc_0_f_res_44533;\n    ((__local int16_t *) color_48095)[(int64_t) 2] = tmp_44559;\n    ((__local int16_t *) color_48095)[(int64_t) 3] = tmp_44560;\n    num_chunks_48513 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48514 = 0; chunk_i_48514 < num_chunks_48513; chunk_i_48514++) {\n        int32_t i_48515 = chunk_i_48514 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48515, sext_i64_i32(i16_res_41708))) {\n            ((__global int16_t *) mem_47968)[gtid_44490 * i16_res_41708 + sext_i32_i64(i_48515)] = ((__local int16_t *) color_48102)[sext_i32_i64(i_48515)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48516 = sdiv_up32(sext_i64_i32(i16_res_41708), sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48517 = 0; chunk_i_48517 < num_chunks_48516; chunk_i_48517++) {\n        int32_t i_48518 = chunk_i_48517 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48518, sext_i64_i32(i16_res_41708))) {\n            ((__global int64_t *) mem_47971)[gtid_44490 * i16_res_41708 + sext_i32_i64(i_48518)] = ((__local int64_t *) color_48101)[sext_i32_i64(i_48518)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    num_chunks_48519 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48520 = 0; chunk_i_48520 < num_chunks_48519; chunk_i_48520++) {\n        int32_t i_48521 = chunk_i_48520 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48521, 4)) {\n            ((__global int64_t *) mem_47974)[gtid_44490 * (int64_t) 4 + sext_i32_i64(i_48521)] = ((__local int64_t *) color_48096)[sext_i32_i64(i_48521)];\n        }\n    }\n    barrier(CLK_LOCAL_ME", "M_FENCE);\n    num_chunks_48522 = sdiv_up32(4, sext_i64_i32(computed_tblock_sizze_44464));\n    for (int32_t chunk_i_48523 = 0; chunk_i_48523 < num_chunks_48522; chunk_i_48523++) {\n        int32_t i_48524 = chunk_i_48523 * sext_i64_i32(computed_tblock_sizze_44464) + local_tid_48469;\n        \n        if (slt32(i_48524, 4)) {\n            ((__global int16_t *) mem_47977)[gtid_44490 * (int64_t) 4 + sext_i32_i64(i_48524)] = ((__local int16_t *) color_48095)[sext_i32_i64(i_48524)];\n        }\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n  error_5:\n    return;\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegscan_44435_dim1, 1, 1)\nvoid sortColumn_shortzisegscan_44435(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t rest_41713, int64_t arg_41714, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_44432, int64_t num_virt_blocks_48139, int64_t num_virt_threads_48140, __global unsigned char *mem_47846, __global unsigned char *mem_47857, __global unsigned char *mem_47859, __global unsigned char *mem_47861, __global unsigned char *mem_47863, __global unsigned char *mem_47865, __global unsigned char *status_flags_mem_48141, __global unsigned char *aggregates_mem_48163, __global unsigned char *incprefixes_mem_48165, __global unsigned char *aggregates_mem_48167, __global unsigned char *incprefixes_mem_48169, __global unsigned char *aggregates_mem_48171, __global unsigned char *incprefixes_mem_48173, __global unsigned char *aggregates_mem_48175, __global unsigned char *incprefixes_mem_48177, __global unsigned char *global_dynid_mem_48179)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_44430 (sortColumn_shortzisegscan_44435zisegscan_tblock_sizze_44430)\n    #define chunk_sizze_48138 (sortColumn_shortzisegscan_44435zichunk_sizze_48138)\n    \n    volatile __local unsigned",
                                    " char *local_mem_48215_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48215_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48202;\n    int32_t tblock_sizze_48205;\n    int32_t wave_sizze_48204;\n    int32_t block_id_48203;\n    int32_t global_tid_48201;\n    int64_t phys_tid_44435;\n    int32_t chunk_sizze_32b_48206;\n    int64_t byte_offsets_48207;\n    int64_t byte_offsets_48208;\n    int64_t byte_offsets_48209;\n    int64_t byte_offsets_48210;\n    int64_t warp_byte_offset_48211;\n    int64_t warp_byte_offset_48212;\n    int64_t warp_byte_offset_48213;\n    int64_t warp_byte_offset_48214;\n    __local unsigned char *local_mem_48215;\n    int64", "_t trans_arr_len_48216;\n    int64_t phys_block_id_48231;\n    int64_t virtloop_bound_48232;\n    \n    local_tid_48202 = get_local_id(0);\n    tblock_sizze_48205 = get_local_size(0);\n    wave_sizze_48204 = LOCKSTEP_WIDTH;\n    block_id_48203 = get_tblock_id(0);\n    global_tid_48201 = block_id_48203 * tblock_sizze_48205 + local_tid_48202;\n    phys_tid_44435 = sext_i32_i64(global_tid_48201);\n    chunk_sizze_32b_48206 = sext_i64_i32(chunk_sizze_48138);\n    byte_offsets_48207 = segscan_tblock_sizze_44430 * (int64_t) 2;\n    byte_offsets_48208 = sdiv_up64(byte_offsets_48207, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44430 * (int64_t) 2;\n    byte_offsets_48209 = sdiv_up64(byte_offsets_48208, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44430 * (int64_t) 2;\n    byte_offsets_48210 = sdiv_up64(byte_offsets_48209, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44430 * (int64_t) 2;\n    warp_byte_offset_48211 = (int64_t) 96;\n    warp_byte_offset_48212 = sdiv_up64(warp_byte_offset_48211, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48213 = sdiv_up64(warp_byte_offset_48212, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48214 = sdiv_up64(warp_byte_offset_48213, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48215 = (__local unsigned char *) local_mem_48215_backing_0;\n    trans_arr_len_48216 = chunk_sizze_48138 * segscan_tblock_sizze_44430;\n    phys_block_id_48231 = get_tblock_id(0);\n    virtloop_bound_48232 = sdiv_up64(num_virt_blocks_48139 - phys_block_id_48231, num_tblocks_44432);\n    for (int64_t virtloop_i_48233 = 0; virtloop_i_48233 < virtloop_bound_48232; virtloop_i_48233++) {\n        int64_t dynamic_id_48234;\n        int64_t block_offset_48235;\n        int64_t sgm_idx_48236;\n        int32_t boundary_48237;\n        int32_t segsizze_compact_48238;\n        int16_t private_mem_48239[chunk_sizze_48138];\n        int16_t private_mem_48241[chunk_sizze_48138];\n        int16_t priv", "ate_mem_48243[chunk_sizze_48138];\n        int16_t private_mem_48245[chunk_sizze_48138];\n        int64_t thd_offset_48247;\n        int16_t acc_48293;\n        int16_t acc_48294;\n        int16_t acc_48295;\n        int16_t acc_48296;\n        int16_t prefix_48315;\n        int16_t prefix_48316;\n        int16_t prefix_48317;\n        int16_t prefix_48318;\n        bool block_new_sgm_48319;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48202 == 0) {\n                dynamic_id_48234 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48179)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48215)[(int64_t) 0] = dynamic_id_48234;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48234 == num_virt_blocks_48139 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48179)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48234 = ((__local int32_t *) local_mem_48215)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48235 = dynamic_id_48234 * chunk_sizze_48138 * segscan_tblock_sizze_44430;\n        sgm_idx_48236 = smod64(block_offset_48235, rest_41713);\n        boundary_48237 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_44430, rest_41713 - sgm_idx_48236));\n        segsizze_compact_48238 = sext_i64_i32(smin64(chunk_sizze_48138 * segscan_tblock_sizze_44430, rest_41713));\n        thd_offset_48247 = block_offset_48235 + sext_i32_i64(local_tid_48202);\n        // Load and map\n        {\n            for (int64_t i_48248 = 0; i_48248 < chunk_sizze_48138; i_48248++) {\n                int64_t virt_tid_48249 = thd_offset_48247 + i_48248 * segscan_tblock_sizze_44430;\n     ",
                                    "           int64_t slice_48250 = rest_41713;\n                int64_t gtid_44434 = virt_tid_48249;\n                int64_t remnant_48251 = virt_tid_48249 - gtid_44434;\n                \n                if (slt64(virt_tid_48249, rest_41713)) {\n                    int64_t slice_46966 = arg_41714 + gtid_44434;\n                    int16_t eta_p_43668 = ((__global int16_t *) mem_47846)[slice_46966];\n                    int32_t defunc_0_get_bit_res_43669;\n                    \n                    futrts_get_bit_1844(&defunc_0_get_bit_res_43669, get_bit_arg0_41781, eta_p_43668);\n                    \n                    int32_t defunc_0_get_bit_res_43670;\n                    \n                    if (cond_41782) {\n                        int32_t defunc_0_get_bit_res_t_res_43782 = 1 ^ defunc_0_get_bit_res_43669;\n                        \n                        defunc_0_get_bit_res_43670 = defunc_0_get_bit_res_t_res_43782;\n                    } else {\n                        defunc_0_get_bit_res_43670 = defunc_0_get_bit_res_43669;\n                    }\n                    \n                    int32_t zp_lhs_43672 = mul32(2, defunc_0_get_bit_res_43670);\n                    int32_t defunc_0_get_bit_res_43673;\n                    \n                    futrts_get_bit_1844(&defunc_0_get_bit_res_43673, blocked_radix_sort_step_arg1_41776, eta_p_43668);\n                    \n                    int32_t defunc_0_get_bit_res_43674;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_43783 = 1 ^ defunc_0_get_bit_res_43673;\n                        \n                        defunc_0_get_bit_res_43674 = defunc_0_get_bit_res_t_res_43783;\n                    } else {\n                        defunc_0_get_bit_res_43674 = defunc_0_get_bit_res_43673;\n                    }\n                    \n                    int32_t i32_arg0_43676 = add32(zp_lhs_43672, defunc_0_get_bit_res_43674);\n                    int16_t i32_res_43677 = sext_i32_", "i16(i32_arg0_43676);\n                    int16_t defunc_0_f_res_43679;\n                    int16_t defunc_0_f_res_43680;\n                    int16_t defunc_0_f_res_43681;\n                    int16_t defunc_0_f_res_43682;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_43679, &defunc_0_f_res_43680, &defunc_0_f_res_43681, &defunc_0_f_res_43682, i32_res_43677);\n                    ((__global int16_t *) mem_47865)[gtid_44434] = i32_res_43677;\n                    private_mem_48239[i_48248] = defunc_0_f_res_43679;\n                    private_mem_48241[i_48248] = defunc_0_f_res_43680;\n                    private_mem_48243[i_48248] = defunc_0_f_res_43681;\n                    private_mem_48245[i_48248] = defunc_0_f_res_43682;\n                } else {\n                    private_mem_48239[i_48248] = (int16_t) 0;\n                    private_mem_48241[i_48248] = (int16_t) 0;\n                    private_mem_48243[i_48248] = (int16_t) 0;\n                    private_mem_48245[i_48248] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48252 = 0; i_48252 < chunk_sizze_48138; i_48252++) {\n                int64_t sharedIdx_48253 = sext_i32_i64(local_tid_48202) + i_48252 * segscan_tblock_sizze_44430;\n                int16_t tmp_48254 = private_mem_48239[i_48252];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48253] = tmp_48254;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48255 = 0; i_48255 < chunk_sizze_48138; i_48255++) {\n                int64_t sharedIdx_48256 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48255;\n                int16_t tmp_48257 = ((__local int16_t *) local_mem_48215)[sharedIdx_48256];\n                \n                private_mem_48239[i_48255] = tmp_48257;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t ", "i_48258 = 0; i_48258 < chunk_sizze_48138; i_48258++) {\n                int64_t sharedIdx_48259 = sext_i32_i64(local_tid_48202) + i_48258 * segscan_tblock_sizze_44430;\n                int16_t tmp_48260 = private_mem_48241[i_48258];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48259] = tmp_48260;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48261 = 0; i_48261 < chunk_sizze_48138; i_48261++) {\n                int64_t sharedIdx_48262 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48261;\n                int16_t tmp_48263 = ((__local int16_t *) local_mem_48215)[sharedIdx_48262];\n                \n                private_mem_48241[i_48261] = tmp_48263;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48264 = 0; i_48264 < chunk_sizze_48138; i_48264++) {\n                int64_t sharedIdx_48265 = sext_i32_i64(local_tid_48202) + i_48264 * segscan_tblock_sizze_44430;\n                int16_t tmp_48266 = private_mem_48243[i_48264];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48265] = tmp_48266;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48267 = 0; i_48267 < chunk_sizze_48138; i_48267++) {\n                int64_t sharedIdx_48268 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48267;\n                int16_t tmp_48269 = ((__local int16_t *) local_mem_48215)[sharedIdx_48268];\n                \n                private_mem_48243[i_48267] = tmp_48269;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48270 = 0; i_48270 < chunk_sizze_48138; i_48270++) {\n                int64_t sharedIdx_48271 = sext_i32_i64(local_tid_48202) + i_48270 * segscan_tblock_sizze_44430;\n                int16_t tmp_48272 = private_mem_48245[i_48270];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48271] = tmp_48272;\n            }\n            barrier(",
                                    "CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48273 = 0; i_48273 < chunk_sizze_48138; i_48273++) {\n                int64_t sharedIdx_48274 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48273;\n                int16_t tmp_48275 = ((__local int16_t *) local_mem_48215)[sharedIdx_48274];\n                \n                private_mem_48245[i_48273] = tmp_48275;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48276 = 0; i_48276 < chunk_sizze_48138 - (int64_t) 1; i_48276++) {\n                int16_t eta_p_41812;\n                int16_t eta_p_41816;\n                \n                eta_p_41812 = private_mem_48239[i_48276];\n                eta_p_41816 = private_mem_48239[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41813;\n                int16_t eta_p_41817;\n                \n                eta_p_41813 = private_mem_48241[i_48276];\n                eta_p_41817 = private_mem_48241[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41814;\n                int16_t eta_p_41818;\n                \n                eta_p_41814 = private_mem_48243[i_48276];\n                eta_p_41818 = private_mem_48243[i_48276 + (int64_t) 1];\n                \n                int16_t eta_p_41815;\n                int16_t eta_p_41819;\n                \n                eta_p_41815 = private_mem_48245[i_48276];\n                eta_p_41819 = private_mem_48245[i_48276 + (int64_t) 1];\n                \n                int16_t defunc_0_op_res_41820 = add16(eta_p_41812, eta_p_41816);\n                int16_t defunc_0_op_res_41821 = add16(eta_p_41813, eta_p_41817);\n                int16_t defunc_0_op_res_41822 = add16(eta_p_41814, eta_p_41818);\n                int16_t defunc_0_op_res_41823 = add16(eta_p_41815, eta_p_41819);\n                \n                private_mem_48239[i_48276 + (int64_t) 1] = defunc_0_op_res_41820;\n                private_mem_48241[i_48276 + (int64_t) 1] =", " defunc_0_op_res_41821;\n                private_mem_48243[i_48276 + (int64_t) 1] = defunc_0_op_res_41822;\n                private_mem_48245[i_48276 + (int64_t) 1] = defunc_0_op_res_41823;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48277 = private_mem_48239[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = tmp_48277;\n            \n            int16_t tmp_48278 = private_mem_48241[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48278;\n            \n            int16_t tmp_48279 = private_mem_48243[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48279;\n            \n            int16_t tmp_48280 = private_mem_48245[chunk_sizze_48138 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = tmp_48280;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48281;\n            int16_t eta_p_48282;\n            int16_t eta_p_48283;\n            int16_t eta_p_48284;\n            int16_t eta_p_48285;\n            int16_t eta_p_48286;\n            int16_t eta_p_48287;\n            int16_t eta_p_48288;\n            int16_t eta_p_48297;\n            int16_t eta_p_48298;\n            int16_t eta_p_48299;\n            int16_t eta_p_48300;\n            int16_t eta_p_48301;\n            int16_t eta_p_48302;\n            int16_t eta_p_48303;\n            int16_t eta_p_48304;\n            bool ltid_in_bounds_48309 = slt64(sext_i32_i64(local_tid_48202), num_virt_threads_48140);\n            int32_t skip_threads_48310;\n            \n            // r", "ead input for in-block scan\n            {\n                if (ltid_in_bounds_48309) {\n                    eta_p_48285 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                    eta_p_48286 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48287 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    eta_p_48288 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                    if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                        eta_p_48281 = eta_p_48285;\n                        eta_p_48282 = eta_p_48286;\n                        eta_p_48283 = eta_p_48287;\n                        eta_p_48284 = eta_p_48288;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48310 = 1;\n                while (slt32(skip_threads_48310, 32)) {\n                    bool thread_active_48311 = sle32(skip_threads_48310, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && ltid_in_bounds_48309;\n                    \n                    if (thread_active_48311) {\n                        // read operands\n                        {\n                            eta_p_48281 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310)];\n                            eta_p_48282 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                            eta_p_48283 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i6",
                                    "4(skip_threads_48310))];\n                            eta_p_48284 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48310))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48311) {\n                            int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                            int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                            int16_t defunc_0_op_res_48291 = add16(eta_p_48283, eta_p_48287);\n                            int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                            \n                            eta_p_48281 = defunc_0_op_res_48289;\n                            eta_p_48282 = defunc_0_op_res_48290;\n                            eta_p_48283 = defunc_0_op_res_48291;\n                            eta_p_48284 = defunc_0_op_res_48292;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48311) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                            eta_p_48285 = eta_p_48281;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                            eta_p_48286 = eta_p_48282;\n                            ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                            eta_p_48287 = eta_p_48283;\n                            (", "(volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                            eta_p_48288 = eta_p_48284;\n                        }\n                    }\n                    if (sle32(wave_sizze_48204, skip_threads_48310)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48310 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 31 && ltid_in_bounds_48309) {\n                    ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48281;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48282;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48283;\n                    ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48202, 32))] = eta_p_48284;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48312;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                        eta_p_48301 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                        eta_p_48302 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)];", "\n                        eta_p_48303 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        eta_p_48304 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                        if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                            eta_p_48297 = eta_p_48301;\n                            eta_p_48298 = eta_p_48302;\n                            eta_p_48299 = eta_p_48303;\n                            eta_p_48300 = eta_p_48304;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48312 = 1;\n                    while (slt32(skip_threads_48312, 32)) {\n                        bool thread_active_48313 = sle32(skip_threads_48312, local_tid_48202 - squot32(local_tid_48202, 32) * 32) && (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309);\n                        \n                        if (thread_active_48313) {\n                            // read operands\n                            {\n                                eta_p_48297 = ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312)];\n                                eta_p_48298 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48299 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))];\n                                eta_p_48300 = ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48312))",
                                    "];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (thread_active_48313) {\n                                int16_t defunc_0_op_res_48305 = add16(eta_p_48297, eta_p_48301);\n                                int16_t defunc_0_op_res_48306 = add16(eta_p_48298, eta_p_48302);\n                                int16_t defunc_0_op_res_48307 = add16(eta_p_48299, eta_p_48303);\n                                int16_t defunc_0_op_res_48308 = add16(eta_p_48300, eta_p_48304);\n                                \n                                eta_p_48297 = defunc_0_op_res_48305;\n                                eta_p_48298 = defunc_0_op_res_48306;\n                                eta_p_48299 = defunc_0_op_res_48307;\n                                eta_p_48300 = defunc_0_op_res_48308;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48313) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48297;\n                                eta_p_48301 = eta_p_48297;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48298;\n                                eta_p_48302 = eta_p_48298;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48299;\n                                eta_p_48303 = eta_p_48299;\n                                ((volatile __local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local", "_tid_48202)] = eta_p_48300;\n                                eta_p_48304 = eta_p_48300;\n                            }\n                        }\n                        if (sle32(wave_sizze_48204, skip_threads_48312)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48312 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48314 = squot32(local_tid_48202, 32) == 0 || !ltid_in_bounds_48309;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48314) {\n                        eta_p_48285 = eta_p_48281;\n                        eta_p_48286 = eta_p_48282;\n                        eta_p_48287 = eta_p_48283;\n                        eta_p_48288 = eta_p_48284;\n                        eta_p_48281 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1];\n                        eta_p_48282 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48283 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                        eta_p_48284 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48202, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48314) {\n                        int16_t defunc_0_op_res_48289 = add16(eta_p_48281, eta_p_48285);\n                        int16_t defunc_0_op_res_48290 = add16(eta_p_48282, eta_p_48286);\n                        int16_t defunc_0_op_res_48291 = add16(et", "a_p_48283, eta_p_48287);\n                        int16_t defunc_0_op_res_48292 = add16(eta_p_48284, eta_p_48288);\n                        \n                        eta_p_48281 = defunc_0_op_res_48289;\n                        eta_p_48282 = defunc_0_op_res_48290;\n                        eta_p_48283 = defunc_0_op_res_48291;\n                        eta_p_48284 = defunc_0_op_res_48292;\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48314) {\n                        ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48281;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48282;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48283;\n                        ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48284;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48202, 32) == 0 && ltid_in_bounds_48309) {\n                    ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = eta_p_48285;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48286;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48287;\n                    ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48288;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n        ",
                                    "    if (local_tid_48202 == 0) {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[segscan_tblock_sizze_44430 - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (segscan_tblock_sizze_44430 - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (segscan_tblock_sizze_44430 - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (segscan_tblock_sizze_44430 - (int64_t) 1)];\n            } else {\n                acc_48293 = ((__local int16_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - (int64_t) 1];\n                acc_48294 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48207, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48295 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48208, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n                acc_48296 = ((__local int16_t *) local_mem_48215)[squot64(byte_offsets_48209, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48315 = (int16_t) 0;\n        prefix_48316 = (int16_t) 0;\n        prefix_48317 = (int16_t) 0;\n        prefix_48318 = (int16_t) 0;\n        block_new_sgm_48319 = sgm_idx_48236 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48319 && local_tid_48202 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = acc_48293;\n                ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = acc_48294;\n                ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = acc_48295;\n                ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = acc_48296;\n                me", "m_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                acc_48293 = (int16_t) 0;\n                acc_48294 = (int16_t) 0;\n                acc_48295 = (int16_t) 0;\n                acc_48296 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48319 && slt32(local_tid_48202, wave_sizze_48204)) {\n                if (local_tid_48202 == 0) {\n                    ((volatile __global int16_t *) aggregates_mem_48163)[dynamic_id_48234] = acc_48293;\n                    ((volatile __global int16_t *) aggregates_mem_48167)[dynamic_id_48234] = acc_48294;\n                    ((volatile __global int16_t *) aggregates_mem_48171)[dynamic_id_48234] = acc_48295;\n                    ((volatile __global int16_t *) aggregates_mem_48175)[dynamic_id_48234] = acc_48296;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 1;\n                    \n                    int8_t tmp_48320 = ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48215)[(int64_t) 0] = tmp_48320;\n                }\n                mem_fence_local();\n                \n                int8_t status_48321 = ((__local int8_t *) local_mem_48215)[(int64_t) 0];\n                \n                if (status_48321 == (int8_t) 2) {\n                    if (local_tid_48202 == 0) {\n                        prefix_48315 = ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48316 = ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48317 = ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234 - (int64_t) 1];\n                        prefix_48318 = ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic", "_id_48234 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48322 = sext_i64_i32(dynamic_id_48234 - sext_i32_i64(wave_sizze_48204));\n                    \n                    while (slt32(wave_sizze_48204 * -1, readOffset_48322)) {\n                        int32_t read_i_48323 = readOffset_48322 + local_tid_48202;\n                        int16_t aggr_48324 = (int16_t) 0;\n                        int16_t aggr_48325 = (int16_t) 0;\n                        int16_t aggr_48326 = (int16_t) 0;\n                        int16_t aggr_48327 = (int16_t) 0;\n                        int8_t flag_48328 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48323)) {\n                            flag_48328 = ((volatile __global int8_t *) status_flags_mem_48141)[sext_i32_i64(read_i_48323)];\n                            if (flag_48328 == (int8_t) 2) {\n                                aggr_48324 = ((volatile __global int16_t *) incprefixes_mem_48165)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) incprefixes_mem_48169)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) incprefixes_mem_48173)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) incprefixes_mem_48177)[sext_i32_i64(read_i_48323)];\n                            } else if (flag_48328 == (int8_t) 1) {\n                                aggr_48324 = ((volatile __global int16_t *) aggregates_mem_48163)[sext_i32_i64(read_i_48323)];\n                                aggr_48325 = ((volatile __global int16_t *) aggregates_mem_48167)[sext_i32_i64(read_i_48323)];\n                                aggr_48326 = ((volatile __global int16_t *) aggregates_mem_48171)[sext_i32_i64(read_i_48323)];\n                                aggr_48327 = ((volatile __global int16_t *) aggregates_mem_48175)[sext_i32_i64(read_i_48323",
                                    ")];\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = aggr_48324;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48325;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48326;\n                        ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = aggr_48327;\n                        ((__local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flag_48328;\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        if (slt8(flag_48328, (int8_t) 2)) {\n                            int8_t flg_x_48341;\n                            int8_t flg_y_48342;\n                            int16_t eta_p_48329;\n                            int16_t eta_p_48330;\n                            int16_t eta_p_48331;\n                            int16_t eta_p_48332;\n                            int16_t eta_p_48333;\n                            int16_t eta_p_48334;\n                            int16_t eta_p_48335;\n                            int16_t eta_p_48336;\n                            int32_t skip_threads_48343;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48342 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)];\n                                eta_p_48333 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)];\n                                eta_p_48334 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + se", "xt_i32_i64(local_tid_48202)];\n                                eta_p_48335 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                eta_p_48336 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)];\n                                if ((local_tid_48202 - squot32(local_tid_48202, 32) * 32) == 0) {\n                                    eta_p_48329 = eta_p_48333;\n                                    eta_p_48330 = eta_p_48334;\n                                    eta_p_48331 = eta_p_48335;\n                                    eta_p_48332 = eta_p_48336;\n                                    flg_x_48341 = flg_y_48342;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48343 = 1;\n                                while (slt32(skip_threads_48343, 32)) {\n                                    if (sle32(skip_threads_48343, local_tid_48202 - squot32(local_tid_48202, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48341 = ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343)];\n                                            eta_p_48329 = ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48330 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48331 = ((volatile __local int16_t *) local_mem_48215)[squot64(", "warp_byte_offset_48212, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                            eta_p_48332 = ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(local_tid_48202) - sext_i32_i64(skip_threads_48343))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48342 == (int8_t) 2 || flg_y_48342 == (int8_t) 0) {\n                                                flg_x_48341 = flg_y_48342;\n                                                eta_p_48329 = eta_p_48333;\n                                                eta_p_48330 = eta_p_48334;\n                                                eta_p_48331 = eta_p_48335;\n                                                eta_p_48332 = eta_p_48336;\n                                            } else {\n                                                int16_t defunc_0_op_res_48337 = add16(eta_p_48329, eta_p_48333);\n                                                int16_t defunc_0_op_res_48338 = add16(eta_p_48330, eta_p_48334);\n                                                int16_t defunc_0_op_res_48339 = add16(eta_p_48331, eta_p_48335);\n                                                int16_t defunc_0_op_res_48340 = add16(eta_p_48332, eta_p_48336);\n                                                \n                                                eta_p_48329 = defunc_0_op_res_48337;\n                                                eta_p_48330 = defunc_0_op_res_48338;\n                                                eta_p_48331 = defunc_0_op_res_48339;\n                                                eta_p_48332 = defunc_0_op_res_48340;\n                                            }\n                                        }\n                                        // write result\n       ",
                                    "                                 {\n                                            ((volatile __local int8_t *) local_mem_48215)[sext_i32_i64(local_tid_48202)] = flg_x_48341;\n                                            flg_y_48342 = flg_x_48341;\n                                            ((volatile __local int16_t *) local_mem_48215)[(int64_t) 16 + sext_i32_i64(local_tid_48202)] = eta_p_48329;\n                                            eta_p_48333 = eta_p_48329;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48330;\n                                            eta_p_48334 = eta_p_48330;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48331;\n                                            eta_p_48335 = eta_p_48331;\n                                            ((volatile __local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + sext_i32_i64(local_tid_48202)] = eta_p_48332;\n                                            eta_p_48336 = eta_p_48332;\n                                        }\n                                    }\n                                    skip_threads_48343 *= 2;\n                                }\n                            }\n                        }\n                        flag_48328 = ((__local int8_t *) local_mem_48215)[sext_i32_i64(wave_sizze_48204) - (int64_t) 1];\n                        aggr_48324 = ((__local int16_t *) local_mem_48215)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48325 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48326 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (", "int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        aggr_48327 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2) + (sext_i32_i64(wave_sizze_48204) - (int64_t) 1)];\n                        if (flag_48328 == (int8_t) 2) {\n                            readOffset_48322 = wave_sizze_48204 * -1;\n                        } else if (flag_48328 == (int8_t) 1) {\n                            readOffset_48322 -= wave_sizze_48204;\n                        }\n                        if (slt8((int8_t) 0, flag_48328)) {\n                            int16_t eta_p_48344 = aggr_48324;\n                            int16_t eta_p_48345 = aggr_48325;\n                            int16_t eta_p_48346 = aggr_48326;\n                            int16_t eta_p_48347 = aggr_48327;\n                            int16_t eta_p_48348 = prefix_48315;\n                            int16_t eta_p_48349 = prefix_48316;\n                            int16_t eta_p_48350 = prefix_48317;\n                            int16_t eta_p_48351 = prefix_48318;\n                            int16_t defunc_0_op_res_48352 = add16(eta_p_48344, eta_p_48348);\n                            int16_t defunc_0_op_res_48353 = add16(eta_p_48345, eta_p_48349);\n                            int16_t defunc_0_op_res_48354 = add16(eta_p_48346, eta_p_48350);\n                            int16_t defunc_0_op_res_48355 = add16(eta_p_48347, eta_p_48351);\n                            \n                            prefix_48315 = defunc_0_op_res_48352;\n                            prefix_48316 = defunc_0_op_res_48353;\n                            prefix_48317 = defunc_0_op_res_48354;\n                            prefix_48318 = defunc_0_op_res_48355;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48202 == 0) {\n                    if (boundary_48237 == sext_i64_i32(segscan_tblock_sizze_44430 * chunk_sizze_48138))", " {\n                        int16_t eta_p_48356 = prefix_48315;\n                        int16_t eta_p_48357 = prefix_48316;\n                        int16_t eta_p_48358 = prefix_48317;\n                        int16_t eta_p_48359 = prefix_48318;\n                        int16_t eta_p_48360 = acc_48293;\n                        int16_t eta_p_48361 = acc_48294;\n                        int16_t eta_p_48362 = acc_48295;\n                        int16_t eta_p_48363 = acc_48296;\n                        int16_t defunc_0_op_res_48364 = add16(eta_p_48356, eta_p_48360);\n                        int16_t defunc_0_op_res_48365 = add16(eta_p_48357, eta_p_48361);\n                        int16_t defunc_0_op_res_48366 = add16(eta_p_48358, eta_p_48362);\n                        int16_t defunc_0_op_res_48367 = add16(eta_p_48359, eta_p_48363);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48165)[dynamic_id_48234] = defunc_0_op_res_48364;\n                        ((volatile __global int16_t *) incprefixes_mem_48169)[dynamic_id_48234] = defunc_0_op_res_48365;\n                        ((volatile __global int16_t *) incprefixes_mem_48173)[dynamic_id_48234] = defunc_0_op_res_48366;\n                        ((volatile __global int16_t *) incprefixes_mem_48177)[dynamic_id_48234] = defunc_0_op_res_48367;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48141)[dynamic_id_48234] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48215)[(int64_t) 16] = prefix_48315;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)] = prefix_48316;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)] = prefix_48317;\n                    ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)] = prefix_48318;\n                    acc_48293 = (int16_t",
                                    ") 0;\n                    acc_48294 = (int16_t) 0;\n                    acc_48295 = (int16_t) 0;\n                    acc_48296 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48234 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48315 = ((__local int16_t *) local_mem_48215)[(int64_t) 16];\n                prefix_48316 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48211, (int64_t) 2)];\n                prefix_48317 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48212, (int64_t) 2)];\n                prefix_48318 = ((__local int16_t *) local_mem_48215)[squot64(warp_byte_offset_48213, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48368;\n            int16_t eta_p_48372;\n            int16_t eta_p_48380 = prefix_48315;\n            int16_t eta_p_48384 = acc_48293;\n            int16_t eta_p_48369;\n            int16_t eta_p_48373;\n            int16_t eta_p_48381 = prefix_48316;\n            int16_t eta_p_48385 = acc_48294;\n            int16_t eta_p_48370;\n            int16_t eta_p_48374;\n            int16_t eta_p_48382 = prefix_48317;\n            int16_t eta_p_48386 = acc_48295;\n            int16_t eta_p_48371;\n            int16_t eta_p_48375;\n            int16_t eta_p_48383 = prefix_48318;\n            int16_t eta_p_48387 = acc_48296;\n            \n            if (slt32(local_tid_48202 * chunk_sizze_32b_48206, boundary_48237) && !block_new_sgm_48319) {\n                int16_t defunc_0_op_res_48388 = add16(eta_p_48380, eta_p_48384);\n                int16_t defunc_0_op_res_48389 = add16(eta_p_48381, eta_p_48385);\n                int16_t defunc_0_op_res_48390 = add16(eta_p_48382, eta_p_48386);\n                int16_t defunc_0_op_res_48391 = add16(eta_p_48383, eta_p_48387);\n                \n                eta_p_48368 = defunc_0_op_res_48388;\n                eta_p_48369 = defunc_", "0_op_res_48389;\n                eta_p_48370 = defunc_0_op_res_48390;\n                eta_p_48371 = defunc_0_op_res_48391;\n            } else {\n                eta_p_48368 = acc_48293;\n                eta_p_48369 = acc_48294;\n                eta_p_48370 = acc_48295;\n                eta_p_48371 = acc_48296;\n            }\n            \n            int32_t stopping_point_48392 = segsizze_compact_48238 - srem32(local_tid_48202 * chunk_sizze_32b_48206 - 1 + segsizze_compact_48238 - boundary_48237, segsizze_compact_48238);\n            \n            for (int64_t i_48393 = 0; i_48393 < chunk_sizze_48138; i_48393++) {\n                if (slt32(sext_i64_i32(i_48393), stopping_point_48392 - 1)) {\n                    eta_p_48372 = private_mem_48239[i_48393];\n                    eta_p_48373 = private_mem_48241[i_48393];\n                    eta_p_48374 = private_mem_48243[i_48393];\n                    eta_p_48375 = private_mem_48245[i_48393];\n                    \n                    int16_t defunc_0_op_res_48376 = add16(eta_p_48368, eta_p_48372);\n                    int16_t defunc_0_op_res_48377 = add16(eta_p_48369, eta_p_48373);\n                    int16_t defunc_0_op_res_48378 = add16(eta_p_48370, eta_p_48374);\n                    int16_t defunc_0_op_res_48379 = add16(eta_p_48371, eta_p_48375);\n                    \n                    private_mem_48239[i_48393] = defunc_0_op_res_48376;\n                    private_mem_48241[i_48393] = defunc_0_op_res_48377;\n                    private_mem_48243[i_48393] = defunc_0_op_res_48378;\n                    private_mem_48245[i_48393] = defunc_0_op_res_48379;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48394 = 0; i_48394 < chunk_sizze_48138; i_48394++) {\n                int64_t sharedIdx_48395 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48394;\n                int16_t tmp_48396 = private_mem_48239[i_48394];\n       ", "         \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48395] = tmp_48396;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48397 = 0; i_48397 < chunk_sizze_48138; i_48397++) {\n                int64_t flat_idx_48398 = thd_offset_48247 + i_48397 * segscan_tblock_sizze_44430;\n                int64_t slice_48399 = rest_41713;\n                int64_t gtid_44434 = flat_idx_48398;\n                int64_t remnant_48400 = flat_idx_48398 - gtid_44434;\n                \n                if (slt64(flat_idx_48398, rest_41713)) {\n                    int16_t tmp_48401 = ((__local int16_t *) local_mem_48215)[flat_idx_48398 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47857)[gtid_44434] = tmp_48401;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48402 = 0; i_48402 < chunk_sizze_48138; i_48402++) {\n                int64_t sharedIdx_48403 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48402;\n                int16_t tmp_48404 = private_mem_48241[i_48402];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48403] = tmp_48404;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48405 = 0; i_48405 < chunk_sizze_48138; i_48405++) {\n                int64_t flat_idx_48406 = thd_offset_48247 + i_48405 * segscan_tblock_sizze_44430;\n                int64_t slice_48407 = rest_41713;\n                int64_t gtid_44434 = flat_idx_48406;\n                int64_t remnant_48408 = flat_idx_48406 - gtid_44434;\n                \n                if (slt64(flat_idx_48406, rest_41713)) {\n                    int16_t tmp_48409 = ((__local int16_t *) local_mem_48215)[flat_idx_48406 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47859)[gtid_44434] = tmp_48409;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int",
                                    "64_t i_48410 = 0; i_48410 < chunk_sizze_48138; i_48410++) {\n                int64_t sharedIdx_48411 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48410;\n                int16_t tmp_48412 = private_mem_48243[i_48410];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48411] = tmp_48412;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48413 = 0; i_48413 < chunk_sizze_48138; i_48413++) {\n                int64_t flat_idx_48414 = thd_offset_48247 + i_48413 * segscan_tblock_sizze_44430;\n                int64_t slice_48415 = rest_41713;\n                int64_t gtid_44434 = flat_idx_48414;\n                int64_t remnant_48416 = flat_idx_48414 - gtid_44434;\n                \n                if (slt64(flat_idx_48414, rest_41713)) {\n                    int16_t tmp_48417 = ((__local int16_t *) local_mem_48215)[flat_idx_48414 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47861)[gtid_44434] = tmp_48417;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48418 = 0; i_48418 < chunk_sizze_48138; i_48418++) {\n                int64_t sharedIdx_48419 = sext_i32_i64(local_tid_48202) * chunk_sizze_48138 + i_48418;\n                int16_t tmp_48420 = private_mem_48245[i_48418];\n                \n                ((__local int16_t *) local_mem_48215)[sharedIdx_48419] = tmp_48420;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48421 = 0; i_48421 < chunk_sizze_48138; i_48421++) {\n                int64_t flat_idx_48422 = thd_offset_48247 + i_48421 * segscan_tblock_sizze_44430;\n                int64_t slice_48423 = rest_41713;\n                int64_t gtid_44434 = flat_idx_48422;\n                int64_t remnant_48424 = flat_idx_48422 - gtid_44434;\n                \n                if (slt64(flat_idx_48422, rest_41713)) {\n                    int16_t tmp_48425 = ((__local int16_t *) local_mem_4821", "5)[flat_idx_48422 - block_offset_48235];\n                    \n                    ((__global int16_t *) mem_47863)[gtid_44434] = tmp_48425;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_44430\n    #undef chunk_sizze_48138\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegscan_44730_dim1, 1, 1)\nvoid sortColumn_shortzisegscan_44730(__global int *global_failure, int failure_is_an_option, __global int64_t *global_failure_args, int64_t i16_res_41708, int64_t n_blocks_41712, int32_t blocked_radix_sort_step_arg1_41776, int32_t get_bit_arg0_41781, unsigned char cond_41782_bits, unsigned char cond_41783_bits, int64_t num_tblocks_44721, int64_t num_virt_blocks_48530, int64_t num_virt_threads_48531, __global unsigned char *mem_47846, __global unsigned char *mem_47889, __global unsigned char *mem_47892, __global unsigned char *mem_47895, __global unsigned char *mem_47898, __global unsigned char *mem_47901, __global unsigned char *status_flags_mem_48532, __global unsigned char *aggregates_mem_48534, __global unsigned char *incprefixes_mem_48536, __global unsigned char *aggregates_mem_48538, __global unsigned char *incprefixes_mem_48540, __global unsigned char *aggregates_mem_48542, __global unsigned char *incprefixes_mem_48544, __global unsigned char *aggregates_mem_48546, __global unsigned char *incprefixes_mem_48548, __global unsigned char *global_dynid_mem_48550)\n{\n    bool cond_41782 = cond_41782_bits;\n    bool cond_41783 = cond_41783_bits;\n    \n    #define segscan_tblock_sizze_44720 (sortColumn_shortzisegscan_44730zisegscan_tblock_sizze_44720)\n    #define chunk_sizze_48529 (sortColumn_shortzisegscan_44730zichunk_sizze_48529)\n    \n    volatile __local unsigned char *local_mem_48566_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48566_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) *", " (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2)), (int64_t) 8), (int64_t) 8));\n    volatile __local int local_failure;\n    \n    // Harmless for all threads to write this.\n    local_failure = 0;\n    \n    int32_t local_tid_48553;\n    int32_t tblock_sizze_48556;\n    int32_t wave_sizze_48555;\n    int32_t block_id_48554;\n    int32_t global_tid_48552;\n    int64_t phys_tid_44730;\n    int32_t chunk_sizze_32b_48557;\n    int64_t byte_offsets_48558;\n    int64_t byte_offsets_48559;\n    int64_t byte_offsets_48560;\n    int64_t byte_offsets_48561;\n    int64_t warp_byte_offset_48562;\n    int64_t warp_byte_offset_48563;\n    int64_t warp_byte_offset_48564;\n    int64_t warp_byte_offset_48565;\n    __local unsigned char *local_mem_48566;\n    int64_t trans_arr_len_48567;\n    int64_t phys_block_id_48582;\n    int64_t virtloop_bound_48583;\n    \n    local_tid_48553 = get_local_id(0);\n    tblock_sizze_48556 = get_local_size(0);\n    wave_sizze_48555 = LOCKSTEP_WIDTH;\n    bl",
                                    "ock_id_48554 = get_tblock_id(0);\n    global_tid_48552 = block_id_48554 * tblock_sizze_48556 + local_tid_48553;\n    phys_tid_44730 = sext_i32_i64(global_tid_48552);\n    chunk_sizze_32b_48557 = sext_i64_i32(chunk_sizze_48529);\n    byte_offsets_48558 = segscan_tblock_sizze_44720 * (int64_t) 2;\n    byte_offsets_48559 = sdiv_up64(byte_offsets_48558, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44720 * (int64_t) 2;\n    byte_offsets_48560 = sdiv_up64(byte_offsets_48559, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44720 * (int64_t) 2;\n    byte_offsets_48561 = sdiv_up64(byte_offsets_48560, (int64_t) 2) * (int64_t) 2 + segscan_tblock_sizze_44720 * (int64_t) 2;\n    warp_byte_offset_48562 = (int64_t) 96;\n    warp_byte_offset_48563 = sdiv_up64(warp_byte_offset_48562, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48564 = sdiv_up64(warp_byte_offset_48563, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    warp_byte_offset_48565 = sdiv_up64(warp_byte_offset_48564, (int64_t) 2) * (int64_t) 2 + (int64_t) 64;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48566 = (__local unsigned char *) local_mem_48566_backing_0;\n    trans_arr_len_48567 = chunk_sizze_48529 * segscan_tblock_sizze_44720;\n    phys_block_id_48582 = get_tblock_id(0);\n    virtloop_bound_48583 = sdiv_up64(num_virt_blocks_48530 - phys_block_id_48582, num_tblocks_44721);\n    for (int64_t virtloop_i_48584 = 0; virtloop_i_48584 < virtloop_bound_48583; virtloop_i_48584++) {\n        int64_t dynamic_id_48585;\n        int64_t block_offset_48586;\n        int64_t sgm_idx_48587;\n        int32_t boundary_48588;\n        int32_t segsizze_compact_48589;\n        int16_t private_mem_48590[chunk_sizze_48529];\n        int16_t private_mem_48592[chunk_sizze_48529];\n        int16_t private_mem_48594[chunk_sizze_48529];\n        int16_t private_mem_48596[chunk_sizze_48529];\n        int64_t thd_offset_48598;\n        int16_t acc_48648;\n        int16_t acc_48649;\n        int16_t acc_48650;\n        int16_t acc_4", "8651;\n        int16_t prefix_48673;\n        int16_t prefix_48674;\n        int16_t prefix_48675;\n        int16_t prefix_48676;\n        bool block_new_sgm_48677;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48553 == 0) {\n                dynamic_id_48585 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48550)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48566)[(int64_t) 0] = dynamic_id_48585;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48585 == num_virt_blocks_48530 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48550)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48585 = ((__local int32_t *) local_mem_48566)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48586 = dynamic_id_48585 * chunk_sizze_48529 * segscan_tblock_sizze_44720;\n        sgm_idx_48587 = smod64(block_offset_48586, i16_res_41708);\n        boundary_48588 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_44720, i16_res_41708 - sgm_idx_48587));\n        segsizze_compact_48589 = sext_i64_i32(smin64(chunk_sizze_48529 * segscan_tblock_sizze_44720, i16_res_41708));\n        thd_offset_48598 = block_offset_48586 + sext_i32_i64(local_tid_48553);\n        // Load and map\n        {\n            for (int64_t i_48599 = 0; i_48599 < chunk_sizze_48529; i_48599++) {\n                int64_t virt_tid_48600 = thd_offset_48598 + i_48599 * segscan_tblock_sizze_44720;\n                int64_t slice_48601 = i16_res_41708;\n                int64_t slice_48602 = n_blocks_41712 * slice_48601;\n                int64_t gtid_44728 = squot64(virt_tid_48600, slice_48601);\n                int64_t ", "remnant_48603 = virt_tid_48600 - gtid_44728 * slice_48601;\n                int64_t gtid_44729 = remnant_48603;\n                int64_t remnant_48604 = remnant_48603 - gtid_44729;\n                \n                if (slt64(virt_tid_48600, n_blocks_41712 * i16_res_41708)) {\n                    int64_t binop_x_46982 = i16_res_41708 * gtid_44728;\n                    int64_t new_index_46983 = gtid_44729 + binop_x_46982;\n                    int16_t eta_p_44744 = ((__global int16_t *) mem_47846)[new_index_46983];\n                    int32_t defunc_0_get_bit_res_44745;\n                    \n                    futrts_get_bit_1844(&defunc_0_get_bit_res_44745, get_bit_arg0_41781, eta_p_44744);\n                    \n                    int32_t defunc_0_get_bit_res_44746;\n                    \n                    if (cond_41782) {\n                        int32_t defunc_0_get_bit_res_t_res_44747 = 1 ^ defunc_0_get_bit_res_44745;\n                        \n                        defunc_0_get_bit_res_44746 = defunc_0_get_bit_res_t_res_44747;\n                    } else {\n                        defunc_0_get_bit_res_44746 = defunc_0_get_bit_res_44745;\n                    }\n                    \n                    int32_t zp_lhs_44748 = mul32(2, defunc_0_get_bit_res_44746);\n                    int32_t defunc_0_get_bit_res_44749;\n                    \n                    futrts_get_bit_1844(&defunc_0_get_bit_res_44749, blocked_radix_sort_step_arg1_41776, eta_p_44744);\n                    \n                    int32_t defunc_0_get_bit_res_44750;\n                    \n                    if (cond_41783) {\n                        int32_t defunc_0_get_bit_res_t_res_44751 = 1 ^ defunc_0_get_bit_res_44749;\n                        \n                        defunc_0_get_bit_res_44750 = defunc_0_get_bit_res_t_res_44751;\n                    } else {\n                        defunc_0_get_bit_res_44750 = defunc_0_get_bit_res_44749;\n                    }\n                    \n                    int32_t i32",
                                    "_arg0_44752 = add32(zp_lhs_44748, defunc_0_get_bit_res_44750);\n                    int16_t i32_res_44753 = sext_i32_i16(i32_arg0_44752);\n                    int16_t defunc_0_f_res_44754;\n                    int16_t defunc_0_f_res_44755;\n                    int16_t defunc_0_f_res_44756;\n                    int16_t defunc_0_f_res_44757;\n                    \n                    futrts_lifted_lambda_7535(&defunc_0_f_res_44754, &defunc_0_f_res_44755, &defunc_0_f_res_44756, &defunc_0_f_res_44757, i32_res_44753);\n                    ((__global int16_t *) mem_47901)[gtid_44728 * i16_res_41708 + gtid_44729] = i32_res_44753;\n                    private_mem_48590[i_48599] = defunc_0_f_res_44754;\n                    private_mem_48592[i_48599] = defunc_0_f_res_44755;\n                    private_mem_48594[i_48599] = defunc_0_f_res_44756;\n                    private_mem_48596[i_48599] = defunc_0_f_res_44757;\n                } else {\n                    private_mem_48590[i_48599] = (int16_t) 0;\n                    private_mem_48592[i_48599] = (int16_t) 0;\n                    private_mem_48594[i_48599] = (int16_t) 0;\n                    private_mem_48596[i_48599] = (int16_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48605 = 0; i_48605 < chunk_sizze_48529; i_48605++) {\n                int64_t sharedIdx_48606 = sext_i32_i64(local_tid_48553) + i_48605 * segscan_tblock_sizze_44720;\n                int16_t tmp_48607 = private_mem_48590[i_48605];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48606] = tmp_48607;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48608 = 0; i_48608 < chunk_sizze_48529; i_48608++) {\n                int64_t sharedIdx_48609 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48608;\n                int16_t tmp_48610 = ((__local int16_t *) local_mem_48566)[sharedIdx_48609];\n         ", "       \n                private_mem_48590[i_48608] = tmp_48610;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48611 = 0; i_48611 < chunk_sizze_48529; i_48611++) {\n                int64_t sharedIdx_48612 = sext_i32_i64(local_tid_48553) + i_48611 * segscan_tblock_sizze_44720;\n                int16_t tmp_48613 = private_mem_48592[i_48611];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48612] = tmp_48613;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48614 = 0; i_48614 < chunk_sizze_48529; i_48614++) {\n                int64_t sharedIdx_48615 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48614;\n                int16_t tmp_48616 = ((__local int16_t *) local_mem_48566)[sharedIdx_48615];\n                \n                private_mem_48592[i_48614] = tmp_48616;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48617 = 0; i_48617 < chunk_sizze_48529; i_48617++) {\n                int64_t sharedIdx_48618 = sext_i32_i64(local_tid_48553) + i_48617 * segscan_tblock_sizze_44720;\n                int16_t tmp_48619 = private_mem_48594[i_48617];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48618] = tmp_48619;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48620 = 0; i_48620 < chunk_sizze_48529; i_48620++) {\n                int64_t sharedIdx_48621 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48620;\n                int16_t tmp_48622 = ((__local int16_t *) local_mem_48566)[sharedIdx_48621];\n                \n                private_mem_48594[i_48620] = tmp_48622;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48623 = 0; i_48623 < chunk_sizze_48529; i_48623++) {\n                int64_t sharedIdx_48624 = sext_i32_i64(local_tid_48553) + i_48623 * segscan_tblock_sizze_44720;\n                int16_t tmp_48625 = private_mem_48596[", "i_48623];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48624] = tmp_48625;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48626 = 0; i_48626 < chunk_sizze_48529; i_48626++) {\n                int64_t sharedIdx_48627 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48626;\n                int16_t tmp_48628 = ((__local int16_t *) local_mem_48566)[sharedIdx_48627];\n                \n                private_mem_48596[i_48626] = tmp_48628;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48629 = 0; i_48629 < chunk_sizze_48529 - (int64_t) 1; i_48629++) {\n                int32_t gidx_48630 = local_tid_48553 * chunk_sizze_32b_48557 + 1;\n                bool new_sgm_48631 = smod32(gidx_48630 + sext_i64_i32(i_48629) - boundary_48588, segsizze_compact_48589) == 0;\n                \n                if (!new_sgm_48631) {\n                    int16_t eta_p_44731;\n                    int16_t eta_p_44735;\n                    \n                    eta_p_44731 = private_mem_48590[i_48629];\n                    eta_p_44735 = private_mem_48590[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_44732;\n                    int16_t eta_p_44736;\n                    \n                    eta_p_44732 = private_mem_48592[i_48629];\n                    eta_p_44736 = private_mem_48592[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_44733;\n                    int16_t eta_p_44737;\n                    \n                    eta_p_44733 = private_mem_48594[i_48629];\n                    eta_p_44737 = private_mem_48594[i_48629 + (int64_t) 1];\n                    \n                    int16_t eta_p_44734;\n                    int16_t eta_p_44738;\n                    \n                    eta_p_44734 = private_mem_48596[i_48629];\n                    eta_p_44738 = private_mem_48596[i_48629 + (int64_t) 1",
                                    "];\n                    \n                    int16_t defunc_0_op_res_44739 = add16(eta_p_44731, eta_p_44735);\n                    int16_t defunc_0_op_res_44740 = add16(eta_p_44732, eta_p_44736);\n                    int16_t defunc_0_op_res_44741 = add16(eta_p_44733, eta_p_44737);\n                    int16_t defunc_0_op_res_44742 = add16(eta_p_44734, eta_p_44738);\n                    \n                    private_mem_48590[i_48629 + (int64_t) 1] = defunc_0_op_res_44739;\n                    private_mem_48592[i_48629 + (int64_t) 1] = defunc_0_op_res_44740;\n                    private_mem_48594[i_48629 + (int64_t) 1] = defunc_0_op_res_44741;\n                    private_mem_48596[i_48629 + (int64_t) 1] = defunc_0_op_res_44742;\n                }\n            }\n        }\n        // Publish results in shared memory\n        {\n            int16_t tmp_48632 = private_mem_48590[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = tmp_48632;\n            \n            int16_t tmp_48633 = private_mem_48592[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48633;\n            \n            int16_t tmp_48634 = private_mem_48594[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48634;\n            \n            int16_t tmp_48635 = private_mem_48596[chunk_sizze_48529 - (int64_t) 1];\n            \n            ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = tmp_48635;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int16_t eta_p_48636;\n            int16_t eta_p_48637;\n            int16_t eta_p_48638;\n            int16_t eta_p_48639;\n        ", "    int16_t eta_p_48640;\n            int16_t eta_p_48641;\n            int16_t eta_p_48642;\n            int16_t eta_p_48643;\n            int16_t eta_p_48652;\n            int16_t eta_p_48653;\n            int16_t eta_p_48654;\n            int16_t eta_p_48655;\n            int16_t eta_p_48656;\n            int16_t eta_p_48657;\n            int16_t eta_p_48658;\n            int16_t eta_p_48659;\n            bool ltid_in_bounds_48664 = slt64(sext_i32_i64(local_tid_48553), num_virt_threads_48531);\n            int32_t skip_threads_48665;\n            \n            // read input for in-block scan\n            {\n                if (ltid_in_bounds_48664) {\n                    eta_p_48640 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                    eta_p_48641 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48642 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    eta_p_48643 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                    if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                        eta_p_48636 = eta_p_48640;\n                        eta_p_48637 = eta_p_48641;\n                        eta_p_48638 = eta_p_48642;\n                        eta_p_48639 = eta_p_48643;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48665 = 1;\n                while (slt32(skip_threads_48665, 32)) {\n                    bool thread_active_48666 = sle32(skip_threads_48665, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && ltid_in_bounds_48664;\n                    \n                    if (thread_active_48666) {\n                        // read operands\n", "                        {\n                            eta_p_48636 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665)];\n                            eta_p_48637 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48638 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                            eta_p_48639 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48665))];\n                        }\n                    }\n                    // perform operation\n                    {\n                        bool inactive_48667 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((local_tid_48553 - skip_threads_48665 + 1) * chunk_sizze_32b_48557 - 1));\n                        \n                        if (thread_active_48666 && inactive_48667) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                        if (thread_active_48666) {\n                            if (!inactive_48667) {\n                                int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                                int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                                int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                                int16_t defunc_0_op_res_48647 = add",
                                    "16(eta_p_48639, eta_p_48643);\n                                \n                                eta_p_48636 = defunc_0_op_res_48644;\n                                eta_p_48637 = defunc_0_op_res_48645;\n                                eta_p_48638 = defunc_0_op_res_48646;\n                                eta_p_48639 = defunc_0_op_res_48647;\n                            }\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48666) {\n                        // write result\n                        {\n                            ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                            eta_p_48640 = eta_p_48636;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                            eta_p_48641 = eta_p_48637;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                            eta_p_48642 = eta_p_48638;\n                            ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48639;\n                            eta_p_48643 = eta_p_48639;\n                        }\n                    }\n                    if (sle32(wave_sizze_48555, skip_threads_48665)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_48665 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 31 && ltid_in", "_bounds_48664) {\n                    ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48636;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48637;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48638;\n                    ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(squot32(local_tid_48553, 32))] = eta_p_48639;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48668;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                        eta_p_48656 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                        eta_p_48657 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48658 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        eta_p_48659 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                        if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                            eta_p_48652 = eta_p_48656;\n                            eta_p_48653 = eta_p_48657;\n                            eta_p_48654 = eta_p_48658;\n                            eta_p_48655 = eta_p_48659;\n                        }\n                    }\n ", "               }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48668 = 1;\n                    while (slt32(skip_threads_48668, 32)) {\n                        bool thread_active_48669 = sle32(skip_threads_48668, local_tid_48553 - squot32(local_tid_48553, 32) * 32) && (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664);\n                        \n                        if (thread_active_48669) {\n                            // read operands\n                            {\n                                eta_p_48652 = ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668)];\n                                eta_p_48653 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48654 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                                eta_p_48655 = ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48668))];\n                            }\n                        }\n                        // perform operation\n                        {\n                            bool inactive_48670 = slt32(smod32((local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1 - (((local_tid_48553 - skip_threads_48668) * 32 + 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                            \n                            if (thread_active_48669 && inactive_48670) {\n                                eta_p_48652 = eta_p_48656;\n                                eta_p",
                                    "_48653 = eta_p_48657;\n                                eta_p_48654 = eta_p_48658;\n                                eta_p_48655 = eta_p_48659;\n                            }\n                            if (thread_active_48669) {\n                                if (!inactive_48670) {\n                                    int16_t defunc_0_op_res_48660 = add16(eta_p_48652, eta_p_48656);\n                                    int16_t defunc_0_op_res_48661 = add16(eta_p_48653, eta_p_48657);\n                                    int16_t defunc_0_op_res_48662 = add16(eta_p_48654, eta_p_48658);\n                                    int16_t defunc_0_op_res_48663 = add16(eta_p_48655, eta_p_48659);\n                                    \n                                    eta_p_48652 = defunc_0_op_res_48660;\n                                    eta_p_48653 = defunc_0_op_res_48661;\n                                    eta_p_48654 = defunc_0_op_res_48662;\n                                    eta_p_48655 = defunc_0_op_res_48663;\n                                }\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48669) {\n                            // write result\n                            {\n                                ((volatile __local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48652;\n                                eta_p_48656 = eta_p_48652;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48653;\n                                eta_p_48657 = eta_p_48653;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48654;\n                                et", "a_p_48658 = eta_p_48654;\n                                ((volatile __local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48655;\n                                eta_p_48659 = eta_p_48655;\n                            }\n                        }\n                        if (sle32(wave_sizze_48555, skip_threads_48668)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48668 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48671 = squot32(local_tid_48553, 32) == 0 || !ltid_in_bounds_48664;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48671) {\n                        eta_p_48640 = eta_p_48636;\n                        eta_p_48641 = eta_p_48637;\n                        eta_p_48642 = eta_p_48638;\n                        eta_p_48643 = eta_p_48639;\n                        eta_p_48636 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1];\n                        eta_p_48637 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48638 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                        eta_p_48639 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(squot32(local_tid_48553, 32)) - (int64_t) 1)];\n                    }\n                }\n                // perform operation\n                {\n                    bool inactive_48672 = slt32(smod32((local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 + segsizze_compact", "_48589 - boundary_48588, segsizze_compact_48589), (local_tid_48553 + 1) * chunk_sizze_32b_48557 - 1 - ((squot32(local_tid_48553, 32) * 32 - 1 + 1) * chunk_sizze_32b_48557 - 1));\n                    \n                    if (!no_carry_in_48671) {\n                        if (inactive_48672) {\n                            eta_p_48636 = eta_p_48640;\n                            eta_p_48637 = eta_p_48641;\n                            eta_p_48638 = eta_p_48642;\n                            eta_p_48639 = eta_p_48643;\n                        }\n                    }\n                    if (!no_carry_in_48671) {\n                        if (!inactive_48672) {\n                            int16_t defunc_0_op_res_48644 = add16(eta_p_48636, eta_p_48640);\n                            int16_t defunc_0_op_res_48645 = add16(eta_p_48637, eta_p_48641);\n                            int16_t defunc_0_op_res_48646 = add16(eta_p_48638, eta_p_48642);\n                            int16_t defunc_0_op_res_48647 = add16(eta_p_48639, eta_p_48643);\n                            \n                            eta_p_48636 = defunc_0_op_res_48644;\n                            eta_p_48637 = defunc_0_op_res_48645;\n                            eta_p_48638 = defunc_0_op_res_48646;\n                            eta_p_48639 = defunc_0_op_res_48647;\n                        }\n                    }\n                }\n                // write final result\n                {\n                    if (!no_carry_in_48671) {\n                        ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48636;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48637;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48638;\n                        ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext",
                                    "_i32_i64(local_tid_48553)] = eta_p_48639;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48553, 32) == 0 && ltid_in_bounds_48664) {\n                    ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = eta_p_48640;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48641;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48642;\n                    ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48643;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48553 == 0) {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[segscan_tblock_sizze_44720 - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (segscan_tblock_sizze_44720 - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (segscan_tblock_sizze_44720 - (int64_t) 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (segscan_tblock_sizze_44720 - (int64_t) 1)];\n            } else {\n                acc_48648 = ((__local int16_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - (int64_t) 1];\n                acc_48649 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48558, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n                acc_48650 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48559, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t)", " 1)];\n                acc_48651 = ((__local int16_t *) local_mem_48566)[squot64(byte_offsets_48560, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - (int64_t) 1)];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48673 = (int16_t) 0;\n        prefix_48674 = (int16_t) 0;\n        prefix_48675 = (int16_t) 0;\n        prefix_48676 = (int16_t) 0;\n        block_new_sgm_48677 = sgm_idx_48587 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48677 && local_tid_48553 == 0) {\n                ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                acc_48648 = (int16_t) 0;\n                acc_48649 = (int16_t) 0;\n                acc_48650 = (int16_t) 0;\n                acc_48651 = (int16_t) 0;\n            }\n            if (!block_new_sgm_48677 && slt32(local_tid_48553, wave_sizze_48555)) {\n                if (local_tid_48553 == 0) {\n                    if (boundary_48588 == sext_i64_i32(segscan_tblock_sizze_44720 * chunk_sizze_48529)) {\n                        ((volatile __global int16_t *) aggregates_mem_48534)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) aggregates_mem_48538)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) aggregates_mem_48542)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) aggregates_mem_48546)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile _", "_global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 1;\n                    } else {\n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = acc_48648;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = acc_48649;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = acc_48650;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = acc_48651;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    \n                    int8_t tmp_48678 = ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585 - (int64_t) 1];\n                    \n                    ((volatile __local int8_t *) local_mem_48566)[(int64_t) 0] = tmp_48678;\n                }\n                mem_fence_local();\n                \n                int8_t status_48679 = ((__local int8_t *) local_mem_48566)[(int64_t) 0];\n                \n                if (status_48679 == (int8_t) 2) {\n                    if (local_tid_48553 == 0) {\n                        prefix_48673 = ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48674 = ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48675 = ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585 - (int64_t) 1];\n                        prefix_48676 = ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48680 = sext_i64_i32(dynamic_id_48585 - sext_i32_i64(wave_sizze_48555));\n                    \n                    while (slt32(wave_sizze_48555 * -1, readOffset_",
                                    "48680)) {\n                        int32_t read_i_48681 = readOffset_48680 + local_tid_48553;\n                        int16_t aggr_48682 = (int16_t) 0;\n                        int16_t aggr_48683 = (int16_t) 0;\n                        int16_t aggr_48684 = (int16_t) 0;\n                        int16_t aggr_48685 = (int16_t) 0;\n                        int8_t flag_48686 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48681)) {\n                            if (sle64(block_offset_48586 - (sext_i32_i64(read_i_48681 + 1) * segscan_tblock_sizze_44720 * chunk_sizze_48529 - (int64_t) 1), sgm_idx_48587)) {\n                                flag_48686 = ((volatile __global int8_t *) status_flags_mem_48532)[sext_i32_i64(read_i_48681)];\n                                if (flag_48686 == (int8_t) 2) {\n                                    aggr_48682 = ((volatile __global int16_t *) incprefixes_mem_48536)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) incprefixes_mem_48540)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) incprefixes_mem_48544)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) incprefixes_mem_48548)[sext_i32_i64(read_i_48681)];\n                                } else if (flag_48686 == (int8_t) 1) {\n                                    aggr_48682 = ((volatile __global int16_t *) aggregates_mem_48534)[sext_i32_i64(read_i_48681)];\n                                    aggr_48683 = ((volatile __global int16_t *) aggregates_mem_48538)[sext_i32_i64(read_i_48681)];\n                                    aggr_48684 = ((volatile __global int16_t *) aggregates_mem_48542)[sext_i32_i64(read_i_48681)];\n                                    aggr_48685 = ((volatile __global int16_t *) aggregates_mem_48546)[sext_i32_i64(read_i_48681)];\n                                }\n                 ", "           } else {\n                                flag_48686 = (int8_t) 2;\n                            }\n                        }\n                        ((__local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = aggr_48682;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48683;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48684;\n                        ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = aggr_48685;\n                        ((__local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flag_48686;\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        if (slt8(flag_48686, (int8_t) 2)) {\n                            int8_t flg_x_48699;\n                            int8_t flg_y_48700;\n                            int16_t eta_p_48687;\n                            int16_t eta_p_48688;\n                            int16_t eta_p_48689;\n                            int16_t eta_p_48690;\n                            int16_t eta_p_48691;\n                            int16_t eta_p_48692;\n                            int16_t eta_p_48693;\n                            int16_t eta_p_48694;\n                            int32_t skip_threads_48701;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48700 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)];\n                                eta_p_48691 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)];\n                                eta_p_48692 = ((volatile __local int1", "6_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48693 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                eta_p_48694 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)];\n                                if ((local_tid_48553 - squot32(local_tid_48553, 32) * 32) == 0) {\n                                    eta_p_48687 = eta_p_48691;\n                                    eta_p_48688 = eta_p_48692;\n                                    eta_p_48689 = eta_p_48693;\n                                    eta_p_48690 = eta_p_48694;\n                                    flg_x_48699 = flg_y_48700;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48701 = 1;\n                                while (slt32(skip_threads_48701, 32)) {\n                                    if (sle32(skip_threads_48701, local_tid_48553 - squot32(local_tid_48553, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48699 = ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701)];\n                                            eta_p_48687 = ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48688 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        ",
                                    "    eta_p_48689 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                            eta_p_48690 = ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(local_tid_48553) - sext_i32_i64(skip_threads_48701))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48700 == (int8_t) 2 || flg_y_48700 == (int8_t) 0) {\n                                                flg_x_48699 = flg_y_48700;\n                                                eta_p_48687 = eta_p_48691;\n                                                eta_p_48688 = eta_p_48692;\n                                                eta_p_48689 = eta_p_48693;\n                                                eta_p_48690 = eta_p_48694;\n                                            } else {\n                                                int16_t defunc_0_op_res_48695 = add16(eta_p_48687, eta_p_48691);\n                                                int16_t defunc_0_op_res_48696 = add16(eta_p_48688, eta_p_48692);\n                                                int16_t defunc_0_op_res_48697 = add16(eta_p_48689, eta_p_48693);\n                                                int16_t defunc_0_op_res_48698 = add16(eta_p_48690, eta_p_48694);\n                                                \n                                                eta_p_48687 = defunc_0_op_res_48695;\n                                                eta_p_48688 = defunc_0_op_res_48696;\n                                                eta_p_48689 = defunc_0_op_res_48697;\n                                                eta_p_48690 = defunc_0_op_res_48698;\n                                            }\n                                ", "        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48566)[sext_i32_i64(local_tid_48553)] = flg_x_48699;\n                                            flg_y_48700 = flg_x_48699;\n                                            ((volatile __local int16_t *) local_mem_48566)[(int64_t) 16 + sext_i32_i64(local_tid_48553)] = eta_p_48687;\n                                            eta_p_48691 = eta_p_48687;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48688;\n                                            eta_p_48692 = eta_p_48688;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48689;\n                                            eta_p_48693 = eta_p_48689;\n                                            ((volatile __local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + sext_i32_i64(local_tid_48553)] = eta_p_48690;\n                                            eta_p_48694 = eta_p_48690;\n                                        }\n                                    }\n                                    skip_threads_48701 *= 2;\n                                }\n                            }\n                        }\n                        flag_48686 = ((__local int8_t *) local_mem_48566)[sext_i32_i64(wave_sizze_48555) - (int64_t) 1];\n                        aggr_48682 = ((__local int16_t *) local_mem_48566)[(int64_t) 16 + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48683 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48684 ", "= ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        aggr_48685 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2) + (sext_i32_i64(wave_sizze_48555) - (int64_t) 1)];\n                        if (flag_48686 == (int8_t) 2) {\n                            readOffset_48680 = wave_sizze_48555 * -1;\n                        } else if (flag_48686 == (int8_t) 1) {\n                            readOffset_48680 -= wave_sizze_48555;\n                        }\n                        if (slt8((int8_t) 0, flag_48686)) {\n                            int16_t eta_p_48702 = aggr_48682;\n                            int16_t eta_p_48703 = aggr_48683;\n                            int16_t eta_p_48704 = aggr_48684;\n                            int16_t eta_p_48705 = aggr_48685;\n                            int16_t eta_p_48706 = prefix_48673;\n                            int16_t eta_p_48707 = prefix_48674;\n                            int16_t eta_p_48708 = prefix_48675;\n                            int16_t eta_p_48709 = prefix_48676;\n                            int16_t defunc_0_op_res_48710 = add16(eta_p_48702, eta_p_48706);\n                            int16_t defunc_0_op_res_48711 = add16(eta_p_48703, eta_p_48707);\n                            int16_t defunc_0_op_res_48712 = add16(eta_p_48704, eta_p_48708);\n                            int16_t defunc_0_op_res_48713 = add16(eta_p_48705, eta_p_48709);\n                            \n                            prefix_48673 = defunc_0_op_res_48710;\n                            prefix_48674 = defunc_0_op_res_48711;\n                            prefix_48675 = defunc_0_op_res_48712;\n                            prefix_48676 = defunc_0_op_res_48713;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48553 == 0) {\n                    if (bounda",
                                    "ry_48588 == sext_i64_i32(segscan_tblock_sizze_44720 * chunk_sizze_48529)) {\n                        int16_t eta_p_48714 = prefix_48673;\n                        int16_t eta_p_48715 = prefix_48674;\n                        int16_t eta_p_48716 = prefix_48675;\n                        int16_t eta_p_48717 = prefix_48676;\n                        int16_t eta_p_48718 = acc_48648;\n                        int16_t eta_p_48719 = acc_48649;\n                        int16_t eta_p_48720 = acc_48650;\n                        int16_t eta_p_48721 = acc_48651;\n                        int16_t defunc_0_op_res_48722 = add16(eta_p_48714, eta_p_48718);\n                        int16_t defunc_0_op_res_48723 = add16(eta_p_48715, eta_p_48719);\n                        int16_t defunc_0_op_res_48724 = add16(eta_p_48716, eta_p_48720);\n                        int16_t defunc_0_op_res_48725 = add16(eta_p_48717, eta_p_48721);\n                        \n                        ((volatile __global int16_t *) incprefixes_mem_48536)[dynamic_id_48585] = defunc_0_op_res_48722;\n                        ((volatile __global int16_t *) incprefixes_mem_48540)[dynamic_id_48585] = defunc_0_op_res_48723;\n                        ((volatile __global int16_t *) incprefixes_mem_48544)[dynamic_id_48585] = defunc_0_op_res_48724;\n                        ((volatile __global int16_t *) incprefixes_mem_48548)[dynamic_id_48585] = defunc_0_op_res_48725;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48532)[dynamic_id_48585] = (int8_t) 2;\n                    }\n                    ((__local int16_t *) local_mem_48566)[(int64_t) 16] = prefix_48673;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)] = prefix_48674;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)] = prefix_48675;\n                    ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_4856", "4, (int64_t) 2)] = prefix_48676;\n                    acc_48648 = (int16_t) 0;\n                    acc_48649 = (int16_t) 0;\n                    acc_48650 = (int16_t) 0;\n                    acc_48651 = (int16_t) 0;\n                }\n            }\n            if (!(dynamic_id_48585 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48673 = ((__local int16_t *) local_mem_48566)[(int64_t) 16];\n                prefix_48674 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48562, (int64_t) 2)];\n                prefix_48675 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48563, (int64_t) 2)];\n                prefix_48676 = ((__local int16_t *) local_mem_48566)[squot64(warp_byte_offset_48564, (int64_t) 2)];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int16_t eta_p_48726;\n            int16_t eta_p_48730;\n            int16_t eta_p_48738 = prefix_48673;\n            int16_t eta_p_48742 = acc_48648;\n            int16_t eta_p_48727;\n            int16_t eta_p_48731;\n            int16_t eta_p_48739 = prefix_48674;\n            int16_t eta_p_48743 = acc_48649;\n            int16_t eta_p_48728;\n            int16_t eta_p_48732;\n            int16_t eta_p_48740 = prefix_48675;\n            int16_t eta_p_48744 = acc_48650;\n            int16_t eta_p_48729;\n            int16_t eta_p_48733;\n            int16_t eta_p_48741 = prefix_48676;\n            int16_t eta_p_48745 = acc_48651;\n            \n            if (slt32(local_tid_48553 * chunk_sizze_32b_48557, boundary_48588) && !block_new_sgm_48677) {\n                int16_t defunc_0_op_res_48746 = add16(eta_p_48738, eta_p_48742);\n                int16_t defunc_0_op_res_48747 = add16(eta_p_48739, eta_p_48743);\n                int16_t defunc_0_op_res_48748 = add16(eta_p_48740, eta_p_48744);\n                int16_t defunc_0_op_res_48749 = add16(eta_p_48741, eta_p_48745);\n                \n                e", "ta_p_48726 = defunc_0_op_res_48746;\n                eta_p_48727 = defunc_0_op_res_48747;\n                eta_p_48728 = defunc_0_op_res_48748;\n                eta_p_48729 = defunc_0_op_res_48749;\n            } else {\n                eta_p_48726 = acc_48648;\n                eta_p_48727 = acc_48649;\n                eta_p_48728 = acc_48650;\n                eta_p_48729 = acc_48651;\n            }\n            \n            int32_t stopping_point_48750 = segsizze_compact_48589 - srem32(local_tid_48553 * chunk_sizze_32b_48557 - 1 + segsizze_compact_48589 - boundary_48588, segsizze_compact_48589);\n            \n            for (int64_t i_48751 = 0; i_48751 < chunk_sizze_48529; i_48751++) {\n                if (slt32(sext_i64_i32(i_48751), stopping_point_48750 - 1)) {\n                    eta_p_48730 = private_mem_48590[i_48751];\n                    eta_p_48731 = private_mem_48592[i_48751];\n                    eta_p_48732 = private_mem_48594[i_48751];\n                    eta_p_48733 = private_mem_48596[i_48751];\n                    \n                    int16_t defunc_0_op_res_48734 = add16(eta_p_48726, eta_p_48730);\n                    int16_t defunc_0_op_res_48735 = add16(eta_p_48727, eta_p_48731);\n                    int16_t defunc_0_op_res_48736 = add16(eta_p_48728, eta_p_48732);\n                    int16_t defunc_0_op_res_48737 = add16(eta_p_48729, eta_p_48733);\n                    \n                    private_mem_48590[i_48751] = defunc_0_op_res_48734;\n                    private_mem_48592[i_48751] = defunc_0_op_res_48735;\n                    private_mem_48594[i_48751] = defunc_0_op_res_48736;\n                    private_mem_48596[i_48751] = defunc_0_op_res_48737;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48752 = 0; i_48752 < chunk_sizze_48529; i_48752++) {\n                int64_t sharedIdx_48753 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48752",
                                    ";\n                int16_t tmp_48754 = private_mem_48590[i_48752];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48753] = tmp_48754;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48755 = 0; i_48755 < chunk_sizze_48529; i_48755++) {\n                int64_t flat_idx_48756 = thd_offset_48598 + i_48755 * segscan_tblock_sizze_44720;\n                int64_t slice_48757 = i16_res_41708;\n                int64_t slice_48758 = n_blocks_41712 * slice_48757;\n                int64_t gtid_44728 = squot64(flat_idx_48756, slice_48757);\n                int64_t remnant_48759 = flat_idx_48756 - gtid_44728 * slice_48757;\n                int64_t gtid_44729 = remnant_48759;\n                int64_t remnant_48760 = remnant_48759 - gtid_44729;\n                \n                if (slt64(flat_idx_48756, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48761 = ((__local int16_t *) local_mem_48566)[flat_idx_48756 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47889)[gtid_44728 * i16_res_41708 + gtid_44729] = tmp_48761;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48762 = 0; i_48762 < chunk_sizze_48529; i_48762++) {\n                int64_t sharedIdx_48763 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48762;\n                int16_t tmp_48764 = private_mem_48592[i_48762];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48763] = tmp_48764;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48765 = 0; i_48765 < chunk_sizze_48529; i_48765++) {\n                int64_t flat_idx_48766 = thd_offset_48598 + i_48765 * segscan_tblock_sizze_44720;\n                int64_t slice_48767 = i16_res_41708;\n                int64_t slice_48768 = n_blocks_41712 * slice_48767;\n                int64_t gtid_44728 = squot64(flat_idx_48766, slice_48767);\n          ", "      int64_t remnant_48769 = flat_idx_48766 - gtid_44728 * slice_48767;\n                int64_t gtid_44729 = remnant_48769;\n                int64_t remnant_48770 = remnant_48769 - gtid_44729;\n                \n                if (slt64(flat_idx_48766, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48771 = ((__local int16_t *) local_mem_48566)[flat_idx_48766 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47892)[gtid_44728 * i16_res_41708 + gtid_44729] = tmp_48771;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48772 = 0; i_48772 < chunk_sizze_48529; i_48772++) {\n                int64_t sharedIdx_48773 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48772;\n                int16_t tmp_48774 = private_mem_48594[i_48772];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48773] = tmp_48774;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48775 = 0; i_48775 < chunk_sizze_48529; i_48775++) {\n                int64_t flat_idx_48776 = thd_offset_48598 + i_48775 * segscan_tblock_sizze_44720;\n                int64_t slice_48777 = i16_res_41708;\n                int64_t slice_48778 = n_blocks_41712 * slice_48777;\n                int64_t gtid_44728 = squot64(flat_idx_48776, slice_48777);\n                int64_t remnant_48779 = flat_idx_48776 - gtid_44728 * slice_48777;\n                int64_t gtid_44729 = remnant_48779;\n                int64_t remnant_48780 = remnant_48779 - gtid_44729;\n                \n                if (slt64(flat_idx_48776, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48781 = ((__local int16_t *) local_mem_48566)[flat_idx_48776 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47895)[gtid_44728 * i16_res_41708 + gtid_44729] = tmp_48781;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n  ", "          for (int64_t i_48782 = 0; i_48782 < chunk_sizze_48529; i_48782++) {\n                int64_t sharedIdx_48783 = sext_i32_i64(local_tid_48553) * chunk_sizze_48529 + i_48782;\n                int16_t tmp_48784 = private_mem_48596[i_48782];\n                \n                ((__local int16_t *) local_mem_48566)[sharedIdx_48783] = tmp_48784;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48785 = 0; i_48785 < chunk_sizze_48529; i_48785++) {\n                int64_t flat_idx_48786 = thd_offset_48598 + i_48785 * segscan_tblock_sizze_44720;\n                int64_t slice_48787 = i16_res_41708;\n                int64_t slice_48788 = n_blocks_41712 * slice_48787;\n                int64_t gtid_44728 = squot64(flat_idx_48786, slice_48787);\n                int64_t remnant_48789 = flat_idx_48786 - gtid_44728 * slice_48787;\n                int64_t gtid_44729 = remnant_48789;\n                int64_t remnant_48790 = remnant_48789 - gtid_44729;\n                \n                if (slt64(flat_idx_48786, n_blocks_41712 * i16_res_41708)) {\n                    int16_t tmp_48791 = ((__local int16_t *) local_mem_48566)[flat_idx_48786 - block_offset_48586];\n                    \n                    ((__global int16_t *) mem_47898)[gtid_44728 * i16_res_41708 + gtid_44729] = tmp_48791;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_44720\n    #undef chunk_sizze_48529\n}\nFUTHARK_KERNEL_SIZED(sortColumn_shortzisegscan_44851_dim1, 1, 1)\nvoid sortColumn_shortzisegscan_44851(__global int *global_failure, int64_t n_blocks_41712, int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, int64_t num_tblocks_44848, int64_t num_virt_blocks_48874, int64_t num_virt_threads_48875, __global unsigned char *ext_mem_47981, __global unsigned char *mem_47989, __global unsigned char *mem_47992, __global unsigned char *status_f",
                                    "lags_mem_48876, __global unsigned char *aggregates_mem_48878, __global unsigned char *incprefixes_mem_48880, __global unsigned char *global_dynid_mem_48882)\n{\n    #define segscan_tblock_sizze_44846 (sortColumn_shortzisegscan_44851zisegscan_tblock_sizze_44846)\n    #define chunk_sizze_48873 (sortColumn_shortzisegscan_44851zichunk_sizze_48873)\n    \n    volatile __local unsigned char *local_mem_48892_backing_0 = &shared_mem[0];\n    const int64_t local_mem_48892_backing_0_offset = 0 + (smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_44846), chunk_sizze_48873 * segscan_tblock_sizze_44846 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_44846), chunk_sizze_48873 * segscan_tblock_sizze_44846 * (int64_t) 8), (int64_t) 8), (int64_t) 8));\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t local_tid_48885;\n    int32_t tblock_sizze_48888;\n    int32_t wave_sizze_48887;\n    int32_t block_id_48886;\n    int32_t global_tid_48884;\n    int64_t phys_tid_44851;\n    int32_t chunk_sizze_32b_48889;\n    int64_t byte_offsets_48890;\n    int64_t warp_byte_offset_48891;\n    __local unsigned char *local_mem_48892;\n    int64_t trans_arr_len_48893;\n    int64_t phys_block_id_48899;\n    int64_t virtloop_bound_48900;\n    \n    local_tid_48885 = get_local_id(0);\n    tblock_sizze_48888 = get_local_size(0);\n    wave_sizze_48887 = LOCKSTEP_WIDTH;\n    block_id_48886 = get_tblock_id(0);\n    global_tid_48884 = block_id_48886 * tblock_sizze_48888 + local_tid_48885;\n    phys_tid_44851 = sext_i32_i64(global_tid_48884);\n    chunk_sizze_32b_48889 = sext_i64_i32(chunk_sizze_48873);\n    byte_offsets_48890 = segscan_tblock_sizze_44846 * (int64_t) 8;\n    warp_byte_offset_48891 = (int64_t) 288;\n    // Allocate reusable shared memory\n    { }\n    local_mem_48892 = (__local unsigned char *) local_mem_48892_backing_0;\n    trans_arr_len_48893 = chunk_sizze_48873 * segscan_tblock_sizze_44846;\n    phys_block_id_48899 = get_tblock_id(0", ");\n    virtloop_bound_48900 = sdiv_up64(num_virt_blocks_48874 - phys_block_id_48899, num_tblocks_44848);\n    for (int64_t virtloop_i_48901 = 0; virtloop_i_48901 < virtloop_bound_48900; virtloop_i_48901++) {\n        int64_t dynamic_id_48902;\n        int64_t block_offset_48903;\n        int64_t sgm_idx_48904;\n        int32_t boundary_48905;\n        int32_t segsizze_compact_48906;\n        int64_t private_mem_48907[chunk_sizze_48873];\n        int64_t thd_offset_48909;\n        int64_t acc_48925;\n        int64_t prefix_48935;\n        bool block_new_sgm_48936;\n        \n        // First thread in block fetches this block's dynamic_id\n        {\n            if (local_tid_48885 == 0) {\n                dynamic_id_48902 = atomic_add_i32_global(&((volatile __global int *) global_dynid_mem_48882)[(int64_t) 0], (int) 1);\n                // Set dynamic id for this block\n                {\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 0] = dynamic_id_48902;\n                }\n                // First thread in last (virtual) block resets global dynamic_id\n                {\n                    if (dynamic_id_48902 == num_virt_blocks_48874 - (int64_t) 1) {\n                        ((__global int32_t *) global_dynid_mem_48882)[(int64_t) 0] = 0;\n                    }\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        dynamic_id_48902 = ((__local int32_t *) local_mem_48892)[(int64_t) 0];\n        barrier(CLK_LOCAL_MEM_FENCE);\n        block_offset_48903 = dynamic_id_48902 * chunk_sizze_48873 * segscan_tblock_sizze_44846;\n        sgm_idx_48904 = smod64(block_offset_48903, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);\n        boundary_48905 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_44846, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 - sgm_idx_48904));\n        segsizze_compact_48906 = sext_i64_i32(smin64(chunk_sizze_48873 * segscan_tblock_sizze_44846, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUz", "g_41723));\n        thd_offset_48909 = block_offset_48903 + sext_i32_i64(local_tid_48885);\n        // Load and map\n        {\n            for (int64_t i_48910 = 0; i_48910 < chunk_sizze_48873; i_48910++) {\n                int64_t virt_tid_48911 = thd_offset_48909 + i_48910 * segscan_tblock_sizze_44846;\n                int64_t slice_48912 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_44850 = virt_tid_48911;\n                int64_t remnant_48913 = virt_tid_48911 - gtid_44850;\n                \n                if (slt64(virt_tid_48911, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t new_index_46940 = squot64(gtid_44850, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);\n                    int64_t binop_y_46942 = dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 * new_index_46940;\n                    int64_t new_index_46943 = gtid_44850 - binop_y_46942;\n                    bool index_concat_cmp_46945 = sle64(n_blocks_41712, new_index_46943);\n                    int64_t index_concat_branch_46949;\n                    \n                    if (index_concat_cmp_46945) {\n                        int64_t index_concat_46947 = ((__global int64_t *) mem_47989)[new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46947;\n                    } else {\n                        int64_t index_concat_46948 = ((__global int64_t *) ext_mem_47981)[new_index_46943 * (int64_t) 4 + new_index_46940];\n                        \n                        index_concat_branch_46949 = index_concat_46948;\n                    }\n                    private_mem_48907[i_48910] = index_concat_branch_46949;\n                } else {\n                    private_mem_48907[i_48910] = (int64_t) 0;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // Transpose scan inputs\n        {\n            for (int64_t i_48914 = 0; i_48914 < chunk_sizze_48873; i_48914++) {\n                ",
                                    "int64_t sharedIdx_48915 = sext_i32_i64(local_tid_48885) + i_48914 * segscan_tblock_sizze_44846;\n                int64_t tmp_48916 = private_mem_48907[i_48914];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48915] = tmp_48916;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48917 = 0; i_48917 < chunk_sizze_48873; i_48917++) {\n                int64_t sharedIdx_48918 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48917;\n                int64_t tmp_48919 = ((__local int64_t *) local_mem_48892)[sharedIdx_48918];\n                \n                private_mem_48907[i_48917] = tmp_48919;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Per thread scan\n        {\n            for (int64_t i_48920 = 0; i_48920 < chunk_sizze_48873 - (int64_t) 1; i_48920++) {\n                int64_t eta_p_41940;\n                int64_t eta_p_41941;\n                \n                eta_p_41940 = private_mem_48907[i_48920];\n                eta_p_41941 = private_mem_48907[i_48920 + (int64_t) 1];\n                \n                int64_t defunc_0_op_res_41942 = add64(eta_p_41940, eta_p_41941);\n                \n                private_mem_48907[i_48920 + (int64_t) 1] = defunc_0_op_res_41942;\n            }\n        }\n        // Publish results in shared memory\n        {\n            int64_t tmp_48921 = private_mem_48907[chunk_sizze_48873 - (int64_t) 1];\n            \n            ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = tmp_48921;\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        // Scan results (with warp scan)\n        {\n            int64_t eta_p_48922;\n            int64_t eta_p_48923;\n            int64_t eta_p_48926;\n            int64_t eta_p_48927;\n            bool ltid_in_bounds_48929 = slt64(sext_i32_i64(local_tid_48885), num_virt_threads_48875);\n            int32_t skip_threads_48930;\n            \n            // read input for in-block scan\n            {\n   ", "             if (ltid_in_bounds_48929) {\n                    eta_p_48923 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                    if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                        eta_p_48922 = eta_p_48923;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_48930 = 1;\n                while (slt32(skip_threads_48930, 32)) {\n                    bool thread_active_48931 = sle32(skip_threads_48930, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && ltid_in_bounds_48929;\n                    \n                    if (thread_active_48931) {\n                        // read operands\n                        {\n                            eta_p_48922 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48930)];\n                        }\n                    }\n                    // perform operation\n                    {\n                        if (thread_active_48931) {\n                            int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                            \n                            eta_p_48922 = defunc_0_op_res_48924;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (thread_active_48931) {\n                        // write result\n                        {\n                            ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                            eta_p_48923 = eta_p_48922;\n                        }\n                    }\n                    if (sle32(wave_sizze_48887, skip_threads_48930)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n               ", "     skip_threads_48930 *= 2;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // last thread of block 'i' writes its result to offset 'i'\n            {\n                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 31 && ltid_in_bounds_48929) {\n                    ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32))] = eta_p_48922;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n            {\n                int32_t skip_threads_48932;\n                \n                // read input for in-block scan\n                {\n                    if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                        eta_p_48927 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                        if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                            eta_p_48926 = eta_p_48927;\n                        }\n                    }\n                }\n                // in-block scan (hopefully no barriers needed)\n                {\n                    skip_threads_48932 = 1;\n                    while (slt32(skip_threads_48932, 32)) {\n                        bool thread_active_48933 = sle32(skip_threads_48932, local_tid_48885 - squot32(local_tid_48885, 32) * 32) && (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929);\n                        \n                        if (thread_active_48933) {\n                            // read operands\n                            {\n                                eta_p_48926 = ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48932)];\n                            }\n                        }\n                        // perform operation\n                        {\n                            if (threa",
                                    "d_active_48933) {\n                                int64_t defunc_0_op_res_48928 = add64(eta_p_48926, eta_p_48927);\n                                \n                                eta_p_48926 = defunc_0_op_res_48928;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        if (thread_active_48933) {\n                            // write result\n                            {\n                                ((volatile __local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48926;\n                                eta_p_48927 = eta_p_48926;\n                            }\n                        }\n                        if (sle32(wave_sizze_48887, skip_threads_48932)) {\n                            barrier(CLK_LOCAL_MEM_FENCE);\n                        }\n                        skip_threads_48932 *= 2;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            \n            bool no_carry_in_48934 = squot32(local_tid_48885, 32) == 0 || !ltid_in_bounds_48929;\n            \n            // carry-in for every block except the first\n            {\n                // read operands\n                {\n                    if (!no_carry_in_48934) {\n                        eta_p_48923 = eta_p_48922;\n                        eta_p_48922 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(squot32(local_tid_48885, 32)) - (int64_t) 1];\n                    }\n                }\n                // perform operation\n                {\n                    if (!no_carry_in_48934) {\n                        int64_t defunc_0_op_res_48924 = add64(eta_p_48922, eta_p_48923);\n                        \n                        eta_p_48922 = defunc_0_op_res_48924;\n                    }\n                }\n                // write final result\n                {\n          ", "          if (!no_carry_in_48934) {\n                        ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48922;\n                    }\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            // restore correct values for first block\n            {\n                if (squot32(local_tid_48885, 32) == 0 && ltid_in_bounds_48929) {\n                    ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = eta_p_48923;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            barrier(CLK_LOCAL_MEM_FENCE);\n            if (local_tid_48885 == 0) {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[segscan_tblock_sizze_44846 - (int64_t) 1];\n            } else {\n                acc_48925 = ((__local int64_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - (int64_t) 1];\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n        prefix_48935 = (int64_t) 0;\n        block_new_sgm_48936 = sgm_idx_48904 == (int64_t) 0;\n        // Perform lookback\n        {\n            if (block_new_sgm_48936 && local_tid_48885 == 0) {\n                ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = acc_48925;\n                mem_fence_global();\n                ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                acc_48925 = (int64_t) 0;\n            }\n            if (!block_new_sgm_48936 && slt32(local_tid_48885, wave_sizze_48887)) {\n                if (local_tid_48885 == 0) {\n                    ((volatile __global int64_t *) aggregates_mem_48878)[dynamic_id_48902] = acc_48925;\n                    mem_fence_global();\n                    ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 1;\n                    \n                    int8_t tmp_48937 = ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902 - (int64_t) 1];\n                    \n      ", "              ((volatile __local int8_t *) local_mem_48892)[(int64_t) 0] = tmp_48937;\n                }\n                mem_fence_local();\n                \n                int8_t status_48938 = ((__local int8_t *) local_mem_48892)[(int64_t) 0];\n                \n                if (status_48938 == (int8_t) 2) {\n                    if (local_tid_48885 == 0) {\n                        prefix_48935 = ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902 - (int64_t) 1];\n                    }\n                } else {\n                    int32_t readOffset_48939 = sext_i64_i32(dynamic_id_48902 - sext_i32_i64(wave_sizze_48887));\n                    \n                    while (slt32(wave_sizze_48887 * -1, readOffset_48939)) {\n                        int32_t read_i_48940 = readOffset_48939 + local_tid_48885;\n                        int64_t aggr_48941 = (int64_t) 0;\n                        int8_t flag_48942 = (int8_t) 0;\n                        \n                        if (sle32(0, read_i_48940)) {\n                            flag_48942 = ((volatile __global int8_t *) status_flags_mem_48876)[sext_i32_i64(read_i_48940)];\n                            if (flag_48942 == (int8_t) 2) {\n                                aggr_48941 = ((volatile __global int64_t *) incprefixes_mem_48880)[sext_i32_i64(read_i_48940)];\n                            } else if (flag_48942 == (int8_t) 1) {\n                                aggr_48941 = ((volatile __global int64_t *) aggregates_mem_48878)[sext_i32_i64(read_i_48940)];\n                            }\n                        }\n                        ((__local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = aggr_48941;\n                        ((__local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flag_48942;\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        if (slt8(flag_48942, (int8_t) 2)) {\n           ",
                                    "                 int8_t flg_x_48946;\n                            int8_t flg_y_48947;\n                            int64_t eta_p_48943;\n                            int64_t eta_p_48944;\n                            int32_t skip_threads_48948;\n                            \n                            // read input for in-block scan\n                            {\n                                flg_y_48947 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)];\n                                eta_p_48944 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)];\n                                if ((local_tid_48885 - squot32(local_tid_48885, 32) * 32) == 0) {\n                                    eta_p_48943 = eta_p_48944;\n                                    flg_x_48946 = flg_y_48947;\n                                }\n                            }\n                            // in-block scan (hopefully no barriers needed)\n                            {\n                                skip_threads_48948 = 1;\n                                while (slt32(skip_threads_48948, 32)) {\n                                    if (sle32(skip_threads_48948, local_tid_48885 - squot32(local_tid_48885, 32) * 32)) {\n                                        // read operands\n                                        {\n                                            flg_x_48946 = ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948)];\n                                            eta_p_48943 = ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(local_tid_48885) - sext_i32_i64(skip_threads_48948))];\n                                        }\n                                        // perform operation\n                                        {\n                                            if (flg_y_48947 == (int8_t) 2 || flg_y_48947 == (int8_t) 0) {\n                          ", "                      flg_x_48946 = flg_y_48947;\n                                                eta_p_48943 = eta_p_48944;\n                                            } else {\n                                                int64_t defunc_0_op_res_48945 = add64(eta_p_48943, eta_p_48944);\n                                                \n                                                eta_p_48943 = defunc_0_op_res_48945;\n                                            }\n                                        }\n                                        // write result\n                                        {\n                                            ((volatile __local int8_t *) local_mem_48892)[sext_i32_i64(local_tid_48885)] = flg_x_48946;\n                                            flg_y_48947 = flg_x_48946;\n                                            ((volatile __local int64_t *) local_mem_48892)[(int64_t) 4 + sext_i32_i64(local_tid_48885)] = eta_p_48943;\n                                            eta_p_48944 = eta_p_48943;\n                                        }\n                                    }\n                                    skip_threads_48948 *= 2;\n                                }\n                            }\n                        }\n                        flag_48942 = ((__local int8_t *) local_mem_48892)[sext_i32_i64(wave_sizze_48887) - (int64_t) 1];\n                        aggr_48941 = ((__local int64_t *) local_mem_48892)[(int64_t) 4 + (sext_i32_i64(wave_sizze_48887) - (int64_t) 1)];\n                        if (flag_48942 == (int8_t) 2) {\n                            readOffset_48939 = wave_sizze_48887 * -1;\n                        } else if (flag_48942 == (int8_t) 1) {\n                            readOffset_48939 -= wave_sizze_48887;\n                        }\n                        if (slt8((int8_t) 0, flag_48942)) {\n                            int64_t eta_p_48949 = aggr_48941;\n                            int64_t eta_p_48950 = prefix_48935;\n    ", "                        int64_t defunc_0_op_res_48951 = add64(eta_p_48949, eta_p_48950);\n                            \n                            prefix_48935 = defunc_0_op_res_48951;\n                        }\n                        mem_fence_local();\n                    }\n                }\n                if (local_tid_48885 == 0) {\n                    if (boundary_48905 == sext_i64_i32(segscan_tblock_sizze_44846 * chunk_sizze_48873)) {\n                        int64_t eta_p_48952 = prefix_48935;\n                        int64_t eta_p_48953 = acc_48925;\n                        int64_t defunc_0_op_res_48954 = add64(eta_p_48952, eta_p_48953);\n                        \n                        ((volatile __global int64_t *) incprefixes_mem_48880)[dynamic_id_48902] = defunc_0_op_res_48954;\n                        mem_fence_global();\n                        ((volatile __global int8_t *) status_flags_mem_48876)[dynamic_id_48902] = (int8_t) 2;\n                    }\n                    ((__local int64_t *) local_mem_48892)[(int64_t) 4] = prefix_48935;\n                    acc_48925 = (int64_t) 0;\n                }\n            }\n            if (!(dynamic_id_48902 == (int64_t) 0)) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                prefix_48935 = ((__local int64_t *) local_mem_48892)[(int64_t) 4];\n                barrier(CLK_LOCAL_MEM_FENCE);\n            }\n        }\n        // Distribute results\n        {\n            int64_t eta_p_48955;\n            int64_t eta_p_48956;\n            int64_t eta_p_48958 = prefix_48935;\n            int64_t eta_p_48959 = acc_48925;\n            \n            if (slt32(local_tid_48885 * chunk_sizze_32b_48889, boundary_48905) && !block_new_sgm_48936) {\n                int64_t defunc_0_op_res_48960 = add64(eta_p_48958, eta_p_48959);\n                \n                eta_p_48955 = defunc_0_op_res_48960;\n            } else {\n                eta_p_48955 = acc_48925;\n            }\n            \n            int32_t stopping_point_48961 = segsizze_co",
                                    "mpact_48906 - srem32(local_tid_48885 * chunk_sizze_32b_48889 - 1 + segsizze_compact_48906 - boundary_48905, segsizze_compact_48906);\n            \n            for (int64_t i_48962 = 0; i_48962 < chunk_sizze_48873; i_48962++) {\n                if (slt32(sext_i64_i32(i_48962), stopping_point_48961 - 1)) {\n                    eta_p_48956 = private_mem_48907[i_48962];\n                    \n                    int64_t defunc_0_op_res_48957 = add64(eta_p_48955, eta_p_48956);\n                    \n                    private_mem_48907[i_48962] = defunc_0_op_res_48957;\n                }\n            }\n        }\n        // Transpose scan output and Write it to global memory in coalesced fashion\n        {\n            for (int64_t i_48963 = 0; i_48963 < chunk_sizze_48873; i_48963++) {\n                int64_t sharedIdx_48964 = sext_i32_i64(local_tid_48885) * chunk_sizze_48873 + i_48963;\n                int64_t tmp_48965 = private_mem_48907[i_48963];\n                \n                ((__local int64_t *) local_mem_48892)[sharedIdx_48964] = tmp_48965;\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n            for (int64_t i_48966 = 0; i_48966 < chunk_sizze_48873; i_48966++) {\n                int64_t flat_idx_48967 = thd_offset_48909 + i_48966 * segscan_tblock_sizze_44846;\n                int64_t slice_48968 = dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723;\n                int64_t gtid_44850 = flat_idx_48967;\n                int64_t remnant_48969 = flat_idx_48967 - gtid_44850;\n                \n                if (slt64(flat_idx_48967, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {\n                    int64_t tmp_48970 = ((__local int64_t *) local_mem_48892)[flat_idx_48967 - block_offset_48903];\n                    \n                    ((__global int64_t *) mem_47992)[gtid_44850] = tmp_48970;\n                }\n            }\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    \n  error_3:\n    return;\n    #undef segscan_tblock_sizze_44846\n    #undef c", "hunk_sizze_48873\n}\n", NULL};
// Start of gpu_prototypes.h

// Constants used for transpositions.  In principle these should be configurable.
#define TR_BLOCK_DIM 16
#define TR_TILE_DIM (TR_BLOCK_DIM*2)
#define TR_ELEMS_PER_THREAD 8

// Config stuff included in every GPU backend.
struct gpu_config {
  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_reg_tile_size;
  size_t default_cache;
  size_t default_shared_memory;
  size_t default_registers;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;
};

// The following are dummy sizes that mean the concrete defaults
// will be set during initialisation via hardware-inspection-based
// heuristics.
struct gpu_config gpu_config_initial = {
  0
};

// Must be defined by the user.
static int gpu_macros(struct futhark_context *ctx, char*** names, int64_t** values);

static void gpu_init_log(struct futhark_context *ctx);
struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);
static int gpu_free_all(struct futhark_context *ctx);

// End of gpu_prototypes.h

// Start of backends/cuda.h.

// Forward declarations.
// Invoked by setup_opencl() after the platform and device has been
// found, but before the program is loaded.  Its intended use is to
// tune constants based on the selected platform and device.
static void set_tuning_params(struct futhark_context* ctx);
static char* get_failure_msg(int failure_idx, int64_t args[]);

#define CUDA_SUCCEED_FATAL(x) cuda_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define CUDA_SUCCEED_NONFATAL(x) cuda_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_FATAL(x) nvrtc_api_succeed_fatal(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED_NONFATAL(x) nvrtc_api_succeed_nonfatal(x, #x, __FILE__, __LINE__)
// Take care not to override an existing error.
#define CUDA_SUCCEED_OR_RETURN(e) {             \
    char *serror = CUDA_SUCCEED_NONFATAL(e);    \
    if (serror) {                               \
      if (!ctx->error) {                        \
        ctx->error = serror;                    \
      } else {                                  \
        free(serror);                           \
      }                                         \
      return bad;                               \
    }                                           \
  }

// CUDA_SUCCEED_OR_RETURN returns the value of the variable 'bad' in
// scope.  By default, it will be this one.  Create a local variable
// of some other type if needed.  This is a bit of a hack, but it
// saves effort in the code generator.
static const int bad = 1;

static inline void cuda_api_succeed_fatal(CUresult res, const char *call,
                                          const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* cuda_api_succeed_nonfatal(CUresult res, const char *call,
                                       const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    return msgprintf("%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

static inline void nvrtc_api_succeed_fatal(nvrtcResult res, const char *call,
                                           const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                  file, line, call, res, err_str);
  }
}

static char* nvrtc_api_succeed_nonfatal(nvrtcResult res, const char *call,
                                        const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    return msgprintf("%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
                     file, line, call, res, err_str);
  } else {
    return NULL;
  }
}

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char* cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
  // Uniform fields above.

  char* program;
  int num_nvrtc_opts;
  char* *nvrtc_opts;

  char* preferred_device;
  int preferred_device_num;

  int unified_memory;

  char* dump_ptx_to;
  char* load_ptx_from;

  struct gpu_config gpu;
};

static void backend_context_config_setup(struct futhark_context_config *cfg) {
  cfg->num_nvrtc_opts = 0;
  cfg->nvrtc_opts = (char**) malloc(sizeof(char*));
  cfg->nvrtc_opts[0] = NULL;

  cfg->program = strconcat(gpu_program);

  cfg->preferred_device_num = 0;
  cfg->preferred_device = strdup("");

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->unified_memory = 2;

  cfg->gpu = gpu_config_initial;
  cfg->gpu.default_block_size = 256;
  cfg->gpu.default_tile_size = 32;
  cfg->gpu.default_reg_tile_size = 2;
  cfg->gpu.default_threshold = 32*1024;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  for (int i = 0; i < cfg->num_nvrtc_opts; i++) {
    free(cfg->nvrtc_opts[i]);
  }
  free(cfg->nvrtc_opts);
  free(cfg->dump_ptx_to);
  free(cfg->load_ptx_from);
  free(cfg->preferred_device);
  free(cfg->program);
}

void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg, const char *opt) {
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = strdup(opt);
  cfg->num_nvrtc_opts++;
  cfg->nvrtc_opts = (char **) realloc(cfg->nvrtc_opts, (cfg->num_nvrtc_opts + 1) * sizeof(char *));
  cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}

void futhark_context_config_set_device(struct futhark_context_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  free(cfg->preferred_device);
  cfg->preferred_device = strdup(s);
  cfg->preferred_device_num = x;
}

const char* futhark_context_config_get_program(struct futhark_context_config *cfg) {
  return cfg->program;
}

void futhark_context_config_set_program(struct futhark_context_config *cfg, const char *s) {
  free(cfg->program);
  cfg->program = strdup(s);
}

void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg, const char *path) {
  free(cfg->dump_ptx_to);
  cfg->dump_ptx_to = strdup(path);
}

void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg, const char *path) {
  free(cfg->load_ptx_from);
  cfg->load_ptx_from = strdup(path);
}

void futhark_context_config_set_unified_memory(struct futhark_context_config* cfg, int flag) {
  cfg->unified_memory = flag;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  const char *name;
};

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
  // Uniform fields above.

  CUdeviceptr global_failure;
  CUdeviceptr global_failure_args;
  struct tuning_params tuning_params;
  // True if a potentially failing kernel has been enqueued.
  int32_t failure_is_an_option;
  int total_runs;
  long int total_runtime;
  int64_t peak_mem_usage_device;
  int64_t cur_mem_usage_device;

  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;
  CUstream stream;

  struct free_list gpu_free_list;

  size_t max_thread_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;
  size_t max_registers;
  size_t max_cache;

  size_t lockstep_width;

  struct builtin_kernels* kernels;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED_FATAL(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static int cuda_device_setup(struct futhark_context *ctx) {
  struct futhark_context_config *cfg = ctx->cfg;
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best = 0, cc_minor_best = 0;
  int cc_major = 0, cc_minor = 0;
  CUdevice dev;

  CUDA_SUCCEED_FATAL(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED_FATAL(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED_FATAL(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (cfg->logging) {
      fprintf(ctx->log, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
              i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (cfg->logging) {
        fprintf(ctx->log, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, cfg->preferred_device) != NULL &&
        num_device_matches++ == cfg->preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (cfg->logging) {
    fprintf(ctx->log, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED_FATAL(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  static struct {
    int major;
    int minor;
    const char *arch_str;
  } const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" },
    { 8, 0, "compute_80" },
    { 8, 6, "compute_80" },
    { 8, 7, "compute_80" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  int num_archs = sizeof(x)/sizeof(x[0]);
  for (int i = 0; i < num_archs; i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static void cuda_nvrtc_mk_build_options(struct futhark_context *ctx, const char *extra_opts[],
                                        char*** opts_out, size_t *n_opts) {
  int arch_set = 0, num_extra_opts;
  struct futhark_context_config *cfg = ctx->cfg;

  char** macro_names;
  int64_t* macro_vals;
  int num_macros = gpu_macros(ctx, &macro_names, &macro_vals);

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t i = 0, n_opts_alloc = 20 + num_macros + num_extra_opts + cfg->num_tuning_params;
  char **opts = (char**) malloc(n_opts_alloc * sizeof(char *));
  if (!arch_set) {
    opts[i++] = strdup("-arch");
    opts[i++] = strdup(cuda_nvrtc_get_arch(ctx->dev));
  }
  opts[i++] = strdup("-default-device");
  if (cfg->debugging) {
    opts[i++] = strdup("-G");
    opts[i++] = strdup("-lineinfo");
  } else {
    opts[i++] = strdup("--disable-warnings");
  }
  opts[i++] = msgprintf("-D%s=%d",
                        "max_thread_block_size",
                        (int)ctx->max_thread_block_size);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_shared_memory",
                        (int)ctx->max_shared_memory);
  opts[i++] = msgprintf("-D%s=%d",
                        "max_registers",
                        (int)ctx->max_registers);

  for (int j = 0; j < num_macros; j++) {
    opts[i++] = msgprintf("-D%s=%zu", macro_names[j], macro_vals[j]);
  }

  for (int j = 0; j < cfg->num_tuning_params; j++) {
    opts[i++] = msgprintf("-D%s=%zu", cfg->tuning_param_vars[j],
                          cfg->tuning_params[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_thread_block_size);

  // Time for the best lines of the code in the entire compiler.
  if (getenv("CUDA_HOME") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_HOME"));
  }
  if (getenv("CUDA_ROOT") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_ROOT"));
  }
  if (getenv("CUDA_PATH") != NULL) {
    opts[i++] = msgprintf("-I%s/include", getenv("CUDA_PATH"));
  }
  opts[i++] = msgprintf("-I/usr/local/cuda/include");
  opts[i++] = msgprintf("-I/usr/include");

  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = strdup(extra_opts[j]);
  }

  opts[i++] = msgprintf("-DTR_BLOCK_DIM=%d", TR_BLOCK_DIM);
  opts[i++] = msgprintf("-DTR_TILE_DIM=%d", TR_TILE_DIM);
  opts[i++] = msgprintf("-DTR_ELEMS_PER_THREAD=%d", TR_ELEMS_PER_THREAD);

  free(macro_names);
  free(macro_vals);

  *n_opts = i;
  *opts_out = opts;
}

static char* cuda_nvrtc_build(const char *src, const char *opts[], size_t n_opts,
                              char **ptx) {
  nvrtcProgram prog;
  char *problem = NULL;

  problem = NVRTC_SUCCEED_NONFATAL(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));

  if (problem) {
    return problem;
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        problem = msgprintf("NVRTC compilation failed.\n\n%s\n", log);
      } else {
        problem = msgprintf("Could not retrieve compilation log\n");
      }
      free(log);
    }
    return problem;
  }

  size_t ptx_size;
  NVRTC_SUCCEED_FATAL(nvrtcGetPTXSize(prog, &ptx_size));
  *ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED_FATAL(nvrtcGetPTX(prog, *ptx));

  NVRTC_SUCCEED_FATAL(nvrtcDestroyProgram(&prog));

  return NULL;
}

static void cuda_load_ptx_from_cache(struct futhark_context_config *cfg,
                                     const char *src,
                                     const char *opts[], size_t n_opts,
                                     struct cache_hash *h, const char *cache_fname,
                                     char **ptx) {
  if (cfg->logging) {
    fprintf(stderr, "Restoring cache from from %s...\n", cache_fname);
  }
  cache_hash_init(h);
  for (size_t i = 0; i < n_opts; i++) {
    cache_hash(h, opts[i], strlen(opts[i]));
  }
  cache_hash(h, src, strlen(src));
  size_t ptxsize;
  errno = 0;
  if (cache_restore(cache_fname, h, (unsigned char**)ptx, &ptxsize) != 0) {
    if (cfg->logging) {
      fprintf(stderr, "Failed to restore cache (errno: %s)\n", strerror(errno));
    }
  }
}

static void cuda_size_setup(struct futhark_context *ctx)
{
  struct futhark_context_config *cfg = ctx->cfg;
  if (cfg->gpu.default_block_size > ctx->max_thread_block_size) {
    if (cfg->gpu.default_block_size_changed) {
      fprintf(stderr,
              "Note: Device limits default block size to %zu (down from %zu).\n",
              ctx->max_thread_block_size, cfg->gpu.default_block_size);
    }
    cfg->gpu.default_block_size = ctx->max_thread_block_size;
  }
  if (cfg->gpu.default_grid_size > ctx->max_grid_size) {
    if (cfg->gpu.default_grid_size_changed) {
      fprintf(stderr,
              "Note: Device limits default grid size to %zu (down from %zu).\n",
              ctx->max_grid_size, cfg->gpu.default_grid_size);
    }
    cfg->gpu.default_grid_size = ctx->max_grid_size;
  }
  if (cfg->gpu.default_tile_size > ctx->max_tile_size) {
    if (cfg->gpu.default_tile_size_changed) {
      fprintf(stderr,
              "Note: Device limits default tile size to %zu (down from %zu).\n",
              ctx->max_tile_size, cfg->gpu.default_tile_size);
    }
    cfg->gpu.default_tile_size = ctx->max_tile_size;
  }

  if (!cfg->gpu.default_grid_size_changed) {
    cfg->gpu.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / cfg->gpu.default_block_size;
  }

  for (int i = 0; i < cfg->num_tuning_params; i++) {
    const char *size_class = cfg->tuning_param_classes[i];
    int64_t *size_value = &cfg->tuning_params[i];
    const char* size_name = cfg->tuning_param_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "thread_block_size") == size_class) {
      max_value = ctx->max_thread_block_size;
      default_value = cfg->gpu.default_block_size;
    } else if (strstr(size_class, "grid_size") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = cfg->gpu.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = cfg->gpu.default_tile_size;
    } else if (strstr(size_class, "reg_tile_size") == size_class) {
      max_value = 0; // No limit.
      default_value = cfg->gpu.default_reg_tile_size;
    } else if (strstr(size_class, "shared_memory") == size_class) {
      max_value = ctx->max_shared_memory;
      default_value = ctx->max_shared_memory;
    } else if (strstr(size_class, "cache") == size_class) {
      max_value = ctx->max_cache;
      default_value = ctx->max_cache;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = cfg->gpu.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static char* cuda_module_setup(struct futhark_context *ctx,
                               const char *src,
                               const char *extra_opts[],
                               const char* cache_fname) {
  char *ptx = NULL;
  struct futhark_context_config *cfg = ctx->cfg;

  if (cfg->load_ptx_from) {
    ptx = slurp_file(cfg->load_ptx_from, NULL);
  }

  char **opts;
  size_t n_opts;
  cuda_nvrtc_mk_build_options(ctx, extra_opts, &opts, &n_opts);

  if (cfg->logging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  struct cache_hash h;
  int loaded_ptx_from_cache = 0;
  if (cache_fname != NULL) {
    cuda_load_ptx_from_cache(cfg, src, (const char**)opts, n_opts, &h, cache_fname, &ptx);

    if (ptx != NULL) {
      if (cfg->logging) {
        fprintf(stderr, "Restored PTX from cache; now loading module...\n");
      }
      if (cuModuleLoadData(&ctx->module, ptx) == CUDA_SUCCESS) {
        if (cfg->logging) {
          fprintf(stderr, "Success!\n");
        }
        loaded_ptx_from_cache = 1;
      } else {
        if (cfg->logging) {
          fprintf(stderr, "Failed!\n");
        }
        free(ptx);
        ptx = NULL;
      }
    }
  }

  if (ptx == NULL) {
    char* problem = cuda_nvrtc_build(src, (const char**)opts, n_opts, &ptx);
    if (problem != NULL) {
      return problem;
    }
  }

  if (cfg->dump_ptx_to != NULL) {
    dump_file(cfg->dump_ptx_to, ptx, strlen(ptx));
  }

  if (!loaded_ptx_from_cache) {
    CUDA_SUCCEED_FATAL(cuModuleLoadData(&ctx->module, ptx));
  }

  if (cache_fname != NULL && !loaded_ptx_from_cache) {
    if (cfg->logging) {
      fprintf(stderr, "Caching PTX in %s...\n", cache_fname);
    }
    errno = 0;
    if (cache_store(cache_fname, &h, (const unsigned char*)ptx, strlen(ptx)) != 0) {
      fprintf(stderr, "Failed to cache PTX: %s\n", strerror(errno));
    }
  }

  for (size_t i = 0; i < n_opts; i++) {
    free((char *)opts[i]);
  }
  free(opts);
  free(ptx);

  return NULL;
}

struct cuda_event {
  cudaEvent_t start;
  cudaEvent_t end;
};

static struct cuda_event* cuda_event_new(struct futhark_context* ctx) {
  if (ctx->profiling && !ctx->profiling_paused) {
    struct cuda_event* e = malloc(sizeof(struct cuda_event));
    cudaEventCreate(&e->start);
    cudaEventCreate(&e->end);
    return e;
  } else {
    return NULL;
  }
}

static int cuda_event_report(struct str_builder* sb, struct cuda_event* e) {
  float ms;
  CUresult err;
  if ((err = cuEventElapsedTime(&ms, e->start, e->end)) != CUDA_SUCCESS) {
    return err;
  }

  // CUDA provides milisecond resolution, but we want microseconds.
  str_builder(sb, ",\"duration\":%f", ms*1000);

  if ((err = cuEventDestroy(e->start)) != CUDA_SUCCESS) {
    return 1;
  }

  if ((err = cuEventDestroy(e->end)) != CUDA_SUCCESS) {
    return 1;
  }

  free(e);

  return 0;
}

int futhark_context_sync(struct futhark_context* ctx) {
  CUDA_SUCCEED_OR_RETURN(cuCtxPushCurrent(ctx->cu_ctx));
  CUDA_SUCCEED_OR_RETURN(cuCtxSynchronize());
  if (ctx->failure_is_an_option) {
    // Check for any delayed error.
    int32_t failure_idx;
    CUDA_SUCCEED_OR_RETURN(
                           cuMemcpyDtoH(&failure_idx,
                                        ctx->global_failure,
                                        sizeof(int32_t)));
    ctx->failure_is_an_option = 0;

    if (failure_idx >= 0) {
      // We have to clear global_failure so that the next entry point
      // is not considered a failure from the start.
      int32_t no_failure = -1;
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyHtoD(ctx->global_failure,
                                          &no_failure,
                                          sizeof(int32_t)));

      int64_t args[max_failure_args+1];
      CUDA_SUCCEED_OR_RETURN(
                             cuMemcpyDtoH(&args,
                                          ctx->global_failure_args,
                                          sizeof(args)));

      ctx->error = get_failure_msg(failure_idx, args);

      return FUTHARK_PROGRAM_ERROR;
    }
  }

  CUDA_SUCCEED_OR_RETURN(cuCtxPopCurrent(&ctx->cu_ctx));
  return 0;
}

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx);
void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels);

int backend_context_setup(struct futhark_context* ctx) {
  ctx->failure_is_an_option = 0;
  ctx->total_runs = 0;
  ctx->total_runtime = 0;
  ctx->peak_mem_usage_device = 0;
  ctx->cur_mem_usage_device = 0;
  ctx->kernels = NULL;

  CUDA_SUCCEED_FATAL(cuInit(0));
  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED_FATAL(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->gpu_free_list);

  if (ctx->cfg->unified_memory == 2) {
    ctx->cfg->unified_memory = device_query(ctx->dev, MANAGED_MEMORY);
  }

  if (ctx->cfg->logging) {
    if (ctx->cfg->unified_memory) {
      fprintf(ctx->log, "Using managed memory\n");
    } else {
      fprintf(ctx->log, "Using unmanaged memory\n");
    }
  }

  ctx->max_thread_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_thread_block_size);
  ctx->max_threshold = 1U<<31; // No limit.
  ctx->max_bespoke = 1U<<31; // No limit.

  if (ctx->cfg->gpu.default_registers != 0) {
    ctx->max_registers = ctx->cfg->gpu.default_registers;
  } else {
    ctx->max_registers = device_query(ctx->dev, MAX_REGISTERS_PER_BLOCK);
  }

  if (ctx->cfg->gpu.default_shared_memory != 0) {
    ctx->max_shared_memory = ctx->cfg->gpu.default_shared_memory;
  } else {
    // MAX_SHARED_MEMORY_PER_BLOCK gives bogus numbers (48KiB); probably
    // for backwards compatibility.  Add _OPTIN and you seem to get the
    // right number.
    ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK_OPTIN);
#if CUDART_VERSION >= 12000
    ctx->max_shared_memory -= device_query(ctx->dev, RESERVED_SHARED_MEMORY_PER_BLOCK);
#endif
  }

  if (ctx->cfg->gpu.default_cache != 0) {
    ctx->max_cache = ctx->cfg->gpu.default_cache;
  } else {
    ctx->max_cache = device_query(ctx->dev, L2_CACHE_SIZE);
  }

  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);
  CUDA_SUCCEED_FATAL(cuStreamCreate(&ctx->stream, CU_STREAM_DEFAULT));
  cuda_size_setup(ctx);

  gpu_init_log(ctx);

  ctx->error = cuda_module_setup(ctx,
                                 ctx->cfg->program,
                                 (const char**)ctx->cfg->nvrtc_opts,
                                 ctx->cfg->cache_fname);

  if (ctx->error != NULL) {
    futhark_panic(1, "During CUDA initialisation:\n%s\n", ctx->error);
  }

  int32_t no_error = -1;
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
  CUDA_SUCCEED_FATAL(cuMemcpyHtoD(ctx->global_failure, &no_error, sizeof(no_error)));
  // The +1 is to avoid zero-byte allocations.
  CUDA_SUCCEED_FATAL(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t)*(max_failure_args+1)));

  if ((ctx->kernels = init_builtin_kernels(ctx)) == NULL) {
    return 1;
  }

  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  if (ctx->kernels != NULL) {
    free_builtin_kernels(ctx, ctx->kernels);
    cuMemFree(ctx->global_failure);
    cuMemFree(ctx->global_failure_args);
    CUDA_SUCCEED_FATAL(gpu_free_all(ctx));
    CUDA_SUCCEED_FATAL(cuStreamDestroy(ctx->stream));
    CUDA_SUCCEED_FATAL(cuModuleUnload(ctx->module));
    CUDA_SUCCEED_FATAL(cuCtxDestroy(ctx->cu_ctx));
  }
  free_list_destroy(&ctx->gpu_free_list);
}

// GPU ABSTRACTION LAYER

// Types.

typedef CUfunction gpu_kernel;
typedef CUdeviceptr gpu_mem;

static void gpu_create_kernel(struct futhark_context *ctx,
                              gpu_kernel* kernel,
                              const char* name) {
  if (ctx->debugging) {
    fprintf(ctx->log, "Creating kernel %s.\n", name);
  }
  CUDA_SUCCEED_FATAL(cuModuleGetFunction(kernel, ctx->module, name));
  // Unless the below is set, the kernel is limited to 48KiB of memory.
  CUDA_SUCCEED_FATAL(cuFuncSetAttribute(*kernel,
                                        cudaFuncAttributeMaxDynamicSharedMemorySize,
                                        ctx->max_shared_memory));
}

static void gpu_free_kernel(struct futhark_context *ctx,
                            gpu_kernel kernel) {
  (void)ctx;
  (void)kernel;
}

static int gpu_scalar_to_device(struct futhark_context* ctx,
                                gpu_mem dst, size_t offset, size_t size,
                                void *src) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyHtoD(dst + offset, src, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_scalar_from_device(struct futhark_context* ctx,
                                  void *dst,
                                  gpu_mem src, size_t offset, size_t size) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_scalar_from_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyDtoH(dst, src + offset, size));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int gpu_memcpy(struct futhark_context* ctx,
                      gpu_mem dst, int64_t dst_offset,
                      gpu_mem src, int64_t src_offset,
                      int64_t nbytes) {
  struct cuda_event *event = cuda_event_new(ctx);
  if (event != NULL) {
    add_event(ctx,
              "copy_dev_to_dev",
              strdup(""),
              event,
              (event_report_fn)cuda_event_report);
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
  }
  CUDA_SUCCEED_OR_RETURN(cuMemcpyAsync(dst+dst_offset, src+src_offset, nbytes, ctx->stream));
  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_host2gpu(struct futhark_context* ctx, bool sync,
                           gpu_mem dst, int64_t dst_offset,
                           const unsigned char* src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_host_to_dev",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoD(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyHtoDAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
  }
  return FUTHARK_SUCCESS;
}

static int memcpy_gpu2host(struct futhark_context* ctx, bool sync,
                           unsigned char* dst, int64_t dst_offset,
                           gpu_mem src, int64_t src_offset,
                           int64_t nbytes) {
  if (nbytes > 0) {
    struct cuda_event *event = cuda_event_new(ctx);
    if (event != NULL) {
      add_event(ctx,
                "copy_dev_to_host",
                strdup(""),
                event,
                (event_report_fn)cuda_event_report);
      CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    }
    if (sync) {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoH(dst + dst_offset, src + src_offset, nbytes));
    } else {
      CUDA_SUCCEED_OR_RETURN
        (cuMemcpyDtoHAsync(dst + dst_offset, src + src_offset, nbytes, ctx->stream));
    }
    if (event != NULL) {
      CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
    }
    if (sync &&
        ctx->failure_is_an_option &&
        futhark_context_sync(ctx) != 0) {
      return 1;
    }
  }
  return FUTHARK_SUCCESS;
}

static int gpu_launch_kernel(struct futhark_context* ctx,
                             gpu_kernel kernel, const char *name,
                             const int32_t grid[3],
                             const int32_t block[3],
                             unsigned int shared_mem_bytes,
                             int num_args,
                             void* args[num_args],
                             size_t args_sizes[num_args]) {
  (void) args_sizes;

  if (shared_mem_bytes > ctx->max_shared_memory) {
    set_error(ctx, msgprintf("Kernel %s with %d bytes of memory exceeds device limit of %d\n",
                             name, shared_mem_bytes, (int)ctx->max_shared_memory));
    return 1;
  }

  int64_t time_start = 0, time_end = 0;
  if (ctx->debugging) {
    time_start = get_wall_time();
  }

  struct cuda_event *event = cuda_event_new(ctx);

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->start, ctx->stream));
    add_event(ctx,
              name,
              msgprintf("Kernel %s with\n"
                        "  grid=(%d,%d,%d)\n"
                        "  block=(%d,%d,%d)\n"
                        "  shared memory=%d",
                        name,
                        grid[0], grid[1], grid[2],
                        block[0], block[1], block[2],
                        shared_mem_bytes),
              event,
              (event_report_fn)cuda_event_report);
  }

  CUDA_SUCCEED_OR_RETURN
    (cuLaunchKernel(kernel,
                    grid[0], grid[1], grid[2],
                    block[0], block[1], block[2],
                    shared_mem_bytes, ctx->stream,
                    args, NULL));

  if (event != NULL) {
    CUDA_SUCCEED_FATAL(cuEventRecord(event->end, ctx->stream));
  }

  if (ctx->debugging) {
    CUDA_SUCCEED_FATAL(cuCtxSynchronize());
    time_end = get_wall_time();
    long int time_diff = time_end - time_start;
    fprintf(ctx->log, "  runtime: %ldus\n", time_diff);
  }
  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return FUTHARK_SUCCESS;
}

static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out) {
  CUresult res;
  if (ctx->cfg->unified_memory) {
    res = cuMemAllocManaged(mem_out, size, CU_MEM_ATTACH_GLOBAL);
  } else {
    res = cuMemAlloc(mem_out, size);
  }

  if (res == CUDA_ERROR_OUT_OF_MEMORY) {
    return FUTHARK_OUT_OF_MEMORY;
  }

  CUDA_SUCCEED_OR_RETURN(res);
  return FUTHARK_SUCCESS;
}

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem) {
  (void)ctx;
  CUDA_SUCCEED_OR_RETURN(cuMemFree(mem));
  return FUTHARK_SUCCESS;
}

// End of backends/cuda.h.

// Start of gpu.h

// Generic functions that use our tiny GPU abstraction layer.  The
// entire context must be defined before this header is included.  In
// particular we expect the following functions to be available:

static int gpu_free_actual(struct futhark_context *ctx, gpu_mem mem);
static int gpu_alloc_actual(struct futhark_context *ctx, size_t size, gpu_mem *mem_out);
int gpu_launch_kernel(struct futhark_context* ctx,
                      gpu_kernel kernel, const char *name,
                      const int32_t grid[3],
                      const int32_t block[3],
                      unsigned int shared_mem_bytes,
                      int num_args,
                      void* args[num_args],
                      size_t args_sizes[num_args]);
int gpu_memcpy(struct futhark_context* ctx,
               gpu_mem dst, int64_t dst_offset,
               gpu_mem src, int64_t src_offset,
               int64_t nbytes);
int gpu_scalar_from_device(struct futhark_context* ctx,
                           void *dst,
                           gpu_mem src, size_t offset, size_t size);
int gpu_scalar_to_device(struct futhark_context* ctx,
                         gpu_mem dst, size_t offset, size_t size,
                         void *src);
void gpu_create_kernel(struct futhark_context *ctx,
                       gpu_kernel* kernel,
                       const char* name);

static void gpu_init_log(struct futhark_context *ctx) {
  if (ctx->cfg->logging) {
    fprintf(ctx->log, "Default block size: %ld\n", (long)ctx->cfg->gpu.default_block_size);
    fprintf(ctx->log, "Default grid size: %ld\n", (long)ctx->cfg->gpu.default_grid_size);
    fprintf(ctx->log, "Default tile size: %ld\n", (long)ctx->cfg->gpu.default_tile_size);
    fprintf(ctx->log, "Default register tile size: %ld\n", (long)ctx->cfg->gpu.default_reg_tile_size);
    fprintf(ctx->log, "Default cache: %ld\n", (long)ctx->cfg->gpu.default_cache);
    fprintf(ctx->log, "Default registers: %ld\n", (long)ctx->cfg->gpu.default_registers);
    fprintf(ctx->log, "Default threshold: %ld\n", (long)ctx->cfg->gpu.default_threshold);
    fprintf(ctx->log, "Max thread block size: %ld\n", (long)ctx->max_thread_block_size);
    fprintf(ctx->log, "Max grid size: %ld\n", (long)ctx->max_grid_size);
    fprintf(ctx->log, "Max tile size: %ld\n", (long)ctx->max_tile_size);
    fprintf(ctx->log, "Max threshold: %ld\n", (long)ctx->max_threshold);
    fprintf(ctx->log, "Max shared memory: %ld\n", (long)ctx->max_shared_memory);
    fprintf(ctx->log, "Max registers: %ld\n", (long)ctx->max_registers);
    fprintf(ctx->log, "Max cache: %ld\n", (long)ctx->max_cache);
    fprintf(ctx->log, "Lockstep width: %ld\n", (long)ctx->lockstep_width);
  }
}

// Generic GPU command line options.

void futhark_context_config_set_default_thread_block_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_block_size = size;
  cfg->gpu.default_block_size_changed = 1;
}

void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg, int size) {
  futhark_context_config_set_default_thread_block_size(cfg, size);
}

void futhark_context_config_set_default_grid_size(struct futhark_context_config *cfg, int num) {
  cfg->gpu.default_grid_size = num;
  cfg->gpu.default_grid_size_changed = 1;
}

void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg, int num) {
  futhark_context_config_set_default_grid_size(cfg, num);
}

void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_tile_size = size;
  cfg->gpu.default_tile_size_changed = 1;
}

void futhark_context_config_set_default_reg_tile_size(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_reg_tile_size = size;
}

void futhark_context_config_set_default_cache(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_cache = size;
}

void futhark_context_config_set_default_registers(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_registers = size;
}

void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg, int size) {
  cfg->gpu.default_threshold = size;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg,
                                            const char *param_name,
                                            size_t new_value) {
  for (int i = 0; i < cfg->num_tuning_params; i++) {
    if (strcmp(param_name, cfg->tuning_param_names[i]) == 0) {
      cfg->tuning_params[i] = new_value;
      return 0;
    }
  }
  if (strcmp(param_name, "default_thread_block_size") == 0 ||
      strcmp(param_name, "default_group_size") == 0) {
    cfg->gpu.default_block_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_grid_size") == 0 ||
      strcmp(param_name, "default_num_groups") == 0) {
    cfg->gpu.default_grid_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_threshold") == 0) {
    cfg->gpu.default_threshold = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_tile_size") == 0) {
    cfg->gpu.default_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_reg_tile_size") == 0) {
    cfg->gpu.default_reg_tile_size = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_cache") == 0) {
    cfg->gpu.default_cache = new_value;
    return 0;
  }
  if (strcmp(param_name, "default_shared_memory") == 0) {
    cfg->gpu.default_shared_memory = new_value;
    return 0;
  }

  return 1;
}

// End of GPU command line optiopns.

// Max number of thead blocks we allow along the second or third
// dimension for transpositions.
#define MAX_TR_THREAD_BLOCKS 65535

struct builtin_kernels {
  // We have a lot of ways to transpose arrays.
  gpu_kernel map_transpose_1b;
  gpu_kernel map_transpose_1b_low_height;
  gpu_kernel map_transpose_1b_low_width;
  gpu_kernel map_transpose_1b_small;
  gpu_kernel map_transpose_1b_large;
  gpu_kernel map_transpose_2b;
  gpu_kernel map_transpose_2b_low_height;
  gpu_kernel map_transpose_2b_low_width;
  gpu_kernel map_transpose_2b_small;
  gpu_kernel map_transpose_2b_large;
  gpu_kernel map_transpose_4b;
  gpu_kernel map_transpose_4b_low_height;
  gpu_kernel map_transpose_4b_low_width;
  gpu_kernel map_transpose_4b_small;
  gpu_kernel map_transpose_4b_large;
  gpu_kernel map_transpose_8b;
  gpu_kernel map_transpose_8b_low_height;
  gpu_kernel map_transpose_8b_low_width;
  gpu_kernel map_transpose_8b_small;
  gpu_kernel map_transpose_8b_large;

  // And a few ways of copying.
  gpu_kernel lmad_copy_1b;
  gpu_kernel lmad_copy_2b;
  gpu_kernel lmad_copy_4b;
  gpu_kernel lmad_copy_8b;
};

struct builtin_kernels* init_builtin_kernels(struct futhark_context* ctx) {
  struct builtin_kernels *kernels = malloc(sizeof(struct builtin_kernels));
  gpu_create_kernel(ctx, &kernels->map_transpose_1b, "map_transpose_1b");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_large, "map_transpose_1b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_height, "map_transpose_1b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_low_width, "map_transpose_1b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_1b_small, "map_transpose_1b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_2b, "map_transpose_2b");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_large, "map_transpose_2b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_height, "map_transpose_2b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_low_width, "map_transpose_2b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_2b_small, "map_transpose_2b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_4b, "map_transpose_4b");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_large, "map_transpose_4b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_height, "map_transpose_4b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_low_width, "map_transpose_4b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_4b_small, "map_transpose_4b_small");

  gpu_create_kernel(ctx, &kernels->map_transpose_8b, "map_transpose_8b");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_large, "map_transpose_8b_large");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_height, "map_transpose_8b_low_height");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_low_width, "map_transpose_8b_low_width");
  gpu_create_kernel(ctx, &kernels->map_transpose_8b_small, "map_transpose_8b_small");

  gpu_create_kernel(ctx, &kernels->lmad_copy_1b, "lmad_copy_1b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_2b, "lmad_copy_2b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_4b, "lmad_copy_4b");
  gpu_create_kernel(ctx, &kernels->lmad_copy_8b, "lmad_copy_8b");

  return kernels;
}

void free_builtin_kernels(struct futhark_context* ctx, struct builtin_kernels* kernels) {
  gpu_free_kernel(ctx, kernels->map_transpose_1b);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_1b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_2b);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_2b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_4b);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_4b_small);

  gpu_free_kernel(ctx, kernels->map_transpose_8b);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_large);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_height);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_low_width);
  gpu_free_kernel(ctx, kernels->map_transpose_8b_small);

  gpu_free_kernel(ctx, kernels->lmad_copy_1b);
  gpu_free_kernel(ctx, kernels->lmad_copy_2b);
  gpu_free_kernel(ctx, kernels->lmad_copy_4b);
  gpu_free_kernel(ctx, kernels->lmad_copy_8b);

  free(kernels);
}

static int gpu_alloc(struct futhark_context *ctx, FILE *log,
                     size_t min_size, const char *tag,
                     gpu_mem *mem_out, size_t *size_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  gpu_mem* memptr;
  if (free_list_find(&ctx->gpu_free_list, min_size, tag, size_out, (fl_mem*)&memptr) == 0) {
    // Successfully found a free block.  Is it big enough?
    if (*size_out >= min_size) {
      if (ctx->cfg->debugging) {
        fprintf(log, "No need to allocate: Found a block in the free list.\n");
      }
      *mem_out = *memptr;
      free(memptr);
      return FUTHARK_SUCCESS;
    } else {
      if (ctx->cfg->debugging) {
        fprintf(log, "Found a free block, but it was too small.\n");
      }
      int error = gpu_free_actual(ctx, *memptr);
      free(memptr);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    }
  }

  *size_out = min_size;

  // We have to allocate a new block from the driver.  If the
  // allocation does not succeed, then we might be in an out-of-memory
  // situation.  We now start freeing things from the free list until
  // we think we have freed enough that the allocation will succeed.
  // Since we don't know how far the allocation is from fitting, we
  // have to check after every deallocation.  This might be pretty
  // expensive.  Let's hope that this case is hit rarely.

  if (ctx->cfg->debugging) {
    fprintf(log, "Actually allocating the desired block.\n");
  }

  int error = gpu_alloc_actual(ctx, min_size, mem_out);

  while (error == FUTHARK_OUT_OF_MEMORY) {
    if (ctx->cfg->debugging) {
      fprintf(log, "Out of GPU memory: releasing entry from the free list...\n");
    }
    gpu_mem* memptr;
    if (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
      gpu_mem mem = *memptr;
      free(memptr);
      error = gpu_free_actual(ctx, mem);
      if (error != FUTHARK_SUCCESS) {
        return error;
      }
    } else {
      break;
    }
    error = gpu_alloc_actual(ctx, min_size, mem_out);
  }

  return error;
}

static int gpu_free(struct futhark_context *ctx,
                    gpu_mem mem, size_t size, const char *tag) {
  gpu_mem* memptr = malloc(sizeof(gpu_mem));
  *memptr = mem;
  free_list_insert(&ctx->gpu_free_list, size, (fl_mem)memptr, tag);
  return FUTHARK_SUCCESS;
}

static int gpu_free_all(struct futhark_context *ctx) {
  free_list_pack(&ctx->gpu_free_list);
  gpu_mem* memptr;
  while (free_list_first(&ctx->gpu_free_list, (fl_mem*)&memptr) == 0) {
    gpu_mem mem = *memptr;
    free(memptr);
    int error = gpu_free_actual(ctx, mem);
    if (error != FUTHARK_SUCCESS) {
      return error;
    }
  }

  return FUTHARK_SUCCESS;
}

static int gpu_map_transpose(struct futhark_context* ctx,
                             gpu_kernel kernel_default,
                             gpu_kernel kernel_low_height,
                             gpu_kernel kernel_low_width,
                             gpu_kernel kernel_small,
                             gpu_kernel kernel_large,
                             const char *name, size_t elem_size,
                             gpu_mem dst, int64_t dst_offset,
                             gpu_mem src, int64_t src_offset,
                             int64_t k, int64_t n, int64_t m) {
  int64_t mulx = TR_BLOCK_DIM / n;
  int64_t muly = TR_BLOCK_DIM / m;
  int32_t mulx32 = mulx;
  int32_t muly32 = muly;
  int32_t k32 = k;
  int32_t n32 = n;
  int32_t m32 = m;

  gpu_kernel kernel = kernel_default;
  int32_t grid[3];
  int32_t block[3];

  void* args[11];
  size_t args_sizes[11] = {
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(gpu_mem), sizeof(int64_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t),
    sizeof(int32_t)
  };

  args[0] = &dst;
  args[1] = &dst_offset;
  args[2] = &src;
  args[3] = &src_offset;
  args[7] = &mulx;
  args[8] = &muly;

  if (dst_offset + k * n * m <= 2147483647L &&
      src_offset + k * n * m <= 2147483647L) {
    if (m <= TR_BLOCK_DIM/2 && n <= TR_BLOCK_DIM/2) {
      if (ctx->logging) { fprintf(ctx->log, "Using small kernel\n"); }
      kernel = kernel_small;
      grid[0] = ((k * n * m) + (TR_BLOCK_DIM*TR_BLOCK_DIM) - 1) / (TR_BLOCK_DIM*TR_BLOCK_DIM);
      grid[1] = 1;
      grid[2] = 1;
      block[0] = TR_BLOCK_DIM*TR_BLOCK_DIM;
      block[1] = 1;
      block[2] = 1;
    } else if (m <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < n) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-width kernel\n"); }
      kernel = kernel_low_width;
      int64_t x_elems = m;
      int64_t y_elems = (n + muly - 1) / muly;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else if (n <= TR_BLOCK_DIM/2 && TR_BLOCK_DIM < m) {
      if (ctx->logging) { fprintf(ctx->log, "Using low-height kernel\n"); }
      kernel = kernel_low_height;
      int64_t x_elems = (m + mulx - 1) / mulx;
      int64_t y_elems = n;
      grid[0] = (x_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[1] = (y_elems + TR_BLOCK_DIM - 1) / TR_BLOCK_DIM;
      grid[2] = k;
      block[0] = TR_BLOCK_DIM;
      block[1] = TR_BLOCK_DIM;
      block[2] = 1;
    } else {
      if (ctx->logging) { fprintf(ctx->log, "Using default kernel\n"); }
      kernel = kernel_default;
      grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
      grid[2] = k;
      block[0] = TR_TILE_DIM;
      block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
      block[2] = 1;
    }
    args[4] = &k32;
    args[5] = &m32;
    args[6] = &n32;
    args[7] = &mulx32;
    args[8] = &muly32;
  } else {
    if (ctx->logging) { fprintf(ctx->log, "Using large kernel\n"); }
    kernel = kernel_large;
    grid[0] = (m+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[1] = (n+TR_TILE_DIM-1)/TR_TILE_DIM;
    grid[2] = k;
    block[0] = TR_TILE_DIM;
    block[1] = TR_TILE_DIM/TR_ELEMS_PER_THREAD;
    block[2] = 1;
    args[4] = &k;
    args[5] = &m;
    args[6] = &n;
    args[7] = &mulx;
    args[8] = &muly;
    args_sizes[4] = sizeof(int64_t);
    args_sizes[5] = sizeof(int64_t);
    args_sizes[6] = sizeof(int64_t);
    args_sizes[7] = sizeof(int64_t);
    args_sizes[8] = sizeof(int64_t);
  }

  // Cap the number of thead blocks we launch and figure out how many
  // repeats we need alongside each dimension.
  int32_t repeat_1 = grid[1] / MAX_TR_THREAD_BLOCKS;
  int32_t repeat_2 = grid[2] / MAX_TR_THREAD_BLOCKS;
  grid[1] = repeat_1 > 0 ? MAX_TR_THREAD_BLOCKS : grid[1];
  grid[2] = repeat_2 > 0 ? MAX_TR_THREAD_BLOCKS : grid[2];
  args[9] = &repeat_1;
  args[10] = &repeat_2;
  args_sizes[9] = sizeof(repeat_1);
  args_sizes[10] = sizeof(repeat_2);

  if (ctx->logging) {
    fprintf(ctx->log, "\n");
  }

  return gpu_launch_kernel(ctx, kernel, name, grid, block,
                           TR_TILE_DIM*(TR_TILE_DIM+1)*elem_size,
                           sizeof(args)/sizeof(args[0]), args, args_sizes);
}

#define GEN_MAP_TRANSPOSE_GPU2GPU(NAME, ELEM_TYPE)                      \
  static int map_transpose_gpu2gpu_##NAME                               \
  (struct futhark_context* ctx,                                         \
   gpu_mem dst, int64_t dst_offset,                                     \
   gpu_mem src, int64_t src_offset,                                     \
   int64_t k, int64_t m, int64_t n)                                     \
  {                                                                     \
    return                                                              \
      gpu_map_transpose                                                 \
      (ctx,                                                             \
       ctx->kernels->map_transpose_##NAME,                              \
       ctx->kernels->map_transpose_##NAME##_low_height,                 \
       ctx->kernels->map_transpose_##NAME##_low_width,                  \
       ctx->kernels->map_transpose_##NAME##_small,                      \
       ctx->kernels->map_transpose_##NAME##_large,                      \
       "map_transpose_" #NAME, sizeof(ELEM_TYPE),                       \
       dst, dst_offset, src, src_offset,                                \
       k, n, m);                                                        \
  }

static int gpu_lmad_copy(struct futhark_context* ctx,
                         gpu_kernel kernel, int r,
                         gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                         gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                         int64_t shape[r]) {
  if (r > 8) {
    set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy array of greater than rank 8.\n"));
    return 1;
  }

  int64_t n = 1;
  for (int i = 0; i < r; i++) { n *= shape[i]; }

  void* args[6+(8*3)];
  size_t args_sizes[6+(8*3)];

  args[0] = &dst;
  args_sizes[0] = sizeof(gpu_mem);
  args[1] = &dst_offset;
  args_sizes[1] = sizeof(dst_offset);
  args[2] = &src;
  args_sizes[2] = sizeof(gpu_mem);
  args[3] = &src_offset;
  args_sizes[3] = sizeof(src_offset);
  args[4] = &n;
  args_sizes[4] = sizeof(n);
  args[5] = &r;
  args_sizes[5] = sizeof(r);

  int64_t zero = 0;

  for (int i = 0; i < 8; i++) {
    args_sizes[6+i*3] = sizeof(int64_t);
    args_sizes[6+i*3+1] = sizeof(int64_t);
    args_sizes[6+i*3+2] = sizeof(int64_t);
    if (i < r) {
      args[6+i*3] = &shape[i];
      args[6+i*3+1] = &dst_strides[i];
      args[6+i*3+2] = &src_strides[i];
    } else {
      args[6+i*3] = &zero;
      args[6+i*3+1] = &zero;
      args[6+i*3+2] = &zero;
    }
  }
  const size_t w = 256; // XXX: hardcoded thread block size.

  return gpu_launch_kernel(ctx, kernel, "copy_lmad_dev_to_dev",
                           (const int32_t[3]) {(n+w-1)/w,1,1},
                           (const int32_t[3]) {w,1,1},
                           0, 6+(8*3), args, args_sizes);
}

#define GEN_LMAD_COPY_ELEMENTS_GPU2GPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return gpu_lmad_copy(ctx, ctx->kernels->lmad_copy_##NAME, r,        \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \

#define GEN_LMAD_COPY_GPU2GPU(NAME, ELEM_TYPE)                          \
  static int lmad_copy_gpu2gpu_##NAME                                   \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "GPU to GPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return FUTHARK_SUCCESS; }                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                       r, dst_strides, src_strides, shape)) {           \
      log_transpose(ctx, k, n, m);                                      \
      return map_transpose_gpu2gpu_##NAME                               \
        (ctx, dst, dst_offset, src, src_offset, k, n, m);               \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}        \
      return gpu_memcpy(ctx,                                            \
                        dst, dst_offset*sizeof(ELEM_TYPE),              \
                        src, src_offset*sizeof(ELEM_TYPE),              \
                        size * sizeof(ELEM_TYPE));                      \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}     \
      return lmad_copy_elements_gpu2gpu_##NAME                          \
        (ctx, r,                                                        \
         dst, dst_offset, dst_strides,                                  \
         src, src_offset, src_strides,                                  \
         shape);                                                        \
    }                                                                   \
  }

static int
lmad_copy_elements_host2gpu(struct futhark_context *ctx, size_t elem_size,
                            int r,
                            gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                            unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                            int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from host to GPU.\n"));
  return 1;
}

static int
lmad_copy_elements_gpu2host (struct futhark_context *ctx, size_t elem_size,
                             int r,
                             unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                             gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                             int64_t shape[r]) {
  (void)ctx; (void)elem_size; (void)r;
  (void)dst; (void)dst_offset; (void)dst_strides;
  (void)src; (void)src_offset; (void)src_strides;
  (void)shape;
  set_error(ctx, strdup("Futhark runtime limitation:\nCannot copy unstructured array from GPU to host.\n"));
  return 1;
}

#define GEN_LMAD_COPY_ELEMENTS_HOSTGPU(NAME, ELEM_TYPE)                 \
  static int lmad_copy_elements_gpu2gpu_##NAME                          \
  (struct futhark_context* ctx,                                         \
   int r,                                                               \
   gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],             \
   gpu_mem src, int64_t src_offset, int64_t src_strides[r],             \
   int64_t shape[r]) {                                                  \
    return (ctx, ctx->kernels->lmad_copy_##NAME, r,                     \
                         dst, dst_offset, dst_strides,                  \
                         src, src_offset, src_strides,                  \
                         shape);                                        \
  }                                                                     \


static int lmad_copy_host2gpu(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              gpu_mem dst, int64_t dst_offset, int64_t dst_strides[r],
                              unsigned char* src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_host2gpu(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_host2gpu
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

static int lmad_copy_gpu2host(struct futhark_context* ctx, size_t elem_size, bool sync,
                              int r,
                              unsigned char* dst, int64_t dst_offset, int64_t dst_strides[r],
                              gpu_mem src, int64_t src_offset, int64_t src_strides[r],
                              int64_t shape[r]) {
  log_copy(ctx, "Host to GPU", r, dst_offset, dst_strides,
           src_offset, src_strides, shape);
  int64_t size = elem_size;
  for (int i = 0; i < r; i++) { size *= shape[i]; }
  if (size == 0) { return FUTHARK_SUCCESS; }
  int64_t k, n, m;
  if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {
    if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}
    return memcpy_gpu2host(ctx, sync,
                           dst, dst_offset*elem_size,
                           src, src_offset*elem_size,
                           size);
  } else {
    if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}
    int error;
    error = lmad_copy_elements_gpu2host
      (ctx, elem_size, r,
       dst, dst_offset, dst_strides,
       src, src_offset, src_strides,
       shape);
    if (error == 0 && sync) {
      error = futhark_context_sync(ctx);
    }
    return error;
  }
}

GEN_MAP_TRANSPOSE_GPU2GPU(1b, uint8_t)
GEN_MAP_TRANSPOSE_GPU2GPU(2b, uint16_t)
GEN_MAP_TRANSPOSE_GPU2GPU(4b, uint32_t)
GEN_MAP_TRANSPOSE_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS_GPU2GPU(8b, uint64_t)

GEN_LMAD_COPY_GPU2GPU(1b, uint8_t)
GEN_LMAD_COPY_GPU2GPU(2b, uint16_t)
GEN_LMAD_COPY_GPU2GPU(4b, uint32_t)
GEN_LMAD_COPY_GPU2GPU(8b, uint64_t)

// End of gpu.h

static int gpu_macros(struct futhark_context *ctx, char ***names_out, int64_t **values_out)
{
    int num_macros = 190;
    char **names = malloc(num_macros * sizeof(char *));
    int64_t *values = malloc(num_macros * sizeof(int64_t));
    
    {
        names[0] = "sortColumn_shortzisegmap_44903_dim1";
        values[0] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44885;
    }
    {
        names[1] = "sortColumn_shortzisegmap_44903zisegmap_tblock_sizze_44898";
        values[1] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44885;
    }
    {
        names[2] = "sortColumn_shortzisegmap_44875_dim1";
        values[2] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44877;
    }
    {
        names[3] = "sortColumn_shortzisegmap_44875zisegmap_tblock_sizze_44878";
        values[3] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44877;
    }
    {
        names[4] = "sortColumn_shortzisegmap_44869_dim1";
        values[4] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44855;
    }
    {
        names[5] = "sortColumn_shortzisegmap_44869zisegmap_tblock_sizze_44865";
        values[5] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44855;
    }
    {
        names[6] = "sortColumn_shortzisegscan_44851_dim1";
        values[6] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44845;
    }
    {
        names[7] = "sortColumn_shortzisegscan_44851zisegscan_tblock_sizze_44846";
        values[7] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44845;
    }
    {
        names[8] = "sortColumn_shortzisegscan_44851zichunk_sizze_48873";
        values[8] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[9] = "sortColumn_shortzisegmap_44459_dim1";
        values[9] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44447;
    }
    {
        names[10] = "sortColumn_shortzisegmap_44459zisegmap_tblock_sizze_44455";
        values[10] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44447;
    }
    {
        names[11] = "sortColumn_shortzigpuseq_48854_dim1";
        values[11] = (int64_t) 1;
    }
    {
        names[12] = "sortColumn_shortzisegmap_44833_dim1";
        values[12] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44568;
    }
    {
        names[13] = "sortColumn_shortzisegmap_44833zisegmap_tblock_sizze_44828";
        values[13] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44568;
    }
    {
        names[14] = "sortColumn_shortzisegmap_44823_dim1";
        values[14] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44595;
    }
    {
        names[15] = "sortColumn_shortzisegmap_44823zisegmap_tblock_sizze_44818";
        values[15] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44595;
    }
    {
        names[16] = "sortColumn_shortzisegmap_44806_dim1";
        values[16] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44617;
    }
    {
        names[17] = "sortColumn_shortzisegmap_44806zisegmap_tblock_sizze_44801";
        values[17] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44617;
    }
    {
        names[18] = "sortColumn_shortzisegmap_44788_dim1";
        values[18] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44639;
    }
    {
        names[19] = "sortColumn_shortzisegmap_44788zisegmap_tblock_sizze_44781";
        values[19] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44639;
    }
    {
        names[20] = "sortColumn_shortzisegmap_44766_dim1";
        values[20] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44661;
    }
    {
        names[21] = "sortColumn_shortzisegmap_44766zisegmap_tblock_sizze_44759";
        values[21] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44661;
    }
    {
        names[22] = "sortColumn_shortzisegscan_44730_dim1";
        values[22] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44681;
    }
    {
        names[23] = "sortColumn_shortzisegscan_44730zisegscan_tblock_sizze_44720";
        values[23] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44681;
    }
    {
        names[24] = "sortColumn_shortzisegscan_44730zichunk_sizze_48529";
        values[24] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[25] = "sortColumn_shortzisegmap_44437_dim1";
        values[25] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44439;
    }
    {
        names[26] = "sortColumn_shortzisegmap_44437zisegmap_tblock_sizze_44440";
        values[26] = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44439;
    }
    {
        names[27] = "sortColumn_shortzigpuseq_48446_dim1";
        values[27] = (int64_t) 1;
    }
    {
        names[28] = "sortColumn_shortzisegscan_44435_dim1";
        values[28] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44429;
    }
    {
        names[29] = "sortColumn_shortzisegscan_44435zisegscan_tblock_sizze_44430";
        values[29] = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44429;
    }
    {
        names[30] = "sortColumn_shortzisegscan_44435zichunk_sizze_48138";
        values[30] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[31] = "sortColumn_longzisegmap_45386_dim1";
        values[31] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45368;
    }
    {
        names[32] = "sortColumn_longzisegmap_45386zisegmap_tblock_sizze_45381";
        values[32] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45368;
    }
    {
        names[33] = "sortColumn_longzisegmap_45358_dim1";
        values[33] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45360;
    }
    {
        names[34] = "sortColumn_longzisegmap_45358zisegmap_tblock_sizze_45361";
        values[34] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45360;
    }
    {
        names[35] = "sortColumn_longzisegmap_45352_dim1";
        values[35] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45338;
    }
    {
        names[36] = "sortColumn_longzisegmap_45352zisegmap_tblock_sizze_45348";
        values[36] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45338;
    }
    {
        names[37] = "sortColumn_longzisegscan_45334_dim1";
        values[37] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45328;
    }
    {
        names[38] = "sortColumn_longzisegscan_45334zisegscan_tblock_sizze_45329";
        values[38] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45328;
    }
    {
        names[39] = "sortColumn_longzisegscan_45334zichunk_sizze_48873";
        values[39] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[40] = "sortColumn_longzisegmap_44942_dim1";
        values[40] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44930;
    }
    {
        names[41] = "sortColumn_longzisegmap_44942zisegmap_tblock_sizze_44938";
        values[41] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44930;
    }
    {
        names[42] = "sortColumn_longzigpuseq_48854_dim1";
        values[42] = (int64_t) 1;
    }
    {
        names[43] = "sortColumn_longzisegmap_45316_dim1";
        values[43] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45051;
    }
    {
        names[44] = "sortColumn_longzisegmap_45316zisegmap_tblock_sizze_45311";
        values[44] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45051;
    }
    {
        names[45] = "sortColumn_longzisegmap_45306_dim1";
        values[45] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45078;
    }
    {
        names[46] = "sortColumn_longzisegmap_45306zisegmap_tblock_sizze_45301";
        values[46] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45078;
    }
    {
        names[47] = "sortColumn_longzisegmap_45289_dim1";
        values[47] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45100;
    }
    {
        names[48] = "sortColumn_longzisegmap_45289zisegmap_tblock_sizze_45284";
        values[48] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45100;
    }
    {
        names[49] = "sortColumn_longzisegmap_45271_dim1";
        values[49] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45122;
    }
    {
        names[50] = "sortColumn_longzisegmap_45271zisegmap_tblock_sizze_45264";
        values[50] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45122;
    }
    {
        names[51] = "sortColumn_longzisegmap_45249_dim1";
        values[51] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45144;
    }
    {
        names[52] = "sortColumn_longzisegmap_45249zisegmap_tblock_sizze_45242";
        values[52] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45144;
    }
    {
        names[53] = "sortColumn_longzisegscan_45213_dim1";
        values[53] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45164;
    }
    {
        names[54] = "sortColumn_longzisegscan_45213zisegscan_tblock_sizze_45203";
        values[54] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45164;
    }
    {
        names[55] = "sortColumn_longzisegscan_45213zichunk_sizze_48529";
        values[55] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[56] = "sortColumn_longzisegmap_44920_dim1";
        values[56] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44922;
    }
    {
        names[57] = "sortColumn_longzisegmap_44920zisegmap_tblock_sizze_44923";
        values[57] = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44922;
    }
    {
        names[58] = "sortColumn_longzigpuseq_48446_dim1";
        values[58] = (int64_t) 1;
    }
    {
        names[59] = "sortColumn_longzisegscan_44918_dim1";
        values[59] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_44912;
    }
    {
        names[60] = "sortColumn_longzisegscan_44918zisegscan_tblock_sizze_44913";
        values[60] = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_44912;
    }
    {
        names[61] = "sortColumn_longzisegscan_44918zichunk_sizze_48138";
        values[61] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[62] = "sortColumn_intzisegmap_46916_dim1";
        values[62] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46898;
    }
    {
        names[63] = "sortColumn_intzisegmap_46916zisegmap_tblock_sizze_46911";
        values[63] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46898;
    }
    {
        names[64] = "sortColumn_intzisegmap_46888_dim1";
        values[64] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46890;
    }
    {
        names[65] = "sortColumn_intzisegmap_46888zisegmap_tblock_sizze_46891";
        values[65] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46890;
    }
    {
        names[66] = "sortColumn_intzisegmap_46882_dim1";
        values[66] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46868;
    }
    {
        names[67] = "sortColumn_intzisegmap_46882zisegmap_tblock_sizze_46878";
        values[67] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46868;
    }
    {
        names[68] = "sortColumn_intzisegscan_46864_dim1";
        values[68] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46858;
    }
    {
        names[69] = "sortColumn_intzisegscan_46864zisegscan_tblock_sizze_46859";
        values[69] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46858;
    }
    {
        names[70] = "sortColumn_intzisegscan_46864zichunk_sizze_48873";
        values[70] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[71] = "sortColumn_intzisegmap_46466_dim1";
        values[71] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46454;
    }
    {
        names[72] = "sortColumn_intzisegmap_46466zisegmap_tblock_sizze_46462";
        values[72] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46454;
    }
    {
        names[73] = "sortColumn_intzigpuseq_48854_dim1";
        values[73] = (int64_t) 1;
    }
    {
        names[74] = "sortColumn_intzisegmap_46846_dim1";
        values[74] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46577;
    }
    {
        names[75] = "sortColumn_intzisegmap_46846zisegmap_tblock_sizze_46841";
        values[75] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46577;
    }
    {
        names[76] = "sortColumn_intzisegmap_46836_dim1";
        values[76] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46604;
    }
    {
        names[77] = "sortColumn_intzisegmap_46836zisegmap_tblock_sizze_46831";
        values[77] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46604;
    }
    {
        names[78] = "sortColumn_intzisegmap_46819_dim1";
        values[78] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46626;
    }
    {
        names[79] = "sortColumn_intzisegmap_46819zisegmap_tblock_sizze_46814";
        values[79] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46626;
    }
    {
        names[80] = "sortColumn_intzisegmap_46801_dim1";
        values[80] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46648;
    }
    {
        names[81] = "sortColumn_intzisegmap_46801zisegmap_tblock_sizze_46794";
        values[81] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46648;
    }
    {
        names[82] = "sortColumn_intzisegmap_46779_dim1";
        values[82] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46670;
    }
    {
        names[83] = "sortColumn_intzisegmap_46779zisegmap_tblock_sizze_46772";
        values[83] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46670;
    }
    {
        names[84] = "sortColumn_intzisegscan_46741_dim1";
        values[84] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46690;
    }
    {
        names[85] = "sortColumn_intzisegscan_46741zisegscan_tblock_sizze_46731";
        values[85] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46690;
    }
    {
        names[86] = "sortColumn_intzisegscan_46741zichunk_sizze_48529";
        values[86] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[87] = "sortColumn_intzisegmap_46444_dim1";
        values[87] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46446;
    }
    {
        names[88] = "sortColumn_intzisegmap_46444zisegmap_tblock_sizze_46447";
        values[88] = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46446;
    }
    {
        names[89] = "sortColumn_intzigpuseq_48446_dim1";
        values[89] = (int64_t) 1;
    }
    {
        names[90] = "sortColumn_intzisegscan_46442_dim1";
        values[90] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46436;
    }
    {
        names[91] = "sortColumn_intzisegscan_46442zisegscan_tblock_sizze_46437";
        values[91] = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46436;
    }
    {
        names[92] = "sortColumn_intzisegscan_46442zichunk_sizze_48138";
        values[92] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[93] = "sortColumn_floatzisegmap_45902_dim1";
        values[93] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45884;
    }
    {
        names[94] = "sortColumn_floatzisegmap_45902zisegmap_tblock_sizze_45897";
        values[94] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45884;
    }
    {
        names[95] = "sortColumn_floatzisegmap_45874_dim1";
        values[95] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45876;
    }
    {
        names[96] = "sortColumn_floatzisegmap_45874zisegmap_tblock_sizze_45877";
        values[96] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45876;
    }
    {
        names[97] = "sortColumn_floatzisegmap_45868_dim1";
        values[97] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45854;
    }
    {
        names[98] = "sortColumn_floatzisegmap_45868zisegmap_tblock_sizze_45864";
        values[98] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45854;
    }
    {
        names[99] = "sortColumn_floatzisegscan_45850_dim1";
        values[99] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45844;
    }
    {
        names[100] = "sortColumn_floatzisegscan_45850zisegscan_tblock_sizze_45845";
        values[100] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45844;
    }
    {
        names[101] = "sortColumn_floatzisegscan_45850zichunk_sizze_48873";
        values[101] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[102] = "sortColumn_floatzisegmap_45425_dim1";
        values[102] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45413;
    }
    {
        names[103] = "sortColumn_floatzisegmap_45425zisegmap_tblock_sizze_45421";
        values[103] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45413;
    }
    {
        names[104] = "sortColumn_floatzigpuseq_48854_dim1";
        values[104] = (int64_t) 1;
    }
    {
        names[105] = "sortColumn_floatzisegmap_45832_dim1";
        values[105] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45545;
    }
    {
        names[106] = "sortColumn_floatzisegmap_45832zisegmap_tblock_sizze_45827";
        values[106] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45545;
    }
    {
        names[107] = "sortColumn_floatzisegmap_45822_dim1";
        values[107] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45572;
    }
    {
        names[108] = "sortColumn_floatzisegmap_45822zisegmap_tblock_sizze_45817";
        values[108] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45572;
    }
    {
        names[109] = "sortColumn_floatzisegmap_45805_dim1";
        values[109] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45594;
    }
    {
        names[110] = "sortColumn_floatzisegmap_45805zisegmap_tblock_sizze_45800";
        values[110] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45594;
    }
    {
        names[111] = "sortColumn_floatzisegmap_45787_dim1";
        values[111] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45616;
    }
    {
        names[112] = "sortColumn_floatzisegmap_45787zisegmap_tblock_sizze_45780";
        values[112] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45616;
    }
    {
        names[113] = "sortColumn_floatzisegmap_45765_dim1";
        values[113] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45638;
    }
    {
        names[114] = "sortColumn_floatzisegmap_45765zisegmap_tblock_sizze_45758";
        values[114] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45638;
    }
    {
        names[115] = "sortColumn_floatzisegscan_45718_dim1";
        values[115] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45658;
    }
    {
        names[116] = "sortColumn_floatzisegscan_45718zisegscan_tblock_sizze_45708";
        values[116] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45658;
    }
    {
        names[117] = "sortColumn_floatzisegscan_45718zichunk_sizze_48529";
        values[117] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[118] = "sortColumn_floatzisegmap_45403_dim1";
        values[118] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45405;
    }
    {
        names[119] = "sortColumn_floatzisegmap_45403zisegmap_tblock_sizze_45406";
        values[119] = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45405;
    }
    {
        names[120] = "sortColumn_floatzigpuseq_48446_dim1";
        values[120] = (int64_t) 1;
    }
    {
        names[121] = "sortColumn_floatzisegscan_45401_dim1";
        values[121] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45395;
    }
    {
        names[122] = "sortColumn_floatzisegscan_45401zisegscan_tblock_sizze_45396";
        values[122] = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45395;
    }
    {
        names[123] = "sortColumn_floatzisegscan_45401zichunk_sizze_48138";
        values[123] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[124] = "sortColumn_doublezisegmap_46427_dim1";
        values[124] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46409;
    }
    {
        names[125] = "sortColumn_doublezisegmap_46427zisegmap_tblock_sizze_46422";
        values[125] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46409;
    }
    {
        names[126] = "sortColumn_doublezisegmap_46399_dim1";
        values[126] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46401;
    }
    {
        names[127] = "sortColumn_doublezisegmap_46399zisegmap_tblock_sizze_46402";
        values[127] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46401;
    }
    {
        names[128] = "sortColumn_doublezisegmap_46393_dim1";
        values[128] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46379;
    }
    {
        names[129] = "sortColumn_doublezisegmap_46393zisegmap_tblock_sizze_46389";
        values[129] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46379;
    }
    {
        names[130] = "sortColumn_doublezisegscan_46375_dim1";
        values[130] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46369;
    }
    {
        names[131] = "sortColumn_doublezisegscan_46375zisegscan_tblock_sizze_46370";
        values[131] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46369;
    }
    {
        names[132] = "sortColumn_doublezisegscan_46375zichunk_sizze_48873";
        values[132] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 8), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
    }
    {
        names[133] = "sortColumn_doublezisegmap_45941_dim1";
        values[133] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45929;
    }
    {
        names[134] = "sortColumn_doublezisegmap_45941zisegmap_tblock_sizze_45937";
        values[134] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45929;
    }
    {
        names[135] = "sortColumn_doublezigpuseq_48854_dim1";
        values[135] = (int64_t) 1;
    }
    {
        names[136] = "sortColumn_doublezisegmap_46357_dim1";
        values[136] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46064;
    }
    {
        names[137] = "sortColumn_doublezisegmap_46357zisegmap_tblock_sizze_46352";
        values[137] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46064;
    }
    {
        names[138] = "sortColumn_doublezisegmap_46347_dim1";
        values[138] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46091;
    }
    {
        names[139] = "sortColumn_doublezisegmap_46347zisegmap_tblock_sizze_46342";
        values[139] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46091;
    }
    {
        names[140] = "sortColumn_doublezisegmap_46330_dim1";
        values[140] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46113;
    }
    {
        names[141] = "sortColumn_doublezisegmap_46330zisegmap_tblock_sizze_46325";
        values[141] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46113;
    }
    {
        names[142] = "sortColumn_doublezisegmap_46312_dim1";
        values[142] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46135;
    }
    {
        names[143] = "sortColumn_doublezisegmap_46312zisegmap_tblock_sizze_46305";
        values[143] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46135;
    }
    {
        names[144] = "sortColumn_doublezisegmap_46290_dim1";
        values[144] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46157;
    }
    {
        names[145] = "sortColumn_doublezisegmap_46290zisegmap_tblock_sizze_46283";
        values[145] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46157;
    }
    {
        names[146] = "sortColumn_doublezisegscan_46240_dim1";
        values[146] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46177;
    }
    {
        names[147] = "sortColumn_doublezisegscan_46240zisegscan_tblock_sizze_46230";
        values[147] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46177;
    }
    {
        names[148] = "sortColumn_doublezisegscan_46240zichunk_sizze_48529";
        values[148] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[149] = "sortColumn_doublezisegmap_45919_dim1";
        values[149] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45921;
    }
    {
        names[150] = "sortColumn_doublezisegmap_45919zisegmap_tblock_sizze_45922";
        values[150] = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45921;
    }
    {
        names[151] = "sortColumn_doublezigpuseq_48446_dim1";
        values[151] = (int64_t) 1;
    }
    {
        names[152] = "sortColumn_doublezisegscan_45917_dim1";
        values[152] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_45911;
    }
    {
        names[153] = "sortColumn_doublezisegscan_45917zisegscan_tblock_sizze_45912";
        values[153] = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_45911;
    }
    {
        names[154] = "sortColumn_doublezisegscan_45917zichunk_sizze_48138";
        values[154] = smax64((int64_t) 1, smin64(squot64(squot64(ctx->max_shared_memory, ctx->max_thread_block_size), (int64_t) 2), squot64(squot64(ctx->max_registers, ctx->max_thread_block_size) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
    }
    {
        names[155] = "partitionFunczisegmap_43943_dim1";
        values[155] = *ctx->tuning_params.partitionFunczisegmap_tblock_sizze_43861;
    }
    {
        names[156] = "partitionFunczisegmap_43943zisegmap_tblock_sizze_43938";
        values[156] = *ctx->tuning_params.partitionFunczisegmap_tblock_sizze_43861;
    }
    {
        names[157] = "orderByIndices_shortzisegmap_44308_dim1";
        values[157] = *ctx->tuning_params.orderByIndices_shortzisegmap_tblock_sizze_44291;
    }
    {
        names[158] = "orderByIndices_shortzisegmap_44308zisegmap_tblock_sizze_44304";
        values[158] = *ctx->tuning_params.orderByIndices_shortzisegmap_tblock_sizze_44291;
    }
    {
        names[159] = "orderByIndices_longzisegmap_44364_dim1";
        values[159] = *ctx->tuning_params.orderByIndices_longzisegmap_tblock_sizze_44347;
    }
    {
        names[160] = "orderByIndices_longzisegmap_44364zisegmap_tblock_sizze_44360";
        values[160] = *ctx->tuning_params.orderByIndices_longzisegmap_tblock_sizze_44347;
    }
    {
        names[161] = "orderByIndices_intzisegmap_44336_dim1";
        values[161] = *ctx->tuning_params.orderByIndices_intzisegmap_tblock_sizze_44319;
    }
    {
        names[162] = "orderByIndices_intzisegmap_44336zisegmap_tblock_sizze_44332";
        values[162] = *ctx->tuning_params.orderByIndices_intzisegmap_tblock_sizze_44319;
    }
    {
        names[163] = "orderByIndices_floatzisegmap_44392_dim1";
        values[163] = *ctx->tuning_params.orderByIndices_floatzisegmap_tblock_sizze_44375;
    }
    {
        names[164] = "orderByIndices_floatzisegmap_44392zisegmap_tblock_sizze_44388";
        values[164] = *ctx->tuning_params.orderByIndices_floatzisegmap_tblock_sizze_44375;
    }
    {
        names[165] = "orderByIndices_doublezisegmap_44420_dim1";
        values[165] = *ctx->tuning_params.orderByIndices_doublezisegmap_tblock_sizze_44403;
    }
    {
        names[166] = "orderByIndices_doublezisegmap_44420zisegmap_tblock_sizze_44416";
        values[166] = *ctx->tuning_params.orderByIndices_doublezisegmap_tblock_sizze_44403;
    }
    {
        names[167] = "mergeFunczisegmap_intrablock_47382_dim1";
        values[167] = *ctx->tuning_params.mergeFunczitile_sizze_47383;
    }
    {
        names[168] = "mergeFunczisegmap_intrablock_47382zitile_sizze_47384";
        values[168] = *ctx->tuning_params.mergeFunczitile_sizze_47383;
    }
    {
        names[169] = "mergeFunczisegmap_intrablock_47382zibytes_47866";
        values[169] = (int64_t) 8 * *ctx->tuning_params.mergeFunczitile_sizze_47383;
    }
    {
        names[170] = "mergeFunczisegmap_intrablock_47382zibytes_47868";
        values[170] = (int64_t) 4 * *ctx->tuning_params.mergeFunczitile_sizze_47383;
    }
    {
        names[171] = "mergeFunczisegmap_intrablock_46987_dim1";
        values[171] = *ctx->tuning_params.mergeFunczitile_sizze_46988;
    }
    {
        names[172] = "mergeFunczisegmap_intrablock_46987zitile_sizze_46989";
        values[172] = *ctx->tuning_params.mergeFunczitile_sizze_46988;
    }
    {
        names[173] = "mergeFunczisegmap_intrablock_46987zibytes_47934";
        values[173] = (int64_t) 8 * *ctx->tuning_params.mergeFunczitile_sizze_46988;
    }
    {
        names[174] = "mergeFunczisegmap_intrablock_46987zibytes_47936";
        values[174] = (int64_t) 4 * *ctx->tuning_params.mergeFunczitile_sizze_46988;
    }
    {
        names[175] = "argmin_shortzisegred_nonseg_44025_dim1";
        values[175] = *ctx->tuning_params.argmin_shortzisegred_tblock_sizze_44016;
    }
    {
        names[176] = "argmin_shortzisegred_nonseg_44025zisegred_tblock_sizze_44017";
        values[176] = *ctx->tuning_params.argmin_shortzisegred_tblock_sizze_44016;
    }
    {
        names[177] = "argmin_shortzisegred_nonseg_44025zichunk_sizze_48105";
        values[177] = (int64_t) 1;
    }
    {
        names[178] = "argmin_longzisegred_nonseg_44047_dim1";
        values[178] = *ctx->tuning_params.argmin_longzisegred_tblock_sizze_44038;
    }
    {
        names[179] = "argmin_longzisegred_nonseg_44047zisegred_tblock_sizze_44039";
        values[179] = *ctx->tuning_params.argmin_longzisegred_tblock_sizze_44038;
    }
    {
        names[180] = "argmin_longzisegred_nonseg_44047zichunk_sizze_48105";
        values[180] = (int64_t) 1;
    }
    {
        names[181] = "argmin_intzisegred_nonseg_44036_dim1";
        values[181] = *ctx->tuning_params.argmin_intzisegred_tblock_sizze_44027;
    }
    {
        names[182] = "argmin_intzisegred_nonseg_44036zisegred_tblock_sizze_44028";
        values[182] = *ctx->tuning_params.argmin_intzisegred_tblock_sizze_44027;
    }
    {
        names[183] = "argmin_intzisegred_nonseg_44036zichunk_sizze_48105";
        values[183] = (int64_t) 1;
    }
    {
        names[184] = "argmin_floatzisegred_nonseg_44058_dim1";
        values[184] = *ctx->tuning_params.argmin_floatzisegred_tblock_sizze_44049;
    }
    {
        names[185] = "argmin_floatzisegred_nonseg_44058zisegred_tblock_sizze_44050";
        values[185] = *ctx->tuning_params.argmin_floatzisegred_tblock_sizze_44049;
    }
    {
        names[186] = "argmin_floatzisegred_nonseg_44058zichunk_sizze_48105";
        values[186] = (int64_t) 1;
    }
    {
        names[187] = "argmin_doublezisegred_nonseg_44069_dim1";
        values[187] = *ctx->tuning_params.argmin_doublezisegred_tblock_sizze_44060;
    }
    {
        names[188] = "argmin_doublezisegred_nonseg_44069zisegred_tblock_sizze_44061";
        values[188] = *ctx->tuning_params.argmin_doublezisegred_tblock_sizze_44060;
    }
    {
        names[189] = "argmin_doublezisegred_nonseg_44069zichunk_sizze_48105";
        values[189] = (int64_t) 1;
    }
    *names_out = names;
    *values_out = values;
    return num_macros;
}
static char *get_failure_msg(int failure_idx, int64_t args[])
{
    (void) args;
    switch (failure_idx) {
        
      case 0:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:40:20-25\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:40:9-26\n   #3  ftsort.fut:12:9-15\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftsort.fut:12:9-18\n   #6  ftsort.fut:49:12-26\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftsort.fut:47:1-49:36\n", args[0], args[1]);
            break;
        }
        
      case 1:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:40:20-25\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:40:9-26\n   #3  ftsort.fut:12:9-15\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftsort.fut:12:9-18\n   #6  ftsort.fut:45:12-26\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftsort.fut:43:1-45:36\n", args[0], args[1]);
            break;
        }
        
      case 2:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:40:20-25\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:40:9-26\n   #3  ftsort.fut:12:9-15\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftsort.fut:12:9-18\n   #6  ftsort.fut:37:12-26\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftsort.fut:35:1-37:36\n", args[0], args[1]);
            break;
        }
        
      case 3:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:40:20-25\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:40:9-26\n   #3  ftsort.fut:12:9-15\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftsort.fut:12:9-18\n   #6  ftsort.fut:41:12-26\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftsort.fut:39:1-41:36\n", args[0], args[1]);
            break;
        }
        
      case 4:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftbasics.fut:40:20-25\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:40:9-26\n   #3  ftsort.fut:12:9-15\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftsort.fut:12:9-18\n   #6  ftsort.fut:33:12-26\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftsort.fut:31:1-33:36\n", args[0], args[1]);
            break;
        }
        
      case 5:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:106:47-53\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:93:38-119:6\n   #3  ftsort.fut:89:1-120:43\n", args[0], args[1]);
            break;
        }
        
      case 6:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:107:36-44\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:93:38-119:6\n   #3  ftsort.fut:89:1-120:43\n", args[0], args[1]);
            break;
        }
        
      case 7:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:108:47-53\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:93:38-119:6\n   #3  ftsort.fut:89:1-120:43\n", args[0], args[1]);
            break;
        }
        
      case 8:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  ftsort.fut:109:36-44\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:93:38-119:6\n   #3  ftsort.fut:89:1-120:43\n", args[0], args[1]);
            break;
        }
        
      case 9:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-48\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n", args[0], args[1]);
            break;
        }
        
      case 10:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-53\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n", args[0], args[1]);
            break;
        }
        
      case 11:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:68:27-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:68:6-33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #4  ftbasics.fut:175:95-98\n   #5  ftsort.fut:28:3-47\n   #6  ftsort.fut:27:1-28:47\n", args[0], args[1]);
            break;
        }
        
      case 12:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-48\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n", args[0], args[1]);
            break;
        }
        
      case 13:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-53\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n", args[0], args[1]);
            break;
        }
        
      case 14:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:68:27-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:68:6-33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #4  ftbasics.fut:175:95-98\n   #5  ftsort.fut:25:3-46\n   #6  ftsort.fut:24:1-25:46\n", args[0], args[1]);
            break;
        }
        
      case 15:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-48\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:19:3-44\n   #10 ftsort.fut:18:1-19:44\n", args[0], args[1]);
            break;
        }
        
      case 16:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-53\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:19:3-44\n   #10 ftsort.fut:18:1-19:44\n", args[0], args[1]);
            break;
        }
        
      case 17:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:68:27-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:68:6-33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:19:3-44\n   #6  ftsort.fut:18:1-19:44\n", args[0], args[1]);
            break;
        }
        
      case 18:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-48\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:22:3-45\n   #10 ftsort.fut:21:1-22:45\n", args[0], args[1]);
            break;
        }
        
      case 19:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-53\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:22:3-45\n   #10 ftsort.fut:21:1-22:45\n", args[0], args[1]);
            break;
        }
        
      case 20:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:68:27-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:68:6-33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:22:3-45\n   #6  ftsort.fut:21:1-22:45\n", args[0], args[1]);
            break;
        }
        
      case 21:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-48\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:16:3-46\n   #10 ftsort.fut:15:1-16:46\n", args[0], args[1]);
            break;
        }
        
      case 22:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:187:26-53\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:16:3-46\n   #10 ftsort.fut:15:1-16:46\n", args[0], args[1]);
            break;
        }
        
      case 23:
        {
            return msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:68:27-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:68:6-33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:16:3-46\n   #6  ftsort.fut:15:1-16:46\n", args[0], args[1]);
            break;
        }
    }
    return strdup("Unknown error.  This is a compiler bug.");
}
struct program {
    int dummy;
    gpu_kernel argmin_doublezisegred_nonseg_44069;
    gpu_kernel argmin_floatzisegred_nonseg_44058;
    gpu_kernel argmin_intzisegred_nonseg_44036;
    gpu_kernel argmin_longzisegred_nonseg_44047;
    gpu_kernel argmin_shortzisegred_nonseg_44025;
    gpu_kernel builtinzhiota_i64ziiota_i64_48110;
    gpu_kernel builtinzhreplicate_i16zireplicate_48431;
    gpu_kernel builtinzhreplicate_i32zireplicate_48186;
    gpu_kernel builtinzhreplicate_i8zireplicate_48148;
    gpu_kernel mergeFunczisegmap_intrablock_46987;
    gpu_kernel mergeFunczisegmap_intrablock_47382;
    gpu_kernel orderByIndices_doublezisegmap_44420;
    gpu_kernel orderByIndices_floatzisegmap_44392;
    gpu_kernel orderByIndices_intzisegmap_44336;
    gpu_kernel orderByIndices_longzisegmap_44364;
    gpu_kernel orderByIndices_shortzisegmap_44308;
    gpu_kernel partitionFunczisegmap_43943;
    gpu_kernel sortColumn_doublezigpuseq_48446;
    gpu_kernel sortColumn_doublezigpuseq_48854;
    gpu_kernel sortColumn_doublezisegmap_45919;
    gpu_kernel sortColumn_doublezisegmap_45941;
    gpu_kernel sortColumn_doublezisegmap_46290;
    gpu_kernel sortColumn_doublezisegmap_46312;
    gpu_kernel sortColumn_doublezisegmap_46330;
    gpu_kernel sortColumn_doublezisegmap_46347;
    gpu_kernel sortColumn_doublezisegmap_46357;
    gpu_kernel sortColumn_doublezisegmap_46393;
    gpu_kernel sortColumn_doublezisegmap_46399;
    gpu_kernel sortColumn_doublezisegmap_46427;
    gpu_kernel sortColumn_doublezisegmap_intrablock_45973;
    gpu_kernel sortColumn_doublezisegscan_45917;
    gpu_kernel sortColumn_doublezisegscan_46240;
    gpu_kernel sortColumn_doublezisegscan_46375;
    gpu_kernel sortColumn_floatzigpuseq_48446;
    gpu_kernel sortColumn_floatzigpuseq_48854;
    gpu_kernel sortColumn_floatzisegmap_45403;
    gpu_kernel sortColumn_floatzisegmap_45425;
    gpu_kernel sortColumn_floatzisegmap_45765;
    gpu_kernel sortColumn_floatzisegmap_45787;
    gpu_kernel sortColumn_floatzisegmap_45805;
    gpu_kernel sortColumn_floatzisegmap_45822;
    gpu_kernel sortColumn_floatzisegmap_45832;
    gpu_kernel sortColumn_floatzisegmap_45868;
    gpu_kernel sortColumn_floatzisegmap_45874;
    gpu_kernel sortColumn_floatzisegmap_45902;
    gpu_kernel sortColumn_floatzisegmap_intrablock_45457;
    gpu_kernel sortColumn_floatzisegscan_45401;
    gpu_kernel sortColumn_floatzisegscan_45718;
    gpu_kernel sortColumn_floatzisegscan_45850;
    gpu_kernel sortColumn_intzigpuseq_48446;
    gpu_kernel sortColumn_intzigpuseq_48854;
    gpu_kernel sortColumn_intzisegmap_46444;
    gpu_kernel sortColumn_intzisegmap_46466;
    gpu_kernel sortColumn_intzisegmap_46779;
    gpu_kernel sortColumn_intzisegmap_46801;
    gpu_kernel sortColumn_intzisegmap_46819;
    gpu_kernel sortColumn_intzisegmap_46836;
    gpu_kernel sortColumn_intzisegmap_46846;
    gpu_kernel sortColumn_intzisegmap_46882;
    gpu_kernel sortColumn_intzisegmap_46888;
    gpu_kernel sortColumn_intzisegmap_46916;
    gpu_kernel sortColumn_intzisegmap_intrablock_46498;
    gpu_kernel sortColumn_intzisegscan_46442;
    gpu_kernel sortColumn_intzisegscan_46741;
    gpu_kernel sortColumn_intzisegscan_46864;
    gpu_kernel sortColumn_longzigpuseq_48446;
    gpu_kernel sortColumn_longzigpuseq_48854;
    gpu_kernel sortColumn_longzisegmap_44920;
    gpu_kernel sortColumn_longzisegmap_44942;
    gpu_kernel sortColumn_longzisegmap_45249;
    gpu_kernel sortColumn_longzisegmap_45271;
    gpu_kernel sortColumn_longzisegmap_45289;
    gpu_kernel sortColumn_longzisegmap_45306;
    gpu_kernel sortColumn_longzisegmap_45316;
    gpu_kernel sortColumn_longzisegmap_45352;
    gpu_kernel sortColumn_longzisegmap_45358;
    gpu_kernel sortColumn_longzisegmap_45386;
    gpu_kernel sortColumn_longzisegmap_intrablock_44974;
    gpu_kernel sortColumn_longzisegscan_44918;
    gpu_kernel sortColumn_longzisegscan_45213;
    gpu_kernel sortColumn_longzisegscan_45334;
    gpu_kernel sortColumn_shortzigpuseq_48446;
    gpu_kernel sortColumn_shortzigpuseq_48854;
    gpu_kernel sortColumn_shortzisegmap_44437;
    gpu_kernel sortColumn_shortzisegmap_44459;
    gpu_kernel sortColumn_shortzisegmap_44766;
    gpu_kernel sortColumn_shortzisegmap_44788;
    gpu_kernel sortColumn_shortzisegmap_44806;
    gpu_kernel sortColumn_shortzisegmap_44823;
    gpu_kernel sortColumn_shortzisegmap_44833;
    gpu_kernel sortColumn_shortzisegmap_44869;
    gpu_kernel sortColumn_shortzisegmap_44875;
    gpu_kernel sortColumn_shortzisegmap_44903;
    gpu_kernel sortColumn_shortzisegmap_intrablock_44491;
    gpu_kernel sortColumn_shortzisegscan_44435;
    gpu_kernel sortColumn_shortzisegscan_44730;
    gpu_kernel sortColumn_shortzisegscan_44851;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
    gpu_create_kernel(ctx, &ctx->program->argmin_doublezisegred_nonseg_44069, "argmin_doublezisegred_nonseg_44069");
    gpu_create_kernel(ctx, &ctx->program->argmin_floatzisegred_nonseg_44058, "argmin_floatzisegred_nonseg_44058");
    gpu_create_kernel(ctx, &ctx->program->argmin_intzisegred_nonseg_44036, "argmin_intzisegred_nonseg_44036");
    gpu_create_kernel(ctx, &ctx->program->argmin_longzisegred_nonseg_44047, "argmin_longzisegred_nonseg_44047");
    gpu_create_kernel(ctx, &ctx->program->argmin_shortzisegred_nonseg_44025, "argmin_shortzisegred_nonseg_44025");
    gpu_create_kernel(ctx, &ctx->program->builtinzhiota_i64ziiota_i64_48110, "builtinzhiota_i64ziiota_i64_48110");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i16zireplicate_48431, "builtinzhreplicate_i16zireplicate_48431");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i32zireplicate_48186, "builtinzhreplicate_i32zireplicate_48186");
    gpu_create_kernel(ctx, &ctx->program->builtinzhreplicate_i8zireplicate_48148, "builtinzhreplicate_i8zireplicate_48148");
    gpu_create_kernel(ctx, &ctx->program->mergeFunczisegmap_intrablock_46987, "mergeFunczisegmap_intrablock_46987");
    gpu_create_kernel(ctx, &ctx->program->mergeFunczisegmap_intrablock_47382, "mergeFunczisegmap_intrablock_47382");
    gpu_create_kernel(ctx, &ctx->program->orderByIndices_doublezisegmap_44420, "orderByIndices_doublezisegmap_44420");
    gpu_create_kernel(ctx, &ctx->program->orderByIndices_floatzisegmap_44392, "orderByIndices_floatzisegmap_44392");
    gpu_create_kernel(ctx, &ctx->program->orderByIndices_intzisegmap_44336, "orderByIndices_intzisegmap_44336");
    gpu_create_kernel(ctx, &ctx->program->orderByIndices_longzisegmap_44364, "orderByIndices_longzisegmap_44364");
    gpu_create_kernel(ctx, &ctx->program->orderByIndices_shortzisegmap_44308, "orderByIndices_shortzisegmap_44308");
    gpu_create_kernel(ctx, &ctx->program->partitionFunczisegmap_43943, "partitionFunczisegmap_43943");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezigpuseq_48446, "sortColumn_doublezigpuseq_48446");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezigpuseq_48854, "sortColumn_doublezigpuseq_48854");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_45919, "sortColumn_doublezisegmap_45919");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_45941, "sortColumn_doublezisegmap_45941");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46290, "sortColumn_doublezisegmap_46290");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46312, "sortColumn_doublezisegmap_46312");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46330, "sortColumn_doublezisegmap_46330");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46347, "sortColumn_doublezisegmap_46347");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46357, "sortColumn_doublezisegmap_46357");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46393, "sortColumn_doublezisegmap_46393");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46399, "sortColumn_doublezisegmap_46399");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_46427, "sortColumn_doublezisegmap_46427");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegmap_intrablock_45973, "sortColumn_doublezisegmap_intrablock_45973");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegscan_45917, "sortColumn_doublezisegscan_45917");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegscan_46240, "sortColumn_doublezisegscan_46240");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_doublezisegscan_46375, "sortColumn_doublezisegscan_46375");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzigpuseq_48446, "sortColumn_floatzigpuseq_48446");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzigpuseq_48854, "sortColumn_floatzigpuseq_48854");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45403, "sortColumn_floatzisegmap_45403");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45425, "sortColumn_floatzisegmap_45425");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45765, "sortColumn_floatzisegmap_45765");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45787, "sortColumn_floatzisegmap_45787");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45805, "sortColumn_floatzisegmap_45805");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45822, "sortColumn_floatzisegmap_45822");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45832, "sortColumn_floatzisegmap_45832");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45868, "sortColumn_floatzisegmap_45868");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45874, "sortColumn_floatzisegmap_45874");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_45902, "sortColumn_floatzisegmap_45902");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegmap_intrablock_45457, "sortColumn_floatzisegmap_intrablock_45457");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegscan_45401, "sortColumn_floatzisegscan_45401");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegscan_45718, "sortColumn_floatzisegscan_45718");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_floatzisegscan_45850, "sortColumn_floatzisegscan_45850");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzigpuseq_48446, "sortColumn_intzigpuseq_48446");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzigpuseq_48854, "sortColumn_intzigpuseq_48854");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46444, "sortColumn_intzisegmap_46444");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46466, "sortColumn_intzisegmap_46466");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46779, "sortColumn_intzisegmap_46779");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46801, "sortColumn_intzisegmap_46801");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46819, "sortColumn_intzisegmap_46819");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46836, "sortColumn_intzisegmap_46836");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46846, "sortColumn_intzisegmap_46846");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46882, "sortColumn_intzisegmap_46882");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46888, "sortColumn_intzisegmap_46888");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_46916, "sortColumn_intzisegmap_46916");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegmap_intrablock_46498, "sortColumn_intzisegmap_intrablock_46498");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegscan_46442, "sortColumn_intzisegscan_46442");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegscan_46741, "sortColumn_intzisegscan_46741");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_intzisegscan_46864, "sortColumn_intzisegscan_46864");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzigpuseq_48446, "sortColumn_longzigpuseq_48446");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzigpuseq_48854, "sortColumn_longzigpuseq_48854");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_44920, "sortColumn_longzisegmap_44920");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_44942, "sortColumn_longzisegmap_44942");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45249, "sortColumn_longzisegmap_45249");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45271, "sortColumn_longzisegmap_45271");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45289, "sortColumn_longzisegmap_45289");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45306, "sortColumn_longzisegmap_45306");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45316, "sortColumn_longzisegmap_45316");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45352, "sortColumn_longzisegmap_45352");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45358, "sortColumn_longzisegmap_45358");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_45386, "sortColumn_longzisegmap_45386");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegmap_intrablock_44974, "sortColumn_longzisegmap_intrablock_44974");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegscan_44918, "sortColumn_longzisegscan_44918");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegscan_45213, "sortColumn_longzisegscan_45213");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_longzisegscan_45334, "sortColumn_longzisegscan_45334");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzigpuseq_48446, "sortColumn_shortzigpuseq_48446");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzigpuseq_48854, "sortColumn_shortzigpuseq_48854");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44437, "sortColumn_shortzisegmap_44437");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44459, "sortColumn_shortzisegmap_44459");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44766, "sortColumn_shortzisegmap_44766");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44788, "sortColumn_shortzisegmap_44788");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44806, "sortColumn_shortzisegmap_44806");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44823, "sortColumn_shortzisegmap_44823");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44833, "sortColumn_shortzisegmap_44833");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44869, "sortColumn_shortzisegmap_44869");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44875, "sortColumn_shortzisegmap_44875");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_44903, "sortColumn_shortzisegmap_44903");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegmap_intrablock_44491, "sortColumn_shortzisegmap_intrablock_44491");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegscan_44435, "sortColumn_shortzisegscan_44435");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegscan_44730, "sortColumn_shortzisegscan_44730");
    gpu_create_kernel(ctx, &ctx->program->sortColumn_shortzisegscan_44851, "sortColumn_shortzisegscan_44851");
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    gpu_free_kernel(ctx, ctx->program->argmin_doublezisegred_nonseg_44069);
    gpu_free_kernel(ctx, ctx->program->argmin_floatzisegred_nonseg_44058);
    gpu_free_kernel(ctx, ctx->program->argmin_intzisegred_nonseg_44036);
    gpu_free_kernel(ctx, ctx->program->argmin_longzisegred_nonseg_44047);
    gpu_free_kernel(ctx, ctx->program->argmin_shortzisegred_nonseg_44025);
    gpu_free_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_48110);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_48431);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_48186);
    gpu_free_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_48148);
    gpu_free_kernel(ctx, ctx->program->mergeFunczisegmap_intrablock_46987);
    gpu_free_kernel(ctx, ctx->program->mergeFunczisegmap_intrablock_47382);
    gpu_free_kernel(ctx, ctx->program->orderByIndices_doublezisegmap_44420);
    gpu_free_kernel(ctx, ctx->program->orderByIndices_floatzisegmap_44392);
    gpu_free_kernel(ctx, ctx->program->orderByIndices_intzisegmap_44336);
    gpu_free_kernel(ctx, ctx->program->orderByIndices_longzisegmap_44364);
    gpu_free_kernel(ctx, ctx->program->orderByIndices_shortzisegmap_44308);
    gpu_free_kernel(ctx, ctx->program->partitionFunczisegmap_43943);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezigpuseq_48446);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezigpuseq_48854);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_45919);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_45941);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46290);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46312);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46330);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46347);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46357);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46393);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46399);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46427);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegmap_intrablock_45973);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegscan_45917);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegscan_46240);
    gpu_free_kernel(ctx, ctx->program->sortColumn_doublezisegscan_46375);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzigpuseq_48446);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzigpuseq_48854);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45403);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45425);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45765);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45787);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45805);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45822);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45832);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45868);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45874);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45902);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegmap_intrablock_45457);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45401);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45718);
    gpu_free_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45850);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzigpuseq_48446);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzigpuseq_48854);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46444);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46466);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46779);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46801);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46819);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46836);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46846);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46882);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46888);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_46916);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegmap_intrablock_46498);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegscan_46442);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegscan_46741);
    gpu_free_kernel(ctx, ctx->program->sortColumn_intzisegscan_46864);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzigpuseq_48446);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzigpuseq_48854);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_44920);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_44942);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45249);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45271);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45289);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45306);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45316);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45352);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45358);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_45386);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegmap_intrablock_44974);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegscan_44918);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegscan_45213);
    gpu_free_kernel(ctx, ctx->program->sortColumn_longzisegscan_45334);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzigpuseq_48446);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzigpuseq_48854);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44437);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44459);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44766);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44788);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44806);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44823);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44833);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44869);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44875);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44903);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegmap_intrablock_44491);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44435);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44730);
    gpu_free_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44851);
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
    ctx->tuning_params.argmin_doublezisegred_num_tblocks_44062 = &ctx->cfg->tuning_params[0];
    ctx->tuning_params.argmin_doublezisegred_tblock_sizze_44060 = &ctx->cfg->tuning_params[1];
    ctx->tuning_params.argmin_floatzisegred_num_tblocks_44051 = &ctx->cfg->tuning_params[2];
    ctx->tuning_params.argmin_floatzisegred_tblock_sizze_44049 = &ctx->cfg->tuning_params[3];
    ctx->tuning_params.argmin_intzisegred_num_tblocks_44029 = &ctx->cfg->tuning_params[4];
    ctx->tuning_params.argmin_intzisegred_tblock_sizze_44027 = &ctx->cfg->tuning_params[5];
    ctx->tuning_params.argmin_longzisegred_num_tblocks_44040 = &ctx->cfg->tuning_params[6];
    ctx->tuning_params.argmin_longzisegred_tblock_sizze_44038 = &ctx->cfg->tuning_params[7];
    ctx->tuning_params.argmin_shortzisegred_num_tblocks_44018 = &ctx->cfg->tuning_params[8];
    ctx->tuning_params.argmin_shortzisegred_tblock_sizze_44016 = &ctx->cfg->tuning_params[9];
    ctx->tuning_params.builtinzhiota_i64zitblock_sizze_48114 = &ctx->cfg->tuning_params[10];
    ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_48435 = &ctx->cfg->tuning_params[11];
    ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_48190 = &ctx->cfg->tuning_params[12];
    ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_48152 = &ctx->cfg->tuning_params[13];
    ctx->tuning_params.mergeFunczisuff_outer_par_0 = &ctx->cfg->tuning_params[14];
    ctx->tuning_params.mergeFunczitile_sizze_46988 = &ctx->cfg->tuning_params[15];
    ctx->tuning_params.mergeFunczitile_sizze_47383 = &ctx->cfg->tuning_params[16];
    ctx->tuning_params.orderByIndices_doublezisegmap_tblock_sizze_44403 = &ctx->cfg->tuning_params[17];
    ctx->tuning_params.orderByIndices_floatzisegmap_tblock_sizze_44375 = &ctx->cfg->tuning_params[18];
    ctx->tuning_params.orderByIndices_intzisegmap_tblock_sizze_44319 = &ctx->cfg->tuning_params[19];
    ctx->tuning_params.orderByIndices_longzisegmap_tblock_sizze_44347 = &ctx->cfg->tuning_params[20];
    ctx->tuning_params.orderByIndices_shortzisegmap_tblock_sizze_44291 = &ctx->cfg->tuning_params[21];
    ctx->tuning_params.partitionFunczisegmap_tblock_sizze_43861 = &ctx->cfg->tuning_params[22];
    ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_45923 = &ctx->cfg->tuning_params[23];
    ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46066 = &ctx->cfg->tuning_params[24];
    ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46115 = &ctx->cfg->tuning_params[25];
    ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46137 = &ctx->cfg->tuning_params[26];
    ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46403 = &ctx->cfg->tuning_params[27];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45921 = &ctx->cfg->tuning_params[28];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45929 = &ctx->cfg->tuning_params[29];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46064 = &ctx->cfg->tuning_params[30];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46091 = &ctx->cfg->tuning_params[31];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46113 = &ctx->cfg->tuning_params[32];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46135 = &ctx->cfg->tuning_params[33];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46157 = &ctx->cfg->tuning_params[34];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46379 = &ctx->cfg->tuning_params[35];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46401 = &ctx->cfg->tuning_params[36];
    ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46409 = &ctx->cfg->tuning_params[37];
    ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_45913 = &ctx->cfg->tuning_params[38];
    ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_46179 = &ctx->cfg->tuning_params[39];
    ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_46371 = &ctx->cfg->tuning_params[40];
    ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_45911 = &ctx->cfg->tuning_params[41];
    ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46177 = &ctx->cfg->tuning_params[42];
    ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46369 = &ctx->cfg->tuning_params[43];
    ctx->tuning_params.sortColumn_doublezisuff_intra_par_0 = &ctx->cfg->tuning_params[44];
    ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45407 = &ctx->cfg->tuning_params[45];
    ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45547 = &ctx->cfg->tuning_params[46];
    ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45596 = &ctx->cfg->tuning_params[47];
    ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45618 = &ctx->cfg->tuning_params[48];
    ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45878 = &ctx->cfg->tuning_params[49];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45405 = &ctx->cfg->tuning_params[50];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45413 = &ctx->cfg->tuning_params[51];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45545 = &ctx->cfg->tuning_params[52];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45572 = &ctx->cfg->tuning_params[53];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45594 = &ctx->cfg->tuning_params[54];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45616 = &ctx->cfg->tuning_params[55];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45638 = &ctx->cfg->tuning_params[56];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45854 = &ctx->cfg->tuning_params[57];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45876 = &ctx->cfg->tuning_params[58];
    ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45884 = &ctx->cfg->tuning_params[59];
    ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45397 = &ctx->cfg->tuning_params[60];
    ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45660 = &ctx->cfg->tuning_params[61];
    ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45846 = &ctx->cfg->tuning_params[62];
    ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45395 = &ctx->cfg->tuning_params[63];
    ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45658 = &ctx->cfg->tuning_params[64];
    ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45844 = &ctx->cfg->tuning_params[65];
    ctx->tuning_params.sortColumn_floatzisuff_intra_par_0 = &ctx->cfg->tuning_params[66];
    ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46448 = &ctx->cfg->tuning_params[67];
    ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46579 = &ctx->cfg->tuning_params[68];
    ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46628 = &ctx->cfg->tuning_params[69];
    ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46650 = &ctx->cfg->tuning_params[70];
    ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46892 = &ctx->cfg->tuning_params[71];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46446 = &ctx->cfg->tuning_params[72];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46454 = &ctx->cfg->tuning_params[73];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46577 = &ctx->cfg->tuning_params[74];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46604 = &ctx->cfg->tuning_params[75];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46626 = &ctx->cfg->tuning_params[76];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46648 = &ctx->cfg->tuning_params[77];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46670 = &ctx->cfg->tuning_params[78];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46868 = &ctx->cfg->tuning_params[79];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46890 = &ctx->cfg->tuning_params[80];
    ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46898 = &ctx->cfg->tuning_params[81];
    ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46438 = &ctx->cfg->tuning_params[82];
    ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46692 = &ctx->cfg->tuning_params[83];
    ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46860 = &ctx->cfg->tuning_params[84];
    ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46436 = &ctx->cfg->tuning_params[85];
    ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46690 = &ctx->cfg->tuning_params[86];
    ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46858 = &ctx->cfg->tuning_params[87];
    ctx->tuning_params.sortColumn_intzisuff_intra_par_0 = &ctx->cfg->tuning_params[88];
    ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_44924 = &ctx->cfg->tuning_params[89];
    ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45053 = &ctx->cfg->tuning_params[90];
    ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45102 = &ctx->cfg->tuning_params[91];
    ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45124 = &ctx->cfg->tuning_params[92];
    ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45362 = &ctx->cfg->tuning_params[93];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44922 = &ctx->cfg->tuning_params[94];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44930 = &ctx->cfg->tuning_params[95];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45051 = &ctx->cfg->tuning_params[96];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45078 = &ctx->cfg->tuning_params[97];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45100 = &ctx->cfg->tuning_params[98];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45122 = &ctx->cfg->tuning_params[99];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45144 = &ctx->cfg->tuning_params[100];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45338 = &ctx->cfg->tuning_params[101];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45360 = &ctx->cfg->tuning_params[102];
    ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45368 = &ctx->cfg->tuning_params[103];
    ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_44914 = &ctx->cfg->tuning_params[104];
    ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_45166 = &ctx->cfg->tuning_params[105];
    ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_45330 = &ctx->cfg->tuning_params[106];
    ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_44912 = &ctx->cfg->tuning_params[107];
    ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45164 = &ctx->cfg->tuning_params[108];
    ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45328 = &ctx->cfg->tuning_params[109];
    ctx->tuning_params.sortColumn_longzisuff_intra_par_0 = &ctx->cfg->tuning_params[110];
    ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44441 = &ctx->cfg->tuning_params[111];
    ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44570 = &ctx->cfg->tuning_params[112];
    ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44619 = &ctx->cfg->tuning_params[113];
    ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44641 = &ctx->cfg->tuning_params[114];
    ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44879 = &ctx->cfg->tuning_params[115];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44439 = &ctx->cfg->tuning_params[116];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44447 = &ctx->cfg->tuning_params[117];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44568 = &ctx->cfg->tuning_params[118];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44595 = &ctx->cfg->tuning_params[119];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44617 = &ctx->cfg->tuning_params[120];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44639 = &ctx->cfg->tuning_params[121];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44661 = &ctx->cfg->tuning_params[122];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44855 = &ctx->cfg->tuning_params[123];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44877 = &ctx->cfg->tuning_params[124];
    ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44885 = &ctx->cfg->tuning_params[125];
    ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44431 = &ctx->cfg->tuning_params[126];
    ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44683 = &ctx->cfg->tuning_params[127];
    ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44847 = &ctx->cfg->tuning_params[128];
    ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44429 = &ctx->cfg->tuning_params[129];
    ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44681 = &ctx->cfg->tuning_params[130];
    ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44845 = &ctx->cfg->tuning_params[131];
    ctx->tuning_params.sortColumn_shortzisuff_intra_par_0 = &ctx->cfg->tuning_params[132];
}
int memblock_unref_device(struct futhark_context *ctx, struct memblock_device *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            (void) gpu_free(ctx, block->mem, block->size, desc);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc_device(struct futhark_context *ctx, struct memblock_device *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "space 'device'", ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "space 'device'", (long long) ctx->cur_mem_usage_device);
    (void) gpu_alloc(ctx, ctx->log, (size_t) size, desc, &block->mem, (size_t *) &size);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_device + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_device = new_usage;
        if (new_usage > ctx->peak_mem_usage_device) {
            ctx->peak_mem_usage_device = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "space 'device'", (long long) size, (long long) ctx->cur_mem_usage_device, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set_device(struct futhark_context *ctx, struct memblock_device *lhs, struct memblock_device *rhs, const char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"space 'device'\": %lld", (long long) ctx->peak_mem_usage_device);
    str_builder_char(&builder, ',');
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    ctx->peak_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    if (ctx->error == NULL)
        gpu_free_all(ctx);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_48105, int64_t n_48106, int64_t x_48107, int64_t s_48108);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_48426, int64_t num_elems_48427, int16_t val_48428);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_48181, int64_t num_elems_48182, int32_t val_48183);
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_48143, int64_t num_elems_48144, int8_t val_48145);
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_49003, struct memblock_device ks_mem_47844, int64_t n_37213);
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_49005, struct memblock_device ks_mem_47844, int64_t n_37044);
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_49007, struct memblock_device ks_mem_47844, int64_t n_36709);
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_49009, struct memblock_device ks_mem_47844, int64_t n_36875);
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_49011, struct memblock_device ks_mem_47844, int64_t n_36543);
FUTHARK_FUN_ATTR int futrts_entry_mergeFunc(struct futhark_context *ctx, struct memblock_device *mem_out_p_49013, struct memblock_device *mem_out_p_49014, struct memblock_device *mem_out_p_49015, struct memblock_device xs_mem_47844, struct memblock_device ys_mem_47845, int64_t w1_37999, int64_t w2_38000);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_49016, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36374, int64_t n_36375, int64_t incr_36376);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_49017, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36220, int64_t n_36221, int64_t incr_36222);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_49018, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_35915, int64_t n_35916, int64_t incr_35917);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_49019, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36066, int64_t n_36067, int64_t incr_36068);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_49020, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_35761, int64_t n_35762, int64_t incr_35763);
FUTHARK_FUN_ATTR int futrts_entry_partitionFunc(struct futhark_context *ctx, struct memblock_device *mem_out_p_49021, struct memblock_device *mem_out_p_49022, struct memblock_device as_mem_47844, struct memblock_device bs_mem_47845, int64_t na_37612, int64_t nb_37613, int64_t threads_37614);
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_49023, struct memblock_device *mem_out_p_49024, struct memblock_device xs_mem_47844, int64_t n_35607, int64_t incr_35608, int16_t block_sizze_35609);
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_49026, struct memblock_device *mem_out_p_49027, struct memblock_device xs_mem_47844, int64_t n_32852, int64_t incr_32853, int16_t block_sizze_32854);
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_49029, struct memblock_device *mem_out_p_49030, struct memblock_device xs_mem_47844, int64_t n_27501, int64_t incr_27502, int16_t block_sizze_27503);
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_49032, struct memblock_device *mem_out_p_49033, struct memblock_device xs_mem_47844, int64_t n_30101, int64_t incr_30102, int16_t block_sizze_30103);
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_49035, struct memblock_device *mem_out_p_49036, struct memblock_device xs_mem_47844, int64_t n_24884, int64_t incr_24885, int16_t block_sizze_24886);
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_49038, int32_t bit_22732, int16_t x_22733);
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_49039, int32_t bit_27949, int64_t x_27950);
FUTHARK_FUN_ATTR int futrts_lifted_f_7536(struct futhark_context *ctx, int64_t *out_prim_out_49040, int16_t na_22256, int16_t nb_22257, int16_t nc_22258, int16_t bin_22259, int16_t a_22260, int16_t b_22261, int16_t c_22262, int16_t d_22263);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_7535(struct futhark_context *ctx, int16_t *out_prim_out_49041, int16_t *out_prim_out_49042, int16_t *out_prim_out_49043, int16_t *out_prim_out_49044, int16_t x_22199);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    #define counters_mem_48106 (ctx->constants->counters_mem_48106)
    #define global_dynid_mem_48179 (ctx->constants->global_dynid_mem_48179)
    #define global_dynid_mem_48550 (ctx->constants->global_dynid_mem_48550)
    #define global_dynid_mem_48882 (ctx->constants->global_dynid_mem_48882)
    counters_mem_48106.references = NULL;
    global_dynid_mem_48179.references = NULL;
    global_dynid_mem_48550.references = NULL;
    global_dynid_mem_48882.references = NULL;
    if (memblock_alloc_device(ctx, &counters_mem_48106, (int64_t) 80, "counters_mem_48106")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_48106, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_48106, (int64_t) 80, "counters_mem_48106")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_48106, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_48106, (int64_t) 80, "counters_mem_48106")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_48106, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_48106, (int64_t) 80, "counters_mem_48106")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_48106, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &counters_mem_48106, (int64_t) 80, "counters_mem_48106")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, counters_mem_48106, (int64_t) 20, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48179, (int64_t) 4, "global_dynid_mem_48179")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48179, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48550, (int64_t) 4, "global_dynid_mem_48550")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48550, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48882, (int64_t) 4, "global_dynid_mem_48882")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48882, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48179, (int64_t) 4, "global_dynid_mem_48179")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48179, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48550, (int64_t) 4, "global_dynid_mem_48550")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48550, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48882, (int64_t) 4, "global_dynid_mem_48882")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48882, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48179, (int64_t) 4, "global_dynid_mem_48179")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48179, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48550, (int64_t) 4, "global_dynid_mem_48550")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48550, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48882, (int64_t) 4, "global_dynid_mem_48882")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48882, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48179, (int64_t) 4, "global_dynid_mem_48179")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48179, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48550, (int64_t) 4, "global_dynid_mem_48550")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48550, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48882, (int64_t) 4, "global_dynid_mem_48882")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48882, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48179, (int64_t) 4, "global_dynid_mem_48179")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48179, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48550, (int64_t) 4, "global_dynid_mem_48550")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48550, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &global_dynid_mem_48882, (int64_t) 4, "global_dynid_mem_48882")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i32(ctx, global_dynid_mem_48882, (int64_t) 1, 0) != 0) {
        err = 1;
        goto cleanup;
    }
    #undef counters_mem_48106
    #undef global_dynid_mem_48179
    #undef global_dynid_mem_48550
    #undef global_dynid_mem_48882
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    if (memblock_unref_device(ctx, &ctx->constants->counters_mem_48106, "ctx->constants->counters_mem_48106") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_48179, "ctx->constants->global_dynid_mem_48179") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_48550, "ctx->constants->global_dynid_mem_48550") != 0)
        return 1;
    if (memblock_unref_device(ctx, &ctx->constants->global_dynid_mem_48882, "ctx->constants->global_dynid_mem_48882") != 0)
        return 1;
    return 0;
}
static int gpu_kernel_builtinzhiota_i64ziiota_i64_48110(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhiota_i64ziiota_i64_48110, "builtin#iota_i64.iota_i64_48110", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i16zireplicate_48431(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int16_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i16zireplicate_48431, "builtin#replicate_i16.replicate_48431", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i32zireplicate_48186(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int32_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i32zireplicate_48186, "builtin#replicate_i32.replicate_48186", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_builtinzhreplicate_i8zireplicate_48148(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int8_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[6] = {&arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[6] = {sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->builtinzhreplicate_i8zireplicate_48148, "builtin#replicate_i8.replicate_48148", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 6, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_argmin_doublezisegred_nonseg_44069(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->argmin_doublezisegred_nonseg_44069, "argmin_double.segred_nonseg_44069", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_argmin_floatzisegred_nonseg_44058(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->argmin_floatzisegred_nonseg_44058, "argmin_float.segred_nonseg_44058", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_argmin_intzisegred_nonseg_44036(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->argmin_intzisegred_nonseg_44036, "argmin_int.segred_nonseg_44036", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_argmin_longzisegred_nonseg_44047(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->argmin_longzisegred_nonseg_44047, "argmin_long.segred_nonseg_44047", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_argmin_shortzisegred_nonseg_44025(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->argmin_shortzisegred_nonseg_44025, "argmin_short.segred_nonseg_44025", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_mergeFunczisegmap_intrablock_46987(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->mergeFunczisegmap_intrablock_46987, "mergeFunc.segmap_intrablock_46987", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_mergeFunczisegmap_intrablock_47382(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, int64_t arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[13] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11};
        size_t args_sizes[13] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11)};
        
        return gpu_launch_kernel(ctx, ctx->program->mergeFunczisegmap_intrablock_47382, "mergeFunc.segmap_intrablock_47382", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 13, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_orderByIndices_doublezisegmap_44420(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->orderByIndices_doublezisegmap_44420, "orderByIndices_double.segmap_44420", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_orderByIndices_floatzisegmap_44392(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->orderByIndices_floatzisegmap_44392, "orderByIndices_float.segmap_44392", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_orderByIndices_intzisegmap_44336(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->orderByIndices_intzisegmap_44336, "orderByIndices_int.segmap_44336", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_orderByIndices_longzisegmap_44364(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->orderByIndices_longzisegmap_44364, "orderByIndices_long.segmap_44364", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_orderByIndices_shortzisegmap_44308(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->orderByIndices_shortzisegmap_44308, "orderByIndices_short.segmap_44308", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_partitionFunczisegmap_43943(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[11] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[11] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->partitionFunczisegmap_43943, "partitionFunc.segmap_43943", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 11, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegscan_45917(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, int64_t arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegscan_45917, "sortColumn_double.segscan_45917", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezigpuseq_48446(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezigpuseq_48446, "sortColumn_double.gpuseq_48446", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_45919(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_45919, "sortColumn_double.segmap_45919", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_intrablock_45973(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int64_t arg4, bool arg5, int64_t arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_intrablock_45973, "sortColumn_double.segmap_intrablock_45973", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegscan_46240(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, bool arg3, int64_t arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegscan_46240, "sortColumn_double.segscan_46240", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46290(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, bool arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46290, "sortColumn_double.segmap_46290", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46312(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46312, "sortColumn_double.segmap_46312", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46330(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46330, "sortColumn_double.segmap_46330", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46347(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46347, "sortColumn_double.segmap_46347", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46357(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46357, "sortColumn_double.segmap_46357", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezigpuseq_48854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezigpuseq_48854, "sortColumn_double.gpuseq_48854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_45941(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_45941, "sortColumn_double.segmap_45941", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegscan_46375(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegscan_46375, "sortColumn_double.segscan_46375", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46393(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46393, "sortColumn_double.segmap_46393", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46399(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46399, "sortColumn_double.segmap_46399", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_doublezisegmap_46427(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_doublezisegmap_46427, "sortColumn_double.segmap_46427", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegscan_45401(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45401, "sortColumn_float.segscan_45401", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzigpuseq_48446(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzigpuseq_48446, "sortColumn_float.gpuseq_48446", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45403(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45403, "sortColumn_float.segmap_45403", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_intrablock_45457(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, bool arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_intrablock_45457, "sortColumn_float.segmap_intrablock_45457", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegscan_45718(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45718, "sortColumn_float.segscan_45718", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45765(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, bool arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45765, "sortColumn_float.segmap_45765", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45787(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45787, "sortColumn_float.segmap_45787", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45805(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45805, "sortColumn_float.segmap_45805", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45822(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45822, "sortColumn_float.segmap_45822", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45832(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45832, "sortColumn_float.segmap_45832", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzigpuseq_48854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzigpuseq_48854, "sortColumn_float.gpuseq_48854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45425(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45425, "sortColumn_float.segmap_45425", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegscan_45850(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegscan_45850, "sortColumn_float.segscan_45850", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45868(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45868, "sortColumn_float.segmap_45868", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45874(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45874, "sortColumn_float.segmap_45874", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_floatzisegmap_45902(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_floatzisegmap_45902, "sortColumn_float.segmap_45902", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegscan_46442(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegscan_46442, "sortColumn_int.segscan_46442", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzigpuseq_48446(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzigpuseq_48446, "sortColumn_int.gpuseq_48446", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46444(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46444, "sortColumn_int.segmap_46444", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_intrablock_46498(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, bool arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, int64_t arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_intrablock_46498, "sortColumn_int.segmap_intrablock_46498", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegscan_46741(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegscan_46741, "sortColumn_int.segscan_46741", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46779(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, bool arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46779, "sortColumn_int.segmap_46779", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46801(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46801, "sortColumn_int.segmap_46801", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46819(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46819, "sortColumn_int.segmap_46819", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46836(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46836, "sortColumn_int.segmap_46836", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46846(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46846, "sortColumn_int.segmap_46846", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzigpuseq_48854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzigpuseq_48854, "sortColumn_int.gpuseq_48854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46466(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46466, "sortColumn_int.segmap_46466", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegscan_46864(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegscan_46864, "sortColumn_int.segscan_46864", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46882(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46882, "sortColumn_int.segmap_46882", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46888(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46888, "sortColumn_int.segmap_46888", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_intzisegmap_46916(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_intzisegmap_46916, "sortColumn_int.segmap_46916", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegscan_44918(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegscan_44918, "sortColumn_long.segscan_44918", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzigpuseq_48446(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzigpuseq_48446, "sortColumn_long.gpuseq_48446", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_44920(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_44920, "sortColumn_long.segmap_44920", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_intrablock_44974(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, bool arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_intrablock_44974, "sortColumn_long.segmap_intrablock_44974", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegscan_45213(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegscan_45213, "sortColumn_long.segscan_45213", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45249(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, bool arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45249, "sortColumn_long.segmap_45249", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45271(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45271, "sortColumn_long.segmap_45271", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45289(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45289, "sortColumn_long.segmap_45289", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45306(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45306, "sortColumn_long.segmap_45306", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45316(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45316, "sortColumn_long.segmap_45316", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzigpuseq_48854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzigpuseq_48854, "sortColumn_long.gpuseq_48854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_44942(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_44942, "sortColumn_long.segmap_44942", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegscan_45334(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegscan_45334, "sortColumn_long.segscan_45334", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45352(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45352, "sortColumn_long.segmap_45352", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45358(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45358, "sortColumn_long.segmap_45358", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_longzisegmap_45386(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_longzisegmap_45386, "sortColumn_long.segmap_45386", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegscan_44435(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44435, "sortColumn_short.segscan_44435", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzigpuseq_48446(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[10] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8};
        size_t args_sizes[10] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzigpuseq_48446, "sortColumn_short.gpuseq_48446", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 10, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44437(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44437, "sortColumn_short.segmap_44437", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_intrablock_44491(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, int64_t arg2, int64_t arg3, int32_t arg4, int32_t arg5, bool arg6, bool arg7, int64_t arg8, int64_t arg9, int64_t arg10, int64_t arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[21] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17};
        size_t args_sizes[21] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_intrablock_44491, "sortColumn_short.segmap_intrablock_44491", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 21, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegscan_44730(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, int32_t arg3, bool arg4, bool arg5, int64_t arg6, int64_t arg7, int64_t arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18, gpu_mem arg19, gpu_mem arg20, gpu_mem arg21, gpu_mem arg22, gpu_mem arg23, gpu_mem arg24)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[28] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18, &arg19, &arg20, &arg21, &arg22, &arg23, &arg24};
        size_t args_sizes[28] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18), sizeof(arg19), sizeof(arg20), sizeof(arg21), sizeof(arg22), sizeof(arg23), sizeof(arg24)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44730, "sortColumn_short.segscan_44730", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 28, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44766(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, bool arg1, bool arg2, int64_t arg3, int64_t arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44766, "sortColumn_short.segmap_44766", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44788(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int32_t arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[19] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15};
        size_t args_sizes[19] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44788, "sortColumn_short.segmap_44788", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 19, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44806(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44806, "sortColumn_short.segmap_44806", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44823(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44823, "sortColumn_short.segmap_44823", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44833(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int32_t arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[8] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6};
        size_t args_sizes[8] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44833, "sortColumn_short.segmap_44833", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 8, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzigpuseq_48854(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5, gpu_mem arg6, gpu_mem arg7)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzigpuseq_48854, "sortColumn_short.gpuseq_48854", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44459(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, gpu_mem arg0, gpu_mem arg1)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[3] = {&ctx->global_failure, &arg0, &arg1};
        size_t args_sizes[3] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44459, "sortColumn_short.segmap_44459", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 3, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegscan_44851(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int64_t arg5, gpu_mem arg6, gpu_mem arg7, gpu_mem arg8, gpu_mem arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[14] = {&ctx->global_failure, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12};
        size_t args_sizes[14] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegscan_44851, "sortColumn_short.segscan_44851", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 14, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44869(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, gpu_mem arg1, gpu_mem arg2)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[4] = {&ctx->global_failure, &arg0, &arg1, &arg2};
        size_t args_sizes[4] = {sizeof(ctx->global_failure), sizeof(arg0), sizeof(arg1), sizeof(arg2)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44869, "sortColumn_short.segmap_44869", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 4, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44875(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, int64_t arg2, int64_t arg3, int64_t arg4, int32_t arg5, int64_t arg6, int64_t arg7, int64_t arg8, int32_t arg9, gpu_mem arg10, gpu_mem arg11, gpu_mem arg12, gpu_mem arg13, gpu_mem arg14, gpu_mem arg15, gpu_mem arg16, gpu_mem arg17, gpu_mem arg18)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[22] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5, &arg6, &arg7, &arg8, &arg9, &arg10, &arg11, &arg12, &arg13, &arg14, &arg15, &arg16, &arg17, &arg18};
        size_t args_sizes[22] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5), sizeof(arg6), sizeof(arg7), sizeof(arg8), sizeof(arg9), sizeof(arg10), sizeof(arg11), sizeof(arg12), sizeof(arg13), sizeof(arg14), sizeof(arg15), sizeof(arg16), sizeof(arg17), sizeof(arg18)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44875, "sortColumn_short.segmap_44875", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 22, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
static int gpu_kernel_sortColumn_shortzisegmap_44903(struct futhark_context *ctx, unsigned int grid_x, unsigned int grid_y, unsigned int grid_z, unsigned int block_x, unsigned int block_y, unsigned int block_z, unsigned int shared_bytes, int64_t arg0, int64_t arg1, gpu_mem arg2, gpu_mem arg3, gpu_mem arg4, gpu_mem arg5)
{
    if (grid_x * grid_y * grid_z * block_x * block_y * block_z != 0) {
        void *args[9] = {&ctx->global_failure, &ctx->failure_is_an_option, &ctx->global_failure_args, &arg0, &arg1, &arg2, &arg3, &arg4, &arg5};
        size_t args_sizes[9] = {sizeof(ctx->global_failure), sizeof(ctx->failure_is_an_option), sizeof(ctx->global_failure_args), sizeof(arg0), sizeof(arg1), sizeof(arg2), sizeof(arg3), sizeof(arg4), sizeof(arg5)};
        
        return gpu_launch_kernel(ctx, ctx->program->sortColumn_shortzisegmap_44903, "sortColumn_short.segmap_44903", (const int32_t []) {grid_x, grid_y, grid_z}, (const int32_t []) {block_x, block_y, block_z}, shared_bytes, 9, args, args_sizes);
    }
    return FUTHARK_SUCCESS;
}
struct futhark_i16_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 2);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 2 * (i0 * 1), 2);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 4);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 4 * (i0 * 1), 4);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock_device mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    err = memcpy_host2gpu(ctx, false, arr->mem.mem, 0, (const unsigned char *) data, 0, (size_t) dim0 * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, CUdeviceptr data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    err = memcpy_gpu2host(ctx, false, (unsigned char *) data, 0, arr->mem.mem, 0, (size_t) arr->shape[0] * 8);
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
        err = memcpy_gpu2host(ctx, false, (unsigned char *) out, 0, arr->mem.mem, 8 * (i0 * 1), 8);
        CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_sortInfo_short {
    struct futhark_i64_1d *v0;
    struct futhark_i16_1d *v1;
};
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs)
{
    struct futhark_opaque_sortInfo_short *v = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i16_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_short *obj = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i16_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_int {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
};
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_int *v = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_int *obj = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_long *v = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_long *obj = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_float {
    struct futhark_i64_1d *v0;
    struct futhark_f32_1d *v1;
};
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_float *v = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_float *obj = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_double {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_double *v = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_double *obj = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup2_i64_i64 {
    int64_t v0;
    int64_t v1;
};
int futhark_project_opaque_tup2_i64_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_i64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, const int64_t f_0, const int64_t f_1)
{
    struct futhark_opaque_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v->v0 = f_0;
    v->v1 = f_1;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_i64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_i64_i64 *futhark_restore_opaque_tup2_i64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_i64_i64 *obj = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_i64_i64 {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_i64_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_i64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_i64_i64 **out, struct futhark_opaque_arr1d_tup2_i64_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_i64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_i64_i64));
        
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v0, 0, arr->v0->mem.mem, 8 * (i0 * 1), 8);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v1, 0, arr->v1->mem.mem, 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_i64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_i64_i64 *futhark_restore_opaque_arr1d_tup2_i64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_i64_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup3_i64_i32_i64 {
    int64_t v0;
    int32_t v1;
    int64_t v2;
};
int futhark_project_opaque_tup3_i64_i32_i64_0(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_tup3_i64_i32_i64_1(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    int32_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_project_opaque_tup3_i64_i32_i64_2(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 **out, const int64_t f_0, const int32_t f_1, const int64_t f_2)
{
    struct futhark_opaque_tup3_i64_i32_i64 *v = malloc(sizeof(struct futhark_opaque_tup3_i64_i32_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v->v0 = f_0;
    v->v1 = f_1;
    v->v2 = f_2;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    free(obj);
    return ret;
}
int futhark_store_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup3_i64_i32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int32_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
    }
    return ret;
}
struct futhark_opaque_tup3_i64_i32_i64 *futhark_restore_opaque_tup3_i64_i32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup3_i64_i32_i64 *obj = malloc(sizeof(struct futhark_opaque_tup3_i64_i32_i64));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup3_i64_i32_i64 {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_0(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_1(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup3_i64_i32_i64_2(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 **out, const struct futhark_i64_1d *f_0, const struct futhark_i32_1d *f_1, const struct futhark_i64_1d *f_2)
{
    if (!(f_0->shape[0] == f_1->shape[0] && f_1->shape[0] == f_2->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup3_i64_i32_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup3_i64_i32_i64));
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_2;
        (void) (*v->v2->mem.references)++;
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_tup3_i64_i32_i64 **out, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup3_i64_i32_i64 *v = malloc(sizeof(struct futhark_opaque_tup3_i64_i32_i64));
        
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v0, 0, arr->v0->mem.mem, 8 * (i0 * 1), 8);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v1, 0, arr->v1->mem.mem, 4 * (i0 * 1), 4);
        err = memcpy_gpu2host(ctx, false, (unsigned char *) &v->v2, 0, arr->v2->mem.mem, 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup3_i64_i32_i64 *futhark_restore_opaque_arr1d_tup3_i64_i32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup3_i64_i32_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup3_i64_i32_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_builtinzhiota_i64(struct futhark_context *ctx, struct memblock_device mem_48105, int64_t n_48106, int64_t x_48107, int64_t s_48108)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t tblock_sizze_48114;
    
    tblock_sizze_48114 = *ctx->tuning_params.builtinzhiota_i64zitblock_sizze_48114;
    
    int64_t virt_num_tblocks_48115 = sdiv_up64(n_48106, tblock_sizze_48114);
    int64_t num_tblocks_48116 = smin64(virt_num_tblocks_48115, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhiota_i64ziiota_i64_48110(ctx, num_tblocks_48116, 1, 1, tblock_sizze_48114, 1, 1, (int64_t) 0, n_48106, x_48107, s_48108, virt_num_tblocks_48115, num_tblocks_48116, mem_48105.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i16(struct futhark_context *ctx, struct memblock_device mem_48426, int64_t num_elems_48427, int16_t val_48428)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t replicate_n_48430 = num_elems_48427;
    int64_t tblock_sizze_48435;
    
    tblock_sizze_48435 = *ctx->tuning_params.builtinzhreplicate_i16zitblock_sizze_48435;
    
    int64_t virt_num_tblocks_48436 = sdiv_up64(replicate_n_48430, tblock_sizze_48435);
    int64_t num_tblocks_48437 = smin64(virt_num_tblocks_48436, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i16zireplicate_48431(ctx, num_tblocks_48437, 1, 1, tblock_sizze_48435, 1, 1, (int64_t) 0, num_elems_48427, val_48428, replicate_n_48430, virt_num_tblocks_48436, num_tblocks_48437, mem_48426.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i32(struct futhark_context *ctx, struct memblock_device mem_48181, int64_t num_elems_48182, int32_t val_48183)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t replicate_n_48185 = num_elems_48182;
    int64_t tblock_sizze_48190;
    
    tblock_sizze_48190 = *ctx->tuning_params.builtinzhreplicate_i32zitblock_sizze_48190;
    
    int64_t virt_num_tblocks_48191 = sdiv_up64(replicate_n_48185, tblock_sizze_48190);
    int64_t num_tblocks_48192 = smin64(virt_num_tblocks_48191, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i32zireplicate_48186(ctx, num_tblocks_48192, 1, 1, tblock_sizze_48190, 1, 1, (int64_t) 0, num_elems_48182, val_48183, replicate_n_48185, virt_num_tblocks_48191, num_tblocks_48192, mem_48181.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_builtinzhreplicate_i8(struct futhark_context *ctx, struct memblock_device mem_48143, int64_t num_elems_48144, int8_t val_48145)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t replicate_n_48147 = num_elems_48144;
    int64_t tblock_sizze_48152;
    
    tblock_sizze_48152 = *ctx->tuning_params.builtinzhreplicate_i8zitblock_sizze_48152;
    
    int64_t virt_num_tblocks_48153 = sdiv_up64(replicate_n_48147, tblock_sizze_48152);
    int64_t num_tblocks_48154 = smin64(virt_num_tblocks_48153, (int64_t) 1048576);
    
    {
        err = gpu_kernel_builtinzhreplicate_i8zireplicate_48148(ctx, num_tblocks_48154, 1, 1, tblock_sizze_48152, 1, 1, (int64_t) 0, num_elems_48144, val_48145, replicate_n_48147, virt_num_tblocks_48153, num_tblocks_48154, mem_48143.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_49003, struct memblock_device ks_mem_47844, int64_t n_37213)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_48130;
    
    segred_tmp_mem_48130.references = NULL;
    
    struct memblock_device segred_tmp_mem_48128;
    
    segred_tmp_mem_48128.references = NULL;
    
    struct memblock_device mem_47847;
    
    mem_47847.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    int64_t segred_tblock_sizze_44061;
    
    segred_tblock_sizze_44061 = *ctx->tuning_params.argmin_doublezisegred_tblock_sizze_44060;
    
    int64_t num_tblocks_44063;
    int64_t max_num_tblocks_48104;
    
    max_num_tblocks_48104 = *ctx->tuning_params.argmin_doublezisegred_num_tblocks_44062;
    num_tblocks_44063 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_37213, segred_tblock_sizze_44061), max_num_tblocks_48104)));
    if (memblock_alloc_device(ctx, &mem_47846, (int64_t) 8, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47847, (int64_t) 8, "mem_47847")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_48105 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48128, (int64_t) 8 * num_tblocks_44063, "segred_tmp_mem_48128")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48130, (int64_t) 8 * num_tblocks_44063, "segred_tmp_mem_48130")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_48132 = num_tblocks_44063 * segred_tblock_sizze_44061;
    
    {
        err = gpu_kernel_argmin_doublezisegred_nonseg_44069(ctx, num_tblocks_44063, 1, 1, *ctx->tuning_params.argmin_doublezisegred_tblock_sizze_44060, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_44061 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44061, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_44061 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44061, (int64_t) 8), (int64_t) 8)), n_37213, num_tblocks_44063, num_threads_48132, ks_mem_47844.mem, mem_47846.mem, mem_47847.mem, counters_mem_48106.mem, segred_tmp_mem_48128.mem, segred_tmp_mem_48130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
        return 1;
    
    int64_t read_res_49004;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_49004, mem_47846.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_43595 = read_res_49004;
    
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    prim_out_48103 = defunc_0_reduce_comm_res_43595;
    *out_prim_out_49003 = prim_out_48103;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_48130, "segred_tmp_mem_48130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_48128, "segred_tmp_mem_48128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_49005, struct memblock_device ks_mem_47844, int64_t n_37044)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_48130;
    
    segred_tmp_mem_48130.references = NULL;
    
    struct memblock_device segred_tmp_mem_48128;
    
    segred_tmp_mem_48128.references = NULL;
    
    struct memblock_device mem_47847;
    
    mem_47847.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    int64_t segred_tblock_sizze_44050;
    
    segred_tblock_sizze_44050 = *ctx->tuning_params.argmin_floatzisegred_tblock_sizze_44049;
    
    int64_t num_tblocks_44052;
    int64_t max_num_tblocks_48104;
    
    max_num_tblocks_48104 = *ctx->tuning_params.argmin_floatzisegred_num_tblocks_44051;
    num_tblocks_44052 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_37044, segred_tblock_sizze_44050), max_num_tblocks_48104)));
    if (memblock_alloc_device(ctx, &mem_47846, (int64_t) 8, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47847, (int64_t) 4, "mem_47847")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_48105 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48128, (int64_t) 8 * num_tblocks_44052, "segred_tmp_mem_48128")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48130, (int64_t) 4 * num_tblocks_44052, "segred_tmp_mem_48130")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_48132 = num_tblocks_44052 * segred_tblock_sizze_44050;
    
    {
        err = gpu_kernel_argmin_floatzisegred_nonseg_44058(ctx, num_tblocks_44052, 1, 1, *ctx->tuning_params.argmin_floatzisegred_tblock_sizze_44049, 1, 1, 8 + ((int64_t) 4 * segred_tblock_sizze_44050 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_44050, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_44050 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44050, (int64_t) 8), (int64_t) 8)), n_37044, num_tblocks_44052, num_threads_48132, ks_mem_47844.mem, mem_47846.mem, mem_47847.mem, counters_mem_48106.mem, segred_tmp_mem_48128.mem, segred_tmp_mem_48130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
        return 1;
    
    int64_t read_res_49006;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_49006, mem_47846.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_43595 = read_res_49006;
    
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    prim_out_48103 = defunc_0_reduce_comm_res_43595;
    *out_prim_out_49005 = prim_out_48103;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_48130, "segred_tmp_mem_48130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_48128, "segred_tmp_mem_48128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_49007, struct memblock_device ks_mem_47844, int64_t n_36709)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_48130;
    
    segred_tmp_mem_48130.references = NULL;
    
    struct memblock_device segred_tmp_mem_48128;
    
    segred_tmp_mem_48128.references = NULL;
    
    struct memblock_device mem_47847;
    
    mem_47847.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    int64_t segred_tblock_sizze_44028;
    
    segred_tblock_sizze_44028 = *ctx->tuning_params.argmin_intzisegred_tblock_sizze_44027;
    
    int64_t num_tblocks_44030;
    int64_t max_num_tblocks_48104;
    
    max_num_tblocks_48104 = *ctx->tuning_params.argmin_intzisegred_num_tblocks_44029;
    num_tblocks_44030 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_36709, segred_tblock_sizze_44028), max_num_tblocks_48104)));
    if (memblock_alloc_device(ctx, &mem_47846, (int64_t) 8, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47847, (int64_t) 4, "mem_47847")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_48105 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48128, (int64_t) 8 * num_tblocks_44030, "segred_tmp_mem_48128")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48130, (int64_t) 4 * num_tblocks_44030, "segred_tmp_mem_48130")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_48132 = num_tblocks_44030 * segred_tblock_sizze_44028;
    
    {
        err = gpu_kernel_argmin_intzisegred_nonseg_44036(ctx, num_tblocks_44030, 1, 1, *ctx->tuning_params.argmin_intzisegred_tblock_sizze_44027, 1, 1, 8 + ((int64_t) 4 * segred_tblock_sizze_44028 + srem64((int64_t) 8 - srem64((int64_t) 4 * segred_tblock_sizze_44028, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_44028 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44028, (int64_t) 8), (int64_t) 8)), n_36709, num_tblocks_44030, num_threads_48132, ks_mem_47844.mem, mem_47846.mem, mem_47847.mem, counters_mem_48106.mem, segred_tmp_mem_48128.mem, segred_tmp_mem_48130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
        return 1;
    
    int64_t read_res_49008;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_49008, mem_47846.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_43595 = read_res_49008;
    
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    prim_out_48103 = defunc_0_reduce_comm_res_43595;
    *out_prim_out_49007 = prim_out_48103;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_48130, "segred_tmp_mem_48130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_48128, "segred_tmp_mem_48128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_49009, struct memblock_device ks_mem_47844, int64_t n_36875)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_48130;
    
    segred_tmp_mem_48130.references = NULL;
    
    struct memblock_device segred_tmp_mem_48128;
    
    segred_tmp_mem_48128.references = NULL;
    
    struct memblock_device mem_47847;
    
    mem_47847.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    int64_t segred_tblock_sizze_44039;
    
    segred_tblock_sizze_44039 = *ctx->tuning_params.argmin_longzisegred_tblock_sizze_44038;
    
    int64_t num_tblocks_44041;
    int64_t max_num_tblocks_48104;
    
    max_num_tblocks_48104 = *ctx->tuning_params.argmin_longzisegred_num_tblocks_44040;
    num_tblocks_44041 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_36875, segred_tblock_sizze_44039), max_num_tblocks_48104)));
    if (memblock_alloc_device(ctx, &mem_47846, (int64_t) 8, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47847, (int64_t) 8, "mem_47847")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_48105 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48128, (int64_t) 8 * num_tblocks_44041, "segred_tmp_mem_48128")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48130, (int64_t) 8 * num_tblocks_44041, "segred_tmp_mem_48130")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_48132 = num_tblocks_44041 * segred_tblock_sizze_44039;
    
    {
        err = gpu_kernel_argmin_longzisegred_nonseg_44047(ctx, num_tblocks_44041, 1, 1, *ctx->tuning_params.argmin_longzisegred_tblock_sizze_44038, 1, 1, 8 + ((int64_t) 8 * segred_tblock_sizze_44039 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44039, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_44039 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44039, (int64_t) 8), (int64_t) 8)), n_36875, num_tblocks_44041, num_threads_48132, ks_mem_47844.mem, mem_47846.mem, mem_47847.mem, counters_mem_48106.mem, segred_tmp_mem_48128.mem, segred_tmp_mem_48130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
        return 1;
    
    int64_t read_res_49010;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_49010, mem_47846.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_43595 = read_res_49010;
    
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    prim_out_48103 = defunc_0_reduce_comm_res_43595;
    *out_prim_out_49009 = prim_out_48103;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_48130, "segred_tmp_mem_48130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_48128, "segred_tmp_mem_48128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_49011, struct memblock_device ks_mem_47844, int64_t n_36543)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device segred_tmp_mem_48130;
    
    segred_tmp_mem_48130.references = NULL;
    
    struct memblock_device segred_tmp_mem_48128;
    
    segred_tmp_mem_48128.references = NULL;
    
    struct memblock_device mem_47847;
    
    mem_47847.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    int64_t segred_tblock_sizze_44017;
    
    segred_tblock_sizze_44017 = *ctx->tuning_params.argmin_shortzisegred_tblock_sizze_44016;
    
    int64_t num_tblocks_44019;
    int64_t max_num_tblocks_48104;
    
    max_num_tblocks_48104 = *ctx->tuning_params.argmin_shortzisegred_num_tblocks_44018;
    num_tblocks_44019 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_36543, segred_tblock_sizze_44017), max_num_tblocks_48104)));
    if (memblock_alloc_device(ctx, &mem_47846, (int64_t) 8, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47847, (int64_t) 2, "mem_47847")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegRed");
    
    int64_t chunk_sizze_48105 = (int64_t) 1;
    
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48128, (int64_t) 8 * num_tblocks_44019, "segred_tmp_mem_48128")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &segred_tmp_mem_48130, (int64_t) 2 * num_tblocks_44019, "segred_tmp_mem_48130")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_48132 = num_tblocks_44019 * segred_tblock_sizze_44017;
    
    {
        err = gpu_kernel_argmin_shortzisegred_nonseg_44025(ctx, num_tblocks_44019, 1, 1, *ctx->tuning_params.argmin_shortzisegred_tblock_sizze_44016, 1, 1, 8 + ((int64_t) 2 * segred_tblock_sizze_44017 + srem64((int64_t) 8 - srem64((int64_t) 2 * segred_tblock_sizze_44017, (int64_t) 8), (int64_t) 8)) + ((int64_t) 8 * segred_tblock_sizze_44017 + srem64((int64_t) 8 - srem64((int64_t) 8 * segred_tblock_sizze_44017, (int64_t) 8), (int64_t) 8)), n_36543, num_tblocks_44019, num_threads_48132, ks_mem_47844.mem, mem_47846.mem, mem_47847.mem, counters_mem_48106.mem, segred_tmp_mem_48128.mem, segred_tmp_mem_48130.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
        return 1;
    
    int64_t read_res_49012;
    
    if ((err = gpu_scalar_from_device(ctx, &read_res_49012, mem_47846.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t))) != 0)
        goto cleanup;
    if (ctx->failure_is_an_option && futhark_context_sync(ctx) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_43595 = read_res_49012;
    
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    prim_out_48103 = defunc_0_reduce_comm_res_43595;
    *out_prim_out_49011 = prim_out_48103;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &segred_tmp_mem_48130, "segred_tmp_mem_48130") != 0)
            return 1;
        if (memblock_unref_device(ctx, &segred_tmp_mem_48128, "segred_tmp_mem_48128") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47847, "mem_47847") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeFunc(struct futhark_context *ctx, struct memblock_device *mem_out_p_49013, struct memblock_device *mem_out_p_49014, struct memblock_device *mem_out_p_49015, struct memblock_device xs_mem_47844, struct memblock_device ys_mem_47845, int64_t w1_37999, int64_t w2_38000)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47913;
    
    mem_47913.references = NULL;
    
    struct memblock_device mem_47911;
    
    mem_47911.references = NULL;
    
    struct memblock_device mem_47909;
    
    mem_47909.references = NULL;
    
    struct memblock_device mem_47981;
    
    mem_47981.references = NULL;
    
    struct memblock_device mem_47979;
    
    mem_47979.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device ext_mem_47984;
    
    ext_mem_47984.references = NULL;
    
    struct memblock_device mem_out_48105;
    
    mem_out_48105.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    bool suff_outer_par_44071;
    
    suff_outer_par_44071 = *ctx->tuning_params.mergeFunczisuff_outer_par_0 <= w1_37999;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "mergeFunc.suff_outer_par_0", (long) w1_37999, suff_outer_par_44071 ? "true" : "false");
    
    int64_t tile_sizze_47384;
    
    tile_sizze_47384 = *ctx->tuning_params.mergeFunczitile_sizze_47383;
    
    int64_t tile_sizze_46989;
    
    tile_sizze_46989 = *ctx->tuning_params.mergeFunczitile_sizze_46988;
    
    int64_t num_whole_tiles_47399 = squot_safe64(w2_38000, tile_sizze_47384);
    int64_t residual_input_47653 = srem_safe64(w2_38000, tile_sizze_47384);
    bool cond_47654 = residual_input_47653 == (int64_t) 0;
    int64_t binop_x_47670 = tile_sizze_47384 * num_whole_tiles_47399;
    int64_t bytes_47908 = (int64_t) 8 * w1_37999;
    int64_t bytes_47910 = (int64_t) 4 * w1_37999;
    int64_t bytes_47866 = (int64_t) 8 * tile_sizze_47384;
    int64_t bytes_47868 = (int64_t) 4 * tile_sizze_47384;
    int64_t num_whole_tiles_47004 = squot_safe64(w2_38000, tile_sizze_46989);
    int64_t residual_input_47258 = srem_safe64(w2_38000, tile_sizze_46989);
    bool cond_47259 = residual_input_47258 == (int64_t) 0;
    int64_t binop_x_47275 = tile_sizze_46989 * num_whole_tiles_47004;
    int64_t bytes_47934 = (int64_t) 8 * tile_sizze_46989;
    int64_t bytes_47936 = (int64_t) 4 * tile_sizze_46989;
    int64_t shared_memory_capacity_48160;
    
    shared_memory_capacity_48160 = ctx->max_shared_memory;
    if (suff_outer_par_44071 && sle64(sdiv_up64(bytes_47934, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47936, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47934, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48160)) {
        int64_t ldim_46990 = sdiv_up64(w1_37999, tile_sizze_46989);
        
        if (memblock_alloc_device(ctx, &mem_47977, bytes_47908, "mem_47977")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_47979, bytes_47910, "mem_47979")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_47981, bytes_47908, "mem_47981")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_48106 = sext_i64_i32(sdiv_up64(tile_sizze_46989, tile_sizze_46989));
        int32_t virt_num_tblocks_48107 = sext_i64_i32(ldim_46990);
        
        {
            err = gpu_kernel_mergeFunczisegmap_intrablock_46987(ctx, ldim_46990, 1, 1, *ctx->tuning_params.mergeFunczitile_sizze_46988, 1, 1, bytes_47934 + srem64((int64_t) 8 - srem64(bytes_47934, (int64_t) 8), (int64_t) 8) + (bytes_47936 + srem64((int64_t) 8 - srem64(bytes_47936, (int64_t) 8), (int64_t) 8)) + (bytes_47934 + srem64((int64_t) 8 - srem64(bytes_47934, (int64_t) 8), (int64_t) 8)), w1_37999, w2_38000, ldim_46990, num_whole_tiles_47004, residual_input_47258, cond_47259, binop_x_47275, xs_mem_47844.mem, ys_mem_47845.mem, mem_47977.mem, mem_47979.mem, mem_47981.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_47984, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_47983, &mem_47979, "mem_47979") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_47982, &mem_47981, "mem_47981") != 0)
            return 1;
    } else {
        int64_t ldim_47385 = sdiv_up64(w1_37999, tile_sizze_47384);
        
        if (memblock_alloc_device(ctx, &mem_47909, bytes_47908, "mem_47909")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_47911, bytes_47910, "mem_47911")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc_device(ctx, &mem_47913, bytes_47908, "mem_47913")) {
            err = 1;
            goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t num_chunks_48133 = sext_i64_i32(sdiv_up64(tile_sizze_47384, tile_sizze_47384));
        int32_t virt_num_tblocks_48134 = sext_i64_i32(ldim_47385);
        
        {
            err = gpu_kernel_mergeFunczisegmap_intrablock_47382(ctx, ldim_47385, 1, 1, *ctx->tuning_params.mergeFunczitile_sizze_47383, 1, 1, bytes_47866 + srem64((int64_t) 8 - srem64(bytes_47866, (int64_t) 8), (int64_t) 8) + (bytes_47868 + srem64((int64_t) 8 - srem64(bytes_47868, (int64_t) 8), (int64_t) 8)) + (bytes_47866 + srem64((int64_t) 8 - srem64(bytes_47866, (int64_t) 8), (int64_t) 8)), w1_37999, w2_38000, ldim_47385, num_whole_tiles_47399, residual_input_47653, cond_47654, binop_x_47670, xs_mem_47844.mem, ys_mem_47845.mem, mem_47909.mem, mem_47911.mem, mem_47913.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_set_device(ctx, &ext_mem_47984, &mem_47909, "mem_47909") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_47983, &mem_47911, "mem_47911") != 0)
            return 1;
        if (memblock_set_device(ctx, &ext_mem_47982, &mem_47913, "mem_47913") != 0)
            return 1;
    }
    if (memblock_set_device(ctx, &mem_out_48103, &ext_mem_47984, "ext_mem_47984") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &ext_mem_47983, "ext_mem_47983") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48105, &ext_mem_47982, "ext_mem_47982") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49013, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49014, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49015, &mem_out_48105, "mem_out_48105") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47913, "mem_47913") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47911, "mem_47911") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47909, "mem_47909") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47981, "mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47979, "mem_47979") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47984, "ext_mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48105, "mem_out_48105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_49016, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36374, int64_t n_36375, int64_t incr_36376)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t bytes_47847 = (int64_t) 8 * ni_36374;
    int64_t segmap_tblock_sizze_44416;
    
    segmap_tblock_sizze_44416 = *ctx->tuning_params.orderByIndices_doublezisegmap_tblock_sizze_44403;
    
    int64_t segmap_usable_groups_44417 = sdiv_up64(ni_36374, segmap_tblock_sizze_44416);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48104 = sext_i64_i32(sdiv_up64(ni_36374, segmap_tblock_sizze_44416));
    
    {
        err = gpu_kernel_orderByIndices_doublezisegmap_44420(ctx, segmap_usable_groups_44417, 1, 1, *ctx->tuning_params.orderByIndices_doublezisegmap_tblock_sizze_44403, 1, 1, (int64_t) 0, ni_36374, n_36375, incr_36376, is_mem_47844.mem, ys_mem_47845.mem, mem_47848.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49016, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_49017, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36220, int64_t n_36221, int64_t incr_36222)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t bytes_47847 = (int64_t) 4 * ni_36220;
    int64_t segmap_tblock_sizze_44388;
    
    segmap_tblock_sizze_44388 = *ctx->tuning_params.orderByIndices_floatzisegmap_tblock_sizze_44375;
    
    int64_t segmap_usable_groups_44389 = sdiv_up64(ni_36220, segmap_tblock_sizze_44388);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48104 = sext_i64_i32(sdiv_up64(ni_36220, segmap_tblock_sizze_44388));
    
    {
        err = gpu_kernel_orderByIndices_floatzisegmap_44392(ctx, segmap_usable_groups_44389, 1, 1, *ctx->tuning_params.orderByIndices_floatzisegmap_tblock_sizze_44375, 1, 1, (int64_t) 0, ni_36220, n_36221, incr_36222, is_mem_47844.mem, ys_mem_47845.mem, mem_47848.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49017, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_49018, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_35915, int64_t n_35916, int64_t incr_35917)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t bytes_47847 = (int64_t) 4 * ni_35915;
    int64_t segmap_tblock_sizze_44332;
    
    segmap_tblock_sizze_44332 = *ctx->tuning_params.orderByIndices_intzisegmap_tblock_sizze_44319;
    
    int64_t segmap_usable_groups_44333 = sdiv_up64(ni_35915, segmap_tblock_sizze_44332);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48104 = sext_i64_i32(sdiv_up64(ni_35915, segmap_tblock_sizze_44332));
    
    {
        err = gpu_kernel_orderByIndices_intzisegmap_44336(ctx, segmap_usable_groups_44333, 1, 1, *ctx->tuning_params.orderByIndices_intzisegmap_tblock_sizze_44319, 1, 1, (int64_t) 0, ni_35915, n_35916, incr_35917, is_mem_47844.mem, ys_mem_47845.mem, mem_47848.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49018, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_49019, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_36066, int64_t n_36067, int64_t incr_36068)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t bytes_47847 = (int64_t) 8 * ni_36066;
    int64_t segmap_tblock_sizze_44360;
    
    segmap_tblock_sizze_44360 = *ctx->tuning_params.orderByIndices_longzisegmap_tblock_sizze_44347;
    
    int64_t segmap_usable_groups_44361 = sdiv_up64(ni_36066, segmap_tblock_sizze_44360);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48104 = sext_i64_i32(sdiv_up64(ni_36066, segmap_tblock_sizze_44360));
    
    {
        err = gpu_kernel_orderByIndices_longzisegmap_44364(ctx, segmap_usable_groups_44361, 1, 1, *ctx->tuning_params.orderByIndices_longzisegmap_tblock_sizze_44347, 1, 1, (int64_t) 0, ni_36066, n_36067, incr_36068, is_mem_47844.mem, ys_mem_47845.mem, mem_47848.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49019, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_49020, struct memblock_device is_mem_47844, struct memblock_device ys_mem_47845, int64_t ni_35761, int64_t n_35762, int64_t incr_35763)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t bytes_47847 = (int64_t) 2 * ni_35761;
    int64_t segmap_tblock_sizze_44304;
    
    segmap_tblock_sizze_44304 = *ctx->tuning_params.orderByIndices_shortzisegmap_tblock_sizze_44291;
    
    int64_t segmap_usable_groups_44305 = sdiv_up64(ni_35761, segmap_tblock_sizze_44304);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48104 = sext_i64_i32(sdiv_up64(ni_35761, segmap_tblock_sizze_44304));
    
    {
        err = gpu_kernel_orderByIndices_shortzisegmap_44308(ctx, segmap_usable_groups_44305, 1, 1, *ctx->tuning_params.orderByIndices_shortzisegmap_tblock_sizze_44291, 1, 1, (int64_t) 0, ni_35761, n_35762, incr_35763, is_mem_47844.mem, ys_mem_47845.mem, mem_47848.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49020, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partitionFunc(struct futhark_context *ctx, struct memblock_device *mem_out_p_49021, struct memblock_device *mem_out_p_49022, struct memblock_device as_mem_47844, struct memblock_device bs_mem_47845, int64_t na_37612, int64_t nb_37613, int64_t threads_37614)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_47850;
    
    mem_47850.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    bool zzero_38588 = threads_37614 == (int64_t) 0;
    bool nonzzero_38589 = !zzero_38588;
    bool nonzzero_cert_38590;
    
    if (!nonzzero_38589) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftsort.fut:95:30-38\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftsort.fut:93:38-119:6\n   #3  ftsort.fut:89:1-120:43\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47847 = (int64_t) 8 * threads_37614;
    int64_t zt_rhs_38587 = add64(na_37612, nb_37613);
    int64_t segmap_tblock_sizze_43938;
    
    segmap_tblock_sizze_43938 = *ctx->tuning_params.partitionFunczisegmap_tblock_sizze_43861;
    
    int64_t segmap_usable_groups_43939 = sdiv_up64(threads_37614, segmap_tblock_sizze_43938);
    
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47850, bytes_47847, "mem_47850")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48105 = sext_i64_i32(sdiv_up64(threads_37614, segmap_tblock_sizze_43938));
    
    {
        err = gpu_kernel_partitionFunczisegmap_43943(ctx, segmap_usable_groups_43939, 1, 1, *ctx->tuning_params.partitionFunczisegmap_tblock_sizze_43861, 1, 1, (int64_t) 0, na_37612, nb_37613, threads_37614, zt_rhs_38587, as_mem_47844.mem, bs_mem_47845.mem, mem_47848.mem, mem_47850.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_set_device(ctx, &mem_out_48103, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_47850, "mem_47850") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49021, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49022, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_47850, "mem_47850") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_double(struct futhark_context *ctx, struct memblock_device *mem_out_p_49023, struct memblock_device *mem_out_p_49024, struct memblock_device xs_mem_47844, int64_t n_35607, int64_t incr_35608, int16_t block_sizze_35609)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_48007;
    
    mem_48007.references = NULL;
    
    struct memblock_device mem_48005;
    
    mem_48005.references = NULL;
    
    struct memblock_device incprefixes_mem_48880;
    
    incprefixes_mem_48880.references = NULL;
    
    struct memblock_device aggregates_mem_48878;
    
    aggregates_mem_48878.references = NULL;
    
    struct memblock_device status_flags_mem_48876;
    
    status_flags_mem_48876.references = NULL;
    
    struct memblock_device mem_47947;
    
    mem_47947.references = NULL;
    
    struct memblock_device mem_47931;
    
    mem_47931.references = NULL;
    
    struct memblock_device mem_47927;
    
    mem_47927.references = NULL;
    
    struct memblock_device mem_47910;
    
    mem_47910.references = NULL;
    
    struct memblock_device mem_47908;
    
    mem_47908.references = NULL;
    
    struct memblock_device mem_47906;
    
    mem_47906.references = NULL;
    
    struct memblock_device mem_47904;
    
    mem_47904.references = NULL;
    
    struct memblock_device incprefixes_mem_48548;
    
    incprefixes_mem_48548.references = NULL;
    
    struct memblock_device aggregates_mem_48546;
    
    aggregates_mem_48546.references = NULL;
    
    struct memblock_device incprefixes_mem_48544;
    
    incprefixes_mem_48544.references = NULL;
    
    struct memblock_device aggregates_mem_48542;
    
    aggregates_mem_48542.references = NULL;
    
    struct memblock_device incprefixes_mem_48540;
    
    incprefixes_mem_48540.references = NULL;
    
    struct memblock_device aggregates_mem_48538;
    
    aggregates_mem_48538.references = NULL;
    
    struct memblock_device incprefixes_mem_48536;
    
    incprefixes_mem_48536.references = NULL;
    
    struct memblock_device aggregates_mem_48534;
    
    aggregates_mem_48534.references = NULL;
    
    struct memblock_device status_flags_mem_48532;
    
    status_flags_mem_48532.references = NULL;
    
    struct memblock_device mem_47901;
    
    mem_47901.references = NULL;
    
    struct memblock_device mem_47898;
    
    mem_47898.references = NULL;
    
    struct memblock_device mem_47895;
    
    mem_47895.references = NULL;
    
    struct memblock_device mem_47892;
    
    mem_47892.references = NULL;
    
    struct memblock_device mem_47889;
    
    mem_47889.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device mem_47974;
    
    mem_47974.references = NULL;
    
    struct memblock_device mem_47971;
    
    mem_47971.references = NULL;
    
    struct memblock_device mem_47968;
    
    mem_47968.references = NULL;
    
    struct memblock_device ext_mem_47980;
    
    ext_mem_47980.references = NULL;
    
    struct memblock_device ext_mem_47981;
    
    ext_mem_47981.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device mem_47869;
    
    mem_47869.references = NULL;
    
    struct memblock_device mem_47868;
    
    mem_47868.references = NULL;
    
    struct memblock_device mem_47867;
    
    mem_47867.references = NULL;
    
    struct memblock_device mem_47866;
    
    mem_47866.references = NULL;
    
    struct memblock_device mem_47870;
    
    mem_47870.references = NULL;
    
    struct memblock_device ext_mem_47871;
    
    ext_mem_47871.references = NULL;
    
    struct memblock_device ext_mem_47872;
    
    ext_mem_47872.references = NULL;
    
    struct memblock_device ext_mem_47873;
    
    ext_mem_47873.references = NULL;
    
    struct memblock_device ext_mem_47874;
    
    ext_mem_47874.references = NULL;
    
    struct memblock_device incprefixes_mem_48177;
    
    incprefixes_mem_48177.references = NULL;
    
    struct memblock_device aggregates_mem_48175;
    
    aggregates_mem_48175.references = NULL;
    
    struct memblock_device incprefixes_mem_48173;
    
    incprefixes_mem_48173.references = NULL;
    
    struct memblock_device aggregates_mem_48171;
    
    aggregates_mem_48171.references = NULL;
    
    struct memblock_device incprefixes_mem_48169;
    
    incprefixes_mem_48169.references = NULL;
    
    struct memblock_device aggregates_mem_48167;
    
    aggregates_mem_48167.references = NULL;
    
    struct memblock_device incprefixes_mem_48165;
    
    incprefixes_mem_48165.references = NULL;
    
    struct memblock_device aggregates_mem_48163;
    
    aggregates_mem_48163.references = NULL;
    
    struct memblock_device status_flags_mem_48141;
    
    status_flags_mem_48141.references = NULL;
    
    struct memblock_device mem_47995;
    
    mem_47995.references = NULL;
    
    struct memblock_device mem_47992;
    
    mem_47992.references = NULL;
    
    struct memblock_device mem_47989;
    
    mem_47989.references = NULL;
    
    struct memblock_device mem_47987;
    
    mem_47987.references = NULL;
    
    struct memblock_device mem_47986;
    
    mem_47986.references = NULL;
    
    struct memblock_device mem_47985;
    
    mem_47985.references = NULL;
    
    struct memblock_device mem_47984;
    
    mem_47984.references = NULL;
    
    struct memblock_device mem_47885;
    
    mem_47885.references = NULL;
    
    struct memblock_device mem_47882;
    
    mem_47882.references = NULL;
    
    struct memblock_device mem_47878;
    
    mem_47878.references = NULL;
    
    struct memblock_device mem_47876;
    
    mem_47876.references = NULL;
    
    struct memblock_device mem_47865;
    
    mem_47865.references = NULL;
    
    struct memblock_device mem_47863;
    
    mem_47863.references = NULL;
    
    struct memblock_device mem_47861;
    
    mem_47861.references = NULL;
    
    struct memblock_device mem_47859;
    
    mem_47859.references = NULL;
    
    struct memblock_device mem_47857;
    
    mem_47857.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t rng_43219 = add64(n_35607, incr_35608);
    bool bounds_invalid_upwards_43220 = slt64(rng_43219, incr_35608);
    bool valid_43221 = !bounds_invalid_upwards_43220;
    bool range_valid_c_43222;
    
    if (!valid_43221) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_35608, "..<", (long long) rng_43219, " is invalid.", "-> #0  ftbasics.fut:18:25-40\n   #1  ftbasics.fut:174:32-58\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:174:32-63\n   #4  ftsort.fut:28:3-47\n   #5  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_43223 = n_35607 == (int64_t) 0;
    int32_t iters_43224;
    
    if (cond_43223) {
        iters_43224 = 0;
    } else {
        iters_43224 = 32;
    }
    
    int64_t i16_res_43225 = sext_i16_i64(block_sizze_35609);
    bool zzero_43226 = i16_res_43225 == (int64_t) 0;
    bool nonzzero_43227 = !zzero_43226;
    bool nonzzero_cert_43228;
    
    if (!nonzzero_43227) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:222:20-27\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #4  ftbasics.fut:175:95-98\n   #5  ftsort.fut:28:3-47\n   #6  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t n_blocks_43229 = sdiv64(n_35607, i16_res_43225);
    int64_t rest_43230 = smod64(n_35607, i16_res_43225);
    int64_t arg_43231 = mul64(i16_res_43225, n_blocks_43229);
    int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232 = add64(rest_43230, arg_43231);
    bool dim_match_43233 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232 == n_35607;
    bool empty_or_match_cert_43234;
    
    if (!dim_match_43233) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) n_35607, "] cannot match shape of type `[", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "](f64, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:224:12-46\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #3  /prelude/functional.fut:9:44-45\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #5  ftbasics.fut:175:95-98\n   #6  ftsort.fut:28:3-47\n   #7  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47845 = (int64_t) 8 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;
    bool loop_nonempty_43238 = slt32(0, iters_43224);
    int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 = add64((int64_t) 1, n_blocks_43229);
    int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240 = mul64((int64_t) 4, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);
    bool empty_slice_43241 = arg_43231 == (int64_t) 0;
    int64_t m_43242 = sub64(arg_43231, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_43243 = sle64((int64_t) 0, m_43242);
    bool i_p_m_t_s_leq_w_43244 = slt64(m_43242, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool i_lte_j_43245 = sle64((int64_t) 0, arg_43231);
    bool y_43246 = zzero_leq_i_p_m_t_s_43243 && i_p_m_t_s_leq_w_43244;
    bool forwards_ok_43247 = i_lte_j_43245 && y_43246;
    bool ok_or_empty_43248 = empty_slice_43241 || forwards_ok_43247;
    bool loop_not_taken_43249 = !loop_nonempty_43238;
    bool protect_assert_disj_43250 = ok_or_empty_43248 || loop_not_taken_43249;
    bool index_certs_43251;
    
    if (!protect_assert_disj_43250) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) arg_43231, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "].", "-> #0  /prelude/array.fut:65:4-11\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:28:3-47\n   #8  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_43252 = rest_43230 == (int64_t) 0;
    int64_t m_43253 = sub64(rest_43230, (int64_t) 1);
    int64_t i_p_m_t_s_43254 = add64(arg_43231, m_43253);
    bool zzero_leq_i_p_m_t_s_43255 = sle64((int64_t) 0, i_p_m_t_s_43254);
    bool i_p_m_t_s_leq_w_43256 = slt64(i_p_m_t_s_43254, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool i_lte_j_43257 = sle64(arg_43231, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool y_43258 = zzero_leq_i_p_m_t_s_43255 && i_p_m_t_s_leq_w_43256;
    bool forwards_ok_43259 = i_lte_j_43257 && y_43258;
    bool ok_or_empty_43260 = empty_slice_43252 || forwards_ok_43259;
    bool protect_assert_disj_43261 = loop_not_taken_43249 || ok_or_empty_43260;
    bool index_certs_43262;
    
    if (!protect_assert_disj_43261) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_43231, ":", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "].", "-> #0  /prelude/array.fut:65:13-24\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:28:3-47\n   #8  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool binop_x_43263 = sle64((int64_t) 0, n_blocks_43229);
    bool binop_y_43264 = sle64((int64_t) 0, i16_res_43225);
    bool binop_y_43265 = binop_x_43263 && binop_y_43264;
    bool protect_assert_disj_43266 = loop_not_taken_43249 || binop_y_43265;
    bool dim_ok_cert_43267;
    
    if (!protect_assert_disj_43266) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Cannot unflatten array of shape [", (long long) arg_43231, "] to array of shape [", (long long) n_blocks_43229, "][", (long long) i16_res_43225, "]", "-> #0  /prelude/array.fut:184:3-30\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-168:21\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:28:3-47\n   #8  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_43268 = sub64(i16_res_43225, (int64_t) 1);
    bool x_43269 = sle64((int64_t) 0, tmp_43268);
    bool y_43270 = slt64(tmp_43268, i16_res_43225);
    bool bounds_check_43271 = x_43269 && y_43270;
    bool protect_assert_disj_43272 = zzero_43226 || bounds_check_43271;
    bool protect_assert_disj_43273 = loop_not_taken_43249 || protect_assert_disj_43272;
    bool index_certs_43274;
    
    if (!protect_assert_disj_43273) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_43268, "] out of bounds for array of shape [", (long long) i16_res_43225, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_43276 = slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);
    bool protect_assert_disj_43277 = loop_not_taken_43249 || y_43276;
    bool index_certs_43278;
    
    if (!protect_assert_disj_43277) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, "].", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:122:3-123:7\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:178:8-20\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_43280 = nonzzero_43227 || loop_not_taken_43249;
    bool nonzzero_cert_43281;
    
    if (!protect_assert_disj_43280) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:186:27-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_43282 = sle64((int64_t) 0, m_43253);
    bool y_43283 = slt64(m_43253, rest_43230);
    bool bounds_check_43284 = x_43282 && y_43283;
    bool protect_assert_disj_43285 = empty_slice_43252 || bounds_check_43284;
    bool protect_assert_disj_43286 = loop_not_taken_43249 || protect_assert_disj_43285;
    bool index_certs_43287;
    
    if (!protect_assert_disj_43286) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_43253, "] out of bounds for array of shape [", (long long) rest_43230, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:28:3-47\n   #8  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47856 = (int64_t) 2 * rest_43230;
    int64_t bytes_47875 = (int64_t) 8 * rest_43230;
    int64_t binop_x_47880 = (int64_t) 8 * n_blocks_43229;
    int64_t bytes_47881 = i16_res_43225 * binop_x_47880;
    int64_t bytes_47991 = (int64_t) 32 * dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239;
    bool dim_match_43560 = n_35607 == dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;
    bool empty_or_match_cert_43561;
    
    if (!dim_match_43560) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "] cannot match shape of type `[", (long long) n_35607, "](f64, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:225:6-11\n   #2  /prelude/functional.fut:26:41-42\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:226:6-227:50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:28:3-47\n   #9  ftsort.fut:27:1-28:47\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_48004 = (int64_t) 8 * n_35607;
    
    if (memblock_alloc_device(ctx, &mem_47846, bytes_47845, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xs_mem_47844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47845, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_47848, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_45912;
    
    segscan_tblock_sizze_45912 = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_45911;
    
    int64_t num_tblocks_45914;
    int64_t max_num_tblocks_48122;
    
    max_num_tblocks_48122 = *ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_45913;
    num_tblocks_45914 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_43230, segscan_tblock_sizze_45912), max_num_tblocks_48122)));
    
    int64_t segmap_tblock_sizze_45922;
    
    segmap_tblock_sizze_45922 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45921;
    
    int64_t num_tblocks_45924;
    int64_t max_num_tblocks_48123;
    
    max_num_tblocks_48123 = *ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_45923;
    num_tblocks_45924 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_43230, segmap_tblock_sizze_45922), max_num_tblocks_48123)));
    
    int64_t segmap_tblock_sizze_45937;
    
    segmap_tblock_sizze_45937 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45929;
    
    int64_t segmap_usable_groups_45938 = sdiv_up_safe64((int64_t) 4, segmap_tblock_sizze_45937);
    int64_t intra_avail_par_45957 = smin64((int64_t) 4, i16_res_43225);
    int64_t computed_tblock_sizze_45946 = smax64((int64_t) 4, i16_res_43225);
    int64_t max_tblock_sizze_45965;
    
    max_tblock_sizze_45965 = ctx->max_thread_block_size;
    
    bool fits_45966 = sle64(computed_tblock_sizze_45946, max_tblock_sizze_45965);
    bool suff_intra_par_45964;
    
    suff_intra_par_45964 = *ctx->tuning_params.sortColumn_doublezisuff_intra_par_0 <= intra_avail_par_45957;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "sortColumn_double.suff_intra_par_0", (long) intra_avail_par_45957, suff_intra_par_45964 ? "true" : "false");
    
    bool intra_suff_and_fits_45967 = suff_intra_par_45964 && fits_45966;
    int64_t segscan_tblock_sizze_46230;
    
    segscan_tblock_sizze_46230 = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46177;
    
    int64_t num_tblocks_46231;
    int64_t max_num_tblocks_48124;
    
    max_num_tblocks_48124 = *ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_46179;
    num_tblocks_46231 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_43231, segscan_tblock_sizze_46230), max_num_tblocks_48124)));
    
    int64_t segmap_tblock_sizze_46283;
    
    segmap_tblock_sizze_46283 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46157;
    
    int64_t segmap_tblock_sizze_46305;
    
    segmap_tblock_sizze_46305 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46135;
    
    int64_t num_tblocks_46306;
    int64_t max_num_tblocks_48125;
    
    max_num_tblocks_48125 = *ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46137;
    num_tblocks_46306 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_43231, segmap_tblock_sizze_46305), max_num_tblocks_48125)));
    
    int64_t segmap_tblock_sizze_46325;
    
    segmap_tblock_sizze_46325 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46113;
    
    int64_t num_tblocks_46326;
    int64_t max_num_tblocks_48126;
    
    max_num_tblocks_48126 = *ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46115;
    num_tblocks_46326 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_46325), max_num_tblocks_48126)));
    
    int64_t nest_sizze_46341 = (int64_t) 4 * n_blocks_43229;
    int64_t segmap_tblock_sizze_46342;
    
    segmap_tblock_sizze_46342 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46091;
    
    int64_t segmap_tblock_sizze_46352;
    
    segmap_tblock_sizze_46352 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46064;
    
    int64_t num_tblocks_46353;
    int64_t max_num_tblocks_48127;
    
    max_num_tblocks_48127 = *ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46066;
    num_tblocks_46353 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_46352), max_num_tblocks_48127)));
    
    int64_t segscan_tblock_sizze_46370;
    
    segscan_tblock_sizze_46370 = *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46369;
    
    int64_t num_tblocks_46372;
    int64_t max_num_tblocks_48128;
    
    max_num_tblocks_48128 = *ctx->tuning_params.sortColumn_doublezisegscan_num_tblocks_46371;
    num_tblocks_46372 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segscan_tblock_sizze_46370), max_num_tblocks_48128)));
    
    int64_t segmap_tblock_sizze_46389;
    
    segmap_tblock_sizze_46389 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46379;
    
    int64_t segmap_usable_groups_46390 = sdiv_up_safe64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segmap_tblock_sizze_46389);
    int64_t segmap_tblock_sizze_46402;
    
    segmap_tblock_sizze_46402 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46401;
    
    int64_t num_tblocks_46404;
    int64_t max_num_tblocks_48129;
    
    max_num_tblocks_48129 = *ctx->tuning_params.sortColumn_doublezisegmap_num_tblocks_46403;
    num_tblocks_46404 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, segmap_tblock_sizze_46402), max_num_tblocks_48129)));
    
    int64_t segmap_usable_groups_46284 = sdiv_up_safe64(n_blocks_43229, segmap_tblock_sizze_46283);
    int64_t segmap_usable_groups_46343 = sdiv_up_safe64(nest_sizze_46341, segmap_tblock_sizze_46342);
    int64_t ext_47979;
    int64_t shared_memory_capacity_48130;
    
    shared_memory_capacity_48130 = ctx->max_shared_memory;
    if (intra_suff_and_fits_45967) {
        ext_47979 = (int64_t) 4;
    } else {
        ext_47979 = (int64_t) 1;
    }
    
    int64_t ext_47978;
    int64_t shared_memory_capacity_48131;
    
    shared_memory_capacity_48131 = ctx->max_shared_memory;
    if (intra_suff_and_fits_45967) {
        ext_47978 = (int64_t) 1;
    } else {
        ext_47978 = n_blocks_43229;
    }
    
    int64_t binop_x_47887 = (int64_t) 2 * n_blocks_43229;
    int64_t bytes_47888 = i16_res_43225 * binop_x_47887;
    int64_t binop_y_47918 = n_blocks_43229 - (int64_t) 1;
    int64_t binop_x_47920 = smax64((int64_t) 0, binop_y_47918);
    int64_t binop_y_47922 = (int64_t) 3 * n_blocks_43229;
    int64_t binop_y_47923 = smax64((int64_t) 0, binop_y_47922);
    int64_t binop_y_47924 = binop_x_47920 + binop_y_47923;
    int64_t binop_y_47925 = (int64_t) 1 + binop_y_47924;
    int64_t bytes_47926 = (int64_t) 2 * binop_y_47925;
    int64_t bytes_47930 = (int64_t) 32 * n_blocks_43229;
    int64_t bytes_47949 = (int64_t) 8 * i16_res_43225;
    int64_t bytes_47953 = (int64_t) 2 * i16_res_43225;
    
    if (memblock_alloc_device(ctx, &mem_47857, bytes_47856, "mem_47857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47859, bytes_47856, "mem_47859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47861, bytes_47856, "mem_47861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47863, bytes_47856, "mem_47863")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47865, bytes_47856, "mem_47865")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47876, bytes_47875, "mem_47876")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47878, bytes_47875, "mem_47878")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47882, bytes_47881, "mem_47882")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47885, bytes_47881, "mem_47885")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47984, (int64_t) 8, "mem_47984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47985, (int64_t) 8, "mem_47985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47986, (int64_t) 8, "mem_47986")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47987, (int64_t) 8, "mem_47987")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47989, (int64_t) 32, "mem_47989")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47992, bytes_47991, "mem_47992")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47995, bytes_47991, "mem_47995")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t maxSubHelper_48094 = umax64((int64_t) 8, bytes_47953);
    
    for (int32_t i_43290 = 0; i_43290 < iters_43224; i_43290++) {
        int32_t blocked_radix_sort_step_arg1_43293 = mul32(2, i_43290);
        int32_t get_bit_arg0_43298 = add32(1, blocked_radix_sort_step_arg1_43293);
        int64_t unsign_arg0_43299 = zext_i32_i64(get_bit_arg0_43298);
        bool cond_f_res_43300 = get_bit_arg0_43298 == 63;
        int64_t unsign_arg0_43301 = zext_i32_i64(blocked_radix_sort_step_arg1_43293);
        bool cond_f_res_43302 = blocked_radix_sort_step_arg1_43293 == 63;
        
        if (slt64((int64_t) 0, rest_43230)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48134;
            
            shared_memory_48134 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48135;
            
            thread_block_sizze_48135 = ctx->max_thread_block_size;
            
            int64_t registers_48136;
            
            registers_48136 = ctx->max_registers;
            
            int64_t thread_block_sizze_48137;
            
            thread_block_sizze_48137 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48138 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48134, thread_block_sizze_48135), (int64_t) 2), squot64(squot64(registers_48136, thread_block_sizze_48137) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
            int64_t num_virt_blocks_48139 = sdiv_up64(rest_43230, segscan_tblock_sizze_45912 * chunk_sizze_48138);
            int64_t num_virt_threads_48140 = num_virt_blocks_48139 * segscan_tblock_sizze_45912;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48138, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48141, num_virt_blocks_48139, "status_flags_mem_48141")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48141, num_virt_blocks_48139, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48163, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48163")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48165, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48165")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48167, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48167")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48169, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48169")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48171, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48173, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48175, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48177, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48177")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_doublezisegscan_45917(ctx, num_tblocks_45914, 1, 1, *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_45911, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45912), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45912 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), rest_43230, arg_43231, unsign_arg0_43299, cond_f_res_43300, unsign_arg0_43301, cond_f_res_43302, num_tblocks_45914, num_virt_blocks_48139, num_virt_threads_48140, mem_47846.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, status_flags_mem_48141.mem, aggregates_mem_48163.mem, incprefixes_mem_48165.mem, aggregates_mem_48167.mem, incprefixes_mem_48169.mem, aggregates_mem_48171.mem, incprefixes_mem_48173.mem, aggregates_mem_48175.mem, incprefixes_mem_48177.mem, global_dynid_mem_48179.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (empty_slice_43252) {
            if (memblock_alloc_device(ctx, &mem_47870, (int64_t) 2, "mem_47870")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i16(ctx, mem_47870, (int64_t) 1, (int16_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47870, "mem_47870") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47866, (int64_t) 2, "mem_47866")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47867, (int64_t) 2, "mem_47867")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47868, (int64_t) 2, "mem_47868")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47869, (int64_t) 2, "mem_47869")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_doublezigpuseq_48446(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_43253, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47866.mem, mem_47867.mem, mem_47868.mem, mem_47869.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47866, "mem_47866") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47867, "mem_47867") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47868, "mem_47868") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47869, "mem_47869") != 0)
                return 1;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47876.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47848.mem, (int64_t) 0 + (int64_t) 1 * arg_43231, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_43230})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47878.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47846.mem, (int64_t) 0 + (int64_t) 1 * arg_43231, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_43230})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48452 = sext_i64_i32(sdiv_up64(rest_43230, segmap_tblock_sizze_45922));
        
        {
            err = gpu_kernel_sortColumn_doublezisegmap_45919(ctx, num_tblocks_45924, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45921, 1, 1, (int64_t) 0, rest_43230, arg_43231, num_tblocks_45924, virt_num_tblocks_48452, mem_47846.mem, mem_47848.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47876.mem, mem_47878.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47882.mem, (int64_t) 0, (int64_t []) {i16_res_43225, (int64_t) 1}, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_43225, (int64_t) 1}, (int64_t []) {n_blocks_43229, i16_res_43225})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47885.mem, (int64_t) 0, (int64_t []) {i16_res_43225, (int64_t) 1}, mem_47848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_43225, (int64_t) 1}, (int64_t []) {n_blocks_43229, i16_res_43225})) != 0)
            goto cleanup;
        
        int64_t shared_memory_capacity_48853;
        
        shared_memory_capacity_48853 = ctx->max_shared_memory;
        if (intra_suff_and_fits_45967 && sle64(sdiv_up64(maxSubHelper_48094, (int64_t) 8) * (int64_t) 8 + (int64_t) 32 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48853)) {
            if (memblock_alloc_device(ctx, &mem_47968, bytes_47881, "mem_47968")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47971, bytes_47881, "mem_47971")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47974, bytes_47930, "mem_47974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47977, binop_x_47880, "mem_47977")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_48465 = sext_i64_i32(sdiv_up64((int64_t) 4, computed_tblock_sizze_45946));
            int32_t num_chunks_48466 = sext_i64_i32(sdiv_up64(i16_res_43225, computed_tblock_sizze_45946));
            int32_t virt_num_tblocks_48467 = sext_i64_i32(n_blocks_43229);
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_intrablock_45973(ctx, n_blocks_43229, 1, 1, computed_tblock_sizze_45946, 1, 1, bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (int64_t) 32 + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8)), i16_res_43225, zzero_43226, n_blocks_43229, tmp_43268, unsign_arg0_43299, cond_f_res_43300, unsign_arg0_43301, cond_f_res_43302, computed_tblock_sizze_45946, bytes_47949, bytes_47953, maxSubHelper_48094, mem_47846.mem, mem_47848.mem, mem_47968.mem, mem_47971.mem, mem_47974.mem, mem_47977.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47968, "mem_47968") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47971, "mem_47971") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47974, "mem_47974") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47977, "mem_47977") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47889, bytes_47888, "mem_47889")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47892, bytes_47888, "mem_47892")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47895, bytes_47888, "mem_47895")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47898, bytes_47888, "mem_47898")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47901, bytes_47888, "mem_47901")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, n_blocks_43229 * i16_res_43225)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_48525;
                
                shared_memory_48525 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_48526;
                
                thread_block_sizze_48526 = ctx->max_thread_block_size;
                
                int64_t registers_48527;
                
                registers_48527 = ctx->max_registers;
                
                int64_t thread_block_sizze_48528;
                
                thread_block_sizze_48528 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_48529 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48525, thread_block_sizze_48526), (int64_t) 2), squot64(squot64(registers_48527, thread_block_sizze_48528) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
                int64_t num_virt_blocks_48530 = sdiv_up64(n_blocks_43229 * i16_res_43225, segscan_tblock_sizze_46230 * chunk_sizze_48529);
                int64_t num_virt_threads_48531 = num_virt_blocks_48530 * segscan_tblock_sizze_46230;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48529, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_48532, num_virt_blocks_48530, "status_flags_mem_48532")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48532, num_virt_blocks_48530, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48534, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48534")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48536, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48536")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48538, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48538")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48540, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48540")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48542, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48542")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48544, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48544")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48546, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48546")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48548, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48548")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_sortColumn_doublezisegscan_46240(ctx, num_tblocks_46231, 1, 1, *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46177, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46230), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46230 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), i16_res_43225, n_blocks_43229, unsign_arg0_43299, cond_f_res_43300, unsign_arg0_43301, cond_f_res_43302, num_tblocks_46231, num_virt_blocks_48530, num_virt_threads_48531, mem_47846.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, status_flags_mem_48532.mem, aggregates_mem_48534.mem, incprefixes_mem_48536.mem, aggregates_mem_48538.mem, incprefixes_mem_48540.mem, aggregates_mem_48542.mem, incprefixes_mem_48544.mem, aggregates_mem_48546.mem, incprefixes_mem_48548.mem, global_dynid_mem_48550.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_47904, binop_x_47887, "mem_47904")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47906, binop_x_47887, "mem_47906")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47908, binop_x_47887, "mem_47908")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47910, binop_x_47887, "mem_47910")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48792 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_46283));
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_46290(ctx, segmap_usable_groups_46284, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46157, 1, 1, (int64_t) 0, i16_res_43225, zzero_43226, nonzzero_43227, n_blocks_43229, tmp_43268, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48801 = sext_i64_i32(sdiv_up64(n_blocks_43229 * i16_res_43225, segmap_tblock_sizze_46305));
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_46312(ctx, num_tblocks_46306, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46135, 1, 1, (int64_t) 0, i16_res_43225, n_blocks_43229, num_tblocks_46306, virt_num_tblocks_48801, mem_47846.mem, mem_47848.mem, mem_47882.mem, mem_47885.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47927, bytes_47926, "mem_47927")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48816 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_46325));
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_46330(ctx, num_tblocks_46326, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46113, 1, 1, (int64_t) 0, n_blocks_43229, num_tblocks_46326, virt_num_tblocks_48816, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47927.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47931, bytes_47930, "mem_47931")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48829 = sext_i64_i32(sdiv_up64(n_blocks_43229 * (int64_t) 4, segmap_tblock_sizze_46342));
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_46347(ctx, segmap_usable_groups_46343, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46091, 1, 1, (int64_t) 0, n_blocks_43229, mem_47927.mem, mem_47931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47947, bytes_47926, "mem_47947")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48840 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_46352));
            
            {
                err = gpu_kernel_sortColumn_doublezisegmap_46357(ctx, num_tblocks_46353, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46064, 1, 1, (int64_t) 0, n_blocks_43229, num_tblocks_46353, virt_num_tblocks_48840, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47947.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47882, "mem_47882") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47885, "mem_47885") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47931, "mem_47931") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47947, "mem_47947") != 0)
                return 1;
        }
        {
            err = gpu_kernel_sortColumn_doublezigpuseq_48854(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_47871.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47984.mem, mem_47985.mem, mem_47986.mem, mem_47987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48860 = sext_i64_i32(sdiv_up64((int64_t) 4, segmap_tblock_sizze_45937));
        
        {
            err = gpu_kernel_sortColumn_doublezisegmap_45941(ctx, segmap_usable_groups_45938, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_45929, 1, 1, (int64_t) 0, mem_47986.mem, mem_47989.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48869;
            
            shared_memory_48869 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48870;
            
            thread_block_sizze_48870 = ctx->max_thread_block_size;
            
            int64_t registers_48871;
            
            registers_48871 = ctx->max_registers;
            
            int64_t thread_block_sizze_48872;
            
            thread_block_sizze_48872 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48873 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48869, thread_block_sizze_48870), (int64_t) 8), squot64(squot64(registers_48871, thread_block_sizze_48872) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_48874 = sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segscan_tblock_sizze_46370 * chunk_sizze_48873);
            int64_t num_virt_threads_48875 = num_virt_blocks_48874 * segscan_tblock_sizze_46370;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48873, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48876, num_virt_blocks_48874, "status_flags_mem_48876")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48876, num_virt_blocks_48874, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48878, (int64_t) 8 * num_virt_blocks_48874, "aggregates_mem_48878")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48880, (int64_t) 8 * num_virt_blocks_48874, "incprefixes_mem_48880")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_doublezisegscan_46375(ctx, num_tblocks_46372, 1, 1, *ctx->tuning_params.sortColumn_doublezisegscan_tblock_sizze_46369, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46370), chunk_sizze_48873 * segscan_tblock_sizze_46370 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46370), chunk_sizze_48873 * segscan_tblock_sizze_46370 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_blocks_43229, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, num_tblocks_46372, num_virt_blocks_48874, num_virt_threads_48875, ext_mem_47981.mem, mem_47989.mem, mem_47992.mem, status_flags_mem_48876.mem, aggregates_mem_48878.mem, incprefixes_mem_48880.mem, global_dynid_mem_48882.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48971 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segmap_tblock_sizze_46389));
        
        {
            err = gpu_kernel_sortColumn_doublezisegmap_46393(ctx, segmap_usable_groups_46390, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46379, 1, 1, (int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, mem_47992.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t write_tmp_49025 = (int64_t) 0;
        
        if ((err = gpu_scalar_to_device(ctx, mem_47995.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t), &write_tmp_49025)) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48980 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, segmap_tblock_sizze_46402));
        
        {
            err = gpu_kernel_sortColumn_doublezisegmap_46399(ctx, num_tblocks_46404, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46401, 1, 1, (int64_t) 0, i16_res_43225, n_blocks_43229, arg_43231, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, blocked_radix_sort_step_arg1_43293, num_tblocks_46404, ext_47978, ext_47979, virt_num_tblocks_48980, mem_47846.mem, mem_47848.mem, mem_47876.mem, mem_47878.mem, ext_mem_47980.mem, ext_mem_47982.mem, ext_mem_47983.mem, mem_47987.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_46422;
    
    segmap_tblock_sizze_46422 = *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46409;
    
    int64_t segmap_usable_groups_46423 = sdiv_up64(n_35607, segmap_tblock_sizze_46422);
    
    if (memblock_alloc_device(ctx, &mem_48005, bytes_48004, "mem_48005")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_48007, bytes_48004, "mem_48007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48994 = sext_i64_i32(sdiv_up64(n_35607, segmap_tblock_sizze_46422));
    
    {
        err = gpu_kernel_sortColumn_doublezisegmap_46427(ctx, segmap_usable_groups_46423, 1, 1, *ctx->tuning_params.sortColumn_doublezisegmap_tblock_sizze_46409, 1, 1, (int64_t) 0, n_35607, incr_35608, xs_mem_47844.mem, mem_47848.mem, mem_48005.mem, mem_48007.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48103, &mem_48005, "mem_48005") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_48007, "mem_48007") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49023, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49024, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_48007, "mem_48007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_48005, "mem_48005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48880, "incprefixes_mem_48880") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48878, "aggregates_mem_48878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48876, "status_flags_mem_48876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47947, "mem_47947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47931, "mem_47931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48548, "incprefixes_mem_48548") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48546, "aggregates_mem_48546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48544, "incprefixes_mem_48544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48542, "aggregates_mem_48542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48540, "incprefixes_mem_48540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48538, "aggregates_mem_48538") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48536, "incprefixes_mem_48536") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48534, "aggregates_mem_48534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48532, "status_flags_mem_48532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47974, "mem_47974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47971, "mem_47971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47968, "mem_47968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47869, "mem_47869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47868, "mem_47868") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47867, "mem_47867") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47866, "mem_47866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47870, "mem_47870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48177, "incprefixes_mem_48177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48175, "aggregates_mem_48175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48173, "incprefixes_mem_48173") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48171, "aggregates_mem_48171") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48169, "incprefixes_mem_48169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48167, "aggregates_mem_48167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48165, "incprefixes_mem_48165") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48163, "aggregates_mem_48163") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48141, "status_flags_mem_48141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_float(struct futhark_context *ctx, struct memblock_device *mem_out_p_49026, struct memblock_device *mem_out_p_49027, struct memblock_device xs_mem_47844, int64_t n_32852, int64_t incr_32853, int16_t block_sizze_32854)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_48007;
    
    mem_48007.references = NULL;
    
    struct memblock_device mem_48005;
    
    mem_48005.references = NULL;
    
    struct memblock_device incprefixes_mem_48880;
    
    incprefixes_mem_48880.references = NULL;
    
    struct memblock_device aggregates_mem_48878;
    
    aggregates_mem_48878.references = NULL;
    
    struct memblock_device status_flags_mem_48876;
    
    status_flags_mem_48876.references = NULL;
    
    struct memblock_device mem_47947;
    
    mem_47947.references = NULL;
    
    struct memblock_device mem_47931;
    
    mem_47931.references = NULL;
    
    struct memblock_device mem_47927;
    
    mem_47927.references = NULL;
    
    struct memblock_device mem_47910;
    
    mem_47910.references = NULL;
    
    struct memblock_device mem_47908;
    
    mem_47908.references = NULL;
    
    struct memblock_device mem_47906;
    
    mem_47906.references = NULL;
    
    struct memblock_device mem_47904;
    
    mem_47904.references = NULL;
    
    struct memblock_device incprefixes_mem_48548;
    
    incprefixes_mem_48548.references = NULL;
    
    struct memblock_device aggregates_mem_48546;
    
    aggregates_mem_48546.references = NULL;
    
    struct memblock_device incprefixes_mem_48544;
    
    incprefixes_mem_48544.references = NULL;
    
    struct memblock_device aggregates_mem_48542;
    
    aggregates_mem_48542.references = NULL;
    
    struct memblock_device incprefixes_mem_48540;
    
    incprefixes_mem_48540.references = NULL;
    
    struct memblock_device aggregates_mem_48538;
    
    aggregates_mem_48538.references = NULL;
    
    struct memblock_device incprefixes_mem_48536;
    
    incprefixes_mem_48536.references = NULL;
    
    struct memblock_device aggregates_mem_48534;
    
    aggregates_mem_48534.references = NULL;
    
    struct memblock_device status_flags_mem_48532;
    
    status_flags_mem_48532.references = NULL;
    
    struct memblock_device mem_47901;
    
    mem_47901.references = NULL;
    
    struct memblock_device mem_47898;
    
    mem_47898.references = NULL;
    
    struct memblock_device mem_47895;
    
    mem_47895.references = NULL;
    
    struct memblock_device mem_47892;
    
    mem_47892.references = NULL;
    
    struct memblock_device mem_47889;
    
    mem_47889.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device mem_47974;
    
    mem_47974.references = NULL;
    
    struct memblock_device mem_47971;
    
    mem_47971.references = NULL;
    
    struct memblock_device mem_47968;
    
    mem_47968.references = NULL;
    
    struct memblock_device ext_mem_47980;
    
    ext_mem_47980.references = NULL;
    
    struct memblock_device ext_mem_47981;
    
    ext_mem_47981.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device mem_47869;
    
    mem_47869.references = NULL;
    
    struct memblock_device mem_47868;
    
    mem_47868.references = NULL;
    
    struct memblock_device mem_47867;
    
    mem_47867.references = NULL;
    
    struct memblock_device mem_47866;
    
    mem_47866.references = NULL;
    
    struct memblock_device mem_47870;
    
    mem_47870.references = NULL;
    
    struct memblock_device ext_mem_47871;
    
    ext_mem_47871.references = NULL;
    
    struct memblock_device ext_mem_47872;
    
    ext_mem_47872.references = NULL;
    
    struct memblock_device ext_mem_47873;
    
    ext_mem_47873.references = NULL;
    
    struct memblock_device ext_mem_47874;
    
    ext_mem_47874.references = NULL;
    
    struct memblock_device incprefixes_mem_48177;
    
    incprefixes_mem_48177.references = NULL;
    
    struct memblock_device aggregates_mem_48175;
    
    aggregates_mem_48175.references = NULL;
    
    struct memblock_device incprefixes_mem_48173;
    
    incprefixes_mem_48173.references = NULL;
    
    struct memblock_device aggregates_mem_48171;
    
    aggregates_mem_48171.references = NULL;
    
    struct memblock_device incprefixes_mem_48169;
    
    incprefixes_mem_48169.references = NULL;
    
    struct memblock_device aggregates_mem_48167;
    
    aggregates_mem_48167.references = NULL;
    
    struct memblock_device incprefixes_mem_48165;
    
    incprefixes_mem_48165.references = NULL;
    
    struct memblock_device aggregates_mem_48163;
    
    aggregates_mem_48163.references = NULL;
    
    struct memblock_device status_flags_mem_48141;
    
    status_flags_mem_48141.references = NULL;
    
    struct memblock_device mem_47995;
    
    mem_47995.references = NULL;
    
    struct memblock_device mem_47992;
    
    mem_47992.references = NULL;
    
    struct memblock_device mem_47989;
    
    mem_47989.references = NULL;
    
    struct memblock_device mem_47987;
    
    mem_47987.references = NULL;
    
    struct memblock_device mem_47986;
    
    mem_47986.references = NULL;
    
    struct memblock_device mem_47985;
    
    mem_47985.references = NULL;
    
    struct memblock_device mem_47984;
    
    mem_47984.references = NULL;
    
    struct memblock_device mem_47885;
    
    mem_47885.references = NULL;
    
    struct memblock_device mem_47882;
    
    mem_47882.references = NULL;
    
    struct memblock_device mem_47878;
    
    mem_47878.references = NULL;
    
    struct memblock_device mem_47876;
    
    mem_47876.references = NULL;
    
    struct memblock_device mem_47865;
    
    mem_47865.references = NULL;
    
    struct memblock_device mem_47863;
    
    mem_47863.references = NULL;
    
    struct memblock_device mem_47861;
    
    mem_47861.references = NULL;
    
    struct memblock_device mem_47859;
    
    mem_47859.references = NULL;
    
    struct memblock_device mem_47857;
    
    mem_47857.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t rng_43219 = add64(n_32852, incr_32853);
    bool bounds_invalid_upwards_43220 = slt64(rng_43219, incr_32853);
    bool valid_43221 = !bounds_invalid_upwards_43220;
    bool range_valid_c_43222;
    
    if (!valid_43221) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_32853, "..<", (long long) rng_43219, " is invalid.", "-> #0  ftbasics.fut:18:25-40\n   #1  ftbasics.fut:174:32-58\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:174:32-63\n   #4  ftsort.fut:25:3-46\n   #5  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_43223 = n_32852 == (int64_t) 0;
    int32_t iters_43224;
    
    if (cond_43223) {
        iters_43224 = 0;
    } else {
        iters_43224 = 16;
    }
    
    int64_t i16_res_43225 = sext_i16_i64(block_sizze_32854);
    bool zzero_43226 = i16_res_43225 == (int64_t) 0;
    bool nonzzero_43227 = !zzero_43226;
    bool nonzzero_cert_43228;
    
    if (!nonzzero_43227) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:222:20-27\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #4  ftbasics.fut:175:95-98\n   #5  ftsort.fut:25:3-46\n   #6  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t n_blocks_43229 = sdiv64(n_32852, i16_res_43225);
    int64_t rest_43230 = smod64(n_32852, i16_res_43225);
    int64_t arg_43231 = mul64(i16_res_43225, n_blocks_43229);
    int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232 = add64(rest_43230, arg_43231);
    bool dim_match_43233 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232 == n_32852;
    bool empty_or_match_cert_43234;
    
    if (!dim_match_43233) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) n_32852, "] cannot match shape of type `[", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "](f32, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:224:12-46\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #3  /prelude/functional.fut:9:44-45\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #5  ftbasics.fut:175:95-98\n   #6  ftsort.fut:25:3-46\n   #7  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47845 = (int64_t) 4 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;
    int64_t bytes_47847 = (int64_t) 8 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;
    bool loop_nonempty_43238 = slt32(0, iters_43224);
    int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239 = add64((int64_t) 1, n_blocks_43229);
    int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240 = mul64((int64_t) 4, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239);
    bool empty_slice_43241 = arg_43231 == (int64_t) 0;
    int64_t m_43242 = sub64(arg_43231, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_43243 = sle64((int64_t) 0, m_43242);
    bool i_p_m_t_s_leq_w_43244 = slt64(m_43242, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool i_lte_j_43245 = sle64((int64_t) 0, arg_43231);
    bool y_43246 = zzero_leq_i_p_m_t_s_43243 && i_p_m_t_s_leq_w_43244;
    bool forwards_ok_43247 = i_lte_j_43245 && y_43246;
    bool ok_or_empty_43248 = empty_slice_43241 || forwards_ok_43247;
    bool loop_not_taken_43249 = !loop_nonempty_43238;
    bool protect_assert_disj_43250 = ok_or_empty_43248 || loop_not_taken_43249;
    bool index_certs_43251;
    
    if (!protect_assert_disj_43250) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) arg_43231, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "].", "-> #0  /prelude/array.fut:65:4-11\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:25:3-46\n   #8  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_43252 = rest_43230 == (int64_t) 0;
    int64_t m_43253 = sub64(rest_43230, (int64_t) 1);
    int64_t i_p_m_t_s_43254 = add64(arg_43231, m_43253);
    bool zzero_leq_i_p_m_t_s_43255 = sle64((int64_t) 0, i_p_m_t_s_43254);
    bool i_p_m_t_s_leq_w_43256 = slt64(i_p_m_t_s_43254, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool i_lte_j_43257 = sle64(arg_43231, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232);
    bool y_43258 = zzero_leq_i_p_m_t_s_43255 && i_p_m_t_s_leq_w_43256;
    bool forwards_ok_43259 = i_lte_j_43257 && y_43258;
    bool ok_or_empty_43260 = empty_slice_43252 || forwards_ok_43259;
    bool protect_assert_disj_43261 = loop_not_taken_43249 || ok_or_empty_43260;
    bool index_certs_43262;
    
    if (!protect_assert_disj_43261) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_43231, ":", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "].", "-> #0  /prelude/array.fut:65:13-24\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:25:3-46\n   #8  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool binop_x_43263 = sle64((int64_t) 0, n_blocks_43229);
    bool binop_y_43264 = sle64((int64_t) 0, i16_res_43225);
    bool binop_y_43265 = binop_x_43263 && binop_y_43264;
    bool protect_assert_disj_43266 = loop_not_taken_43249 || binop_y_43265;
    bool dim_ok_cert_43267;
    
    if (!protect_assert_disj_43266) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Cannot unflatten array of shape [", (long long) arg_43231, "] to array of shape [", (long long) n_blocks_43229, "][", (long long) i16_res_43225, "]", "-> #0  /prelude/array.fut:184:3-30\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-168:21\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:25:3-46\n   #8  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_43268 = sub64(i16_res_43225, (int64_t) 1);
    bool x_43269 = sle64((int64_t) 0, tmp_43268);
    bool y_43270 = slt64(tmp_43268, i16_res_43225);
    bool bounds_check_43271 = x_43269 && y_43270;
    bool protect_assert_disj_43272 = zzero_43226 || bounds_check_43271;
    bool protect_assert_disj_43273 = loop_not_taken_43249 || protect_assert_disj_43272;
    bool index_certs_43274;
    
    if (!protect_assert_disj_43273) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_43268, "] out of bounds for array of shape [", (long long) i16_res_43225, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_43276 = slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240);
    bool protect_assert_disj_43277 = loop_not_taken_43249 || y_43276;
    bool index_certs_43278;
    
    if (!protect_assert_disj_43277) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, "].", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:122:3-123:7\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:178:8-20\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_43280 = nonzzero_43227 || loop_not_taken_43249;
    bool nonzzero_cert_43281;
    
    if (!protect_assert_disj_43280) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:186:27-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_43282 = sle64((int64_t) 0, m_43253);
    bool y_43283 = slt64(m_43253, rest_43230);
    bool bounds_check_43284 = x_43282 && y_43283;
    bool protect_assert_disj_43285 = empty_slice_43252 || bounds_check_43284;
    bool protect_assert_disj_43286 = loop_not_taken_43249 || protect_assert_disj_43285;
    bool index_certs_43287;
    
    if (!protect_assert_disj_43286) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_43253, "] out of bounds for array of shape [", (long long) rest_43230, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #6  ftbasics.fut:175:95-98\n   #7  ftsort.fut:25:3-46\n   #8  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t nest_sizze_45816 = (int64_t) 4 * n_blocks_43229;
    int64_t bytes_47856 = (int64_t) 2 * rest_43230;
    int64_t bytes_47875 = (int64_t) 8 * rest_43230;
    int64_t bytes_47877 = (int64_t) 4 * rest_43230;
    int64_t bytes_47881 = i16_res_43225 * nest_sizze_45816;
    int64_t binop_x_47883 = (int64_t) 8 * n_blocks_43229;
    int64_t bytes_47884 = i16_res_43225 * binop_x_47883;
    int64_t bytes_47991 = (int64_t) 32 * dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239;
    bool dim_match_43549 = n_32852 == dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232;
    bool empty_or_match_cert_43550;
    
    if (!dim_match_43549) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, "] cannot match shape of type `[", (long long) n_32852, "](f32, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:225:6-11\n   #2  /prelude/functional.fut:26:41-42\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:226:6-227:50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:270:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:280:49-51\n   #7  ftbasics.fut:175:95-98\n   #8  ftsort.fut:25:3-46\n   #9  ftsort.fut:24:1-25:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_48004 = (int64_t) 8 * n_32852;
    int64_t bytes_48006 = (int64_t) 4 * n_32852;
    
    if (memblock_alloc_device(ctx, &mem_47846, bytes_47845, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xs_mem_47844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_47848, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_45396;
    
    segscan_tblock_sizze_45396 = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45395;
    
    int64_t num_tblocks_45398;
    int64_t max_num_tblocks_48122;
    
    max_num_tblocks_48122 = *ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45397;
    num_tblocks_45398 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_43230, segscan_tblock_sizze_45396), max_num_tblocks_48122)));
    
    int64_t segmap_tblock_sizze_45406;
    
    segmap_tblock_sizze_45406 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45405;
    
    int64_t num_tblocks_45408;
    int64_t max_num_tblocks_48123;
    
    max_num_tblocks_48123 = *ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45407;
    num_tblocks_45408 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_43230, segmap_tblock_sizze_45406), max_num_tblocks_48123)));
    
    int64_t segmap_tblock_sizze_45421;
    
    segmap_tblock_sizze_45421 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45413;
    
    int64_t segmap_usable_groups_45422 = sdiv_up_safe64((int64_t) 4, segmap_tblock_sizze_45421);
    int64_t intra_avail_par_45441 = smin64((int64_t) 4, i16_res_43225);
    int64_t computed_tblock_sizze_45430 = smax64((int64_t) 4, i16_res_43225);
    int64_t max_tblock_sizze_45449;
    
    max_tblock_sizze_45449 = ctx->max_thread_block_size;
    
    bool fits_45450 = sle64(computed_tblock_sizze_45430, max_tblock_sizze_45449);
    bool suff_intra_par_45448;
    
    suff_intra_par_45448 = *ctx->tuning_params.sortColumn_floatzisuff_intra_par_0 <= intra_avail_par_45441;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "sortColumn_float.suff_intra_par_0", (long) intra_avail_par_45441, suff_intra_par_45448 ? "true" : "false");
    
    bool intra_suff_and_fits_45451 = suff_intra_par_45448 && fits_45450;
    int64_t segscan_tblock_sizze_45708;
    
    segscan_tblock_sizze_45708 = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45658;
    
    int64_t num_tblocks_45709;
    int64_t max_num_tblocks_48124;
    
    max_num_tblocks_48124 = *ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45660;
    num_tblocks_45709 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_43231, segscan_tblock_sizze_45708), max_num_tblocks_48124)));
    
    int64_t segmap_tblock_sizze_45758;
    
    segmap_tblock_sizze_45758 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45638;
    
    int64_t segmap_tblock_sizze_45780;
    
    segmap_tblock_sizze_45780 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45616;
    
    int64_t num_tblocks_45781;
    int64_t max_num_tblocks_48125;
    
    max_num_tblocks_48125 = *ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45618;
    num_tblocks_45781 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_43231, segmap_tblock_sizze_45780), max_num_tblocks_48125)));
    
    int64_t segmap_tblock_sizze_45800;
    
    segmap_tblock_sizze_45800 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45594;
    
    int64_t num_tblocks_45801;
    int64_t max_num_tblocks_48126;
    
    max_num_tblocks_48126 = *ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45596;
    num_tblocks_45801 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_45800), max_num_tblocks_48126)));
    
    int64_t segmap_tblock_sizze_45817;
    
    segmap_tblock_sizze_45817 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45572;
    
    int64_t segmap_tblock_sizze_45827;
    
    segmap_tblock_sizze_45827 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45545;
    
    int64_t num_tblocks_45828;
    int64_t max_num_tblocks_48127;
    
    max_num_tblocks_48127 = *ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45547;
    num_tblocks_45828 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_45827), max_num_tblocks_48127)));
    
    int64_t segscan_tblock_sizze_45845;
    
    segscan_tblock_sizze_45845 = *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45844;
    
    int64_t num_tblocks_45847;
    int64_t max_num_tblocks_48128;
    
    max_num_tblocks_48128 = *ctx->tuning_params.sortColumn_floatzisegscan_num_tblocks_45846;
    num_tblocks_45847 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segscan_tblock_sizze_45845), max_num_tblocks_48128)));
    
    int64_t segmap_tblock_sizze_45864;
    
    segmap_tblock_sizze_45864 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45854;
    
    int64_t segmap_usable_groups_45865 = sdiv_up_safe64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segmap_tblock_sizze_45864);
    int64_t segmap_tblock_sizze_45877;
    
    segmap_tblock_sizze_45877 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45876;
    
    int64_t num_tblocks_45879;
    int64_t max_num_tblocks_48129;
    
    max_num_tblocks_48129 = *ctx->tuning_params.sortColumn_floatzisegmap_num_tblocks_45878;
    num_tblocks_45879 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, segmap_tblock_sizze_45877), max_num_tblocks_48129)));
    
    int64_t segmap_usable_groups_45759 = sdiv_up_safe64(n_blocks_43229, segmap_tblock_sizze_45758);
    int64_t segmap_usable_groups_45818 = sdiv_up_safe64(nest_sizze_45816, segmap_tblock_sizze_45817);
    int64_t ext_47979;
    int64_t shared_memory_capacity_48130;
    
    shared_memory_capacity_48130 = ctx->max_shared_memory;
    if (intra_suff_and_fits_45451) {
        ext_47979 = (int64_t) 4;
    } else {
        ext_47979 = (int64_t) 1;
    }
    
    int64_t ext_47978;
    int64_t shared_memory_capacity_48131;
    
    shared_memory_capacity_48131 = ctx->max_shared_memory;
    if (intra_suff_and_fits_45451) {
        ext_47978 = (int64_t) 1;
    } else {
        ext_47978 = n_blocks_43229;
    }
    
    int64_t binop_x_47887 = (int64_t) 2 * n_blocks_43229;
    int64_t bytes_47888 = i16_res_43225 * binop_x_47887;
    int64_t binop_y_47918 = n_blocks_43229 - (int64_t) 1;
    int64_t binop_x_47920 = smax64((int64_t) 0, binop_y_47918);
    int64_t binop_y_47922 = (int64_t) 3 * n_blocks_43229;
    int64_t binop_y_47923 = smax64((int64_t) 0, binop_y_47922);
    int64_t binop_y_47924 = binop_x_47920 + binop_y_47923;
    int64_t binop_y_47925 = (int64_t) 1 + binop_y_47924;
    int64_t bytes_47926 = (int64_t) 2 * binop_y_47925;
    int64_t bytes_47930 = (int64_t) 32 * n_blocks_43229;
    int64_t bytes_47949 = (int64_t) 4 * i16_res_43225;
    int64_t bytes_47951 = (int64_t) 8 * i16_res_43225;
    int64_t bytes_47953 = (int64_t) 2 * i16_res_43225;
    
    if (memblock_alloc_device(ctx, &mem_47857, bytes_47856, "mem_47857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47859, bytes_47856, "mem_47859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47861, bytes_47856, "mem_47861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47863, bytes_47856, "mem_47863")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47865, bytes_47856, "mem_47865")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47876, bytes_47875, "mem_47876")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47878, bytes_47877, "mem_47878")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47882, bytes_47881, "mem_47882")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47885, bytes_47884, "mem_47885")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47984, (int64_t) 8, "mem_47984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47985, (int64_t) 8, "mem_47985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47986, (int64_t) 8, "mem_47986")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47987, (int64_t) 8, "mem_47987")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47989, (int64_t) 32, "mem_47989")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47992, bytes_47991, "mem_47992")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47995, bytes_47991, "mem_47995")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t maxSubHelper_48094 = umax64((int64_t) 8, bytes_47953);
    
    for (int32_t i_43290 = 0; i_43290 < iters_43224; i_43290++) {
        int32_t blocked_radix_sort_step_arg1_43293 = mul32(2, i_43290);
        int32_t get_bit_arg0_43298 = add32(1, blocked_radix_sort_step_arg1_43293);
        bool cond_f_res_43299 = get_bit_arg0_43298 == 31;
        bool cond_f_res_43300 = blocked_radix_sort_step_arg1_43293 == 31;
        
        if (slt64((int64_t) 0, rest_43230)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48134;
            
            shared_memory_48134 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48135;
            
            thread_block_sizze_48135 = ctx->max_thread_block_size;
            
            int64_t registers_48136;
            
            registers_48136 = ctx->max_registers;
            
            int64_t thread_block_sizze_48137;
            
            thread_block_sizze_48137 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48138 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48134, thread_block_sizze_48135), (int64_t) 2), squot64(squot64(registers_48136, thread_block_sizze_48137) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
            int64_t num_virt_blocks_48139 = sdiv_up64(rest_43230, segscan_tblock_sizze_45396 * chunk_sizze_48138);
            int64_t num_virt_threads_48140 = num_virt_blocks_48139 * segscan_tblock_sizze_45396;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48138, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48141, num_virt_blocks_48139, "status_flags_mem_48141")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48141, num_virt_blocks_48139, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48163, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48163")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48165, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48165")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48167, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48167")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48169, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48169")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48171, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48173, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48175, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48177, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48177")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_floatzisegscan_45401(ctx, num_tblocks_45398, 1, 1, *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45395, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45396), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_45396 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), rest_43230, arg_43231, blocked_radix_sort_step_arg1_43293, get_bit_arg0_43298, cond_f_res_43299, cond_f_res_43300, num_tblocks_45398, num_virt_blocks_48139, num_virt_threads_48140, mem_47846.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, status_flags_mem_48141.mem, aggregates_mem_48163.mem, incprefixes_mem_48165.mem, aggregates_mem_48167.mem, incprefixes_mem_48169.mem, aggregates_mem_48171.mem, incprefixes_mem_48173.mem, aggregates_mem_48175.mem, incprefixes_mem_48177.mem, global_dynid_mem_48179.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (empty_slice_43252) {
            if (memblock_alloc_device(ctx, &mem_47870, (int64_t) 2, "mem_47870")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i16(ctx, mem_47870, (int64_t) 1, (int16_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47870, "mem_47870") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47866, (int64_t) 2, "mem_47866")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47867, (int64_t) 2, "mem_47867")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47868, (int64_t) 2, "mem_47868")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47869, (int64_t) 2, "mem_47869")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_floatzigpuseq_48446(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_43253, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47866.mem, mem_47867.mem, mem_47868.mem, mem_47869.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47866, "mem_47866") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47867, "mem_47867") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47868, "mem_47868") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47869, "mem_47869") != 0)
                return 1;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47876.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47848.mem, (int64_t) 0 + (int64_t) 1 * arg_43231, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_43230})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_47878.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47846.mem, (int64_t) 0 + (int64_t) 1 * arg_43231, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_43230})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48452 = sext_i64_i32(sdiv_up64(rest_43230, segmap_tblock_sizze_45406));
        
        {
            err = gpu_kernel_sortColumn_floatzisegmap_45403(ctx, num_tblocks_45408, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45405, 1, 1, (int64_t) 0, rest_43230, arg_43231, num_tblocks_45408, virt_num_tblocks_48452, mem_47846.mem, mem_47848.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47876.mem, mem_47878.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_47882.mem, (int64_t) 0, (int64_t []) {i16_res_43225, (int64_t) 1}, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_43225, (int64_t) 1}, (int64_t []) {n_blocks_43229, i16_res_43225})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47885.mem, (int64_t) 0, (int64_t []) {i16_res_43225, (int64_t) 1}, mem_47848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_43225, (int64_t) 1}, (int64_t []) {n_blocks_43229, i16_res_43225})) != 0)
            goto cleanup;
        
        int64_t shared_memory_capacity_48853;
        
        shared_memory_capacity_48853 = ctx->max_shared_memory;
        if (intra_suff_and_fits_45451 && sle64(sdiv_up64(maxSubHelper_48094, (int64_t) 8) * (int64_t) 8 + (int64_t) 32 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47951, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48853)) {
            if (memblock_alloc_device(ctx, &mem_47968, bytes_47881, "mem_47968")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47971, bytes_47884, "mem_47971")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47974, bytes_47930, "mem_47974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47977, binop_x_47883, "mem_47977")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_48465 = sext_i64_i32(sdiv_up64((int64_t) 4, computed_tblock_sizze_45430));
            int32_t num_chunks_48466 = sext_i64_i32(sdiv_up64(i16_res_43225, computed_tblock_sizze_45430));
            int32_t virt_num_tblocks_48467 = sext_i64_i32(n_blocks_43229);
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_intrablock_45457(ctx, n_blocks_43229, 1, 1, computed_tblock_sizze_45430, 1, 1, bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8) + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (int64_t) 32 + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8)), i16_res_43225, zzero_43226, n_blocks_43229, tmp_43268, blocked_radix_sort_step_arg1_43293, get_bit_arg0_43298, cond_f_res_43299, cond_f_res_43300, computed_tblock_sizze_45430, bytes_47949, bytes_47951, bytes_47953, maxSubHelper_48094, mem_47846.mem, mem_47848.mem, mem_47968.mem, mem_47971.mem, mem_47974.mem, mem_47977.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47968, "mem_47968") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47971, "mem_47971") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47974, "mem_47974") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47977, "mem_47977") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47889, bytes_47888, "mem_47889")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47892, bytes_47888, "mem_47892")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47895, bytes_47888, "mem_47895")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47898, bytes_47888, "mem_47898")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47901, bytes_47888, "mem_47901")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, n_blocks_43229 * i16_res_43225)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_48525;
                
                shared_memory_48525 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_48526;
                
                thread_block_sizze_48526 = ctx->max_thread_block_size;
                
                int64_t registers_48527;
                
                registers_48527 = ctx->max_registers;
                
                int64_t thread_block_sizze_48528;
                
                thread_block_sizze_48528 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_48529 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48525, thread_block_sizze_48526), (int64_t) 2), squot64(squot64(registers_48527, thread_block_sizze_48528) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
                int64_t num_virt_blocks_48530 = sdiv_up64(n_blocks_43229 * i16_res_43225, segscan_tblock_sizze_45708 * chunk_sizze_48529);
                int64_t num_virt_threads_48531 = num_virt_blocks_48530 * segscan_tblock_sizze_45708;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48529, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_48532, num_virt_blocks_48530, "status_flags_mem_48532")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48532, num_virt_blocks_48530, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48534, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48534")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48536, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48536")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48538, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48538")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48540, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48540")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48542, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48542")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48544, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48544")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48546, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48546")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48548, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48548")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_sortColumn_floatzisegscan_45718(ctx, num_tblocks_45709, 1, 1, *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45658, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45708), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45708 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), i16_res_43225, n_blocks_43229, blocked_radix_sort_step_arg1_43293, get_bit_arg0_43298, cond_f_res_43299, cond_f_res_43300, num_tblocks_45709, num_virt_blocks_48530, num_virt_threads_48531, mem_47846.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, status_flags_mem_48532.mem, aggregates_mem_48534.mem, incprefixes_mem_48536.mem, aggregates_mem_48538.mem, incprefixes_mem_48540.mem, aggregates_mem_48542.mem, incprefixes_mem_48544.mem, aggregates_mem_48546.mem, incprefixes_mem_48548.mem, global_dynid_mem_48550.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_47904, binop_x_47887, "mem_47904")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47906, binop_x_47887, "mem_47906")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47908, binop_x_47887, "mem_47908")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47910, binop_x_47887, "mem_47910")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48792 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_45758));
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_45765(ctx, segmap_usable_groups_45759, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45638, 1, 1, (int64_t) 0, i16_res_43225, zzero_43226, nonzzero_43227, n_blocks_43229, tmp_43268, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48801 = sext_i64_i32(sdiv_up64(n_blocks_43229 * i16_res_43225, segmap_tblock_sizze_45780));
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_45787(ctx, num_tblocks_45781, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45616, 1, 1, (int64_t) 0, i16_res_43225, n_blocks_43229, num_tblocks_45781, virt_num_tblocks_48801, mem_47846.mem, mem_47848.mem, mem_47882.mem, mem_47885.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47927, bytes_47926, "mem_47927")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48816 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_45800));
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_45805(ctx, num_tblocks_45801, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45594, 1, 1, (int64_t) 0, n_blocks_43229, num_tblocks_45801, virt_num_tblocks_48816, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47927.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47931, bytes_47930, "mem_47931")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48829 = sext_i64_i32(sdiv_up64(n_blocks_43229 * (int64_t) 4, segmap_tblock_sizze_45817));
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_45822(ctx, segmap_usable_groups_45818, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45572, 1, 1, (int64_t) 0, n_blocks_43229, mem_47927.mem, mem_47931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47947, bytes_47926, "mem_47947")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48840 = sext_i64_i32(sdiv_up64(n_blocks_43229, segmap_tblock_sizze_45827));
            
            {
                err = gpu_kernel_sortColumn_floatzisegmap_45832(ctx, num_tblocks_45828, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45545, 1, 1, (int64_t) 0, n_blocks_43229, num_tblocks_45828, virt_num_tblocks_48840, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47947.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47882, "mem_47882") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47885, "mem_47885") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47931, "mem_47931") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47947, "mem_47947") != 0)
                return 1;
        }
        {
            err = gpu_kernel_sortColumn_floatzigpuseq_48854(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_47871.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47984.mem, mem_47985.mem, mem_47986.mem, mem_47987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48860 = sext_i64_i32(sdiv_up64((int64_t) 4, segmap_tblock_sizze_45421));
        
        {
            err = gpu_kernel_sortColumn_floatzisegmap_45425(ctx, segmap_usable_groups_45422, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45413, 1, 1, (int64_t) 0, mem_47986.mem, mem_47989.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48869;
            
            shared_memory_48869 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48870;
            
            thread_block_sizze_48870 = ctx->max_thread_block_size;
            
            int64_t registers_48871;
            
            registers_48871 = ctx->max_registers;
            
            int64_t thread_block_sizze_48872;
            
            thread_block_sizze_48872 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48873 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48869, thread_block_sizze_48870), (int64_t) 8), squot64(squot64(registers_48871, thread_block_sizze_48872) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_48874 = sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segscan_tblock_sizze_45845 * chunk_sizze_48873);
            int64_t num_virt_threads_48875 = num_virt_blocks_48874 * segscan_tblock_sizze_45845;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48873, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48876, num_virt_blocks_48874, "status_flags_mem_48876")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48876, num_virt_blocks_48874, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48878, (int64_t) 8 * num_virt_blocks_48874, "aggregates_mem_48878")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48880, (int64_t) 8 * num_virt_blocks_48874, "incprefixes_mem_48880")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_floatzisegscan_45850(ctx, num_tblocks_45847, 1, 1, *ctx->tuning_params.sortColumn_floatzisegscan_tblock_sizze_45844, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45845), chunk_sizze_48873 * segscan_tblock_sizze_45845 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45845), chunk_sizze_48873 * segscan_tblock_sizze_45845 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_blocks_43229, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, num_tblocks_45847, num_virt_blocks_48874, num_virt_threads_48875, ext_mem_47981.mem, mem_47989.mem, mem_47992.mem, status_flags_mem_48876.mem, aggregates_mem_48878.mem, incprefixes_mem_48880.mem, global_dynid_mem_48882.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48971 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, segmap_tblock_sizze_45864));
        
        {
            err = gpu_kernel_sortColumn_floatzisegmap_45868(ctx, segmap_usable_groups_45865, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45854, 1, 1, (int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_43240, mem_47992.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t write_tmp_49028 = (int64_t) 0;
        
        if ((err = gpu_scalar_to_device(ctx, mem_47995.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t), &write_tmp_49028)) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48980 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, segmap_tblock_sizze_45877));
        
        {
            err = gpu_kernel_sortColumn_floatzisegmap_45874(ctx, num_tblocks_45879, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45876, 1, 1, (int64_t) 0, i16_res_43225, n_blocks_43229, arg_43231, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_43232, dzlz7bUZLzpZRz20Unz20U1z7dUzg_43239, blocked_radix_sort_step_arg1_43293, num_tblocks_45879, ext_47978, ext_47979, virt_num_tblocks_48980, mem_47846.mem, mem_47848.mem, mem_47876.mem, mem_47878.mem, ext_mem_47980.mem, ext_mem_47982.mem, ext_mem_47983.mem, mem_47987.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_45897;
    
    segmap_tblock_sizze_45897 = *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45884;
    
    int64_t segmap_usable_groups_45898 = sdiv_up64(n_32852, segmap_tblock_sizze_45897);
    
    if (memblock_alloc_device(ctx, &mem_48005, bytes_48004, "mem_48005")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_48007, bytes_48006, "mem_48007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48994 = sext_i64_i32(sdiv_up64(n_32852, segmap_tblock_sizze_45897));
    
    {
        err = gpu_kernel_sortColumn_floatzisegmap_45902(ctx, segmap_usable_groups_45898, 1, 1, *ctx->tuning_params.sortColumn_floatzisegmap_tblock_sizze_45884, 1, 1, (int64_t) 0, n_32852, incr_32853, xs_mem_47844.mem, mem_47848.mem, mem_48005.mem, mem_48007.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48103, &mem_48005, "mem_48005") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_48007, "mem_48007") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49026, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49027, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_48007, "mem_48007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_48005, "mem_48005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48880, "incprefixes_mem_48880") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48878, "aggregates_mem_48878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48876, "status_flags_mem_48876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47947, "mem_47947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47931, "mem_47931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48548, "incprefixes_mem_48548") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48546, "aggregates_mem_48546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48544, "incprefixes_mem_48544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48542, "aggregates_mem_48542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48540, "incprefixes_mem_48540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48538, "aggregates_mem_48538") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48536, "incprefixes_mem_48536") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48534, "aggregates_mem_48534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48532, "status_flags_mem_48532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47974, "mem_47974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47971, "mem_47971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47968, "mem_47968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47869, "mem_47869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47868, "mem_47868") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47867, "mem_47867") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47866, "mem_47866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47870, "mem_47870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48177, "incprefixes_mem_48177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48175, "aggregates_mem_48175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48173, "incprefixes_mem_48173") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48171, "aggregates_mem_48171") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48169, "incprefixes_mem_48169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48167, "aggregates_mem_48167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48165, "incprefixes_mem_48165") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48163, "aggregates_mem_48163") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48141, "status_flags_mem_48141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_int(struct futhark_context *ctx, struct memblock_device *mem_out_p_49029, struct memblock_device *mem_out_p_49030, struct memblock_device xs_mem_47844, int64_t n_27501, int64_t incr_27502, int16_t block_sizze_27503)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_48007;
    
    mem_48007.references = NULL;
    
    struct memblock_device mem_48005;
    
    mem_48005.references = NULL;
    
    struct memblock_device incprefixes_mem_48880;
    
    incprefixes_mem_48880.references = NULL;
    
    struct memblock_device aggregates_mem_48878;
    
    aggregates_mem_48878.references = NULL;
    
    struct memblock_device status_flags_mem_48876;
    
    status_flags_mem_48876.references = NULL;
    
    struct memblock_device mem_47947;
    
    mem_47947.references = NULL;
    
    struct memblock_device mem_47931;
    
    mem_47931.references = NULL;
    
    struct memblock_device mem_47927;
    
    mem_47927.references = NULL;
    
    struct memblock_device mem_47910;
    
    mem_47910.references = NULL;
    
    struct memblock_device mem_47908;
    
    mem_47908.references = NULL;
    
    struct memblock_device mem_47906;
    
    mem_47906.references = NULL;
    
    struct memblock_device mem_47904;
    
    mem_47904.references = NULL;
    
    struct memblock_device incprefixes_mem_48548;
    
    incprefixes_mem_48548.references = NULL;
    
    struct memblock_device aggregates_mem_48546;
    
    aggregates_mem_48546.references = NULL;
    
    struct memblock_device incprefixes_mem_48544;
    
    incprefixes_mem_48544.references = NULL;
    
    struct memblock_device aggregates_mem_48542;
    
    aggregates_mem_48542.references = NULL;
    
    struct memblock_device incprefixes_mem_48540;
    
    incprefixes_mem_48540.references = NULL;
    
    struct memblock_device aggregates_mem_48538;
    
    aggregates_mem_48538.references = NULL;
    
    struct memblock_device incprefixes_mem_48536;
    
    incprefixes_mem_48536.references = NULL;
    
    struct memblock_device aggregates_mem_48534;
    
    aggregates_mem_48534.references = NULL;
    
    struct memblock_device status_flags_mem_48532;
    
    status_flags_mem_48532.references = NULL;
    
    struct memblock_device mem_47901;
    
    mem_47901.references = NULL;
    
    struct memblock_device mem_47898;
    
    mem_47898.references = NULL;
    
    struct memblock_device mem_47895;
    
    mem_47895.references = NULL;
    
    struct memblock_device mem_47892;
    
    mem_47892.references = NULL;
    
    struct memblock_device mem_47889;
    
    mem_47889.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device mem_47974;
    
    mem_47974.references = NULL;
    
    struct memblock_device mem_47971;
    
    mem_47971.references = NULL;
    
    struct memblock_device mem_47968;
    
    mem_47968.references = NULL;
    
    struct memblock_device ext_mem_47980;
    
    ext_mem_47980.references = NULL;
    
    struct memblock_device ext_mem_47981;
    
    ext_mem_47981.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device mem_47869;
    
    mem_47869.references = NULL;
    
    struct memblock_device mem_47868;
    
    mem_47868.references = NULL;
    
    struct memblock_device mem_47867;
    
    mem_47867.references = NULL;
    
    struct memblock_device mem_47866;
    
    mem_47866.references = NULL;
    
    struct memblock_device mem_47870;
    
    mem_47870.references = NULL;
    
    struct memblock_device ext_mem_47871;
    
    ext_mem_47871.references = NULL;
    
    struct memblock_device ext_mem_47872;
    
    ext_mem_47872.references = NULL;
    
    struct memblock_device ext_mem_47873;
    
    ext_mem_47873.references = NULL;
    
    struct memblock_device ext_mem_47874;
    
    ext_mem_47874.references = NULL;
    
    struct memblock_device incprefixes_mem_48177;
    
    incprefixes_mem_48177.references = NULL;
    
    struct memblock_device aggregates_mem_48175;
    
    aggregates_mem_48175.references = NULL;
    
    struct memblock_device incprefixes_mem_48173;
    
    incprefixes_mem_48173.references = NULL;
    
    struct memblock_device aggregates_mem_48171;
    
    aggregates_mem_48171.references = NULL;
    
    struct memblock_device incprefixes_mem_48169;
    
    incprefixes_mem_48169.references = NULL;
    
    struct memblock_device aggregates_mem_48167;
    
    aggregates_mem_48167.references = NULL;
    
    struct memblock_device incprefixes_mem_48165;
    
    incprefixes_mem_48165.references = NULL;
    
    struct memblock_device aggregates_mem_48163;
    
    aggregates_mem_48163.references = NULL;
    
    struct memblock_device status_flags_mem_48141;
    
    status_flags_mem_48141.references = NULL;
    
    struct memblock_device mem_47995;
    
    mem_47995.references = NULL;
    
    struct memblock_device mem_47992;
    
    mem_47992.references = NULL;
    
    struct memblock_device mem_47989;
    
    mem_47989.references = NULL;
    
    struct memblock_device mem_47987;
    
    mem_47987.references = NULL;
    
    struct memblock_device mem_47986;
    
    mem_47986.references = NULL;
    
    struct memblock_device mem_47985;
    
    mem_47985.references = NULL;
    
    struct memblock_device mem_47984;
    
    mem_47984.references = NULL;
    
    struct memblock_device mem_47885;
    
    mem_47885.references = NULL;
    
    struct memblock_device mem_47882;
    
    mem_47882.references = NULL;
    
    struct memblock_device mem_47878;
    
    mem_47878.references = NULL;
    
    struct memblock_device mem_47876;
    
    mem_47876.references = NULL;
    
    struct memblock_device mem_47865;
    
    mem_47865.references = NULL;
    
    struct memblock_device mem_47863;
    
    mem_47863.references = NULL;
    
    struct memblock_device mem_47861;
    
    mem_47861.references = NULL;
    
    struct memblock_device mem_47859;
    
    mem_47859.references = NULL;
    
    struct memblock_device mem_47857;
    
    mem_47857.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t rng_41702 = add64(n_27501, incr_27502);
    bool bounds_invalid_upwards_41703 = slt64(rng_41702, incr_27502);
    bool valid_41704 = !bounds_invalid_upwards_41703;
    bool range_valid_c_41705;
    
    if (!valid_41704) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_27502, "..<", (long long) rng_41702, " is invalid.", "-> #0  ftbasics.fut:18:25-40\n   #1  ftbasics.fut:121:32-58\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:121:32-63\n   #4  ftsort.fut:19:3-44\n   #5  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_41706 = n_27501 == (int64_t) 0;
    int32_t iters_41707;
    
    if (cond_41706) {
        iters_41707 = 0;
    } else {
        iters_41707 = 16;
    }
    
    int64_t i16_res_41708 = sext_i16_i64(block_sizze_27503);
    bool zzero_41709 = i16_res_41708 == (int64_t) 0;
    bool nonzzero_41710 = !zzero_41709;
    bool nonzzero_cert_41711;
    
    if (!nonzzero_41710) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:222:20-27\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:19:3-44\n   #6  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t n_blocks_41712 = sdiv64(n_27501, i16_res_41708);
    int64_t rest_41713 = smod64(n_27501, i16_res_41708);
    int64_t arg_41714 = mul64(i16_res_41708, n_blocks_41712);
    int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 = add64(rest_41713, arg_41714);
    bool dim_match_41716 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 == n_27501;
    bool empty_or_match_cert_41717;
    
    if (!dim_match_41716) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) n_27501, "] cannot match shape of type `[", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "](i32, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:224:12-46\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #3  /prelude/functional.fut:9:44-45\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #5  ftbasics.fut:122:93-96\n   #6  ftsort.fut:19:3-44\n   #7  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47845 = (int64_t) 4 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    int64_t bytes_47847 = (int64_t) 8 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool loop_nonempty_41721 = slt32(0, iters_41707);
    int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 = add64((int64_t) 1, n_blocks_41712);
    int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 = mul64((int64_t) 4, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);
    bool empty_slice_41724 = arg_41714 == (int64_t) 0;
    int64_t m_41725 = sub64(arg_41714, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_41726 = sle64((int64_t) 0, m_41725);
    bool i_p_m_t_s_leq_w_41727 = slt64(m_41725, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41728 = sle64((int64_t) 0, arg_41714);
    bool y_41729 = zzero_leq_i_p_m_t_s_41726 && i_p_m_t_s_leq_w_41727;
    bool forwards_ok_41730 = i_lte_j_41728 && y_41729;
    bool ok_or_empty_41731 = empty_slice_41724 || forwards_ok_41730;
    bool loop_not_taken_41732 = !loop_nonempty_41721;
    bool protect_assert_disj_41733 = ok_or_empty_41731 || loop_not_taken_41732;
    bool index_certs_41734;
    
    if (!protect_assert_disj_41733) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) arg_41714, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:4-11\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:19:3-44\n   #8  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_41735 = rest_41713 == (int64_t) 0;
    int64_t m_41736 = sub64(rest_41713, (int64_t) 1);
    int64_t i_p_m_t_s_41737 = add64(arg_41714, m_41736);
    bool zzero_leq_i_p_m_t_s_41738 = sle64((int64_t) 0, i_p_m_t_s_41737);
    bool i_p_m_t_s_leq_w_41739 = slt64(i_p_m_t_s_41737, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41740 = sle64(arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool y_41741 = zzero_leq_i_p_m_t_s_41738 && i_p_m_t_s_leq_w_41739;
    bool forwards_ok_41742 = i_lte_j_41740 && y_41741;
    bool ok_or_empty_41743 = empty_slice_41735 || forwards_ok_41742;
    bool protect_assert_disj_41744 = loop_not_taken_41732 || ok_or_empty_41743;
    bool index_certs_41745;
    
    if (!protect_assert_disj_41744) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_41714, ":", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:13-24\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:19:3-44\n   #8  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool binop_x_41746 = sle64((int64_t) 0, n_blocks_41712);
    bool binop_y_41747 = sle64((int64_t) 0, i16_res_41708);
    bool binop_y_41748 = binop_x_41746 && binop_y_41747;
    bool protect_assert_disj_41749 = loop_not_taken_41732 || binop_y_41748;
    bool dim_ok_cert_41750;
    
    if (!protect_assert_disj_41749) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Cannot unflatten array of shape [", (long long) arg_41714, "] to array of shape [", (long long) n_blocks_41712, "][", (long long) i16_res_41708, "]", "-> #0  /prelude/array.fut:184:3-30\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-168:21\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:19:3-44\n   #8  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_41751 = sub64(i16_res_41708, (int64_t) 1);
    bool x_41752 = sle64((int64_t) 0, tmp_41751);
    bool y_41753 = slt64(tmp_41751, i16_res_41708);
    bool bounds_check_41754 = x_41752 && y_41753;
    bool protect_assert_disj_41755 = zzero_41709 || bounds_check_41754;
    bool protect_assert_disj_41756 = loop_not_taken_41732 || protect_assert_disj_41755;
    bool index_certs_41757;
    
    if (!protect_assert_disj_41756) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_41751, "] out of bounds for array of shape [", (long long) i16_res_41708, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:19:3-44\n   #9  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_41759 = slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);
    bool protect_assert_disj_41760 = loop_not_taken_41732 || y_41759;
    bool index_certs_41761;
    
    if (!protect_assert_disj_41760) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, "].", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:122:3-123:7\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:178:8-20\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:19:3-44\n   #9  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_41763 = nonzzero_41710 || loop_not_taken_41732;
    bool nonzzero_cert_41764;
    
    if (!protect_assert_disj_41763) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:186:27-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:19:3-44\n   #10 ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_41765 = sle64((int64_t) 0, m_41736);
    bool y_41766 = slt64(m_41736, rest_41713);
    bool bounds_check_41767 = x_41765 && y_41766;
    bool protect_assert_disj_41768 = empty_slice_41735 || bounds_check_41767;
    bool protect_assert_disj_41769 = loop_not_taken_41732 || protect_assert_disj_41768;
    bool index_certs_41770;
    
    if (!protect_assert_disj_41769) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_41736, "] out of bounds for array of shape [", (long long) rest_41713, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:166:41-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:19:3-44\n   #9  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t nest_sizze_46830 = (int64_t) 4 * n_blocks_41712;
    int64_t bytes_47856 = (int64_t) 2 * rest_41713;
    int64_t bytes_47875 = (int64_t) 8 * rest_41713;
    int64_t bytes_47877 = (int64_t) 4 * rest_41713;
    int64_t bytes_47881 = i16_res_41708 * nest_sizze_46830;
    int64_t binop_x_47883 = (int64_t) 8 * n_blocks_41712;
    int64_t bytes_47884 = i16_res_41708 * binop_x_47883;
    int64_t bytes_47991 = (int64_t) 32 * dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;
    bool dim_match_42002 = n_27501 == dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool empty_or_match_cert_42003;
    
    if (!dim_match_42002) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] cannot match shape of type `[", (long long) n_27501, "](i32, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:225:6-11\n   #2  /prelude/functional.fut:26:41-42\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:226:6-227:50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:19:3-44\n   #9  ftsort.fut:18:1-19:44\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_48004 = (int64_t) 8 * n_27501;
    int64_t bytes_48006 = (int64_t) 4 * n_27501;
    
    if (memblock_alloc_device(ctx, &mem_47846, bytes_47845, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xs_mem_47844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_47848, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_46437;
    
    segscan_tblock_sizze_46437 = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46436;
    
    int64_t num_tblocks_46439;
    int64_t max_num_tblocks_48122;
    
    max_num_tblocks_48122 = *ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46438;
    num_tblocks_46439 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segscan_tblock_sizze_46437), max_num_tblocks_48122)));
    
    int64_t segmap_tblock_sizze_46447;
    
    segmap_tblock_sizze_46447 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46446;
    
    int64_t num_tblocks_46449;
    int64_t max_num_tblocks_48123;
    
    max_num_tblocks_48123 = *ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46448;
    num_tblocks_46449 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segmap_tblock_sizze_46447), max_num_tblocks_48123)));
    
    int64_t segmap_tblock_sizze_46462;
    
    segmap_tblock_sizze_46462 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46454;
    
    int64_t segmap_usable_groups_46463 = sdiv_up_safe64((int64_t) 4, segmap_tblock_sizze_46462);
    int64_t intra_avail_par_46482 = smin64((int64_t) 4, i16_res_41708);
    int64_t computed_tblock_sizze_46471 = smax64((int64_t) 4, i16_res_41708);
    int64_t max_tblock_sizze_46490;
    
    max_tblock_sizze_46490 = ctx->max_thread_block_size;
    
    bool fits_46491 = sle64(computed_tblock_sizze_46471, max_tblock_sizze_46490);
    bool suff_intra_par_46489;
    
    suff_intra_par_46489 = *ctx->tuning_params.sortColumn_intzisuff_intra_par_0 <= intra_avail_par_46482;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "sortColumn_int.suff_intra_par_0", (long) intra_avail_par_46482, suff_intra_par_46489 ? "true" : "false");
    
    bool intra_suff_and_fits_46492 = suff_intra_par_46489 && fits_46491;
    int64_t segscan_tblock_sizze_46731;
    
    segscan_tblock_sizze_46731 = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46690;
    
    int64_t num_tblocks_46732;
    int64_t max_num_tblocks_48124;
    
    max_num_tblocks_48124 = *ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46692;
    num_tblocks_46732 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segscan_tblock_sizze_46731), max_num_tblocks_48124)));
    
    int64_t segmap_tblock_sizze_46772;
    
    segmap_tblock_sizze_46772 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46670;
    
    int64_t segmap_tblock_sizze_46794;
    
    segmap_tblock_sizze_46794 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46648;
    
    int64_t num_tblocks_46795;
    int64_t max_num_tblocks_48125;
    
    max_num_tblocks_48125 = *ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46650;
    num_tblocks_46795 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segmap_tblock_sizze_46794), max_num_tblocks_48125)));
    
    int64_t segmap_tblock_sizze_46814;
    
    segmap_tblock_sizze_46814 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46626;
    
    int64_t num_tblocks_46815;
    int64_t max_num_tblocks_48126;
    
    max_num_tblocks_48126 = *ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46628;
    num_tblocks_46815 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_46814), max_num_tblocks_48126)));
    
    int64_t segmap_tblock_sizze_46831;
    
    segmap_tblock_sizze_46831 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46604;
    
    int64_t segmap_tblock_sizze_46841;
    
    segmap_tblock_sizze_46841 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46577;
    
    int64_t num_tblocks_46842;
    int64_t max_num_tblocks_48127;
    
    max_num_tblocks_48127 = *ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46579;
    num_tblocks_46842 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_46841), max_num_tblocks_48127)));
    
    int64_t segscan_tblock_sizze_46859;
    
    segscan_tblock_sizze_46859 = *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46858;
    
    int64_t num_tblocks_46861;
    int64_t max_num_tblocks_48128;
    
    max_num_tblocks_48128 = *ctx->tuning_params.sortColumn_intzisegscan_num_tblocks_46860;
    num_tblocks_46861 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_46859), max_num_tblocks_48128)));
    
    int64_t segmap_tblock_sizze_46878;
    
    segmap_tblock_sizze_46878 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46868;
    
    int64_t segmap_usable_groups_46879 = sdiv_up_safe64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_46878);
    int64_t segmap_tblock_sizze_46891;
    
    segmap_tblock_sizze_46891 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46890;
    
    int64_t num_tblocks_46893;
    int64_t max_num_tblocks_48129;
    
    max_num_tblocks_48129 = *ctx->tuning_params.sortColumn_intzisegmap_num_tblocks_46892;
    num_tblocks_46893 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_46891), max_num_tblocks_48129)));
    
    int64_t segmap_usable_groups_46773 = sdiv_up_safe64(n_blocks_41712, segmap_tblock_sizze_46772);
    int64_t segmap_usable_groups_46832 = sdiv_up_safe64(nest_sizze_46830, segmap_tblock_sizze_46831);
    int64_t ext_47979;
    int64_t shared_memory_capacity_48130;
    
    shared_memory_capacity_48130 = ctx->max_shared_memory;
    if (intra_suff_and_fits_46492) {
        ext_47979 = (int64_t) 4;
    } else {
        ext_47979 = (int64_t) 1;
    }
    
    int64_t ext_47978;
    int64_t shared_memory_capacity_48131;
    
    shared_memory_capacity_48131 = ctx->max_shared_memory;
    if (intra_suff_and_fits_46492) {
        ext_47978 = (int64_t) 1;
    } else {
        ext_47978 = n_blocks_41712;
    }
    
    int64_t binop_x_47887 = (int64_t) 2 * n_blocks_41712;
    int64_t bytes_47888 = i16_res_41708 * binop_x_47887;
    int64_t binop_y_47918 = n_blocks_41712 - (int64_t) 1;
    int64_t binop_x_47920 = smax64((int64_t) 0, binop_y_47918);
    int64_t binop_y_47922 = (int64_t) 3 * n_blocks_41712;
    int64_t binop_y_47923 = smax64((int64_t) 0, binop_y_47922);
    int64_t binop_y_47924 = binop_x_47920 + binop_y_47923;
    int64_t binop_y_47925 = (int64_t) 1 + binop_y_47924;
    int64_t bytes_47926 = (int64_t) 2 * binop_y_47925;
    int64_t bytes_47930 = (int64_t) 32 * n_blocks_41712;
    int64_t bytes_47949 = (int64_t) 4 * i16_res_41708;
    int64_t bytes_47951 = (int64_t) 8 * i16_res_41708;
    int64_t bytes_47953 = (int64_t) 2 * i16_res_41708;
    
    if (memblock_alloc_device(ctx, &mem_47857, bytes_47856, "mem_47857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47859, bytes_47856, "mem_47859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47861, bytes_47856, "mem_47861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47863, bytes_47856, "mem_47863")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47865, bytes_47856, "mem_47865")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47876, bytes_47875, "mem_47876")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47878, bytes_47877, "mem_47878")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47882, bytes_47881, "mem_47882")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47885, bytes_47884, "mem_47885")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47984, (int64_t) 8, "mem_47984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47985, (int64_t) 8, "mem_47985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47986, (int64_t) 8, "mem_47986")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47987, (int64_t) 8, "mem_47987")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47989, (int64_t) 32, "mem_47989")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47992, bytes_47991, "mem_47992")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47995, bytes_47991, "mem_47995")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t maxSubHelper_48094 = umax64((int64_t) 8, bytes_47953);
    
    for (int32_t i_41773 = 0; i_41773 < iters_41707; i_41773++) {
        int32_t blocked_radix_sort_step_arg1_41776 = mul32(2, i_41773);
        int32_t get_bit_arg0_41781 = add32(1, blocked_radix_sort_step_arg1_41776);
        bool cond_41782 = get_bit_arg0_41781 == 31;
        bool cond_41783 = blocked_radix_sort_step_arg1_41776 == 31;
        
        if (slt64((int64_t) 0, rest_41713)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48134;
            
            shared_memory_48134 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48135;
            
            thread_block_sizze_48135 = ctx->max_thread_block_size;
            
            int64_t registers_48136;
            
            registers_48136 = ctx->max_registers;
            
            int64_t thread_block_sizze_48137;
            
            thread_block_sizze_48137 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48138 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48134, thread_block_sizze_48135), (int64_t) 2), squot64(squot64(registers_48136, thread_block_sizze_48137) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
            int64_t num_virt_blocks_48139 = sdiv_up64(rest_41713, segscan_tblock_sizze_46437 * chunk_sizze_48138);
            int64_t num_virt_threads_48140 = num_virt_blocks_48139 * segscan_tblock_sizze_46437;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48138, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48141, num_virt_blocks_48139, "status_flags_mem_48141")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48141, num_virt_blocks_48139, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48163, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48163")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48165, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48165")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48167, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48167")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48169, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48169")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48171, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48173, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48175, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48177, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48177")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_intzisegscan_46442(ctx, num_tblocks_46439, 1, 1, *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46436, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46437), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_46437 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), rest_41713, arg_41714, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_46439, num_virt_blocks_48139, num_virt_threads_48140, mem_47846.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, status_flags_mem_48141.mem, aggregates_mem_48163.mem, incprefixes_mem_48165.mem, aggregates_mem_48167.mem, incprefixes_mem_48169.mem, aggregates_mem_48171.mem, incprefixes_mem_48173.mem, aggregates_mem_48175.mem, incprefixes_mem_48177.mem, global_dynid_mem_48179.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (empty_slice_41735) {
            if (memblock_alloc_device(ctx, &mem_47870, (int64_t) 2, "mem_47870")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i16(ctx, mem_47870, (int64_t) 1, (int16_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47870, "mem_47870") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47866, (int64_t) 2, "mem_47866")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47867, (int64_t) 2, "mem_47867")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47868, (int64_t) 2, "mem_47868")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47869, (int64_t) 2, "mem_47869")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_intzigpuseq_48446(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_41736, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47866.mem, mem_47867.mem, mem_47868.mem, mem_47869.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47866, "mem_47866") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47867, "mem_47867") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47868, "mem_47868") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47869, "mem_47869") != 0)
                return 1;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47876.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47848.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 1, mem_47878.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47846.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48452 = sext_i64_i32(sdiv_up64(rest_41713, segmap_tblock_sizze_46447));
        
        {
            err = gpu_kernel_sortColumn_intzisegmap_46444(ctx, num_tblocks_46449, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46446, 1, 1, (int64_t) 0, rest_41713, arg_41714, num_tblocks_46449, virt_num_tblocks_48452, mem_47846.mem, mem_47848.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47876.mem, mem_47878.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_4b(ctx, 2, mem_47882.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47885.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        
        int64_t shared_memory_capacity_48853;
        
        shared_memory_capacity_48853 = ctx->max_shared_memory;
        if (intra_suff_and_fits_46492 && sle64(sdiv_up64(maxSubHelper_48094, (int64_t) 8) * (int64_t) 8 + (int64_t) 32 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47951, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48853)) {
            if (memblock_alloc_device(ctx, &mem_47968, bytes_47881, "mem_47968")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47971, bytes_47884, "mem_47971")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47974, bytes_47930, "mem_47974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47977, binop_x_47883, "mem_47977")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_48465 = sext_i64_i32(sdiv_up64((int64_t) 4, computed_tblock_sizze_46471));
            int32_t num_chunks_48466 = sext_i64_i32(sdiv_up64(i16_res_41708, computed_tblock_sizze_46471));
            int32_t virt_num_tblocks_48467 = sext_i64_i32(n_blocks_41712);
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_intrablock_46498(ctx, n_blocks_41712, 1, 1, computed_tblock_sizze_46471, 1, 1, bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8) + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (int64_t) 32 + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8)), i16_res_41708, zzero_41709, n_blocks_41712, tmp_41751, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, computed_tblock_sizze_46471, bytes_47949, bytes_47951, bytes_47953, maxSubHelper_48094, mem_47846.mem, mem_47848.mem, mem_47968.mem, mem_47971.mem, mem_47974.mem, mem_47977.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47968, "mem_47968") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47971, "mem_47971") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47974, "mem_47974") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47977, "mem_47977") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47889, bytes_47888, "mem_47889")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47892, bytes_47888, "mem_47892")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47895, bytes_47888, "mem_47895")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47898, bytes_47888, "mem_47898")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47901, bytes_47888, "mem_47901")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, n_blocks_41712 * i16_res_41708)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_48525;
                
                shared_memory_48525 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_48526;
                
                thread_block_sizze_48526 = ctx->max_thread_block_size;
                
                int64_t registers_48527;
                
                registers_48527 = ctx->max_registers;
                
                int64_t thread_block_sizze_48528;
                
                thread_block_sizze_48528 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_48529 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48525, thread_block_sizze_48526), (int64_t) 2), squot64(squot64(registers_48527, thread_block_sizze_48528) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
                int64_t num_virt_blocks_48530 = sdiv_up64(n_blocks_41712 * i16_res_41708, segscan_tblock_sizze_46731 * chunk_sizze_48529);
                int64_t num_virt_threads_48531 = num_virt_blocks_48530 * segscan_tblock_sizze_46731;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48529, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_48532, num_virt_blocks_48530, "status_flags_mem_48532")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48532, num_virt_blocks_48530, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48534, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48534")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48536, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48536")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48538, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48538")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48540, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48540")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48542, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48542")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48544, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48544")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48546, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48546")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48548, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48548")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_sortColumn_intzisegscan_46741(ctx, num_tblocks_46732, 1, 1, *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46690, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_46731), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_46731 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), i16_res_41708, n_blocks_41712, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_46732, num_virt_blocks_48530, num_virt_threads_48531, mem_47846.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, status_flags_mem_48532.mem, aggregates_mem_48534.mem, incprefixes_mem_48536.mem, aggregates_mem_48538.mem, incprefixes_mem_48540.mem, aggregates_mem_48542.mem, incprefixes_mem_48544.mem, aggregates_mem_48546.mem, incprefixes_mem_48548.mem, global_dynid_mem_48550.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_47904, binop_x_47887, "mem_47904")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47906, binop_x_47887, "mem_47906")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47908, binop_x_47887, "mem_47908")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47910, binop_x_47887, "mem_47910")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48792 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_46772));
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_46779(ctx, segmap_usable_groups_46773, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46670, 1, 1, (int64_t) 0, i16_res_41708, zzero_41709, nonzzero_41710, n_blocks_41712, tmp_41751, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48801 = sext_i64_i32(sdiv_up64(n_blocks_41712 * i16_res_41708, segmap_tblock_sizze_46794));
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_46801(ctx, num_tblocks_46795, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46648, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, num_tblocks_46795, virt_num_tblocks_48801, mem_47846.mem, mem_47848.mem, mem_47882.mem, mem_47885.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47927, bytes_47926, "mem_47927")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48816 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_46814));
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_46819(ctx, num_tblocks_46815, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46626, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_46815, virt_num_tblocks_48816, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47927.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47931, bytes_47930, "mem_47931")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48829 = sext_i64_i32(sdiv_up64(n_blocks_41712 * (int64_t) 4, segmap_tblock_sizze_46831));
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_46836(ctx, segmap_usable_groups_46832, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46604, 1, 1, (int64_t) 0, n_blocks_41712, mem_47927.mem, mem_47931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47947, bytes_47926, "mem_47947")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48840 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_46841));
            
            {
                err = gpu_kernel_sortColumn_intzisegmap_46846(ctx, num_tblocks_46842, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46577, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_46842, virt_num_tblocks_48840, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47947.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47882, "mem_47882") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47885, "mem_47885") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47931, "mem_47931") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47947, "mem_47947") != 0)
                return 1;
        }
        {
            err = gpu_kernel_sortColumn_intzigpuseq_48854(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_47871.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47984.mem, mem_47985.mem, mem_47986.mem, mem_47987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48860 = sext_i64_i32(sdiv_up64((int64_t) 4, segmap_tblock_sizze_46462));
        
        {
            err = gpu_kernel_sortColumn_intzisegmap_46466(ctx, segmap_usable_groups_46463, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46454, 1, 1, (int64_t) 0, mem_47986.mem, mem_47989.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48869;
            
            shared_memory_48869 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48870;
            
            thread_block_sizze_48870 = ctx->max_thread_block_size;
            
            int64_t registers_48871;
            
            registers_48871 = ctx->max_registers;
            
            int64_t thread_block_sizze_48872;
            
            thread_block_sizze_48872 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48873 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48869, thread_block_sizze_48870), (int64_t) 8), squot64(squot64(registers_48871, thread_block_sizze_48872) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_48874 = sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_46859 * chunk_sizze_48873);
            int64_t num_virt_threads_48875 = num_virt_blocks_48874 * segscan_tblock_sizze_46859;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48873, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48876, num_virt_blocks_48874, "status_flags_mem_48876")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48876, num_virt_blocks_48874, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48878, (int64_t) 8 * num_virt_blocks_48874, "aggregates_mem_48878")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48880, (int64_t) 8 * num_virt_blocks_48874, "incprefixes_mem_48880")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_intzisegscan_46864(ctx, num_tblocks_46861, 1, 1, *ctx->tuning_params.sortColumn_intzisegscan_tblock_sizze_46858, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46859), chunk_sizze_48873 * segscan_tblock_sizze_46859 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_46859), chunk_sizze_48873 * segscan_tblock_sizze_46859 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_blocks_41712, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, num_tblocks_46861, num_virt_blocks_48874, num_virt_threads_48875, ext_mem_47981.mem, mem_47989.mem, mem_47992.mem, status_flags_mem_48876.mem, aggregates_mem_48878.mem, incprefixes_mem_48880.mem, global_dynid_mem_48882.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48971 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_46878));
        
        {
            err = gpu_kernel_sortColumn_intzisegmap_46882(ctx, segmap_usable_groups_46879, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46868, 1, 1, (int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, mem_47992.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t write_tmp_49031 = (int64_t) 0;
        
        if ((err = gpu_scalar_to_device(ctx, mem_47995.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t), &write_tmp_49031)) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48980 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_46891));
        
        {
            err = gpu_kernel_sortColumn_intzisegmap_46888(ctx, num_tblocks_46893, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46890, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, blocked_radix_sort_step_arg1_41776, num_tblocks_46893, ext_47978, ext_47979, virt_num_tblocks_48980, mem_47846.mem, mem_47848.mem, mem_47876.mem, mem_47878.mem, ext_mem_47980.mem, ext_mem_47982.mem, ext_mem_47983.mem, mem_47987.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_46911;
    
    segmap_tblock_sizze_46911 = *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46898;
    
    int64_t segmap_usable_groups_46912 = sdiv_up64(n_27501, segmap_tblock_sizze_46911);
    
    if (memblock_alloc_device(ctx, &mem_48005, bytes_48004, "mem_48005")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_48007, bytes_48006, "mem_48007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48994 = sext_i64_i32(sdiv_up64(n_27501, segmap_tblock_sizze_46911));
    
    {
        err = gpu_kernel_sortColumn_intzisegmap_46916(ctx, segmap_usable_groups_46912, 1, 1, *ctx->tuning_params.sortColumn_intzisegmap_tblock_sizze_46898, 1, 1, (int64_t) 0, n_27501, incr_27502, xs_mem_47844.mem, mem_47848.mem, mem_48005.mem, mem_48007.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48103, &mem_48005, "mem_48005") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_48007, "mem_48007") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49029, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49030, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_48007, "mem_48007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_48005, "mem_48005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48880, "incprefixes_mem_48880") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48878, "aggregates_mem_48878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48876, "status_flags_mem_48876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47947, "mem_47947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47931, "mem_47931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48548, "incprefixes_mem_48548") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48546, "aggregates_mem_48546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48544, "incprefixes_mem_48544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48542, "aggregates_mem_48542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48540, "incprefixes_mem_48540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48538, "aggregates_mem_48538") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48536, "incprefixes_mem_48536") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48534, "aggregates_mem_48534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48532, "status_flags_mem_48532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47974, "mem_47974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47971, "mem_47971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47968, "mem_47968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47869, "mem_47869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47868, "mem_47868") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47867, "mem_47867") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47866, "mem_47866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47870, "mem_47870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48177, "incprefixes_mem_48177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48175, "aggregates_mem_48175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48173, "incprefixes_mem_48173") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48171, "aggregates_mem_48171") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48169, "incprefixes_mem_48169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48167, "aggregates_mem_48167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48165, "incprefixes_mem_48165") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48163, "aggregates_mem_48163") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48141, "status_flags_mem_48141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_long(struct futhark_context *ctx, struct memblock_device *mem_out_p_49032, struct memblock_device *mem_out_p_49033, struct memblock_device xs_mem_47844, int64_t n_30101, int64_t incr_30102, int16_t block_sizze_30103)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_48007;
    
    mem_48007.references = NULL;
    
    struct memblock_device mem_48005;
    
    mem_48005.references = NULL;
    
    struct memblock_device incprefixes_mem_48880;
    
    incprefixes_mem_48880.references = NULL;
    
    struct memblock_device aggregates_mem_48878;
    
    aggregates_mem_48878.references = NULL;
    
    struct memblock_device status_flags_mem_48876;
    
    status_flags_mem_48876.references = NULL;
    
    struct memblock_device mem_47947;
    
    mem_47947.references = NULL;
    
    struct memblock_device mem_47931;
    
    mem_47931.references = NULL;
    
    struct memblock_device mem_47927;
    
    mem_47927.references = NULL;
    
    struct memblock_device mem_47910;
    
    mem_47910.references = NULL;
    
    struct memblock_device mem_47908;
    
    mem_47908.references = NULL;
    
    struct memblock_device mem_47906;
    
    mem_47906.references = NULL;
    
    struct memblock_device mem_47904;
    
    mem_47904.references = NULL;
    
    struct memblock_device incprefixes_mem_48548;
    
    incprefixes_mem_48548.references = NULL;
    
    struct memblock_device aggregates_mem_48546;
    
    aggregates_mem_48546.references = NULL;
    
    struct memblock_device incprefixes_mem_48544;
    
    incprefixes_mem_48544.references = NULL;
    
    struct memblock_device aggregates_mem_48542;
    
    aggregates_mem_48542.references = NULL;
    
    struct memblock_device incprefixes_mem_48540;
    
    incprefixes_mem_48540.references = NULL;
    
    struct memblock_device aggregates_mem_48538;
    
    aggregates_mem_48538.references = NULL;
    
    struct memblock_device incprefixes_mem_48536;
    
    incprefixes_mem_48536.references = NULL;
    
    struct memblock_device aggregates_mem_48534;
    
    aggregates_mem_48534.references = NULL;
    
    struct memblock_device status_flags_mem_48532;
    
    status_flags_mem_48532.references = NULL;
    
    struct memblock_device mem_47901;
    
    mem_47901.references = NULL;
    
    struct memblock_device mem_47898;
    
    mem_47898.references = NULL;
    
    struct memblock_device mem_47895;
    
    mem_47895.references = NULL;
    
    struct memblock_device mem_47892;
    
    mem_47892.references = NULL;
    
    struct memblock_device mem_47889;
    
    mem_47889.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device mem_47974;
    
    mem_47974.references = NULL;
    
    struct memblock_device mem_47971;
    
    mem_47971.references = NULL;
    
    struct memblock_device mem_47968;
    
    mem_47968.references = NULL;
    
    struct memblock_device ext_mem_47980;
    
    ext_mem_47980.references = NULL;
    
    struct memblock_device ext_mem_47981;
    
    ext_mem_47981.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device mem_47869;
    
    mem_47869.references = NULL;
    
    struct memblock_device mem_47868;
    
    mem_47868.references = NULL;
    
    struct memblock_device mem_47867;
    
    mem_47867.references = NULL;
    
    struct memblock_device mem_47866;
    
    mem_47866.references = NULL;
    
    struct memblock_device mem_47870;
    
    mem_47870.references = NULL;
    
    struct memblock_device ext_mem_47871;
    
    ext_mem_47871.references = NULL;
    
    struct memblock_device ext_mem_47872;
    
    ext_mem_47872.references = NULL;
    
    struct memblock_device ext_mem_47873;
    
    ext_mem_47873.references = NULL;
    
    struct memblock_device ext_mem_47874;
    
    ext_mem_47874.references = NULL;
    
    struct memblock_device incprefixes_mem_48177;
    
    incprefixes_mem_48177.references = NULL;
    
    struct memblock_device aggregates_mem_48175;
    
    aggregates_mem_48175.references = NULL;
    
    struct memblock_device incprefixes_mem_48173;
    
    incprefixes_mem_48173.references = NULL;
    
    struct memblock_device aggregates_mem_48171;
    
    aggregates_mem_48171.references = NULL;
    
    struct memblock_device incprefixes_mem_48169;
    
    incprefixes_mem_48169.references = NULL;
    
    struct memblock_device aggregates_mem_48167;
    
    aggregates_mem_48167.references = NULL;
    
    struct memblock_device incprefixes_mem_48165;
    
    incprefixes_mem_48165.references = NULL;
    
    struct memblock_device aggregates_mem_48163;
    
    aggregates_mem_48163.references = NULL;
    
    struct memblock_device status_flags_mem_48141;
    
    status_flags_mem_48141.references = NULL;
    
    struct memblock_device mem_47995;
    
    mem_47995.references = NULL;
    
    struct memblock_device mem_47992;
    
    mem_47992.references = NULL;
    
    struct memblock_device mem_47989;
    
    mem_47989.references = NULL;
    
    struct memblock_device mem_47987;
    
    mem_47987.references = NULL;
    
    struct memblock_device mem_47986;
    
    mem_47986.references = NULL;
    
    struct memblock_device mem_47985;
    
    mem_47985.references = NULL;
    
    struct memblock_device mem_47984;
    
    mem_47984.references = NULL;
    
    struct memblock_device mem_47885;
    
    mem_47885.references = NULL;
    
    struct memblock_device mem_47882;
    
    mem_47882.references = NULL;
    
    struct memblock_device mem_47878;
    
    mem_47878.references = NULL;
    
    struct memblock_device mem_47876;
    
    mem_47876.references = NULL;
    
    struct memblock_device mem_47865;
    
    mem_47865.references = NULL;
    
    struct memblock_device mem_47863;
    
    mem_47863.references = NULL;
    
    struct memblock_device mem_47861;
    
    mem_47861.references = NULL;
    
    struct memblock_device mem_47859;
    
    mem_47859.references = NULL;
    
    struct memblock_device mem_47857;
    
    mem_47857.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t rng_41702 = add64(n_30101, incr_30102);
    bool bounds_invalid_upwards_41703 = slt64(rng_41702, incr_30102);
    bool valid_41704 = !bounds_invalid_upwards_41703;
    bool range_valid_c_41705;
    
    if (!valid_41704) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_30102, "..<", (long long) rng_41702, " is invalid.", "-> #0  ftbasics.fut:18:25-40\n   #1  ftbasics.fut:121:32-58\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:121:32-63\n   #4  ftsort.fut:22:3-45\n   #5  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_41706 = n_30101 == (int64_t) 0;
    int32_t iters_41707;
    
    if (cond_41706) {
        iters_41707 = 0;
    } else {
        iters_41707 = 32;
    }
    
    int64_t i16_res_41708 = sext_i16_i64(block_sizze_30103);
    bool zzero_41709 = i16_res_41708 == (int64_t) 0;
    bool nonzzero_41710 = !zzero_41709;
    bool nonzzero_cert_41711;
    
    if (!nonzzero_41710) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:222:20-27\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:22:3-45\n   #6  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t n_blocks_41712 = sdiv64(n_30101, i16_res_41708);
    int64_t rest_41713 = smod64(n_30101, i16_res_41708);
    int64_t arg_41714 = mul64(i16_res_41708, n_blocks_41712);
    int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 = add64(rest_41713, arg_41714);
    bool dim_match_41716 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 == n_30101;
    bool empty_or_match_cert_41717;
    
    if (!dim_match_41716) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) n_30101, "] cannot match shape of type `[", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "](i64, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:224:12-46\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #3  /prelude/functional.fut:9:44-45\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #5  ftbasics.fut:122:93-96\n   #6  ftsort.fut:22:3-45\n   #7  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47845 = (int64_t) 8 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool loop_nonempty_41721 = slt32(0, iters_41707);
    int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 = add64((int64_t) 1, n_blocks_41712);
    int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 = mul64((int64_t) 4, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);
    bool empty_slice_41724 = arg_41714 == (int64_t) 0;
    int64_t m_41725 = sub64(arg_41714, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_41726 = sle64((int64_t) 0, m_41725);
    bool i_p_m_t_s_leq_w_41727 = slt64(m_41725, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41728 = sle64((int64_t) 0, arg_41714);
    bool y_41729 = zzero_leq_i_p_m_t_s_41726 && i_p_m_t_s_leq_w_41727;
    bool forwards_ok_41730 = i_lte_j_41728 && y_41729;
    bool ok_or_empty_41731 = empty_slice_41724 || forwards_ok_41730;
    bool loop_not_taken_41732 = !loop_nonempty_41721;
    bool protect_assert_disj_41733 = ok_or_empty_41731 || loop_not_taken_41732;
    bool index_certs_41734;
    
    if (!protect_assert_disj_41733) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) arg_41714, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:4-11\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:22:3-45\n   #8  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_41735 = rest_41713 == (int64_t) 0;
    int64_t m_41736 = sub64(rest_41713, (int64_t) 1);
    int64_t i_p_m_t_s_41737 = add64(arg_41714, m_41736);
    bool zzero_leq_i_p_m_t_s_41738 = sle64((int64_t) 0, i_p_m_t_s_41737);
    bool i_p_m_t_s_leq_w_41739 = slt64(i_p_m_t_s_41737, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41740 = sle64(arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool y_41741 = zzero_leq_i_p_m_t_s_41738 && i_p_m_t_s_leq_w_41739;
    bool forwards_ok_41742 = i_lte_j_41740 && y_41741;
    bool ok_or_empty_41743 = empty_slice_41735 || forwards_ok_41742;
    bool protect_assert_disj_41744 = loop_not_taken_41732 || ok_or_empty_41743;
    bool index_certs_41745;
    
    if (!protect_assert_disj_41744) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_41714, ":", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:13-24\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:22:3-45\n   #8  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool binop_x_41746 = sle64((int64_t) 0, n_blocks_41712);
    bool binop_y_41747 = sle64((int64_t) 0, i16_res_41708);
    bool binop_y_41748 = binop_x_41746 && binop_y_41747;
    bool protect_assert_disj_41749 = loop_not_taken_41732 || binop_y_41748;
    bool dim_ok_cert_41750;
    
    if (!protect_assert_disj_41749) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Cannot unflatten array of shape [", (long long) arg_41714, "] to array of shape [", (long long) n_blocks_41712, "][", (long long) i16_res_41708, "]", "-> #0  /prelude/array.fut:184:3-30\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-168:21\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:22:3-45\n   #8  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_41751 = sub64(i16_res_41708, (int64_t) 1);
    bool x_41752 = sle64((int64_t) 0, tmp_41751);
    bool y_41753 = slt64(tmp_41751, i16_res_41708);
    bool bounds_check_41754 = x_41752 && y_41753;
    bool protect_assert_disj_41755 = zzero_41709 || bounds_check_41754;
    bool protect_assert_disj_41756 = loop_not_taken_41732 || protect_assert_disj_41755;
    bool index_certs_41757;
    
    if (!protect_assert_disj_41756) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_41751, "] out of bounds for array of shape [", (long long) i16_res_41708, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:22:3-45\n   #9  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_41759 = slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);
    bool protect_assert_disj_41760 = loop_not_taken_41732 || y_41759;
    bool index_certs_41761;
    
    if (!protect_assert_disj_41760) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, "].", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:122:3-123:7\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:178:8-20\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:22:3-45\n   #9  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_41763 = nonzzero_41710 || loop_not_taken_41732;
    bool nonzzero_cert_41764;
    
    if (!protect_assert_disj_41763) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:186:27-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:22:3-45\n   #10 ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_41765 = sle64((int64_t) 0, m_41736);
    bool y_41766 = slt64(m_41736, rest_41713);
    bool bounds_check_41767 = x_41765 && y_41766;
    bool protect_assert_disj_41768 = empty_slice_41735 || bounds_check_41767;
    bool protect_assert_disj_41769 = loop_not_taken_41732 || protect_assert_disj_41768;
    bool index_certs_41770;
    
    if (!protect_assert_disj_41769) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_41736, "] out of bounds for array of shape [", (long long) rest_41713, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:166:41-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:22:3-45\n   #9  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47856 = (int64_t) 2 * rest_41713;
    int64_t bytes_47875 = (int64_t) 8 * rest_41713;
    int64_t binop_x_47880 = (int64_t) 8 * n_blocks_41712;
    int64_t bytes_47881 = i16_res_41708 * binop_x_47880;
    int64_t bytes_47991 = (int64_t) 32 * dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;
    bool dim_match_42002 = n_30101 == dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool empty_or_match_cert_42003;
    
    if (!dim_match_42002) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] cannot match shape of type `[", (long long) n_30101, "](i64, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:225:6-11\n   #2  /prelude/functional.fut:26:41-42\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:226:6-227:50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:22:3-45\n   #9  ftsort.fut:21:1-22:45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_48004 = (int64_t) 8 * n_30101;
    
    if (memblock_alloc_device(ctx, &mem_47846, bytes_47845, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xs_mem_47844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47845, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_47848, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_44913;
    
    segscan_tblock_sizze_44913 = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_44912;
    
    int64_t num_tblocks_44915;
    int64_t max_num_tblocks_48122;
    
    max_num_tblocks_48122 = *ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_44914;
    num_tblocks_44915 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segscan_tblock_sizze_44913), max_num_tblocks_48122)));
    
    int64_t segmap_tblock_sizze_44923;
    
    segmap_tblock_sizze_44923 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44922;
    
    int64_t num_tblocks_44925;
    int64_t max_num_tblocks_48123;
    
    max_num_tblocks_48123 = *ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_44924;
    num_tblocks_44925 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segmap_tblock_sizze_44923), max_num_tblocks_48123)));
    
    int64_t segmap_tblock_sizze_44938;
    
    segmap_tblock_sizze_44938 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44930;
    
    int64_t segmap_usable_groups_44939 = sdiv_up_safe64((int64_t) 4, segmap_tblock_sizze_44938);
    int64_t intra_avail_par_44958 = smin64((int64_t) 4, i16_res_41708);
    int64_t computed_tblock_sizze_44947 = smax64((int64_t) 4, i16_res_41708);
    int64_t max_tblock_sizze_44966;
    
    max_tblock_sizze_44966 = ctx->max_thread_block_size;
    
    bool fits_44967 = sle64(computed_tblock_sizze_44947, max_tblock_sizze_44966);
    bool suff_intra_par_44965;
    
    suff_intra_par_44965 = *ctx->tuning_params.sortColumn_longzisuff_intra_par_0 <= intra_avail_par_44958;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "sortColumn_long.suff_intra_par_0", (long) intra_avail_par_44958, suff_intra_par_44965 ? "true" : "false");
    
    bool intra_suff_and_fits_44968 = suff_intra_par_44965 && fits_44967;
    int64_t segscan_tblock_sizze_45203;
    
    segscan_tblock_sizze_45203 = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45164;
    
    int64_t num_tblocks_45204;
    int64_t max_num_tblocks_48124;
    
    max_num_tblocks_48124 = *ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_45166;
    num_tblocks_45204 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segscan_tblock_sizze_45203), max_num_tblocks_48124)));
    
    int64_t segmap_tblock_sizze_45242;
    
    segmap_tblock_sizze_45242 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45144;
    
    int64_t segmap_tblock_sizze_45264;
    
    segmap_tblock_sizze_45264 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45122;
    
    int64_t num_tblocks_45265;
    int64_t max_num_tblocks_48125;
    
    max_num_tblocks_48125 = *ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45124;
    num_tblocks_45265 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segmap_tblock_sizze_45264), max_num_tblocks_48125)));
    
    int64_t segmap_tblock_sizze_45284;
    
    segmap_tblock_sizze_45284 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45100;
    
    int64_t num_tblocks_45285;
    int64_t max_num_tblocks_48126;
    
    max_num_tblocks_48126 = *ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45102;
    num_tblocks_45285 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_45284), max_num_tblocks_48126)));
    
    int64_t nest_sizze_45300 = (int64_t) 4 * n_blocks_41712;
    int64_t segmap_tblock_sizze_45301;
    
    segmap_tblock_sizze_45301 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45078;
    
    int64_t segmap_tblock_sizze_45311;
    
    segmap_tblock_sizze_45311 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45051;
    
    int64_t num_tblocks_45312;
    int64_t max_num_tblocks_48127;
    
    max_num_tblocks_48127 = *ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45053;
    num_tblocks_45312 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_45311), max_num_tblocks_48127)));
    
    int64_t segscan_tblock_sizze_45329;
    
    segscan_tblock_sizze_45329 = *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45328;
    
    int64_t num_tblocks_45331;
    int64_t max_num_tblocks_48128;
    
    max_num_tblocks_48128 = *ctx->tuning_params.sortColumn_longzisegscan_num_tblocks_45330;
    num_tblocks_45331 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_45329), max_num_tblocks_48128)));
    
    int64_t segmap_tblock_sizze_45348;
    
    segmap_tblock_sizze_45348 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45338;
    
    int64_t segmap_usable_groups_45349 = sdiv_up_safe64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_45348);
    int64_t segmap_tblock_sizze_45361;
    
    segmap_tblock_sizze_45361 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45360;
    
    int64_t num_tblocks_45363;
    int64_t max_num_tblocks_48129;
    
    max_num_tblocks_48129 = *ctx->tuning_params.sortColumn_longzisegmap_num_tblocks_45362;
    num_tblocks_45363 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_45361), max_num_tblocks_48129)));
    
    int64_t segmap_usable_groups_45243 = sdiv_up_safe64(n_blocks_41712, segmap_tblock_sizze_45242);
    int64_t segmap_usable_groups_45302 = sdiv_up_safe64(nest_sizze_45300, segmap_tblock_sizze_45301);
    int64_t ext_47979;
    int64_t shared_memory_capacity_48130;
    
    shared_memory_capacity_48130 = ctx->max_shared_memory;
    if (intra_suff_and_fits_44968) {
        ext_47979 = (int64_t) 4;
    } else {
        ext_47979 = (int64_t) 1;
    }
    
    int64_t ext_47978;
    int64_t shared_memory_capacity_48131;
    
    shared_memory_capacity_48131 = ctx->max_shared_memory;
    if (intra_suff_and_fits_44968) {
        ext_47978 = (int64_t) 1;
    } else {
        ext_47978 = n_blocks_41712;
    }
    
    int64_t binop_x_47887 = (int64_t) 2 * n_blocks_41712;
    int64_t bytes_47888 = i16_res_41708 * binop_x_47887;
    int64_t binop_y_47918 = n_blocks_41712 - (int64_t) 1;
    int64_t binop_x_47920 = smax64((int64_t) 0, binop_y_47918);
    int64_t binop_y_47922 = (int64_t) 3 * n_blocks_41712;
    int64_t binop_y_47923 = smax64((int64_t) 0, binop_y_47922);
    int64_t binop_y_47924 = binop_x_47920 + binop_y_47923;
    int64_t binop_y_47925 = (int64_t) 1 + binop_y_47924;
    int64_t bytes_47926 = (int64_t) 2 * binop_y_47925;
    int64_t bytes_47930 = (int64_t) 32 * n_blocks_41712;
    int64_t bytes_47949 = (int64_t) 8 * i16_res_41708;
    int64_t bytes_47953 = (int64_t) 2 * i16_res_41708;
    
    if (memblock_alloc_device(ctx, &mem_47857, bytes_47856, "mem_47857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47859, bytes_47856, "mem_47859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47861, bytes_47856, "mem_47861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47863, bytes_47856, "mem_47863")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47865, bytes_47856, "mem_47865")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47876, bytes_47875, "mem_47876")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47878, bytes_47875, "mem_47878")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47882, bytes_47881, "mem_47882")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47885, bytes_47881, "mem_47885")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47984, (int64_t) 8, "mem_47984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47985, (int64_t) 8, "mem_47985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47986, (int64_t) 8, "mem_47986")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47987, (int64_t) 8, "mem_47987")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47989, (int64_t) 32, "mem_47989")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47992, bytes_47991, "mem_47992")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47995, bytes_47991, "mem_47995")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t maxSubHelper_48094 = umax64((int64_t) 8, bytes_47953);
    
    for (int32_t i_41773 = 0; i_41773 < iters_41707; i_41773++) {
        int32_t blocked_radix_sort_step_arg1_41776 = mul32(2, i_41773);
        int32_t get_bit_arg0_41781 = add32(1, blocked_radix_sort_step_arg1_41776);
        bool cond_41782 = get_bit_arg0_41781 == 63;
        bool cond_41783 = blocked_radix_sort_step_arg1_41776 == 63;
        
        if (slt64((int64_t) 0, rest_41713)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48134;
            
            shared_memory_48134 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48135;
            
            thread_block_sizze_48135 = ctx->max_thread_block_size;
            
            int64_t registers_48136;
            
            registers_48136 = ctx->max_registers;
            
            int64_t thread_block_sizze_48137;
            
            thread_block_sizze_48137 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48138 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48134, thread_block_sizze_48135), (int64_t) 2), squot64(squot64(registers_48136, thread_block_sizze_48137) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
            int64_t num_virt_blocks_48139 = sdiv_up64(rest_41713, segscan_tblock_sizze_44913 * chunk_sizze_48138);
            int64_t num_virt_threads_48140 = num_virt_blocks_48139 * segscan_tblock_sizze_44913;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48138, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48141, num_virt_blocks_48139, "status_flags_mem_48141")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48141, num_virt_blocks_48139, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48163, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48163")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48165, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48165")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48167, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48167")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48169, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48169")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48171, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48173, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48175, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48177, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48177")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_longzisegscan_44918(ctx, num_tblocks_44915, 1, 1, *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_44912, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44913), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44913 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), rest_41713, arg_41714, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_44915, num_virt_blocks_48139, num_virt_threads_48140, mem_47846.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, status_flags_mem_48141.mem, aggregates_mem_48163.mem, incprefixes_mem_48165.mem, aggregates_mem_48167.mem, incprefixes_mem_48169.mem, aggregates_mem_48171.mem, incprefixes_mem_48173.mem, aggregates_mem_48175.mem, incprefixes_mem_48177.mem, global_dynid_mem_48179.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (empty_slice_41735) {
            if (memblock_alloc_device(ctx, &mem_47870, (int64_t) 2, "mem_47870")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i16(ctx, mem_47870, (int64_t) 1, (int16_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47870, "mem_47870") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47866, (int64_t) 2, "mem_47866")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47867, (int64_t) 2, "mem_47867")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47868, (int64_t) 2, "mem_47868")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47869, (int64_t) 2, "mem_47869")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_longzigpuseq_48446(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_41736, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47866.mem, mem_47867.mem, mem_47868.mem, mem_47869.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47866, "mem_47866") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47867, "mem_47867") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47868, "mem_47868") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47869, "mem_47869") != 0)
                return 1;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47876.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47848.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47878.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47846.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48452 = sext_i64_i32(sdiv_up64(rest_41713, segmap_tblock_sizze_44923));
        
        {
            err = gpu_kernel_sortColumn_longzisegmap_44920(ctx, num_tblocks_44925, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44922, 1, 1, (int64_t) 0, rest_41713, arg_41714, num_tblocks_44925, virt_num_tblocks_48452, mem_47846.mem, mem_47848.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47876.mem, mem_47878.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47882.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47885.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        
        int64_t shared_memory_capacity_48853;
        
        shared_memory_capacity_48853 = ctx->max_shared_memory;
        if (intra_suff_and_fits_44968 && sle64(sdiv_up64(maxSubHelper_48094, (int64_t) 8) * (int64_t) 8 + (int64_t) 32 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47953, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48853)) {
            if (memblock_alloc_device(ctx, &mem_47968, bytes_47881, "mem_47968")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47971, bytes_47881, "mem_47971")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47974, bytes_47930, "mem_47974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47977, binop_x_47880, "mem_47977")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_48465 = sext_i64_i32(sdiv_up64((int64_t) 4, computed_tblock_sizze_44947));
            int32_t num_chunks_48466 = sext_i64_i32(sdiv_up64(i16_res_41708, computed_tblock_sizze_44947));
            int32_t virt_num_tblocks_48467 = sext_i64_i32(n_blocks_41712);
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_intrablock_44974(ctx, n_blocks_41712, 1, 1, computed_tblock_sizze_44947, 1, 1, bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (bytes_47953 + srem64((int64_t) 8 - srem64(bytes_47953, (int64_t) 8), (int64_t) 8)) + (int64_t) 32 + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8)), i16_res_41708, zzero_41709, n_blocks_41712, tmp_41751, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, computed_tblock_sizze_44947, bytes_47949, bytes_47953, maxSubHelper_48094, mem_47846.mem, mem_47848.mem, mem_47968.mem, mem_47971.mem, mem_47974.mem, mem_47977.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47968, "mem_47968") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47971, "mem_47971") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47974, "mem_47974") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47977, "mem_47977") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47889, bytes_47888, "mem_47889")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47892, bytes_47888, "mem_47892")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47895, bytes_47888, "mem_47895")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47898, bytes_47888, "mem_47898")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47901, bytes_47888, "mem_47901")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, n_blocks_41712 * i16_res_41708)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_48525;
                
                shared_memory_48525 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_48526;
                
                thread_block_sizze_48526 = ctx->max_thread_block_size;
                
                int64_t registers_48527;
                
                registers_48527 = ctx->max_registers;
                
                int64_t thread_block_sizze_48528;
                
                thread_block_sizze_48528 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_48529 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48525, thread_block_sizze_48526), (int64_t) 2), squot64(squot64(registers_48527, thread_block_sizze_48528) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
                int64_t num_virt_blocks_48530 = sdiv_up64(n_blocks_41712 * i16_res_41708, segscan_tblock_sizze_45203 * chunk_sizze_48529);
                int64_t num_virt_threads_48531 = num_virt_blocks_48530 * segscan_tblock_sizze_45203;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48529, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_48532, num_virt_blocks_48530, "status_flags_mem_48532")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48532, num_virt_blocks_48530, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48534, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48534")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48536, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48536")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48538, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48538")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48540, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48540")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48542, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48542")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48544, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48544")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48546, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48546")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48548, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48548")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_sortColumn_longzisegscan_45213(ctx, num_tblocks_45204, 1, 1, *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45164, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_45203), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_45203 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), i16_res_41708, n_blocks_41712, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_45204, num_virt_blocks_48530, num_virt_threads_48531, mem_47846.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, status_flags_mem_48532.mem, aggregates_mem_48534.mem, incprefixes_mem_48536.mem, aggregates_mem_48538.mem, incprefixes_mem_48540.mem, aggregates_mem_48542.mem, incprefixes_mem_48544.mem, aggregates_mem_48546.mem, incprefixes_mem_48548.mem, global_dynid_mem_48550.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_47904, binop_x_47887, "mem_47904")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47906, binop_x_47887, "mem_47906")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47908, binop_x_47887, "mem_47908")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47910, binop_x_47887, "mem_47910")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48792 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_45242));
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_45249(ctx, segmap_usable_groups_45243, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45144, 1, 1, (int64_t) 0, i16_res_41708, zzero_41709, nonzzero_41710, n_blocks_41712, tmp_41751, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48801 = sext_i64_i32(sdiv_up64(n_blocks_41712 * i16_res_41708, segmap_tblock_sizze_45264));
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_45271(ctx, num_tblocks_45265, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45122, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, num_tblocks_45265, virt_num_tblocks_48801, mem_47846.mem, mem_47848.mem, mem_47882.mem, mem_47885.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47927, bytes_47926, "mem_47927")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48816 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_45284));
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_45289(ctx, num_tblocks_45285, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45100, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_45285, virt_num_tblocks_48816, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47927.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47931, bytes_47930, "mem_47931")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48829 = sext_i64_i32(sdiv_up64(n_blocks_41712 * (int64_t) 4, segmap_tblock_sizze_45301));
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_45306(ctx, segmap_usable_groups_45302, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45078, 1, 1, (int64_t) 0, n_blocks_41712, mem_47927.mem, mem_47931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47947, bytes_47926, "mem_47947")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48840 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_45311));
            
            {
                err = gpu_kernel_sortColumn_longzisegmap_45316(ctx, num_tblocks_45312, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45051, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_45312, virt_num_tblocks_48840, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47947.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47882, "mem_47882") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47885, "mem_47885") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47931, "mem_47931") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47947, "mem_47947") != 0)
                return 1;
        }
        {
            err = gpu_kernel_sortColumn_longzigpuseq_48854(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_47871.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47984.mem, mem_47985.mem, mem_47986.mem, mem_47987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48860 = sext_i64_i32(sdiv_up64((int64_t) 4, segmap_tblock_sizze_44938));
        
        {
            err = gpu_kernel_sortColumn_longzisegmap_44942(ctx, segmap_usable_groups_44939, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_44930, 1, 1, (int64_t) 0, mem_47986.mem, mem_47989.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48869;
            
            shared_memory_48869 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48870;
            
            thread_block_sizze_48870 = ctx->max_thread_block_size;
            
            int64_t registers_48871;
            
            registers_48871 = ctx->max_registers;
            
            int64_t thread_block_sizze_48872;
            
            thread_block_sizze_48872 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48873 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48869, thread_block_sizze_48870), (int64_t) 8), squot64(squot64(registers_48871, thread_block_sizze_48872) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_48874 = sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_45329 * chunk_sizze_48873);
            int64_t num_virt_threads_48875 = num_virt_blocks_48874 * segscan_tblock_sizze_45329;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48873, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48876, num_virt_blocks_48874, "status_flags_mem_48876")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48876, num_virt_blocks_48874, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48878, (int64_t) 8 * num_virt_blocks_48874, "aggregates_mem_48878")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48880, (int64_t) 8 * num_virt_blocks_48874, "incprefixes_mem_48880")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_longzisegscan_45334(ctx, num_tblocks_45331, 1, 1, *ctx->tuning_params.sortColumn_longzisegscan_tblock_sizze_45328, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45329), chunk_sizze_48873 * segscan_tblock_sizze_45329 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_45329), chunk_sizze_48873 * segscan_tblock_sizze_45329 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_blocks_41712, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, num_tblocks_45331, num_virt_blocks_48874, num_virt_threads_48875, ext_mem_47981.mem, mem_47989.mem, mem_47992.mem, status_flags_mem_48876.mem, aggregates_mem_48878.mem, incprefixes_mem_48880.mem, global_dynid_mem_48882.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48971 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_45348));
        
        {
            err = gpu_kernel_sortColumn_longzisegmap_45352(ctx, segmap_usable_groups_45349, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45338, 1, 1, (int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, mem_47992.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t write_tmp_49034 = (int64_t) 0;
        
        if ((err = gpu_scalar_to_device(ctx, mem_47995.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t), &write_tmp_49034)) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48980 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_45361));
        
        {
            err = gpu_kernel_sortColumn_longzisegmap_45358(ctx, num_tblocks_45363, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45360, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, blocked_radix_sort_step_arg1_41776, num_tblocks_45363, ext_47978, ext_47979, virt_num_tblocks_48980, mem_47846.mem, mem_47848.mem, mem_47876.mem, mem_47878.mem, ext_mem_47980.mem, ext_mem_47982.mem, ext_mem_47983.mem, mem_47987.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_45381;
    
    segmap_tblock_sizze_45381 = *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45368;
    
    int64_t segmap_usable_groups_45382 = sdiv_up64(n_30101, segmap_tblock_sizze_45381);
    
    if (memblock_alloc_device(ctx, &mem_48005, bytes_48004, "mem_48005")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_48007, bytes_48004, "mem_48007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48994 = sext_i64_i32(sdiv_up64(n_30101, segmap_tblock_sizze_45381));
    
    {
        err = gpu_kernel_sortColumn_longzisegmap_45386(ctx, segmap_usable_groups_45382, 1, 1, *ctx->tuning_params.sortColumn_longzisegmap_tblock_sizze_45368, 1, 1, (int64_t) 0, n_30101, incr_30102, xs_mem_47844.mem, mem_47848.mem, mem_48005.mem, mem_48007.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48103, &mem_48005, "mem_48005") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_48007, "mem_48007") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49032, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49033, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_48007, "mem_48007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_48005, "mem_48005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48880, "incprefixes_mem_48880") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48878, "aggregates_mem_48878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48876, "status_flags_mem_48876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47947, "mem_47947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47931, "mem_47931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48548, "incprefixes_mem_48548") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48546, "aggregates_mem_48546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48544, "incprefixes_mem_48544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48542, "aggregates_mem_48542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48540, "incprefixes_mem_48540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48538, "aggregates_mem_48538") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48536, "incprefixes_mem_48536") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48534, "aggregates_mem_48534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48532, "status_flags_mem_48532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47974, "mem_47974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47971, "mem_47971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47968, "mem_47968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47869, "mem_47869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47868, "mem_47868") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47867, "mem_47867") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47866, "mem_47866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47870, "mem_47870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48177, "incprefixes_mem_48177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48175, "aggregates_mem_48175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48173, "incprefixes_mem_48173") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48171, "aggregates_mem_48171") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48169, "incprefixes_mem_48169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48167, "aggregates_mem_48167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48165, "incprefixes_mem_48165") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48163, "aggregates_mem_48163") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48141, "status_flags_mem_48141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortColumn_short(struct futhark_context *ctx, struct memblock_device *mem_out_p_49035, struct memblock_device *mem_out_p_49036, struct memblock_device xs_mem_47844, int64_t n_24884, int64_t incr_24885, int16_t block_sizze_24886)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device mem_48007;
    
    mem_48007.references = NULL;
    
    struct memblock_device mem_48005;
    
    mem_48005.references = NULL;
    
    struct memblock_device incprefixes_mem_48880;
    
    incprefixes_mem_48880.references = NULL;
    
    struct memblock_device aggregates_mem_48878;
    
    aggregates_mem_48878.references = NULL;
    
    struct memblock_device status_flags_mem_48876;
    
    status_flags_mem_48876.references = NULL;
    
    struct memblock_device mem_47947;
    
    mem_47947.references = NULL;
    
    struct memblock_device mem_47931;
    
    mem_47931.references = NULL;
    
    struct memblock_device mem_47927;
    
    mem_47927.references = NULL;
    
    struct memblock_device mem_47910;
    
    mem_47910.references = NULL;
    
    struct memblock_device mem_47908;
    
    mem_47908.references = NULL;
    
    struct memblock_device mem_47906;
    
    mem_47906.references = NULL;
    
    struct memblock_device mem_47904;
    
    mem_47904.references = NULL;
    
    struct memblock_device incprefixes_mem_48548;
    
    incprefixes_mem_48548.references = NULL;
    
    struct memblock_device aggregates_mem_48546;
    
    aggregates_mem_48546.references = NULL;
    
    struct memblock_device incprefixes_mem_48544;
    
    incprefixes_mem_48544.references = NULL;
    
    struct memblock_device aggregates_mem_48542;
    
    aggregates_mem_48542.references = NULL;
    
    struct memblock_device incprefixes_mem_48540;
    
    incprefixes_mem_48540.references = NULL;
    
    struct memblock_device aggregates_mem_48538;
    
    aggregates_mem_48538.references = NULL;
    
    struct memblock_device incprefixes_mem_48536;
    
    incprefixes_mem_48536.references = NULL;
    
    struct memblock_device aggregates_mem_48534;
    
    aggregates_mem_48534.references = NULL;
    
    struct memblock_device status_flags_mem_48532;
    
    status_flags_mem_48532.references = NULL;
    
    struct memblock_device mem_47901;
    
    mem_47901.references = NULL;
    
    struct memblock_device mem_47898;
    
    mem_47898.references = NULL;
    
    struct memblock_device mem_47895;
    
    mem_47895.references = NULL;
    
    struct memblock_device mem_47892;
    
    mem_47892.references = NULL;
    
    struct memblock_device mem_47889;
    
    mem_47889.references = NULL;
    
    struct memblock_device mem_47977;
    
    mem_47977.references = NULL;
    
    struct memblock_device mem_47974;
    
    mem_47974.references = NULL;
    
    struct memblock_device mem_47971;
    
    mem_47971.references = NULL;
    
    struct memblock_device mem_47968;
    
    mem_47968.references = NULL;
    
    struct memblock_device ext_mem_47980;
    
    ext_mem_47980.references = NULL;
    
    struct memblock_device ext_mem_47981;
    
    ext_mem_47981.references = NULL;
    
    struct memblock_device ext_mem_47982;
    
    ext_mem_47982.references = NULL;
    
    struct memblock_device ext_mem_47983;
    
    ext_mem_47983.references = NULL;
    
    struct memblock_device mem_47869;
    
    mem_47869.references = NULL;
    
    struct memblock_device mem_47868;
    
    mem_47868.references = NULL;
    
    struct memblock_device mem_47867;
    
    mem_47867.references = NULL;
    
    struct memblock_device mem_47866;
    
    mem_47866.references = NULL;
    
    struct memblock_device mem_47870;
    
    mem_47870.references = NULL;
    
    struct memblock_device ext_mem_47871;
    
    ext_mem_47871.references = NULL;
    
    struct memblock_device ext_mem_47872;
    
    ext_mem_47872.references = NULL;
    
    struct memblock_device ext_mem_47873;
    
    ext_mem_47873.references = NULL;
    
    struct memblock_device ext_mem_47874;
    
    ext_mem_47874.references = NULL;
    
    struct memblock_device incprefixes_mem_48177;
    
    incprefixes_mem_48177.references = NULL;
    
    struct memblock_device aggregates_mem_48175;
    
    aggregates_mem_48175.references = NULL;
    
    struct memblock_device incprefixes_mem_48173;
    
    incprefixes_mem_48173.references = NULL;
    
    struct memblock_device aggregates_mem_48171;
    
    aggregates_mem_48171.references = NULL;
    
    struct memblock_device incprefixes_mem_48169;
    
    incprefixes_mem_48169.references = NULL;
    
    struct memblock_device aggregates_mem_48167;
    
    aggregates_mem_48167.references = NULL;
    
    struct memblock_device incprefixes_mem_48165;
    
    incprefixes_mem_48165.references = NULL;
    
    struct memblock_device aggregates_mem_48163;
    
    aggregates_mem_48163.references = NULL;
    
    struct memblock_device status_flags_mem_48141;
    
    status_flags_mem_48141.references = NULL;
    
    struct memblock_device mem_47995;
    
    mem_47995.references = NULL;
    
    struct memblock_device mem_47992;
    
    mem_47992.references = NULL;
    
    struct memblock_device mem_47989;
    
    mem_47989.references = NULL;
    
    struct memblock_device mem_47987;
    
    mem_47987.references = NULL;
    
    struct memblock_device mem_47986;
    
    mem_47986.references = NULL;
    
    struct memblock_device mem_47985;
    
    mem_47985.references = NULL;
    
    struct memblock_device mem_47984;
    
    mem_47984.references = NULL;
    
    struct memblock_device mem_47885;
    
    mem_47885.references = NULL;
    
    struct memblock_device mem_47882;
    
    mem_47882.references = NULL;
    
    struct memblock_device mem_47878;
    
    mem_47878.references = NULL;
    
    struct memblock_device mem_47876;
    
    mem_47876.references = NULL;
    
    struct memblock_device mem_47865;
    
    mem_47865.references = NULL;
    
    struct memblock_device mem_47863;
    
    mem_47863.references = NULL;
    
    struct memblock_device mem_47861;
    
    mem_47861.references = NULL;
    
    struct memblock_device mem_47859;
    
    mem_47859.references = NULL;
    
    struct memblock_device mem_47857;
    
    mem_47857.references = NULL;
    
    struct memblock_device mem_47848;
    
    mem_47848.references = NULL;
    
    struct memblock_device mem_47846;
    
    mem_47846.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t rng_41702 = add64(n_24884, incr_24885);
    bool bounds_invalid_upwards_41703 = slt64(rng_41702, incr_24885);
    bool valid_41704 = !bounds_invalid_upwards_41703;
    bool range_valid_c_41705;
    
    if (!valid_41704) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_24885, "..<", (long long) rng_41702, " is invalid.", "-> #0  ftbasics.fut:18:25-40\n   #1  ftbasics.fut:121:32-58\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftbasics.fut:121:32-63\n   #4  ftsort.fut:16:3-46\n   #5  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_41706 = n_24884 == (int64_t) 0;
    int32_t iters_41707;
    
    if (cond_41706) {
        iters_41707 = 0;
    } else {
        iters_41707 = 8;
    }
    
    int64_t i16_res_41708 = sext_i16_i64(block_sizze_24886);
    bool zzero_41709 = i16_res_41708 == (int64_t) 0;
    bool nonzzero_41710 = !zzero_41709;
    bool nonzzero_cert_41711;
    
    if (!nonzzero_41710) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:222:20-27\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #4  ftbasics.fut:122:93-96\n   #5  ftsort.fut:16:3-46\n   #6  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t n_blocks_41712 = sdiv64(n_24884, i16_res_41708);
    int64_t rest_41713 = smod64(n_24884, i16_res_41708);
    int64_t arg_41714 = mul64(i16_res_41708, n_blocks_41712);
    int64_t dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 = add64(rest_41713, arg_41714);
    bool dim_match_41716 = dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715 == n_24884;
    bool empty_or_match_cert_41717;
    
    if (!dim_match_41716) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) n_24884, "] cannot match shape of type `[", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "](i16, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:224:12-46\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #3  /prelude/functional.fut:9:44-45\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #5  ftbasics.fut:122:93-96\n   #6  ftsort.fut:16:3-46\n   #7  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47845 = (int64_t) 2 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    int64_t bytes_47847 = (int64_t) 8 * dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool loop_nonempty_41721 = slt32(0, iters_41707);
    int64_t dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722 = add64((int64_t) 1, n_blocks_41712);
    int64_t dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723 = mul64((int64_t) 4, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722);
    bool empty_slice_41724 = arg_41714 == (int64_t) 0;
    int64_t m_41725 = sub64(arg_41714, (int64_t) 1);
    bool zzero_leq_i_p_m_t_s_41726 = sle64((int64_t) 0, m_41725);
    bool i_p_m_t_s_leq_w_41727 = slt64(m_41725, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41728 = sle64((int64_t) 0, arg_41714);
    bool y_41729 = zzero_leq_i_p_m_t_s_41726 && i_p_m_t_s_leq_w_41727;
    bool forwards_ok_41730 = i_lte_j_41728 && y_41729;
    bool ok_or_empty_41731 = empty_slice_41724 || forwards_ok_41730;
    bool loop_not_taken_41732 = !loop_nonempty_41721;
    bool protect_assert_disj_41733 = ok_or_empty_41731 || loop_not_taken_41732;
    bool index_certs_41734;
    
    if (!protect_assert_disj_41733) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) arg_41714, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:4-11\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:16:3-46\n   #8  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_slice_41735 = rest_41713 == (int64_t) 0;
    int64_t m_41736 = sub64(rest_41713, (int64_t) 1);
    int64_t i_p_m_t_s_41737 = add64(arg_41714, m_41736);
    bool zzero_leq_i_p_m_t_s_41738 = sle64((int64_t) 0, i_p_m_t_s_41737);
    bool i_p_m_t_s_leq_w_41739 = slt64(i_p_m_t_s_41737, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool i_lte_j_41740 = sle64(arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715);
    bool y_41741 = zzero_leq_i_p_m_t_s_41738 && i_p_m_t_s_leq_w_41739;
    bool forwards_ok_41742 = i_lte_j_41740 && y_41741;
    bool ok_or_empty_41743 = empty_slice_41735 || forwards_ok_41742;
    bool protect_assert_disj_41744 = loop_not_taken_41732 || ok_or_empty_41743;
    bool index_certs_41745;
    
    if (!protect_assert_disj_41744) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) arg_41714, ":", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "].", "-> #0  /prelude/array.fut:65:13-24\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-164:32\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:16:3-46\n   #8  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool binop_x_41746 = sle64((int64_t) 0, n_blocks_41712);
    bool binop_y_41747 = sle64((int64_t) 0, i16_res_41708);
    bool binop_y_41748 = binop_x_41746 && binop_y_41747;
    bool protect_assert_disj_41749 = loop_not_taken_41732 || binop_y_41748;
    bool dim_ok_cert_41750;
    
    if (!protect_assert_disj_41749) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Cannot unflatten array of shape [", (long long) arg_41714, "] to array of shape [", (long long) n_blocks_41712, "][", (long long) i16_res_41708, "]", "-> #0  /prelude/array.fut:184:3-30\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:163:34-168:21\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #4  /prelude/functional.fut:9:44-45\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #6  ftbasics.fut:122:93-96\n   #7  ftsort.fut:16:3-46\n   #8  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_41751 = sub64(i16_res_41708, (int64_t) 1);
    bool x_41752 = sle64((int64_t) 0, tmp_41751);
    bool y_41753 = slt64(tmp_41751, i16_res_41708);
    bool bounds_check_41754 = x_41752 && y_41753;
    bool protect_assert_disj_41755 = zzero_41709 || bounds_check_41754;
    bool protect_assert_disj_41756 = loop_not_taken_41732 || protect_assert_disj_41755;
    bool index_certs_41757;
    
    if (!protect_assert_disj_41756) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_41751, "] out of bounds for array of shape [", (long long) i16_res_41708, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  /prelude/functional.fut:9:44-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:16:3-46\n   #9  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_41759 = slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723);
    bool protect_assert_disj_41760 = loop_not_taken_41732 || y_41759;
    bool index_certs_41761;
    
    if (!protect_assert_disj_41760) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, "].", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:122:3-123:7\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:178:8-20\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:16:3-46\n   #9  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_41763 = nonzzero_41710 || loop_not_taken_41732;
    bool nonzzero_cert_41764;
    
    if (!protect_assert_disj_41763) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:186:27-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:183:7-191:15\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #6  /prelude/functional.fut:9:44-45\n   #7  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #8  ftbasics.fut:122:93-96\n   #9  ftsort.fut:16:3-46\n   #10 ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_41765 = sle64((int64_t) 0, m_41736);
    bool y_41766 = slt64(m_41736, rest_41713);
    bool bounds_check_41767 = x_41765 && y_41766;
    bool protect_assert_disj_41768 = empty_slice_41735 || bounds_check_41767;
    bool protect_assert_disj_41769 = loop_not_taken_41732 || protect_assert_disj_41768;
    bool index_certs_41770;
    
    if (!protect_assert_disj_41769) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_41736, "] out of bounds for array of shape [", (long long) rest_41713, "].", "-> #0  /prelude/array.fut:28:29-37\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:149:53-65\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:166:41-45\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:227:48-50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:16:3-46\n   #9  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_47856 = (int64_t) 2 * rest_41713;
    int64_t bytes_47875 = (int64_t) 8 * rest_41713;
    int64_t binop_x_47880 = (int64_t) 2 * n_blocks_41712;
    int64_t bytes_47881 = i16_res_41708 * binop_x_47880;
    int64_t binop_x_47883 = (int64_t) 8 * n_blocks_41712;
    int64_t bytes_47884 = i16_res_41708 * binop_x_47883;
    int64_t bytes_47991 = (int64_t) 32 * dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722;
    bool dim_match_42002 = n_24884 == dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715;
    bool empty_or_match_cert_42003;
    
    if (!dim_match_42002) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, "] cannot match shape of type `[", (long long) n_24884, "](i16, i64)`.", "-> #0  /prelude/array.fut:58:47-57\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:225:6-11\n   #2  /prelude/functional.fut:26:41-42\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:226:6-227:50\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:248:49-51\n   #5  /prelude/functional.fut:9:44-45\n   #6  lib/github.com/diku-dk/sorts/radix_sort.fut:258:49-51\n   #7  ftbasics.fut:122:93-96\n   #8  ftsort.fut:16:3-46\n   #9  ftsort.fut:15:1-16:46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_48004 = (int64_t) 8 * n_24884;
    int64_t bytes_48006 = (int64_t) 2 * n_24884;
    
    if (memblock_alloc_device(ctx, &mem_47846, bytes_47845, "mem_47846")) {
        err = 1;
        goto cleanup;
    }
    if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, xs_mem_47844.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715})) != 0)
        goto cleanup;
    if (memblock_alloc_device(ctx, &mem_47848, bytes_47847, "mem_47848")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhiota_i64(ctx, mem_47848, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, (int64_t) 0, (int64_t) 1) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segscan_tblock_sizze_44430;
    
    segscan_tblock_sizze_44430 = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44429;
    
    int64_t num_tblocks_44432;
    int64_t max_num_tblocks_48122;
    
    max_num_tblocks_48122 = *ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44431;
    num_tblocks_44432 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segscan_tblock_sizze_44430), max_num_tblocks_48122)));
    
    int64_t segmap_tblock_sizze_44440;
    
    segmap_tblock_sizze_44440 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44439;
    
    int64_t num_tblocks_44442;
    int64_t max_num_tblocks_48123;
    
    max_num_tblocks_48123 = *ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44441;
    num_tblocks_44442 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(rest_41713, segmap_tblock_sizze_44440), max_num_tblocks_48123)));
    
    int64_t segmap_tblock_sizze_44455;
    
    segmap_tblock_sizze_44455 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44447;
    
    int64_t segmap_usable_groups_44456 = sdiv_up_safe64((int64_t) 4, segmap_tblock_sizze_44455);
    int64_t intra_avail_par_44475 = smin64((int64_t) 4, i16_res_41708);
    int64_t computed_tblock_sizze_44464 = smax64((int64_t) 4, i16_res_41708);
    int64_t max_tblock_sizze_44483;
    
    max_tblock_sizze_44483 = ctx->max_thread_block_size;
    
    bool fits_44484 = sle64(computed_tblock_sizze_44464, max_tblock_sizze_44483);
    bool suff_intra_par_44482;
    
    suff_intra_par_44482 = *ctx->tuning_params.sortColumn_shortzisuff_intra_par_0 <= intra_avail_par_44475;
    if (ctx->logging)
        fprintf(ctx->log, "Compared %s <= %ld: %s.\n", "sortColumn_short.suff_intra_par_0", (long) intra_avail_par_44475, suff_intra_par_44482 ? "true" : "false");
    
    bool intra_suff_and_fits_44485 = suff_intra_par_44482 && fits_44484;
    int64_t segscan_tblock_sizze_44720;
    
    segscan_tblock_sizze_44720 = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44681;
    
    int64_t num_tblocks_44721;
    int64_t max_num_tblocks_48124;
    
    max_num_tblocks_48124 = *ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44683;
    num_tblocks_44721 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segscan_tblock_sizze_44720), max_num_tblocks_48124)));
    
    int64_t segmap_tblock_sizze_44759;
    
    segmap_tblock_sizze_44759 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44661;
    
    int64_t segmap_tblock_sizze_44781;
    
    segmap_tblock_sizze_44781 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44639;
    
    int64_t num_tblocks_44782;
    int64_t max_num_tblocks_48125;
    
    max_num_tblocks_48125 = *ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44641;
    num_tblocks_44782 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(arg_41714, segmap_tblock_sizze_44781), max_num_tblocks_48125)));
    
    int64_t segmap_tblock_sizze_44801;
    
    segmap_tblock_sizze_44801 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44617;
    
    int64_t num_tblocks_44802;
    int64_t max_num_tblocks_48126;
    
    max_num_tblocks_48126 = *ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44619;
    num_tblocks_44802 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_44801), max_num_tblocks_48126)));
    
    int64_t nest_sizze_44817 = (int64_t) 4 * n_blocks_41712;
    int64_t segmap_tblock_sizze_44818;
    
    segmap_tblock_sizze_44818 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44595;
    
    int64_t segmap_tblock_sizze_44828;
    
    segmap_tblock_sizze_44828 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44568;
    
    int64_t num_tblocks_44829;
    int64_t max_num_tblocks_48127;
    
    max_num_tblocks_48127 = *ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44570;
    num_tblocks_44829 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_44828), max_num_tblocks_48127)));
    
    int64_t segscan_tblock_sizze_44846;
    
    segscan_tblock_sizze_44846 = *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44845;
    
    int64_t num_tblocks_44848;
    int64_t max_num_tblocks_48128;
    
    max_num_tblocks_48128 = *ctx->tuning_params.sortColumn_shortzisegscan_num_tblocks_44847;
    num_tblocks_44848 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_44846), max_num_tblocks_48128)));
    
    int64_t segmap_tblock_sizze_44865;
    
    segmap_tblock_sizze_44865 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44855;
    
    int64_t segmap_usable_groups_44866 = sdiv_up_safe64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_44865);
    int64_t segmap_tblock_sizze_44878;
    
    segmap_tblock_sizze_44878 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44877;
    
    int64_t num_tblocks_44880;
    int64_t max_num_tblocks_48129;
    
    max_num_tblocks_48129 = *ctx->tuning_params.sortColumn_shortzisegmap_num_tblocks_44879;
    num_tblocks_44880 = sext_i64_i32(smax64((int64_t) 1, smin64(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_44878), max_num_tblocks_48129)));
    
    int64_t segmap_usable_groups_44760 = sdiv_up_safe64(n_blocks_41712, segmap_tblock_sizze_44759);
    int64_t segmap_usable_groups_44819 = sdiv_up_safe64(nest_sizze_44817, segmap_tblock_sizze_44818);
    int64_t ext_47979;
    int64_t shared_memory_capacity_48130;
    
    shared_memory_capacity_48130 = ctx->max_shared_memory;
    if (intra_suff_and_fits_44485) {
        ext_47979 = (int64_t) 4;
    } else {
        ext_47979 = (int64_t) 1;
    }
    
    int64_t ext_47978;
    int64_t shared_memory_capacity_48131;
    
    shared_memory_capacity_48131 = ctx->max_shared_memory;
    if (intra_suff_and_fits_44485) {
        ext_47978 = (int64_t) 1;
    } else {
        ext_47978 = n_blocks_41712;
    }
    
    int64_t binop_y_47918 = n_blocks_41712 - (int64_t) 1;
    int64_t binop_x_47920 = smax64((int64_t) 0, binop_y_47918);
    int64_t binop_y_47922 = (int64_t) 3 * n_blocks_41712;
    int64_t binop_y_47923 = smax64((int64_t) 0, binop_y_47922);
    int64_t binop_y_47924 = binop_x_47920 + binop_y_47923;
    int64_t binop_y_47925 = (int64_t) 1 + binop_y_47924;
    int64_t bytes_47926 = (int64_t) 2 * binop_y_47925;
    int64_t bytes_47930 = (int64_t) 32 * n_blocks_41712;
    int64_t bytes_47949 = (int64_t) 2 * i16_res_41708;
    int64_t bytes_47951 = (int64_t) 8 * i16_res_41708;
    
    if (memblock_alloc_device(ctx, &mem_47857, bytes_47856, "mem_47857")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47859, bytes_47856, "mem_47859")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47861, bytes_47856, "mem_47861")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47863, bytes_47856, "mem_47863")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47865, bytes_47856, "mem_47865")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47876, bytes_47875, "mem_47876")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47878, bytes_47856, "mem_47878")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47882, bytes_47881, "mem_47882")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47885, bytes_47884, "mem_47885")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47984, (int64_t) 8, "mem_47984")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47985, (int64_t) 8, "mem_47985")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47986, (int64_t) 8, "mem_47986")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47987, (int64_t) 8, "mem_47987")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47989, (int64_t) 32, "mem_47989")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47992, bytes_47991, "mem_47992")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_47995, bytes_47991, "mem_47995")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t maxSubHelper_48094 = umax64((int64_t) 8, bytes_47949);
    
    for (int32_t i_41773 = 0; i_41773 < iters_41707; i_41773++) {
        int32_t blocked_radix_sort_step_arg1_41776 = mul32(2, i_41773);
        int32_t get_bit_arg0_41781 = add32(1, blocked_radix_sort_step_arg1_41776);
        bool cond_41782 = get_bit_arg0_41781 == 15;
        bool cond_41783 = blocked_radix_sort_step_arg1_41776 == 15;
        
        if (slt64((int64_t) 0, rest_41713)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48134;
            
            shared_memory_48134 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48135;
            
            thread_block_sizze_48135 = ctx->max_thread_block_size;
            
            int64_t registers_48136;
            
            registers_48136 = ctx->max_registers;
            
            int64_t thread_block_sizze_48137;
            
            thread_block_sizze_48137 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48138 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48134, thread_block_sizze_48135), (int64_t) 2), squot64(squot64(registers_48136, thread_block_sizze_48137) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
            int64_t num_virt_blocks_48139 = sdiv_up64(rest_41713, segscan_tblock_sizze_44430 * chunk_sizze_48138);
            int64_t num_virt_threads_48140 = num_virt_blocks_48139 * segscan_tblock_sizze_44430;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48138, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48141, num_virt_blocks_48139, "status_flags_mem_48141")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48141, num_virt_blocks_48139, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48163, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48163")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48165, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48165")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48167, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48167")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48169, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48169")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48171, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48171")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48173, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48173")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48175, (int64_t) 2 * num_virt_blocks_48139, "aggregates_mem_48175")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48177, (int64_t) 2 * num_virt_blocks_48139, "incprefixes_mem_48177")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_shortzisegscan_44435(ctx, num_tblocks_44432, 1, 1, *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44429, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44430), smax64(smax64(smax64(chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2, chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2), chunk_sizze_48138 * segscan_tblock_sizze_44430 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), rest_41713, arg_41714, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_44432, num_virt_blocks_48139, num_virt_threads_48140, mem_47846.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, status_flags_mem_48141.mem, aggregates_mem_48163.mem, incprefixes_mem_48165.mem, aggregates_mem_48167.mem, incprefixes_mem_48169.mem, aggregates_mem_48171.mem, incprefixes_mem_48173.mem, aggregates_mem_48175.mem, incprefixes_mem_48177.mem, global_dynid_mem_48179.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (empty_slice_41735) {
            if (memblock_alloc_device(ctx, &mem_47870, (int64_t) 2, "mem_47870")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i16(ctx, mem_47870, (int64_t) 1, (int16_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47870, "mem_47870") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47870, "mem_47870") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47866, (int64_t) 2, "mem_47866")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47867, (int64_t) 2, "mem_47867")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47868, (int64_t) 2, "mem_47868")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47869, (int64_t) 2, "mem_47869")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_shortzigpuseq_48446(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, m_41736, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47866.mem, mem_47867.mem, mem_47868.mem, mem_47869.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (memblock_set_device(ctx, &ext_mem_47874, &mem_47866, "mem_47866") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47873, &mem_47867, "mem_47867") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47872, &mem_47868, "mem_47868") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47871, &mem_47869, "mem_47869") != 0)
                return 1;
        }
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 1, mem_47876.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47848.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 1, mem_47878.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, mem_47846.mem, (int64_t) 0 + (int64_t) 1 * arg_41714, (int64_t []) {(int64_t) 1}, (int64_t []) {rest_41713})) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48452 = sext_i64_i32(sdiv_up64(rest_41713, segmap_tblock_sizze_44440));
        
        {
            err = gpu_kernel_sortColumn_shortzisegmap_44437(ctx, num_tblocks_44442, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44439, 1, 1, (int64_t) 0, rest_41713, arg_41714, num_tblocks_44442, virt_num_tblocks_48452, mem_47846.mem, mem_47848.mem, mem_47857.mem, mem_47859.mem, mem_47861.mem, mem_47863.mem, mem_47865.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47876.mem, mem_47878.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if ((err = lmad_copy_gpu2gpu_2b(ctx, 2, mem_47882.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47846.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        if ((err = lmad_copy_gpu2gpu_8b(ctx, 2, mem_47885.mem, (int64_t) 0, (int64_t []) {i16_res_41708, (int64_t) 1}, mem_47848.mem, (int64_t) 0, (int64_t []) {(int64_t) 1 * i16_res_41708, (int64_t) 1}, (int64_t []) {n_blocks_41712, i16_res_41708})) != 0)
            goto cleanup;
        
        int64_t shared_memory_capacity_48853;
        
        shared_memory_capacity_48853 = ctx->max_shared_memory;
        if (intra_suff_and_fits_44485 && sle64(sdiv_up64(maxSubHelper_48094, (int64_t) 8) * (int64_t) 8 + (int64_t) 32 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47951, (int64_t) 8) * (int64_t) 8 + sdiv_up64(bytes_47949, (int64_t) 8) * (int64_t) 8, shared_memory_capacity_48853)) {
            if (memblock_alloc_device(ctx, &mem_47968, bytes_47881, "mem_47968")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47971, bytes_47884, "mem_47971")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47974, bytes_47930, "mem_47974")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47977, binop_x_47883, "mem_47977")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t num_chunks_48465 = sext_i64_i32(sdiv_up64((int64_t) 4, computed_tblock_sizze_44464));
            int32_t num_chunks_48466 = sext_i64_i32(sdiv_up64(i16_res_41708, computed_tblock_sizze_44464));
            int32_t virt_num_tblocks_48467 = sext_i64_i32(n_blocks_41712);
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_intrablock_44491(ctx, n_blocks_41712, 1, 1, computed_tblock_sizze_44464, 1, 1, bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8) + (bytes_47951 + srem64((int64_t) 8 - srem64(bytes_47951, (int64_t) 8), (int64_t) 8)) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (bytes_47949 + srem64((int64_t) 8 - srem64(bytes_47949, (int64_t) 8), (int64_t) 8)) + (int64_t) 32 + (maxSubHelper_48094 + srem64((int64_t) 8 - srem64(maxSubHelper_48094, (int64_t) 8), (int64_t) 8)), i16_res_41708, zzero_41709, n_blocks_41712, tmp_41751, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, computed_tblock_sizze_44464, bytes_47949, bytes_47951, maxSubHelper_48094, mem_47846.mem, mem_47848.mem, mem_47968.mem, mem_47971.mem, mem_47974.mem, mem_47977.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47968, "mem_47968") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47971, "mem_47971") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47974, "mem_47974") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47977, "mem_47977") != 0)
                return 1;
        } else {
            if (memblock_alloc_device(ctx, &mem_47889, bytes_47881, "mem_47889")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47892, bytes_47881, "mem_47892")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47895, bytes_47881, "mem_47895")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47898, bytes_47881, "mem_47898")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47901, bytes_47881, "mem_47901")) {
                err = 1;
                goto cleanup;
            }
            if (slt64((int64_t) 0, n_blocks_41712 * i16_res_41708)) {
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "\n# SegScan");
                
                int64_t shared_memory_48525;
                
                shared_memory_48525 = ctx->max_shared_memory;
                
                int64_t thread_block_sizze_48526;
                
                thread_block_sizze_48526 = ctx->max_thread_block_size;
                
                int64_t registers_48527;
                
                registers_48527 = ctx->max_registers;
                
                int64_t thread_block_sizze_48528;
                
                thread_block_sizze_48528 = ctx->max_thread_block_size;
                
                int64_t chunk_sizze_48529 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48525, thread_block_sizze_48526), (int64_t) 2), squot64(squot64(registers_48527, thread_block_sizze_48528) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2) + smax64((int64_t) 4, (int64_t) 2), (int64_t) 4))));
                int64_t num_virt_blocks_48530 = sdiv_up64(n_blocks_41712 * i16_res_41708, segscan_tblock_sizze_44720 * chunk_sizze_48529);
                int64_t num_virt_threads_48531 = num_virt_blocks_48530 * segscan_tblock_sizze_44720;
                
                if (ctx->debugging)
                    fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48529, '\n');
                if (memblock_alloc_device(ctx, &status_flags_mem_48532, num_virt_blocks_48530, "status_flags_mem_48532")) {
                    err = 1;
                    goto cleanup;
                }
                if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48532, num_virt_blocks_48530, (int8_t) 0) != 0) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48534, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48534")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48536, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48536")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48538, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48538")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48540, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48540")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48542, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48542")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48544, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48544")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &aggregates_mem_48546, (int64_t) 2 * num_virt_blocks_48530, "aggregates_mem_48546")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc_device(ctx, &incprefixes_mem_48548, (int64_t) 2 * num_virt_blocks_48530, "incprefixes_mem_48548")) {
                    err = 1;
                    goto cleanup;
                }
                {
                    err = gpu_kernel_sortColumn_shortzisegscan_44730(ctx, num_tblocks_44721, 1, 1, *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44681, 1, 1, smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2)) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720, (int64_t) 2) * (int64_t) 2 + (int64_t) 2 * segscan_tblock_sizze_44720), smax64(smax64(smax64(chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2, chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2), chunk_sizze_48529 * segscan_tblock_sizze_44720 * (int64_t) 2)), (int64_t) 8), (int64_t) 8), i16_res_41708, n_blocks_41712, blocked_radix_sort_step_arg1_41776, get_bit_arg0_41781, cond_41782, cond_41783, num_tblocks_44721, num_virt_blocks_48530, num_virt_threads_48531, mem_47846.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, status_flags_mem_48532.mem, aggregates_mem_48534.mem, incprefixes_mem_48536.mem, aggregates_mem_48538.mem, incprefixes_mem_48540.mem, aggregates_mem_48542.mem, incprefixes_mem_48544.mem, aggregates_mem_48546.mem, incprefixes_mem_48548.mem, global_dynid_mem_48550.mem);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                ctx->failure_is_an_option = 1;
                if (ctx->debugging)
                    fprintf(ctx->log, "%s\n", "");
            }
            if (memblock_alloc_device(ctx, &mem_47904, binop_x_47880, "mem_47904")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47906, binop_x_47880, "mem_47906")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47908, binop_x_47880, "mem_47908")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &mem_47910, binop_x_47880, "mem_47910")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48792 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_44759));
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_44766(ctx, segmap_usable_groups_44760, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44661, 1, 1, (int64_t) 0, i16_res_41708, zzero_41709, nonzzero_41710, n_blocks_41712, tmp_41751, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48801 = sext_i64_i32(sdiv_up64(n_blocks_41712 * i16_res_41708, segmap_tblock_sizze_44781));
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_44788(ctx, num_tblocks_44782, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44639, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, num_tblocks_44782, virt_num_tblocks_48801, mem_47846.mem, mem_47848.mem, mem_47882.mem, mem_47885.mem, mem_47889.mem, mem_47892.mem, mem_47895.mem, mem_47898.mem, mem_47901.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            ctx->failure_is_an_option = 1;
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47927, bytes_47926, "mem_47927")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48816 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_44801));
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_44806(ctx, num_tblocks_44802, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44617, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_44802, virt_num_tblocks_48816, mem_47904.mem, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47927.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47931, bytes_47930, "mem_47931")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48829 = sext_i64_i32(sdiv_up64(n_blocks_41712 * (int64_t) 4, segmap_tblock_sizze_44818));
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_44823(ctx, segmap_usable_groups_44819, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44595, 1, 1, (int64_t) 0, n_blocks_41712, mem_47927.mem, mem_47931.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
                return 1;
            if (memblock_alloc_device(ctx, &mem_47947, bytes_47926, "mem_47947")) {
                err = 1;
                goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegMap");
            
            int32_t virt_num_tblocks_48840 = sext_i64_i32(sdiv_up64(n_blocks_41712, segmap_tblock_sizze_44828));
            
            {
                err = gpu_kernel_sortColumn_shortzisegmap_44833(ctx, num_tblocks_44829, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44568, 1, 1, (int64_t) 0, n_blocks_41712, num_tblocks_44829, virt_num_tblocks_48840, mem_47906.mem, mem_47908.mem, mem_47910.mem, mem_47947.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
            if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47983, &mem_47882, "mem_47882") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47982, &mem_47885, "mem_47885") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47981, &mem_47931, "mem_47931") != 0)
                return 1;
            if (memblock_set_device(ctx, &ext_mem_47980, &mem_47947, "mem_47947") != 0)
                return 1;
        }
        {
            err = gpu_kernel_sortColumn_shortzigpuseq_48854(ctx, (int64_t) 1, 1, 1, (int64_t) 1, 1, 1, (int64_t) 0, ext_mem_47871.mem, ext_mem_47872.mem, ext_mem_47873.mem, ext_mem_47874.mem, mem_47984.mem, mem_47985.mem, mem_47986.mem, mem_47987.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48860 = sext_i64_i32(sdiv_up64((int64_t) 4, segmap_tblock_sizze_44455));
        
        {
            err = gpu_kernel_sortColumn_shortzisegmap_44459(ctx, segmap_usable_groups_44456, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44447, 1, 1, (int64_t) 0, mem_47986.mem, mem_47989.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (slt64((int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723)) {
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "\n# SegScan");
            
            int64_t shared_memory_48869;
            
            shared_memory_48869 = ctx->max_shared_memory;
            
            int64_t thread_block_sizze_48870;
            
            thread_block_sizze_48870 = ctx->max_thread_block_size;
            
            int64_t registers_48871;
            
            registers_48871 = ctx->max_registers;
            
            int64_t thread_block_sizze_48872;
            
            thread_block_sizze_48872 = ctx->max_thread_block_size;
            
            int64_t chunk_sizze_48873 = smax64((int64_t) 1, smin64(squot64(squot64(shared_memory_48869, thread_block_sizze_48870), (int64_t) 8), squot64(squot64(registers_48871, thread_block_sizze_48872) - (int64_t) 1 - squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4), (int64_t) 2 * squot64(smax64((int64_t) 4, (int64_t) 8), (int64_t) 4))));
            int64_t num_virt_blocks_48874 = sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segscan_tblock_sizze_44846 * chunk_sizze_48873);
            int64_t num_virt_threads_48875 = num_virt_blocks_48874 * segscan_tblock_sizze_44846;
            
            if (ctx->debugging)
                fprintf(ctx->log, "%s: %llu%c", "Sequential elements per thread (chunk)", (long long) chunk_sizze_48873, '\n');
            if (memblock_alloc_device(ctx, &status_flags_mem_48876, num_virt_blocks_48874, "status_flags_mem_48876")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_48876, num_virt_blocks_48874, (int8_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &aggregates_mem_48878, (int64_t) 8 * num_virt_blocks_48874, "aggregates_mem_48878")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc_device(ctx, &incprefixes_mem_48880, (int64_t) 8 * num_virt_blocks_48874, "incprefixes_mem_48880")) {
                err = 1;
                goto cleanup;
            }
            {
                err = gpu_kernel_sortColumn_shortzisegscan_44851(ctx, num_tblocks_44848, 1, 1, *ctx->tuning_params.sortColumn_shortzisegscan_tblock_sizze_44845, 1, 1, smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_44846), chunk_sizze_48873 * segscan_tblock_sizze_44846 * (int64_t) 8) + srem64((int64_t) 8 - srem64(smax64(smax64((int64_t) 288, (int64_t) 8 * segscan_tblock_sizze_44846), chunk_sizze_48873 * segscan_tblock_sizze_44846 * (int64_t) 8), (int64_t) 8), (int64_t) 8), n_blocks_41712, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, num_tblocks_44848, num_virt_blocks_48874, num_virt_threads_48875, ext_mem_47981.mem, mem_47989.mem, mem_47992.mem, status_flags_mem_48876.mem, aggregates_mem_48878.mem, incprefixes_mem_48880.mem, global_dynid_mem_48882.mem);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (ctx->debugging)
                fprintf(ctx->log, "%s\n", "");
        }
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48971 = sext_i64_i32(sdiv_up64(dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, segmap_tblock_sizze_44865));
        
        {
            err = gpu_kernel_sortColumn_shortzisegmap_44869(ctx, segmap_usable_groups_44866, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44855, 1, 1, (int64_t) 0, dzlz7bUZLztZRz20U4z20UZLZLzpZRz20Unz20U1ZRz7dUzg_41723, mem_47992.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        
        int64_t write_tmp_49037 = (int64_t) 0;
        
        if ((err = gpu_scalar_to_device(ctx, mem_47995.mem, (int64_t) 0 * sizeof(int64_t), sizeof(int64_t), &write_tmp_49037)) != 0)
            goto cleanup;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "\n# SegMap");
        
        int32_t virt_num_tblocks_48980 = sext_i64_i32(sdiv_up64(dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, segmap_tblock_sizze_44878));
        
        {
            err = gpu_kernel_sortColumn_shortzisegmap_44875(ctx, num_tblocks_44880, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44877, 1, 1, (int64_t) 0, i16_res_41708, n_blocks_41712, arg_41714, dzlz7bUZLzpZRz20UZLZLztZRz20Un_blocksz20UblockZRz20Urestz7dUzg_41715, dzlz7bUZLzpZRz20Unz20U1z7dUzg_41722, blocked_radix_sort_step_arg1_41776, num_tblocks_44880, ext_47978, ext_47979, virt_num_tblocks_48980, mem_47846.mem, mem_47848.mem, mem_47876.mem, mem_47878.mem, ext_mem_47980.mem, ext_mem_47982.mem, ext_mem_47983.mem, mem_47987.mem, mem_47995.mem);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        ctx->failure_is_an_option = 1;
        if (ctx->debugging)
            fprintf(ctx->log, "%s\n", "");
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
        return 1;
    
    int64_t segmap_tblock_sizze_44898;
    
    segmap_tblock_sizze_44898 = *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44885;
    
    int64_t segmap_usable_groups_44899 = sdiv_up64(n_24884, segmap_tblock_sizze_44898);
    
    if (memblock_alloc_device(ctx, &mem_48005, bytes_48004, "mem_48005")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc_device(ctx, &mem_48007, bytes_48006, "mem_48007")) {
        err = 1;
        goto cleanup;
    }
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "\n# SegMap");
    
    int32_t virt_num_tblocks_48994 = sext_i64_i32(sdiv_up64(n_24884, segmap_tblock_sizze_44898));
    
    {
        err = gpu_kernel_sortColumn_shortzisegmap_44903(ctx, segmap_usable_groups_44899, 1, 1, *ctx->tuning_params.sortColumn_shortzisegmap_tblock_sizze_44885, 1, 1, (int64_t) 0, n_24884, incr_24885, xs_mem_47844.mem, mem_47848.mem, mem_48005.mem, mem_48007.mem);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    ctx->failure_is_an_option = 1;
    if (ctx->debugging)
        fprintf(ctx->log, "%s\n", "");
    if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48103, &mem_48005, "mem_48005") != 0)
        return 1;
    if (memblock_set_device(ctx, &mem_out_48104, &mem_48007, "mem_48007") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49035, &mem_out_48103, "mem_out_48103") != 0)
        return 1;
    if (memblock_set_device(ctx, &*mem_out_p_49036, &mem_out_48104, "mem_out_48104") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref_device(ctx, &mem_48007, "mem_48007") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_48005, "mem_48005") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48880, "incprefixes_mem_48880") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48878, "aggregates_mem_48878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48876, "status_flags_mem_48876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47947, "mem_47947") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47931, "mem_47931") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47927, "mem_47927") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47910, "mem_47910") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47908, "mem_47908") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47906, "mem_47906") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47904, "mem_47904") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48548, "incprefixes_mem_48548") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48546, "aggregates_mem_48546") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48544, "incprefixes_mem_48544") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48542, "aggregates_mem_48542") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48540, "incprefixes_mem_48540") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48538, "aggregates_mem_48538") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48536, "incprefixes_mem_48536") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48534, "aggregates_mem_48534") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48532, "status_flags_mem_48532") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47901, "mem_47901") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47898, "mem_47898") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47895, "mem_47895") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47892, "mem_47892") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47889, "mem_47889") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47977, "mem_47977") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47974, "mem_47974") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47971, "mem_47971") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47968, "mem_47968") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47980, "ext_mem_47980") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47981, "ext_mem_47981") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47982, "ext_mem_47982") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47983, "ext_mem_47983") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47869, "mem_47869") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47868, "mem_47868") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47867, "mem_47867") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47866, "mem_47866") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47870, "mem_47870") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47871, "ext_mem_47871") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47872, "ext_mem_47872") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47873, "ext_mem_47873") != 0)
            return 1;
        if (memblock_unref_device(ctx, &ext_mem_47874, "ext_mem_47874") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48177, "incprefixes_mem_48177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48175, "aggregates_mem_48175") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48173, "incprefixes_mem_48173") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48171, "aggregates_mem_48171") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48169, "incprefixes_mem_48169") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48167, "aggregates_mem_48167") != 0)
            return 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_48165, "incprefixes_mem_48165") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_48163, "aggregates_mem_48163") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_48141, "status_flags_mem_48141") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47995, "mem_47995") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47992, "mem_47992") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47989, "mem_47989") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47987, "mem_47987") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47986, "mem_47986") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47985, "mem_47985") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47984, "mem_47984") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47885, "mem_47885") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47882, "mem_47882") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47878, "mem_47878") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47876, "mem_47876") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47865, "mem_47865") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47863, "mem_47863") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47861, "mem_47861") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47859, "mem_47859") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47857, "mem_47857") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47848, "mem_47848") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_47846, "mem_47846") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48104, "mem_out_48104") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_out_48103, "mem_out_48103") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_49038, int32_t bit_22732, int16_t x_22733)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int32_t prim_out_48103;
    int16_t i32_res_38034 = sext_i32_i16(bit_22732);
    int16_t zgzg_res_38037 = ashr16(x_22733, i32_res_38034);
    int16_t za_res_38042 = (int16_t) 1 & zgzg_res_38037;
    int32_t to_i32_res_38044 = sext_i16_i32(za_res_38042);
    
    prim_out_48103 = to_i32_res_38044;
    *out_prim_out_49038 = prim_out_48103;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_49039, int32_t bit_27949, int64_t x_27950)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int32_t prim_out_48103;
    int64_t i32_res_38034 = sext_i32_i64(bit_27949);
    int64_t zgzg_res_38037 = ashr64(x_27950, i32_res_38034);
    int64_t za_res_38042 = (int64_t) 1 & zgzg_res_38037;
    int32_t to_i32_res_38044 = sext_i64_i32(za_res_38042);
    
    prim_out_48103 = to_i32_res_38044;
    *out_prim_out_49039 = prim_out_48103;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_f_7536(struct futhark_context *ctx, int64_t *out_prim_out_49040, int16_t na_22256, int16_t nb_22257, int16_t nc_22258, int16_t bin_22259, int16_t a_22260, int16_t b_22261, int16_t c_22262, int16_t d_22263)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int64_t prim_out_48103;
    bool bool_arg0_22264 = bin_22259 == (int16_t) 0;
    int16_t bool_res_38034 = btoi_bool_i16(bool_arg0_22264);
    int16_t zp_rhs_22268 = mul16(a_22260, bool_res_38034);
    int16_t zp_lhs_22271 = add16((int16_t) -1, zp_rhs_22268);
    bool bool_arg0_22273 = slt16((int16_t) 0, bin_22259);
    int16_t bool_res_38036 = btoi_bool_i16(bool_arg0_22273);
    int16_t zp_rhs_22277 = mul16(na_22256, bool_res_38036);
    int16_t zp_lhs_22279 = add16(zp_lhs_22271, zp_rhs_22277);
    bool bool_arg0_22281 = bin_22259 == (int16_t) 1;
    int16_t bool_res_38038 = btoi_bool_i16(bool_arg0_22281);
    int16_t zp_rhs_22285 = mul16(b_22261, bool_res_38038);
    int16_t zp_lhs_22287 = add16(zp_lhs_22279, zp_rhs_22285);
    bool bool_arg0_22289 = slt16((int16_t) 1, bin_22259);
    int16_t bool_res_38040 = btoi_bool_i16(bool_arg0_22289);
    int16_t zp_rhs_22293 = mul16(nb_22257, bool_res_38040);
    int16_t zp_lhs_22295 = add16(zp_lhs_22287, zp_rhs_22293);
    bool bool_arg0_22297 = bin_22259 == (int16_t) 2;
    int16_t bool_res_38042 = btoi_bool_i16(bool_arg0_22297);
    int16_t zp_rhs_22301 = mul16(c_22262, bool_res_38042);
    int16_t zp_lhs_22303 = add16(zp_lhs_22295, zp_rhs_22301);
    bool bool_arg0_22305 = slt16((int16_t) 2, bin_22259);
    int16_t bool_res_38044 = btoi_bool_i16(bool_arg0_22305);
    int16_t zp_rhs_22309 = mul16(nc_22258, bool_res_38044);
    int16_t zp_lhs_22311 = add16(zp_lhs_22303, zp_rhs_22309);
    bool bool_arg0_22313 = bin_22259 == (int16_t) 3;
    int16_t bool_res_38046 = btoi_bool_i16(bool_arg0_22313);
    int16_t zp_rhs_22317 = mul16(d_22263, bool_res_38046);
    int16_t i16_arg0_22319 = add16(zp_lhs_22311, zp_rhs_22317);
    int64_t i16_res_38048 = sext_i16_i64(i16_arg0_22319);
    
    prim_out_48103 = i16_res_38048;
    *out_prim_out_49040 = prim_out_48103;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_7535(struct futhark_context *ctx, int16_t *out_prim_out_49041, int16_t *out_prim_out_49042, int16_t *out_prim_out_49043, int16_t *out_prim_out_49044, int16_t x_22199)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
    struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
    struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
    struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
    int16_t prim_out_48103;
    int16_t prim_out_48104;
    int16_t prim_out_48105;
    int16_t prim_out_48106;
    bool bool_arg0_22200 = x_22199 == (int16_t) 0;
    int16_t bool_res_38034 = btoi_bool_i16(bool_arg0_22200);
    bool bool_arg0_22204 = x_22199 == (int16_t) 1;
    int16_t bool_res_38036 = btoi_bool_i16(bool_arg0_22204);
    bool bool_arg0_22208 = x_22199 == (int16_t) 2;
    int16_t bool_res_38038 = btoi_bool_i16(bool_arg0_22208);
    bool bool_arg0_22212 = x_22199 == (int16_t) 3;
    int16_t bool_res_38040 = btoi_bool_i16(bool_arg0_22212);
    
    prim_out_48103 = bool_res_38034;
    prim_out_48104 = bool_res_38036;
    prim_out_48105 = bool_res_38038;
    prim_out_48106 = bool_res_38040;
    *out_prim_out_49041 = prim_out_48103;
    *out_prim_out_49042 = prim_out_48104;
    *out_prim_out_49043 = prim_out_48105;
    *out_prim_out_49044 = prim_out_48106;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0)
{
    int64_t n_37213 = (int64_t) 0;
    int64_t prim_out_48103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device ks_mem_47844;
    
    ks_mem_47844.references = NULL;
    ks_mem_47844 = in0->mem;
    n_37213 = in0->shape[0];
    if (!(n_37213 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_double(ctx, &prim_out_48103, ks_mem_47844, n_37213);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            *out0 = prim_out_48103;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0)
{
    int64_t n_37044 = (int64_t) 0;
    int64_t prim_out_48103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device ks_mem_47844;
    
    ks_mem_47844.references = NULL;
    ks_mem_47844 = in0->mem;
    n_37044 = in0->shape[0];
    if (!(n_37044 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_float(ctx, &prim_out_48103, ks_mem_47844, n_37044);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            *out0 = prim_out_48103;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t n_36709 = (int64_t) 0;
    int64_t prim_out_48103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device ks_mem_47844;
    
    ks_mem_47844.references = NULL;
    ks_mem_47844 = in0->mem;
    n_36709 = in0->shape[0];
    if (!(n_36709 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_int(ctx, &prim_out_48103, ks_mem_47844, n_36709);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            *out0 = prim_out_48103;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t n_36875 = (int64_t) 0;
    int64_t prim_out_48103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device ks_mem_47844;
    
    ks_mem_47844.references = NULL;
    ks_mem_47844 = in0->mem;
    n_36875 = in0->shape[0];
    if (!(n_36875 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_long(ctx, &prim_out_48103, ks_mem_47844, n_36875);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            *out0 = prim_out_48103;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t n_36543 = (int64_t) 0;
    int64_t prim_out_48103 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device ks_mem_47844;
    
    ks_mem_47844.references = NULL;
    ks_mem_47844 = in0->mem;
    n_36543 = in0->shape[0];
    if (!(n_36543 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_short(ctx, &prim_out_48103, ks_mem_47844, n_36543);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            *out0 = prim_out_48103;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeFunc(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup3_i64_i32_i64 **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1)
{
    int64_t w1_37999 = (int64_t) 0;
    int64_t w2_38000 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48105;
    
    mem_out_48105.references = NULL;
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    xs_mem_47844 = in0->mem;
    w1_37999 = in0->shape[0];
    ys_mem_47845 = in1->mem;
    w2_38000 = in1->shape[0];
    if (!(w1_37999 == in0->shape[0] && w2_38000 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeFunc(ctx, &mem_out_48103, &mem_out_48104, &mem_out_48105, xs_mem_47844, ys_mem_47845, w1_37999, w2_38000);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_arr1d_tup3_i64_i32_i64 *) malloc(sizeof(struct futhark_opaque_arr1d_tup3_i64_i32_i64))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = w1_37999;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = w1_37999;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_48105;
            (*out0)->v2->shape[0] = w1_37999;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2)
{
    int64_t ni_36374 = (int64_t) 0;
    int64_t n_36375 = (int64_t) 0;
    int64_t incr_36376 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device is_mem_47844;
    
    is_mem_47844.references = NULL;
    incr_36376 = in0;
    is_mem_47844 = in1->mem;
    ni_36374 = in1->shape[0];
    ys_mem_47845 = in2->mem;
    n_36375 = in2->shape[0];
    if (!(ni_36374 == in1->shape[0] && n_36375 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_double(ctx, &mem_out_48103, is_mem_47844, ys_mem_47845, ni_36374, n_36375, incr_36376);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_48103;
            (*out0)->shape[0] = ni_36374;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2)
{
    int64_t ni_36220 = (int64_t) 0;
    int64_t n_36221 = (int64_t) 0;
    int64_t incr_36222 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device is_mem_47844;
    
    is_mem_47844.references = NULL;
    incr_36222 = in0;
    is_mem_47844 = in1->mem;
    ni_36220 = in1->shape[0];
    ys_mem_47845 = in2->mem;
    n_36221 = in2->shape[0];
    if (!(ni_36220 == in1->shape[0] && n_36221 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_float(ctx, &mem_out_48103, is_mem_47844, ys_mem_47845, ni_36220, n_36221, incr_36222);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_48103;
            (*out0)->shape[0] = ni_36220;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t ni_35915 = (int64_t) 0;
    int64_t n_35916 = (int64_t) 0;
    int64_t incr_35917 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device is_mem_47844;
    
    is_mem_47844.references = NULL;
    incr_35917 = in0;
    is_mem_47844 = in1->mem;
    ni_35915 = in1->shape[0];
    ys_mem_47845 = in2->mem;
    n_35916 = in2->shape[0];
    if (!(ni_35915 == in1->shape[0] && n_35916 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_int(ctx, &mem_out_48103, is_mem_47844, ys_mem_47845, ni_35915, n_35916, incr_35917);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_48103;
            (*out0)->shape[0] = ni_35915;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2)
{
    int64_t ni_36066 = (int64_t) 0;
    int64_t n_36067 = (int64_t) 0;
    int64_t incr_36068 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device is_mem_47844;
    
    is_mem_47844.references = NULL;
    incr_36068 = in0;
    is_mem_47844 = in1->mem;
    ni_36066 = in1->shape[0];
    ys_mem_47845 = in2->mem;
    n_36067 = in2->shape[0];
    if (!(ni_36066 == in1->shape[0] && n_36067 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_long(ctx, &mem_out_48103, is_mem_47844, ys_mem_47845, ni_36066, n_36067, incr_36068);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_48103;
            (*out0)->shape[0] = ni_36066;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2)
{
    int64_t ni_35761 = (int64_t) 0;
    int64_t n_35762 = (int64_t) 0;
    int64_t incr_35763 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device ys_mem_47845;
    
    ys_mem_47845.references = NULL;
    
    struct memblock_device is_mem_47844;
    
    is_mem_47844.references = NULL;
    incr_35763 = in0;
    is_mem_47844 = in1->mem;
    ni_35761 = in1->shape[0];
    ys_mem_47845 = in2->mem;
    n_35762 = in2->shape[0];
    if (!(ni_35761 == in1->shape[0] && n_35762 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_short(ctx, &mem_out_48103, is_mem_47844, ys_mem_47845, ni_35761, n_35762, incr_35763);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_48103;
            (*out0)->shape[0] = ni_35761;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partitionFunc(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_i64_i64 **out0, const int64_t in0, const struct futhark_i32_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t na_37612 = (int64_t) 0;
    int64_t nb_37613 = (int64_t) 0;
    int64_t threads_37614 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device bs_mem_47845;
    
    bs_mem_47845.references = NULL;
    
    struct memblock_device as_mem_47844;
    
    as_mem_47844.references = NULL;
    threads_37614 = in0;
    as_mem_47844 = in1->mem;
    na_37612 = in1->shape[0];
    bs_mem_47845 = in2->mem;
    nb_37613 = in2->shape[0];
    if (!(na_37612 == in1->shape[0] && nb_37613 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partitionFunc(ctx, &mem_out_48103, &mem_out_48104, as_mem_47844, bs_mem_47845, na_37612, nb_37613, threads_37614);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_arr1d_tup2_i64_i64 *) malloc(sizeof(struct futhark_opaque_arr1d_tup2_i64_i64))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = threads_37614;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = threads_37614;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int16_t in1, const struct futhark_f64_1d *in2)
{
    int64_t n_35607 = (int64_t) 0;
    int64_t incr_35608 = (int64_t) 0;
    int16_t block_sizze_35609 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    incr_35608 = in0;
    block_sizze_35609 = in1;
    xs_mem_47844 = in2->mem;
    n_35607 = in2->shape[0];
    if (!(n_35607 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortColumn_double(ctx, &mem_out_48103, &mem_out_48104, xs_mem_47844, n_35607, incr_35608, block_sizze_35609);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = n_35607;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = n_35607;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int16_t in1, const struct futhark_f32_1d *in2)
{
    int64_t n_32852 = (int64_t) 0;
    int64_t incr_32853 = (int64_t) 0;
    int16_t block_sizze_32854 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    incr_32853 = in0;
    block_sizze_32854 = in1;
    xs_mem_47844 = in2->mem;
    n_32852 = in2->shape[0];
    if (!(n_32852 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortColumn_float(ctx, &mem_out_48103, &mem_out_48104, xs_mem_47844, n_32852, incr_32853, block_sizze_32854);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = n_32852;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = n_32852;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int16_t in1, const struct futhark_i32_1d *in2)
{
    int64_t n_27501 = (int64_t) 0;
    int64_t incr_27502 = (int64_t) 0;
    int16_t block_sizze_27503 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    incr_27502 = in0;
    block_sizze_27503 = in1;
    xs_mem_47844 = in2->mem;
    n_27501 = in2->shape[0];
    if (!(n_27501 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortColumn_int(ctx, &mem_out_48103, &mem_out_48104, xs_mem_47844, n_27501, incr_27502, block_sizze_27503);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = n_27501;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = n_27501;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int16_t in1, const struct futhark_i64_1d *in2)
{
    int64_t n_30101 = (int64_t) 0;
    int64_t incr_30102 = (int64_t) 0;
    int16_t block_sizze_30103 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    incr_30102 = in0;
    block_sizze_30103 = in1;
    xs_mem_47844 = in2->mem;
    n_30101 = in2->shape[0];
    if (!(n_30101 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortColumn_long(ctx, &mem_out_48103, &mem_out_48104, xs_mem_47844, n_30101, incr_30102, block_sizze_30103);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = n_30101;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = n_30101;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int16_t in1, const struct futhark_i16_1d *in2)
{
    int64_t n_24884 = (int64_t) 0;
    int64_t incr_24885 = (int64_t) 0;
    int16_t block_sizze_24886 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED_FATAL(cuCtxPushCurrent(ctx->cu_ctx));
    
    struct memblock_device mem_out_48104;
    
    mem_out_48104.references = NULL;
    
    struct memblock_device mem_out_48103;
    
    mem_out_48103.references = NULL;
    
    struct memblock_device xs_mem_47844;
    
    xs_mem_47844.references = NULL;
    incr_24885 = in0;
    block_sizze_24886 = in1;
    xs_mem_47844 = in2->mem;
    n_24884 = in2->shape[0];
    if (!(n_24884 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortColumn_short(ctx, &mem_out_48103, &mem_out_48104, xs_mem_47844, n_24884, incr_24885, block_sizze_24886);
        if (ret == 0) {
            struct memblock_device counters_mem_48106 = ctx->constants->counters_mem_48106;
            struct memblock_device global_dynid_mem_48179 = ctx->constants->global_dynid_mem_48179;
            struct memblock_device global_dynid_mem_48550 = ctx->constants->global_dynid_mem_48550;
            struct memblock_device global_dynid_mem_48882 = ctx->constants->global_dynid_mem_48882;
            
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_48103;
            (*out0)->v0->shape[0] = n_24884;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_48104;
            (*out0)->v1->shape[0] = n_24884;
        }
    }
    CUDA_SUCCEED_FATAL(cuCtxPopCurrent(&ctx->cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
  
