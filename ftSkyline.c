// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_bool_1d;
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0);
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data);
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr);
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f32_2d;
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const float *data, int64_t dim0, int64_t dim1);
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
int futhark_values_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr, float *data);
int futhark_index_f32_2d(struct futhark_context *ctx, float *out, struct futhark_f32_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_f64_2d;
struct futhark_f64_2d *futhark_new_f64_2d(struct futhark_context *ctx, const double *data, int64_t dim0, int64_t dim1);
struct futhark_f64_2d *futhark_new_raw_f64_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr);
int futhark_values_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr, double *data);
int futhark_index_f64_2d(struct futhark_context *ctx, double *out, struct futhark_f64_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr);
const int64_t *futhark_shape_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);

// Opaque values
struct futhark_opaque_tup2_arr1d_f32_i64;
struct futhark_opaque_tup2_arr1d_f64_i64;
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64;
struct futhark_opaque_arr1d_tup2_arr1d_f64_i64;
struct futhark_opaque_skylineBase_double;
struct futhark_opaque_skylineBase_float;
struct futhark_opaque_skylineData_GFUR_double;
struct futhark_opaque_skylineData_GFUR_float;
struct futhark_opaque_skylineInfo_GFUR_double;
struct futhark_opaque_skylineInfo_GFUR_float;
int futhark_free_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_store_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_arr1d_f32_i64 *futhark_restore_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_project_opaque_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj);
int futhark_new_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, const struct futhark_f32_1d *f_0, const int64_t f_1);
int futhark_free_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 *obj);
int futhark_store_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_tup2_arr1d_f64_i64 *futhark_restore_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_tup2_arr1d_f64_i64_0(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj);
int futhark_project_opaque_tup2_arr1d_f64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj);
int futhark_new_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 **out, const struct futhark_f64_1d *f_0, const int64_t f_1);
int futhark_free_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_store_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj);
int futhark_zip_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_f32_2d *f_0, const struct futhark_i64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr);
int futhark_free_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj);
int futhark_store_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj, void **p, size_t *n);
struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_arr1d_tup2_arr1d_f64_i64_0(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj);
int futhark_project_opaque_arr1d_tup2_arr1d_f64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj);
int futhark_zip_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 **out, const struct futhark_f64_2d *f_0, const struct futhark_i64_1d *f_1);
int futhark_index_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *arr, int64_t i0);
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *arr);
int futhark_free_opaque_skylineBase_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double *obj);
int futhark_store_opaque_skylineBase_double(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_double *obj, void **p, size_t *n);
struct futhark_opaque_skylineBase_double *futhark_restore_opaque_skylineBase_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineBase_double_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_project_opaque_skylineBase_double_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj);
int futhark_new_opaque_skylineBase_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f64_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const struct futhark_f64_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no);
int futhark_free_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float *obj);
int futhark_store_opaque_skylineBase_float(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineBase_float *futhark_restore_opaque_skylineBase_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineBase_float_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_project_opaque_skylineBase_float_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj);
int futhark_new_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f32_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const struct futhark_f32_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no);
int futhark_free_opaque_skylineData_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double *obj);
int futhark_store_opaque_skylineData_GFUR_double(struct futhark_context *ctx, const struct futhark_opaque_skylineData_GFUR_double *obj, void **p, size_t *n);
struct futhark_opaque_skylineData_GFUR_double *futhark_restore_opaque_skylineData_GFUR_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineData_GFUR_double_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_GFUR_double *obj);
int futhark_project_opaque_skylineData_GFUR_double_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_GFUR_double *obj);
int futhark_project_opaque_skylineData_GFUR_double_skyTups(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_skylineData_GFUR_double *obj);
int futhark_new_opaque_skylineData_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double **out, const int64_t f_len, const struct futhark_i64_1d *f_pL, const struct futhark_f64_2d *f_skyTups);
int futhark_free_opaque_skylineData_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float *obj);
int futhark_store_opaque_skylineData_GFUR_float(struct futhark_context *ctx, const struct futhark_opaque_skylineData_GFUR_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineData_GFUR_float *futhark_restore_opaque_skylineData_GFUR_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineData_GFUR_float_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_GFUR_float *obj);
int futhark_project_opaque_skylineData_GFUR_float_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_GFUR_float *obj);
int futhark_project_opaque_skylineData_GFUR_float_skyTups(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineData_GFUR_float *obj);
int futhark_new_opaque_skylineData_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float **out, const int64_t f_len, const struct futhark_i64_1d *f_pL, const struct futhark_f32_2d *f_skyTups);
int futhark_free_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double *obj);
int futhark_store_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_GFUR_double *obj, void **p, size_t *n);
struct futhark_opaque_skylineInfo_GFUR_double *futhark_restore_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineInfo_GFUR_double_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj);
int futhark_project_opaque_skylineInfo_GFUR_double_part_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj);
int futhark_project_opaque_skylineInfo_GFUR_double_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj);
int futhark_new_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_i64_1d *f_part_idx, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *f_xys);
int futhark_free_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float *obj);
int futhark_store_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_GFUR_float *obj, void **p, size_t *n);
struct futhark_opaque_skylineInfo_GFUR_float *futhark_restore_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_skylineInfo_GFUR_float_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj);
int futhark_project_opaque_skylineInfo_GFUR_float_part_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj);
int futhark_project_opaque_skylineInfo_GFUR_float_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj);
int futhark_new_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_i64_1d *f_part_idx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *f_xys);

// Entry points
int futhark_entry_calc_global_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1);
int futhark_entry_calc_global_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1);
int futhark_entry_calc_intermSkyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const bool in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_calc_intermSkyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const bool in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_calc_local_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1);
int futhark_entry_calc_local_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1);
int futhark_entry_crack_Skyline_double_GFUR(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double **out0, const struct futhark_opaque_skylineInfo_GFUR_double *in0);
int futhark_entry_crack_Skyline_float_GFUR(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float **out0, const struct futhark_opaque_skylineInfo_GFUR_float *in0);
int futhark_entry_define_skyline_space_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_define_skyline_space_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_merge_Skylines_2_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2);
int futhark_entry_merge_Skylines_2_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2);
int futhark_entry_merge_Skylines_3_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3);
int futhark_entry_merge_Skylines_3_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3);
int futhark_entry_merge_Skylines_4_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3, const struct futhark_opaque_skylineInfo_GFUR_double *in4);
int futhark_entry_merge_Skylines_4_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3, const struct futhark_opaque_skylineInfo_GFUR_float *in4);
int futhark_entry_merge_Skylines_5_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3, const struct futhark_opaque_skylineInfo_GFUR_double *in4, const struct futhark_opaque_skylineInfo_GFUR_double *in5);
int futhark_entry_merge_Skylines_5_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3, const struct futhark_opaque_skylineInfo_GFUR_float *in4, const struct futhark_opaque_skylineInfo_GFUR_float *in5);
int futhark_entry_partwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineBase_double *in1, const struct futhark_f64_2d *in2, const int64_t in3, const bool in4);
int futhark_entry_partwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_f32_2d *in2, const int64_t in3, const bool in4);
int futhark_entry_pointwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_f64_2d *in1, const int64_t in2, const bool in3);
int futhark_entry_pointwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3);
int futhark_entry_sort_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_f64_2d *in1, const int64_t in2, const bool in3);
int futhark_entry_sort_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
};
struct tuning_params {
    int dummy;
};
static const int num_tuning_params = 0;
static const char *tuning_param_names[] = {NULL};
static const char *tuning_param_vars[] = {NULL};
static const char *tuning_param_classes[] = {NULL};
static int64_t tuning_param_defaults[] = {0};
// Start of backends/c.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  (void)cfg;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
};

int backend_context_setup(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)ctx;
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/c.h

struct program {
    int dummy;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_entry_calc_global_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588224, struct memblock *mem_out_p_588225, struct memblock *mem_out_p_588226, struct memblock *mem_out_p_588227, int64_t *out_prim_out_588228, int64_t *out_prim_out_588229, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_305789, int64_t dz2080U_305790, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791, int64_t dz2081U_305792, int64_t dz2082U_305793, int64_t dz2083U_305794, int64_t total_angle_no_305801, int64_t total_grid_no_305802, int64_t total_part_no_305803);
FUTHARK_FUN_ATTR int futrts_entry_calc_global_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588244, struct memblock *mem_out_p_588245, struct memblock *mem_out_p_588246, struct memblock *mem_out_p_588247, int64_t *out_prim_out_588248, int64_t *out_prim_out_588249, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_470048, int64_t dz2080U_470049, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050, int64_t dz2081U_470051, int64_t dz2082U_470052, int64_t dz2083U_470053, int64_t total_angle_no_470060, int64_t total_grid_no_470061, int64_t total_part_no_470062);
FUTHARK_FUN_ATTR int futrts_entry_calc_intermSkyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588264, struct memblock *mem_out_p_588265, struct memblock *mem_out_p_588266, struct memblock *mem_out_p_588267, int64_t *out_prim_out_588268, int64_t *out_prim_out_588269, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_396635, int64_t dz2080U_396636, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637, int64_t dz2081U_396638, int64_t dz2082U_396639, int64_t dz2083U_396640, int64_t total_angle_no_396647, int64_t total_grid_no_396648, int64_t total_part_no_396649, bool include_angle_steps_396654, int64_t omit_step_396655, int64_t max_steps_396656, int64_t sizze_thresh_396657);
FUTHARK_FUN_ATTR int futrts_entry_calc_intermSkyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588298, struct memblock *mem_out_p_588299, struct memblock *mem_out_p_588300, struct memblock *mem_out_p_588301, int64_t *out_prim_out_588302, int64_t *out_prim_out_588303, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_560381, int64_t dz2080U_560382, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383, int64_t dz2081U_560384, int64_t dz2082U_560385, int64_t dz2083U_560386, int64_t total_angle_no_560393, int64_t total_grid_no_560394, int64_t total_part_no_560395, bool include_angle_steps_560400, int64_t omit_step_560401, int64_t max_steps_560402, int64_t sizze_thresh_560403);
FUTHARK_FUN_ATTR int futrts_entry_calc_local_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588332, struct memblock *mem_out_p_588333, struct memblock *mem_out_p_588334, struct memblock *mem_out_p_588335, int64_t *out_prim_out_588336, int64_t *out_prim_out_588337, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_302009, int64_t dz2080U_302010, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011, int64_t dz2081U_302012, int64_t dz2082U_302013, int64_t dz2083U_302014, int64_t total_angle_no_302021, int64_t total_grid_no_302022, int64_t total_part_no_302023);
FUTHARK_FUN_ATTR int futrts_entry_calc_local_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588358, struct memblock *mem_out_p_588359, struct memblock *mem_out_p_588360, struct memblock *mem_out_p_588361, int64_t *out_prim_out_588362, int64_t *out_prim_out_588363, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_466278, int64_t dz2080U_466279, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280, int64_t dz2081U_466281, int64_t dz2082U_466282, int64_t dz2083U_466283, int64_t total_angle_no_466290, int64_t total_grid_no_466291, int64_t total_part_no_466292);
FUTHARK_FUN_ATTR int futrts_entry_crack_Skyline_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_588384, struct memblock *mem_out_p_588385, int64_t *out_prim_out_588386, struct memblock isPartitionDominated_mem_586411, struct memblock part_idx_mem_586412, struct memblock xys_mem_586413, struct memblock xys_mem_586414, int64_t dim_396692, int64_t dz2081U_396693, int64_t dz2082U_396694, int64_t dz2083U_396695);
FUTHARK_FUN_ATTR int futrts_entry_crack_Skyline_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_588387, struct memblock *mem_out_p_588388, int64_t *out_prim_out_588389, struct memblock isPartitionDominated_mem_586411, struct memblock part_idx_mem_586412, struct memblock xys_mem_586413, struct memblock xys_mem_586414, int64_t dim_560438, int64_t dz2081U_560439, int64_t dz2082U_560440, int64_t dz2083U_560441);
FUTHARK_FUN_ATTR int futrts_entry_define_skyline_space_double(struct futhark_context *ctx, struct memblock *mem_out_p_588390, struct memblock *mem_out_p_588391, struct memblock *mem_out_p_588392, struct memblock *mem_out_p_588393, struct memblock *mem_out_p_588394, struct memblock *mem_out_p_588395, int64_t *out_prim_out_588396, int64_t *out_prim_out_588397, int64_t *out_prim_out_588398, int64_t *out_prim_out_588399, struct memblock min_per_dim_mem_586411, struct memblock max_per_dim_mem_586412, struct memblock grid_partitions_per_dim_mem_586413, struct memblock angle_partitions_per_dim_mem_586414, int64_t dim_233135, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136);
FUTHARK_FUN_ATTR int futrts_entry_define_skyline_space_float(struct futhark_context *ctx, struct memblock *mem_out_p_588402, struct memblock *mem_out_p_588403, struct memblock *mem_out_p_588404, struct memblock *mem_out_p_588405, struct memblock *mem_out_p_588406, struct memblock *mem_out_p_588407, int64_t *out_prim_out_588408, int64_t *out_prim_out_588409, int64_t *out_prim_out_588410, int64_t *out_prim_out_588411, struct memblock min_per_dim_mem_586411, struct memblock max_per_dim_mem_586412, struct memblock grid_partitions_per_dim_mem_586413, struct memblock angle_partitions_per_dim_mem_586414, int64_t dim_397793, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_2_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588414, struct memblock *mem_out_p_588415, struct memblock *mem_out_p_588416, struct memblock *mem_out_p_588417, int64_t *out_prim_out_588418, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, int64_t dim_386746, int64_t dz2080U_386747, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748, int64_t dz2083U_386749, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_386750, int64_t dzlz7bUskBzitotal_part_noz7dUzg_386751, int64_t dz2083U_386752, int64_t total_angle_no_386759, int64_t total_grid_no_386760, int64_t total_part_no_386761);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_2_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588433, struct memblock *mem_out_p_588434, struct memblock *mem_out_p_588435, struct memblock *mem_out_p_588436, int64_t *out_prim_out_588437, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, int64_t dim_550531, int64_t dz2080U_550532, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533, int64_t dz2083U_550534, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_550535, int64_t dzlz7bUskBzitotal_part_noz7dUzg_550536, int64_t dz2083U_550537, int64_t total_angle_no_550544, int64_t total_grid_no_550545, int64_t total_part_no_550546);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_3_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588452, struct memblock *mem_out_p_588453, struct memblock *mem_out_p_588454, struct memblock *mem_out_p_588455, int64_t *out_prim_out_588456, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, int64_t dim_366050, int64_t dz2080U_366051, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052, int64_t dz2083U_366053, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_366054, int64_t dzlz7bUskBzitotal_part_noz7dUzg_366055, int64_t dz2083U_366056, int64_t dz2083U_366057, int64_t total_angle_no_366064, int64_t total_grid_no_366065, int64_t total_part_no_366066);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_3_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588478, struct memblock *mem_out_p_588479, struct memblock *mem_out_p_588480, struct memblock *mem_out_p_588481, int64_t *out_prim_out_588482, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, int64_t dim_529835, int64_t dz2080U_529836, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837, int64_t dz2083U_529838, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_529839, int64_t dzlz7bUskBzitotal_part_noz7dUzg_529840, int64_t dz2083U_529841, int64_t dz2083U_529842, int64_t total_angle_no_529849, int64_t total_grid_no_529850, int64_t total_part_no_529851);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_4_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588504, struct memblock *mem_out_p_588505, struct memblock *mem_out_p_588506, struct memblock *mem_out_p_588507, int64_t *out_prim_out_588508, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, int64_t dim_345683, int64_t dz2080U_345684, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685, int64_t dz2083U_345686, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_345687, int64_t dzlz7bUskBzitotal_part_noz7dUzg_345688, int64_t dz2083U_345689, int64_t dz2083U_345690, int64_t dz2083U_345691, int64_t total_angle_no_345698, int64_t total_grid_no_345699, int64_t total_part_no_345700);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_4_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588537, struct memblock *mem_out_p_588538, struct memblock *mem_out_p_588539, struct memblock *mem_out_p_588540, int64_t *out_prim_out_588541, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, int64_t dim_509468, int64_t dz2080U_509469, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470, int64_t dz2083U_509471, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_509472, int64_t dzlz7bUskBzitotal_part_noz7dUzg_509473, int64_t dz2083U_509474, int64_t dz2083U_509475, int64_t dz2083U_509476, int64_t total_angle_no_509483, int64_t total_grid_no_509484, int64_t total_part_no_509485);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_5_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588570, struct memblock *mem_out_p_588571, struct memblock *mem_out_p_588572, struct memblock *mem_out_p_588573, int64_t *out_prim_out_588574, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, struct memblock isPartitionDominated_mem_586433, struct memblock part_idx_mem_586434, struct memblock xys_mem_586435, struct memblock xys_mem_586436, int64_t dim_325730, int64_t dz2080U_325731, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732, int64_t dz2083U_325733, int64_t dz2081U_325734, int64_t dzlz7bUskBzitotal_part_noz7dUzg_325735, int64_t dz2083U_325736, int64_t dz2083U_325737, int64_t dz2083U_325738, int64_t dz2083U_325739, int64_t total_angle_no_325746, int64_t total_grid_no_325747, int64_t total_part_no_325748);
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_5_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588610, struct memblock *mem_out_p_588611, struct memblock *mem_out_p_588612, struct memblock *mem_out_p_588613, int64_t *out_prim_out_588614, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, struct memblock isPartitionDominated_mem_586433, struct memblock part_idx_mem_586434, struct memblock xys_mem_586435, struct memblock xys_mem_586436, int64_t dim_489515, int64_t dz2080U_489516, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517, int64_t dz2083U_489518, int64_t dz2081U_489519, int64_t dzlz7bUskBzitotal_part_noz7dUzg_489520, int64_t dz2083U_489521, int64_t dz2083U_489522, int64_t dz2083U_489523, int64_t dz2083U_489524, int64_t total_angle_no_489531, int64_t total_grid_no_489532, int64_t total_part_no_489533);
FUTHARK_FUN_ATTR int futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588650, struct memblock *mem_out_p_588651, struct memblock *mem_out_p_588652, struct memblock *mem_out_p_588653, int64_t *out_prim_out_588654, int64_t *out_prim_out_588655, int64_t *out_prim_out_588656, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock angle_part_prefix_sum_mem_586417, struct memblock angle_partitions_per_dim_mem_586418, struct memblock grid_part_prefix_sum_mem_586419, struct memblock grid_part_sizze_per_dim_mem_586420, struct memblock grid_partitions_per_dim_mem_586421, struct memblock start_of_grid_partition_mem_586422, struct memblock xs_mem_586423, int64_t dim_274571, int64_t dz2080U_274572, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573, int64_t dz2080U_274574, int64_t n_274575, int64_t total_angle_no_274582, int64_t total_grid_no_274583, int64_t total_part_no_274584, int64_t total_angle_no_274591, int64_t total_grid_no_274592, int64_t total_part_no_274593, int64_t offset_274595, bool use_measure_for_sorting_274596);
FUTHARK_FUN_ATTR int futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588735, struct memblock *mem_out_p_588736, struct memblock *mem_out_p_588737, struct memblock *mem_out_p_588738, int64_t *out_prim_out_588739, int64_t *out_prim_out_588740, int64_t *out_prim_out_588741, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock angle_part_prefix_sum_mem_586417, struct memblock angle_partitions_per_dim_mem_586418, struct memblock grid_part_prefix_sum_mem_586419, struct memblock grid_part_sizze_per_dim_mem_586420, struct memblock grid_partitions_per_dim_mem_586421, struct memblock start_of_grid_partition_mem_586422, struct memblock xs_mem_586423, int64_t dim_438949, int64_t dz2080U_438950, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951, int64_t dz2080U_438952, int64_t n_438953, int64_t total_angle_no_438960, int64_t total_grid_no_438961, int64_t total_part_no_438962, int64_t total_angle_no_438969, int64_t total_grid_no_438970, int64_t total_part_no_438971, int64_t offset_438973, bool use_measure_for_sorting_438974);
FUTHARK_FUN_ATTR int futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588820, struct memblock *mem_out_p_588821, struct memblock *mem_out_p_588822, struct memblock *mem_out_p_588823, int64_t *out_prim_out_588824, int64_t *out_prim_out_588825, int64_t *out_prim_out_588826, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_293582, int64_t dz2080U_293583, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584, int64_t n_293585, int64_t total_angle_no_293592, int64_t total_grid_no_293593, int64_t total_part_no_293594, int64_t offset_293596, bool use_measure_for_sorting_293597);
FUTHARK_FUN_ATTR int futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588902, struct memblock *mem_out_p_588903, struct memblock *mem_out_p_588904, struct memblock *mem_out_p_588905, int64_t *out_prim_out_588906, int64_t *out_prim_out_588907, int64_t *out_prim_out_588908, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_457918, int64_t dz2080U_457919, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920, int64_t n_457921, int64_t total_angle_no_457928, int64_t total_grid_no_457929, int64_t total_part_no_457930, int64_t offset_457932, bool use_measure_for_sorting_457933);
FUTHARK_FUN_ATTR int futrts_entry_sort_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588984, struct memblock *mem_out_p_588985, struct memblock *mem_out_p_588986, struct memblock *mem_out_p_588987, int64_t *out_prim_out_588988, int64_t *out_prim_out_588989, int64_t *out_prim_out_588990, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_251930, int64_t dz2080U_251931, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932, int64_t n_251933, int64_t total_angle_no_251940, int64_t total_grid_no_251941, int64_t total_part_no_251942, int64_t offset_251944, bool use_measure_for_sorting_251945);
FUTHARK_FUN_ATTR int futrts_entry_sort_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_589060, struct memblock *mem_out_p_589061, struct memblock *mem_out_p_589062, struct memblock *mem_out_p_589063, int64_t *out_prim_out_589064, int64_t *out_prim_out_589065, int64_t *out_prim_out_589066, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_416322, int64_t dz2080U_416323, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324, int64_t n_416325, int64_t total_angle_no_416332, int64_t total_grid_no_416333, int64_t total_part_no_416334, int64_t offset_416336, bool use_measure_for_sorting_416337);
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_4833(struct futhark_context *ctx, int64_t *out_prim_out_589136, int64_t upper_bound_233466, int64_t n_233467);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13270(struct futhark_context *ctx, bool *out_prim_out_589137, int64_t j_234369, int64_t pre_d_234370, int64_t per_d_234371);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13275(struct futhark_context *ctx, bool *out_prim_out_589138, int64_t j_251958, int64_t pre_d_251959, int64_t per_d_251960);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13310(struct futhark_context *ctx, int64_t *out_prim_out_589139, int64_t accumulated_subdiv_386856, int64_t angle_no_omitted_386857, int64_t grid_no_omitted_386858, int64_t i_386859);
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13311(struct futhark_context *ctx, int64_t *out_prim_out_589140, int64_t i_386872);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_13231(struct futhark_context *ctx, int64_t *out_prim_out_589141, int64_t *out_prim_out_589142, int64_t *out_prim_out_589143, int64_t *out_prim_out_589144, int64_t *out_prim_out_589145, int64_t slo_233770, int64_t shi_233771, int64_t tlo_233772, int64_t thi_233773, int64_t count_233774);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
struct futhark_i64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_f32_2d *futhark_new_f32_2d(struct futhark_context *ctx, const float *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_2d *futhark_new_raw_f32_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f32_2d *bad = NULL;
    struct futhark_f32_2d *arr = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_2d(struct futhark_context *ctx, float *out, struct futhark_f32_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * arr->shape[1] + i1 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_2d(struct futhark_context *ctx, struct futhark_f32_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_f64_2d *futhark_new_f64_2d(struct futhark_context *ctx, const double *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f64_2d *bad = NULL;
    struct futhark_f64_2d *arr = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_2d *futhark_new_raw_f64_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_f64_2d *bad = NULL;
    struct futhark_f64_2d *arr = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_2d(struct futhark_context *ctx, double *out, struct futhark_f64_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * arr->shape[1] + i1 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_2d(struct futhark_context *ctx, struct futhark_f64_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_bool_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_bool_1d *futhark_new_bool_1d(struct futhark_context *ctx, const bool *data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 1 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 1);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_bool_1d *futhark_new_raw_bool_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_bool_1d *bad = NULL;
    struct futhark_bool_1d *arr = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr, bool *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 1 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 1);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_bool_1d(struct futhark_context *ctx, bool *out, struct futhark_bool_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (1 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 1 * (i0 * 1), 1);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_bool_1d(struct futhark_context *ctx, struct futhark_bool_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_skylineBase_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
    struct futhark_f64_1d *v3;
    struct futhark_i64_1d *v4;
    struct futhark_f64_2d *v5;
    int64_t v6;
    int64_t v7;
    int64_t v8;
};
int futhark_project_opaque_skylineBase_double_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v3, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v4, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_2d));
    memcpy(v, obj->v5, sizeof(struct futhark_f64_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v6;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v7;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_double_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v8;
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineBase_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f64_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const struct futhark_f64_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no)
{
    struct futhark_opaque_skylineBase_double *v = malloc(sizeof(struct futhark_opaque_skylineBase_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_angle_part_prefix_sum;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_angle_partitions_per_dim;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_grid_part_prefix_sum;
        (void) (*v->v2->mem.references)++;
    }
    {
        v->v3 = malloc(sizeof(struct futhark_f64_1d));
        *v->v3 = *f_grid_part_sizze_per_dim;
        (void) (*v->v3->mem.references)++;
    }
    {
        v->v4 = malloc(sizeof(struct futhark_i64_1d));
        *v->v4 = *f_grid_partitions_per_dim;
        (void) (*v->v4->mem.references)++;
    }
    {
        v->v5 = malloc(sizeof(struct futhark_f64_2d));
        *v->v5 = *f_start_of_grid_partition;
        (void) (*v->v5->mem.references)++;
    }
    v->v6 = f_total_angle_no;
    v->v7 = f_total_grid_no;
    v->v8 = f_total_part_no;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineBase_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
        ret = tmp;
    if (obj->v5 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v5)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineBase_double(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
    int64_t size_4 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
    int64_t size_5 = 7 + 2 * sizeof(int64_t) + futhark_shape_f64_2d(ctx, obj->v5)[0] * futhark_shape_f64_2d(ctx, obj->v5)[1] * sizeof(double);
    int64_t size_6 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_7 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_8 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v3)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v4), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v4, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_2d(ctx, obj->v5), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f64_2d(ctx, obj->v5, (void *) out);
        out += futhark_shape_f64_2d(ctx, obj->v5)[0] * futhark_shape_f64_2d(ctx, obj->v5)[1] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v6, sizeof(obj->v6));
        out += sizeof(obj->v6);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v7, sizeof(obj->v7));
        out += sizeof(obj->v7);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v8, sizeof(obj->v8));
        out += sizeof(obj->v8);
    }
    return ret;
}
struct futhark_opaque_skylineBase_double *futhark_restore_opaque_skylineBase_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineBase_double *obj = malloc(sizeof(struct futhark_opaque_skylineBase_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(double);
    
    int64_t shape_4[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_4, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    obj->v4 = NULL;
    src += shape_4[0] * sizeof(int64_t);
    
    int64_t shape_5[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_5, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    obj->v5 = NULL;
    src += shape_5[0] * shape_5[1] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    src += sizeof(obj->v6);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    src += sizeof(obj->v7);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    src += sizeof(obj->v8);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_f64_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
        obj->v4 = futhark_new_i64_1d(ctx, data_4, shape_4[0]);
        if (obj->v4 == NULL)
            err = 1;
        obj->v5 = futhark_new_f64_2d(ctx, data_5, shape_5[0], shape_5[1]);
        if (obj->v5 == NULL)
            err = 1;
        memcpy(&obj->v6, data_6, sizeof(obj->v6));
        memcpy(&obj->v7, data_7, sizeof(obj->v7));
        memcpy(&obj->v8, data_8, sizeof(obj->v8));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
            ret = tmp;
        if (obj->v5 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v5)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup2_arr1d_f64_i64 {
    struct futhark_f64_1d *v0;
    int64_t v1;
};
int futhark_project_opaque_tup2_arr1d_f64_i64_0(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_arr1d_f64_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 **out, const struct futhark_f64_1d *f_0, const int64_t f_1)
{
    struct futhark_opaque_tup2_arr1d_f64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f64_i64));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_1;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_arr1d_f64_i64 *futhark_restore_opaque_tup2_arr1d_f64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_arr1d_f64_i64 *obj = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f64_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 {
    struct futhark_f64_2d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_arr1d_f64_i64_0(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f64_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_arr1d_f64_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 **out, const struct futhark_f64_2d *f_0, const struct futhark_i64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f64_i64));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_2d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f64_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_arr1d_f64_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f64_i64));
        
        v->v0 = malloc(sizeof(*v->v0));
        v->v0->mem.references = NULL;
        if (memblock_alloc(ctx, &v->v0->mem, arr->v0->shape[1] * 8, "v->v0->mem"))
            err = 1;
        v->v0->shape[0] = arr->v0->shape[1];
        if (8 * arr->v0->shape[1] > 0)
            memmove(v->v0->mem.mem + 0, arr->v0->mem.mem + 8 * (i0 * arr->v0->shape[1]), 8 * arr->v0->shape[1]);
        if (8 > 0)
            memmove((unsigned char *) &v->v1 + 0, arr->v1->mem.mem + 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_f64_2d(ctx, obj->v0)[0] * futhark_shape_f64_2d(ctx, obj->v0)[1] * sizeof(double);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f64_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_2d(ctx, obj->v0)[0] * futhark_shape_f64_2d(ctx, obj->v0)[1] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f64_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f64_i64));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(double);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_f64_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineInfo_GFUR_double {
    struct futhark_bool_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_2d *v2;
    struct futhark_i64_1d *v3;
};
int futhark_project_opaque_skylineInfo_GFUR_double_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineInfo_GFUR_double_part_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineInfo_GFUR_double_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 **out, const struct futhark_opaque_skylineInfo_GFUR_double *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f64_i64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v2;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v3;
    (void) (*v->v1->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_i64_1d *f_part_idx, const struct futhark_opaque_arr1d_tup2_arr1d_f64_i64 *f_xys)
{
    struct futhark_opaque_skylineInfo_GFUR_double *v = malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_bool_1d));
        *v->v0 = *f_isPartitionDominated;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_part_idx;
        (void) (*v->v1->mem.references)++;
    }
    {
        {
            v->v2 = malloc(sizeof(*f_xys->v0));
            *v->v2 = *f_xys->v0;
            (void) (*v->v2->mem.references)++;
        }
        {
            v->v3 = malloc(sizeof(*f_xys->v1));
            *v->v3 = *f_xys->v1;
            (void) (*v->v3->mem.references)++;
        }
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_GFUR_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_f64_2d(ctx, obj->v2)[0] * futhark_shape_f64_2d(ctx, obj->v2)[1] * sizeof(double);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v3)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f64_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_2d(ctx, obj->v2)[0] * futhark_shape_f64_2d(ctx, obj->v2)[1] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v3)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_skylineInfo_GFUR_double *futhark_restore_opaque_skylineInfo_GFUR_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineInfo_GFUR_double *obj = malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(bool);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(double);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_bool_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_i64_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineData_GFUR_double {
    int64_t v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_2d *v2;
};
int futhark_project_opaque_skylineData_GFUR_double_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_GFUR_double *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_GFUR_double_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_GFUR_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_GFUR_double_skyTups(struct futhark_context *ctx, struct futhark_f64_2d **out, const struct futhark_opaque_skylineData_GFUR_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineData_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double **out, const int64_t f_len, const struct futhark_i64_1d *f_pL, const struct futhark_f64_2d *f_skyTups)
{
    struct futhark_opaque_skylineData_GFUR_double *v = malloc(sizeof(struct futhark_opaque_skylineData_GFUR_double));
    
    lock_lock(&ctx->lock);
    v->v0 = f_len;
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_2d));
        *v->v2 = *f_skyTups;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineData_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineData_GFUR_double(struct futhark_context *ctx, const struct futhark_opaque_skylineData_GFUR_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_f64_2d(ctx, obj->v2)[0] * futhark_shape_f64_2d(ctx, obj->v2)[1] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f64_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_2d(ctx, obj->v2)[0] * futhark_shape_f64_2d(ctx, obj->v2)[1] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_skylineData_GFUR_double *futhark_restore_opaque_skylineData_GFUR_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineData_GFUR_double *obj = malloc(sizeof(struct futhark_opaque_skylineData_GFUR_double));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(double);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineBase_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
    struct futhark_f32_1d *v3;
    struct futhark_i64_1d *v4;
    struct futhark_f32_2d *v5;
    int64_t v6;
    int64_t v7;
    int64_t v8;
};
int futhark_project_opaque_skylineBase_float_angle_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_angle_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_part_prefix_sum(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_part_size_per_dim(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v3, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_grid_partitions_per_dim(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v4, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_start_of_grid_partition(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v5, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_angle_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v6;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_grid_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v7;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineBase_float_total_part_no(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v8;
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out, const struct futhark_i64_1d *f_angle_part_prefix_sum, const struct futhark_i64_1d *f_angle_partitions_per_dim, const struct futhark_i64_1d *f_grid_part_prefix_sum, const struct futhark_f32_1d *f_grid_part_sizze_per_dim, const struct futhark_i64_1d *f_grid_partitions_per_dim, const struct futhark_f32_2d *f_start_of_grid_partition, const int64_t f_total_angle_no, const int64_t f_total_grid_no, const int64_t f_total_part_no)
{
    struct futhark_opaque_skylineBase_float *v = malloc(sizeof(struct futhark_opaque_skylineBase_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_angle_part_prefix_sum;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_angle_partitions_per_dim;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_grid_part_prefix_sum;
        (void) (*v->v2->mem.references)++;
    }
    {
        v->v3 = malloc(sizeof(struct futhark_f32_1d));
        *v->v3 = *f_grid_part_sizze_per_dim;
        (void) (*v->v3->mem.references)++;
    }
    {
        v->v4 = malloc(sizeof(struct futhark_i64_1d));
        *v->v4 = *f_grid_partitions_per_dim;
        (void) (*v->v4->mem.references)++;
    }
    {
        v->v5 = malloc(sizeof(struct futhark_f32_2d));
        *v->v5 = *f_start_of_grid_partition;
        (void) (*v->v5->mem.references)++;
    }
    v->v6 = f_total_angle_no;
    v->v7 = f_total_grid_no;
    v->v8 = f_total_part_no;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineBase_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
        ret = tmp;
    if (obj->v5 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v5)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineBase_float(struct futhark_context *ctx, const struct futhark_opaque_skylineBase_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v3)[0] * sizeof(float);
    int64_t size_4 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
    int64_t size_5 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v5)[0] * futhark_shape_f32_2d(ctx, obj->v5)[1] * sizeof(float);
    int64_t size_6 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_7 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_8 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3 + size_4 + size_5 + size_6 + size_7 + size_8;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v3)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v4), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v4, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v4)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v5), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v5, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v5)[0] * futhark_shape_f32_2d(ctx, obj->v5)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v6, sizeof(obj->v6));
        out += sizeof(obj->v6);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v7, sizeof(obj->v7));
        out += sizeof(obj->v7);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v8, sizeof(obj->v8));
        out += sizeof(obj->v8);
    }
    return ret;
}
struct futhark_opaque_skylineBase_float *futhark_restore_opaque_skylineBase_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineBase_float *obj = malloc(sizeof(struct futhark_opaque_skylineBase_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(float);
    
    int64_t shape_4[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_4, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_4 = src;
    
    obj->v4 = NULL;
    src += shape_4[0] * sizeof(int64_t);
    
    int64_t shape_5[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_5, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_5 = src;
    
    obj->v5 = NULL;
    src += shape_5[0] * shape_5[1] * sizeof(float);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_6 = src;
    
    src += sizeof(obj->v6);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_7 = src;
    
    src += sizeof(obj->v7);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_8 = src;
    
    src += sizeof(obj->v8);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_f32_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
        obj->v4 = futhark_new_i64_1d(ctx, data_4, shape_4[0]);
        if (obj->v4 == NULL)
            err = 1;
        obj->v5 = futhark_new_f32_2d(ctx, data_5, shape_5[0], shape_5[1]);
        if (obj->v5 == NULL)
            err = 1;
        memcpy(&obj->v6, data_6, sizeof(obj->v6));
        memcpy(&obj->v7, data_7, sizeof(obj->v7));
        memcpy(&obj->v8, data_8, sizeof(obj->v8));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        if (obj->v4 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v4)) != 0)
            ret = tmp;
        if (obj->v5 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v5)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_tup2_arr1d_f32_i64 {
    struct futhark_f32_1d *v0;
    int64_t v1;
};
int futhark_project_opaque_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v1;
    *out = v;
    return 0;
}
int futhark_new_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, const struct futhark_f32_1d *f_0, const int64_t f_1)
{
    struct futhark_opaque_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    v->v1 = f_1;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_tup2_arr1d_f32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v1, sizeof(obj->v1));
        out += sizeof(obj->v1);
    }
    return ret;
}
struct futhark_opaque_tup2_arr1d_f32_i64 *futhark_restore_opaque_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_tup2_arr1d_f32_i64 *obj = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    src += sizeof(obj->v1);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        memcpy(&obj->v1, data_1, sizeof(obj->v1));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 {
    struct futhark_f32_2d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_0(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_arr1d_tup2_arr1d_f32_i64_1(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_zip_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_f32_2d *f_0, const struct futhark_i64_1d *f_1)
{
    if (!(f_0->shape[0] == f_1->shape[0])) {
        set_error(ctx, strdup("Cannot zip arrays with different shapes."));
        return 1;
    }
    
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_2d));
        *v->v0 = *f_0;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_1;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_index_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_tup2_arr1d_f32_i64 **out, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->v0->shape[0]) {
        struct futhark_opaque_tup2_arr1d_f32_i64 *v = malloc(sizeof(struct futhark_opaque_tup2_arr1d_f32_i64));
        
        v->v0 = malloc(sizeof(*v->v0));
        v->v0->mem.references = NULL;
        if (memblock_alloc(ctx, &v->v0->mem, arr->v0->shape[1] * 4, "v->v0->mem"))
            err = 1;
        v->v0->shape[0] = arr->v0->shape[1];
        if (4 * arr->v0->shape[1] > 0)
            memmove(v->v0->mem.mem + 0, arr->v0->mem.mem + 4 * (i0 * arr->v0->shape[1]), 4 * arr->v0->shape[1]);
        if (8 > 0)
            memmove((unsigned char *) &v->v1 + 0, arr->v1->mem.mem + 8 * (i0 * 1), 8);
        if (err == 0)
            *out = v;
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
const int64_t *futhark_shape_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *arr)
{
    (void) ctx;
    return arr->v0->shape;
}
int futhark_free_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v0)[0] * futhark_shape_f32_2d(ctx, obj->v0)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *futhark_restore_opaque_arr1d_tup2_arr1d_f32_i64(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *obj = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(float);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineInfo_GFUR_float {
    struct futhark_bool_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_2d *v2;
    struct futhark_i64_1d *v3;
};
int futhark_project_opaque_skylineInfo_GFUR_float_isPartitionDominated(struct futhark_context *ctx, struct futhark_bool_1d **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj)
{
    (void) ctx;
    
    struct futhark_bool_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_bool_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_bool_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineInfo_GFUR_float_part_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineInfo_GFUR_float_xys(struct futhark_context *ctx, struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 **out, const struct futhark_opaque_skylineInfo_GFUR_float *obj)
{
    (void) ctx;
    
    struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_opaque_arr1d_tup2_arr1d_f32_i64));
    v->v0 = malloc(sizeof(*v->v0));
    *v->v0 = *obj->v2;
    (void) (*v->v0->mem.references)++;
    v->v1 = malloc(sizeof(*v->v1));
    *v->v1 = *obj->v3;
    (void) (*v->v1->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out, const struct futhark_bool_1d *f_isPartitionDominated, const struct futhark_i64_1d *f_part_idx, const struct futhark_opaque_arr1d_tup2_arr1d_f32_i64 *f_xys)
{
    struct futhark_opaque_skylineInfo_GFUR_float *v = malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_bool_1d));
        *v->v0 = *f_isPartitionDominated;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_part_idx;
        (void) (*v->v1->mem.references)++;
    }
    {
        {
            v->v2 = malloc(sizeof(*f_xys->v0));
            *v->v2 = *f_xys->v0;
            (void) (*v->v2->mem.references)++;
        }
        {
            v->v3 = malloc(sizeof(*f_xys->v1));
            *v->v3 = *f_xys->v1;
            (void) (*v->v3->mem.references)++;
        }
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    if (obj->v3 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v3)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, const struct futhark_opaque_skylineInfo_GFUR_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v2)[0] * futhark_shape_f32_2d(ctx, obj->v2)[1] * sizeof(float);
    int64_t size_3 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v3)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2 + size_3;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, "bool", 4);
        out += 4;
        memcpy(out, futhark_shape_bool_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_bool_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_bool_1d(ctx, obj->v0)[0] * sizeof(bool);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v2)[0] * futhark_shape_f32_2d(ctx, obj->v2)[1] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v3), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v3, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v3)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_skylineInfo_GFUR_float *futhark_restore_opaque_skylineInfo_GFUR_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineInfo_GFUR_float *obj = malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, "bool", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(bool);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(float);
    
    int64_t shape_3[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_3, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_3 = src;
    
    obj->v3 = NULL;
    src += shape_3[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_bool_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
        obj->v3 = futhark_new_i64_1d(ctx, data_3, shape_3[0]);
        if (obj->v3 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_bool_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        if (obj->v3 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v3)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_skylineData_GFUR_float {
    int64_t v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_2d *v2;
};
int futhark_project_opaque_skylineData_GFUR_float_len(struct futhark_context *ctx, int64_t *out, const struct futhark_opaque_skylineData_GFUR_float *obj)
{
    (void) ctx;
    
    int64_t v;
    
    v = obj->v0;
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_GFUR_float_pL(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_skylineData_GFUR_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_skylineData_GFUR_float_skyTups(struct futhark_context *ctx, struct futhark_f32_2d **out, const struct futhark_opaque_skylineData_GFUR_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_skylineData_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float **out, const int64_t f_len, const struct futhark_i64_1d *f_pL, const struct futhark_f32_2d *f_skyTups)
{
    struct futhark_opaque_skylineData_GFUR_float *v = malloc(sizeof(struct futhark_opaque_skylineData_GFUR_float));
    
    lock_lock(&ctx->lock);
    v->v0 = f_len;
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_2d));
        *v->v2 = *f_skyTups;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_skylineData_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_skylineData_GFUR_float(struct futhark_context *ctx, const struct futhark_opaque_skylineData_GFUR_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_f32_2d(ctx, obj->v2)[0] * futhark_shape_f32_2d(ctx, obj->v2)[1] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, &obj->v0, sizeof(obj->v0));
        out += sizeof(obj->v0);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_f32_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_2d(ctx, obj->v2)[0] * futhark_shape_f32_2d(ctx, obj->v2)[1] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_skylineData_GFUR_float *futhark_restore_opaque_skylineData_GFUR_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_skylineData_GFUR_float *obj = malloc(sizeof(struct futhark_opaque_skylineData_GFUR_float));
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    src += sizeof(obj->v0);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(float);
    if (err == 0) {
        memcpy(&obj->v0, data_0, sizeof(obj->v0));
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_entry_calc_global_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588224, struct memblock *mem_out_p_588225, struct memblock *mem_out_p_588226, struct memblock *mem_out_p_588227, int64_t *out_prim_out_588228, int64_t *out_prim_out_588229, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_305789, int64_t dz2080U_305790, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791, int64_t dz2081U_305792, int64_t dz2082U_305793, int64_t dz2083U_305794, int64_t total_angle_no_305801, int64_t total_grid_no_305802, int64_t total_part_no_305803)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586431_cached_sizze_588230 = 0;
    unsigned char *mem_586431 = NULL;
    int64_t mem_586438_cached_sizze_588231 = 0;
    unsigned char *mem_586438 = NULL;
    int64_t mem_586452_cached_sizze_588232 = 0;
    unsigned char *mem_586452 = NULL;
    int64_t mem_586454_cached_sizze_588233 = 0;
    unsigned char *mem_586454 = NULL;
    int64_t mem_586468_cached_sizze_588234 = 0;
    unsigned char *mem_586468 = NULL;
    int64_t mem_586495_cached_sizze_588235 = 0;
    unsigned char *mem_586495 = NULL;
    int64_t mem_586503_cached_sizze_588236 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586508_cached_sizze_588237 = 0;
    unsigned char *mem_586508 = NULL;
    int64_t mem_586516_cached_sizze_588238 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586524_cached_sizze_588239 = 0;
    unsigned char *mem_586524 = NULL;
    int64_t mem_586529_cached_sizze_588240 = 0;
    unsigned char *mem_586529 = NULL;
    int64_t mem_586540_cached_sizze_588241 = 0;
    unsigned char *mem_586540 = NULL;
    int64_t mem_586551_cached_sizze_588242 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586559_cached_sizze_588243 = 0;
    unsigned char *mem_586559 = NULL;
    struct memblock mem_586567;
    
    mem_586567.references = NULL;
    
    struct memblock mem_586479;
    
    mem_586479.references = NULL;
    
    struct memblock mem_586477;
    
    mem_586477.references = NULL;
    
    struct memblock mem_param_tmp_588015;
    
    mem_param_tmp_588015.references = NULL;
    
    struct memblock mem_586427;
    
    mem_586427.references = NULL;
    
    struct memblock mem_param_586425;
    
    mem_param_586425.references = NULL;
    
    struct memblock ext_mem_586450;
    
    ext_mem_586450.references = NULL;
    
    struct memblock mem_586422;
    
    mem_586422.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_571846 = sub64(dim_305789, (int64_t) 1);
    bool assert_cond_571847 = arg_571846 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791;
    bool assert_c_571848;
    
    if (!assert_cond_571847) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:828:26-830:44\n   #1  ftSkyline.fut:826:17-830:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586421 = (int64_t) 8 * dz2083U_305794;
    
    if (memblock_alloc(ctx, &mem_586422, bytes_586421, "mem_586422")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_588013 = 0; i_588013 < dz2083U_305794; i_588013++) {
        int64_t x_588014 = (int64_t) 0 + i_588013 * (int64_t) 1;
        
        ((int64_t *) mem_586422.mem)[i_588013] = x_588014;
    }
    if (memblock_set(ctx, &mem_param_586425, &mem_586422, "mem_586422") != 0)
        return 1;
    for (int64_t i_571851 = 0; i_571851 < dz2083U_305794; i_571851++) {
        if (memblock_alloc(ctx, &mem_586427, bytes_586421, "mem_586427")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586058 = 0; i_586058 < dz2083U_305794; i_586058++) {
            int64_t eta_p_571855 = ((int64_t *) mem_param_586425.mem)[i_586058];
            bool cond_571856 = slt64(eta_p_571855, (int64_t) 0);
            bool cond_f_res_571857 = eta_p_571855 == i_571851;
            bool x_571858 = !cond_571856;
            bool y_571859 = cond_f_res_571857 && x_571858;
            bool cond_571860 = cond_571856 || y_571859;
            int64_t defunc_0_f_res_571861;
            
            if (cond_571860) {
                defunc_0_f_res_571861 = eta_p_571855;
            } else {
                bool x_571862 = sle64((int64_t) 0, eta_p_571855);
                bool y_571863 = slt64(eta_p_571855, dz2083U_305794);
                bool bounds_check_571864 = x_571862 && y_571863;
                bool index_certs_571865;
                
                if (!bounds_check_571864) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_571855, "] out of bounds for array of shape [", (long long) dz2083U_305794, "].", "-> #0  ftSkyline.fut:676:46-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:828:26-29\n   #3  ftSkyline.fut:826:17-830:69\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (mem_586431_cached_sizze_588230 < dim_305789) {
                    err = lexical_realloc(ctx, &mem_586431, &mem_586431_cached_sizze_588230, dim_305789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586050 = 0; i_586050 < dim_305789; i_586050++) {
                    double eta_p_571868 = ((double *) xys_mem_586419.mem)[eta_p_571855 * dim_305789 + i_586050];
                    double eta_p_571869 = ((double *) xys_mem_586419.mem)[i_571851 * dim_305789 + i_586050];
                    bool defunc_0_f_res_571870 = eta_p_571869 <= eta_p_571868;
                    
                    ((bool *) mem_586431)[i_586050] = defunc_0_f_res_571870;
                }
                
                bool defunc_0_foldl_res_571871;
                bool acc_571873 = 1;
                
                for (int64_t i_571872 = 0; i_571872 < dim_305789; i_571872++) {
                    bool b_571874 = ((bool *) mem_586431)[i_571872];
                    bool x_571875 = acc_571873 && b_571874;
                    bool acc_tmp_588019 = x_571875;
                    
                    acc_571873 = acc_tmp_588019;
                }
                defunc_0_foldl_res_571871 = acc_571873;
                
                bool elimd_571876;
                
                if (defunc_0_foldl_res_571871) {
                    if (mem_586438_cached_sizze_588231 < dim_305789) {
                        err = lexical_realloc(ctx, &mem_586438, &mem_586438_cached_sizze_588231, dim_305789);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586054 = 0; i_586054 < dim_305789; i_586054++) {
                        double eta_p_582646 = ((double *) xys_mem_586419.mem)[eta_p_571855 * dim_305789 + i_586054];
                        double eta_p_582647 = ((double *) xys_mem_586419.mem)[i_571851 * dim_305789 + i_586054];
                        bool defunc_0_f_res_582648 = eta_p_582647 < eta_p_582646;
                        
                        ((bool *) mem_586438)[i_586054] = defunc_0_f_res_582648;
                    }
                    
                    bool defunc_0_foldl_res_582650;
                    bool acc_582652 = 0;
                    
                    for (int64_t i_582651 = 0; i_582651 < dim_305789; i_582651++) {
                        bool b_582653 = ((bool *) mem_586438)[i_582651];
                        bool defunc_0_f_res_582654 = acc_582652 || b_582653;
                        bool acc_tmp_588021 = defunc_0_f_res_582654;
                        
                        acc_582652 = acc_tmp_588021;
                    }
                    defunc_0_foldl_res_582650 = acc_582652;
                    elimd_571876 = defunc_0_foldl_res_582650;
                } else {
                    elimd_571876 = 0;
                }
                
                int64_t defunc_0_f_res_f_res_571886;
                
                if (elimd_571876) {
                    defunc_0_f_res_f_res_571886 = (int64_t) -1;
                } else {
                    defunc_0_f_res_f_res_571886 = eta_p_571855;
                }
                defunc_0_f_res_571861 = defunc_0_f_res_f_res_571886;
            }
            ((int64_t *) mem_586427.mem)[i_586058] = defunc_0_f_res_571861;
        }
        if (memblock_set(ctx, &mem_param_tmp_588015, &mem_586427, "mem_586427") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586425, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_586450, &mem_param_586425, "mem_param_586425") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
        return 1;
    if (mem_586452_cached_sizze_588232 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586452, &mem_586452_cached_sizze_588232, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586454_cached_sizze_588233 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586454, &mem_586454_cached_sizze_588233, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586068;
    int64_t scanacc_586062 = (int64_t) 0;
    
    for (int64_t i_586065 = 0; i_586065 < dz2083U_305794; i_586065++) {
        int64_t eta_p_582527 = ((int64_t *) ext_mem_586450.mem)[i_586065];
        bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
        int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
        int64_t defunc_0_op_res_571895 = add64(defunc_0_f_res_582529, scanacc_586062);
        
        ((int64_t *) mem_586452)[i_586065] = defunc_0_op_res_571895;
        ((int64_t *) mem_586454)[i_586065] = defunc_0_f_res_582529;
        
        int64_t scanacc_tmp_588022 = defunc_0_op_res_571895;
        
        scanacc_586062 = scanacc_tmp_588022;
    }
    discard_586068 = scanacc_586062;
    
    bool cond_571896 = dz2083U_305794 == (int64_t) 0;
    bool x_571897 = !cond_571896;
    int64_t tmp_571898 = sub64(dz2083U_305794, (int64_t) 1);
    bool x_571899 = sle64((int64_t) 0, tmp_571898);
    bool y_571900 = slt64(tmp_571898, dz2083U_305794);
    bool bounds_check_571901 = x_571899 && y_571900;
    bool protect_assert_disj_571902 = cond_571896 || bounds_check_571901;
    bool index_certs_571903;
    
    if (!protect_assert_disj_571902) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_571898, "] out of bounds for array of shape [", (long long) dz2083U_305794, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:828:26-29\n   #3  ftSkyline.fut:826:17-830:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_571904;
    
    if (x_571897) {
        int64_t x_582657 = ((int64_t *) mem_586452)[tmp_571898];
        
        m_f_res_571904 = x_582657;
    } else {
        m_f_res_571904 = (int64_t) 0;
    }
    
    int64_t m_571906;
    
    if (cond_571896) {
        m_571906 = (int64_t) 0;
    } else {
        m_571906 = m_f_res_571904;
    }
    
    int64_t m_571916 = sub64(m_571906, (int64_t) 1);
    bool i_p_m_t_s_leq_w_571918 = slt64(m_571916, dz2083U_305794);
    bool zzero_leq_i_p_m_t_s_571917 = sle64((int64_t) 0, m_571916);
    bool y_571920 = zzero_leq_i_p_m_t_s_571917 && i_p_m_t_s_leq_w_571918;
    bool i_lte_j_571919 = sle64((int64_t) 0, m_571906);
    bool forwards_ok_571921 = i_lte_j_571919 && y_571920;
    bool eq_x_zz_571913 = (int64_t) 0 == m_f_res_571904;
    bool p_and_eq_x_y_571914 = x_571897 && eq_x_zz_571913;
    bool empty_slice_571915 = cond_571896 || p_and_eq_x_y_571914;
    bool ok_or_empty_571922 = empty_slice_571915 || forwards_ok_571921;
    bool index_certs_571923;
    
    if (!ok_or_empty_571922) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_571906, "] out of bounds for array of shape [", (long long) dz2083U_305794, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:828:26-29\n   #3  ftSkyline.fut:826:17-830:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586467 = (int64_t) 8 * m_571906;
    int64_t bytes_586476 = dim_305789 * bytes_586467;
    bool y_571938 = slt64((int64_t) 0, dz2080U_305790);
    bool index_certs_571939;
    
    if (!y_571938) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_305790, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:828:26-29\n   #5  ftSkyline.fut:826:17-830:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586494 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791;
    bool empty_or_match_cert_571953;
    
    if (!assert_cond_571847) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:828:26-29\n   #5  ftSkyline.fut:826:17-830:69\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586507 = (int64_t) 8 * dim_305789;
    int64_t bytes_586523 = (int64_t) 8 * arg_571846;
    int64_t bytes_586550 = (int64_t) 8 * total_part_no_305803;
    
    if (mem_586468_cached_sizze_588234 < bytes_586467) {
        err = lexical_realloc(ctx, &mem_586468, &mem_586468_cached_sizze_588234, bytes_586467);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586468, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586450.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_571906});
    for (int64_t write_iter_586069 = 0; write_iter_586069 < dz2083U_305794; write_iter_586069++) {
        int64_t write_iv_586071 = ((int64_t *) mem_586454)[write_iter_586069];
        int64_t write_iv_586072 = ((int64_t *) mem_586452)[write_iter_586069];
        int64_t write_iv_586073 = ((int64_t *) ext_mem_586450.mem)[write_iter_586069];
        bool cond_582522 = write_iv_586071 == (int64_t) 1;
        int64_t lifted_lambda_res_582523;
        
        if (cond_582522) {
            int64_t lifted_lambda_res_t_res_582658 = sub64(write_iv_586072, (int64_t) 1);
            
            lifted_lambda_res_582523 = lifted_lambda_res_t_res_582658;
        } else {
            lifted_lambda_res_582523 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_571906)) {
            ((int64_t *) mem_586468)[lifted_lambda_res_582523] = write_iv_586073;
        }
    }
    if (memblock_unref(ctx, &ext_mem_586450, "ext_mem_586450") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_586477, bytes_586476, "mem_586477")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586479, bytes_586467, "mem_586479")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586079 = 0; i_586079 < m_571906; i_586079++) {
        int64_t eta_p_571931 = ((int64_t *) mem_586468)[i_586079];
        bool x_571932 = sle64((int64_t) 0, eta_p_571931);
        bool y_571933 = slt64(eta_p_571931, dz2083U_305794);
        bool bounds_check_571934 = x_571932 && y_571933;
        bool index_certs_571935;
        
        if (!bounds_check_571934) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_571931, "] out of bounds for array of shape [", (long long) dz2083U_305794, "].", "-> #0  ftSkyline.fut:685:49-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:685:38-60\n   #3  ftSkyline.fut:828:26-29\n   #4  ftSkyline.fut:826:17-830:69\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_571937 = ((int64_t *) xys_mem_586420.mem)[eta_p_571931];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586477.mem, i_586079 * dim_305789, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, eta_p_571931 * dim_305789, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_305789});
        ((int64_t *) mem_586479.mem)[i_586079] = lifted_lambda_res_571937;
    }
    if (mem_586495_cached_sizze_588235 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586495, &mem_586495_cached_sizze_588235, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586084 = 0; i_586084 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791; i_586084++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_571949 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586084];
        double i64_res_571950 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_571949);
        double defunc_0_fover_res_571951 = 1.5707963267948966 / i64_res_571950;
        
        ((double *) mem_586495)[i_586084] = defunc_0_fover_res_571951;
    }
    if (mem_586503_cached_sizze_588236 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588236, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586508_cached_sizze_588237 < bytes_586507) {
        err = lexical_realloc(ctx, &mem_586508, &mem_586508_cached_sizze_588237, bytes_586507);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586516_cached_sizze_588238 < bytes_586507) {
        err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588238, bytes_586507);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586524_cached_sizze_588239 < bytes_586523) {
        err = lexical_realloc(ctx, &mem_586524, &mem_586524_cached_sizze_588239, bytes_586523);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586540_cached_sizze_588241 < bytes_586523) {
        err = lexical_realloc(ctx, &mem_586540, &mem_586540_cached_sizze_588241, bytes_586523);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586104 = 0; i_586104 < dz2083U_305794; i_586104++) {
        for (int64_t i_586088 = 0; i_586088 < dim_305789; i_586088++) {
            double eta_p_582612 = ((double *) xys_mem_586419.mem)[i_586104 * dim_305789 + i_586088];
            double eta_p_582613 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586088];
            double eta_p_582614 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586088];
            int64_t eta_p_582616 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586088];
            double defunc_0_f_res_582617 = eta_p_582612 - eta_p_582613;
            double defunc_0_f_res_582619 = defunc_0_f_res_582617 / eta_p_582614;
            int64_t f64_res_582621 = fptosi_f64_i64(defunc_0_f_res_582619);
            int64_t max_res_582623 = smax64((int64_t) 0, f64_res_582621);
            int64_t zm_lhs_582629 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586088];
            int64_t min_arg1_582630 = sub64(zm_lhs_582629, (int64_t) 1);
            int64_t min_res_582631 = smin64(max_res_582623, min_arg1_582630);
            int64_t defunc_0_f_res_582633 = mul64(eta_p_582616, min_res_582631);
            
            ((int64_t *) mem_586508)[i_586088] = defunc_0_f_res_582633;
        }
        
        int64_t defunc_0_foldl_res_571981;
        int64_t acc_571983 = (int64_t) 0;
        
        for (int64_t i_571982 = 0; i_571982 < dim_305789; i_571982++) {
            int64_t b_571984 = ((int64_t *) mem_586508)[i_571982];
            int64_t defunc_0_f_res_571985 = add64(acc_571983, b_571984);
            int64_t acc_tmp_588031 = defunc_0_f_res_571985;
            
            acc_571983 = acc_tmp_588031;
        }
        defunc_0_foldl_res_571981 = acc_571983;
        
        bool x_571986 = sle64((int64_t) 0, defunc_0_foldl_res_571981);
        bool y_571987 = slt64(defunc_0_foldl_res_571981, dz2080U_305790);
        bool bounds_check_571988 = x_571986 && y_571987;
        bool index_certs_571989;
        
        if (!bounds_check_571988) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_571981, "] out of bounds for array of shape [", (long long) dz2080U_305790, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:828:26-29\n   #5  ftSkyline.fut:826:17-830:69\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586092 = 0; i_586092 < dim_305789; i_586092++) {
            double eta_p_571992 = ((double *) xys_mem_586419.mem)[i_586104 * dim_305789 + i_586092];
            double eta_p_571993 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_571981 * dim_305789 + i_586092];
            double defunc_0_f_res_571994 = eta_p_571992 - eta_p_571993;
            
            ((double *) mem_586516)[i_586092] = defunc_0_f_res_571994;
        }
        for (int64_t nest_i_588033 = 0; nest_i_588033 < arg_571846; nest_i_588033++) {
            ((double *) mem_586524)[nest_i_588033] = 0.0;
        }
        for (int64_t i_571997 = 0; i_571997 < arg_571846; i_571997++) {
            bool y_571999 = slt64(i_571997, dim_305789);
            bool index_certs_572000;
            
            if (!y_571999) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_571997, "] out of bounds for array of shape [", (long long) dim_305789, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:828:26-29\n   #5  ftSkyline.fut:826:17-830:69\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_572002 = add64((int64_t) 1, i_571997);
            int64_t j_m_i_572003 = sub64(dim_305789, map_arg1_572002);
            bool empty_slice_572004 = j_m_i_572003 == (int64_t) 0;
            int64_t m_572005 = sub64(j_m_i_572003, (int64_t) 1);
            int64_t i_p_m_t_s_572006 = add64(map_arg1_572002, m_572005);
            bool zzero_leq_i_p_m_t_s_572007 = sle64((int64_t) 0, i_p_m_t_s_572006);
            bool i_p_m_t_s_leq_w_572008 = slt64(i_p_m_t_s_572006, dim_305789);
            bool zzero_lte_i_572009 = sle64((int64_t) 0, map_arg1_572002);
            bool i_lte_j_572010 = sle64(map_arg1_572002, dim_305789);
            bool y_572011 = i_p_m_t_s_leq_w_572008 && zzero_lte_i_572009;
            bool y_572012 = zzero_leq_i_p_m_t_s_572007 && y_572011;
            bool forwards_ok_572013 = i_lte_j_572010 && y_572012;
            bool ok_or_empty_572014 = empty_slice_572004 || forwards_ok_572013;
            bool index_certs_572015;
            
            if (!ok_or_empty_572014) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_572002, ":", (long long) dim_305789, "] out of bounds for array of shape [", (long long) dim_305789, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:828:26-29\n   #5  ftSkyline.fut:826:17-830:69\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586528 = (int64_t) 8 * j_m_i_572003;
            double this_x_572001 = ((double *) mem_586516)[i_571997];
            
            if (mem_586529_cached_sizze_588240 < bytes_586528) {
                err = lexical_realloc(ctx, &mem_586529, &mem_586529_cached_sizze_588240, bytes_586528);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586096 = 0; i_586096 < j_m_i_572003; i_586096++) {
                int64_t slice_586364 = map_arg1_572002 + i_586096;
                double eta_p_572018 = ((double *) mem_586516)[slice_586364];
                double defunc_0_ftimes_res_572019 = eta_p_572018 * eta_p_572018;
                
                ((double *) mem_586529)[i_586096] = defunc_0_ftimes_res_572019;
            }
            
            double defunc_0_foldl_res_572020;
            double acc_572022 = 0.0;
            
            for (int64_t i_572021 = 0; i_572021 < j_m_i_572003; i_572021++) {
                double b_572023 = ((double *) mem_586529)[i_572021];
                double defunc_0_f_res_572024 = acc_572022 + b_572023;
                double acc_tmp_588036 = defunc_0_f_res_572024;
                
                acc_572022 = acc_tmp_588036;
            }
            defunc_0_foldl_res_572020 = acc_572022;
            
            double sqrt_res_572025 = futrts_sqrt64(defunc_0_foldl_res_572020);
            double atan2_res_572026 = futrts_atan2_64(sqrt_res_572025, this_x_572001);
            
            ((double *) mem_586524)[i_571997] = atan2_res_572026;
        }
        for (int64_t i_586100 = 0; i_586100 < arg_571846; i_586100++) {
            double eta_p_572029 = ((double *) mem_586524)[i_586100];
            double eta_p_572030 = ((double *) mem_586495)[i_586100];
            int64_t eta_p_572031 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586100];
            int64_t eta_p_572032 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586100];
            double i64_res_572033 = sitofp_i64_f64(eta_p_572031);
            double defunc_0_fover_res_572034 = eta_p_572029 / eta_p_572030;
            double defunc_0_ftimes_res_572035 = i64_res_572033 * defunc_0_fover_res_572034;
            int64_t f64_res_572036 = fptosi_f64_i64(defunc_0_ftimes_res_572035);
            bool cond_572037 = slt64(f64_res_572036, (int64_t) 0);
            int64_t defunc_0_f_res_572038;
            
            if (cond_572037) {
                defunc_0_f_res_572038 = (int64_t) 0;
            } else {
                bool cond_572039 = sle64(eta_p_572032, f64_res_572036);
                int64_t defunc_0_f_res_f_res_572040;
                
                if (cond_572039) {
                    int64_t defunc_0_f_res_f_res_t_res_582661 = sub64(eta_p_572032, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_572040 = defunc_0_f_res_f_res_t_res_582661;
                } else {
                    defunc_0_f_res_f_res_572040 = f64_res_572036;
                }
                defunc_0_f_res_572038 = defunc_0_f_res_f_res_572040;
            }
            ((int64_t *) mem_586540)[i_586100] = defunc_0_f_res_572038;
        }
        
        int64_t defunc_0_foldl_res_572042;
        int64_t acc_572044 = (int64_t) 0;
        
        for (int64_t i_572043 = 0; i_572043 < arg_571846; i_572043++) {
            int64_t b_572045 = ((int64_t *) mem_586540)[i_572043];
            int64_t defunc_0_f_res_572046 = add64(acc_572044, b_572045);
            int64_t acc_tmp_588038 = defunc_0_f_res_572046;
            
            acc_572044 = acc_tmp_588038;
        }
        defunc_0_foldl_res_572042 = acc_572044;
        
        int64_t zp_lhs_572047 = mul64(total_angle_no_305801, defunc_0_foldl_res_571981);
        int64_t get_id_from_grid_angle_res_572048 = add64(defunc_0_foldl_res_572042, zp_lhs_572047);
        
        ((int64_t *) mem_586503)[i_586104] = get_id_from_grid_angle_res_572048;
    }
    if (mem_586551_cached_sizze_588242 < bytes_586550) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588242, bytes_586550);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588039 = 0; nest_i_588039 < total_part_no_305803; nest_i_588039++) {
        ((int64_t *) mem_586551)[nest_i_588039] = (int64_t) 0;
    }
    for (int64_t iter_586106 = 0; iter_586106 < m_571906; iter_586106++) {
        int64_t pixel_586108 = ((int64_t *) mem_586468)[iter_586106];
        bool x_582512 = sle64((int64_t) 0, pixel_586108);
        bool y_582513 = slt64(pixel_586108, dz2083U_305794);
        bool bounds_check_582514 = x_582512 && y_582513;
        bool index_certs_582515;
        
        if (!bounds_check_582514) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586108, "] out of bounds for array of shape [", (long long) dz2083U_305794, "].", "-> #0  ftSkyline.fut:690:49-60\n   #1  ftSkyline.fut:826:17-830:69\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586503)[pixel_586108];
        bool less_than_zzero_586110 = slt64(lifted_lambda_res_582516, (int64_t) 0);
        bool greater_than_sizze_586111 = sle64(total_part_no_305803, lifted_lambda_res_582516);
        bool outside_bounds_dim_586112 = less_than_zzero_586110 || greater_than_sizze_586111;
        
        if (!outside_bounds_dim_586112) {
            int64_t read_hist_586114 = ((int64_t *) mem_586551)[lifted_lambda_res_582516];
            int64_t defunc_0_op_res_572060 = add64((int64_t) 1, read_hist_586114);
            
            ((int64_t *) mem_586551)[lifted_lambda_res_582516] = defunc_0_op_res_572060;
        }
    }
    if (mem_586559_cached_sizze_588243 < bytes_586550) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588243, bytes_586550);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586122;
    int64_t scanacc_586118 = (int64_t) 0;
    
    for (int64_t i_586120 = 0; i_586120 < total_part_no_305803; i_586120++) {
        int64_t x_572064 = ((int64_t *) mem_586551)[i_586120];
        int64_t defunc_0_op_res_572067 = add64(x_572064, scanacc_586118);
        
        ((int64_t *) mem_586559)[i_586120] = defunc_0_op_res_572067;
        
        int64_t scanacc_tmp_588041 = defunc_0_op_res_572067;
        
        scanacc_586118 = scanacc_tmp_588041;
    }
    discard_586122 = scanacc_586118;
    if (memblock_alloc(ctx, &mem_586567, bytes_586550, "mem_586567")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586125 = 0; i_586125 < total_part_no_305803; i_586125++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586125);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_305803);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586559)[tmp_582504];
        bool cond_582507 = i_586125 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586567.mem)[i_586125] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586567, "mem_586567") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586477, "mem_586477") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586479, "mem_586479") != 0)
        return 1;
    prim_out_588011 = total_part_no_305803;
    prim_out_588012 = m_571906;
    if (memblock_set(ctx, &*mem_out_p_588224, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588225, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588226, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588227, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588228 = prim_out_588011;
    *out_prim_out_588229 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586431);
        free(mem_586438);
        free(mem_586452);
        free(mem_586454);
        free(mem_586468);
        free(mem_586495);
        free(mem_586503);
        free(mem_586508);
        free(mem_586516);
        free(mem_586524);
        free(mem_586529);
        free(mem_586540);
        free(mem_586551);
        free(mem_586559);
        if (memblock_unref(ctx, &mem_586567, "mem_586567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586427, "mem_586427") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586425, "mem_param_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586450, "ext_mem_586450") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_global_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588244, struct memblock *mem_out_p_588245, struct memblock *mem_out_p_588246, struct memblock *mem_out_p_588247, int64_t *out_prim_out_588248, int64_t *out_prim_out_588249, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_470048, int64_t dz2080U_470049, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050, int64_t dz2081U_470051, int64_t dz2082U_470052, int64_t dz2083U_470053, int64_t total_angle_no_470060, int64_t total_grid_no_470061, int64_t total_part_no_470062)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586431_cached_sizze_588250 = 0;
    unsigned char *mem_586431 = NULL;
    int64_t mem_586438_cached_sizze_588251 = 0;
    unsigned char *mem_586438 = NULL;
    int64_t mem_586452_cached_sizze_588252 = 0;
    unsigned char *mem_586452 = NULL;
    int64_t mem_586454_cached_sizze_588253 = 0;
    unsigned char *mem_586454 = NULL;
    int64_t mem_586468_cached_sizze_588254 = 0;
    unsigned char *mem_586468 = NULL;
    int64_t mem_586495_cached_sizze_588255 = 0;
    unsigned char *mem_586495 = NULL;
    int64_t mem_586503_cached_sizze_588256 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586508_cached_sizze_588257 = 0;
    unsigned char *mem_586508 = NULL;
    int64_t mem_586516_cached_sizze_588258 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586524_cached_sizze_588259 = 0;
    unsigned char *mem_586524 = NULL;
    int64_t mem_586529_cached_sizze_588260 = 0;
    unsigned char *mem_586529 = NULL;
    int64_t mem_586540_cached_sizze_588261 = 0;
    unsigned char *mem_586540 = NULL;
    int64_t mem_586551_cached_sizze_588262 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586559_cached_sizze_588263 = 0;
    unsigned char *mem_586559 = NULL;
    struct memblock mem_586567;
    
    mem_586567.references = NULL;
    
    struct memblock mem_586479;
    
    mem_586479.references = NULL;
    
    struct memblock mem_586477;
    
    mem_586477.references = NULL;
    
    struct memblock mem_param_tmp_588015;
    
    mem_param_tmp_588015.references = NULL;
    
    struct memblock mem_586427;
    
    mem_586427.references = NULL;
    
    struct memblock mem_param_586425;
    
    mem_param_586425.references = NULL;
    
    struct memblock ext_mem_586450;
    
    ext_mem_586450.references = NULL;
    
    struct memblock mem_586422;
    
    mem_586422.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_571846 = sub64(dim_470048, (int64_t) 1);
    bool assert_cond_571847 = arg_571846 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050;
    bool assert_c_571848;
    
    if (!assert_cond_571847) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:975:26-977:44\n   #1  ftSkyline.fut:973:17-977:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586421 = (int64_t) 8 * dz2083U_470053;
    
    if (memblock_alloc(ctx, &mem_586422, bytes_586421, "mem_586422")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_588013 = 0; i_588013 < dz2083U_470053; i_588013++) {
        int64_t x_588014 = (int64_t) 0 + i_588013 * (int64_t) 1;
        
        ((int64_t *) mem_586422.mem)[i_588013] = x_588014;
    }
    if (memblock_set(ctx, &mem_param_586425, &mem_586422, "mem_586422") != 0)
        return 1;
    for (int64_t i_571851 = 0; i_571851 < dz2083U_470053; i_571851++) {
        if (memblock_alloc(ctx, &mem_586427, bytes_586421, "mem_586427")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586058 = 0; i_586058 < dz2083U_470053; i_586058++) {
            int64_t eta_p_571855 = ((int64_t *) mem_param_586425.mem)[i_586058];
            bool cond_571856 = slt64(eta_p_571855, (int64_t) 0);
            bool cond_f_res_571857 = eta_p_571855 == i_571851;
            bool x_571858 = !cond_571856;
            bool y_571859 = cond_f_res_571857 && x_571858;
            bool cond_571860 = cond_571856 || y_571859;
            int64_t defunc_0_f_res_571861;
            
            if (cond_571860) {
                defunc_0_f_res_571861 = eta_p_571855;
            } else {
                bool x_571862 = sle64((int64_t) 0, eta_p_571855);
                bool y_571863 = slt64(eta_p_571855, dz2083U_470053);
                bool bounds_check_571864 = x_571862 && y_571863;
                bool index_certs_571865;
                
                if (!bounds_check_571864) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_571855, "] out of bounds for array of shape [", (long long) dz2083U_470053, "].", "-> #0  ftSkyline.fut:676:46-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:975:26-29\n   #3  ftSkyline.fut:973:17-977:68\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (mem_586431_cached_sizze_588250 < dim_470048) {
                    err = lexical_realloc(ctx, &mem_586431, &mem_586431_cached_sizze_588250, dim_470048);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586050 = 0; i_586050 < dim_470048; i_586050++) {
                    float eta_p_571868 = ((float *) xys_mem_586419.mem)[eta_p_571855 * dim_470048 + i_586050];
                    float eta_p_571869 = ((float *) xys_mem_586419.mem)[i_571851 * dim_470048 + i_586050];
                    bool defunc_0_f_res_571870 = eta_p_571869 <= eta_p_571868;
                    
                    ((bool *) mem_586431)[i_586050] = defunc_0_f_res_571870;
                }
                
                bool defunc_0_foldl_res_571871;
                bool acc_571873 = 1;
                
                for (int64_t i_571872 = 0; i_571872 < dim_470048; i_571872++) {
                    bool b_571874 = ((bool *) mem_586431)[i_571872];
                    bool x_571875 = acc_571873 && b_571874;
                    bool acc_tmp_588019 = x_571875;
                    
                    acc_571873 = acc_tmp_588019;
                }
                defunc_0_foldl_res_571871 = acc_571873;
                
                bool elimd_571876;
                
                if (defunc_0_foldl_res_571871) {
                    if (mem_586438_cached_sizze_588251 < dim_470048) {
                        err = lexical_realloc(ctx, &mem_586438, &mem_586438_cached_sizze_588251, dim_470048);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586054 = 0; i_586054 < dim_470048; i_586054++) {
                        float eta_p_582646 = ((float *) xys_mem_586419.mem)[eta_p_571855 * dim_470048 + i_586054];
                        float eta_p_582647 = ((float *) xys_mem_586419.mem)[i_571851 * dim_470048 + i_586054];
                        bool defunc_0_f_res_582648 = eta_p_582647 < eta_p_582646;
                        
                        ((bool *) mem_586438)[i_586054] = defunc_0_f_res_582648;
                    }
                    
                    bool defunc_0_foldl_res_582650;
                    bool acc_582652 = 0;
                    
                    for (int64_t i_582651 = 0; i_582651 < dim_470048; i_582651++) {
                        bool b_582653 = ((bool *) mem_586438)[i_582651];
                        bool defunc_0_f_res_582654 = acc_582652 || b_582653;
                        bool acc_tmp_588021 = defunc_0_f_res_582654;
                        
                        acc_582652 = acc_tmp_588021;
                    }
                    defunc_0_foldl_res_582650 = acc_582652;
                    elimd_571876 = defunc_0_foldl_res_582650;
                } else {
                    elimd_571876 = 0;
                }
                
                int64_t defunc_0_f_res_f_res_571886;
                
                if (elimd_571876) {
                    defunc_0_f_res_f_res_571886 = (int64_t) -1;
                } else {
                    defunc_0_f_res_f_res_571886 = eta_p_571855;
                }
                defunc_0_f_res_571861 = defunc_0_f_res_f_res_571886;
            }
            ((int64_t *) mem_586427.mem)[i_586058] = defunc_0_f_res_571861;
        }
        if (memblock_set(ctx, &mem_param_tmp_588015, &mem_586427, "mem_586427") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586425, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_586450, &mem_param_586425, "mem_param_586425") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
        return 1;
    if (mem_586452_cached_sizze_588252 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586452, &mem_586452_cached_sizze_588252, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586454_cached_sizze_588253 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586454, &mem_586454_cached_sizze_588253, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586068;
    int64_t scanacc_586062 = (int64_t) 0;
    
    for (int64_t i_586065 = 0; i_586065 < dz2083U_470053; i_586065++) {
        int64_t eta_p_582527 = ((int64_t *) ext_mem_586450.mem)[i_586065];
        bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
        int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
        int64_t defunc_0_op_res_571895 = add64(defunc_0_f_res_582529, scanacc_586062);
        
        ((int64_t *) mem_586452)[i_586065] = defunc_0_op_res_571895;
        ((int64_t *) mem_586454)[i_586065] = defunc_0_f_res_582529;
        
        int64_t scanacc_tmp_588022 = defunc_0_op_res_571895;
        
        scanacc_586062 = scanacc_tmp_588022;
    }
    discard_586068 = scanacc_586062;
    
    bool cond_571896 = dz2083U_470053 == (int64_t) 0;
    bool x_571897 = !cond_571896;
    int64_t tmp_571898 = sub64(dz2083U_470053, (int64_t) 1);
    bool x_571899 = sle64((int64_t) 0, tmp_571898);
    bool y_571900 = slt64(tmp_571898, dz2083U_470053);
    bool bounds_check_571901 = x_571899 && y_571900;
    bool protect_assert_disj_571902 = cond_571896 || bounds_check_571901;
    bool index_certs_571903;
    
    if (!protect_assert_disj_571902) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_571898, "] out of bounds for array of shape [", (long long) dz2083U_470053, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:975:26-29\n   #3  ftSkyline.fut:973:17-977:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_571904;
    
    if (x_571897) {
        int64_t x_582657 = ((int64_t *) mem_586452)[tmp_571898];
        
        m_f_res_571904 = x_582657;
    } else {
        m_f_res_571904 = (int64_t) 0;
    }
    
    int64_t m_571906;
    
    if (cond_571896) {
        m_571906 = (int64_t) 0;
    } else {
        m_571906 = m_f_res_571904;
    }
    
    int64_t m_571916 = sub64(m_571906, (int64_t) 1);
    bool i_p_m_t_s_leq_w_571918 = slt64(m_571916, dz2083U_470053);
    bool zzero_leq_i_p_m_t_s_571917 = sle64((int64_t) 0, m_571916);
    bool y_571920 = zzero_leq_i_p_m_t_s_571917 && i_p_m_t_s_leq_w_571918;
    bool i_lte_j_571919 = sle64((int64_t) 0, m_571906);
    bool forwards_ok_571921 = i_lte_j_571919 && y_571920;
    bool eq_x_zz_571913 = (int64_t) 0 == m_f_res_571904;
    bool p_and_eq_x_y_571914 = x_571897 && eq_x_zz_571913;
    bool empty_slice_571915 = cond_571896 || p_and_eq_x_y_571914;
    bool ok_or_empty_571922 = empty_slice_571915 || forwards_ok_571921;
    bool index_certs_571923;
    
    if (!ok_or_empty_571922) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_571906, "] out of bounds for array of shape [", (long long) dz2083U_470053, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:975:26-29\n   #3  ftSkyline.fut:973:17-977:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586467 = (int64_t) 8 * m_571906;
    int64_t binop_x_586475 = (int64_t) 4 * m_571906;
    int64_t bytes_586476 = dim_470048 * binop_x_586475;
    bool y_571938 = slt64((int64_t) 0, dz2080U_470049);
    bool index_certs_571939;
    
    if (!y_571938) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_470049, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:975:26-29\n   #5  ftSkyline.fut:973:17-977:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586494 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050;
    bool empty_or_match_cert_571953;
    
    if (!assert_cond_571847) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:975:26-29\n   #5  ftSkyline.fut:973:17-977:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586507 = (int64_t) 8 * dim_470048;
    int64_t bytes_586515 = (int64_t) 4 * dim_470048;
    int64_t bytes_586523 = (int64_t) 4 * arg_571846;
    int64_t bytes_586539 = (int64_t) 8 * arg_571846;
    int64_t bytes_586550 = (int64_t) 8 * total_part_no_470062;
    
    if (mem_586468_cached_sizze_588254 < bytes_586467) {
        err = lexical_realloc(ctx, &mem_586468, &mem_586468_cached_sizze_588254, bytes_586467);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586468, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586450.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_571906});
    for (int64_t write_iter_586069 = 0; write_iter_586069 < dz2083U_470053; write_iter_586069++) {
        int64_t write_iv_586071 = ((int64_t *) mem_586454)[write_iter_586069];
        int64_t write_iv_586072 = ((int64_t *) mem_586452)[write_iter_586069];
        int64_t write_iv_586073 = ((int64_t *) ext_mem_586450.mem)[write_iter_586069];
        bool cond_582522 = write_iv_586071 == (int64_t) 1;
        int64_t lifted_lambda_res_582523;
        
        if (cond_582522) {
            int64_t lifted_lambda_res_t_res_582658 = sub64(write_iv_586072, (int64_t) 1);
            
            lifted_lambda_res_582523 = lifted_lambda_res_t_res_582658;
        } else {
            lifted_lambda_res_582523 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_571906)) {
            ((int64_t *) mem_586468)[lifted_lambda_res_582523] = write_iv_586073;
        }
    }
    if (memblock_unref(ctx, &ext_mem_586450, "ext_mem_586450") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_586477, bytes_586476, "mem_586477")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586479, bytes_586467, "mem_586479")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586079 = 0; i_586079 < m_571906; i_586079++) {
        int64_t eta_p_571931 = ((int64_t *) mem_586468)[i_586079];
        bool x_571932 = sle64((int64_t) 0, eta_p_571931);
        bool y_571933 = slt64(eta_p_571931, dz2083U_470053);
        bool bounds_check_571934 = x_571932 && y_571933;
        bool index_certs_571935;
        
        if (!bounds_check_571934) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_571931, "] out of bounds for array of shape [", (long long) dz2083U_470053, "].", "-> #0  ftSkyline.fut:685:49-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:685:38-60\n   #3  ftSkyline.fut:975:26-29\n   #4  ftSkyline.fut:973:17-977:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_571937 = ((int64_t *) xys_mem_586420.mem)[eta_p_571931];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586477.mem, i_586079 * dim_470048, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, eta_p_571931 * dim_470048, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_470048});
        ((int64_t *) mem_586479.mem)[i_586079] = lifted_lambda_res_571937;
    }
    if (mem_586495_cached_sizze_588255 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586495, &mem_586495_cached_sizze_588255, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586084 = 0; i_586084 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050; i_586084++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_571949 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586084];
        float i64_res_571950 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_571949);
        float defunc_0_fover_res_571951 = 1.5707964F / i64_res_571950;
        
        ((float *) mem_586495)[i_586084] = defunc_0_fover_res_571951;
    }
    if (mem_586503_cached_sizze_588256 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588256, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586508_cached_sizze_588257 < bytes_586507) {
        err = lexical_realloc(ctx, &mem_586508, &mem_586508_cached_sizze_588257, bytes_586507);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586516_cached_sizze_588258 < bytes_586515) {
        err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588258, bytes_586515);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586524_cached_sizze_588259 < bytes_586523) {
        err = lexical_realloc(ctx, &mem_586524, &mem_586524_cached_sizze_588259, bytes_586523);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586540_cached_sizze_588261 < bytes_586539) {
        err = lexical_realloc(ctx, &mem_586540, &mem_586540_cached_sizze_588261, bytes_586539);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586104 = 0; i_586104 < dz2083U_470053; i_586104++) {
        for (int64_t i_586088 = 0; i_586088 < dim_470048; i_586088++) {
            float eta_p_582612 = ((float *) xys_mem_586419.mem)[i_586104 * dim_470048 + i_586088];
            float eta_p_582613 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586088];
            float eta_p_582614 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586088];
            int64_t eta_p_582616 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586088];
            float defunc_0_f_res_582617 = eta_p_582612 - eta_p_582613;
            float defunc_0_f_res_582619 = defunc_0_f_res_582617 / eta_p_582614;
            int64_t f32_res_582621 = fptosi_f32_i64(defunc_0_f_res_582619);
            int64_t max_res_582623 = smax64((int64_t) 0, f32_res_582621);
            int64_t zm_lhs_582629 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586088];
            int64_t min_arg1_582630 = sub64(zm_lhs_582629, (int64_t) 1);
            int64_t min_res_582631 = smin64(max_res_582623, min_arg1_582630);
            int64_t defunc_0_f_res_582633 = mul64(eta_p_582616, min_res_582631);
            
            ((int64_t *) mem_586508)[i_586088] = defunc_0_f_res_582633;
        }
        
        int64_t defunc_0_foldl_res_571981;
        int64_t acc_571983 = (int64_t) 0;
        
        for (int64_t i_571982 = 0; i_571982 < dim_470048; i_571982++) {
            int64_t b_571984 = ((int64_t *) mem_586508)[i_571982];
            int64_t defunc_0_f_res_571985 = add64(acc_571983, b_571984);
            int64_t acc_tmp_588031 = defunc_0_f_res_571985;
            
            acc_571983 = acc_tmp_588031;
        }
        defunc_0_foldl_res_571981 = acc_571983;
        
        bool x_571986 = sle64((int64_t) 0, defunc_0_foldl_res_571981);
        bool y_571987 = slt64(defunc_0_foldl_res_571981, dz2080U_470049);
        bool bounds_check_571988 = x_571986 && y_571987;
        bool index_certs_571989;
        
        if (!bounds_check_571988) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_571981, "] out of bounds for array of shape [", (long long) dz2080U_470049, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:975:26-29\n   #5  ftSkyline.fut:973:17-977:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586092 = 0; i_586092 < dim_470048; i_586092++) {
            float eta_p_571992 = ((float *) xys_mem_586419.mem)[i_586104 * dim_470048 + i_586092];
            float eta_p_571993 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_571981 * dim_470048 + i_586092];
            float defunc_0_f_res_571994 = eta_p_571992 - eta_p_571993;
            
            ((float *) mem_586516)[i_586092] = defunc_0_f_res_571994;
        }
        for (int64_t nest_i_588033 = 0; nest_i_588033 < arg_571846; nest_i_588033++) {
            ((float *) mem_586524)[nest_i_588033] = 0.0F;
        }
        for (int64_t i_571997 = 0; i_571997 < arg_571846; i_571997++) {
            bool y_571999 = slt64(i_571997, dim_470048);
            bool index_certs_572000;
            
            if (!y_571999) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_571997, "] out of bounds for array of shape [", (long long) dim_470048, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:975:26-29\n   #5  ftSkyline.fut:973:17-977:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_572002 = add64((int64_t) 1, i_571997);
            int64_t j_m_i_572003 = sub64(dim_470048, map_arg1_572002);
            bool empty_slice_572004 = j_m_i_572003 == (int64_t) 0;
            int64_t m_572005 = sub64(j_m_i_572003, (int64_t) 1);
            int64_t i_p_m_t_s_572006 = add64(map_arg1_572002, m_572005);
            bool zzero_leq_i_p_m_t_s_572007 = sle64((int64_t) 0, i_p_m_t_s_572006);
            bool i_p_m_t_s_leq_w_572008 = slt64(i_p_m_t_s_572006, dim_470048);
            bool zzero_lte_i_572009 = sle64((int64_t) 0, map_arg1_572002);
            bool i_lte_j_572010 = sle64(map_arg1_572002, dim_470048);
            bool y_572011 = i_p_m_t_s_leq_w_572008 && zzero_lte_i_572009;
            bool y_572012 = zzero_leq_i_p_m_t_s_572007 && y_572011;
            bool forwards_ok_572013 = i_lte_j_572010 && y_572012;
            bool ok_or_empty_572014 = empty_slice_572004 || forwards_ok_572013;
            bool index_certs_572015;
            
            if (!ok_or_empty_572014) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_572002, ":", (long long) dim_470048, "] out of bounds for array of shape [", (long long) dim_470048, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:689:103-104\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:975:26-29\n   #5  ftSkyline.fut:973:17-977:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586528 = (int64_t) 4 * j_m_i_572003;
            float this_x_572001 = ((float *) mem_586516)[i_571997];
            
            if (mem_586529_cached_sizze_588260 < bytes_586528) {
                err = lexical_realloc(ctx, &mem_586529, &mem_586529_cached_sizze_588260, bytes_586528);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586096 = 0; i_586096 < j_m_i_572003; i_586096++) {
                int64_t slice_586364 = map_arg1_572002 + i_586096;
                float eta_p_572018 = ((float *) mem_586516)[slice_586364];
                float defunc_0_ftimes_res_572019 = eta_p_572018 * eta_p_572018;
                
                ((float *) mem_586529)[i_586096] = defunc_0_ftimes_res_572019;
            }
            
            float defunc_0_foldl_res_572020;
            float acc_572022 = 0.0F;
            
            for (int64_t i_572021 = 0; i_572021 < j_m_i_572003; i_572021++) {
                float b_572023 = ((float *) mem_586529)[i_572021];
                float defunc_0_f_res_572024 = acc_572022 + b_572023;
                float acc_tmp_588036 = defunc_0_f_res_572024;
                
                acc_572022 = acc_tmp_588036;
            }
            defunc_0_foldl_res_572020 = acc_572022;
            
            float sqrt_res_572025 = futrts_sqrt32(defunc_0_foldl_res_572020);
            float atan2_res_572026 = futrts_atan2_32(sqrt_res_572025, this_x_572001);
            
            ((float *) mem_586524)[i_571997] = atan2_res_572026;
        }
        for (int64_t i_586100 = 0; i_586100 < arg_571846; i_586100++) {
            float eta_p_572029 = ((float *) mem_586524)[i_586100];
            float eta_p_572030 = ((float *) mem_586495)[i_586100];
            int64_t eta_p_572031 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586100];
            int64_t eta_p_572032 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586100];
            float i64_res_572033 = sitofp_i64_f32(eta_p_572031);
            float defunc_0_fover_res_572034 = eta_p_572029 / eta_p_572030;
            float defunc_0_ftimes_res_572035 = i64_res_572033 * defunc_0_fover_res_572034;
            int64_t f32_res_572036 = fptosi_f32_i64(defunc_0_ftimes_res_572035);
            bool cond_572037 = slt64(f32_res_572036, (int64_t) 0);
            int64_t defunc_0_f_res_572038;
            
            if (cond_572037) {
                defunc_0_f_res_572038 = (int64_t) 0;
            } else {
                bool cond_572039 = sle64(eta_p_572032, f32_res_572036);
                int64_t defunc_0_f_res_f_res_572040;
                
                if (cond_572039) {
                    int64_t defunc_0_f_res_f_res_t_res_582661 = sub64(eta_p_572032, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_572040 = defunc_0_f_res_f_res_t_res_582661;
                } else {
                    defunc_0_f_res_f_res_572040 = f32_res_572036;
                }
                defunc_0_f_res_572038 = defunc_0_f_res_f_res_572040;
            }
            ((int64_t *) mem_586540)[i_586100] = defunc_0_f_res_572038;
        }
        
        int64_t defunc_0_foldl_res_572042;
        int64_t acc_572044 = (int64_t) 0;
        
        for (int64_t i_572043 = 0; i_572043 < arg_571846; i_572043++) {
            int64_t b_572045 = ((int64_t *) mem_586540)[i_572043];
            int64_t defunc_0_f_res_572046 = add64(acc_572044, b_572045);
            int64_t acc_tmp_588038 = defunc_0_f_res_572046;
            
            acc_572044 = acc_tmp_588038;
        }
        defunc_0_foldl_res_572042 = acc_572044;
        
        int64_t zp_lhs_572047 = mul64(total_angle_no_470060, defunc_0_foldl_res_571981);
        int64_t get_id_from_grid_angle_res_572048 = add64(defunc_0_foldl_res_572042, zp_lhs_572047);
        
        ((int64_t *) mem_586503)[i_586104] = get_id_from_grid_angle_res_572048;
    }
    if (mem_586551_cached_sizze_588262 < bytes_586550) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588262, bytes_586550);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588039 = 0; nest_i_588039 < total_part_no_470062; nest_i_588039++) {
        ((int64_t *) mem_586551)[nest_i_588039] = (int64_t) 0;
    }
    for (int64_t iter_586106 = 0; iter_586106 < m_571906; iter_586106++) {
        int64_t pixel_586108 = ((int64_t *) mem_586468)[iter_586106];
        bool x_582512 = sle64((int64_t) 0, pixel_586108);
        bool y_582513 = slt64(pixel_586108, dz2083U_470053);
        bool bounds_check_582514 = x_582512 && y_582513;
        bool index_certs_582515;
        
        if (!bounds_check_582514) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586108, "] out of bounds for array of shape [", (long long) dz2083U_470053, "].", "-> #0  ftSkyline.fut:690:49-60\n   #1  ftSkyline.fut:973:17-977:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586503)[pixel_586108];
        bool less_than_zzero_586110 = slt64(lifted_lambda_res_582516, (int64_t) 0);
        bool greater_than_sizze_586111 = sle64(total_part_no_470062, lifted_lambda_res_582516);
        bool outside_bounds_dim_586112 = less_than_zzero_586110 || greater_than_sizze_586111;
        
        if (!outside_bounds_dim_586112) {
            int64_t read_hist_586114 = ((int64_t *) mem_586551)[lifted_lambda_res_582516];
            int64_t defunc_0_op_res_572060 = add64((int64_t) 1, read_hist_586114);
            
            ((int64_t *) mem_586551)[lifted_lambda_res_582516] = defunc_0_op_res_572060;
        }
    }
    if (mem_586559_cached_sizze_588263 < bytes_586550) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588263, bytes_586550);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586122;
    int64_t scanacc_586118 = (int64_t) 0;
    
    for (int64_t i_586120 = 0; i_586120 < total_part_no_470062; i_586120++) {
        int64_t x_572064 = ((int64_t *) mem_586551)[i_586120];
        int64_t defunc_0_op_res_572067 = add64(x_572064, scanacc_586118);
        
        ((int64_t *) mem_586559)[i_586120] = defunc_0_op_res_572067;
        
        int64_t scanacc_tmp_588041 = defunc_0_op_res_572067;
        
        scanacc_586118 = scanacc_tmp_588041;
    }
    discard_586122 = scanacc_586118;
    if (memblock_alloc(ctx, &mem_586567, bytes_586550, "mem_586567")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586125 = 0; i_586125 < total_part_no_470062; i_586125++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586125);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_470062);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586559)[tmp_582504];
        bool cond_582507 = i_586125 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586567.mem)[i_586125] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586567, "mem_586567") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586477, "mem_586477") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586479, "mem_586479") != 0)
        return 1;
    prim_out_588011 = total_part_no_470062;
    prim_out_588012 = m_571906;
    if (memblock_set(ctx, &*mem_out_p_588244, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588245, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588246, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588247, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588248 = prim_out_588011;
    *out_prim_out_588249 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586431);
        free(mem_586438);
        free(mem_586452);
        free(mem_586454);
        free(mem_586468);
        free(mem_586495);
        free(mem_586503);
        free(mem_586508);
        free(mem_586516);
        free(mem_586524);
        free(mem_586529);
        free(mem_586540);
        free(mem_586551);
        free(mem_586559);
        if (memblock_unref(ctx, &mem_586567, "mem_586567") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586427, "mem_586427") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586425, "mem_param_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586450, "ext_mem_586450") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_intermSkyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588264, struct memblock *mem_out_p_588265, struct memblock *mem_out_p_588266, struct memblock *mem_out_p_588267, int64_t *out_prim_out_588268, int64_t *out_prim_out_588269, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_396635, int64_t dz2080U_396636, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637, int64_t dz2081U_396638, int64_t dz2082U_396639, int64_t dz2083U_396640, int64_t total_angle_no_396647, int64_t total_grid_no_396648, int64_t total_part_no_396649, bool include_angle_steps_396654, int64_t omit_step_396655, int64_t max_steps_396656, int64_t sizze_thresh_396657)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586451_cached_sizze_588270 = 0;
    unsigned char *mem_586451 = NULL;
    int64_t mem_586453_cached_sizze_588271 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586475_cached_sizze_588272 = 0;
    unsigned char *mem_586475 = NULL;
    int64_t mem_586515_cached_sizze_588273 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586517_cached_sizze_588274 = 0;
    unsigned char *mem_586517 = NULL;
    int64_t mem_586538_cached_sizze_588275 = 0;
    unsigned char *mem_586538 = NULL;
    int64_t mem_586548_cached_sizze_588276 = 0;
    unsigned char *mem_586548 = NULL;
    int64_t mem_586550_cached_sizze_588277 = 0;
    unsigned char *mem_586550 = NULL;
    int64_t mem_586564_cached_sizze_588278 = 0;
    unsigned char *mem_586564 = NULL;
    int64_t mem_586577_cached_sizze_588279 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586590_cached_sizze_588280 = 0;
    unsigned char *mem_586590 = NULL;
    int64_t mem_586598_cached_sizze_588281 = 0;
    unsigned char *mem_586598 = NULL;
    int64_t mem_586606_cached_sizze_588282 = 0;
    unsigned char *mem_586606 = NULL;
    int64_t mem_586611_cached_sizze_588283 = 0;
    unsigned char *mem_586611 = NULL;
    int64_t mem_586622_cached_sizze_588284 = 0;
    unsigned char *mem_586622 = NULL;
    int64_t mem_586629_cached_sizze_588285 = 0;
    unsigned char *mem_586629 = NULL;
    int64_t mem_586636_cached_sizze_588286 = 0;
    unsigned char *mem_586636 = NULL;
    int64_t mem_586650_cached_sizze_588287 = 0;
    unsigned char *mem_586650 = NULL;
    int64_t mem_586652_cached_sizze_588288 = 0;
    unsigned char *mem_586652 = NULL;
    int64_t mem_586666_cached_sizze_588289 = 0;
    unsigned char *mem_586666 = NULL;
    int64_t mem_586693_cached_sizze_588290 = 0;
    unsigned char *mem_586693 = NULL;
    int64_t mem_586698_cached_sizze_588291 = 0;
    unsigned char *mem_586698 = NULL;
    int64_t mem_586706_cached_sizze_588292 = 0;
    unsigned char *mem_586706 = NULL;
    int64_t mem_586714_cached_sizze_588293 = 0;
    unsigned char *mem_586714 = NULL;
    int64_t mem_586719_cached_sizze_588294 = 0;
    unsigned char *mem_586719 = NULL;
    int64_t mem_586730_cached_sizze_588295 = 0;
    unsigned char *mem_586730 = NULL;
    int64_t mem_586741_cached_sizze_588296 = 0;
    unsigned char *mem_586741 = NULL;
    int64_t mem_586749_cached_sizze_588297 = 0;
    unsigned char *mem_586749 = NULL;
    struct memblock mem_param_tmp_588021;
    
    mem_param_tmp_588021.references = NULL;
    
    struct memblock mem_param_tmp_588020;
    
    mem_param_tmp_588020.references = NULL;
    
    struct memblock mem_param_tmp_588019;
    
    mem_param_tmp_588019.references = NULL;
    
    struct memblock mem_param_tmp_588018;
    
    mem_param_tmp_588018.references = NULL;
    
    struct memblock mem_param_tmp_588017;
    
    mem_param_tmp_588017.references = NULL;
    
    struct memblock mem_param_tmp_588016;
    
    mem_param_tmp_588016.references = NULL;
    
    struct memblock mem_param_tmp_588015;
    
    mem_param_tmp_588015.references = NULL;
    
    struct memblock mem_param_tmp_588014;
    
    mem_param_tmp_588014.references = NULL;
    
    struct memblock mem_param_tmp_588013;
    
    mem_param_tmp_588013.references = NULL;
    
    struct memblock mem_586757;
    
    mem_586757.references = NULL;
    
    struct memblock mem_586677;
    
    mem_586677.references = NULL;
    
    struct memblock mem_586675;
    
    mem_586675.references = NULL;
    
    struct memblock mem_param_tmp_588063;
    
    mem_param_tmp_588063.references = NULL;
    
    struct memblock mem_586585;
    
    mem_586585.references = NULL;
    
    struct memblock mem_param_586575;
    
    mem_param_586575.references = NULL;
    
    struct memblock ext_mem_586648;
    
    ext_mem_586648.references = NULL;
    
    struct memblock mem_586572;
    
    mem_586572.references = NULL;
    
    struct memblock mem_586532;
    
    mem_586532.references = NULL;
    
    struct memblock ext_mem_586546;
    
    ext_mem_586546.references = NULL;
    
    struct memblock mem_586507;
    
    mem_586507.references = NULL;
    
    struct memblock mem_586499;
    
    mem_586499.references = NULL;
    
    struct memblock mem_586479;
    
    mem_586479.references = NULL;
    
    struct memblock mem_586477;
    
    mem_586477.references = NULL;
    
    struct memblock mem_586455;
    
    mem_586455.references = NULL;
    
    struct memblock mem_param_586449;
    
    mem_param_586449.references = NULL;
    
    struct memblock mem_param_586446;
    
    mem_param_586446.references = NULL;
    
    struct memblock mem_param_586442;
    
    mem_param_586442.references = NULL;
    
    struct memblock mem_param_586439;
    
    mem_param_586439.references = NULL;
    
    struct memblock mem_param_586435;
    
    mem_param_586435.references = NULL;
    
    struct memblock mem_param_586432;
    
    mem_param_586432.references = NULL;
    
    struct memblock mem_param_586429;
    
    mem_param_586429.references = NULL;
    
    struct memblock mem_param_586426;
    
    mem_param_586426.references = NULL;
    
    struct memblock mem_param_586423;
    
    mem_param_586423.references = NULL;
    
    struct memblock ext_mem_586784;
    
    ext_mem_586784.references = NULL;
    
    struct memblock ext_mem_586785;
    
    ext_mem_586785.references = NULL;
    
    struct memblock ext_mem_586786;
    
    ext_mem_586786.references = NULL;
    
    struct memblock ext_mem_586787;
    
    ext_mem_586787.references = NULL;
    
    struct memblock ext_mem_586788;
    
    ext_mem_586788.references = NULL;
    
    struct memblock ext_mem_586789;
    
    ext_mem_586789.references = NULL;
    
    struct memblock ext_mem_586790;
    
    ext_mem_586790.references = NULL;
    
    struct memblock ext_mem_586791;
    
    ext_mem_586791.references = NULL;
    
    struct memblock ext_mem_586792;
    
    ext_mem_586792.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_572688 = sub64(dim_396635, (int64_t) 1);
    bool assert_cond_572689 = arg_572688 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637;
    bool assert_c_572690;
    
    if (!assert_cond_572689) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:876:25-127\n   #1  ftSkyline.fut:868:17-876:127\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_572691;
    
    if (include_angle_steps_396654) {
        tmp_572691 = (int64_t) 0;
    } else {
        tmp_572691 = dim_396635;
    }
    
    int64_t zl_rhs_572692 = add64(dim_396635, max_steps_396656);
    bool cond_572693 = slt64(tmp_572691, zl_rhs_572692);
    int64_t zt_lhs_572694 = sub64(tmp_572691, (int64_t) 1);
    int64_t zl_lhs_572695 = mul64(omit_step_396655, zt_lhs_572694);
    int64_t zm_lhs_572696 = mul64((int64_t) 2, dim_396635);
    int64_t zl_rhs_572697 = sub64(zm_lhs_572696, (int64_t) 1);
    bool cond_t_res_572698 = slt64(zl_lhs_572695, zl_rhs_572697);
    bool x_572699 = cond_572693 && cond_t_res_572698;
    bool loop_cond_t_res_572700 = slt64(sizze_thresh_396657, dz2083U_396640);
    bool x_572701 = x_572699 && loop_cond_t_res_572700;
    bool y_572706 = slt64((int64_t) 0, dz2080U_396636);
    bool loop_not_taken_572707 = !x_572701;
    bool protect_assert_disj_572708 = y_572706 || loop_not_taken_572707;
    bool index_certs_572709;
    
    if (!protect_assert_disj_572708) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_396636, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:876:116-127\n   #5  ftSkyline.fut:868:17-876:127\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_572710 = assert_cond_572689 || loop_not_taken_572707;
    bool empty_or_match_cert_572711;
    
    if (!protect_assert_disj_572710) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:876:116-127\n   #5  ftSkyline.fut:868:17-876:127\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_572714 = slt64(total_part_no_396649, (int64_t) 0);
    bool valid_572715 = !bounds_invalid_upwards_572714;
    bool protect_assert_disj_572716 = loop_not_taken_572707 || valid_572715;
    bool range_valid_c_572717;
    
    if (!protect_assert_disj_572716) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_396649, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:417:98-116\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586450 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637;
    int64_t bytes_586474 = (int64_t) 8 * dim_396635;
    int64_t bytes_586605 = (int64_t) 8 * arg_572688;
    int64_t bytes_586740 = (int64_t) 8 * total_part_no_396649;
    
    if (mem_586451_cached_sizze_588270 < bytes_586450) {
        err = lexical_realloc(ctx, &mem_586451, &mem_586451_cached_sizze_588270, bytes_586450);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586453_cached_sizze_588271 < bytes_586450) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588271, bytes_586450);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586475_cached_sizze_588272 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586475, &mem_586475_cached_sizze_588272, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586577_cached_sizze_588279 < bytes_586450) {
        err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588279, bytes_586450);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586590_cached_sizze_588280 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586590, &mem_586590_cached_sizze_588280, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586598_cached_sizze_588281 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586598, &mem_586598_cached_sizze_588281, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586606_cached_sizze_588282 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586606, &mem_586606_cached_sizze_588282, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586622_cached_sizze_588284 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586622, &mem_586622_cached_sizze_588284, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586698_cached_sizze_588291 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586698, &mem_586698_cached_sizze_588291, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586706_cached_sizze_588292 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586706, &mem_586706_cached_sizze_588292, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586714_cached_sizze_588293 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586714, &mem_586714_cached_sizze_588293, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586730_cached_sizze_588295 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586730, &mem_586730_cached_sizze_588295, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586741_cached_sizze_588296 < bytes_586740) {
        err = lexical_realloc(ctx, &mem_586741, &mem_586741_cached_sizze_588296, bytes_586740);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586749_cached_sizze_588297 < bytes_586740) {
        err = lexical_realloc(ctx, &mem_586749, &mem_586749_cached_sizze_588297, bytes_586740);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t defunc_0_calc_intermediate_skyline_res_572719;
    int64_t defunc_0_calc_intermediate_skyline_res_572720;
    int64_t defunc_0_calc_intermediate_skyline_res_572721;
    bool defunc_0_calc_intermediate_skyline_res_572722;
    int64_t defunc_0_calc_intermediate_skyline_res_572729;
    int64_t defunc_0_calc_intermediate_skyline_res_572730;
    int64_t defunc_0_calc_intermediate_skyline_res_572734;
    int64_t defunc_0_calc_intermediate_skyline_res_572735;
    int64_t loop_dz2087U_572736;
    int64_t loop_dz2081Uz2080U_572737;
    int64_t loop_dz2081Uz2081U_572738;
    bool loop_while_572739;
    int64_t sd_skB_572746;
    int64_t sd_skB_572747;
    int64_t i_572751;
    int64_t acc_sd_572752;
    
    if (memblock_set(ctx, &mem_param_586423, &angle_part_prefix_sum_mem_586411, "angle_part_prefix_sum_mem_586411") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586426, &angle_partitions_per_dim_mem_586412, "angle_partitions_per_dim_mem_586412") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586429, &grid_part_prefix_sum_mem_586413, "grid_part_prefix_sum_mem_586413") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586432, &grid_part_sizze_per_dim_mem_586414, "grid_part_sizze_per_dim_mem_586414") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586435, &grid_partitions_per_dim_mem_586415, "grid_partitions_per_dim_mem_586415") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586439, &start_of_grid_partition_mem_586416, "start_of_grid_partition_mem_586416") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586442, &part_idx_mem_586418, "part_idx_mem_586418") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586446, &xys_mem_586419, "xys_mem_586419") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586449, &xys_mem_586420, "xys_mem_586420") != 0)
        return 1;
    loop_dz2087U_572736 = dz2080U_396636;
    loop_dz2081Uz2080U_572737 = dz2082U_396639;
    loop_dz2081Uz2081U_572738 = dz2083U_396640;
    loop_while_572739 = x_572701;
    sd_skB_572746 = total_angle_no_396647;
    sd_skB_572747 = total_grid_no_396648;
    i_572751 = tmp_572691;
    acc_sd_572752 = (int64_t) 1;
    while (loop_while_572739) {
        int64_t min_arg0_572753 = mul64(omit_step_396655, i_572751);
        int64_t min_res_572754 = smin64(zl_rhs_572697, min_arg0_572753);
        bool cond_572755 = sle64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637, min_res_572754);
        bool x_572756 = !cond_572755;
        bool x_572757 = sle64((int64_t) 0, min_res_572754);
        bool y_572758 = slt64(min_res_572754, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637);
        bool bounds_check_572759 = x_572757 && y_572758;
        bool protect_assert_disj_572760 = cond_572755 || bounds_check_572759;
        bool index_certs_572761;
        
        if (!protect_assert_disj_572760) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_572754, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637, "].", "-> #0  ftSkyline.fut:583:22-58\n   #1  ftSkyline.fut:654:130-136\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t angle_no_omitted_f_res_572762;
        
        if (x_572756) {
            int64_t x_583310 = ((int64_t *) mem_param_586423.mem)[min_res_572754];
            
            angle_no_omitted_f_res_572762 = x_583310;
        } else {
            angle_no_omitted_f_res_572762 = (int64_t) 0;
        }
        
        int64_t angle_no_omitted_572764;
        
        if (cond_572755) {
            angle_no_omitted_572764 = sd_skB_572746;
        } else {
            angle_no_omitted_572764 = angle_no_omitted_f_res_572762;
        }
        
        bool cond_572765 = sle64(min_res_572754, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637);
        bool x_572766 = !cond_572765;
        bool cond_572767 = min_res_572754 == zl_rhs_572697;
        bool x_572768 = !cond_572767;
        int64_t zp_lhs_572769 = sub64(min_res_572754, dim_396635);
        int64_t tmp_572770 = add64((int64_t) 1, zp_lhs_572769);
        bool x_572771 = sle64((int64_t) 0, tmp_572770);
        bool y_572772 = slt64(tmp_572770, dim_396635);
        bool bounds_check_572773 = x_572771 && y_572772;
        bool protect_assert_disj_572774 = cond_572767 || bounds_check_572773;
        bool protect_assert_disj_572775 = cond_572765 || protect_assert_disj_572774;
        bool index_certs_572776;
        
        if (!protect_assert_disj_572775) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_572770, "] out of bounds for array of shape [", (long long) dim_396635, "].", "-> #0  ftSkyline.fut:588:22-63\n   #1  ftSkyline.fut:654:130-136\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool protect_cond_conj_572777 = x_572766 && x_572768;
        int64_t grid_no_omitted_f_res_f_res_572778;
        
        if (protect_cond_conj_572777) {
            int64_t x_583311 = ((int64_t *) mem_param_586429.mem)[tmp_572770];
            
            grid_no_omitted_f_res_f_res_572778 = x_583311;
        } else {
            grid_no_omitted_f_res_f_res_572778 = (int64_t) 0;
        }
        
        int64_t grid_no_omitted_f_res_572780;
        
        if (cond_572767) {
            grid_no_omitted_f_res_572780 = sd_skB_572747;
        } else {
            grid_no_omitted_f_res_572780 = grid_no_omitted_f_res_f_res_572778;
        }
        
        int64_t grid_no_omitted_572781;
        
        if (cond_572765) {
            grid_no_omitted_572781 = (int64_t) 1;
        } else {
            grid_no_omitted_572781 = grid_no_omitted_f_res_572780;
        }
        if (memblock_alloc(ctx, &mem_586455, bytes_586450, "mem_586455")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t discard_586060;
        int64_t defunc_res_583359;
        int64_t scanacc_586051;
        int64_t redout_586053;
        
        scanacc_586051 = (int64_t) 1;
        redout_586053 = (int64_t) 1;
        for (int64_t i_586056 = 0; i_586056 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637; i_586056++) {
            int64_t eta_p_582647 = ((int64_t *) mem_param_586426.mem)[i_586056];
            bool cond_582649 = slt64(i_586056, min_res_572754);
            int64_t lifted_lambda_res_582650;
            
            if (cond_582649) {
                lifted_lambda_res_582650 = (int64_t) 1;
            } else {
                lifted_lambda_res_582650 = eta_p_582647;
            }
            
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582658 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586056];
            double i64_res_582659 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582658);
            double defunc_0_fover_res_582660 = 1.5707963267948966 / i64_res_582659;
            int64_t defunc_0_op_res_572796 = mul64(lifted_lambda_res_582650, scanacc_586051);
            int64_t zt_res_582440 = mul64(lifted_lambda_res_582650, redout_586053);
            
            ((int64_t *) mem_586451)[i_586056] = defunc_0_op_res_572796;
            ((double *) mem_586453)[i_586056] = defunc_0_fover_res_582660;
            ((int64_t *) mem_586455.mem)[i_586056] = lifted_lambda_res_582650;
            
            int64_t scanacc_tmp_588039 = defunc_0_op_res_572796;
            int64_t redout_tmp_588041 = zt_res_582440;
            
            scanacc_586051 = scanacc_tmp_588039;
            redout_586053 = redout_tmp_588041;
        }
        discard_586060 = scanacc_586051;
        defunc_res_583359 = redout_586053;
        if (memblock_alloc(ctx, &mem_586477, bytes_586474, "mem_586477")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_586479, bytes_586474, "mem_586479")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t discard_586073;
        int64_t defunc_res_583363;
        int64_t scanacc_586064;
        int64_t redout_586066;
        
        scanacc_586064 = (int64_t) 1;
        redout_586066 = (int64_t) 1;
        for (int64_t i_586069 = 0; i_586069 < dim_396635; i_586069++) {
            int64_t eta_p_582665 = ((int64_t *) mem_param_586435.mem)[i_586069];
            bool cond_582667 = slt64(i_586069, tmp_572770);
            int64_t lifted_lambda_res_582668;
            
            if (cond_582667) {
                lifted_lambda_res_582668 = (int64_t) 1;
            } else {
                lifted_lambda_res_582668 = eta_p_582665;
            }
            
            bool cond_582672 = slt64(zp_lhs_572769, i_586069);
            double defunc_0_f_res_582673;
            
            if (cond_582672) {
                double defunc_0_f_res_t_res_583316 = ((double *) mem_param_586432.mem)[i_586069];
                
                defunc_0_f_res_582673 = defunc_0_f_res_t_res_583316;
            } else {
                double i64_res_582684 = sitofp_i64_f64(eta_p_582665);
                double dzlz7bUskOpzitimesz7dUzg_arg0_582685 = ((double *) mem_param_586432.mem)[i_586069];
                double defunc_0_times_res_582686 = i64_res_582684 * dzlz7bUskOpzitimesz7dUzg_arg0_582685;
                
                defunc_0_f_res_582673 = defunc_0_times_res_582686;
            }
            
            int64_t defunc_0_op_res_572811 = mul64(lifted_lambda_res_582668, scanacc_586064);
            int64_t zt_res_582447 = mul64(lifted_lambda_res_582668, redout_586066);
            
            ((int64_t *) mem_586475)[i_586069] = defunc_0_op_res_572811;
            ((double *) mem_586477.mem)[i_586069] = defunc_0_f_res_582673;
            ((int64_t *) mem_586479.mem)[i_586069] = lifted_lambda_res_582668;
            
            int64_t scanacc_tmp_588044 = defunc_0_op_res_572811;
            int64_t redout_tmp_588046 = zt_res_582447;
            
            scanacc_586064 = scanacc_tmp_588044;
            redout_586066 = redout_tmp_588046;
        }
        discard_586073 = scanacc_586064;
        defunc_res_583363 = redout_586066;
        if (memblock_alloc(ctx, &mem_586499, bytes_586450, "mem_586499")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586076 = 0; i_586076 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637; i_586076++) {
            int64_t zv_lhs_582609 = add64((int64_t) -1, i_586076);
            int64_t tmp_582610 = smod64(zv_lhs_582609, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637);
            int64_t lifted_lambda_res_582611 = ((int64_t *) mem_586451)[tmp_582610];
            bool cond_582613 = i_586076 == (int64_t) 0;
            int64_t lifted_lambda_res_582614;
            
            if (cond_582613) {
                lifted_lambda_res_582614 = (int64_t) 1;
            } else {
                lifted_lambda_res_582614 = lifted_lambda_res_582611;
            }
            ((int64_t *) mem_586499.mem)[i_586076] = lifted_lambda_res_582614;
        }
        if (memblock_alloc(ctx, &mem_586507, bytes_586474, "mem_586507")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586080 = 0; i_586080 < dim_396635; i_586080++) {
            int64_t zv_lhs_582600 = add64((int64_t) -1, i_586080);
            int64_t tmp_582601 = smod64(zv_lhs_582600, dim_396635);
            int64_t lifted_lambda_res_582602 = ((int64_t *) mem_586475)[tmp_582601];
            bool cond_582604 = i_586080 == (int64_t) 0;
            int64_t lifted_lambda_res_582605;
            
            if (cond_582604) {
                lifted_lambda_res_582605 = (int64_t) 1;
            } else {
                lifted_lambda_res_582605 = lifted_lambda_res_582602;
            }
            ((int64_t *) mem_586507.mem)[i_586080] = lifted_lambda_res_582605;
        }
        
        bool eq_x_y_572824 = (int64_t) 0 == sd_skB_572747;
        bool eq_x_zz_572825 = (int64_t) 0 == grid_no_omitted_f_res_f_res_572778;
        bool p_and_eq_x_y_572826 = cond_572767 && eq_x_y_572824;
        bool p_and_eq_x_y_572827 = x_572768 && eq_x_zz_572825;
        bool eq_x_zz_572828 = p_and_eq_x_y_572826 || p_and_eq_x_y_572827;
        bool p_and_eq_x_y_572829 = x_572766 && eq_x_zz_572828;
        bool nonzzero_572830 = !p_and_eq_x_y_572829;
        bool protect_assert_disj_572831 = cond_572765 || nonzzero_572830;
        bool nonzzero_cert_572832;
        
        if (!protect_assert_disj_572831) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:604:48-65\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:654:130-136\n   #5  ftSkyline.fut:876:116-127\n   #6  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool cond_572833 = loop_dz2087U_572736 == (int64_t) 0;
        bool x_572834 = !cond_572833;
        int64_t tmp_572835 = sub64(loop_dz2087U_572736, (int64_t) 1);
        bool x_572836 = sle64((int64_t) 0, tmp_572835);
        bool y_572837 = slt64(tmp_572835, loop_dz2087U_572736);
        bool bounds_check_572838 = x_572836 && y_572837;
        bool protect_assert_disj_572839 = cond_572833 || bounds_check_572838;
        bool protect_assert_disj_572840 = cond_572765 || protect_assert_disj_572839;
        bool index_certs_572841;
        
        if (!protect_assert_disj_572840) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_572835, "] out of bounds for array of shape [", (long long) loop_dz2087U_572736, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:654:130-136\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_586514 = (int64_t) 8 * loop_dz2087U_572736;
        int64_t new_starts_572842;
        
        if (cond_572765) {
            if (memblock_set(ctx, &ext_mem_586546, &mem_param_586439, "mem_param_586439") != 0)
                return 1;
            new_starts_572842 = loop_dz2087U_572736;
        } else {
            if (mem_586515_cached_sizze_588273 < bytes_586514) {
                err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588273, bytes_586514);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586517_cached_sizze_588274 < bytes_586514) {
                err = lexical_realloc(ctx, &mem_586517, &mem_586517_cached_sizze_588274, bytes_586514);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_586090;
            int64_t scanacc_586084 = (int64_t) 0;
            
            for (int64_t i_586087 = 0; i_586087 < loop_dz2087U_572736; i_586087++) {
                int64_t zeze_lhs_582704 = smod64(i_586087, grid_no_omitted_572781);
                bool lifted_lambda_res_582705 = zeze_lhs_582704 == (int64_t) 0;
                int64_t defunc_0_f_res_582706 = btoi_bool_i64(lifted_lambda_res_582705);
                int64_t defunc_0_op_res_572854 = add64(defunc_0_f_res_582706, scanacc_586084);
                
                ((int64_t *) mem_586515)[i_586087] = defunc_0_op_res_572854;
                ((int64_t *) mem_586517)[i_586087] = defunc_0_f_res_582706;
                
                int64_t scanacc_tmp_588051 = defunc_0_op_res_572854;
                
                scanacc_586084 = scanacc_tmp_588051;
            }
            discard_586090 = scanacc_586084;
            
            int64_t m_f_res_572855;
            
            if (x_572834) {
                int64_t x_583317 = ((int64_t *) mem_586515)[tmp_572835];
                
                m_f_res_572855 = x_583317;
            } else {
                m_f_res_572855 = (int64_t) 0;
            }
            
            int64_t m_572857;
            
            if (cond_572833) {
                m_572857 = (int64_t) 0;
            } else {
                m_572857 = m_f_res_572855;
            }
            
            int64_t m_572867 = sub64(m_572857, (int64_t) 1);
            bool i_p_m_t_s_leq_w_572869 = slt64(m_572867, loop_dz2087U_572736);
            bool zzero_leq_i_p_m_t_s_572868 = sle64((int64_t) 0, m_572867);
            bool y_572871 = zzero_leq_i_p_m_t_s_572868 && i_p_m_t_s_leq_w_572869;
            bool i_lte_j_572870 = sle64((int64_t) 0, m_572857);
            bool forwards_ok_572872 = i_lte_j_572870 && y_572871;
            bool eq_x_zz_572864 = (int64_t) 0 == m_f_res_572855;
            bool p_and_eq_x_y_572865 = x_572834 && eq_x_zz_572864;
            bool empty_slice_572866 = cond_572833 || p_and_eq_x_y_572865;
            bool ok_or_empty_572873 = empty_slice_572866 || forwards_ok_572872;
            bool index_certs_572874;
            
            if (!ok_or_empty_572873) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_572857, "] out of bounds for array of shape [", (long long) loop_dz2087U_572736, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:654:130-136\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_586530 = (int64_t) 8 * m_572857;
            int64_t bytes_586531 = dim_396635 * binop_x_586530;
            
            if (memblock_alloc(ctx, &mem_586532, bytes_586531, "mem_586532")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586532.mem, (int64_t) 0, (int64_t []) {dim_396635, (int64_t) 1}, (uint64_t *) mem_param_586439.mem, (int64_t) 0, (int64_t []) {dim_396635, (int64_t) 1}, (int64_t []) {m_572857, dim_396635});
            if (mem_586538_cached_sizze_588275 < bytes_586474) {
                err = lexical_realloc(ctx, &mem_586538, &mem_586538_cached_sizze_588275, bytes_586474);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t write_iter_586091 = 0; write_iter_586091 < loop_dz2087U_572736; write_iter_586091++) {
                int64_t write_iv_586093 = ((int64_t *) mem_586517)[write_iter_586091];
                int64_t write_iv_586094 = ((int64_t *) mem_586515)[write_iter_586091];
                
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586538, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586439.mem, (int64_t) 0 + write_iter_586091 * dim_396635, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_396635});
                
                bool cond_582698 = write_iv_586093 == (int64_t) 1;
                int64_t lifted_lambda_res_582699;
                
                if (cond_582698) {
                    int64_t lifted_lambda_res_t_res_583318 = sub64(write_iv_586094, (int64_t) 1);
                    
                    lifted_lambda_res_582699 = lifted_lambda_res_t_res_583318;
                } else {
                    lifted_lambda_res_582699 = (int64_t) -1;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_582699) && slt64(lifted_lambda_res_582699, m_572857)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_396635 - (int64_t) 1, dim_396635))) {
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586532.mem, lifted_lambda_res_582699 * dim_396635, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586538, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_396635});
                }
            }
            if (memblock_set(ctx, &ext_mem_586546, &mem_586532, "mem_586532") != 0)
                return 1;
            new_starts_572842 = m_572857;
        }
        
        int64_t new_skB_572897 = mul64(defunc_res_583359, defunc_res_583363);
        int64_t bytes_586547 = (int64_t) 8 * loop_dz2081Uz2080U_572737;
        
        if (mem_586548_cached_sizze_588276 < bytes_586547) {
            err = lexical_realloc(ctx, &mem_586548, &mem_586548_cached_sizze_588276, bytes_586547);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586550_cached_sizze_588277 < bytes_586547) {
            err = lexical_realloc(ctx, &mem_586550, &mem_586550_cached_sizze_588277, bytes_586547);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_586105;
        int64_t scanacc_586099 = (int64_t) 0;
        
        for (int64_t i_586102 = 0; i_586102 < loop_dz2081Uz2080U_572737; i_586102++) {
            int64_t defunc_0_f_res_582593;
            
            if (futrts_lifted_lambda_13310(ctx, &defunc_0_f_res_582593, acc_sd_572752, angle_no_omitted_572764, grid_no_omitted_572781, i_586102) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_0_f_res_582595;
            
            if (futrts_lifted_lambda_13311(ctx, &defunc_0_f_res_582595, defunc_0_f_res_582593) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_0_op_res_572909 = add64(defunc_0_f_res_582595, scanacc_586099);
            
            ((int64_t *) mem_586548)[i_586102] = defunc_0_op_res_572909;
            ((int64_t *) mem_586550)[i_586102] = defunc_0_f_res_582593;
            
            int64_t scanacc_tmp_588055 = defunc_0_op_res_572909;
            
            scanacc_586099 = scanacc_tmp_588055;
        }
        discard_586105 = scanacc_586099;
        
        int64_t bytes_586563 = (int64_t) 8 * new_skB_572897;
        
        if (mem_586564_cached_sizze_588278 < bytes_586563) {
            err = lexical_realloc(ctx, &mem_586564, &mem_586564_cached_sizze_588278, bytes_586563);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588058 = 0; nest_i_588058 < new_skB_572897; nest_i_588058++) {
            ((int64_t *) mem_586564)[nest_i_588058] = (int64_t) 0;
        }
        for (int64_t write_iter_586106 = 0; write_iter_586106 < loop_dz2081Uz2080U_572737; write_iter_586106++) {
            int64_t write_iv_586109 = ((int64_t *) mem_586550)[write_iter_586106];
            int64_t write_iv_586110 = ((int64_t *) mem_param_586442.mem)[write_iter_586106];
            int64_t zv_lhs_582577 = add64((int64_t) -1, write_iter_586106);
            int64_t tmp_582578 = smod64(zv_lhs_582577, loop_dz2081Uz2080U_572737);
            int64_t lifted_lambda_res_582579 = ((int64_t *) mem_586548)[tmp_582578];
            bool cond_582581 = write_iter_586106 == (int64_t) 0;
            int64_t lifted_lambda_res_582582;
            
            if (cond_582581) {
                lifted_lambda_res_582582 = (int64_t) 0;
            } else {
                lifted_lambda_res_582582 = lifted_lambda_res_582579;
            }
            
            bool cond_582584 = slt64(write_iv_586109, (int64_t) 0);
            int64_t lifted_lambda_res_582585;
            
            if (cond_582584) {
                lifted_lambda_res_582585 = (int64_t) -1;
            } else {
                lifted_lambda_res_582585 = lifted_lambda_res_582582;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_582585) && slt64(lifted_lambda_res_582585, new_skB_572897)) {
                ((int64_t *) mem_586564)[lifted_lambda_res_582585] = write_iv_586110;
            }
        }
        
        int64_t zeze_rhs_572930 = sub64(new_skB_572897, (int64_t) 1);
        int64_t defunc_0_reduce_res_583371;
        int64_t redout_586112 = (int64_t) -9223372036854775808;
        
        for (int64_t i_586113 = 0; i_586113 < new_skB_572897; i_586113++) {
            bool cond_582533 = i_586113 == zeze_rhs_572930;
            int64_t lifted_lambda_res_582534;
            
            if (cond_582533) {
                int64_t zm_rhs_583326 = ((int64_t *) mem_586564)[i_586113];
                int64_t lifted_lambda_res_t_res_583327 = sub64(loop_dz2081Uz2081U_572738, zm_rhs_583326);
                
                lifted_lambda_res_582534 = lifted_lambda_res_t_res_583327;
            } else {
                int64_t zm_lhs_582541 = add64((int64_t) 1, i_586113);
                bool x_582542 = sle64((int64_t) 0, zm_lhs_582541);
                bool y_582543 = slt64(zm_lhs_582541, new_skB_572897);
                bool bounds_check_582544 = x_582542 && y_582543;
                bool index_certs_582545;
                
                if (!bounds_check_582544) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582541, "] out of bounds for array of shape [", (long long) new_skB_572897, "].", "-> #0  ftSkyline.fut:376:38-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zm_lhs_582546 = ((int64_t *) mem_586564)[zm_lhs_582541];
                int64_t zm_rhs_582551 = ((int64_t *) mem_586564)[i_586113];
                int64_t lifted_lambda_res_f_res_582552 = sub64(zm_lhs_582546, zm_rhs_582551);
                
                lifted_lambda_res_582534 = lifted_lambda_res_f_res_582552;
            }
            
            int64_t max_res_572957 = smax64(lifted_lambda_res_582534, redout_586112);
            int64_t redout_tmp_588060 = max_res_572957;
            
            redout_586112 = redout_tmp_588060;
        }
        defunc_0_reduce_res_583371 = redout_586112;
        
        int64_t bytes_586571 = (int64_t) 8 * loop_dz2081Uz2081U_572738;
        
        if (memblock_alloc(ctx, &mem_586572, bytes_586571, "mem_586572")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_588061 = 0; i_588061 < loop_dz2081Uz2081U_572738; i_588061++) {
            int64_t x_588062 = (int64_t) 0 + i_588061 * (int64_t) 1;
            
            ((int64_t *) mem_586572.mem)[i_588061] = x_588062;
        }
        
        bool bounds_invalid_upwards_572959 = slt64(defunc_0_reduce_res_583371, (int64_t) 0);
        bool valid_572960 = !bounds_invalid_upwards_572959;
        bool range_valid_c_572961;
        
        if (!valid_572960) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_0_reduce_res_583371, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:380:65-83\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t min_arg1_572962 = sub64(loop_dz2081Uz2081U_572738, (int64_t) 1);
        bool loop_nonempty_572963 = slt64((int64_t) 0, defunc_0_reduce_res_583371);
        bool y_572964 = slt64((int64_t) 0, new_starts_572842);
        bool loop_not_taken_572965 = !loop_nonempty_572963;
        bool protect_assert_disj_572966 = y_572964 || loop_not_taken_572965;
        bool index_certs_572967;
        
        if (!protect_assert_disj_572966) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) new_starts_572842, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool protect_assert_disj_572968 = assert_cond_572689 || loop_not_taken_572965;
        bool empty_or_match_cert_572969;
        
        if (!protect_assert_disj_572968) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &mem_param_586575, &mem_586572, "mem_586572") != 0)
            return 1;
        for (int64_t i_572973 = 0; i_572973 < defunc_0_reduce_res_583371; i_572973++) {
            for (int64_t i_586116 = 0; i_586116 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637; i_586116++) {
                int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572982 = ((int64_t *) mem_586455.mem)[i_586116];
                double i64_res_572983 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572982);
                double defunc_0_fover_res_572984 = 1.5707963267948966 / i64_res_572983;
                
                ((double *) mem_586577)[i_586116] = defunc_0_fover_res_572984;
            }
            if (memblock_alloc(ctx, &mem_586585, bytes_586571, "mem_586585")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_586144 = 0; i_586144 < loop_dz2081Uz2081U_572738; i_586144++) {
                for (int64_t i_586120 = 0; i_586120 < dim_396635; i_586120++) {
                    double eta_p_583059 = ((double *) mem_param_586446.mem)[i_586144 * dim_396635 + i_586120];
                    double eta_p_583060 = ((double *) ext_mem_586546.mem)[i_586120];
                    double eta_p_583061 = ((double *) mem_586477.mem)[i_586120];
                    int64_t eta_p_583063 = ((int64_t *) mem_586507.mem)[i_586120];
                    double defunc_0_f_res_583064 = eta_p_583059 - eta_p_583060;
                    double defunc_0_f_res_583066 = defunc_0_f_res_583064 / eta_p_583061;
                    int64_t f64_res_583068 = fptosi_f64_i64(defunc_0_f_res_583066);
                    int64_t max_res_583070 = smax64((int64_t) 0, f64_res_583068);
                    int64_t zm_lhs_583076 = ((int64_t *) mem_586479.mem)[i_586120];
                    int64_t min_arg1_583077 = sub64(zm_lhs_583076, (int64_t) 1);
                    int64_t min_res_583078 = smin64(max_res_583070, min_arg1_583077);
                    int64_t defunc_0_f_res_583080 = mul64(eta_p_583063, min_res_583078);
                    
                    ((int64_t *) mem_586590)[i_586120] = defunc_0_f_res_583080;
                }
                
                int64_t defunc_0_foldl_res_582882;
                int64_t acc_582884 = (int64_t) 0;
                
                for (int64_t i_582883 = 0; i_582883 < dim_396635; i_582883++) {
                    int64_t b_582885 = ((int64_t *) mem_586590)[i_582883];
                    int64_t defunc_0_f_res_582886 = add64(acc_582884, b_582885);
                    int64_t acc_tmp_588068 = defunc_0_f_res_582886;
                    
                    acc_582884 = acc_tmp_588068;
                }
                defunc_0_foldl_res_582882 = acc_582884;
                
                bool x_582887 = sle64((int64_t) 0, defunc_0_foldl_res_582882);
                bool y_582888 = slt64(defunc_0_foldl_res_582882, new_starts_572842);
                bool bounds_check_582889 = x_582887 && y_582888;
                bool index_certs_582890;
                
                if (!bounds_check_582889) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582882, "] out of bounds for array of shape [", (long long) new_starts_572842, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int64_t i_586124 = 0; i_586124 < dim_396635; i_586124++) {
                    double eta_p_582893 = ((double *) mem_param_586446.mem)[i_586144 * dim_396635 + i_586124];
                    double eta_p_582894 = ((double *) ext_mem_586546.mem)[defunc_0_foldl_res_582882 * dim_396635 + i_586124];
                    double defunc_0_f_res_582895 = eta_p_582893 - eta_p_582894;
                    
                    ((double *) mem_586598)[i_586124] = defunc_0_f_res_582895;
                }
                for (int64_t nest_i_588070 = 0; nest_i_588070 < arg_572688; nest_i_588070++) {
                    ((double *) mem_586606)[nest_i_588070] = 0.0;
                }
                for (int64_t i_582898 = 0; i_582898 < arg_572688; i_582898++) {
                    bool y_582900 = slt64(i_582898, dim_396635);
                    bool index_certs_582901;
                    
                    if (!y_582900) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582898, "] out of bounds for array of shape [", (long long) dim_396635, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t map_arg1_582903 = add64((int64_t) 1, i_582898);
                    int64_t j_m_i_582904 = sub64(dim_396635, map_arg1_582903);
                    bool empty_slice_582905 = j_m_i_582904 == (int64_t) 0;
                    int64_t m_582906 = sub64(j_m_i_582904, (int64_t) 1);
                    int64_t i_p_m_t_s_582907 = add64(map_arg1_582903, m_582906);
                    bool zzero_leq_i_p_m_t_s_582908 = sle64((int64_t) 0, i_p_m_t_s_582907);
                    bool i_p_m_t_s_leq_w_582909 = slt64(i_p_m_t_s_582907, dim_396635);
                    bool zzero_lte_i_582910 = sle64((int64_t) 0, map_arg1_582903);
                    bool i_lte_j_582911 = sle64(map_arg1_582903, dim_396635);
                    bool y_582912 = i_p_m_t_s_leq_w_582909 && zzero_lte_i_582910;
                    bool y_582913 = zzero_leq_i_p_m_t_s_582908 && y_582912;
                    bool forwards_ok_582914 = i_lte_j_582911 && y_582913;
                    bool ok_or_empty_582915 = empty_slice_582905 || forwards_ok_582914;
                    bool index_certs_582916;
                    
                    if (!ok_or_empty_582915) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582903, ":", (long long) dim_396635, "] out of bounds for array of shape [", (long long) dim_396635, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_586610 = (int64_t) 8 * j_m_i_582904;
                    double this_x_582902 = ((double *) mem_586598)[i_582898];
                    
                    if (mem_586611_cached_sizze_588283 < bytes_586610) {
                        err = lexical_realloc(ctx, &mem_586611, &mem_586611_cached_sizze_588283, bytes_586610);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586128 = 0; i_586128 < j_m_i_582904; i_586128++) {
                        int64_t slice_586367 = map_arg1_582903 + i_586128;
                        double eta_p_582919 = ((double *) mem_586598)[slice_586367];
                        double defunc_0_ftimes_res_582920 = eta_p_582919 * eta_p_582919;
                        
                        ((double *) mem_586611)[i_586128] = defunc_0_ftimes_res_582920;
                    }
                    
                    double defunc_0_foldl_res_582921;
                    double acc_582923 = 0.0;
                    
                    for (int64_t i_582922 = 0; i_582922 < j_m_i_582904; i_582922++) {
                        double b_582924 = ((double *) mem_586611)[i_582922];
                        double defunc_0_f_res_582925 = acc_582923 + b_582924;
                        double acc_tmp_588073 = defunc_0_f_res_582925;
                        
                        acc_582923 = acc_tmp_588073;
                    }
                    defunc_0_foldl_res_582921 = acc_582923;
                    
                    double sqrt_res_582926 = futrts_sqrt64(defunc_0_foldl_res_582921);
                    double atan2_res_582927 = futrts_atan2_64(sqrt_res_582926, this_x_582902);
                    
                    ((double *) mem_586606)[i_582898] = atan2_res_582927;
                }
                for (int64_t i_586132 = 0; i_586132 < arg_572688; i_586132++) {
                    double eta_p_582930 = ((double *) mem_586606)[i_586132];
                    double eta_p_582931 = ((double *) mem_586577)[i_586132];
                    int64_t eta_p_582932 = ((int64_t *) mem_586499.mem)[i_586132];
                    int64_t eta_p_582933 = ((int64_t *) mem_586455.mem)[i_586132];
                    double i64_res_582934 = sitofp_i64_f64(eta_p_582932);
                    double defunc_0_fover_res_582935 = eta_p_582930 / eta_p_582931;
                    double defunc_0_ftimes_res_582936 = i64_res_582934 * defunc_0_fover_res_582935;
                    int64_t f64_res_582937 = fptosi_f64_i64(defunc_0_ftimes_res_582936);
                    bool cond_582938 = slt64(f64_res_582937, (int64_t) 0);
                    int64_t defunc_0_f_res_582939;
                    
                    if (cond_582938) {
                        defunc_0_f_res_582939 = (int64_t) 0;
                    } else {
                        bool cond_582940 = sle64(eta_p_582933, f64_res_582937);
                        int64_t defunc_0_f_res_f_res_582941;
                        
                        if (cond_582940) {
                            int64_t defunc_0_f_res_f_res_t_res_583330 = sub64(eta_p_582933, (int64_t) 1);
                            
                            defunc_0_f_res_f_res_582941 = defunc_0_f_res_f_res_t_res_583330;
                        } else {
                            defunc_0_f_res_f_res_582941 = f64_res_582937;
                        }
                        defunc_0_f_res_582939 = defunc_0_f_res_f_res_582941;
                    }
                    ((int64_t *) mem_586622)[i_586132] = defunc_0_f_res_582939;
                }
                
                int64_t defunc_0_foldl_res_582943;
                int64_t acc_582945 = (int64_t) 0;
                
                for (int64_t i_582944 = 0; i_582944 < arg_572688; i_582944++) {
                    int64_t b_582946 = ((int64_t *) mem_586622)[i_582944];
                    int64_t defunc_0_f_res_582947 = add64(acc_582945, b_582946);
                    int64_t acc_tmp_588075 = defunc_0_f_res_582947;
                    
                    acc_582945 = acc_tmp_588075;
                }
                defunc_0_foldl_res_582943 = acc_582945;
                
                int64_t zp_lhs_582950 = mul64(defunc_0_foldl_res_582882, defunc_res_583359);
                int64_t get_id_from_grid_angle_res_582951 = add64(defunc_0_foldl_res_582943, zp_lhs_582950);
                bool x_582953 = sle64((int64_t) 0, get_id_from_grid_angle_res_582951);
                bool y_582954 = slt64(get_id_from_grid_angle_res_582951, new_skB_572897);
                bool bounds_check_582955 = x_582953 && y_582954;
                bool index_certs_582956;
                
                if (!bounds_check_582955) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582951, "] out of bounds for array of shape [", (long long) new_skB_572897, "].", "-> #0  ftSkyline.fut:389:73-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zp_lhs_582957 = ((int64_t *) mem_586564)[get_id_from_grid_angle_res_582951];
                int64_t min_arg0_582958 = add64(i_572973, zp_lhs_582957);
                int64_t min_res_582959 = smin64(min_arg1_572962, min_arg0_582958);
                bool x_582961 = sle64((int64_t) 0, min_res_582959);
                bool y_582962 = slt64(min_res_582959, loop_dz2081Uz2081U_572738);
                bool bounds_check_582963 = x_582961 && y_582962;
                bool index_certs_582964;
                
                if (!bounds_check_582963) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_582959, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:390:56-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:390:44-70\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t eta_p_582852 = ((int64_t *) mem_param_586575.mem)[i_586144];
                bool cond_582967 = slt64(eta_p_582852, (int64_t) 0);
                bool x_582969 = !cond_582967;
                bool cond_f_res_582968 = eta_p_582852 == i_572973;
                bool y_582970 = cond_f_res_582968 && x_582969;
                bool cond_582971 = cond_582967 || y_582970;
                int64_t defunc_0_f_res_582972;
                
                if (cond_582971) {
                    defunc_0_f_res_582972 = eta_p_582852;
                } else {
                    if (mem_586629_cached_sizze_588285 < dim_396635) {
                        err = lexical_realloc(ctx, &mem_586629, &mem_586629_cached_sizze_588285, dim_396635);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586136 = 0; i_586136 < dim_396635; i_586136++) {
                        double eta_p_582974 = ((double *) mem_param_586446.mem)[i_586144 * dim_396635 + i_586136];
                        double eta_p_582975 = ((double *) mem_param_586446.mem)[min_res_582959 * dim_396635 + i_586136];
                        bool defunc_0_f_res_582976 = eta_p_582975 <= eta_p_582974;
                        
                        ((bool *) mem_586629)[i_586136] = defunc_0_f_res_582976;
                    }
                    
                    bool defunc_0_foldl_res_582977;
                    bool acc_582979 = 1;
                    
                    for (int64_t i_582978 = 0; i_582978 < dim_396635; i_582978++) {
                        bool b_582980 = ((bool *) mem_586629)[i_582978];
                        bool x_582981 = acc_582979 && b_582980;
                        bool acc_tmp_588077 = x_582981;
                        
                        acc_582979 = acc_tmp_588077;
                    }
                    defunc_0_foldl_res_582977 = acc_582979;
                    
                    bool elimd_582982;
                    
                    if (defunc_0_foldl_res_582977) {
                        if (mem_586636_cached_sizze_588286 < dim_396635) {
                            err = lexical_realloc(ctx, &mem_586636, &mem_586636_cached_sizze_588286, dim_396635);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586140 = 0; i_586140 < dim_396635; i_586140++) {
                            double eta_p_583333 = ((double *) mem_param_586446.mem)[i_586144 * dim_396635 + i_586140];
                            double eta_p_583334 = ((double *) mem_param_586446.mem)[min_res_582959 * dim_396635 + i_586140];
                            bool defunc_0_f_res_583335 = eta_p_583334 < eta_p_583333;
                            
                            ((bool *) mem_586636)[i_586140] = defunc_0_f_res_583335;
                        }
                        
                        bool defunc_0_foldl_res_583337;
                        bool acc_583339 = 0;
                        
                        for (int64_t i_583338 = 0; i_583338 < dim_396635; i_583338++) {
                            bool b_583340 = ((bool *) mem_586636)[i_583338];
                            bool defunc_0_f_res_583341 = acc_583339 || b_583340;
                            bool acc_tmp_588079 = defunc_0_f_res_583341;
                            
                            acc_583339 = acc_tmp_588079;
                        }
                        defunc_0_foldl_res_583337 = acc_583339;
                        elimd_582982 = defunc_0_foldl_res_583337;
                    } else {
                        elimd_582982 = 0;
                    }
                    
                    int64_t defunc_0_f_res_f_res_f_res_582992;
                    
                    if (elimd_582982) {
                        defunc_0_f_res_f_res_f_res_582992 = (int64_t) -1;
                    } else {
                        defunc_0_f_res_f_res_f_res_582992 = eta_p_582852;
                    }
                    defunc_0_f_res_582972 = defunc_0_f_res_f_res_f_res_582992;
                }
                ((int64_t *) mem_586585.mem)[i_586144] = defunc_0_f_res_582972;
            }
            if (memblock_set(ctx, &mem_param_tmp_588063, &mem_586585, "mem_586585") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586575, &mem_param_tmp_588063, "mem_param_tmp_588063") != 0)
                return 1;
        }
        if (memblock_set(ctx, &ext_mem_586648, &mem_param_586575, "mem_param_586575") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586572, "mem_586572") != 0)
            return 1;
        if (mem_586650_cached_sizze_588287 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586650, &mem_586650_cached_sizze_588287, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586652_cached_sizze_588288 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586652, &mem_586652_cached_sizze_588288, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_586154;
        int64_t scanacc_586148 = (int64_t) 0;
        
        for (int64_t i_586151 = 0; i_586151 < loop_dz2081Uz2081U_572738; i_586151++) {
            int64_t eta_p_582527 = ((int64_t *) ext_mem_586648.mem)[i_586151];
            bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
            int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
            int64_t defunc_0_op_res_573136 = add64(defunc_0_f_res_582529, scanacc_586148);
            
            ((int64_t *) mem_586650)[i_586151] = defunc_0_op_res_573136;
            ((int64_t *) mem_586652)[i_586151] = defunc_0_f_res_582529;
            
            int64_t scanacc_tmp_588080 = defunc_0_op_res_573136;
            
            scanacc_586148 = scanacc_tmp_588080;
        }
        discard_586154 = scanacc_586148;
        
        bool cond_573137 = loop_dz2081Uz2081U_572738 == (int64_t) 0;
        bool x_573138 = !cond_573137;
        bool x_573139 = sle64((int64_t) 0, min_arg1_572962);
        bool y_573140 = slt64(min_arg1_572962, loop_dz2081Uz2081U_572738);
        bool bounds_check_573141 = x_573139 && y_573140;
        bool protect_assert_disj_573142 = cond_573137 || bounds_check_573141;
        bool index_certs_573143;
        
        if (!protect_assert_disj_573142) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_572962, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_573144;
        
        if (x_573138) {
            int64_t x_583349 = ((int64_t *) mem_586650)[min_arg1_572962];
            
            m_f_res_573144 = x_583349;
        } else {
            m_f_res_573144 = (int64_t) 0;
        }
        
        int64_t m_573146;
        
        if (cond_573137) {
            m_573146 = (int64_t) 0;
        } else {
            m_573146 = m_f_res_573144;
        }
        
        int64_t m_573156 = sub64(m_573146, (int64_t) 1);
        bool i_p_m_t_s_leq_w_573158 = slt64(m_573156, loop_dz2081Uz2081U_572738);
        bool zzero_leq_i_p_m_t_s_573157 = sle64((int64_t) 0, m_573156);
        bool y_573160 = zzero_leq_i_p_m_t_s_573157 && i_p_m_t_s_leq_w_573158;
        bool i_lte_j_573159 = sle64((int64_t) 0, m_573146);
        bool forwards_ok_573161 = i_lte_j_573159 && y_573160;
        bool eq_x_zz_573153 = (int64_t) 0 == m_f_res_573144;
        bool p_and_eq_x_y_573154 = x_573138 && eq_x_zz_573153;
        bool empty_slice_573155 = cond_573137 || p_and_eq_x_y_573154;
        bool ok_or_empty_573162 = empty_slice_573155 || forwards_ok_573161;
        bool index_certs_573163;
        
        if (!ok_or_empty_573162) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_573146, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:876:116-127\n   #3  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_586665 = (int64_t) 8 * m_573146;
        int64_t bytes_586674 = dim_396635 * bytes_586665;
        bool zzero_573307 = new_skB_572897 == (int64_t) 0;
        bool nonzzero_573308 = !zzero_573307;
        bool nonzzero_cert_573309;
        
        if (!nonzzero_573308) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:656:62-85\n   #1  ftSkyline.fut:876:116-127\n   #2  ftSkyline.fut:868:17-876:127\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (mem_586666_cached_sizze_588289 < bytes_586665) {
            err = lexical_realloc(ctx, &mem_586666, &mem_586666_cached_sizze_588289, bytes_586665);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586648.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_573146});
        for (int64_t write_iter_586155 = 0; write_iter_586155 < loop_dz2081Uz2081U_572738; write_iter_586155++) {
            int64_t write_iv_586157 = ((int64_t *) mem_586652)[write_iter_586155];
            int64_t write_iv_586158 = ((int64_t *) mem_586650)[write_iter_586155];
            int64_t write_iv_586159 = ((int64_t *) ext_mem_586648.mem)[write_iter_586155];
            bool cond_582522 = write_iv_586157 == (int64_t) 1;
            int64_t lifted_lambda_res_582523;
            
            if (cond_582522) {
                int64_t lifted_lambda_res_t_res_583350 = sub64(write_iv_586158, (int64_t) 1);
                
                lifted_lambda_res_582523 = lifted_lambda_res_t_res_583350;
            } else {
                lifted_lambda_res_582523 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_573146)) {
                ((int64_t *) mem_586666)[lifted_lambda_res_582523] = write_iv_586159;
            }
        }
        if (memblock_unref(ctx, &ext_mem_586648, "ext_mem_586648") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_586675, bytes_586674, "mem_586675")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_586677, bytes_586665, "mem_586677")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586165 = 0; i_586165 < m_573146; i_586165++) {
            int64_t eta_p_573171 = ((int64_t *) mem_586666)[i_586165];
            bool x_573172 = sle64((int64_t) 0, eta_p_573171);
            bool y_573173 = slt64(eta_p_573171, loop_dz2081Uz2081U_572738);
            bool bounds_check_573174 = x_573172 && y_573173;
            bool index_certs_573175;
            
            if (!bounds_check_573174) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_573171, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:408:53-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:408:42-64\n   #3  ftSkyline.fut:876:116-127\n   #4  ftSkyline.fut:868:17-876:127\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_573177 = ((int64_t *) mem_param_586449.mem)[eta_p_573171];
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586675.mem, i_586165 * dim_396635, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586446.mem, (int64_t) 0 + eta_p_573171 * dim_396635, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_396635});
            ((int64_t *) mem_586677.mem)[i_586165] = lifted_lambda_res_573177;
        }
        if (mem_586693_cached_sizze_588290 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586693, &mem_586693_cached_sizze_588290, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586186 = 0; i_586186 < loop_dz2081Uz2081U_572738; i_586186++) {
            for (int64_t i_586170 = 0; i_586170 < dim_396635; i_586170++) {
                double eta_p_583207 = ((double *) mem_param_586446.mem)[i_586186 * dim_396635 + i_586170];
                double eta_p_583208 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586170];
                double eta_p_583209 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586170];
                int64_t eta_p_583211 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586170];
                double defunc_0_f_res_583212 = eta_p_583207 - eta_p_583208;
                double defunc_0_f_res_583214 = defunc_0_f_res_583212 / eta_p_583209;
                int64_t f64_res_583216 = fptosi_f64_i64(defunc_0_f_res_583214);
                int64_t max_res_583218 = smax64((int64_t) 0, f64_res_583216);
                int64_t zm_lhs_583224 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586170];
                int64_t min_arg1_583225 = sub64(zm_lhs_583224, (int64_t) 1);
                int64_t min_res_583226 = smin64(max_res_583218, min_arg1_583225);
                int64_t defunc_0_f_res_583228 = mul64(eta_p_583211, min_res_583226);
                
                ((int64_t *) mem_586698)[i_586170] = defunc_0_f_res_583228;
            }
            
            int64_t defunc_0_foldl_res_573213;
            int64_t acc_573215 = (int64_t) 0;
            
            for (int64_t i_573214 = 0; i_573214 < dim_396635; i_573214++) {
                int64_t b_573216 = ((int64_t *) mem_586698)[i_573214];
                int64_t defunc_0_f_res_573217 = add64(acc_573215, b_573216);
                int64_t acc_tmp_588088 = defunc_0_f_res_573217;
                
                acc_573215 = acc_tmp_588088;
            }
            defunc_0_foldl_res_573213 = acc_573215;
            
            bool x_573218 = sle64((int64_t) 0, defunc_0_foldl_res_573213);
            bool y_573219 = slt64(defunc_0_foldl_res_573213, dz2080U_396636);
            bool bounds_check_573220 = x_573218 && y_573219;
            bool index_certs_573221;
            
            if (!bounds_check_573220) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_573213, "] out of bounds for array of shape [", (long long) dz2080U_396636, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:876:116-127\n   #5  ftSkyline.fut:868:17-876:127\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586174 = 0; i_586174 < dim_396635; i_586174++) {
                double eta_p_573224 = ((double *) mem_param_586446.mem)[i_586186 * dim_396635 + i_586174];
                double eta_p_573225 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_573213 * dim_396635 + i_586174];
                double defunc_0_f_res_573226 = eta_p_573224 - eta_p_573225;
                
                ((double *) mem_586706)[i_586174] = defunc_0_f_res_573226;
            }
            for (int64_t nest_i_588090 = 0; nest_i_588090 < arg_572688; nest_i_588090++) {
                ((double *) mem_586714)[nest_i_588090] = 0.0;
            }
            for (int64_t i_573229 = 0; i_573229 < arg_572688; i_573229++) {
                bool y_573231 = slt64(i_573229, dim_396635);
                bool index_certs_573232;
                
                if (!y_573231) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_573229, "] out of bounds for array of shape [", (long long) dim_396635, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:876:116-127\n   #5  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_573234 = add64((int64_t) 1, i_573229);
                int64_t j_m_i_573235 = sub64(dim_396635, map_arg1_573234);
                bool empty_slice_573236 = j_m_i_573235 == (int64_t) 0;
                int64_t m_573237 = sub64(j_m_i_573235, (int64_t) 1);
                int64_t i_p_m_t_s_573238 = add64(map_arg1_573234, m_573237);
                bool zzero_leq_i_p_m_t_s_573239 = sle64((int64_t) 0, i_p_m_t_s_573238);
                bool i_p_m_t_s_leq_w_573240 = slt64(i_p_m_t_s_573238, dim_396635);
                bool zzero_lte_i_573241 = sle64((int64_t) 0, map_arg1_573234);
                bool i_lte_j_573242 = sle64(map_arg1_573234, dim_396635);
                bool y_573243 = i_p_m_t_s_leq_w_573240 && zzero_lte_i_573241;
                bool y_573244 = zzero_leq_i_p_m_t_s_573239 && y_573243;
                bool forwards_ok_573245 = i_lte_j_573242 && y_573244;
                bool ok_or_empty_573246 = empty_slice_573236 || forwards_ok_573245;
                bool index_certs_573247;
                
                if (!ok_or_empty_573246) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_573234, ":", (long long) dim_396635, "] out of bounds for array of shape [", (long long) dim_396635, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:876:116-127\n   #5  ftSkyline.fut:868:17-876:127\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586718 = (int64_t) 8 * j_m_i_573235;
                double this_x_573233 = ((double *) mem_586706)[i_573229];
                
                if (mem_586719_cached_sizze_588294 < bytes_586718) {
                    err = lexical_realloc(ctx, &mem_586719, &mem_586719_cached_sizze_588294, bytes_586718);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586178 = 0; i_586178 < j_m_i_573235; i_586178++) {
                    int64_t slice_586364 = map_arg1_573234 + i_586178;
                    double eta_p_573250 = ((double *) mem_586706)[slice_586364];
                    double defunc_0_ftimes_res_573251 = eta_p_573250 * eta_p_573250;
                    
                    ((double *) mem_586719)[i_586178] = defunc_0_ftimes_res_573251;
                }
                
                double defunc_0_foldl_res_573252;
                double acc_573254 = 0.0;
                
                for (int64_t i_573253 = 0; i_573253 < j_m_i_573235; i_573253++) {
                    double b_573255 = ((double *) mem_586719)[i_573253];
                    double defunc_0_f_res_573256 = acc_573254 + b_573255;
                    double acc_tmp_588093 = defunc_0_f_res_573256;
                    
                    acc_573254 = acc_tmp_588093;
                }
                defunc_0_foldl_res_573252 = acc_573254;
                
                double sqrt_res_573257 = futrts_sqrt64(defunc_0_foldl_res_573252);
                double atan2_res_573258 = futrts_atan2_64(sqrt_res_573257, this_x_573233);
                
                ((double *) mem_586714)[i_573229] = atan2_res_573258;
            }
            for (int64_t i_586182 = 0; i_586182 < arg_572688; i_586182++) {
                double eta_p_573261 = ((double *) mem_586714)[i_586182];
                double eta_p_573262 = ((double *) mem_586453)[i_586182];
                int64_t eta_p_573263 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586182];
                int64_t eta_p_573264 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586182];
                double i64_res_573265 = sitofp_i64_f64(eta_p_573263);
                double defunc_0_fover_res_573266 = eta_p_573261 / eta_p_573262;
                double defunc_0_ftimes_res_573267 = i64_res_573265 * defunc_0_fover_res_573266;
                int64_t f64_res_573268 = fptosi_f64_i64(defunc_0_ftimes_res_573267);
                bool cond_573269 = slt64(f64_res_573268, (int64_t) 0);
                int64_t defunc_0_f_res_573270;
                
                if (cond_573269) {
                    defunc_0_f_res_573270 = (int64_t) 0;
                } else {
                    bool cond_573271 = sle64(eta_p_573264, f64_res_573268);
                    int64_t defunc_0_f_res_f_res_573272;
                    
                    if (cond_573271) {
                        int64_t defunc_0_f_res_f_res_t_res_583353 = sub64(eta_p_573264, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_573272 = defunc_0_f_res_f_res_t_res_583353;
                    } else {
                        defunc_0_f_res_f_res_573272 = f64_res_573268;
                    }
                    defunc_0_f_res_573270 = defunc_0_f_res_f_res_573272;
                }
                ((int64_t *) mem_586730)[i_586182] = defunc_0_f_res_573270;
            }
            
            int64_t defunc_0_foldl_res_573274;
            int64_t acc_573276 = (int64_t) 0;
            
            for (int64_t i_573275 = 0; i_573275 < arg_572688; i_573275++) {
                int64_t b_573277 = ((int64_t *) mem_586730)[i_573275];
                int64_t defunc_0_f_res_573278 = add64(acc_573276, b_573277);
                int64_t acc_tmp_588095 = defunc_0_f_res_573278;
                
                acc_573276 = acc_tmp_588095;
            }
            defunc_0_foldl_res_573274 = acc_573276;
            
            int64_t zp_lhs_573279 = mul64(total_angle_no_396647, defunc_0_foldl_res_573213);
            int64_t get_id_from_grid_angle_res_573280 = add64(defunc_0_foldl_res_573274, zp_lhs_573279);
            
            ((int64_t *) mem_586693)[i_586186] = get_id_from_grid_angle_res_573280;
        }
        for (int64_t nest_i_588096 = 0; nest_i_588096 < total_part_no_396649; nest_i_588096++) {
            ((int64_t *) mem_586741)[nest_i_588096] = (int64_t) 0;
        }
        for (int64_t iter_586188 = 0; iter_586188 < m_573146; iter_586188++) {
            int64_t pixel_586190 = ((int64_t *) mem_586666)[iter_586188];
            bool x_582512 = sle64((int64_t) 0, pixel_586190);
            bool y_582513 = slt64(pixel_586190, loop_dz2081Uz2081U_572738);
            bool bounds_check_582514 = x_582512 && y_582513;
            bool index_certs_582515;
            
            if (!bounds_check_582514) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586190, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:413:51-62\n   #1  ftSkyline.fut:876:116-127\n   #2  ftSkyline.fut:868:17-876:127\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586693)[pixel_586190];
            bool less_than_zzero_586192 = slt64(lifted_lambda_res_582516, (int64_t) 0);
            bool greater_than_sizze_586193 = sle64(total_part_no_396649, lifted_lambda_res_582516);
            bool outside_bounds_dim_586194 = less_than_zzero_586192 || greater_than_sizze_586193;
            
            if (!outside_bounds_dim_586194) {
                int64_t read_hist_586196 = ((int64_t *) mem_586741)[lifted_lambda_res_582516];
                int64_t defunc_0_op_res_573289 = add64((int64_t) 1, read_hist_586196);
                
                ((int64_t *) mem_586741)[lifted_lambda_res_582516] = defunc_0_op_res_573289;
            }
        }
        
        int64_t discard_586204;
        int64_t scanacc_586200 = (int64_t) 0;
        
        for (int64_t i_586202 = 0; i_586202 < total_part_no_396649; i_586202++) {
            int64_t x_573293 = ((int64_t *) mem_586741)[i_586202];
            int64_t defunc_0_op_res_573296 = add64(x_573293, scanacc_586200);
            
            ((int64_t *) mem_586749)[i_586202] = defunc_0_op_res_573296;
            
            int64_t scanacc_tmp_588098 = defunc_0_op_res_573296;
            
            scanacc_586200 = scanacc_tmp_588098;
        }
        discard_586204 = scanacc_586200;
        if (memblock_alloc(ctx, &mem_586757, bytes_586740, "mem_586757")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586207 = 0; i_586207 < total_part_no_396649; i_586207++) {
            int64_t zv_lhs_582503 = add64((int64_t) -1, i_586207);
            int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_396649);
            int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586749)[tmp_582504];
            bool cond_582507 = i_586207 == (int64_t) 0;
            int64_t lifted_lambda_res_582508;
            
            if (cond_582507) {
                lifted_lambda_res_582508 = (int64_t) 0;
            } else {
                lifted_lambda_res_582508 = lifted_lambda_res_582505;
            }
            ((int64_t *) mem_586757.mem)[i_586207] = lifted_lambda_res_582508;
        }
        
        int64_t next_acc_sd_573310 = sdiv64(total_part_no_396649, new_skB_572897);
        int64_t tmp_573311 = add64((int64_t) 1, i_572751);
        bool cond_573312 = slt64(tmp_573311, zl_rhs_572692);
        bool cond_t_res_573313 = slt64(min_arg0_572753, zl_rhs_572697);
        bool x_573314 = cond_573312 && cond_t_res_573313;
        bool loop_cond_t_res_573315 = slt64(sizze_thresh_396657, m_573146);
        bool x_573316 = x_573314 && loop_cond_t_res_573315;
        
        if (memblock_set(ctx, &mem_param_tmp_588013, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588014, &mem_586455, "mem_586455") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588015, &mem_586507, "mem_586507") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588016, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588017, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588018, &ext_mem_586546, "ext_mem_586546") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588019, &mem_586757, "mem_586757") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588020, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588021, &mem_586677, "mem_586677") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_588022 = new_starts_572842;
        int64_t loop_dz2081Uz2080U_tmp_588023 = total_part_no_396649;
        int64_t loop_dz2081Uz2081U_tmp_588024 = m_573146;
        bool loop_while_tmp_588025 = x_573316;
        int64_t sd_skB_tmp_588032 = defunc_res_583359;
        int64_t sd_skB_tmp_588033 = defunc_res_583363;
        int64_t i_tmp_588037 = tmp_573311;
        int64_t acc_sd_tmp_588038 = next_acc_sd_573310;
        
        if (memblock_set(ctx, &mem_param_586423, &mem_param_tmp_588013, "mem_param_tmp_588013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586426, &mem_param_tmp_588014, "mem_param_tmp_588014") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586429, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586432, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586435, &mem_param_tmp_588017, "mem_param_tmp_588017") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586439, &mem_param_tmp_588018, "mem_param_tmp_588018") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586442, &mem_param_tmp_588019, "mem_param_tmp_588019") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586446, &mem_param_tmp_588020, "mem_param_tmp_588020") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586449, &mem_param_tmp_588021, "mem_param_tmp_588021") != 0)
            return 1;
        loop_dz2087U_572736 = loop_dz2087U_tmp_588022;
        loop_dz2081Uz2080U_572737 = loop_dz2081Uz2080U_tmp_588023;
        loop_dz2081Uz2081U_572738 = loop_dz2081Uz2081U_tmp_588024;
        loop_while_572739 = loop_while_tmp_588025;
        sd_skB_572746 = sd_skB_tmp_588032;
        sd_skB_572747 = sd_skB_tmp_588033;
        i_572751 = i_tmp_588037;
        acc_sd_572752 = acc_sd_tmp_588038;
    }
    if (memblock_set(ctx, &ext_mem_586792, &mem_param_586423, "mem_param_586423") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586791, &mem_param_586426, "mem_param_586426") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586790, &mem_param_586429, "mem_param_586429") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586789, &mem_param_586432, "mem_param_586432") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586788, &mem_param_586435, "mem_param_586435") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586787, &mem_param_586439, "mem_param_586439") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586786, &mem_param_586442, "mem_param_586442") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586785, &mem_param_586446, "mem_param_586446") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586784, &mem_param_586449, "mem_param_586449") != 0)
        return 1;
    defunc_0_calc_intermediate_skyline_res_572719 = loop_dz2087U_572736;
    defunc_0_calc_intermediate_skyline_res_572720 = loop_dz2081Uz2080U_572737;
    defunc_0_calc_intermediate_skyline_res_572721 = loop_dz2081Uz2081U_572738;
    defunc_0_calc_intermediate_skyline_res_572722 = loop_while_572739;
    defunc_0_calc_intermediate_skyline_res_572729 = sd_skB_572746;
    defunc_0_calc_intermediate_skyline_res_572730 = sd_skB_572747;
    defunc_0_calc_intermediate_skyline_res_572734 = i_572751;
    defunc_0_calc_intermediate_skyline_res_572735 = acc_sd_572752;
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &ext_mem_586786, "ext_mem_586786") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &ext_mem_586785, "ext_mem_586785") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &ext_mem_586784, "ext_mem_586784") != 0)
        return 1;
    prim_out_588011 = defunc_0_calc_intermediate_skyline_res_572720;
    prim_out_588012 = defunc_0_calc_intermediate_skyline_res_572721;
    if (memblock_set(ctx, &*mem_out_p_588264, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588265, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588266, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588267, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588268 = prim_out_588011;
    *out_prim_out_588269 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586451);
        free(mem_586453);
        free(mem_586475);
        free(mem_586515);
        free(mem_586517);
        free(mem_586538);
        free(mem_586548);
        free(mem_586550);
        free(mem_586564);
        free(mem_586577);
        free(mem_586590);
        free(mem_586598);
        free(mem_586606);
        free(mem_586611);
        free(mem_586622);
        free(mem_586629);
        free(mem_586636);
        free(mem_586650);
        free(mem_586652);
        free(mem_586666);
        free(mem_586693);
        free(mem_586698);
        free(mem_586706);
        free(mem_586714);
        free(mem_586719);
        free(mem_586730);
        free(mem_586741);
        free(mem_586749);
        if (memblock_unref(ctx, &mem_param_tmp_588021, "mem_param_tmp_588021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588020, "mem_param_tmp_588020") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588019, "mem_param_tmp_588019") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588018, "mem_param_tmp_588018") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588017, "mem_param_tmp_588017") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588014, "mem_param_tmp_588014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588013, "mem_param_tmp_588013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586757, "mem_586757") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586677, "mem_586677") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588063, "mem_param_tmp_588063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586585, "mem_586585") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586575, "mem_param_586575") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586648, "ext_mem_586648") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586572, "mem_586572") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586532, "mem_586532") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586546, "ext_mem_586546") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586507, "mem_586507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586455, "mem_586455") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586449, "mem_param_586449") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586446, "mem_param_586446") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586442, "mem_param_586442") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586439, "mem_param_586439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586435, "mem_param_586435") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586432, "mem_param_586432") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586429, "mem_param_586429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586426, "mem_param_586426") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586423, "mem_param_586423") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586784, "ext_mem_586784") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586785, "ext_mem_586785") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586786, "ext_mem_586786") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586787, "ext_mem_586787") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586788, "ext_mem_586788") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586789, "ext_mem_586789") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586790, "ext_mem_586790") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586791, "ext_mem_586791") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586792, "ext_mem_586792") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_intermSkyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588298, struct memblock *mem_out_p_588299, struct memblock *mem_out_p_588300, struct memblock *mem_out_p_588301, int64_t *out_prim_out_588302, int64_t *out_prim_out_588303, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_560381, int64_t dz2080U_560382, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383, int64_t dz2081U_560384, int64_t dz2082U_560385, int64_t dz2083U_560386, int64_t total_angle_no_560393, int64_t total_grid_no_560394, int64_t total_part_no_560395, bool include_angle_steps_560400, int64_t omit_step_560401, int64_t max_steps_560402, int64_t sizze_thresh_560403)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586451_cached_sizze_588304 = 0;
    unsigned char *mem_586451 = NULL;
    int64_t mem_586453_cached_sizze_588305 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586475_cached_sizze_588306 = 0;
    unsigned char *mem_586475 = NULL;
    int64_t mem_586515_cached_sizze_588307 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586517_cached_sizze_588308 = 0;
    unsigned char *mem_586517 = NULL;
    int64_t mem_586538_cached_sizze_588309 = 0;
    unsigned char *mem_586538 = NULL;
    int64_t mem_586548_cached_sizze_588310 = 0;
    unsigned char *mem_586548 = NULL;
    int64_t mem_586550_cached_sizze_588311 = 0;
    unsigned char *mem_586550 = NULL;
    int64_t mem_586564_cached_sizze_588312 = 0;
    unsigned char *mem_586564 = NULL;
    int64_t mem_586577_cached_sizze_588313 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586590_cached_sizze_588314 = 0;
    unsigned char *mem_586590 = NULL;
    int64_t mem_586598_cached_sizze_588315 = 0;
    unsigned char *mem_586598 = NULL;
    int64_t mem_586606_cached_sizze_588316 = 0;
    unsigned char *mem_586606 = NULL;
    int64_t mem_586611_cached_sizze_588317 = 0;
    unsigned char *mem_586611 = NULL;
    int64_t mem_586622_cached_sizze_588318 = 0;
    unsigned char *mem_586622 = NULL;
    int64_t mem_586629_cached_sizze_588319 = 0;
    unsigned char *mem_586629 = NULL;
    int64_t mem_586636_cached_sizze_588320 = 0;
    unsigned char *mem_586636 = NULL;
    int64_t mem_586650_cached_sizze_588321 = 0;
    unsigned char *mem_586650 = NULL;
    int64_t mem_586652_cached_sizze_588322 = 0;
    unsigned char *mem_586652 = NULL;
    int64_t mem_586666_cached_sizze_588323 = 0;
    unsigned char *mem_586666 = NULL;
    int64_t mem_586693_cached_sizze_588324 = 0;
    unsigned char *mem_586693 = NULL;
    int64_t mem_586698_cached_sizze_588325 = 0;
    unsigned char *mem_586698 = NULL;
    int64_t mem_586706_cached_sizze_588326 = 0;
    unsigned char *mem_586706 = NULL;
    int64_t mem_586714_cached_sizze_588327 = 0;
    unsigned char *mem_586714 = NULL;
    int64_t mem_586719_cached_sizze_588328 = 0;
    unsigned char *mem_586719 = NULL;
    int64_t mem_586730_cached_sizze_588329 = 0;
    unsigned char *mem_586730 = NULL;
    int64_t mem_586741_cached_sizze_588330 = 0;
    unsigned char *mem_586741 = NULL;
    int64_t mem_586749_cached_sizze_588331 = 0;
    unsigned char *mem_586749 = NULL;
    struct memblock mem_param_tmp_588021;
    
    mem_param_tmp_588021.references = NULL;
    
    struct memblock mem_param_tmp_588020;
    
    mem_param_tmp_588020.references = NULL;
    
    struct memblock mem_param_tmp_588019;
    
    mem_param_tmp_588019.references = NULL;
    
    struct memblock mem_param_tmp_588018;
    
    mem_param_tmp_588018.references = NULL;
    
    struct memblock mem_param_tmp_588017;
    
    mem_param_tmp_588017.references = NULL;
    
    struct memblock mem_param_tmp_588016;
    
    mem_param_tmp_588016.references = NULL;
    
    struct memblock mem_param_tmp_588015;
    
    mem_param_tmp_588015.references = NULL;
    
    struct memblock mem_param_tmp_588014;
    
    mem_param_tmp_588014.references = NULL;
    
    struct memblock mem_param_tmp_588013;
    
    mem_param_tmp_588013.references = NULL;
    
    struct memblock mem_586757;
    
    mem_586757.references = NULL;
    
    struct memblock mem_586677;
    
    mem_586677.references = NULL;
    
    struct memblock mem_586675;
    
    mem_586675.references = NULL;
    
    struct memblock mem_param_tmp_588063;
    
    mem_param_tmp_588063.references = NULL;
    
    struct memblock mem_586585;
    
    mem_586585.references = NULL;
    
    struct memblock mem_param_586575;
    
    mem_param_586575.references = NULL;
    
    struct memblock ext_mem_586648;
    
    ext_mem_586648.references = NULL;
    
    struct memblock mem_586572;
    
    mem_586572.references = NULL;
    
    struct memblock mem_586532;
    
    mem_586532.references = NULL;
    
    struct memblock ext_mem_586546;
    
    ext_mem_586546.references = NULL;
    
    struct memblock mem_586507;
    
    mem_586507.references = NULL;
    
    struct memblock mem_586499;
    
    mem_586499.references = NULL;
    
    struct memblock mem_586479;
    
    mem_586479.references = NULL;
    
    struct memblock mem_586477;
    
    mem_586477.references = NULL;
    
    struct memblock mem_586455;
    
    mem_586455.references = NULL;
    
    struct memblock mem_param_586449;
    
    mem_param_586449.references = NULL;
    
    struct memblock mem_param_586446;
    
    mem_param_586446.references = NULL;
    
    struct memblock mem_param_586442;
    
    mem_param_586442.references = NULL;
    
    struct memblock mem_param_586439;
    
    mem_param_586439.references = NULL;
    
    struct memblock mem_param_586435;
    
    mem_param_586435.references = NULL;
    
    struct memblock mem_param_586432;
    
    mem_param_586432.references = NULL;
    
    struct memblock mem_param_586429;
    
    mem_param_586429.references = NULL;
    
    struct memblock mem_param_586426;
    
    mem_param_586426.references = NULL;
    
    struct memblock mem_param_586423;
    
    mem_param_586423.references = NULL;
    
    struct memblock ext_mem_586784;
    
    ext_mem_586784.references = NULL;
    
    struct memblock ext_mem_586785;
    
    ext_mem_586785.references = NULL;
    
    struct memblock ext_mem_586786;
    
    ext_mem_586786.references = NULL;
    
    struct memblock ext_mem_586787;
    
    ext_mem_586787.references = NULL;
    
    struct memblock ext_mem_586788;
    
    ext_mem_586788.references = NULL;
    
    struct memblock ext_mem_586789;
    
    ext_mem_586789.references = NULL;
    
    struct memblock ext_mem_586790;
    
    ext_mem_586790.references = NULL;
    
    struct memblock ext_mem_586791;
    
    ext_mem_586791.references = NULL;
    
    struct memblock ext_mem_586792;
    
    ext_mem_586792.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_572688 = sub64(dim_560381, (int64_t) 1);
    bool assert_cond_572689 = arg_572688 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383;
    bool assert_c_572690;
    
    if (!assert_cond_572689) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:1023:25-126\n   #1  ftSkyline.fut:1015:17-1023:126\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t tmp_572691;
    
    if (include_angle_steps_560400) {
        tmp_572691 = (int64_t) 0;
    } else {
        tmp_572691 = dim_560381;
    }
    
    int64_t zl_rhs_572692 = add64(dim_560381, max_steps_560402);
    bool cond_572693 = slt64(tmp_572691, zl_rhs_572692);
    int64_t zt_lhs_572694 = sub64(tmp_572691, (int64_t) 1);
    int64_t zl_lhs_572695 = mul64(omit_step_560401, zt_lhs_572694);
    int64_t zm_lhs_572696 = mul64((int64_t) 2, dim_560381);
    int64_t zl_rhs_572697 = sub64(zm_lhs_572696, (int64_t) 1);
    bool cond_t_res_572698 = slt64(zl_lhs_572695, zl_rhs_572697);
    bool x_572699 = cond_572693 && cond_t_res_572698;
    bool loop_cond_t_res_572700 = slt64(sizze_thresh_560403, dz2083U_560386);
    bool x_572701 = x_572699 && loop_cond_t_res_572700;
    bool y_572706 = slt64((int64_t) 0, dz2080U_560382);
    bool loop_not_taken_572707 = !x_572701;
    bool protect_assert_disj_572708 = y_572706 || loop_not_taken_572707;
    bool index_certs_572709;
    
    if (!protect_assert_disj_572708) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_560382, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:1023:115-126\n   #5  ftSkyline.fut:1015:17-1023:126\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_572710 = assert_cond_572689 || loop_not_taken_572707;
    bool empty_or_match_cert_572711;
    
    if (!protect_assert_disj_572710) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:1023:115-126\n   #5  ftSkyline.fut:1015:17-1023:126\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_572714 = slt64(total_part_no_560395, (int64_t) 0);
    bool valid_572715 = !bounds_invalid_upwards_572714;
    bool protect_assert_disj_572716 = loop_not_taken_572707 || valid_572715;
    bool range_valid_c_572717;
    
    if (!protect_assert_disj_572716) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_560395, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:417:98-116\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586450 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383;
    int64_t bytes_586452 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383;
    int64_t bytes_586474 = (int64_t) 8 * dim_560381;
    int64_t bytes_586476 = (int64_t) 4 * dim_560381;
    int64_t bytes_586605 = (int64_t) 4 * arg_572688;
    int64_t bytes_586621 = (int64_t) 8 * arg_572688;
    int64_t bytes_586740 = (int64_t) 8 * total_part_no_560395;
    
    if (mem_586451_cached_sizze_588304 < bytes_586450) {
        err = lexical_realloc(ctx, &mem_586451, &mem_586451_cached_sizze_588304, bytes_586450);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586453_cached_sizze_588305 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588305, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586475_cached_sizze_588306 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586475, &mem_586475_cached_sizze_588306, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586577_cached_sizze_588313 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588313, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586590_cached_sizze_588314 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586590, &mem_586590_cached_sizze_588314, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586598_cached_sizze_588315 < bytes_586476) {
        err = lexical_realloc(ctx, &mem_586598, &mem_586598_cached_sizze_588315, bytes_586476);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586606_cached_sizze_588316 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586606, &mem_586606_cached_sizze_588316, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586622_cached_sizze_588318 < bytes_586621) {
        err = lexical_realloc(ctx, &mem_586622, &mem_586622_cached_sizze_588318, bytes_586621);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586698_cached_sizze_588325 < bytes_586474) {
        err = lexical_realloc(ctx, &mem_586698, &mem_586698_cached_sizze_588325, bytes_586474);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586706_cached_sizze_588326 < bytes_586476) {
        err = lexical_realloc(ctx, &mem_586706, &mem_586706_cached_sizze_588326, bytes_586476);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586714_cached_sizze_588327 < bytes_586605) {
        err = lexical_realloc(ctx, &mem_586714, &mem_586714_cached_sizze_588327, bytes_586605);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586730_cached_sizze_588329 < bytes_586621) {
        err = lexical_realloc(ctx, &mem_586730, &mem_586730_cached_sizze_588329, bytes_586621);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586741_cached_sizze_588330 < bytes_586740) {
        err = lexical_realloc(ctx, &mem_586741, &mem_586741_cached_sizze_588330, bytes_586740);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586749_cached_sizze_588331 < bytes_586740) {
        err = lexical_realloc(ctx, &mem_586749, &mem_586749_cached_sizze_588331, bytes_586740);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t defunc_0_calc_intermediate_skyline_res_572719;
    int64_t defunc_0_calc_intermediate_skyline_res_572720;
    int64_t defunc_0_calc_intermediate_skyline_res_572721;
    bool defunc_0_calc_intermediate_skyline_res_572722;
    int64_t defunc_0_calc_intermediate_skyline_res_572729;
    int64_t defunc_0_calc_intermediate_skyline_res_572730;
    int64_t defunc_0_calc_intermediate_skyline_res_572734;
    int64_t defunc_0_calc_intermediate_skyline_res_572735;
    int64_t loop_dz2087U_572736;
    int64_t loop_dz2081Uz2080U_572737;
    int64_t loop_dz2081Uz2081U_572738;
    bool loop_while_572739;
    int64_t sd_skB_572746;
    int64_t sd_skB_572747;
    int64_t i_572751;
    int64_t acc_sd_572752;
    
    if (memblock_set(ctx, &mem_param_586423, &angle_part_prefix_sum_mem_586411, "angle_part_prefix_sum_mem_586411") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586426, &angle_partitions_per_dim_mem_586412, "angle_partitions_per_dim_mem_586412") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586429, &grid_part_prefix_sum_mem_586413, "grid_part_prefix_sum_mem_586413") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586432, &grid_part_sizze_per_dim_mem_586414, "grid_part_sizze_per_dim_mem_586414") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586435, &grid_partitions_per_dim_mem_586415, "grid_partitions_per_dim_mem_586415") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586439, &start_of_grid_partition_mem_586416, "start_of_grid_partition_mem_586416") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586442, &part_idx_mem_586418, "part_idx_mem_586418") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586446, &xys_mem_586419, "xys_mem_586419") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_586449, &xys_mem_586420, "xys_mem_586420") != 0)
        return 1;
    loop_dz2087U_572736 = dz2080U_560382;
    loop_dz2081Uz2080U_572737 = dz2082U_560385;
    loop_dz2081Uz2081U_572738 = dz2083U_560386;
    loop_while_572739 = x_572701;
    sd_skB_572746 = total_angle_no_560393;
    sd_skB_572747 = total_grid_no_560394;
    i_572751 = tmp_572691;
    acc_sd_572752 = (int64_t) 1;
    while (loop_while_572739) {
        int64_t min_arg0_572753 = mul64(omit_step_560401, i_572751);
        int64_t min_res_572754 = smin64(zl_rhs_572697, min_arg0_572753);
        bool cond_572755 = sle64(dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383, min_res_572754);
        bool x_572756 = !cond_572755;
        bool x_572757 = sle64((int64_t) 0, min_res_572754);
        bool y_572758 = slt64(min_res_572754, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383);
        bool bounds_check_572759 = x_572757 && y_572758;
        bool protect_assert_disj_572760 = cond_572755 || bounds_check_572759;
        bool index_certs_572761;
        
        if (!protect_assert_disj_572760) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_572754, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383, "].", "-> #0  ftSkyline.fut:583:22-58\n   #1  ftSkyline.fut:654:130-136\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t angle_no_omitted_f_res_572762;
        
        if (x_572756) {
            int64_t x_583310 = ((int64_t *) mem_param_586423.mem)[min_res_572754];
            
            angle_no_omitted_f_res_572762 = x_583310;
        } else {
            angle_no_omitted_f_res_572762 = (int64_t) 0;
        }
        
        int64_t angle_no_omitted_572764;
        
        if (cond_572755) {
            angle_no_omitted_572764 = sd_skB_572746;
        } else {
            angle_no_omitted_572764 = angle_no_omitted_f_res_572762;
        }
        
        bool cond_572765 = sle64(min_res_572754, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383);
        bool x_572766 = !cond_572765;
        bool cond_572767 = min_res_572754 == zl_rhs_572697;
        bool x_572768 = !cond_572767;
        int64_t zp_lhs_572769 = sub64(min_res_572754, dim_560381);
        int64_t tmp_572770 = add64((int64_t) 1, zp_lhs_572769);
        bool x_572771 = sle64((int64_t) 0, tmp_572770);
        bool y_572772 = slt64(tmp_572770, dim_560381);
        bool bounds_check_572773 = x_572771 && y_572772;
        bool protect_assert_disj_572774 = cond_572767 || bounds_check_572773;
        bool protect_assert_disj_572775 = cond_572765 || protect_assert_disj_572774;
        bool index_certs_572776;
        
        if (!protect_assert_disj_572775) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_572770, "] out of bounds for array of shape [", (long long) dim_560381, "].", "-> #0  ftSkyline.fut:588:22-63\n   #1  ftSkyline.fut:654:130-136\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool protect_cond_conj_572777 = x_572766 && x_572768;
        int64_t grid_no_omitted_f_res_f_res_572778;
        
        if (protect_cond_conj_572777) {
            int64_t x_583311 = ((int64_t *) mem_param_586429.mem)[tmp_572770];
            
            grid_no_omitted_f_res_f_res_572778 = x_583311;
        } else {
            grid_no_omitted_f_res_f_res_572778 = (int64_t) 0;
        }
        
        int64_t grid_no_omitted_f_res_572780;
        
        if (cond_572767) {
            grid_no_omitted_f_res_572780 = sd_skB_572747;
        } else {
            grid_no_omitted_f_res_572780 = grid_no_omitted_f_res_f_res_572778;
        }
        
        int64_t grid_no_omitted_572781;
        
        if (cond_572765) {
            grid_no_omitted_572781 = (int64_t) 1;
        } else {
            grid_no_omitted_572781 = grid_no_omitted_f_res_572780;
        }
        if (memblock_alloc(ctx, &mem_586455, bytes_586450, "mem_586455")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t discard_586060;
        int64_t defunc_res_583359;
        int64_t scanacc_586051;
        int64_t redout_586053;
        
        scanacc_586051 = (int64_t) 1;
        redout_586053 = (int64_t) 1;
        for (int64_t i_586056 = 0; i_586056 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383; i_586056++) {
            int64_t eta_p_582647 = ((int64_t *) mem_param_586426.mem)[i_586056];
            bool cond_582649 = slt64(i_586056, min_res_572754);
            int64_t lifted_lambda_res_582650;
            
            if (cond_582649) {
                lifted_lambda_res_582650 = (int64_t) 1;
            } else {
                lifted_lambda_res_582650 = eta_p_582647;
            }
            
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582658 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586056];
            float i64_res_582659 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582658);
            float defunc_0_fover_res_582660 = 1.5707964F / i64_res_582659;
            int64_t defunc_0_op_res_572796 = mul64(lifted_lambda_res_582650, scanacc_586051);
            int64_t zt_res_582440 = mul64(lifted_lambda_res_582650, redout_586053);
            
            ((int64_t *) mem_586451)[i_586056] = defunc_0_op_res_572796;
            ((float *) mem_586453)[i_586056] = defunc_0_fover_res_582660;
            ((int64_t *) mem_586455.mem)[i_586056] = lifted_lambda_res_582650;
            
            int64_t scanacc_tmp_588039 = defunc_0_op_res_572796;
            int64_t redout_tmp_588041 = zt_res_582440;
            
            scanacc_586051 = scanacc_tmp_588039;
            redout_586053 = redout_tmp_588041;
        }
        discard_586060 = scanacc_586051;
        defunc_res_583359 = redout_586053;
        if (memblock_alloc(ctx, &mem_586477, bytes_586476, "mem_586477")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_586479, bytes_586474, "mem_586479")) {
            err = 1;
            goto cleanup;
        }
        
        int64_t discard_586073;
        int64_t defunc_res_583363;
        int64_t scanacc_586064;
        int64_t redout_586066;
        
        scanacc_586064 = (int64_t) 1;
        redout_586066 = (int64_t) 1;
        for (int64_t i_586069 = 0; i_586069 < dim_560381; i_586069++) {
            int64_t eta_p_582665 = ((int64_t *) mem_param_586435.mem)[i_586069];
            bool cond_582667 = slt64(i_586069, tmp_572770);
            int64_t lifted_lambda_res_582668;
            
            if (cond_582667) {
                lifted_lambda_res_582668 = (int64_t) 1;
            } else {
                lifted_lambda_res_582668 = eta_p_582665;
            }
            
            bool cond_582672 = slt64(zp_lhs_572769, i_586069);
            float defunc_0_f_res_582673;
            
            if (cond_582672) {
                float defunc_0_f_res_t_res_583316 = ((float *) mem_param_586432.mem)[i_586069];
                
                defunc_0_f_res_582673 = defunc_0_f_res_t_res_583316;
            } else {
                float i64_res_582684 = sitofp_i64_f32(eta_p_582665);
                float dzlz7bUskOpzitimesz7dUzg_arg0_582685 = ((float *) mem_param_586432.mem)[i_586069];
                float defunc_0_times_res_582686 = i64_res_582684 * dzlz7bUskOpzitimesz7dUzg_arg0_582685;
                
                defunc_0_f_res_582673 = defunc_0_times_res_582686;
            }
            
            int64_t defunc_0_op_res_572811 = mul64(lifted_lambda_res_582668, scanacc_586064);
            int64_t zt_res_582447 = mul64(lifted_lambda_res_582668, redout_586066);
            
            ((int64_t *) mem_586475)[i_586069] = defunc_0_op_res_572811;
            ((float *) mem_586477.mem)[i_586069] = defunc_0_f_res_582673;
            ((int64_t *) mem_586479.mem)[i_586069] = lifted_lambda_res_582668;
            
            int64_t scanacc_tmp_588044 = defunc_0_op_res_572811;
            int64_t redout_tmp_588046 = zt_res_582447;
            
            scanacc_586064 = scanacc_tmp_588044;
            redout_586066 = redout_tmp_588046;
        }
        discard_586073 = scanacc_586064;
        defunc_res_583363 = redout_586066;
        if (memblock_alloc(ctx, &mem_586499, bytes_586450, "mem_586499")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586076 = 0; i_586076 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383; i_586076++) {
            int64_t zv_lhs_582609 = add64((int64_t) -1, i_586076);
            int64_t tmp_582610 = smod64(zv_lhs_582609, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383);
            int64_t lifted_lambda_res_582611 = ((int64_t *) mem_586451)[tmp_582610];
            bool cond_582613 = i_586076 == (int64_t) 0;
            int64_t lifted_lambda_res_582614;
            
            if (cond_582613) {
                lifted_lambda_res_582614 = (int64_t) 1;
            } else {
                lifted_lambda_res_582614 = lifted_lambda_res_582611;
            }
            ((int64_t *) mem_586499.mem)[i_586076] = lifted_lambda_res_582614;
        }
        if (memblock_alloc(ctx, &mem_586507, bytes_586474, "mem_586507")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586080 = 0; i_586080 < dim_560381; i_586080++) {
            int64_t zv_lhs_582600 = add64((int64_t) -1, i_586080);
            int64_t tmp_582601 = smod64(zv_lhs_582600, dim_560381);
            int64_t lifted_lambda_res_582602 = ((int64_t *) mem_586475)[tmp_582601];
            bool cond_582604 = i_586080 == (int64_t) 0;
            int64_t lifted_lambda_res_582605;
            
            if (cond_582604) {
                lifted_lambda_res_582605 = (int64_t) 1;
            } else {
                lifted_lambda_res_582605 = lifted_lambda_res_582602;
            }
            ((int64_t *) mem_586507.mem)[i_586080] = lifted_lambda_res_582605;
        }
        
        bool eq_x_y_572824 = (int64_t) 0 == sd_skB_572747;
        bool eq_x_zz_572825 = (int64_t) 0 == grid_no_omitted_f_res_f_res_572778;
        bool p_and_eq_x_y_572826 = cond_572767 && eq_x_y_572824;
        bool p_and_eq_x_y_572827 = x_572768 && eq_x_zz_572825;
        bool eq_x_zz_572828 = p_and_eq_x_y_572826 || p_and_eq_x_y_572827;
        bool p_and_eq_x_y_572829 = x_572766 && eq_x_zz_572828;
        bool nonzzero_572830 = !p_and_eq_x_y_572829;
        bool protect_assert_disj_572831 = cond_572765 || nonzzero_572830;
        bool nonzzero_cert_572832;
        
        if (!protect_assert_disj_572831) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:604:48-65\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:654:130-136\n   #5  ftSkyline.fut:1023:115-126\n   #6  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool cond_572833 = loop_dz2087U_572736 == (int64_t) 0;
        bool x_572834 = !cond_572833;
        int64_t tmp_572835 = sub64(loop_dz2087U_572736, (int64_t) 1);
        bool x_572836 = sle64((int64_t) 0, tmp_572835);
        bool y_572837 = slt64(tmp_572835, loop_dz2087U_572736);
        bool bounds_check_572838 = x_572836 && y_572837;
        bool protect_assert_disj_572839 = cond_572833 || bounds_check_572838;
        bool protect_assert_disj_572840 = cond_572765 || protect_assert_disj_572839;
        bool index_certs_572841;
        
        if (!protect_assert_disj_572840) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_572835, "] out of bounds for array of shape [", (long long) loop_dz2087U_572736, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:654:130-136\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_586514 = (int64_t) 8 * loop_dz2087U_572736;
        int64_t new_starts_572842;
        
        if (cond_572765) {
            if (memblock_set(ctx, &ext_mem_586546, &mem_param_586439, "mem_param_586439") != 0)
                return 1;
            new_starts_572842 = loop_dz2087U_572736;
        } else {
            if (mem_586515_cached_sizze_588307 < bytes_586514) {
                err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588307, bytes_586514);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586517_cached_sizze_588308 < bytes_586514) {
                err = lexical_realloc(ctx, &mem_586517, &mem_586517_cached_sizze_588308, bytes_586514);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_586090;
            int64_t scanacc_586084 = (int64_t) 0;
            
            for (int64_t i_586087 = 0; i_586087 < loop_dz2087U_572736; i_586087++) {
                int64_t zeze_lhs_582704 = smod64(i_586087, grid_no_omitted_572781);
                bool lifted_lambda_res_582705 = zeze_lhs_582704 == (int64_t) 0;
                int64_t defunc_0_f_res_582706 = btoi_bool_i64(lifted_lambda_res_582705);
                int64_t defunc_0_op_res_572854 = add64(defunc_0_f_res_582706, scanacc_586084);
                
                ((int64_t *) mem_586515)[i_586087] = defunc_0_op_res_572854;
                ((int64_t *) mem_586517)[i_586087] = defunc_0_f_res_582706;
                
                int64_t scanacc_tmp_588051 = defunc_0_op_res_572854;
                
                scanacc_586084 = scanacc_tmp_588051;
            }
            discard_586090 = scanacc_586084;
            
            int64_t m_f_res_572855;
            
            if (x_572834) {
                int64_t x_583317 = ((int64_t *) mem_586515)[tmp_572835];
                
                m_f_res_572855 = x_583317;
            } else {
                m_f_res_572855 = (int64_t) 0;
            }
            
            int64_t m_572857;
            
            if (cond_572833) {
                m_572857 = (int64_t) 0;
            } else {
                m_572857 = m_f_res_572855;
            }
            
            int64_t m_572867 = sub64(m_572857, (int64_t) 1);
            bool i_p_m_t_s_leq_w_572869 = slt64(m_572867, loop_dz2087U_572736);
            bool zzero_leq_i_p_m_t_s_572868 = sle64((int64_t) 0, m_572867);
            bool y_572871 = zzero_leq_i_p_m_t_s_572868 && i_p_m_t_s_leq_w_572869;
            bool i_lte_j_572870 = sle64((int64_t) 0, m_572857);
            bool forwards_ok_572872 = i_lte_j_572870 && y_572871;
            bool eq_x_zz_572864 = (int64_t) 0 == m_f_res_572855;
            bool p_and_eq_x_y_572865 = x_572834 && eq_x_zz_572864;
            bool empty_slice_572866 = cond_572833 || p_and_eq_x_y_572865;
            bool ok_or_empty_572873 = empty_slice_572866 || forwards_ok_572872;
            bool index_certs_572874;
            
            if (!ok_or_empty_572873) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_572857, "] out of bounds for array of shape [", (long long) loop_dz2087U_572736, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:654:130-136\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_586530 = (int64_t) 4 * m_572857;
            int64_t bytes_586531 = dim_560381 * binop_x_586530;
            
            if (memblock_alloc(ctx, &mem_586532, bytes_586531, "mem_586532")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_586532.mem, (int64_t) 0, (int64_t []) {dim_560381, (int64_t) 1}, (uint32_t *) mem_param_586439.mem, (int64_t) 0, (int64_t []) {dim_560381, (int64_t) 1}, (int64_t []) {m_572857, dim_560381});
            if (mem_586538_cached_sizze_588309 < bytes_586476) {
                err = lexical_realloc(ctx, &mem_586538, &mem_586538_cached_sizze_588309, bytes_586476);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t write_iter_586091 = 0; write_iter_586091 < loop_dz2087U_572736; write_iter_586091++) {
                int64_t write_iv_586093 = ((int64_t *) mem_586517)[write_iter_586091];
                int64_t write_iv_586094 = ((int64_t *) mem_586515)[write_iter_586091];
                
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586538, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586439.mem, (int64_t) 0 + write_iter_586091 * dim_560381, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_560381});
                
                bool cond_582698 = write_iv_586093 == (int64_t) 1;
                int64_t lifted_lambda_res_582699;
                
                if (cond_582698) {
                    int64_t lifted_lambda_res_t_res_583318 = sub64(write_iv_586094, (int64_t) 1);
                    
                    lifted_lambda_res_582699 = lifted_lambda_res_t_res_583318;
                } else {
                    lifted_lambda_res_582699 = (int64_t) -1;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_582699) && slt64(lifted_lambda_res_582699, m_572857)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_560381 - (int64_t) 1, dim_560381))) {
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586532.mem, lifted_lambda_res_582699 * dim_560381, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586538, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_560381});
                }
            }
            if (memblock_set(ctx, &ext_mem_586546, &mem_586532, "mem_586532") != 0)
                return 1;
            new_starts_572842 = m_572857;
        }
        
        int64_t new_skB_572897 = mul64(defunc_res_583359, defunc_res_583363);
        int64_t bytes_586547 = (int64_t) 8 * loop_dz2081Uz2080U_572737;
        
        if (mem_586548_cached_sizze_588310 < bytes_586547) {
            err = lexical_realloc(ctx, &mem_586548, &mem_586548_cached_sizze_588310, bytes_586547);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586550_cached_sizze_588311 < bytes_586547) {
            err = lexical_realloc(ctx, &mem_586550, &mem_586550_cached_sizze_588311, bytes_586547);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_586105;
        int64_t scanacc_586099 = (int64_t) 0;
        
        for (int64_t i_586102 = 0; i_586102 < loop_dz2081Uz2080U_572737; i_586102++) {
            int64_t defunc_0_f_res_582593;
            
            if (futrts_lifted_lambda_13310(ctx, &defunc_0_f_res_582593, acc_sd_572752, angle_no_omitted_572764, grid_no_omitted_572781, i_586102) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_0_f_res_582595;
            
            if (futrts_lifted_lambda_13311(ctx, &defunc_0_f_res_582595, defunc_0_f_res_582593) != 0) {
                err = 1;
                goto cleanup;
            }
            
            int64_t defunc_0_op_res_572909 = add64(defunc_0_f_res_582595, scanacc_586099);
            
            ((int64_t *) mem_586548)[i_586102] = defunc_0_op_res_572909;
            ((int64_t *) mem_586550)[i_586102] = defunc_0_f_res_582593;
            
            int64_t scanacc_tmp_588055 = defunc_0_op_res_572909;
            
            scanacc_586099 = scanacc_tmp_588055;
        }
        discard_586105 = scanacc_586099;
        
        int64_t bytes_586563 = (int64_t) 8 * new_skB_572897;
        
        if (mem_586564_cached_sizze_588312 < bytes_586563) {
            err = lexical_realloc(ctx, &mem_586564, &mem_586564_cached_sizze_588312, bytes_586563);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588058 = 0; nest_i_588058 < new_skB_572897; nest_i_588058++) {
            ((int64_t *) mem_586564)[nest_i_588058] = (int64_t) 0;
        }
        for (int64_t write_iter_586106 = 0; write_iter_586106 < loop_dz2081Uz2080U_572737; write_iter_586106++) {
            int64_t write_iv_586109 = ((int64_t *) mem_586550)[write_iter_586106];
            int64_t write_iv_586110 = ((int64_t *) mem_param_586442.mem)[write_iter_586106];
            int64_t zv_lhs_582577 = add64((int64_t) -1, write_iter_586106);
            int64_t tmp_582578 = smod64(zv_lhs_582577, loop_dz2081Uz2080U_572737);
            int64_t lifted_lambda_res_582579 = ((int64_t *) mem_586548)[tmp_582578];
            bool cond_582581 = write_iter_586106 == (int64_t) 0;
            int64_t lifted_lambda_res_582582;
            
            if (cond_582581) {
                lifted_lambda_res_582582 = (int64_t) 0;
            } else {
                lifted_lambda_res_582582 = lifted_lambda_res_582579;
            }
            
            bool cond_582584 = slt64(write_iv_586109, (int64_t) 0);
            int64_t lifted_lambda_res_582585;
            
            if (cond_582584) {
                lifted_lambda_res_582585 = (int64_t) -1;
            } else {
                lifted_lambda_res_582585 = lifted_lambda_res_582582;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_582585) && slt64(lifted_lambda_res_582585, new_skB_572897)) {
                ((int64_t *) mem_586564)[lifted_lambda_res_582585] = write_iv_586110;
            }
        }
        
        int64_t zeze_rhs_572930 = sub64(new_skB_572897, (int64_t) 1);
        int64_t defunc_0_reduce_res_583371;
        int64_t redout_586112 = (int64_t) -9223372036854775808;
        
        for (int64_t i_586113 = 0; i_586113 < new_skB_572897; i_586113++) {
            bool cond_582533 = i_586113 == zeze_rhs_572930;
            int64_t lifted_lambda_res_582534;
            
            if (cond_582533) {
                int64_t zm_rhs_583326 = ((int64_t *) mem_586564)[i_586113];
                int64_t lifted_lambda_res_t_res_583327 = sub64(loop_dz2081Uz2081U_572738, zm_rhs_583326);
                
                lifted_lambda_res_582534 = lifted_lambda_res_t_res_583327;
            } else {
                int64_t zm_lhs_582541 = add64((int64_t) 1, i_586113);
                bool x_582542 = sle64((int64_t) 0, zm_lhs_582541);
                bool y_582543 = slt64(zm_lhs_582541, new_skB_572897);
                bool bounds_check_582544 = x_582542 && y_582543;
                bool index_certs_582545;
                
                if (!bounds_check_582544) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582541, "] out of bounds for array of shape [", (long long) new_skB_572897, "].", "-> #0  ftSkyline.fut:376:38-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zm_lhs_582546 = ((int64_t *) mem_586564)[zm_lhs_582541];
                int64_t zm_rhs_582551 = ((int64_t *) mem_586564)[i_586113];
                int64_t lifted_lambda_res_f_res_582552 = sub64(zm_lhs_582546, zm_rhs_582551);
                
                lifted_lambda_res_582534 = lifted_lambda_res_f_res_582552;
            }
            
            int64_t max_res_572957 = smax64(lifted_lambda_res_582534, redout_586112);
            int64_t redout_tmp_588060 = max_res_572957;
            
            redout_586112 = redout_tmp_588060;
        }
        defunc_0_reduce_res_583371 = redout_586112;
        
        int64_t bytes_586571 = (int64_t) 8 * loop_dz2081Uz2081U_572738;
        
        if (memblock_alloc(ctx, &mem_586572, bytes_586571, "mem_586572")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_588061 = 0; i_588061 < loop_dz2081Uz2081U_572738; i_588061++) {
            int64_t x_588062 = (int64_t) 0 + i_588061 * (int64_t) 1;
            
            ((int64_t *) mem_586572.mem)[i_588061] = x_588062;
        }
        
        bool bounds_invalid_upwards_572959 = slt64(defunc_0_reduce_res_583371, (int64_t) 0);
        bool valid_572960 = !bounds_invalid_upwards_572959;
        bool range_valid_c_572961;
        
        if (!valid_572960) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_0_reduce_res_583371, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:380:65-83\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t min_arg1_572962 = sub64(loop_dz2081Uz2081U_572738, (int64_t) 1);
        bool loop_nonempty_572963 = slt64((int64_t) 0, defunc_0_reduce_res_583371);
        bool y_572964 = slt64((int64_t) 0, new_starts_572842);
        bool loop_not_taken_572965 = !loop_nonempty_572963;
        bool protect_assert_disj_572966 = y_572964 || loop_not_taken_572965;
        bool index_certs_572967;
        
        if (!protect_assert_disj_572966) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) new_starts_572842, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool protect_assert_disj_572968 = assert_cond_572689 || loop_not_taken_572965;
        bool empty_or_match_cert_572969;
        
        if (!protect_assert_disj_572968) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &mem_param_586575, &mem_586572, "mem_586572") != 0)
            return 1;
        for (int64_t i_572973 = 0; i_572973 < defunc_0_reduce_res_583371; i_572973++) {
            for (int64_t i_586116 = 0; i_586116 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383; i_586116++) {
                int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572982 = ((int64_t *) mem_586455.mem)[i_586116];
                float i64_res_572983 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572982);
                float defunc_0_fover_res_572984 = 1.5707964F / i64_res_572983;
                
                ((float *) mem_586577)[i_586116] = defunc_0_fover_res_572984;
            }
            if (memblock_alloc(ctx, &mem_586585, bytes_586571, "mem_586585")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_586144 = 0; i_586144 < loop_dz2081Uz2081U_572738; i_586144++) {
                for (int64_t i_586120 = 0; i_586120 < dim_560381; i_586120++) {
                    float eta_p_583059 = ((float *) mem_param_586446.mem)[i_586144 * dim_560381 + i_586120];
                    float eta_p_583060 = ((float *) ext_mem_586546.mem)[i_586120];
                    float eta_p_583061 = ((float *) mem_586477.mem)[i_586120];
                    int64_t eta_p_583063 = ((int64_t *) mem_586507.mem)[i_586120];
                    float defunc_0_f_res_583064 = eta_p_583059 - eta_p_583060;
                    float defunc_0_f_res_583066 = defunc_0_f_res_583064 / eta_p_583061;
                    int64_t f32_res_583068 = fptosi_f32_i64(defunc_0_f_res_583066);
                    int64_t max_res_583070 = smax64((int64_t) 0, f32_res_583068);
                    int64_t zm_lhs_583076 = ((int64_t *) mem_586479.mem)[i_586120];
                    int64_t min_arg1_583077 = sub64(zm_lhs_583076, (int64_t) 1);
                    int64_t min_res_583078 = smin64(max_res_583070, min_arg1_583077);
                    int64_t defunc_0_f_res_583080 = mul64(eta_p_583063, min_res_583078);
                    
                    ((int64_t *) mem_586590)[i_586120] = defunc_0_f_res_583080;
                }
                
                int64_t defunc_0_foldl_res_582882;
                int64_t acc_582884 = (int64_t) 0;
                
                for (int64_t i_582883 = 0; i_582883 < dim_560381; i_582883++) {
                    int64_t b_582885 = ((int64_t *) mem_586590)[i_582883];
                    int64_t defunc_0_f_res_582886 = add64(acc_582884, b_582885);
                    int64_t acc_tmp_588068 = defunc_0_f_res_582886;
                    
                    acc_582884 = acc_tmp_588068;
                }
                defunc_0_foldl_res_582882 = acc_582884;
                
                bool x_582887 = sle64((int64_t) 0, defunc_0_foldl_res_582882);
                bool y_582888 = slt64(defunc_0_foldl_res_582882, new_starts_572842);
                bool bounds_check_582889 = x_582887 && y_582888;
                bool index_certs_582890;
                
                if (!bounds_check_582889) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582882, "] out of bounds for array of shape [", (long long) new_starts_572842, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                for (int64_t i_586124 = 0; i_586124 < dim_560381; i_586124++) {
                    float eta_p_582893 = ((float *) mem_param_586446.mem)[i_586144 * dim_560381 + i_586124];
                    float eta_p_582894 = ((float *) ext_mem_586546.mem)[defunc_0_foldl_res_582882 * dim_560381 + i_586124];
                    float defunc_0_f_res_582895 = eta_p_582893 - eta_p_582894;
                    
                    ((float *) mem_586598)[i_586124] = defunc_0_f_res_582895;
                }
                for (int64_t nest_i_588070 = 0; nest_i_588070 < arg_572688; nest_i_588070++) {
                    ((float *) mem_586606)[nest_i_588070] = 0.0F;
                }
                for (int64_t i_582898 = 0; i_582898 < arg_572688; i_582898++) {
                    bool y_582900 = slt64(i_582898, dim_560381);
                    bool index_certs_582901;
                    
                    if (!y_582900) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582898, "] out of bounds for array of shape [", (long long) dim_560381, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t map_arg1_582903 = add64((int64_t) 1, i_582898);
                    int64_t j_m_i_582904 = sub64(dim_560381, map_arg1_582903);
                    bool empty_slice_582905 = j_m_i_582904 == (int64_t) 0;
                    int64_t m_582906 = sub64(j_m_i_582904, (int64_t) 1);
                    int64_t i_p_m_t_s_582907 = add64(map_arg1_582903, m_582906);
                    bool zzero_leq_i_p_m_t_s_582908 = sle64((int64_t) 0, i_p_m_t_s_582907);
                    bool i_p_m_t_s_leq_w_582909 = slt64(i_p_m_t_s_582907, dim_560381);
                    bool zzero_lte_i_582910 = sle64((int64_t) 0, map_arg1_582903);
                    bool i_lte_j_582911 = sle64(map_arg1_582903, dim_560381);
                    bool y_582912 = i_p_m_t_s_leq_w_582909 && zzero_lte_i_582910;
                    bool y_582913 = zzero_leq_i_p_m_t_s_582908 && y_582912;
                    bool forwards_ok_582914 = i_lte_j_582911 && y_582913;
                    bool ok_or_empty_582915 = empty_slice_582905 || forwards_ok_582914;
                    bool index_certs_582916;
                    
                    if (!ok_or_empty_582915) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582903, ":", (long long) dim_560381, "] out of bounds for array of shape [", (long long) dim_560381, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_586610 = (int64_t) 4 * j_m_i_582904;
                    float this_x_582902 = ((float *) mem_586598)[i_582898];
                    
                    if (mem_586611_cached_sizze_588317 < bytes_586610) {
                        err = lexical_realloc(ctx, &mem_586611, &mem_586611_cached_sizze_588317, bytes_586610);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586128 = 0; i_586128 < j_m_i_582904; i_586128++) {
                        int64_t slice_586367 = map_arg1_582903 + i_586128;
                        float eta_p_582919 = ((float *) mem_586598)[slice_586367];
                        float defunc_0_ftimes_res_582920 = eta_p_582919 * eta_p_582919;
                        
                        ((float *) mem_586611)[i_586128] = defunc_0_ftimes_res_582920;
                    }
                    
                    float defunc_0_foldl_res_582921;
                    float acc_582923 = 0.0F;
                    
                    for (int64_t i_582922 = 0; i_582922 < j_m_i_582904; i_582922++) {
                        float b_582924 = ((float *) mem_586611)[i_582922];
                        float defunc_0_f_res_582925 = acc_582923 + b_582924;
                        float acc_tmp_588073 = defunc_0_f_res_582925;
                        
                        acc_582923 = acc_tmp_588073;
                    }
                    defunc_0_foldl_res_582921 = acc_582923;
                    
                    float sqrt_res_582926 = futrts_sqrt32(defunc_0_foldl_res_582921);
                    float atan2_res_582927 = futrts_atan2_32(sqrt_res_582926, this_x_582902);
                    
                    ((float *) mem_586606)[i_582898] = atan2_res_582927;
                }
                for (int64_t i_586132 = 0; i_586132 < arg_572688; i_586132++) {
                    float eta_p_582930 = ((float *) mem_586606)[i_586132];
                    float eta_p_582931 = ((float *) mem_586577)[i_586132];
                    int64_t eta_p_582932 = ((int64_t *) mem_586499.mem)[i_586132];
                    int64_t eta_p_582933 = ((int64_t *) mem_586455.mem)[i_586132];
                    float i64_res_582934 = sitofp_i64_f32(eta_p_582932);
                    float defunc_0_fover_res_582935 = eta_p_582930 / eta_p_582931;
                    float defunc_0_ftimes_res_582936 = i64_res_582934 * defunc_0_fover_res_582935;
                    int64_t f32_res_582937 = fptosi_f32_i64(defunc_0_ftimes_res_582936);
                    bool cond_582938 = slt64(f32_res_582937, (int64_t) 0);
                    int64_t defunc_0_f_res_582939;
                    
                    if (cond_582938) {
                        defunc_0_f_res_582939 = (int64_t) 0;
                    } else {
                        bool cond_582940 = sle64(eta_p_582933, f32_res_582937);
                        int64_t defunc_0_f_res_f_res_582941;
                        
                        if (cond_582940) {
                            int64_t defunc_0_f_res_f_res_t_res_583330 = sub64(eta_p_582933, (int64_t) 1);
                            
                            defunc_0_f_res_f_res_582941 = defunc_0_f_res_f_res_t_res_583330;
                        } else {
                            defunc_0_f_res_f_res_582941 = f32_res_582937;
                        }
                        defunc_0_f_res_582939 = defunc_0_f_res_f_res_582941;
                    }
                    ((int64_t *) mem_586622)[i_586132] = defunc_0_f_res_582939;
                }
                
                int64_t defunc_0_foldl_res_582943;
                int64_t acc_582945 = (int64_t) 0;
                
                for (int64_t i_582944 = 0; i_582944 < arg_572688; i_582944++) {
                    int64_t b_582946 = ((int64_t *) mem_586622)[i_582944];
                    int64_t defunc_0_f_res_582947 = add64(acc_582945, b_582946);
                    int64_t acc_tmp_588075 = defunc_0_f_res_582947;
                    
                    acc_582945 = acc_tmp_588075;
                }
                defunc_0_foldl_res_582943 = acc_582945;
                
                int64_t zp_lhs_582950 = mul64(defunc_0_foldl_res_582882, defunc_res_583359);
                int64_t get_id_from_grid_angle_res_582951 = add64(defunc_0_foldl_res_582943, zp_lhs_582950);
                bool x_582953 = sle64((int64_t) 0, get_id_from_grid_angle_res_582951);
                bool y_582954 = slt64(get_id_from_grid_angle_res_582951, new_skB_572897);
                bool bounds_check_582955 = x_582953 && y_582954;
                bool index_certs_582956;
                
                if (!bounds_check_582955) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582951, "] out of bounds for array of shape [", (long long) new_skB_572897, "].", "-> #0  ftSkyline.fut:389:73-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zp_lhs_582957 = ((int64_t *) mem_586564)[get_id_from_grid_angle_res_582951];
                int64_t min_arg0_582958 = add64(i_572973, zp_lhs_582957);
                int64_t min_res_582959 = smin64(min_arg1_572962, min_arg0_582958);
                bool x_582961 = sle64((int64_t) 0, min_res_582959);
                bool y_582962 = slt64(min_res_582959, loop_dz2081Uz2081U_572738);
                bool bounds_check_582963 = x_582961 && y_582962;
                bool index_certs_582964;
                
                if (!bounds_check_582963) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_582959, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:390:56-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:390:44-70\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t eta_p_582852 = ((int64_t *) mem_param_586575.mem)[i_586144];
                bool cond_582967 = slt64(eta_p_582852, (int64_t) 0);
                bool x_582969 = !cond_582967;
                bool cond_f_res_582968 = eta_p_582852 == i_572973;
                bool y_582970 = cond_f_res_582968 && x_582969;
                bool cond_582971 = cond_582967 || y_582970;
                int64_t defunc_0_f_res_582972;
                
                if (cond_582971) {
                    defunc_0_f_res_582972 = eta_p_582852;
                } else {
                    if (mem_586629_cached_sizze_588319 < dim_560381) {
                        err = lexical_realloc(ctx, &mem_586629, &mem_586629_cached_sizze_588319, dim_560381);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586136 = 0; i_586136 < dim_560381; i_586136++) {
                        float eta_p_582974 = ((float *) mem_param_586446.mem)[i_586144 * dim_560381 + i_586136];
                        float eta_p_582975 = ((float *) mem_param_586446.mem)[min_res_582959 * dim_560381 + i_586136];
                        bool defunc_0_f_res_582976 = eta_p_582975 <= eta_p_582974;
                        
                        ((bool *) mem_586629)[i_586136] = defunc_0_f_res_582976;
                    }
                    
                    bool defunc_0_foldl_res_582977;
                    bool acc_582979 = 1;
                    
                    for (int64_t i_582978 = 0; i_582978 < dim_560381; i_582978++) {
                        bool b_582980 = ((bool *) mem_586629)[i_582978];
                        bool x_582981 = acc_582979 && b_582980;
                        bool acc_tmp_588077 = x_582981;
                        
                        acc_582979 = acc_tmp_588077;
                    }
                    defunc_0_foldl_res_582977 = acc_582979;
                    
                    bool elimd_582982;
                    
                    if (defunc_0_foldl_res_582977) {
                        if (mem_586636_cached_sizze_588320 < dim_560381) {
                            err = lexical_realloc(ctx, &mem_586636, &mem_586636_cached_sizze_588320, dim_560381);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586140 = 0; i_586140 < dim_560381; i_586140++) {
                            float eta_p_583333 = ((float *) mem_param_586446.mem)[i_586144 * dim_560381 + i_586140];
                            float eta_p_583334 = ((float *) mem_param_586446.mem)[min_res_582959 * dim_560381 + i_586140];
                            bool defunc_0_f_res_583335 = eta_p_583334 < eta_p_583333;
                            
                            ((bool *) mem_586636)[i_586140] = defunc_0_f_res_583335;
                        }
                        
                        bool defunc_0_foldl_res_583337;
                        bool acc_583339 = 0;
                        
                        for (int64_t i_583338 = 0; i_583338 < dim_560381; i_583338++) {
                            bool b_583340 = ((bool *) mem_586636)[i_583338];
                            bool defunc_0_f_res_583341 = acc_583339 || b_583340;
                            bool acc_tmp_588079 = defunc_0_f_res_583341;
                            
                            acc_583339 = acc_tmp_588079;
                        }
                        defunc_0_foldl_res_583337 = acc_583339;
                        elimd_582982 = defunc_0_foldl_res_583337;
                    } else {
                        elimd_582982 = 0;
                    }
                    
                    int64_t defunc_0_f_res_f_res_f_res_582992;
                    
                    if (elimd_582982) {
                        defunc_0_f_res_f_res_f_res_582992 = (int64_t) -1;
                    } else {
                        defunc_0_f_res_f_res_f_res_582992 = eta_p_582852;
                    }
                    defunc_0_f_res_582972 = defunc_0_f_res_f_res_f_res_582992;
                }
                ((int64_t *) mem_586585.mem)[i_586144] = defunc_0_f_res_582972;
            }
            if (memblock_set(ctx, &mem_param_tmp_588063, &mem_586585, "mem_586585") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586575, &mem_param_tmp_588063, "mem_param_tmp_588063") != 0)
                return 1;
        }
        if (memblock_set(ctx, &ext_mem_586648, &mem_param_586575, "mem_param_586575") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586572, "mem_586572") != 0)
            return 1;
        if (mem_586650_cached_sizze_588321 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586650, &mem_586650_cached_sizze_588321, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586652_cached_sizze_588322 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586652, &mem_586652_cached_sizze_588322, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_586154;
        int64_t scanacc_586148 = (int64_t) 0;
        
        for (int64_t i_586151 = 0; i_586151 < loop_dz2081Uz2081U_572738; i_586151++) {
            int64_t eta_p_582527 = ((int64_t *) ext_mem_586648.mem)[i_586151];
            bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
            int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
            int64_t defunc_0_op_res_573136 = add64(defunc_0_f_res_582529, scanacc_586148);
            
            ((int64_t *) mem_586650)[i_586151] = defunc_0_op_res_573136;
            ((int64_t *) mem_586652)[i_586151] = defunc_0_f_res_582529;
            
            int64_t scanacc_tmp_588080 = defunc_0_op_res_573136;
            
            scanacc_586148 = scanacc_tmp_588080;
        }
        discard_586154 = scanacc_586148;
        
        bool cond_573137 = loop_dz2081Uz2081U_572738 == (int64_t) 0;
        bool x_573138 = !cond_573137;
        bool x_573139 = sle64((int64_t) 0, min_arg1_572962);
        bool y_573140 = slt64(min_arg1_572962, loop_dz2081Uz2081U_572738);
        bool bounds_check_573141 = x_573139 && y_573140;
        bool protect_assert_disj_573142 = cond_573137 || bounds_check_573141;
        bool index_certs_573143;
        
        if (!protect_assert_disj_573142) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_572962, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_573144;
        
        if (x_573138) {
            int64_t x_583349 = ((int64_t *) mem_586650)[min_arg1_572962];
            
            m_f_res_573144 = x_583349;
        } else {
            m_f_res_573144 = (int64_t) 0;
        }
        
        int64_t m_573146;
        
        if (cond_573137) {
            m_573146 = (int64_t) 0;
        } else {
            m_573146 = m_f_res_573144;
        }
        
        int64_t m_573156 = sub64(m_573146, (int64_t) 1);
        bool i_p_m_t_s_leq_w_573158 = slt64(m_573156, loop_dz2081Uz2081U_572738);
        bool zzero_leq_i_p_m_t_s_573157 = sle64((int64_t) 0, m_573156);
        bool y_573160 = zzero_leq_i_p_m_t_s_573157 && i_p_m_t_s_leq_w_573158;
        bool i_lte_j_573159 = sle64((int64_t) 0, m_573146);
        bool forwards_ok_573161 = i_lte_j_573159 && y_573160;
        bool eq_x_zz_573153 = (int64_t) 0 == m_f_res_573144;
        bool p_and_eq_x_y_573154 = x_573138 && eq_x_zz_573153;
        bool empty_slice_573155 = cond_573137 || p_and_eq_x_y_573154;
        bool ok_or_empty_573162 = empty_slice_573155 || forwards_ok_573161;
        bool index_certs_573163;
        
        if (!ok_or_empty_573162) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_573146, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:1023:115-126\n   #3  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_586665 = (int64_t) 8 * m_573146;
        int64_t binop_x_586673 = (int64_t) 4 * m_573146;
        int64_t bytes_586674 = dim_560381 * binop_x_586673;
        bool zzero_573307 = new_skB_572897 == (int64_t) 0;
        bool nonzzero_573308 = !zzero_573307;
        bool nonzzero_cert_573309;
        
        if (!nonzzero_573308) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:656:62-85\n   #1  ftSkyline.fut:1023:115-126\n   #2  ftSkyline.fut:1015:17-1023:126\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (mem_586666_cached_sizze_588323 < bytes_586665) {
            err = lexical_realloc(ctx, &mem_586666, &mem_586666_cached_sizze_588323, bytes_586665);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586648.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_573146});
        for (int64_t write_iter_586155 = 0; write_iter_586155 < loop_dz2081Uz2081U_572738; write_iter_586155++) {
            int64_t write_iv_586157 = ((int64_t *) mem_586652)[write_iter_586155];
            int64_t write_iv_586158 = ((int64_t *) mem_586650)[write_iter_586155];
            int64_t write_iv_586159 = ((int64_t *) ext_mem_586648.mem)[write_iter_586155];
            bool cond_582522 = write_iv_586157 == (int64_t) 1;
            int64_t lifted_lambda_res_582523;
            
            if (cond_582522) {
                int64_t lifted_lambda_res_t_res_583350 = sub64(write_iv_586158, (int64_t) 1);
                
                lifted_lambda_res_582523 = lifted_lambda_res_t_res_583350;
            } else {
                lifted_lambda_res_582523 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_573146)) {
                ((int64_t *) mem_586666)[lifted_lambda_res_582523] = write_iv_586159;
            }
        }
        if (memblock_unref(ctx, &ext_mem_586648, "ext_mem_586648") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_586675, bytes_586674, "mem_586675")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_586677, bytes_586665, "mem_586677")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586165 = 0; i_586165 < m_573146; i_586165++) {
            int64_t eta_p_573171 = ((int64_t *) mem_586666)[i_586165];
            bool x_573172 = sle64((int64_t) 0, eta_p_573171);
            bool y_573173 = slt64(eta_p_573171, loop_dz2081Uz2081U_572738);
            bool bounds_check_573174 = x_573172 && y_573173;
            bool index_certs_573175;
            
            if (!bounds_check_573174) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_573171, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:408:53-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:408:42-64\n   #3  ftSkyline.fut:1023:115-126\n   #4  ftSkyline.fut:1015:17-1023:126\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_573177 = ((int64_t *) mem_param_586449.mem)[eta_p_573171];
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586675.mem, i_586165 * dim_560381, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586446.mem, (int64_t) 0 + eta_p_573171 * dim_560381, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_560381});
            ((int64_t *) mem_586677.mem)[i_586165] = lifted_lambda_res_573177;
        }
        if (mem_586693_cached_sizze_588324 < bytes_586571) {
            err = lexical_realloc(ctx, &mem_586693, &mem_586693_cached_sizze_588324, bytes_586571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586186 = 0; i_586186 < loop_dz2081Uz2081U_572738; i_586186++) {
            for (int64_t i_586170 = 0; i_586170 < dim_560381; i_586170++) {
                float eta_p_583207 = ((float *) mem_param_586446.mem)[i_586186 * dim_560381 + i_586170];
                float eta_p_583208 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586170];
                float eta_p_583209 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586170];
                int64_t eta_p_583211 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586170];
                float defunc_0_f_res_583212 = eta_p_583207 - eta_p_583208;
                float defunc_0_f_res_583214 = defunc_0_f_res_583212 / eta_p_583209;
                int64_t f32_res_583216 = fptosi_f32_i64(defunc_0_f_res_583214);
                int64_t max_res_583218 = smax64((int64_t) 0, f32_res_583216);
                int64_t zm_lhs_583224 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586170];
                int64_t min_arg1_583225 = sub64(zm_lhs_583224, (int64_t) 1);
                int64_t min_res_583226 = smin64(max_res_583218, min_arg1_583225);
                int64_t defunc_0_f_res_583228 = mul64(eta_p_583211, min_res_583226);
                
                ((int64_t *) mem_586698)[i_586170] = defunc_0_f_res_583228;
            }
            
            int64_t defunc_0_foldl_res_573213;
            int64_t acc_573215 = (int64_t) 0;
            
            for (int64_t i_573214 = 0; i_573214 < dim_560381; i_573214++) {
                int64_t b_573216 = ((int64_t *) mem_586698)[i_573214];
                int64_t defunc_0_f_res_573217 = add64(acc_573215, b_573216);
                int64_t acc_tmp_588088 = defunc_0_f_res_573217;
                
                acc_573215 = acc_tmp_588088;
            }
            defunc_0_foldl_res_573213 = acc_573215;
            
            bool x_573218 = sle64((int64_t) 0, defunc_0_foldl_res_573213);
            bool y_573219 = slt64(defunc_0_foldl_res_573213, dz2080U_560382);
            bool bounds_check_573220 = x_573218 && y_573219;
            bool index_certs_573221;
            
            if (!bounds_check_573220) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_573213, "] out of bounds for array of shape [", (long long) dz2080U_560382, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:1023:115-126\n   #5  ftSkyline.fut:1015:17-1023:126\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586174 = 0; i_586174 < dim_560381; i_586174++) {
                float eta_p_573224 = ((float *) mem_param_586446.mem)[i_586186 * dim_560381 + i_586174];
                float eta_p_573225 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_573213 * dim_560381 + i_586174];
                float defunc_0_f_res_573226 = eta_p_573224 - eta_p_573225;
                
                ((float *) mem_586706)[i_586174] = defunc_0_f_res_573226;
            }
            for (int64_t nest_i_588090 = 0; nest_i_588090 < arg_572688; nest_i_588090++) {
                ((float *) mem_586714)[nest_i_588090] = 0.0F;
            }
            for (int64_t i_573229 = 0; i_573229 < arg_572688; i_573229++) {
                bool y_573231 = slt64(i_573229, dim_560381);
                bool index_certs_573232;
                
                if (!y_573231) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_573229, "] out of bounds for array of shape [", (long long) dim_560381, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:1023:115-126\n   #5  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_573234 = add64((int64_t) 1, i_573229);
                int64_t j_m_i_573235 = sub64(dim_560381, map_arg1_573234);
                bool empty_slice_573236 = j_m_i_573235 == (int64_t) 0;
                int64_t m_573237 = sub64(j_m_i_573235, (int64_t) 1);
                int64_t i_p_m_t_s_573238 = add64(map_arg1_573234, m_573237);
                bool zzero_leq_i_p_m_t_s_573239 = sle64((int64_t) 0, i_p_m_t_s_573238);
                bool i_p_m_t_s_leq_w_573240 = slt64(i_p_m_t_s_573238, dim_560381);
                bool zzero_lte_i_573241 = sle64((int64_t) 0, map_arg1_573234);
                bool i_lte_j_573242 = sle64(map_arg1_573234, dim_560381);
                bool y_573243 = i_p_m_t_s_leq_w_573240 && zzero_lte_i_573241;
                bool y_573244 = zzero_leq_i_p_m_t_s_573239 && y_573243;
                bool forwards_ok_573245 = i_lte_j_573242 && y_573244;
                bool ok_or_empty_573246 = empty_slice_573236 || forwards_ok_573245;
                bool index_certs_573247;
                
                if (!ok_or_empty_573246) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_573234, ":", (long long) dim_560381, "] out of bounds for array of shape [", (long long) dim_560381, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:1023:115-126\n   #5  ftSkyline.fut:1015:17-1023:126\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586718 = (int64_t) 4 * j_m_i_573235;
                float this_x_573233 = ((float *) mem_586706)[i_573229];
                
                if (mem_586719_cached_sizze_588328 < bytes_586718) {
                    err = lexical_realloc(ctx, &mem_586719, &mem_586719_cached_sizze_588328, bytes_586718);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586178 = 0; i_586178 < j_m_i_573235; i_586178++) {
                    int64_t slice_586364 = map_arg1_573234 + i_586178;
                    float eta_p_573250 = ((float *) mem_586706)[slice_586364];
                    float defunc_0_ftimes_res_573251 = eta_p_573250 * eta_p_573250;
                    
                    ((float *) mem_586719)[i_586178] = defunc_0_ftimes_res_573251;
                }
                
                float defunc_0_foldl_res_573252;
                float acc_573254 = 0.0F;
                
                for (int64_t i_573253 = 0; i_573253 < j_m_i_573235; i_573253++) {
                    float b_573255 = ((float *) mem_586719)[i_573253];
                    float defunc_0_f_res_573256 = acc_573254 + b_573255;
                    float acc_tmp_588093 = defunc_0_f_res_573256;
                    
                    acc_573254 = acc_tmp_588093;
                }
                defunc_0_foldl_res_573252 = acc_573254;
                
                float sqrt_res_573257 = futrts_sqrt32(defunc_0_foldl_res_573252);
                float atan2_res_573258 = futrts_atan2_32(sqrt_res_573257, this_x_573233);
                
                ((float *) mem_586714)[i_573229] = atan2_res_573258;
            }
            for (int64_t i_586182 = 0; i_586182 < arg_572688; i_586182++) {
                float eta_p_573261 = ((float *) mem_586714)[i_586182];
                float eta_p_573262 = ((float *) mem_586453)[i_586182];
                int64_t eta_p_573263 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586182];
                int64_t eta_p_573264 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586182];
                float i64_res_573265 = sitofp_i64_f32(eta_p_573263);
                float defunc_0_fover_res_573266 = eta_p_573261 / eta_p_573262;
                float defunc_0_ftimes_res_573267 = i64_res_573265 * defunc_0_fover_res_573266;
                int64_t f32_res_573268 = fptosi_f32_i64(defunc_0_ftimes_res_573267);
                bool cond_573269 = slt64(f32_res_573268, (int64_t) 0);
                int64_t defunc_0_f_res_573270;
                
                if (cond_573269) {
                    defunc_0_f_res_573270 = (int64_t) 0;
                } else {
                    bool cond_573271 = sle64(eta_p_573264, f32_res_573268);
                    int64_t defunc_0_f_res_f_res_573272;
                    
                    if (cond_573271) {
                        int64_t defunc_0_f_res_f_res_t_res_583353 = sub64(eta_p_573264, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_573272 = defunc_0_f_res_f_res_t_res_583353;
                    } else {
                        defunc_0_f_res_f_res_573272 = f32_res_573268;
                    }
                    defunc_0_f_res_573270 = defunc_0_f_res_f_res_573272;
                }
                ((int64_t *) mem_586730)[i_586182] = defunc_0_f_res_573270;
            }
            
            int64_t defunc_0_foldl_res_573274;
            int64_t acc_573276 = (int64_t) 0;
            
            for (int64_t i_573275 = 0; i_573275 < arg_572688; i_573275++) {
                int64_t b_573277 = ((int64_t *) mem_586730)[i_573275];
                int64_t defunc_0_f_res_573278 = add64(acc_573276, b_573277);
                int64_t acc_tmp_588095 = defunc_0_f_res_573278;
                
                acc_573276 = acc_tmp_588095;
            }
            defunc_0_foldl_res_573274 = acc_573276;
            
            int64_t zp_lhs_573279 = mul64(total_angle_no_560393, defunc_0_foldl_res_573213);
            int64_t get_id_from_grid_angle_res_573280 = add64(defunc_0_foldl_res_573274, zp_lhs_573279);
            
            ((int64_t *) mem_586693)[i_586186] = get_id_from_grid_angle_res_573280;
        }
        for (int64_t nest_i_588096 = 0; nest_i_588096 < total_part_no_560395; nest_i_588096++) {
            ((int64_t *) mem_586741)[nest_i_588096] = (int64_t) 0;
        }
        for (int64_t iter_586188 = 0; iter_586188 < m_573146; iter_586188++) {
            int64_t pixel_586190 = ((int64_t *) mem_586666)[iter_586188];
            bool x_582512 = sle64((int64_t) 0, pixel_586190);
            bool y_582513 = slt64(pixel_586190, loop_dz2081Uz2081U_572738);
            bool bounds_check_582514 = x_582512 && y_582513;
            bool index_certs_582515;
            
            if (!bounds_check_582514) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586190, "] out of bounds for array of shape [", (long long) loop_dz2081Uz2081U_572738, "].", "-> #0  ftSkyline.fut:413:51-62\n   #1  ftSkyline.fut:1023:115-126\n   #2  ftSkyline.fut:1015:17-1023:126\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586693)[pixel_586190];
            bool less_than_zzero_586192 = slt64(lifted_lambda_res_582516, (int64_t) 0);
            bool greater_than_sizze_586193 = sle64(total_part_no_560395, lifted_lambda_res_582516);
            bool outside_bounds_dim_586194 = less_than_zzero_586192 || greater_than_sizze_586193;
            
            if (!outside_bounds_dim_586194) {
                int64_t read_hist_586196 = ((int64_t *) mem_586741)[lifted_lambda_res_582516];
                int64_t defunc_0_op_res_573289 = add64((int64_t) 1, read_hist_586196);
                
                ((int64_t *) mem_586741)[lifted_lambda_res_582516] = defunc_0_op_res_573289;
            }
        }
        
        int64_t discard_586204;
        int64_t scanacc_586200 = (int64_t) 0;
        
        for (int64_t i_586202 = 0; i_586202 < total_part_no_560395; i_586202++) {
            int64_t x_573293 = ((int64_t *) mem_586741)[i_586202];
            int64_t defunc_0_op_res_573296 = add64(x_573293, scanacc_586200);
            
            ((int64_t *) mem_586749)[i_586202] = defunc_0_op_res_573296;
            
            int64_t scanacc_tmp_588098 = defunc_0_op_res_573296;
            
            scanacc_586200 = scanacc_tmp_588098;
        }
        discard_586204 = scanacc_586200;
        if (memblock_alloc(ctx, &mem_586757, bytes_586740, "mem_586757")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586207 = 0; i_586207 < total_part_no_560395; i_586207++) {
            int64_t zv_lhs_582503 = add64((int64_t) -1, i_586207);
            int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_560395);
            int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586749)[tmp_582504];
            bool cond_582507 = i_586207 == (int64_t) 0;
            int64_t lifted_lambda_res_582508;
            
            if (cond_582507) {
                lifted_lambda_res_582508 = (int64_t) 0;
            } else {
                lifted_lambda_res_582508 = lifted_lambda_res_582505;
            }
            ((int64_t *) mem_586757.mem)[i_586207] = lifted_lambda_res_582508;
        }
        
        int64_t next_acc_sd_573310 = sdiv64(total_part_no_560395, new_skB_572897);
        int64_t tmp_573311 = add64((int64_t) 1, i_572751);
        bool cond_573312 = slt64(tmp_573311, zl_rhs_572692);
        bool cond_t_res_573313 = slt64(min_arg0_572753, zl_rhs_572697);
        bool x_573314 = cond_573312 && cond_t_res_573313;
        bool loop_cond_t_res_573315 = slt64(sizze_thresh_560403, m_573146);
        bool x_573316 = x_573314 && loop_cond_t_res_573315;
        
        if (memblock_set(ctx, &mem_param_tmp_588013, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588014, &mem_586455, "mem_586455") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588015, &mem_586507, "mem_586507") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588016, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588017, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588018, &ext_mem_586546, "ext_mem_586546") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588019, &mem_586757, "mem_586757") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588020, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_588021, &mem_586677, "mem_586677") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_588022 = new_starts_572842;
        int64_t loop_dz2081Uz2080U_tmp_588023 = total_part_no_560395;
        int64_t loop_dz2081Uz2081U_tmp_588024 = m_573146;
        bool loop_while_tmp_588025 = x_573316;
        int64_t sd_skB_tmp_588032 = defunc_res_583359;
        int64_t sd_skB_tmp_588033 = defunc_res_583363;
        int64_t i_tmp_588037 = tmp_573311;
        int64_t acc_sd_tmp_588038 = next_acc_sd_573310;
        
        if (memblock_set(ctx, &mem_param_586423, &mem_param_tmp_588013, "mem_param_tmp_588013") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586426, &mem_param_tmp_588014, "mem_param_tmp_588014") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586429, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586432, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586435, &mem_param_tmp_588017, "mem_param_tmp_588017") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586439, &mem_param_tmp_588018, "mem_param_tmp_588018") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586442, &mem_param_tmp_588019, "mem_param_tmp_588019") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586446, &mem_param_tmp_588020, "mem_param_tmp_588020") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586449, &mem_param_tmp_588021, "mem_param_tmp_588021") != 0)
            return 1;
        loop_dz2087U_572736 = loop_dz2087U_tmp_588022;
        loop_dz2081Uz2080U_572737 = loop_dz2081Uz2080U_tmp_588023;
        loop_dz2081Uz2081U_572738 = loop_dz2081Uz2081U_tmp_588024;
        loop_while_572739 = loop_while_tmp_588025;
        sd_skB_572746 = sd_skB_tmp_588032;
        sd_skB_572747 = sd_skB_tmp_588033;
        i_572751 = i_tmp_588037;
        acc_sd_572752 = acc_sd_tmp_588038;
    }
    if (memblock_set(ctx, &ext_mem_586792, &mem_param_586423, "mem_param_586423") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586791, &mem_param_586426, "mem_param_586426") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586790, &mem_param_586429, "mem_param_586429") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586789, &mem_param_586432, "mem_param_586432") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586788, &mem_param_586435, "mem_param_586435") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586787, &mem_param_586439, "mem_param_586439") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586786, &mem_param_586442, "mem_param_586442") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586785, &mem_param_586446, "mem_param_586446") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_586784, &mem_param_586449, "mem_param_586449") != 0)
        return 1;
    defunc_0_calc_intermediate_skyline_res_572719 = loop_dz2087U_572736;
    defunc_0_calc_intermediate_skyline_res_572720 = loop_dz2081Uz2080U_572737;
    defunc_0_calc_intermediate_skyline_res_572721 = loop_dz2081Uz2081U_572738;
    defunc_0_calc_intermediate_skyline_res_572722 = loop_while_572739;
    defunc_0_calc_intermediate_skyline_res_572729 = sd_skB_572746;
    defunc_0_calc_intermediate_skyline_res_572730 = sd_skB_572747;
    defunc_0_calc_intermediate_skyline_res_572734 = i_572751;
    defunc_0_calc_intermediate_skyline_res_572735 = acc_sd_572752;
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &ext_mem_586786, "ext_mem_586786") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &ext_mem_586785, "ext_mem_586785") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &ext_mem_586784, "ext_mem_586784") != 0)
        return 1;
    prim_out_588011 = defunc_0_calc_intermediate_skyline_res_572720;
    prim_out_588012 = defunc_0_calc_intermediate_skyline_res_572721;
    if (memblock_set(ctx, &*mem_out_p_588298, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588299, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588300, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588301, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588302 = prim_out_588011;
    *out_prim_out_588303 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586451);
        free(mem_586453);
        free(mem_586475);
        free(mem_586515);
        free(mem_586517);
        free(mem_586538);
        free(mem_586548);
        free(mem_586550);
        free(mem_586564);
        free(mem_586577);
        free(mem_586590);
        free(mem_586598);
        free(mem_586606);
        free(mem_586611);
        free(mem_586622);
        free(mem_586629);
        free(mem_586636);
        free(mem_586650);
        free(mem_586652);
        free(mem_586666);
        free(mem_586693);
        free(mem_586698);
        free(mem_586706);
        free(mem_586714);
        free(mem_586719);
        free(mem_586730);
        free(mem_586741);
        free(mem_586749);
        if (memblock_unref(ctx, &mem_param_tmp_588021, "mem_param_tmp_588021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588020, "mem_param_tmp_588020") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588019, "mem_param_tmp_588019") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588018, "mem_param_tmp_588018") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588017, "mem_param_tmp_588017") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588015, "mem_param_tmp_588015") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588014, "mem_param_tmp_588014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588013, "mem_param_tmp_588013") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586757, "mem_586757") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586677, "mem_586677") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588063, "mem_param_tmp_588063") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586585, "mem_586585") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586575, "mem_param_586575") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586648, "ext_mem_586648") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586572, "mem_586572") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586532, "mem_586532") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586546, "ext_mem_586546") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586507, "mem_586507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586479, "mem_586479") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586477, "mem_586477") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586455, "mem_586455") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586449, "mem_param_586449") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586446, "mem_param_586446") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586442, "mem_param_586442") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586439, "mem_param_586439") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586435, "mem_param_586435") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586432, "mem_param_586432") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586429, "mem_param_586429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586426, "mem_param_586426") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586423, "mem_param_586423") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586784, "ext_mem_586784") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586785, "ext_mem_586785") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586786, "ext_mem_586786") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586787, "ext_mem_586787") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586788, "ext_mem_586788") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586789, "ext_mem_586789") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586790, "ext_mem_586790") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586791, "ext_mem_586791") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586792, "ext_mem_586792") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_local_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588332, struct memblock *mem_out_p_588333, struct memblock *mem_out_p_588334, struct memblock *mem_out_p_588335, int64_t *out_prim_out_588336, int64_t *out_prim_out_588337, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_302009, int64_t dz2080U_302010, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011, int64_t dz2081U_302012, int64_t dz2082U_302013, int64_t dz2083U_302014, int64_t total_angle_no_302021, int64_t total_grid_no_302022, int64_t total_part_no_302023)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586427_cached_sizze_588338 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586440_cached_sizze_588339 = 0;
    unsigned char *mem_586440 = NULL;
    int64_t mem_586448_cached_sizze_588340 = 0;
    unsigned char *mem_586448 = NULL;
    int64_t mem_586456_cached_sizze_588341 = 0;
    unsigned char *mem_586456 = NULL;
    int64_t mem_586461_cached_sizze_588342 = 0;
    unsigned char *mem_586461 = NULL;
    int64_t mem_586472_cached_sizze_588343 = 0;
    unsigned char *mem_586472 = NULL;
    int64_t mem_586479_cached_sizze_588344 = 0;
    unsigned char *mem_586479 = NULL;
    int64_t mem_586486_cached_sizze_588345 = 0;
    unsigned char *mem_586486 = NULL;
    int64_t mem_586500_cached_sizze_588346 = 0;
    unsigned char *mem_586500 = NULL;
    int64_t mem_586502_cached_sizze_588347 = 0;
    unsigned char *mem_586502 = NULL;
    int64_t mem_586516_cached_sizze_588348 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586543_cached_sizze_588349 = 0;
    unsigned char *mem_586543 = NULL;
    int64_t mem_586551_cached_sizze_588350 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586556_cached_sizze_588351 = 0;
    unsigned char *mem_586556 = NULL;
    int64_t mem_586564_cached_sizze_588352 = 0;
    unsigned char *mem_586564 = NULL;
    int64_t mem_586572_cached_sizze_588353 = 0;
    unsigned char *mem_586572 = NULL;
    int64_t mem_586577_cached_sizze_588354 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586588_cached_sizze_588355 = 0;
    unsigned char *mem_586588 = NULL;
    int64_t mem_586599_cached_sizze_588356 = 0;
    unsigned char *mem_586599 = NULL;
    int64_t mem_586607_cached_sizze_588357 = 0;
    unsigned char *mem_586607 = NULL;
    struct memblock mem_586615;
    
    mem_586615.references = NULL;
    
    struct memblock mem_586527;
    
    mem_586527.references = NULL;
    
    struct memblock mem_586525;
    
    mem_586525.references = NULL;
    
    struct memblock mem_param_tmp_588016;
    
    mem_param_tmp_588016.references = NULL;
    
    struct memblock mem_586435;
    
    mem_586435.references = NULL;
    
    struct memblock mem_param_586425;
    
    mem_param_586425.references = NULL;
    
    struct memblock ext_mem_586498;
    
    ext_mem_586498.references = NULL;
    
    struct memblock mem_586422;
    
    mem_586422.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_572684 = sub64(dim_302009, (int64_t) 1);
    bool assert_cond_572685 = arg_572684 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011;
    bool assert_c_572686;
    
    if (!assert_cond_572685) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:822:26-824:43\n   #1  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zeze_rhs_572688 = sub64(dz2082U_302013, (int64_t) 1);
    int64_t defunc_0_reduce_res_583160;
    int64_t redout_586048 = (int64_t) -9223372036854775808;
    
    for (int64_t i_586049 = 0; i_586049 < dz2082U_302013; i_586049++) {
        bool cond_582533 = i_586049 == zeze_rhs_572688;
        int64_t lifted_lambda_res_582534;
        
        if (cond_582533) {
            int64_t zm_rhs_583128 = ((int64_t *) part_idx_mem_586418.mem)[i_586049];
            int64_t lifted_lambda_res_t_res_583129 = sub64(dz2083U_302014, zm_rhs_583128);
            
            lifted_lambda_res_582534 = lifted_lambda_res_t_res_583129;
        } else {
            int64_t zm_lhs_582541 = add64((int64_t) 1, i_586049);
            bool x_582542 = sle64((int64_t) 0, zm_lhs_582541);
            bool y_582543 = slt64(zm_lhs_582541, dz2082U_302013);
            bool bounds_check_582544 = x_582542 && y_582543;
            bool index_certs_582545;
            
            if (!bounds_check_582544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582541, "] out of bounds for array of shape [", (long long) dz2082U_302013, "].", "-> #0  ftSkyline.fut:376:38-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:822:26-29\n   #4  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582546 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582541];
            int64_t zm_rhs_582551 = ((int64_t *) part_idx_mem_586418.mem)[i_586049];
            int64_t lifted_lambda_res_f_res_582552 = sub64(zm_lhs_582546, zm_rhs_582551);
            
            lifted_lambda_res_582534 = lifted_lambda_res_f_res_582552;
        }
        
        int64_t max_res_572715 = smax64(lifted_lambda_res_582534, redout_586048);
        int64_t redout_tmp_588013 = max_res_572715;
        
        redout_586048 = redout_tmp_588013;
    }
    defunc_0_reduce_res_583160 = redout_586048;
    
    int64_t bytes_586421 = (int64_t) 8 * dz2083U_302014;
    
    if (memblock_alloc(ctx, &mem_586422, bytes_586421, "mem_586422")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_588014 = 0; i_588014 < dz2083U_302014; i_588014++) {
        int64_t x_588015 = (int64_t) 0 + i_588014 * (int64_t) 1;
        
        ((int64_t *) mem_586422.mem)[i_588014] = x_588015;
    }
    
    bool bounds_invalid_upwards_572717 = slt64(defunc_0_reduce_res_583160, (int64_t) 0);
    bool valid_572718 = !bounds_invalid_upwards_572717;
    bool range_valid_c_572719;
    
    if (!valid_572718) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_0_reduce_res_583160, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:380:65-83\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:822:26-29\n   #4  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t min_arg1_572720 = sub64(dz2083U_302014, (int64_t) 1);
    bool loop_nonempty_572721 = slt64((int64_t) 0, defunc_0_reduce_res_583160);
    bool y_572722 = slt64((int64_t) 0, dz2080U_302010);
    bool loop_not_taken_572723 = !loop_nonempty_572721;
    bool protect_assert_disj_572724 = y_572722 || loop_not_taken_572723;
    bool index_certs_572725;
    
    if (!protect_assert_disj_572724) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_302010, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_572730 = assert_cond_572685 || loop_not_taken_572723;
    bool empty_or_match_cert_572731;
    
    if (!protect_assert_disj_572730) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586426 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011;
    int64_t bytes_586439 = (int64_t) 8 * dim_302009;
    int64_t bytes_586455 = (int64_t) 8 * arg_572684;
    
    if (mem_586427_cached_sizze_588338 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_588338, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586440_cached_sizze_588339 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586440, &mem_586440_cached_sizze_588339, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586448_cached_sizze_588340 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586448, &mem_586448_cached_sizze_588340, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586456_cached_sizze_588341 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586456, &mem_586456_cached_sizze_588341, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586472_cached_sizze_588343 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586472, &mem_586472_cached_sizze_588343, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_586425, &mem_586422, "mem_586422") != 0)
        return 1;
    for (int64_t i_572735 = 0; i_572735 < defunc_0_reduce_res_583160; i_572735++) {
        for (int64_t i_586052 = 0; i_586052 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011; i_586052++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572744 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586052];
            double i64_res_572745 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572744);
            double defunc_0_fover_res_572746 = 1.5707963267948966 / i64_res_572745;
            
            ((double *) mem_586427)[i_586052] = defunc_0_fover_res_572746;
        }
        if (memblock_alloc(ctx, &mem_586435, bytes_586421, "mem_586435")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586080 = 0; i_586080 < dz2083U_302014; i_586080++) {
            for (int64_t i_586056 = 0; i_586056 < dim_302009; i_586056++) {
                double eta_p_582942 = ((double *) xys_mem_586419.mem)[i_586080 * dim_302009 + i_586056];
                double eta_p_582943 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586056];
                double eta_p_582944 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586056];
                int64_t eta_p_582946 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586056];
                double defunc_0_f_res_582947 = eta_p_582942 - eta_p_582943;
                double defunc_0_f_res_582949 = defunc_0_f_res_582947 / eta_p_582944;
                int64_t f64_res_582951 = fptosi_f64_i64(defunc_0_f_res_582949);
                int64_t max_res_582953 = smax64((int64_t) 0, f64_res_582951);
                int64_t zm_lhs_582959 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586056];
                int64_t min_arg1_582960 = sub64(zm_lhs_582959, (int64_t) 1);
                int64_t min_res_582961 = smin64(max_res_582953, min_arg1_582960);
                int64_t defunc_0_f_res_582963 = mul64(eta_p_582946, min_res_582961);
                
                ((int64_t *) mem_586440)[i_586056] = defunc_0_f_res_582963;
            }
            
            int64_t defunc_0_foldl_res_582754;
            int64_t acc_582756 = (int64_t) 0;
            
            for (int64_t i_582755 = 0; i_582755 < dim_302009; i_582755++) {
                int64_t b_582757 = ((int64_t *) mem_586440)[i_582755];
                int64_t defunc_0_f_res_582758 = add64(acc_582756, b_582757);
                int64_t acc_tmp_588021 = defunc_0_f_res_582758;
                
                acc_582756 = acc_tmp_588021;
            }
            defunc_0_foldl_res_582754 = acc_582756;
            
            bool x_582759 = sle64((int64_t) 0, defunc_0_foldl_res_582754);
            bool y_582760 = slt64(defunc_0_foldl_res_582754, dz2080U_302010);
            bool bounds_check_582761 = x_582759 && y_582760;
            bool index_certs_582762;
            
            if (!bounds_check_582761) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582754, "] out of bounds for array of shape [", (long long) dz2080U_302010, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586060 = 0; i_586060 < dim_302009; i_586060++) {
                double eta_p_582765 = ((double *) xys_mem_586419.mem)[i_586080 * dim_302009 + i_586060];
                double eta_p_582766 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582754 * dim_302009 + i_586060];
                double defunc_0_f_res_582767 = eta_p_582765 - eta_p_582766;
                
                ((double *) mem_586448)[i_586060] = defunc_0_f_res_582767;
            }
            for (int64_t nest_i_588023 = 0; nest_i_588023 < arg_572684; nest_i_588023++) {
                ((double *) mem_586456)[nest_i_588023] = 0.0;
            }
            for (int64_t i_582770 = 0; i_582770 < arg_572684; i_582770++) {
                bool y_582772 = slt64(i_582770, dim_302009);
                bool index_certs_582773;
                
                if (!y_582772) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582770, "] out of bounds for array of shape [", (long long) dim_302009, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_582775 = add64((int64_t) 1, i_582770);
                int64_t j_m_i_582776 = sub64(dim_302009, map_arg1_582775);
                bool empty_slice_582777 = j_m_i_582776 == (int64_t) 0;
                int64_t m_582778 = sub64(j_m_i_582776, (int64_t) 1);
                int64_t i_p_m_t_s_582779 = add64(map_arg1_582775, m_582778);
                bool zzero_leq_i_p_m_t_s_582780 = sle64((int64_t) 0, i_p_m_t_s_582779);
                bool i_p_m_t_s_leq_w_582781 = slt64(i_p_m_t_s_582779, dim_302009);
                bool zzero_lte_i_582782 = sle64((int64_t) 0, map_arg1_582775);
                bool i_lte_j_582783 = sle64(map_arg1_582775, dim_302009);
                bool y_582784 = i_p_m_t_s_leq_w_582781 && zzero_lte_i_582782;
                bool y_582785 = zzero_leq_i_p_m_t_s_582780 && y_582784;
                bool forwards_ok_582786 = i_lte_j_582783 && y_582785;
                bool ok_or_empty_582787 = empty_slice_582777 || forwards_ok_582786;
                bool index_certs_582788;
                
                if (!ok_or_empty_582787) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582775, ":", (long long) dim_302009, "] out of bounds for array of shape [", (long long) dim_302009, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586460 = (int64_t) 8 * j_m_i_582776;
                double this_x_582774 = ((double *) mem_586448)[i_582770];
                
                if (mem_586461_cached_sizze_588342 < bytes_586460) {
                    err = lexical_realloc(ctx, &mem_586461, &mem_586461_cached_sizze_588342, bytes_586460);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586064 = 0; i_586064 < j_m_i_582776; i_586064++) {
                    int64_t slice_586369 = map_arg1_582775 + i_586064;
                    double eta_p_582791 = ((double *) mem_586448)[slice_586369];
                    double defunc_0_ftimes_res_582792 = eta_p_582791 * eta_p_582791;
                    
                    ((double *) mem_586461)[i_586064] = defunc_0_ftimes_res_582792;
                }
                
                double defunc_0_foldl_res_582793;
                double acc_582795 = 0.0;
                
                for (int64_t i_582794 = 0; i_582794 < j_m_i_582776; i_582794++) {
                    double b_582796 = ((double *) mem_586461)[i_582794];
                    double defunc_0_f_res_582797 = acc_582795 + b_582796;
                    double acc_tmp_588026 = defunc_0_f_res_582797;
                    
                    acc_582795 = acc_tmp_588026;
                }
                defunc_0_foldl_res_582793 = acc_582795;
                
                double sqrt_res_582798 = futrts_sqrt64(defunc_0_foldl_res_582793);
                double atan2_res_582799 = futrts_atan2_64(sqrt_res_582798, this_x_582774);
                
                ((double *) mem_586456)[i_582770] = atan2_res_582799;
            }
            for (int64_t i_586068 = 0; i_586068 < arg_572684; i_586068++) {
                double eta_p_582802 = ((double *) mem_586456)[i_586068];
                double eta_p_582803 = ((double *) mem_586427)[i_586068];
                int64_t eta_p_582804 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586068];
                int64_t eta_p_582805 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586068];
                double i64_res_582806 = sitofp_i64_f64(eta_p_582804);
                double defunc_0_fover_res_582807 = eta_p_582802 / eta_p_582803;
                double defunc_0_ftimes_res_582808 = i64_res_582806 * defunc_0_fover_res_582807;
                int64_t f64_res_582809 = fptosi_f64_i64(defunc_0_ftimes_res_582808);
                bool cond_582810 = slt64(f64_res_582809, (int64_t) 0);
                int64_t defunc_0_f_res_582811;
                
                if (cond_582810) {
                    defunc_0_f_res_582811 = (int64_t) 0;
                } else {
                    bool cond_582812 = sle64(eta_p_582805, f64_res_582809);
                    int64_t defunc_0_f_res_f_res_582813;
                    
                    if (cond_582812) {
                        int64_t defunc_0_f_res_f_res_t_res_583132 = sub64(eta_p_582805, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_582813 = defunc_0_f_res_f_res_t_res_583132;
                    } else {
                        defunc_0_f_res_f_res_582813 = f64_res_582809;
                    }
                    defunc_0_f_res_582811 = defunc_0_f_res_f_res_582813;
                }
                ((int64_t *) mem_586472)[i_586068] = defunc_0_f_res_582811;
            }
            
            int64_t defunc_0_foldl_res_582815;
            int64_t acc_582817 = (int64_t) 0;
            
            for (int64_t i_582816 = 0; i_582816 < arg_572684; i_582816++) {
                int64_t b_582818 = ((int64_t *) mem_586472)[i_582816];
                int64_t defunc_0_f_res_582819 = add64(acc_582817, b_582818);
                int64_t acc_tmp_588028 = defunc_0_f_res_582819;
                
                acc_582817 = acc_tmp_588028;
            }
            defunc_0_foldl_res_582815 = acc_582817;
            
            int64_t zp_lhs_582822 = mul64(total_angle_no_302021, defunc_0_foldl_res_582754);
            int64_t get_id_from_grid_angle_res_582823 = add64(defunc_0_foldl_res_582815, zp_lhs_582822);
            bool x_582826 = sle64((int64_t) 0, get_id_from_grid_angle_res_582823);
            bool y_582827 = slt64(get_id_from_grid_angle_res_582823, dz2082U_302013);
            bool bounds_check_582828 = x_582826 && y_582827;
            bool index_certs_582829;
            
            if (!bounds_check_582828) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582823, "] out of bounds for array of shape [", (long long) dz2082U_302013, "].", "-> #0  ftSkyline.fut:389:73-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:822:26-29\n   #4  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582830 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582823];
            int64_t min_arg0_582831 = add64(i_572735, zp_lhs_582830);
            int64_t min_res_582832 = smin64(min_arg1_572720, min_arg0_582831);
            bool x_582834 = sle64((int64_t) 0, min_res_582832);
            bool y_582835 = slt64(min_res_582832, dz2083U_302014);
            bool bounds_check_582836 = x_582834 && y_582835;
            bool index_certs_582837;
            
            if (!bounds_check_582836) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_582832, "] out of bounds for array of shape [", (long long) dz2083U_302014, "].", "-> #0  ftSkyline.fut:390:56-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:390:44-70\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t eta_p_582724 = ((int64_t *) mem_param_586425.mem)[i_586080];
            bool cond_582840 = slt64(eta_p_582724, (int64_t) 0);
            bool x_582842 = !cond_582840;
            bool cond_f_res_582841 = eta_p_582724 == i_572735;
            bool y_582843 = cond_f_res_582841 && x_582842;
            bool cond_582844 = cond_582840 || y_582843;
            int64_t defunc_0_f_res_582845;
            
            if (cond_582844) {
                defunc_0_f_res_582845 = eta_p_582724;
            } else {
                bool zzero_582846 = total_angle_no_302021 == (int64_t) 0;
                bool nonzzero_582847 = !zzero_582846;
                bool nonzzero_cert_582848;
                
                if (!nonzzero_582847) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:366:10-394:98\n   #2  /prelude/soacs.fut:83:33-34\n   #3  /prelude/soacs.fut:83:37-53\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t grid_id_582849 = sdiv64(get_id_from_grid_angle_res_582823, total_angle_no_302021);
                bool y_582851 = slt64(grid_id_582849, dz2081U_302012);
                bool x_582850 = sle64((int64_t) 0, grid_id_582849);
                bool bounds_check_582852 = x_582850 && y_582851;
                bool index_certs_582853;
                
                if (!bounds_check_582852) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582849, "] out of bounds for array of shape [", (long long) dz2081U_302012, "].", "-> #0  ftSkyline.fut:395:52-81\n   #1  /prelude/soacs.fut:83:33-34\n   #2  /prelude/soacs.fut:83:37-53\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool cond_582854 = ((bool *) isPartitionDominated_mem_586417.mem)[grid_id_582849];
                int64_t defunc_0_f_res_f_res_582855;
                
                if (cond_582854) {
                    defunc_0_f_res_f_res_582855 = (int64_t) -1;
                } else {
                    if (mem_586479_cached_sizze_588344 < dim_302009) {
                        err = lexical_realloc(ctx, &mem_586479, &mem_586479_cached_sizze_588344, dim_302009);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586072 = 0; i_586072 < dim_302009; i_586072++) {
                        double eta_p_582857 = ((double *) xys_mem_586419.mem)[i_586080 * dim_302009 + i_586072];
                        double eta_p_582858 = ((double *) xys_mem_586419.mem)[min_res_582832 * dim_302009 + i_586072];
                        bool defunc_0_f_res_582859 = eta_p_582858 <= eta_p_582857;
                        
                        ((bool *) mem_586479)[i_586072] = defunc_0_f_res_582859;
                    }
                    
                    bool defunc_0_foldl_res_582860;
                    bool acc_582862 = 1;
                    
                    for (int64_t i_582861 = 0; i_582861 < dim_302009; i_582861++) {
                        bool b_582863 = ((bool *) mem_586479)[i_582861];
                        bool x_582864 = acc_582862 && b_582863;
                        bool acc_tmp_588030 = x_582864;
                        
                        acc_582862 = acc_tmp_588030;
                    }
                    defunc_0_foldl_res_582860 = acc_582862;
                    
                    bool elimd_582865;
                    
                    if (defunc_0_foldl_res_582860) {
                        if (mem_586486_cached_sizze_588345 < dim_302009) {
                            err = lexical_realloc(ctx, &mem_586486, &mem_586486_cached_sizze_588345, dim_302009);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586076 = 0; i_586076 < dim_302009; i_586076++) {
                            double eta_p_583135 = ((double *) xys_mem_586419.mem)[i_586080 * dim_302009 + i_586076];
                            double eta_p_583136 = ((double *) xys_mem_586419.mem)[min_res_582832 * dim_302009 + i_586076];
                            bool defunc_0_f_res_583137 = eta_p_583136 < eta_p_583135;
                            
                            ((bool *) mem_586486)[i_586076] = defunc_0_f_res_583137;
                        }
                        
                        bool defunc_0_foldl_res_583139;
                        bool acc_583141 = 0;
                        
                        for (int64_t i_583140 = 0; i_583140 < dim_302009; i_583140++) {
                            bool b_583142 = ((bool *) mem_586486)[i_583140];
                            bool defunc_0_f_res_583143 = acc_583141 || b_583142;
                            bool acc_tmp_588032 = defunc_0_f_res_583143;
                            
                            acc_583141 = acc_tmp_588032;
                        }
                        defunc_0_foldl_res_583139 = acc_583141;
                        elimd_582865 = defunc_0_foldl_res_583139;
                    } else {
                        elimd_582865 = 0;
                    }
                    
                    int64_t defunc_0_f_res_f_res_f_res_582875;
                    
                    if (elimd_582865) {
                        defunc_0_f_res_f_res_f_res_582875 = (int64_t) -1;
                    } else {
                        defunc_0_f_res_f_res_f_res_582875 = eta_p_582724;
                    }
                    defunc_0_f_res_f_res_582855 = defunc_0_f_res_f_res_f_res_582875;
                }
                defunc_0_f_res_582845 = defunc_0_f_res_f_res_582855;
            }
            ((int64_t *) mem_586435.mem)[i_586080] = defunc_0_f_res_582845;
        }
        if (memblock_set(ctx, &mem_param_tmp_588016, &mem_586435, "mem_586435") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586425, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_586498, &mem_param_586425, "mem_param_586425") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
        return 1;
    if (mem_586500_cached_sizze_588346 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586500, &mem_586500_cached_sizze_588346, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586502_cached_sizze_588347 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586502, &mem_586502_cached_sizze_588347, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586090;
    int64_t scanacc_586084 = (int64_t) 0;
    
    for (int64_t i_586087 = 0; i_586087 < dz2083U_302014; i_586087++) {
        int64_t eta_p_582527 = ((int64_t *) ext_mem_586498.mem)[i_586087];
        bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
        int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
        int64_t defunc_0_op_res_572909 = add64(defunc_0_f_res_582529, scanacc_586084);
        
        ((int64_t *) mem_586500)[i_586087] = defunc_0_op_res_572909;
        ((int64_t *) mem_586502)[i_586087] = defunc_0_f_res_582529;
        
        int64_t scanacc_tmp_588033 = defunc_0_op_res_572909;
        
        scanacc_586084 = scanacc_tmp_588033;
    }
    discard_586090 = scanacc_586084;
    
    bool cond_572910 = dz2083U_302014 == (int64_t) 0;
    bool x_572911 = !cond_572910;
    bool x_572912 = sle64((int64_t) 0, min_arg1_572720);
    bool y_572913 = slt64(min_arg1_572720, dz2083U_302014);
    bool bounds_check_572914 = x_572912 && y_572913;
    bool protect_assert_disj_572915 = cond_572910 || bounds_check_572914;
    bool index_certs_572916;
    
    if (!protect_assert_disj_572915) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_572720, "] out of bounds for array of shape [", (long long) dz2083U_302014, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:822:26-29\n   #4  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_572917;
    
    if (x_572911) {
        int64_t x_583151 = ((int64_t *) mem_586500)[min_arg1_572720];
        
        m_f_res_572917 = x_583151;
    } else {
        m_f_res_572917 = (int64_t) 0;
    }
    
    int64_t m_572919;
    
    if (cond_572910) {
        m_572919 = (int64_t) 0;
    } else {
        m_572919 = m_f_res_572917;
    }
    
    int64_t m_572929 = sub64(m_572919, (int64_t) 1);
    bool i_p_m_t_s_leq_w_572931 = slt64(m_572929, dz2083U_302014);
    bool zzero_leq_i_p_m_t_s_572930 = sle64((int64_t) 0, m_572929);
    bool y_572933 = zzero_leq_i_p_m_t_s_572930 && i_p_m_t_s_leq_w_572931;
    bool i_lte_j_572932 = sle64((int64_t) 0, m_572919);
    bool forwards_ok_572934 = i_lte_j_572932 && y_572933;
    bool eq_x_zz_572926 = (int64_t) 0 == m_f_res_572917;
    bool p_and_eq_x_y_572927 = x_572911 && eq_x_zz_572926;
    bool empty_slice_572928 = cond_572910 || p_and_eq_x_y_572927;
    bool ok_or_empty_572935 = empty_slice_572928 || forwards_ok_572934;
    bool index_certs_572936;
    
    if (!ok_or_empty_572935) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_572919, "] out of bounds for array of shape [", (long long) dz2083U_302014, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:822:26-29\n   #4  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586515 = (int64_t) 8 * m_572919;
    int64_t bytes_586524 = dim_302009 * bytes_586515;
    bool index_certs_572951;
    
    if (!y_572722) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_302010, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_572962;
    
    if (!assert_cond_572685) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586598 = (int64_t) 8 * total_part_no_302023;
    
    if (mem_586516_cached_sizze_588348 < bytes_586515) {
        err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588348, bytes_586515);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586516, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586498.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_572919});
    for (int64_t write_iter_586091 = 0; write_iter_586091 < dz2083U_302014; write_iter_586091++) {
        int64_t write_iv_586093 = ((int64_t *) mem_586502)[write_iter_586091];
        int64_t write_iv_586094 = ((int64_t *) mem_586500)[write_iter_586091];
        int64_t write_iv_586095 = ((int64_t *) ext_mem_586498.mem)[write_iter_586091];
        bool cond_582522 = write_iv_586093 == (int64_t) 1;
        int64_t lifted_lambda_res_582523;
        
        if (cond_582522) {
            int64_t lifted_lambda_res_t_res_583152 = sub64(write_iv_586094, (int64_t) 1);
            
            lifted_lambda_res_582523 = lifted_lambda_res_t_res_583152;
        } else {
            lifted_lambda_res_582523 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_572919)) {
            ((int64_t *) mem_586516)[lifted_lambda_res_582523] = write_iv_586095;
        }
    }
    if (memblock_unref(ctx, &ext_mem_586498, "ext_mem_586498") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_586525, bytes_586524, "mem_586525")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586527, bytes_586515, "mem_586527")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586101 = 0; i_586101 < m_572919; i_586101++) {
        int64_t eta_p_572944 = ((int64_t *) mem_586516)[i_586101];
        bool x_572945 = sle64((int64_t) 0, eta_p_572944);
        bool y_572946 = slt64(eta_p_572944, dz2083U_302014);
        bool bounds_check_572947 = x_572945 && y_572946;
        bool index_certs_572948;
        
        if (!bounds_check_572947) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_572944, "] out of bounds for array of shape [", (long long) dz2083U_302014, "].", "-> #0  ftSkyline.fut:408:53-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:408:42-64\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:822:26-29\n   #5  ftSkyline.fut:820:17-824:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_572950 = ((int64_t *) xys_mem_586420.mem)[eta_p_572944];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586525.mem, i_586101 * dim_302009, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, eta_p_572944 * dim_302009, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_302009});
        ((int64_t *) mem_586527.mem)[i_586101] = lifted_lambda_res_572950;
    }
    if (mem_586543_cached_sizze_588349 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586543, &mem_586543_cached_sizze_588349, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586106 = 0; i_586106 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011; i_586106++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572959 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586106];
        double i64_res_572960 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572959);
        double defunc_0_fover_res_572961 = 1.5707963267948966 / i64_res_572960;
        
        ((double *) mem_586543)[i_586106] = defunc_0_fover_res_572961;
    }
    if (mem_586551_cached_sizze_588350 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588350, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586556_cached_sizze_588351 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586556, &mem_586556_cached_sizze_588351, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586564_cached_sizze_588352 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586564, &mem_586564_cached_sizze_588352, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586572_cached_sizze_588353 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586572, &mem_586572_cached_sizze_588353, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586588_cached_sizze_588355 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586588, &mem_586588_cached_sizze_588355, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586126 = 0; i_586126 < dz2083U_302014; i_586126++) {
        for (int64_t i_586110 = 0; i_586110 < dim_302009; i_586110++) {
            double eta_p_583092 = ((double *) xys_mem_586419.mem)[i_586126 * dim_302009 + i_586110];
            double eta_p_583093 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586110];
            double eta_p_583094 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586110];
            int64_t eta_p_583096 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586110];
            double defunc_0_f_res_583097 = eta_p_583092 - eta_p_583093;
            double defunc_0_f_res_583099 = defunc_0_f_res_583097 / eta_p_583094;
            int64_t f64_res_583101 = fptosi_f64_i64(defunc_0_f_res_583099);
            int64_t max_res_583103 = smax64((int64_t) 0, f64_res_583101);
            int64_t zm_lhs_583109 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586110];
            int64_t min_arg1_583110 = sub64(zm_lhs_583109, (int64_t) 1);
            int64_t min_res_583111 = smin64(max_res_583103, min_arg1_583110);
            int64_t defunc_0_f_res_583113 = mul64(eta_p_583096, min_res_583111);
            
            ((int64_t *) mem_586556)[i_586110] = defunc_0_f_res_583113;
        }
        
        int64_t defunc_0_foldl_res_572988;
        int64_t acc_572990 = (int64_t) 0;
        
        for (int64_t i_572989 = 0; i_572989 < dim_302009; i_572989++) {
            int64_t b_572991 = ((int64_t *) mem_586556)[i_572989];
            int64_t defunc_0_f_res_572992 = add64(acc_572990, b_572991);
            int64_t acc_tmp_588042 = defunc_0_f_res_572992;
            
            acc_572990 = acc_tmp_588042;
        }
        defunc_0_foldl_res_572988 = acc_572990;
        
        bool x_572993 = sle64((int64_t) 0, defunc_0_foldl_res_572988);
        bool y_572994 = slt64(defunc_0_foldl_res_572988, dz2080U_302010);
        bool bounds_check_572995 = x_572993 && y_572994;
        bool index_certs_572996;
        
        if (!bounds_check_572995) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_572988, "] out of bounds for array of shape [", (long long) dz2080U_302010, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586114 = 0; i_586114 < dim_302009; i_586114++) {
            double eta_p_572999 = ((double *) xys_mem_586419.mem)[i_586126 * dim_302009 + i_586114];
            double eta_p_573000 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_572988 * dim_302009 + i_586114];
            double defunc_0_f_res_573001 = eta_p_572999 - eta_p_573000;
            
            ((double *) mem_586564)[i_586114] = defunc_0_f_res_573001;
        }
        for (int64_t nest_i_588044 = 0; nest_i_588044 < arg_572684; nest_i_588044++) {
            ((double *) mem_586572)[nest_i_588044] = 0.0;
        }
        for (int64_t i_573004 = 0; i_573004 < arg_572684; i_573004++) {
            bool y_573006 = slt64(i_573004, dim_302009);
            bool index_certs_573007;
            
            if (!y_573006) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_573004, "] out of bounds for array of shape [", (long long) dim_302009, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_573009 = add64((int64_t) 1, i_573004);
            int64_t j_m_i_573010 = sub64(dim_302009, map_arg1_573009);
            bool empty_slice_573011 = j_m_i_573010 == (int64_t) 0;
            int64_t m_573012 = sub64(j_m_i_573010, (int64_t) 1);
            int64_t i_p_m_t_s_573013 = add64(map_arg1_573009, m_573012);
            bool zzero_leq_i_p_m_t_s_573014 = sle64((int64_t) 0, i_p_m_t_s_573013);
            bool i_p_m_t_s_leq_w_573015 = slt64(i_p_m_t_s_573013, dim_302009);
            bool zzero_lte_i_573016 = sle64((int64_t) 0, map_arg1_573009);
            bool i_lte_j_573017 = sle64(map_arg1_573009, dim_302009);
            bool y_573018 = i_p_m_t_s_leq_w_573015 && zzero_lte_i_573016;
            bool y_573019 = zzero_leq_i_p_m_t_s_573014 && y_573018;
            bool forwards_ok_573020 = i_lte_j_573017 && y_573019;
            bool ok_or_empty_573021 = empty_slice_573011 || forwards_ok_573020;
            bool index_certs_573022;
            
            if (!ok_or_empty_573021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_573009, ":", (long long) dim_302009, "] out of bounds for array of shape [", (long long) dim_302009, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:822:26-29\n   #6  ftSkyline.fut:820:17-824:68\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586576 = (int64_t) 8 * j_m_i_573010;
            double this_x_573008 = ((double *) mem_586564)[i_573004];
            
            if (mem_586577_cached_sizze_588354 < bytes_586576) {
                err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588354, bytes_586576);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586118 = 0; i_586118 < j_m_i_573010; i_586118++) {
                int64_t slice_586364 = map_arg1_573009 + i_586118;
                double eta_p_573025 = ((double *) mem_586564)[slice_586364];
                double defunc_0_ftimes_res_573026 = eta_p_573025 * eta_p_573025;
                
                ((double *) mem_586577)[i_586118] = defunc_0_ftimes_res_573026;
            }
            
            double defunc_0_foldl_res_573027;
            double acc_573029 = 0.0;
            
            for (int64_t i_573028 = 0; i_573028 < j_m_i_573010; i_573028++) {
                double b_573030 = ((double *) mem_586577)[i_573028];
                double defunc_0_f_res_573031 = acc_573029 + b_573030;
                double acc_tmp_588047 = defunc_0_f_res_573031;
                
                acc_573029 = acc_tmp_588047;
            }
            defunc_0_foldl_res_573027 = acc_573029;
            
            double sqrt_res_573032 = futrts_sqrt64(defunc_0_foldl_res_573027);
            double atan2_res_573033 = futrts_atan2_64(sqrt_res_573032, this_x_573008);
            
            ((double *) mem_586572)[i_573004] = atan2_res_573033;
        }
        for (int64_t i_586122 = 0; i_586122 < arg_572684; i_586122++) {
            double eta_p_573036 = ((double *) mem_586572)[i_586122];
            double eta_p_573037 = ((double *) mem_586543)[i_586122];
            int64_t eta_p_573038 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586122];
            int64_t eta_p_573039 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586122];
            double i64_res_573040 = sitofp_i64_f64(eta_p_573038);
            double defunc_0_fover_res_573041 = eta_p_573036 / eta_p_573037;
            double defunc_0_ftimes_res_573042 = i64_res_573040 * defunc_0_fover_res_573041;
            int64_t f64_res_573043 = fptosi_f64_i64(defunc_0_ftimes_res_573042);
            bool cond_573044 = slt64(f64_res_573043, (int64_t) 0);
            int64_t defunc_0_f_res_573045;
            
            if (cond_573044) {
                defunc_0_f_res_573045 = (int64_t) 0;
            } else {
                bool cond_573046 = sle64(eta_p_573039, f64_res_573043);
                int64_t defunc_0_f_res_f_res_573047;
                
                if (cond_573046) {
                    int64_t defunc_0_f_res_f_res_t_res_583155 = sub64(eta_p_573039, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_573047 = defunc_0_f_res_f_res_t_res_583155;
                } else {
                    defunc_0_f_res_f_res_573047 = f64_res_573043;
                }
                defunc_0_f_res_573045 = defunc_0_f_res_f_res_573047;
            }
            ((int64_t *) mem_586588)[i_586122] = defunc_0_f_res_573045;
        }
        
        int64_t defunc_0_foldl_res_573049;
        int64_t acc_573051 = (int64_t) 0;
        
        for (int64_t i_573050 = 0; i_573050 < arg_572684; i_573050++) {
            int64_t b_573052 = ((int64_t *) mem_586588)[i_573050];
            int64_t defunc_0_f_res_573053 = add64(acc_573051, b_573052);
            int64_t acc_tmp_588049 = defunc_0_f_res_573053;
            
            acc_573051 = acc_tmp_588049;
        }
        defunc_0_foldl_res_573049 = acc_573051;
        
        int64_t zp_lhs_573054 = mul64(total_angle_no_302021, defunc_0_foldl_res_572988);
        int64_t get_id_from_grid_angle_res_573055 = add64(defunc_0_foldl_res_573049, zp_lhs_573054);
        
        ((int64_t *) mem_586551)[i_586126] = get_id_from_grid_angle_res_573055;
    }
    if (mem_586599_cached_sizze_588356 < bytes_586598) {
        err = lexical_realloc(ctx, &mem_586599, &mem_586599_cached_sizze_588356, bytes_586598);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588050 = 0; nest_i_588050 < total_part_no_302023; nest_i_588050++) {
        ((int64_t *) mem_586599)[nest_i_588050] = (int64_t) 0;
    }
    for (int64_t iter_586128 = 0; iter_586128 < m_572919; iter_586128++) {
        int64_t pixel_586130 = ((int64_t *) mem_586516)[iter_586128];
        bool x_582512 = sle64((int64_t) 0, pixel_586130);
        bool y_582513 = slt64(pixel_586130, dz2083U_302014);
        bool bounds_check_582514 = x_582512 && y_582513;
        bool index_certs_582515;
        
        if (!bounds_check_582514) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586130, "] out of bounds for array of shape [", (long long) dz2083U_302014, "].", "-> #0  ftSkyline.fut:413:51-62\n   #1  ftSkyline.fut:822:26-29\n   #2  ftSkyline.fut:820:17-824:68\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586551)[pixel_586130];
        bool less_than_zzero_586132 = slt64(lifted_lambda_res_582516, (int64_t) 0);
        bool greater_than_sizze_586133 = sle64(total_part_no_302023, lifted_lambda_res_582516);
        bool outside_bounds_dim_586134 = less_than_zzero_586132 || greater_than_sizze_586133;
        
        if (!outside_bounds_dim_586134) {
            int64_t read_hist_586136 = ((int64_t *) mem_586599)[lifted_lambda_res_582516];
            int64_t defunc_0_op_res_573067 = add64((int64_t) 1, read_hist_586136);
            
            ((int64_t *) mem_586599)[lifted_lambda_res_582516] = defunc_0_op_res_573067;
        }
    }
    if (mem_586607_cached_sizze_588357 < bytes_586598) {
        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_588357, bytes_586598);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586144;
    int64_t scanacc_586140 = (int64_t) 0;
    
    for (int64_t i_586142 = 0; i_586142 < total_part_no_302023; i_586142++) {
        int64_t x_573071 = ((int64_t *) mem_586599)[i_586142];
        int64_t defunc_0_op_res_573074 = add64(x_573071, scanacc_586140);
        
        ((int64_t *) mem_586607)[i_586142] = defunc_0_op_res_573074;
        
        int64_t scanacc_tmp_588052 = defunc_0_op_res_573074;
        
        scanacc_586140 = scanacc_tmp_588052;
    }
    discard_586144 = scanacc_586140;
    if (memblock_alloc(ctx, &mem_586615, bytes_586598, "mem_586615")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586147 = 0; i_586147 < total_part_no_302023; i_586147++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586147);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_302023);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586607)[tmp_582504];
        bool cond_582507 = i_586147 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586615.mem)[i_586147] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586615, "mem_586615") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586525, "mem_586525") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586527, "mem_586527") != 0)
        return 1;
    prim_out_588011 = total_part_no_302023;
    prim_out_588012 = m_572919;
    if (memblock_set(ctx, &*mem_out_p_588332, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588333, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588334, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588335, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588336 = prim_out_588011;
    *out_prim_out_588337 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586427);
        free(mem_586440);
        free(mem_586448);
        free(mem_586456);
        free(mem_586461);
        free(mem_586472);
        free(mem_586479);
        free(mem_586486);
        free(mem_586500);
        free(mem_586502);
        free(mem_586516);
        free(mem_586543);
        free(mem_586551);
        free(mem_586556);
        free(mem_586564);
        free(mem_586572);
        free(mem_586577);
        free(mem_586588);
        free(mem_586599);
        free(mem_586607);
        if (memblock_unref(ctx, &mem_586615, "mem_586615") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586527, "mem_586527") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586525, "mem_586525") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586435, "mem_586435") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586425, "mem_param_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586498, "ext_mem_586498") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_local_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588358, struct memblock *mem_out_p_588359, struct memblock *mem_out_p_588360, struct memblock *mem_out_p_588361, int64_t *out_prim_out_588362, int64_t *out_prim_out_588363, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, int64_t dim_466278, int64_t dz2080U_466279, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280, int64_t dz2081U_466281, int64_t dz2082U_466282, int64_t dz2083U_466283, int64_t total_angle_no_466290, int64_t total_grid_no_466291, int64_t total_part_no_466292)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586427_cached_sizze_588364 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586440_cached_sizze_588365 = 0;
    unsigned char *mem_586440 = NULL;
    int64_t mem_586448_cached_sizze_588366 = 0;
    unsigned char *mem_586448 = NULL;
    int64_t mem_586456_cached_sizze_588367 = 0;
    unsigned char *mem_586456 = NULL;
    int64_t mem_586461_cached_sizze_588368 = 0;
    unsigned char *mem_586461 = NULL;
    int64_t mem_586472_cached_sizze_588369 = 0;
    unsigned char *mem_586472 = NULL;
    int64_t mem_586479_cached_sizze_588370 = 0;
    unsigned char *mem_586479 = NULL;
    int64_t mem_586486_cached_sizze_588371 = 0;
    unsigned char *mem_586486 = NULL;
    int64_t mem_586500_cached_sizze_588372 = 0;
    unsigned char *mem_586500 = NULL;
    int64_t mem_586502_cached_sizze_588373 = 0;
    unsigned char *mem_586502 = NULL;
    int64_t mem_586516_cached_sizze_588374 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586543_cached_sizze_588375 = 0;
    unsigned char *mem_586543 = NULL;
    int64_t mem_586551_cached_sizze_588376 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586556_cached_sizze_588377 = 0;
    unsigned char *mem_586556 = NULL;
    int64_t mem_586564_cached_sizze_588378 = 0;
    unsigned char *mem_586564 = NULL;
    int64_t mem_586572_cached_sizze_588379 = 0;
    unsigned char *mem_586572 = NULL;
    int64_t mem_586577_cached_sizze_588380 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586588_cached_sizze_588381 = 0;
    unsigned char *mem_586588 = NULL;
    int64_t mem_586599_cached_sizze_588382 = 0;
    unsigned char *mem_586599 = NULL;
    int64_t mem_586607_cached_sizze_588383 = 0;
    unsigned char *mem_586607 = NULL;
    struct memblock mem_586615;
    
    mem_586615.references = NULL;
    
    struct memblock mem_586527;
    
    mem_586527.references = NULL;
    
    struct memblock mem_586525;
    
    mem_586525.references = NULL;
    
    struct memblock mem_param_tmp_588016;
    
    mem_param_tmp_588016.references = NULL;
    
    struct memblock mem_586435;
    
    mem_586435.references = NULL;
    
    struct memblock mem_param_586425;
    
    mem_param_586425.references = NULL;
    
    struct memblock ext_mem_586498;
    
    ext_mem_586498.references = NULL;
    
    struct memblock mem_586422;
    
    mem_586422.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t arg_572684 = sub64(dim_466278, (int64_t) 1);
    bool assert_cond_572685 = arg_572684 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280;
    bool assert_c_572686;
    
    if (!assert_cond_572685) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftSkyline.fut:969:26-971:43\n   #1  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zeze_rhs_572688 = sub64(dz2082U_466282, (int64_t) 1);
    int64_t defunc_0_reduce_res_583160;
    int64_t redout_586048 = (int64_t) -9223372036854775808;
    
    for (int64_t i_586049 = 0; i_586049 < dz2082U_466282; i_586049++) {
        bool cond_582533 = i_586049 == zeze_rhs_572688;
        int64_t lifted_lambda_res_582534;
        
        if (cond_582533) {
            int64_t zm_rhs_583128 = ((int64_t *) part_idx_mem_586418.mem)[i_586049];
            int64_t lifted_lambda_res_t_res_583129 = sub64(dz2083U_466283, zm_rhs_583128);
            
            lifted_lambda_res_582534 = lifted_lambda_res_t_res_583129;
        } else {
            int64_t zm_lhs_582541 = add64((int64_t) 1, i_586049);
            bool x_582542 = sle64((int64_t) 0, zm_lhs_582541);
            bool y_582543 = slt64(zm_lhs_582541, dz2082U_466282);
            bool bounds_check_582544 = x_582542 && y_582543;
            bool index_certs_582545;
            
            if (!bounds_check_582544) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582541, "] out of bounds for array of shape [", (long long) dz2082U_466282, "].", "-> #0  ftSkyline.fut:376:38-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:969:26-29\n   #4  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582546 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582541];
            int64_t zm_rhs_582551 = ((int64_t *) part_idx_mem_586418.mem)[i_586049];
            int64_t lifted_lambda_res_f_res_582552 = sub64(zm_lhs_582546, zm_rhs_582551);
            
            lifted_lambda_res_582534 = lifted_lambda_res_f_res_582552;
        }
        
        int64_t max_res_572715 = smax64(lifted_lambda_res_582534, redout_586048);
        int64_t redout_tmp_588013 = max_res_572715;
        
        redout_586048 = redout_tmp_588013;
    }
    defunc_0_reduce_res_583160 = redout_586048;
    
    int64_t bytes_586421 = (int64_t) 8 * dz2083U_466283;
    
    if (memblock_alloc(ctx, &mem_586422, bytes_586421, "mem_586422")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_588014 = 0; i_588014 < dz2083U_466283; i_588014++) {
        int64_t x_588015 = (int64_t) 0 + i_588014 * (int64_t) 1;
        
        ((int64_t *) mem_586422.mem)[i_588014] = x_588015;
    }
    
    bool bounds_invalid_upwards_572717 = slt64(defunc_0_reduce_res_583160, (int64_t) 0);
    bool valid_572718 = !bounds_invalid_upwards_572717;
    bool range_valid_c_572719;
    
    if (!valid_572718) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_0_reduce_res_583160, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:380:65-83\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:969:26-29\n   #4  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t min_arg1_572720 = sub64(dz2083U_466283, (int64_t) 1);
    bool loop_nonempty_572721 = slt64((int64_t) 0, defunc_0_reduce_res_583160);
    bool y_572722 = slt64((int64_t) 0, dz2080U_466279);
    bool loop_not_taken_572723 = !loop_nonempty_572721;
    bool protect_assert_disj_572724 = y_572722 || loop_not_taken_572723;
    bool index_certs_572725;
    
    if (!protect_assert_disj_572724) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_466279, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_572730 = assert_cond_572685 || loop_not_taken_572723;
    bool empty_or_match_cert_572731;
    
    if (!protect_assert_disj_572730) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586426 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280;
    int64_t bytes_586439 = (int64_t) 8 * dim_466278;
    int64_t bytes_586447 = (int64_t) 4 * dim_466278;
    int64_t bytes_586455 = (int64_t) 4 * arg_572684;
    int64_t bytes_586471 = (int64_t) 8 * arg_572684;
    
    if (mem_586427_cached_sizze_588364 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_588364, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586440_cached_sizze_588365 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586440, &mem_586440_cached_sizze_588365, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586448_cached_sizze_588366 < bytes_586447) {
        err = lexical_realloc(ctx, &mem_586448, &mem_586448_cached_sizze_588366, bytes_586447);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586456_cached_sizze_588367 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586456, &mem_586456_cached_sizze_588367, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586472_cached_sizze_588369 < bytes_586471) {
        err = lexical_realloc(ctx, &mem_586472, &mem_586472_cached_sizze_588369, bytes_586471);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_586425, &mem_586422, "mem_586422") != 0)
        return 1;
    for (int64_t i_572735 = 0; i_572735 < defunc_0_reduce_res_583160; i_572735++) {
        for (int64_t i_586052 = 0; i_586052 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280; i_586052++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572744 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586052];
            float i64_res_572745 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572744);
            float defunc_0_fover_res_572746 = 1.5707964F / i64_res_572745;
            
            ((float *) mem_586427)[i_586052] = defunc_0_fover_res_572746;
        }
        if (memblock_alloc(ctx, &mem_586435, bytes_586421, "mem_586435")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_586080 = 0; i_586080 < dz2083U_466283; i_586080++) {
            for (int64_t i_586056 = 0; i_586056 < dim_466278; i_586056++) {
                float eta_p_582942 = ((float *) xys_mem_586419.mem)[i_586080 * dim_466278 + i_586056];
                float eta_p_582943 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586056];
                float eta_p_582944 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586056];
                int64_t eta_p_582946 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586056];
                float defunc_0_f_res_582947 = eta_p_582942 - eta_p_582943;
                float defunc_0_f_res_582949 = defunc_0_f_res_582947 / eta_p_582944;
                int64_t f32_res_582951 = fptosi_f32_i64(defunc_0_f_res_582949);
                int64_t max_res_582953 = smax64((int64_t) 0, f32_res_582951);
                int64_t zm_lhs_582959 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586056];
                int64_t min_arg1_582960 = sub64(zm_lhs_582959, (int64_t) 1);
                int64_t min_res_582961 = smin64(max_res_582953, min_arg1_582960);
                int64_t defunc_0_f_res_582963 = mul64(eta_p_582946, min_res_582961);
                
                ((int64_t *) mem_586440)[i_586056] = defunc_0_f_res_582963;
            }
            
            int64_t defunc_0_foldl_res_582754;
            int64_t acc_582756 = (int64_t) 0;
            
            for (int64_t i_582755 = 0; i_582755 < dim_466278; i_582755++) {
                int64_t b_582757 = ((int64_t *) mem_586440)[i_582755];
                int64_t defunc_0_f_res_582758 = add64(acc_582756, b_582757);
                int64_t acc_tmp_588021 = defunc_0_f_res_582758;
                
                acc_582756 = acc_tmp_588021;
            }
            defunc_0_foldl_res_582754 = acc_582756;
            
            bool x_582759 = sle64((int64_t) 0, defunc_0_foldl_res_582754);
            bool y_582760 = slt64(defunc_0_foldl_res_582754, dz2080U_466279);
            bool bounds_check_582761 = x_582759 && y_582760;
            bool index_certs_582762;
            
            if (!bounds_check_582761) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582754, "] out of bounds for array of shape [", (long long) dz2080U_466279, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586060 = 0; i_586060 < dim_466278; i_586060++) {
                float eta_p_582765 = ((float *) xys_mem_586419.mem)[i_586080 * dim_466278 + i_586060];
                float eta_p_582766 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582754 * dim_466278 + i_586060];
                float defunc_0_f_res_582767 = eta_p_582765 - eta_p_582766;
                
                ((float *) mem_586448)[i_586060] = defunc_0_f_res_582767;
            }
            for (int64_t nest_i_588023 = 0; nest_i_588023 < arg_572684; nest_i_588023++) {
                ((float *) mem_586456)[nest_i_588023] = 0.0F;
            }
            for (int64_t i_582770 = 0; i_582770 < arg_572684; i_582770++) {
                bool y_582772 = slt64(i_582770, dim_466278);
                bool index_certs_582773;
                
                if (!y_582772) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582770, "] out of bounds for array of shape [", (long long) dim_466278, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_582775 = add64((int64_t) 1, i_582770);
                int64_t j_m_i_582776 = sub64(dim_466278, map_arg1_582775);
                bool empty_slice_582777 = j_m_i_582776 == (int64_t) 0;
                int64_t m_582778 = sub64(j_m_i_582776, (int64_t) 1);
                int64_t i_p_m_t_s_582779 = add64(map_arg1_582775, m_582778);
                bool zzero_leq_i_p_m_t_s_582780 = sle64((int64_t) 0, i_p_m_t_s_582779);
                bool i_p_m_t_s_leq_w_582781 = slt64(i_p_m_t_s_582779, dim_466278);
                bool zzero_lte_i_582782 = sle64((int64_t) 0, map_arg1_582775);
                bool i_lte_j_582783 = sle64(map_arg1_582775, dim_466278);
                bool y_582784 = i_p_m_t_s_leq_w_582781 && zzero_lte_i_582782;
                bool y_582785 = zzero_leq_i_p_m_t_s_582780 && y_582784;
                bool forwards_ok_582786 = i_lte_j_582783 && y_582785;
                bool ok_or_empty_582787 = empty_slice_582777 || forwards_ok_582786;
                bool index_certs_582788;
                
                if (!ok_or_empty_582787) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582775, ":", (long long) dim_466278, "] out of bounds for array of shape [", (long long) dim_466278, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:382:108-109\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586460 = (int64_t) 4 * j_m_i_582776;
                float this_x_582774 = ((float *) mem_586448)[i_582770];
                
                if (mem_586461_cached_sizze_588368 < bytes_586460) {
                    err = lexical_realloc(ctx, &mem_586461, &mem_586461_cached_sizze_588368, bytes_586460);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586064 = 0; i_586064 < j_m_i_582776; i_586064++) {
                    int64_t slice_586369 = map_arg1_582775 + i_586064;
                    float eta_p_582791 = ((float *) mem_586448)[slice_586369];
                    float defunc_0_ftimes_res_582792 = eta_p_582791 * eta_p_582791;
                    
                    ((float *) mem_586461)[i_586064] = defunc_0_ftimes_res_582792;
                }
                
                float defunc_0_foldl_res_582793;
                float acc_582795 = 0.0F;
                
                for (int64_t i_582794 = 0; i_582794 < j_m_i_582776; i_582794++) {
                    float b_582796 = ((float *) mem_586461)[i_582794];
                    float defunc_0_f_res_582797 = acc_582795 + b_582796;
                    float acc_tmp_588026 = defunc_0_f_res_582797;
                    
                    acc_582795 = acc_tmp_588026;
                }
                defunc_0_foldl_res_582793 = acc_582795;
                
                float sqrt_res_582798 = futrts_sqrt32(defunc_0_foldl_res_582793);
                float atan2_res_582799 = futrts_atan2_32(sqrt_res_582798, this_x_582774);
                
                ((float *) mem_586456)[i_582770] = atan2_res_582799;
            }
            for (int64_t i_586068 = 0; i_586068 < arg_572684; i_586068++) {
                float eta_p_582802 = ((float *) mem_586456)[i_586068];
                float eta_p_582803 = ((float *) mem_586427)[i_586068];
                int64_t eta_p_582804 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586068];
                int64_t eta_p_582805 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586068];
                float i64_res_582806 = sitofp_i64_f32(eta_p_582804);
                float defunc_0_fover_res_582807 = eta_p_582802 / eta_p_582803;
                float defunc_0_ftimes_res_582808 = i64_res_582806 * defunc_0_fover_res_582807;
                int64_t f32_res_582809 = fptosi_f32_i64(defunc_0_ftimes_res_582808);
                bool cond_582810 = slt64(f32_res_582809, (int64_t) 0);
                int64_t defunc_0_f_res_582811;
                
                if (cond_582810) {
                    defunc_0_f_res_582811 = (int64_t) 0;
                } else {
                    bool cond_582812 = sle64(eta_p_582805, f32_res_582809);
                    int64_t defunc_0_f_res_f_res_582813;
                    
                    if (cond_582812) {
                        int64_t defunc_0_f_res_f_res_t_res_583132 = sub64(eta_p_582805, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_582813 = defunc_0_f_res_f_res_t_res_583132;
                    } else {
                        defunc_0_f_res_f_res_582813 = f32_res_582809;
                    }
                    defunc_0_f_res_582811 = defunc_0_f_res_f_res_582813;
                }
                ((int64_t *) mem_586472)[i_586068] = defunc_0_f_res_582811;
            }
            
            int64_t defunc_0_foldl_res_582815;
            int64_t acc_582817 = (int64_t) 0;
            
            for (int64_t i_582816 = 0; i_582816 < arg_572684; i_582816++) {
                int64_t b_582818 = ((int64_t *) mem_586472)[i_582816];
                int64_t defunc_0_f_res_582819 = add64(acc_582817, b_582818);
                int64_t acc_tmp_588028 = defunc_0_f_res_582819;
                
                acc_582817 = acc_tmp_588028;
            }
            defunc_0_foldl_res_582815 = acc_582817;
            
            int64_t zp_lhs_582822 = mul64(total_angle_no_466290, defunc_0_foldl_res_582754);
            int64_t get_id_from_grid_angle_res_582823 = add64(defunc_0_foldl_res_582815, zp_lhs_582822);
            bool x_582826 = sle64((int64_t) 0, get_id_from_grid_angle_res_582823);
            bool y_582827 = slt64(get_id_from_grid_angle_res_582823, dz2082U_466282);
            bool bounds_check_582828 = x_582826 && y_582827;
            bool index_certs_582829;
            
            if (!bounds_check_582828) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582823, "] out of bounds for array of shape [", (long long) dz2082U_466282, "].", "-> #0  ftSkyline.fut:389:73-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:969:26-29\n   #4  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582830 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582823];
            int64_t min_arg0_582831 = add64(i_572735, zp_lhs_582830);
            int64_t min_res_582832 = smin64(min_arg1_572720, min_arg0_582831);
            bool x_582834 = sle64((int64_t) 0, min_res_582832);
            bool y_582835 = slt64(min_res_582832, dz2083U_466283);
            bool bounds_check_582836 = x_582834 && y_582835;
            bool index_certs_582837;
            
            if (!bounds_check_582836) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_582832, "] out of bounds for array of shape [", (long long) dz2083U_466283, "].", "-> #0  ftSkyline.fut:390:56-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:390:44-70\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t eta_p_582724 = ((int64_t *) mem_param_586425.mem)[i_586080];
            bool cond_582840 = slt64(eta_p_582724, (int64_t) 0);
            bool x_582842 = !cond_582840;
            bool cond_f_res_582841 = eta_p_582724 == i_572735;
            bool y_582843 = cond_f_res_582841 && x_582842;
            bool cond_582844 = cond_582840 || y_582843;
            int64_t defunc_0_f_res_582845;
            
            if (cond_582844) {
                defunc_0_f_res_582845 = eta_p_582724;
            } else {
                bool zzero_582846 = total_angle_no_466290 == (int64_t) 0;
                bool nonzzero_582847 = !zzero_582846;
                bool nonzzero_cert_582848;
                
                if (!nonzzero_582847) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:366:10-394:98\n   #2  /prelude/soacs.fut:83:33-34\n   #3  /prelude/soacs.fut:83:37-53\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t grid_id_582849 = sdiv64(get_id_from_grid_angle_res_582823, total_angle_no_466290);
                bool y_582851 = slt64(grid_id_582849, dz2081U_466281);
                bool x_582850 = sle64((int64_t) 0, grid_id_582849);
                bool bounds_check_582852 = x_582850 && y_582851;
                bool index_certs_582853;
                
                if (!bounds_check_582852) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582849, "] out of bounds for array of shape [", (long long) dz2081U_466281, "].", "-> #0  ftSkyline.fut:395:52-81\n   #1  /prelude/soacs.fut:83:33-34\n   #2  /prelude/soacs.fut:83:37-53\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool cond_582854 = ((bool *) isPartitionDominated_mem_586417.mem)[grid_id_582849];
                int64_t defunc_0_f_res_f_res_582855;
                
                if (cond_582854) {
                    defunc_0_f_res_f_res_582855 = (int64_t) -1;
                } else {
                    if (mem_586479_cached_sizze_588370 < dim_466278) {
                        err = lexical_realloc(ctx, &mem_586479, &mem_586479_cached_sizze_588370, dim_466278);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_586072 = 0; i_586072 < dim_466278; i_586072++) {
                        float eta_p_582857 = ((float *) xys_mem_586419.mem)[i_586080 * dim_466278 + i_586072];
                        float eta_p_582858 = ((float *) xys_mem_586419.mem)[min_res_582832 * dim_466278 + i_586072];
                        bool defunc_0_f_res_582859 = eta_p_582858 <= eta_p_582857;
                        
                        ((bool *) mem_586479)[i_586072] = defunc_0_f_res_582859;
                    }
                    
                    bool defunc_0_foldl_res_582860;
                    bool acc_582862 = 1;
                    
                    for (int64_t i_582861 = 0; i_582861 < dim_466278; i_582861++) {
                        bool b_582863 = ((bool *) mem_586479)[i_582861];
                        bool x_582864 = acc_582862 && b_582863;
                        bool acc_tmp_588030 = x_582864;
                        
                        acc_582862 = acc_tmp_588030;
                    }
                    defunc_0_foldl_res_582860 = acc_582862;
                    
                    bool elimd_582865;
                    
                    if (defunc_0_foldl_res_582860) {
                        if (mem_586486_cached_sizze_588371 < dim_466278) {
                            err = lexical_realloc(ctx, &mem_586486, &mem_586486_cached_sizze_588371, dim_466278);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586076 = 0; i_586076 < dim_466278; i_586076++) {
                            float eta_p_583135 = ((float *) xys_mem_586419.mem)[i_586080 * dim_466278 + i_586076];
                            float eta_p_583136 = ((float *) xys_mem_586419.mem)[min_res_582832 * dim_466278 + i_586076];
                            bool defunc_0_f_res_583137 = eta_p_583136 < eta_p_583135;
                            
                            ((bool *) mem_586486)[i_586076] = defunc_0_f_res_583137;
                        }
                        
                        bool defunc_0_foldl_res_583139;
                        bool acc_583141 = 0;
                        
                        for (int64_t i_583140 = 0; i_583140 < dim_466278; i_583140++) {
                            bool b_583142 = ((bool *) mem_586486)[i_583140];
                            bool defunc_0_f_res_583143 = acc_583141 || b_583142;
                            bool acc_tmp_588032 = defunc_0_f_res_583143;
                            
                            acc_583141 = acc_tmp_588032;
                        }
                        defunc_0_foldl_res_583139 = acc_583141;
                        elimd_582865 = defunc_0_foldl_res_583139;
                    } else {
                        elimd_582865 = 0;
                    }
                    
                    int64_t defunc_0_f_res_f_res_f_res_582875;
                    
                    if (elimd_582865) {
                        defunc_0_f_res_f_res_f_res_582875 = (int64_t) -1;
                    } else {
                        defunc_0_f_res_f_res_f_res_582875 = eta_p_582724;
                    }
                    defunc_0_f_res_f_res_582855 = defunc_0_f_res_f_res_f_res_582875;
                }
                defunc_0_f_res_582845 = defunc_0_f_res_f_res_582855;
            }
            ((int64_t *) mem_586435.mem)[i_586080] = defunc_0_f_res_582845;
        }
        if (memblock_set(ctx, &mem_param_tmp_588016, &mem_586435, "mem_586435") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_586425, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_586498, &mem_param_586425, "mem_param_586425") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
        return 1;
    if (mem_586500_cached_sizze_588372 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586500, &mem_586500_cached_sizze_588372, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586502_cached_sizze_588373 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586502, &mem_586502_cached_sizze_588373, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586090;
    int64_t scanacc_586084 = (int64_t) 0;
    
    for (int64_t i_586087 = 0; i_586087 < dz2083U_466283; i_586087++) {
        int64_t eta_p_582527 = ((int64_t *) ext_mem_586498.mem)[i_586087];
        bool lifted_lambda_res_582528 = sle64((int64_t) 0, eta_p_582527);
        int64_t defunc_0_f_res_582529 = btoi_bool_i64(lifted_lambda_res_582528);
        int64_t defunc_0_op_res_572909 = add64(defunc_0_f_res_582529, scanacc_586084);
        
        ((int64_t *) mem_586500)[i_586087] = defunc_0_op_res_572909;
        ((int64_t *) mem_586502)[i_586087] = defunc_0_f_res_582529;
        
        int64_t scanacc_tmp_588033 = defunc_0_op_res_572909;
        
        scanacc_586084 = scanacc_tmp_588033;
    }
    discard_586090 = scanacc_586084;
    
    bool cond_572910 = dz2083U_466283 == (int64_t) 0;
    bool x_572911 = !cond_572910;
    bool x_572912 = sle64((int64_t) 0, min_arg1_572720);
    bool y_572913 = slt64(min_arg1_572720, dz2083U_466283);
    bool bounds_check_572914 = x_572912 && y_572913;
    bool protect_assert_disj_572915 = cond_572910 || bounds_check_572914;
    bool index_certs_572916;
    
    if (!protect_assert_disj_572915) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_arg1_572720, "] out of bounds for array of shape [", (long long) dz2083U_466283, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:969:26-29\n   #4  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_572917;
    
    if (x_572911) {
        int64_t x_583151 = ((int64_t *) mem_586500)[min_arg1_572720];
        
        m_f_res_572917 = x_583151;
    } else {
        m_f_res_572917 = (int64_t) 0;
    }
    
    int64_t m_572919;
    
    if (cond_572910) {
        m_572919 = (int64_t) 0;
    } else {
        m_572919 = m_f_res_572917;
    }
    
    int64_t m_572929 = sub64(m_572919, (int64_t) 1);
    bool i_p_m_t_s_leq_w_572931 = slt64(m_572929, dz2083U_466283);
    bool zzero_leq_i_p_m_t_s_572930 = sle64((int64_t) 0, m_572929);
    bool y_572933 = zzero_leq_i_p_m_t_s_572930 && i_p_m_t_s_leq_w_572931;
    bool i_lte_j_572932 = sle64((int64_t) 0, m_572919);
    bool forwards_ok_572934 = i_lte_j_572932 && y_572933;
    bool eq_x_zz_572926 = (int64_t) 0 == m_f_res_572917;
    bool p_and_eq_x_y_572927 = x_572911 && eq_x_zz_572926;
    bool empty_slice_572928 = cond_572910 || p_and_eq_x_y_572927;
    bool ok_or_empty_572935 = empty_slice_572928 || forwards_ok_572934;
    bool index_certs_572936;
    
    if (!ok_or_empty_572935) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_572919, "] out of bounds for array of shape [", (long long) dz2083U_466283, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:428:10-13\n   #3  ftSkyline.fut:969:26-29\n   #4  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586515 = (int64_t) 8 * m_572919;
    int64_t binop_x_586523 = (int64_t) 4 * m_572919;
    int64_t bytes_586524 = dim_466278 * binop_x_586523;
    bool index_certs_572951;
    
    if (!y_572722) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_466279, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_572962;
    
    if (!assert_cond_572685) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586598 = (int64_t) 8 * total_part_no_466292;
    
    if (mem_586516_cached_sizze_588374 < bytes_586515) {
        err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588374, bytes_586515);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586516, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586498.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_572919});
    for (int64_t write_iter_586091 = 0; write_iter_586091 < dz2083U_466283; write_iter_586091++) {
        int64_t write_iv_586093 = ((int64_t *) mem_586502)[write_iter_586091];
        int64_t write_iv_586094 = ((int64_t *) mem_586500)[write_iter_586091];
        int64_t write_iv_586095 = ((int64_t *) ext_mem_586498.mem)[write_iter_586091];
        bool cond_582522 = write_iv_586093 == (int64_t) 1;
        int64_t lifted_lambda_res_582523;
        
        if (cond_582522) {
            int64_t lifted_lambda_res_t_res_583152 = sub64(write_iv_586094, (int64_t) 1);
            
            lifted_lambda_res_582523 = lifted_lambda_res_t_res_583152;
        } else {
            lifted_lambda_res_582523 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582523) && slt64(lifted_lambda_res_582523, m_572919)) {
            ((int64_t *) mem_586516)[lifted_lambda_res_582523] = write_iv_586095;
        }
    }
    if (memblock_unref(ctx, &ext_mem_586498, "ext_mem_586498") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_586525, bytes_586524, "mem_586525")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586527, bytes_586515, "mem_586527")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586101 = 0; i_586101 < m_572919; i_586101++) {
        int64_t eta_p_572944 = ((int64_t *) mem_586516)[i_586101];
        bool x_572945 = sle64((int64_t) 0, eta_p_572944);
        bool y_572946 = slt64(eta_p_572944, dz2083U_466283);
        bool bounds_check_572947 = x_572945 && y_572946;
        bool index_certs_572948;
        
        if (!bounds_check_572947) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_572944, "] out of bounds for array of shape [", (long long) dz2083U_466283, "].", "-> #0  ftSkyline.fut:408:53-63\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:408:42-64\n   #3  ftSkyline.fut:428:10-13\n   #4  ftSkyline.fut:969:26-29\n   #5  ftSkyline.fut:967:17-971:67\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_572950 = ((int64_t *) xys_mem_586420.mem)[eta_p_572944];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586525.mem, i_586101 * dim_466278, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, eta_p_572944 * dim_466278, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_466278});
        ((int64_t *) mem_586527.mem)[i_586101] = lifted_lambda_res_572950;
    }
    if (mem_586543_cached_sizze_588375 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586543, &mem_586543_cached_sizze_588375, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586106 = 0; i_586106 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280; i_586106++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572959 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586106];
        float i64_res_572960 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_572959);
        float defunc_0_fover_res_572961 = 1.5707964F / i64_res_572960;
        
        ((float *) mem_586543)[i_586106] = defunc_0_fover_res_572961;
    }
    if (mem_586551_cached_sizze_588376 < bytes_586421) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588376, bytes_586421);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586556_cached_sizze_588377 < bytes_586439) {
        err = lexical_realloc(ctx, &mem_586556, &mem_586556_cached_sizze_588377, bytes_586439);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586564_cached_sizze_588378 < bytes_586447) {
        err = lexical_realloc(ctx, &mem_586564, &mem_586564_cached_sizze_588378, bytes_586447);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586572_cached_sizze_588379 < bytes_586455) {
        err = lexical_realloc(ctx, &mem_586572, &mem_586572_cached_sizze_588379, bytes_586455);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586588_cached_sizze_588381 < bytes_586471) {
        err = lexical_realloc(ctx, &mem_586588, &mem_586588_cached_sizze_588381, bytes_586471);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586126 = 0; i_586126 < dz2083U_466283; i_586126++) {
        for (int64_t i_586110 = 0; i_586110 < dim_466278; i_586110++) {
            float eta_p_583092 = ((float *) xys_mem_586419.mem)[i_586126 * dim_466278 + i_586110];
            float eta_p_583093 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586110];
            float eta_p_583094 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586110];
            int64_t eta_p_583096 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586110];
            float defunc_0_f_res_583097 = eta_p_583092 - eta_p_583093;
            float defunc_0_f_res_583099 = defunc_0_f_res_583097 / eta_p_583094;
            int64_t f32_res_583101 = fptosi_f32_i64(defunc_0_f_res_583099);
            int64_t max_res_583103 = smax64((int64_t) 0, f32_res_583101);
            int64_t zm_lhs_583109 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586110];
            int64_t min_arg1_583110 = sub64(zm_lhs_583109, (int64_t) 1);
            int64_t min_res_583111 = smin64(max_res_583103, min_arg1_583110);
            int64_t defunc_0_f_res_583113 = mul64(eta_p_583096, min_res_583111);
            
            ((int64_t *) mem_586556)[i_586110] = defunc_0_f_res_583113;
        }
        
        int64_t defunc_0_foldl_res_572988;
        int64_t acc_572990 = (int64_t) 0;
        
        for (int64_t i_572989 = 0; i_572989 < dim_466278; i_572989++) {
            int64_t b_572991 = ((int64_t *) mem_586556)[i_572989];
            int64_t defunc_0_f_res_572992 = add64(acc_572990, b_572991);
            int64_t acc_tmp_588042 = defunc_0_f_res_572992;
            
            acc_572990 = acc_tmp_588042;
        }
        defunc_0_foldl_res_572988 = acc_572990;
        
        bool x_572993 = sle64((int64_t) 0, defunc_0_foldl_res_572988);
        bool y_572994 = slt64(defunc_0_foldl_res_572988, dz2080U_466279);
        bool bounds_check_572995 = x_572993 && y_572994;
        bool index_certs_572996;
        
        if (!bounds_check_572995) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_572988, "] out of bounds for array of shape [", (long long) dz2080U_466279, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586114 = 0; i_586114 < dim_466278; i_586114++) {
            float eta_p_572999 = ((float *) xys_mem_586419.mem)[i_586126 * dim_466278 + i_586114];
            float eta_p_573000 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_572988 * dim_466278 + i_586114];
            float defunc_0_f_res_573001 = eta_p_572999 - eta_p_573000;
            
            ((float *) mem_586564)[i_586114] = defunc_0_f_res_573001;
        }
        for (int64_t nest_i_588044 = 0; nest_i_588044 < arg_572684; nest_i_588044++) {
            ((float *) mem_586572)[nest_i_588044] = 0.0F;
        }
        for (int64_t i_573004 = 0; i_573004 < arg_572684; i_573004++) {
            bool y_573006 = slt64(i_573004, dim_466278);
            bool index_certs_573007;
            
            if (!y_573006) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_573004, "] out of bounds for array of shape [", (long long) dim_466278, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_573009 = add64((int64_t) 1, i_573004);
            int64_t j_m_i_573010 = sub64(dim_466278, map_arg1_573009);
            bool empty_slice_573011 = j_m_i_573010 == (int64_t) 0;
            int64_t m_573012 = sub64(j_m_i_573010, (int64_t) 1);
            int64_t i_p_m_t_s_573013 = add64(map_arg1_573009, m_573012);
            bool zzero_leq_i_p_m_t_s_573014 = sle64((int64_t) 0, i_p_m_t_s_573013);
            bool i_p_m_t_s_leq_w_573015 = slt64(i_p_m_t_s_573013, dim_466278);
            bool zzero_lte_i_573016 = sle64((int64_t) 0, map_arg1_573009);
            bool i_lte_j_573017 = sle64(map_arg1_573009, dim_466278);
            bool y_573018 = i_p_m_t_s_leq_w_573015 && zzero_lte_i_573016;
            bool y_573019 = zzero_leq_i_p_m_t_s_573014 && y_573018;
            bool forwards_ok_573020 = i_lte_j_573017 && y_573019;
            bool ok_or_empty_573021 = empty_slice_573011 || forwards_ok_573020;
            bool index_certs_573022;
            
            if (!ok_or_empty_573021) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_573009, ":", (long long) dim_466278, "] out of bounds for array of shape [", (long long) dim_466278, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:412:107-108\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:428:10-13\n   #5  ftSkyline.fut:969:26-29\n   #6  ftSkyline.fut:967:17-971:67\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586576 = (int64_t) 4 * j_m_i_573010;
            float this_x_573008 = ((float *) mem_586564)[i_573004];
            
            if (mem_586577_cached_sizze_588380 < bytes_586576) {
                err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588380, bytes_586576);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586118 = 0; i_586118 < j_m_i_573010; i_586118++) {
                int64_t slice_586364 = map_arg1_573009 + i_586118;
                float eta_p_573025 = ((float *) mem_586564)[slice_586364];
                float defunc_0_ftimes_res_573026 = eta_p_573025 * eta_p_573025;
                
                ((float *) mem_586577)[i_586118] = defunc_0_ftimes_res_573026;
            }
            
            float defunc_0_foldl_res_573027;
            float acc_573029 = 0.0F;
            
            for (int64_t i_573028 = 0; i_573028 < j_m_i_573010; i_573028++) {
                float b_573030 = ((float *) mem_586577)[i_573028];
                float defunc_0_f_res_573031 = acc_573029 + b_573030;
                float acc_tmp_588047 = defunc_0_f_res_573031;
                
                acc_573029 = acc_tmp_588047;
            }
            defunc_0_foldl_res_573027 = acc_573029;
            
            float sqrt_res_573032 = futrts_sqrt32(defunc_0_foldl_res_573027);
            float atan2_res_573033 = futrts_atan2_32(sqrt_res_573032, this_x_573008);
            
            ((float *) mem_586572)[i_573004] = atan2_res_573033;
        }
        for (int64_t i_586122 = 0; i_586122 < arg_572684; i_586122++) {
            float eta_p_573036 = ((float *) mem_586572)[i_586122];
            float eta_p_573037 = ((float *) mem_586543)[i_586122];
            int64_t eta_p_573038 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586122];
            int64_t eta_p_573039 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586122];
            float i64_res_573040 = sitofp_i64_f32(eta_p_573038);
            float defunc_0_fover_res_573041 = eta_p_573036 / eta_p_573037;
            float defunc_0_ftimes_res_573042 = i64_res_573040 * defunc_0_fover_res_573041;
            int64_t f32_res_573043 = fptosi_f32_i64(defunc_0_ftimes_res_573042);
            bool cond_573044 = slt64(f32_res_573043, (int64_t) 0);
            int64_t defunc_0_f_res_573045;
            
            if (cond_573044) {
                defunc_0_f_res_573045 = (int64_t) 0;
            } else {
                bool cond_573046 = sle64(eta_p_573039, f32_res_573043);
                int64_t defunc_0_f_res_f_res_573047;
                
                if (cond_573046) {
                    int64_t defunc_0_f_res_f_res_t_res_583155 = sub64(eta_p_573039, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_573047 = defunc_0_f_res_f_res_t_res_583155;
                } else {
                    defunc_0_f_res_f_res_573047 = f32_res_573043;
                }
                defunc_0_f_res_573045 = defunc_0_f_res_f_res_573047;
            }
            ((int64_t *) mem_586588)[i_586122] = defunc_0_f_res_573045;
        }
        
        int64_t defunc_0_foldl_res_573049;
        int64_t acc_573051 = (int64_t) 0;
        
        for (int64_t i_573050 = 0; i_573050 < arg_572684; i_573050++) {
            int64_t b_573052 = ((int64_t *) mem_586588)[i_573050];
            int64_t defunc_0_f_res_573053 = add64(acc_573051, b_573052);
            int64_t acc_tmp_588049 = defunc_0_f_res_573053;
            
            acc_573051 = acc_tmp_588049;
        }
        defunc_0_foldl_res_573049 = acc_573051;
        
        int64_t zp_lhs_573054 = mul64(total_angle_no_466290, defunc_0_foldl_res_572988);
        int64_t get_id_from_grid_angle_res_573055 = add64(defunc_0_foldl_res_573049, zp_lhs_573054);
        
        ((int64_t *) mem_586551)[i_586126] = get_id_from_grid_angle_res_573055;
    }
    if (mem_586599_cached_sizze_588382 < bytes_586598) {
        err = lexical_realloc(ctx, &mem_586599, &mem_586599_cached_sizze_588382, bytes_586598);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588050 = 0; nest_i_588050 < total_part_no_466292; nest_i_588050++) {
        ((int64_t *) mem_586599)[nest_i_588050] = (int64_t) 0;
    }
    for (int64_t iter_586128 = 0; iter_586128 < m_572919; iter_586128++) {
        int64_t pixel_586130 = ((int64_t *) mem_586516)[iter_586128];
        bool x_582512 = sle64((int64_t) 0, pixel_586130);
        bool y_582513 = slt64(pixel_586130, dz2083U_466283);
        bool bounds_check_582514 = x_582512 && y_582513;
        bool index_certs_582515;
        
        if (!bounds_check_582514) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) pixel_586130, "] out of bounds for array of shape [", (long long) dz2083U_466283, "].", "-> #0  ftSkyline.fut:413:51-62\n   #1  ftSkyline.fut:969:26-29\n   #2  ftSkyline.fut:967:17-971:67\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_582516 = ((int64_t *) mem_586551)[pixel_586130];
        bool less_than_zzero_586132 = slt64(lifted_lambda_res_582516, (int64_t) 0);
        bool greater_than_sizze_586133 = sle64(total_part_no_466292, lifted_lambda_res_582516);
        bool outside_bounds_dim_586134 = less_than_zzero_586132 || greater_than_sizze_586133;
        
        if (!outside_bounds_dim_586134) {
            int64_t read_hist_586136 = ((int64_t *) mem_586599)[lifted_lambda_res_582516];
            int64_t defunc_0_op_res_573067 = add64((int64_t) 1, read_hist_586136);
            
            ((int64_t *) mem_586599)[lifted_lambda_res_582516] = defunc_0_op_res_573067;
        }
    }
    if (mem_586607_cached_sizze_588383 < bytes_586598) {
        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_588383, bytes_586598);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586144;
    int64_t scanacc_586140 = (int64_t) 0;
    
    for (int64_t i_586142 = 0; i_586142 < total_part_no_466292; i_586142++) {
        int64_t x_573071 = ((int64_t *) mem_586599)[i_586142];
        int64_t defunc_0_op_res_573074 = add64(x_573071, scanacc_586140);
        
        ((int64_t *) mem_586607)[i_586142] = defunc_0_op_res_573074;
        
        int64_t scanacc_tmp_588052 = defunc_0_op_res_573074;
        
        scanacc_586140 = scanacc_tmp_588052;
    }
    discard_586144 = scanacc_586140;
    if (memblock_alloc(ctx, &mem_586615, bytes_586598, "mem_586615")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586147 = 0; i_586147 < total_part_no_466292; i_586147++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586147);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_466292);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586607)[tmp_582504];
        bool cond_582507 = i_586147 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586615.mem)[i_586147] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &isPartitionDominated_mem_586417, "isPartitionDominated_mem_586417") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586615, "mem_586615") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586525, "mem_586525") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586527, "mem_586527") != 0)
        return 1;
    prim_out_588011 = total_part_no_466292;
    prim_out_588012 = m_572919;
    if (memblock_set(ctx, &*mem_out_p_588358, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588359, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588360, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588361, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588362 = prim_out_588011;
    *out_prim_out_588363 = prim_out_588012;
    
  cleanup:
    {
        free(mem_586427);
        free(mem_586440);
        free(mem_586448);
        free(mem_586456);
        free(mem_586461);
        free(mem_586472);
        free(mem_586479);
        free(mem_586486);
        free(mem_586500);
        free(mem_586502);
        free(mem_586516);
        free(mem_586543);
        free(mem_586551);
        free(mem_586556);
        free(mem_586564);
        free(mem_586572);
        free(mem_586577);
        free(mem_586588);
        free(mem_586599);
        free(mem_586607);
        if (memblock_unref(ctx, &mem_586615, "mem_586615") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586527, "mem_586527") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586525, "mem_586525") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588016, "mem_param_tmp_588016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586435, "mem_586435") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586425, "mem_param_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586498, "ext_mem_586498") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586422, "mem_586422") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_crack_Skyline_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_588384, struct memblock *mem_out_p_588385, int64_t *out_prim_out_588386, struct memblock isPartitionDominated_mem_586411, struct memblock part_idx_mem_586412, struct memblock xys_mem_586413, struct memblock xys_mem_586414, int64_t dim_396692, int64_t dz2081U_396693, int64_t dz2082U_396694, int64_t dz2083U_396695)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_586419;
    
    mem_586419.references = NULL;
    
    struct memblock mem_586417;
    
    mem_586417.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588009;
    int64_t binop_x_586415 = (int64_t) 8 * dz2083U_396695;
    int64_t bytes_586416 = dim_396692 * binop_x_586415;
    
    if (memblock_alloc(ctx, &mem_586417, bytes_586416, "mem_586417")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 2, (uint64_t *) mem_586417.mem, (int64_t) 0, (int64_t []) {dim_396692, (int64_t) 1}, (uint64_t *) xys_mem_586413.mem, (int64_t) 0, (int64_t []) {dim_396692, (int64_t) 1}, (int64_t []) {dz2083U_396695, dim_396692});
    if (memblock_alloc(ctx, &mem_586419, binop_x_586415, "mem_586419")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586419.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586414.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2083U_396695});
    if (memblock_set(ctx, &mem_out_588007, &mem_586419, "mem_586419") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586417, "mem_586417") != 0)
        return 1;
    prim_out_588009 = dz2083U_396695;
    if (memblock_set(ctx, &*mem_out_p_588384, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588385, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    *out_prim_out_588386 = prim_out_588009;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586417, "mem_586417") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_crack_Skyline_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_588387, struct memblock *mem_out_p_588388, int64_t *out_prim_out_588389, struct memblock isPartitionDominated_mem_586411, struct memblock part_idx_mem_586412, struct memblock xys_mem_586413, struct memblock xys_mem_586414, int64_t dim_560438, int64_t dz2081U_560439, int64_t dz2082U_560440, int64_t dz2083U_560441)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_586419;
    
    mem_586419.references = NULL;
    
    struct memblock mem_586417;
    
    mem_586417.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588009;
    int64_t binop_x_586415 = (int64_t) 4 * dz2083U_560441;
    int64_t bytes_586416 = dim_560438 * binop_x_586415;
    int64_t bytes_586418 = (int64_t) 8 * dz2083U_560441;
    
    if (memblock_alloc(ctx, &mem_586417, bytes_586416, "mem_586417")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 2, (uint32_t *) mem_586417.mem, (int64_t) 0, (int64_t []) {dim_560438, (int64_t) 1}, (uint32_t *) xys_mem_586413.mem, (int64_t) 0, (int64_t []) {dim_560438, (int64_t) 1}, (int64_t []) {dz2083U_560441, dim_560438});
    if (memblock_alloc(ctx, &mem_586419, bytes_586418, "mem_586419")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586419.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586414.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dz2083U_560441});
    if (memblock_set(ctx, &mem_out_588007, &mem_586419, "mem_586419") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586417, "mem_586417") != 0)
        return 1;
    prim_out_588009 = dz2083U_560441;
    if (memblock_set(ctx, &*mem_out_p_588387, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588388, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    *out_prim_out_588389 = prim_out_588009;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586417, "mem_586417") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_define_skyline_space_double(struct futhark_context *ctx, struct memblock *mem_out_p_588390, struct memblock *mem_out_p_588391, struct memblock *mem_out_p_588392, struct memblock *mem_out_p_588393, struct memblock *mem_out_p_588394, struct memblock *mem_out_p_588395, int64_t *out_prim_out_588396, int64_t *out_prim_out_588397, int64_t *out_prim_out_588398, int64_t *out_prim_out_588399, struct memblock min_per_dim_mem_586411, struct memblock max_per_dim_mem_586412, struct memblock grid_partitions_per_dim_mem_586413, struct memblock angle_partitions_per_dim_mem_586414, int64_t dim_233135, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586416_cached_sizze_588400 = 0;
    unsigned char *mem_586416 = NULL;
    int64_t mem_586432_cached_sizze_588401 = 0;
    unsigned char *mem_586432 = NULL;
    struct memblock mem_586457;
    
    mem_586457.references = NULL;
    
    struct memblock mem_586448;
    
    mem_586448.references = NULL;
    
    struct memblock mem_586440;
    
    mem_586440.references = NULL;
    
    struct memblock mem_586418;
    
    mem_586418.references = NULL;
    
    struct memblock mem_out_588012;
    
    mem_out_588012.references = NULL;
    
    struct memblock mem_out_588011;
    
    mem_out_588011.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588013;
    int64_t prim_out_588014;
    int64_t prim_out_588015;
    int64_t prim_out_588016;
    int64_t arg_569858 = sub64(dim_233135, (int64_t) 1);
    bool assert_cond_569859 = arg_569858 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136;
    bool assert_c_569860;
    
    if (!assert_cond_569859) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:766:17-777:57\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586415 = (int64_t) 8 * dim_233135;
    
    if (mem_586416_cached_sizze_588400 < bytes_586415) {
        err = lexical_realloc(ctx, &mem_586416, &mem_586416_cached_sizze_588400, bytes_586415);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586418, bytes_586415, "mem_586418")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t discard_586057;
    int64_t defunc_res_582555;
    int64_t scanacc_586050;
    int64_t redout_586052;
    
    scanacc_586050 = (int64_t) 1;
    redout_586052 = (int64_t) 1;
    for (int64_t i_586054 = 0; i_586054 < dim_233135; i_586054++) {
        int64_t x_582538 = ((int64_t *) grid_partitions_per_dim_mem_586413.mem)[i_586054];
        double eta_p_582539 = ((double *) min_per_dim_mem_586411.mem)[i_586054];
        double eta_p_582540 = ((double *) max_per_dim_mem_586412.mem)[i_586054];
        double i64_res_582543 = sitofp_i64_f64(x_582538);
        double defunc_0_minus_res_582545 = eta_p_582540 - eta_p_582539;
        double defunc_0_over_res_582546 = defunc_0_minus_res_582545 / i64_res_582543;
        int64_t defunc_0_op_res_569877 = mul64(x_582538, scanacc_586050);
        int64_t zt_res_582440 = mul64(x_582538, redout_586052);
        
        ((int64_t *) mem_586416)[i_586054] = defunc_0_op_res_569877;
        ((double *) mem_586418.mem)[i_586054] = defunc_0_over_res_582546;
        
        int64_t scanacc_tmp_588017 = defunc_0_op_res_569877;
        int64_t redout_tmp_588019 = zt_res_582440;
        
        scanacc_586050 = scanacc_tmp_588017;
        redout_586052 = redout_tmp_588019;
    }
    discard_586057 = scanacc_586050;
    defunc_res_582555 = redout_586052;
    
    int64_t bytes_586431 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136;
    bool bounds_invalid_upwards_569905 = slt64(defunc_res_582555, (int64_t) 0);
    bool valid_569906 = !bounds_invalid_upwards_569905;
    bool range_valid_c_569907;
    
    if (!valid_569906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_res_582555, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:68:29-47\n   #2  ftSkyline.fut:107:90-114\n   #3  ftSkyline.fut:777:33-57\n   #4  ftSkyline.fut:766:17-777:57\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586455 = (int64_t) 8 * defunc_res_582555;
    int64_t bytes_586456 = dim_233135 * binop_x_586455;
    
    if (mem_586432_cached_sizze_588401 < bytes_586431) {
        err = lexical_realloc(ctx, &mem_586432, &mem_586432_cached_sizze_588401, bytes_586431);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586064;
    int64_t defunc_res_582558;
    int64_t scanacc_586059;
    int64_t redout_586061;
    
    scanacc_586059 = (int64_t) 1;
    redout_586061 = (int64_t) 1;
    for (int64_t i_586062 = 0; i_586062 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136; i_586062++) {
        int64_t x_582550 = ((int64_t *) angle_partitions_per_dim_mem_586414.mem)[i_586062];
        int64_t defunc_0_op_res_569893 = mul64(x_582550, scanacc_586059);
        int64_t zt_res_582447 = mul64(x_582550, redout_586061);
        
        ((int64_t *) mem_586432)[i_586062] = defunc_0_op_res_569893;
        
        int64_t scanacc_tmp_588021 = defunc_0_op_res_569893;
        int64_t redout_tmp_588023 = zt_res_582447;
        
        scanacc_586059 = scanacc_tmp_588021;
        redout_586061 = redout_tmp_588023;
    }
    discard_586064 = scanacc_586059;
    defunc_res_582558 = redout_586061;
    
    int64_t total_part_no_569872 = mul64(defunc_res_582555, defunc_res_582558);
    
    if (memblock_alloc(ctx, &mem_586440, bytes_586415, "mem_586440")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586067 = 0; i_586067 < dim_233135; i_586067++) {
        int64_t zv_lhs_582512 = add64((int64_t) -1, i_586067);
        int64_t tmp_582513 = smod64(zv_lhs_582512, dim_233135);
        int64_t lifted_lambda_res_582514 = ((int64_t *) mem_586416)[tmp_582513];
        bool cond_582516 = i_586067 == (int64_t) 0;
        int64_t lifted_lambda_res_582517;
        
        if (cond_582516) {
            lifted_lambda_res_582517 = (int64_t) 1;
        } else {
            lifted_lambda_res_582517 = lifted_lambda_res_582514;
        }
        ((int64_t *) mem_586440.mem)[i_586067] = lifted_lambda_res_582517;
    }
    if (memblock_alloc(ctx, &mem_586448, bytes_586431, "mem_586448")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586071 = 0; i_586071 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136; i_586071++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586071);
        int64_t tmp_582504 = smod64(zv_lhs_582503, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586432)[tmp_582504];
        bool cond_582507 = i_586071 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 1;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586448.mem)[i_586071] = lifted_lambda_res_582508;
    }
    if (memblock_alloc(ctx, &mem_586457, bytes_586456, "mem_586457")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586079 = 0; i_586079 < defunc_res_582555; i_586079++) {
        for (int64_t i_586075 = 0; i_586075 < dim_233135; i_586075++) {
            int64_t perDim_569917 = ((int64_t *) grid_partitions_per_dim_mem_586413.mem)[i_586075];
            int64_t preDim_569918 = ((int64_t *) mem_586440.mem)[i_586075];
            bool zzero_569919 = preDim_569918 == (int64_t) 0;
            bool nonzzero_569920 = !zzero_569919;
            bool nonzzero_cert_569921;
            
            if (!nonzzero_569920) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:74:78-86\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:71:36-76:34\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:69:20-77:18\n   #5  ftSkyline.fut:107:90-114\n   #6  ftSkyline.fut:777:33-57\n   #7  ftSkyline.fut:766:17-777:57\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_569923 = perDim_569917 == (int64_t) 0;
            bool nonzzero_569924 = !zzero_569923;
            bool nonzzero_cert_569925;
            
            if (!nonzzero_569924) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:74:87-94\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:71:36-76:34\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:69:20-77:18\n   #5  ftSkyline.fut:107:90-114\n   #6  ftSkyline.fut:777:33-57\n   #7  ftSkyline.fut:766:17-777:57\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zv_lhs_569922 = sdiv64(i_586079, preDim_569918);
            int64_t dzlz7bUskOpzifrom_i64z7dUzg_arg0_569926 = smod64(zv_lhs_569922, perDim_569917);
            double i64_res_569927 = sitofp_i64_f64(dzlz7bUskOpzifrom_i64z7dUzg_arg0_569926);
            double dzlz7bUZLskOpzitimesZRz7dUzg_arg1_569928 = ((double *) mem_586418.mem)[i_586075];
            double defunc_0_times_res_569929 = i64_res_569927 * dzlz7bUZLskOpzitimesZRz7dUzg_arg1_569928;
            double dzlz7bUZLskOpziplusZRz7dUzg_arg0_569930 = ((double *) min_per_dim_mem_586411.mem)[i_586075];
            double defunc_0_plus_res_569931 = defunc_0_times_res_569929 + dzlz7bUZLskOpziplusZRz7dUzg_arg0_569930;
            
            ((double *) mem_586457.mem)[i_586079 * dim_233135 + i_586075] = defunc_0_plus_res_569931;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586448, "mem_586448") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &angle_partitions_per_dim_mem_586414, "angle_partitions_per_dim_mem_586414") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586440, "mem_586440") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586418, "mem_586418") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588011, &grid_partitions_per_dim_mem_586413, "grid_partitions_per_dim_mem_586413") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588012, &mem_586457, "mem_586457") != 0)
        return 1;
    prim_out_588013 = defunc_res_582555;
    prim_out_588014 = defunc_res_582558;
    prim_out_588015 = defunc_res_582555;
    prim_out_588016 = total_part_no_569872;
    if (memblock_set(ctx, &*mem_out_p_588390, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588391, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588392, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588393, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588394, &mem_out_588011, "mem_out_588011") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588395, &mem_out_588012, "mem_out_588012") != 0)
        return 1;
    *out_prim_out_588396 = prim_out_588013;
    *out_prim_out_588397 = prim_out_588014;
    *out_prim_out_588398 = prim_out_588015;
    *out_prim_out_588399 = prim_out_588016;
    
  cleanup:
    {
        free(mem_586416);
        free(mem_586432);
        if (memblock_unref(ctx, &mem_586457, "mem_586457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586448, "mem_586448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586440, "mem_586440") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586418, "mem_586418") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588012, "mem_out_588012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588011, "mem_out_588011") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_define_skyline_space_float(struct futhark_context *ctx, struct memblock *mem_out_p_588402, struct memblock *mem_out_p_588403, struct memblock *mem_out_p_588404, struct memblock *mem_out_p_588405, struct memblock *mem_out_p_588406, struct memblock *mem_out_p_588407, int64_t *out_prim_out_588408, int64_t *out_prim_out_588409, int64_t *out_prim_out_588410, int64_t *out_prim_out_588411, struct memblock min_per_dim_mem_586411, struct memblock max_per_dim_mem_586412, struct memblock grid_partitions_per_dim_mem_586413, struct memblock angle_partitions_per_dim_mem_586414, int64_t dim_397793, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586416_cached_sizze_588412 = 0;
    unsigned char *mem_586416 = NULL;
    int64_t mem_586432_cached_sizze_588413 = 0;
    unsigned char *mem_586432 = NULL;
    struct memblock mem_586457;
    
    mem_586457.references = NULL;
    
    struct memblock mem_586448;
    
    mem_586448.references = NULL;
    
    struct memblock mem_586440;
    
    mem_586440.references = NULL;
    
    struct memblock mem_586418;
    
    mem_586418.references = NULL;
    
    struct memblock mem_out_588012;
    
    mem_out_588012.references = NULL;
    
    struct memblock mem_out_588011;
    
    mem_out_588011.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588013;
    int64_t prim_out_588014;
    int64_t prim_out_588015;
    int64_t prim_out_588016;
    int64_t arg_569858 = sub64(dim_397793, (int64_t) 1);
    bool assert_cond_569859 = arg_569858 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794;
    bool assert_c_569860;
    
    if (!assert_cond_569859) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:913:17-924:57\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586415 = (int64_t) 8 * dim_397793;
    
    if (mem_586416_cached_sizze_588412 < bytes_586415) {
        err = lexical_realloc(ctx, &mem_586416, &mem_586416_cached_sizze_588412, bytes_586415);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_586417 = (int64_t) 4 * dim_397793;
    
    if (memblock_alloc(ctx, &mem_586418, bytes_586417, "mem_586418")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t discard_586057;
    int64_t defunc_res_582555;
    int64_t scanacc_586050;
    int64_t redout_586052;
    
    scanacc_586050 = (int64_t) 1;
    redout_586052 = (int64_t) 1;
    for (int64_t i_586054 = 0; i_586054 < dim_397793; i_586054++) {
        int64_t x_582538 = ((int64_t *) grid_partitions_per_dim_mem_586413.mem)[i_586054];
        float eta_p_582539 = ((float *) min_per_dim_mem_586411.mem)[i_586054];
        float eta_p_582540 = ((float *) max_per_dim_mem_586412.mem)[i_586054];
        float i64_res_582543 = sitofp_i64_f32(x_582538);
        float defunc_0_minus_res_582545 = eta_p_582540 - eta_p_582539;
        float defunc_0_over_res_582546 = defunc_0_minus_res_582545 / i64_res_582543;
        int64_t defunc_0_op_res_569877 = mul64(x_582538, scanacc_586050);
        int64_t zt_res_582440 = mul64(x_582538, redout_586052);
        
        ((int64_t *) mem_586416)[i_586054] = defunc_0_op_res_569877;
        ((float *) mem_586418.mem)[i_586054] = defunc_0_over_res_582546;
        
        int64_t scanacc_tmp_588017 = defunc_0_op_res_569877;
        int64_t redout_tmp_588019 = zt_res_582440;
        
        scanacc_586050 = scanacc_tmp_588017;
        redout_586052 = redout_tmp_588019;
    }
    discard_586057 = scanacc_586050;
    defunc_res_582555 = redout_586052;
    
    int64_t bytes_586431 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794;
    bool bounds_invalid_upwards_569905 = slt64(defunc_res_582555, (int64_t) 0);
    bool valid_569906 = !bounds_invalid_upwards_569905;
    bool range_valid_c_569907;
    
    if (!valid_569906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) defunc_res_582555, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:68:29-47\n   #2  ftSkyline.fut:107:90-114\n   #3  ftSkyline.fut:924:33-57\n   #4  ftSkyline.fut:913:17-924:57\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586455 = (int64_t) 4 * defunc_res_582555;
    int64_t bytes_586456 = dim_397793 * binop_x_586455;
    
    if (mem_586432_cached_sizze_588413 < bytes_586431) {
        err = lexical_realloc(ctx, &mem_586432, &mem_586432_cached_sizze_588413, bytes_586431);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586064;
    int64_t defunc_res_582558;
    int64_t scanacc_586059;
    int64_t redout_586061;
    
    scanacc_586059 = (int64_t) 1;
    redout_586061 = (int64_t) 1;
    for (int64_t i_586062 = 0; i_586062 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794; i_586062++) {
        int64_t x_582550 = ((int64_t *) angle_partitions_per_dim_mem_586414.mem)[i_586062];
        int64_t defunc_0_op_res_569893 = mul64(x_582550, scanacc_586059);
        int64_t zt_res_582447 = mul64(x_582550, redout_586061);
        
        ((int64_t *) mem_586432)[i_586062] = defunc_0_op_res_569893;
        
        int64_t scanacc_tmp_588021 = defunc_0_op_res_569893;
        int64_t redout_tmp_588023 = zt_res_582447;
        
        scanacc_586059 = scanacc_tmp_588021;
        redout_586061 = redout_tmp_588023;
    }
    discard_586064 = scanacc_586059;
    defunc_res_582558 = redout_586061;
    
    int64_t total_part_no_569872 = mul64(defunc_res_582555, defunc_res_582558);
    
    if (memblock_alloc(ctx, &mem_586440, bytes_586415, "mem_586440")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586067 = 0; i_586067 < dim_397793; i_586067++) {
        int64_t zv_lhs_582512 = add64((int64_t) -1, i_586067);
        int64_t tmp_582513 = smod64(zv_lhs_582512, dim_397793);
        int64_t lifted_lambda_res_582514 = ((int64_t *) mem_586416)[tmp_582513];
        bool cond_582516 = i_586067 == (int64_t) 0;
        int64_t lifted_lambda_res_582517;
        
        if (cond_582516) {
            lifted_lambda_res_582517 = (int64_t) 1;
        } else {
            lifted_lambda_res_582517 = lifted_lambda_res_582514;
        }
        ((int64_t *) mem_586440.mem)[i_586067] = lifted_lambda_res_582517;
    }
    if (memblock_alloc(ctx, &mem_586448, bytes_586431, "mem_586448")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586071 = 0; i_586071 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794; i_586071++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586071);
        int64_t tmp_582504 = smod64(zv_lhs_582503, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_586432)[tmp_582504];
        bool cond_582507 = i_586071 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 1;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_586448.mem)[i_586071] = lifted_lambda_res_582508;
    }
    if (memblock_alloc(ctx, &mem_586457, bytes_586456, "mem_586457")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586079 = 0; i_586079 < defunc_res_582555; i_586079++) {
        for (int64_t i_586075 = 0; i_586075 < dim_397793; i_586075++) {
            int64_t perDim_569917 = ((int64_t *) grid_partitions_per_dim_mem_586413.mem)[i_586075];
            int64_t preDim_569918 = ((int64_t *) mem_586440.mem)[i_586075];
            bool zzero_569919 = preDim_569918 == (int64_t) 0;
            bool nonzzero_569920 = !zzero_569919;
            bool nonzzero_cert_569921;
            
            if (!nonzzero_569920) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:74:78-86\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:71:36-76:34\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:69:20-77:18\n   #5  ftSkyline.fut:107:90-114\n   #6  ftSkyline.fut:924:33-57\n   #7  ftSkyline.fut:913:17-924:57\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_569923 = perDim_569917 == (int64_t) 0;
            bool nonzzero_569924 = !zzero_569923;
            bool nonzzero_cert_569925;
            
            if (!nonzzero_569924) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:74:87-94\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:71:36-76:34\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:69:20-77:18\n   #5  ftSkyline.fut:107:90-114\n   #6  ftSkyline.fut:924:33-57\n   #7  ftSkyline.fut:913:17-924:57\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zv_lhs_569922 = sdiv64(i_586079, preDim_569918);
            int64_t dzlz7bUskOpzifrom_i64z7dUzg_arg0_569926 = smod64(zv_lhs_569922, perDim_569917);
            float i64_res_569927 = sitofp_i64_f32(dzlz7bUskOpzifrom_i64z7dUzg_arg0_569926);
            float dzlz7bUZLskOpzitimesZRz7dUzg_arg1_569928 = ((float *) mem_586418.mem)[i_586075];
            float defunc_0_times_res_569929 = i64_res_569927 * dzlz7bUZLskOpzitimesZRz7dUzg_arg1_569928;
            float dzlz7bUZLskOpziplusZRz7dUzg_arg0_569930 = ((float *) min_per_dim_mem_586411.mem)[i_586075];
            float defunc_0_plus_res_569931 = defunc_0_times_res_569929 + dzlz7bUZLskOpziplusZRz7dUzg_arg0_569930;
            
            ((float *) mem_586457.mem)[i_586079 * dim_397793 + i_586075] = defunc_0_plus_res_569931;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586448, "mem_586448") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &angle_partitions_per_dim_mem_586414, "angle_partitions_per_dim_mem_586414") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586440, "mem_586440") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586418, "mem_586418") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588011, &grid_partitions_per_dim_mem_586413, "grid_partitions_per_dim_mem_586413") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588012, &mem_586457, "mem_586457") != 0)
        return 1;
    prim_out_588013 = defunc_res_582555;
    prim_out_588014 = defunc_res_582558;
    prim_out_588015 = defunc_res_582555;
    prim_out_588016 = total_part_no_569872;
    if (memblock_set(ctx, &*mem_out_p_588402, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588403, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588404, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588405, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588406, &mem_out_588011, "mem_out_588011") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588407, &mem_out_588012, "mem_out_588012") != 0)
        return 1;
    *out_prim_out_588408 = prim_out_588013;
    *out_prim_out_588409 = prim_out_588014;
    *out_prim_out_588410 = prim_out_588015;
    *out_prim_out_588411 = prim_out_588016;
    
  cleanup:
    {
        free(mem_586416);
        free(mem_586432);
        if (memblock_unref(ctx, &mem_586457, "mem_586457") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586448, "mem_586448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586440, "mem_586440") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586418, "mem_586418") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588012, "mem_out_588012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588011, "mem_out_588011") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_2_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588414, struct memblock *mem_out_p_588415, struct memblock *mem_out_p_588416, struct memblock *mem_out_p_588417, int64_t *out_prim_out_588418, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, int64_t dim_386746, int64_t dz2080U_386747, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748, int64_t dz2083U_386749, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_386750, int64_t dzlz7bUskBzitotal_part_noz7dUzg_386751, int64_t dz2083U_386752, int64_t total_angle_no_386759, int64_t total_grid_no_386760, int64_t total_part_no_386761)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586441_cached_sizze_588419 = 0;
    unsigned char *mem_586441 = NULL;
    int64_t mem_586443_cached_sizze_588420 = 0;
    unsigned char *mem_586443 = NULL;
    int64_t mem_586469_cached_sizze_588421 = 0;
    unsigned char *mem_586469 = NULL;
    int64_t mem_586471_cached_sizze_588422 = 0;
    unsigned char *mem_586471 = NULL;
    int64_t mem_586479_cached_sizze_588423 = 0;
    unsigned char *mem_586479 = NULL;
    int64_t mem_586487_cached_sizze_588424 = 0;
    unsigned char *mem_586487 = NULL;
    int64_t mem_586492_cached_sizze_588425 = 0;
    unsigned char *mem_586492 = NULL;
    int64_t mem_586503_cached_sizze_588426 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586525_cached_sizze_588427 = 0;
    unsigned char *mem_586525 = NULL;
    int64_t mem_586527_cached_sizze_588428 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586535_cached_sizze_588429 = 0;
    unsigned char *mem_586535 = NULL;
    int64_t mem_586543_cached_sizze_588430 = 0;
    unsigned char *mem_586543 = NULL;
    int64_t mem_586548_cached_sizze_588431 = 0;
    unsigned char *mem_586548 = NULL;
    int64_t mem_586559_cached_sizze_588432 = 0;
    unsigned char *mem_586559 = NULL;
    struct memblock mem_586460;
    
    mem_586460.references = NULL;
    
    struct memblock mem_586458;
    
    mem_586458.references = NULL;
    
    struct memblock mem_586433;
    
    mem_586433.references = NULL;
    
    struct memblock mem_586425;
    
    mem_586425.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_574118 = sub64(dim_386746, (int64_t) 1);
    bool assert_cond_t_res_574119 = arg_574118 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748;
    bool assert_c_574120;
    
    if (!assert_cond_t_res_574119) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_574124 = dzlz7bUskBzitotal_grid_noz7dUzg_386750 == total_grid_no_386760;
    bool empty_or_match_cert_574125;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:570:13-21\n   #1  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_574127 = dzlz7bUskBzitotal_part_noz7dUzg_386751 == total_part_no_386761;
    bool empty_or_match_cert_574128;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:570:13-21\n   #1  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574133;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:569:50-60\n   #2  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574136;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:569:50-60\n   #2  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574139;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:569:50-60\n   #3  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574141;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:569:50-60\n   #3  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586432 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_386751;
    int64_t zp_lhs_574158 = add64(dz2083U_386749, dz2083U_386752);
    bool dim_match_574160 = total_part_no_386761 == dzlz7bUskBzitotal_part_noz7dUzg_386751;
    bool empty_or_match_cert_574161;
    
    if (!dim_match_574160) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:565:57-67\n   #3  ftSkyline.fut:569:50-60\n   #4  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_574162 = slt64((int64_t) 0, dz2080U_386747);
    bool index_certs_574163;
    
    if (!y_574162) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_386747, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586440 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748;
    bool empty_or_match_cert_574178;
    
    if (!assert_cond_t_res_574119) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586456 = (int64_t) 8 * zp_lhs_574158;
    int64_t bytes_586457 = dim_386746 * binop_x_586456;
    int64_t bytes_586468 = (int64_t) 8 * dim_386746;
    int64_t bytes_586486 = (int64_t) 8 * arg_574118;
    
    if (memblock_alloc(ctx, &mem_586425, dzlz7bUskBzitotal_grid_noz7dUzg_386750, "mem_586425")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_386750; i_586050++) {
        bool eta_p_574143 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_574144 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool cond_574147 = eta_p_574143 || eta_p_574144;
        
        ((bool *) mem_586425.mem)[i_586050] = cond_574147;
    }
    if (memblock_alloc(ctx, &mem_586433, bytes_586432, "mem_586433")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_386751; i_586054++) {
        int64_t eta_p_574151 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_574152 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t zp_lhs_574155 = add64(eta_p_574151, eta_p_574152);
        
        ((int64_t *) mem_586433.mem)[i_586054] = zp_lhs_574155;
    }
    if (mem_586441_cached_sizze_588419 < bytes_586440) {
        err = lexical_realloc(ctx, &mem_586441, &mem_586441_cached_sizze_588419, bytes_586440);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586443_cached_sizze_588420 < bytes_586440) {
        err = lexical_realloc(ctx, &mem_586443, &mem_586443_cached_sizze_588420, bytes_586440);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586060 = 0; i_586060 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748; i_586060++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582760 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586060];
        double i64_res_582761 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582760);
        double defunc_0_fover_res_582762 = 1.5707963267948966 / i64_res_582761;
        
        ((double *) mem_586441)[i_586060] = defunc_0_fover_res_582762;
        ((double *) mem_586443)[i_586060] = defunc_0_fover_res_582762;
    }
    if (memblock_alloc(ctx, &mem_586458, bytes_586457, "mem_586458")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588016 = 0; nest_i_588016 < zp_lhs_574158; nest_i_588016++) {
        for (int64_t nest_i_588017 = 0; nest_i_588017 < dim_386746; nest_i_588017++) {
            ((double *) mem_586458.mem)[nest_i_588016 * dim_386746 + nest_i_588017] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586460, binop_x_586456, "mem_586460")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588018 = 0; nest_i_588018 < zp_lhs_574158; nest_i_588018++) {
        ((int64_t *) mem_586460.mem)[nest_i_588018] = (int64_t) -1;
    }
    if (mem_586469_cached_sizze_588421 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586469, &mem_586469_cached_sizze_588421, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586471_cached_sizze_588422 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586471, &mem_586471_cached_sizze_588422, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586479_cached_sizze_588423 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586479, &mem_586479_cached_sizze_588423, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586487_cached_sizze_588424 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586487, &mem_586487_cached_sizze_588424, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586503_cached_sizze_588426 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588426, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586079 = 0; write_iter_586079 < dz2083U_386749; write_iter_586079++) {
        for (int64_t i_586065 = 0; i_586065 < dim_386746; i_586065++) {
            double eta_p_582837 = ((double *) xys_mem_586419.mem)[write_iter_586079 * dim_386746 + i_586065];
            double eta_p_582838 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586065];
            double eta_p_582839 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586065];
            int64_t eta_p_582841 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586065];
            double defunc_0_f_res_582842 = eta_p_582837 - eta_p_582838;
            double defunc_0_f_res_582844 = defunc_0_f_res_582842 / eta_p_582839;
            int64_t f64_res_582846 = fptosi_f64_i64(defunc_0_f_res_582844);
            int64_t max_res_582848 = smax64((int64_t) 0, f64_res_582846);
            int64_t zm_lhs_582854 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586065];
            int64_t min_arg1_582855 = sub64(zm_lhs_582854, (int64_t) 1);
            int64_t min_res_582856 = smin64(max_res_582848, min_arg1_582855);
            int64_t defunc_0_f_res_582858 = mul64(eta_p_582841, min_res_582856);
            
            ((int64_t *) mem_586471)[i_586065] = defunc_0_f_res_582858;
        }
        
        int64_t defunc_0_foldl_res_582673;
        int64_t acc_582675 = (int64_t) 0;
        
        for (int64_t i_582674 = 0; i_582674 < dim_386746; i_582674++) {
            int64_t b_582676 = ((int64_t *) mem_586471)[i_582674];
            int64_t defunc_0_f_res_582677 = add64(acc_582675, b_582676);
            int64_t acc_tmp_588022 = defunc_0_f_res_582677;
            
            acc_582675 = acc_tmp_588022;
        }
        defunc_0_foldl_res_582673 = acc_582675;
        
        bool x_582678 = sle64((int64_t) 0, defunc_0_foldl_res_582673);
        bool y_582679 = slt64(defunc_0_foldl_res_582673, dz2080U_386747);
        bool bounds_check_582680 = x_582678 && y_582679;
        bool index_certs_582681;
        
        if (!bounds_check_582680) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582673, "] out of bounds for array of shape [", (long long) dz2080U_386747, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586069 = 0; i_586069 < dim_386746; i_586069++) {
            double eta_p_582684 = ((double *) xys_mem_586419.mem)[write_iter_586079 * dim_386746 + i_586069];
            double eta_p_582685 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582673 * dim_386746 + i_586069];
            double defunc_0_f_res_582686 = eta_p_582684 - eta_p_582685;
            
            ((double *) mem_586479)[i_586069] = defunc_0_f_res_582686;
        }
        for (int64_t nest_i_588024 = 0; nest_i_588024 < arg_574118; nest_i_588024++) {
            ((double *) mem_586487)[nest_i_588024] = 0.0;
        }
        for (int64_t i_582689 = 0; i_582689 < arg_574118; i_582689++) {
            bool y_582691 = slt64(i_582689, dim_386746);
            bool index_certs_582692;
            
            if (!y_582691) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582689, "] out of bounds for array of shape [", (long long) dim_386746, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582694 = add64((int64_t) 1, i_582689);
            int64_t j_m_i_582695 = sub64(dim_386746, map_arg1_582694);
            bool empty_slice_582696 = j_m_i_582695 == (int64_t) 0;
            int64_t m_582697 = sub64(j_m_i_582695, (int64_t) 1);
            int64_t i_p_m_t_s_582698 = add64(map_arg1_582694, m_582697);
            bool zzero_leq_i_p_m_t_s_582699 = sle64((int64_t) 0, i_p_m_t_s_582698);
            bool i_p_m_t_s_leq_w_582700 = slt64(i_p_m_t_s_582698, dim_386746);
            bool zzero_lte_i_582701 = sle64((int64_t) 0, map_arg1_582694);
            bool i_lte_j_582702 = sle64(map_arg1_582694, dim_386746);
            bool y_582703 = i_p_m_t_s_leq_w_582700 && zzero_lte_i_582701;
            bool y_582704 = zzero_leq_i_p_m_t_s_582699 && y_582703;
            bool forwards_ok_582705 = i_lte_j_582702 && y_582704;
            bool ok_or_empty_582706 = empty_slice_582696 || forwards_ok_582705;
            bool index_certs_582707;
            
            if (!ok_or_empty_582706) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582694, ":", (long long) dim_386746, "] out of bounds for array of shape [", (long long) dim_386746, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586491 = (int64_t) 8 * j_m_i_582695;
            double this_x_582693 = ((double *) mem_586479)[i_582689];
            
            if (mem_586492_cached_sizze_588425 < bytes_586491) {
                err = lexical_realloc(ctx, &mem_586492, &mem_586492_cached_sizze_588425, bytes_586491);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586073 = 0; i_586073 < j_m_i_582695; i_586073++) {
                int64_t slice_586367 = map_arg1_582694 + i_586073;
                double eta_p_582710 = ((double *) mem_586479)[slice_586367];
                double defunc_0_ftimes_res_582711 = eta_p_582710 * eta_p_582710;
                
                ((double *) mem_586492)[i_586073] = defunc_0_ftimes_res_582711;
            }
            
            double defunc_0_foldl_res_582712;
            double acc_582714 = 0.0;
            
            for (int64_t i_582713 = 0; i_582713 < j_m_i_582695; i_582713++) {
                double b_582715 = ((double *) mem_586492)[i_582713];
                double defunc_0_f_res_582716 = acc_582714 + b_582715;
                double acc_tmp_588027 = defunc_0_f_res_582716;
                
                acc_582714 = acc_tmp_588027;
            }
            defunc_0_foldl_res_582712 = acc_582714;
            
            double sqrt_res_582717 = futrts_sqrt64(defunc_0_foldl_res_582712);
            double atan2_res_582718 = futrts_atan2_64(sqrt_res_582717, this_x_582693);
            
            ((double *) mem_586487)[i_582689] = atan2_res_582718;
        }
        for (int64_t i_586077 = 0; i_586077 < arg_574118; i_586077++) {
            double eta_p_582721 = ((double *) mem_586487)[i_586077];
            double eta_p_582722 = ((double *) mem_586443)[i_586077];
            int64_t eta_p_582723 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586077];
            int64_t eta_p_582724 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586077];
            double i64_res_582725 = sitofp_i64_f64(eta_p_582723);
            double defunc_0_fover_res_582726 = eta_p_582721 / eta_p_582722;
            double defunc_0_ftimes_res_582727 = i64_res_582725 * defunc_0_fover_res_582726;
            int64_t f64_res_582728 = fptosi_f64_i64(defunc_0_ftimes_res_582727);
            bool cond_582729 = slt64(f64_res_582728, (int64_t) 0);
            int64_t defunc_0_f_res_582730;
            
            if (cond_582729) {
                defunc_0_f_res_582730 = (int64_t) 0;
            } else {
                bool cond_582731 = sle64(eta_p_582724, f64_res_582728);
                int64_t defunc_0_f_res_f_res_582732;
                
                if (cond_582731) {
                    int64_t defunc_0_f_res_f_res_t_res_582979 = sub64(eta_p_582724, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582732 = defunc_0_f_res_f_res_t_res_582979;
                } else {
                    defunc_0_f_res_f_res_582732 = f64_res_582728;
                }
                defunc_0_f_res_582730 = defunc_0_f_res_f_res_582732;
            }
            ((int64_t *) mem_586503)[i_586077] = defunc_0_f_res_582730;
        }
        
        int64_t defunc_0_foldl_res_582734;
        int64_t acc_582736 = (int64_t) 0;
        
        for (int64_t i_582735 = 0; i_582735 < arg_574118; i_582735++) {
            int64_t b_582737 = ((int64_t *) mem_586503)[i_582735];
            int64_t defunc_0_f_res_582738 = add64(acc_582736, b_582737);
            int64_t acc_tmp_588029 = defunc_0_f_res_582738;
            
            acc_582736 = acc_tmp_588029;
        }
        defunc_0_foldl_res_582734 = acc_582736;
        
        int64_t zp_lhs_582739 = mul64(total_angle_no_386759, defunc_0_foldl_res_582673);
        int64_t get_id_from_grid_angle_res_582740 = add64(defunc_0_foldl_res_582734, zp_lhs_582739);
        bool x_582741 = sle64((int64_t) 0, get_id_from_grid_angle_res_582740);
        bool y_582742 = slt64(get_id_from_grid_angle_res_582740, total_part_no_386761);
        bool bounds_check_582743 = x_582741 && y_582742;
        bool index_certs_582744;
        
        if (!bounds_check_582743) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582740, "] out of bounds for array of shape [", (long long) total_part_no_386761, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582747 = slt64(get_id_from_grid_angle_res_582740, dzlz7bUskBzitotal_part_noz7dUzg_386751);
        bool bounds_check_582748 = x_582741 && y_582747;
        bool index_certs_582749;
        
        if (!bounds_check_582748) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582740, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_386751, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586084 = ((int64_t *) xys_mem_586420.mem)[write_iter_586079];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586469, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, write_iter_586079 * dim_386746, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_386746});
        
        int64_t pref_582745 = ((int64_t *) mem_586433.mem)[get_id_from_grid_angle_res_582740];
        int64_t zp_lhs_582746 = add64(pref_582745, write_iter_586079);
        int64_t zm_rhs_582750 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582740];
        int64_t defunc_0_f_res_582751 = sub64(zp_lhs_582746, zm_rhs_582750);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582751) && slt64(defunc_0_f_res_582751, zp_lhs_574158)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_386746 - (int64_t) 1, dim_386746))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586458.mem, defunc_0_f_res_582751 * dim_386746, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586469, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_386746});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582751) && slt64(defunc_0_f_res_582751, zp_lhs_574158)) {
            ((int64_t *) mem_586460.mem)[defunc_0_f_res_582751] = write_iv_586084;
        }
    }
    
    int64_t zeze_rhs_574313 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_386751, (int64_t) 1);
    
    if (mem_586525_cached_sizze_588427 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586525, &mem_586525_cached_sizze_588427, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586527_cached_sizze_588428 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588428, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586535_cached_sizze_588429 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586535, &mem_586535_cached_sizze_588429, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586543_cached_sizze_588430 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586543, &mem_586543_cached_sizze_588430, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586559_cached_sizze_588432 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588432, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586103 = 0; write_iter_586103 < dz2083U_386752; write_iter_586103++) {
        for (int64_t i_586089 = 0; i_586089 < dim_386746; i_586089++) {
            double eta_p_582935 = ((double *) xys_mem_586423.mem)[write_iter_586103 * dim_386746 + i_586089];
            double eta_p_582936 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586089];
            double eta_p_582937 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586089];
            int64_t eta_p_582939 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586089];
            double defunc_0_f_res_582940 = eta_p_582935 - eta_p_582936;
            double defunc_0_f_res_582942 = defunc_0_f_res_582940 / eta_p_582937;
            int64_t f64_res_582944 = fptosi_f64_i64(defunc_0_f_res_582942);
            int64_t max_res_582946 = smax64((int64_t) 0, f64_res_582944);
            int64_t zm_lhs_582952 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586089];
            int64_t min_arg1_582953 = sub64(zm_lhs_582952, (int64_t) 1);
            int64_t min_res_582954 = smin64(max_res_582946, min_arg1_582953);
            int64_t defunc_0_f_res_582956 = mul64(eta_p_582939, min_res_582954);
            
            ((int64_t *) mem_586527)[i_586089] = defunc_0_f_res_582956;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_386746; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586527)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588033 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588033;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_386747);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_386747, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586093 = 0; i_586093 < dim_386746; i_586093++) {
            double eta_p_582548 = ((double *) xys_mem_586423.mem)[write_iter_586103 * dim_386746 + i_586093];
            double eta_p_582549 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_386746 + i_586093];
            double defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((double *) mem_586535)[i_586093] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588035 = 0; nest_i_588035 < arg_574118; nest_i_588035++) {
            ((double *) mem_586543)[nest_i_588035] = 0.0;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_574118; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_386746);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_386746, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_386746, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_386746);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_386746);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_386746, "] out of bounds for array of shape [", (long long) dim_386746, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:860:17-866:81\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586547 = (int64_t) 8 * j_m_i_582559;
            double this_x_582557 = ((double *) mem_586535)[i_582553];
            
            if (mem_586548_cached_sizze_588431 < bytes_586547) {
                err = lexical_realloc(ctx, &mem_586548, &mem_586548_cached_sizze_588431, bytes_586547);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586097 = 0; i_586097 < j_m_i_582559; i_586097++) {
                int64_t slice_586362 = map_arg1_582558 + i_586097;
                double eta_p_582574 = ((double *) mem_586535)[slice_586362];
                double defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((double *) mem_586548)[i_586097] = defunc_0_ftimes_res_582575;
            }
            
            double defunc_0_foldl_res_582576;
            double acc_582578 = 0.0;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                double b_582579 = ((double *) mem_586548)[i_582577];
                double defunc_0_f_res_582580 = acc_582578 + b_582579;
                double acc_tmp_588038 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588038;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            double sqrt_res_582581 = futrts_sqrt64(defunc_0_foldl_res_582576);
            double atan2_res_582582 = futrts_atan2_64(sqrt_res_582581, this_x_582557);
            
            ((double *) mem_586543)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586101 = 0; i_586101 < arg_574118; i_586101++) {
            double eta_p_582585 = ((double *) mem_586543)[i_586101];
            double eta_p_582586 = ((double *) mem_586441)[i_586101];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586101];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586101];
            double i64_res_582589 = sitofp_i64_f64(eta_p_582587);
            double defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            double defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f64_res_582592 = fptosi_f64_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f64_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f64_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_582986 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_582986;
                } else {
                    defunc_0_f_res_f_res_582596 = f64_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586559)[i_586101] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_574118; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586559)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588040 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588040;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_386759, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_386761);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_386761, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582630 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_386751);
        bool bounds_check_582631 = x_582605 && y_582630;
        bool index_certs_582632;
        
        if (!bounds_check_582631) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_386751, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:860:17-866:81\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586108 = ((int64_t *) xys_mem_586424.mem)[write_iter_586103];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586525, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586423.mem, write_iter_586103 * dim_386746, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_386746});
        
        int64_t pref_582609 = ((int64_t *) mem_586433.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_574313;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_582990 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_582991 = sub64(dz2083U_386749, zm_rhs_582990);
            
            post_582611 = post_t_res_582991;
        } else {
            int64_t zm_lhs_582617 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582618 = sle64((int64_t) 0, zm_lhs_582617);
            bool y_582619 = slt64(zm_lhs_582617, dzlz7bUskBzitotal_part_noz7dUzg_386751);
            bool bounds_check_582620 = x_582618 && y_582619;
            bool index_certs_582621;
            
            if (!bounds_check_582620) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582617, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_386751, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:860:17-866:81\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582622 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582617];
            int64_t zm_rhs_582626 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582627 = sub64(zm_lhs_582622, zm_rhs_582626);
            
            post_582611 = post_f_res_582627;
        }
        
        int64_t zp_lhs_582628 = add64(pref_582609, write_iter_586103);
        int64_t zm_lhs_582629 = add64(post_582611, zp_lhs_582628);
        int64_t zm_rhs_582633 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582634 = sub64(zm_lhs_582629, zm_rhs_582633);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582634) && slt64(defunc_0_f_res_582634, zp_lhs_574158)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_386746 - (int64_t) 1, dim_386746))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586458.mem, defunc_0_f_res_582634 * dim_386746, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586525, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_386746});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582634) && slt64(defunc_0_f_res_582634, zp_lhs_574158)) {
            ((int64_t *) mem_586460.mem)[defunc_0_f_res_582634] = write_iv_586108;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586425, "mem_586425") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586433, "mem_586433") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586458, "mem_586458") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586460, "mem_586460") != 0)
        return 1;
    prim_out_588011 = zp_lhs_574158;
    if (memblock_set(ctx, &*mem_out_p_588414, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588415, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588416, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588417, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588418 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586441);
        free(mem_586443);
        free(mem_586469);
        free(mem_586471);
        free(mem_586479);
        free(mem_586487);
        free(mem_586492);
        free(mem_586503);
        free(mem_586525);
        free(mem_586527);
        free(mem_586535);
        free(mem_586543);
        free(mem_586548);
        free(mem_586559);
        if (memblock_unref(ctx, &mem_586460, "mem_586460") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586458, "mem_586458") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586433, "mem_586433") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586425, "mem_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_2_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588433, struct memblock *mem_out_p_588434, struct memblock *mem_out_p_588435, struct memblock *mem_out_p_588436, int64_t *out_prim_out_588437, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, int64_t dim_550531, int64_t dz2080U_550532, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533, int64_t dz2083U_550534, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_550535, int64_t dzlz7bUskBzitotal_part_noz7dUzg_550536, int64_t dz2083U_550537, int64_t total_angle_no_550544, int64_t total_grid_no_550545, int64_t total_part_no_550546)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586441_cached_sizze_588438 = 0;
    unsigned char *mem_586441 = NULL;
    int64_t mem_586443_cached_sizze_588439 = 0;
    unsigned char *mem_586443 = NULL;
    int64_t mem_586469_cached_sizze_588440 = 0;
    unsigned char *mem_586469 = NULL;
    int64_t mem_586471_cached_sizze_588441 = 0;
    unsigned char *mem_586471 = NULL;
    int64_t mem_586479_cached_sizze_588442 = 0;
    unsigned char *mem_586479 = NULL;
    int64_t mem_586487_cached_sizze_588443 = 0;
    unsigned char *mem_586487 = NULL;
    int64_t mem_586492_cached_sizze_588444 = 0;
    unsigned char *mem_586492 = NULL;
    int64_t mem_586503_cached_sizze_588445 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586525_cached_sizze_588446 = 0;
    unsigned char *mem_586525 = NULL;
    int64_t mem_586527_cached_sizze_588447 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586535_cached_sizze_588448 = 0;
    unsigned char *mem_586535 = NULL;
    int64_t mem_586543_cached_sizze_588449 = 0;
    unsigned char *mem_586543 = NULL;
    int64_t mem_586548_cached_sizze_588450 = 0;
    unsigned char *mem_586548 = NULL;
    int64_t mem_586559_cached_sizze_588451 = 0;
    unsigned char *mem_586559 = NULL;
    struct memblock mem_586460;
    
    mem_586460.references = NULL;
    
    struct memblock mem_586458;
    
    mem_586458.references = NULL;
    
    struct memblock mem_586433;
    
    mem_586433.references = NULL;
    
    struct memblock mem_586425;
    
    mem_586425.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_574118 = sub64(dim_550531, (int64_t) 1);
    bool assert_cond_t_res_574119 = arg_574118 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533;
    bool assert_c_574120;
    
    if (!assert_cond_t_res_574119) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_574124 = dzlz7bUskBzitotal_grid_noz7dUzg_550535 == total_grid_no_550545;
    bool empty_or_match_cert_574125;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:570:13-21\n   #1  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_574127 = dzlz7bUskBzitotal_part_noz7dUzg_550536 == total_part_no_550546;
    bool empty_or_match_cert_574128;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:570:13-21\n   #1  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574133;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:569:50-60\n   #2  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574136;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:569:50-60\n   #2  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574139;
    
    if (!dim_match_574124) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:569:50-60\n   #3  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_574141;
    
    if (!dim_match_574127) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:569:50-60\n   #3  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586432 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_550536;
    int64_t zp_lhs_574158 = add64(dz2083U_550534, dz2083U_550537);
    bool dim_match_574160 = total_part_no_550546 == dzlz7bUskBzitotal_part_noz7dUzg_550536;
    bool empty_or_match_cert_574161;
    
    if (!dim_match_574160) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:565:57-67\n   #3  ftSkyline.fut:569:50-60\n   #4  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_574162 = slt64((int64_t) 0, dz2080U_550532);
    bool index_certs_574163;
    
    if (!y_574162) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_550532, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586440 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533;
    bool empty_or_match_cert_574178;
    
    if (!assert_cond_t_res_574119) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586456 = (int64_t) 4 * zp_lhs_574158;
    int64_t bytes_586457 = dim_550531 * binop_x_586456;
    int64_t bytes_586459 = (int64_t) 8 * zp_lhs_574158;
    int64_t bytes_586468 = (int64_t) 4 * dim_550531;
    int64_t bytes_586470 = (int64_t) 8 * dim_550531;
    int64_t bytes_586486 = (int64_t) 4 * arg_574118;
    int64_t bytes_586502 = (int64_t) 8 * arg_574118;
    
    if (memblock_alloc(ctx, &mem_586425, dzlz7bUskBzitotal_grid_noz7dUzg_550535, "mem_586425")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_550535; i_586050++) {
        bool eta_p_574143 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_574144 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool cond_574147 = eta_p_574143 || eta_p_574144;
        
        ((bool *) mem_586425.mem)[i_586050] = cond_574147;
    }
    if (memblock_alloc(ctx, &mem_586433, bytes_586432, "mem_586433")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_550536; i_586054++) {
        int64_t eta_p_574151 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_574152 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t zp_lhs_574155 = add64(eta_p_574151, eta_p_574152);
        
        ((int64_t *) mem_586433.mem)[i_586054] = zp_lhs_574155;
    }
    if (mem_586441_cached_sizze_588438 < bytes_586440) {
        err = lexical_realloc(ctx, &mem_586441, &mem_586441_cached_sizze_588438, bytes_586440);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586443_cached_sizze_588439 < bytes_586440) {
        err = lexical_realloc(ctx, &mem_586443, &mem_586443_cached_sizze_588439, bytes_586440);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586060 = 0; i_586060 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533; i_586060++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582760 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586060];
        float i64_res_582761 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582760);
        float defunc_0_fover_res_582762 = 1.5707964F / i64_res_582761;
        
        ((float *) mem_586441)[i_586060] = defunc_0_fover_res_582762;
        ((float *) mem_586443)[i_586060] = defunc_0_fover_res_582762;
    }
    if (memblock_alloc(ctx, &mem_586458, bytes_586457, "mem_586458")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588016 = 0; nest_i_588016 < zp_lhs_574158; nest_i_588016++) {
        for (int64_t nest_i_588017 = 0; nest_i_588017 < dim_550531; nest_i_588017++) {
            ((float *) mem_586458.mem)[nest_i_588016 * dim_550531 + nest_i_588017] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586460, bytes_586459, "mem_586460")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588018 = 0; nest_i_588018 < zp_lhs_574158; nest_i_588018++) {
        ((int64_t *) mem_586460.mem)[nest_i_588018] = (int64_t) -1;
    }
    if (mem_586469_cached_sizze_588440 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586469, &mem_586469_cached_sizze_588440, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586471_cached_sizze_588441 < bytes_586470) {
        err = lexical_realloc(ctx, &mem_586471, &mem_586471_cached_sizze_588441, bytes_586470);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586479_cached_sizze_588442 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586479, &mem_586479_cached_sizze_588442, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586487_cached_sizze_588443 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586487, &mem_586487_cached_sizze_588443, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586503_cached_sizze_588445 < bytes_586502) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588445, bytes_586502);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586079 = 0; write_iter_586079 < dz2083U_550534; write_iter_586079++) {
        for (int64_t i_586065 = 0; i_586065 < dim_550531; i_586065++) {
            float eta_p_582837 = ((float *) xys_mem_586419.mem)[write_iter_586079 * dim_550531 + i_586065];
            float eta_p_582838 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586065];
            float eta_p_582839 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586065];
            int64_t eta_p_582841 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586065];
            float defunc_0_f_res_582842 = eta_p_582837 - eta_p_582838;
            float defunc_0_f_res_582844 = defunc_0_f_res_582842 / eta_p_582839;
            int64_t f32_res_582846 = fptosi_f32_i64(defunc_0_f_res_582844);
            int64_t max_res_582848 = smax64((int64_t) 0, f32_res_582846);
            int64_t zm_lhs_582854 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586065];
            int64_t min_arg1_582855 = sub64(zm_lhs_582854, (int64_t) 1);
            int64_t min_res_582856 = smin64(max_res_582848, min_arg1_582855);
            int64_t defunc_0_f_res_582858 = mul64(eta_p_582841, min_res_582856);
            
            ((int64_t *) mem_586471)[i_586065] = defunc_0_f_res_582858;
        }
        
        int64_t defunc_0_foldl_res_582673;
        int64_t acc_582675 = (int64_t) 0;
        
        for (int64_t i_582674 = 0; i_582674 < dim_550531; i_582674++) {
            int64_t b_582676 = ((int64_t *) mem_586471)[i_582674];
            int64_t defunc_0_f_res_582677 = add64(acc_582675, b_582676);
            int64_t acc_tmp_588022 = defunc_0_f_res_582677;
            
            acc_582675 = acc_tmp_588022;
        }
        defunc_0_foldl_res_582673 = acc_582675;
        
        bool x_582678 = sle64((int64_t) 0, defunc_0_foldl_res_582673);
        bool y_582679 = slt64(defunc_0_foldl_res_582673, dz2080U_550532);
        bool bounds_check_582680 = x_582678 && y_582679;
        bool index_certs_582681;
        
        if (!bounds_check_582680) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582673, "] out of bounds for array of shape [", (long long) dz2080U_550532, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586069 = 0; i_586069 < dim_550531; i_586069++) {
            float eta_p_582684 = ((float *) xys_mem_586419.mem)[write_iter_586079 * dim_550531 + i_586069];
            float eta_p_582685 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582673 * dim_550531 + i_586069];
            float defunc_0_f_res_582686 = eta_p_582684 - eta_p_582685;
            
            ((float *) mem_586479)[i_586069] = defunc_0_f_res_582686;
        }
        for (int64_t nest_i_588024 = 0; nest_i_588024 < arg_574118; nest_i_588024++) {
            ((float *) mem_586487)[nest_i_588024] = 0.0F;
        }
        for (int64_t i_582689 = 0; i_582689 < arg_574118; i_582689++) {
            bool y_582691 = slt64(i_582689, dim_550531);
            bool index_certs_582692;
            
            if (!y_582691) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582689, "] out of bounds for array of shape [", (long long) dim_550531, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582694 = add64((int64_t) 1, i_582689);
            int64_t j_m_i_582695 = sub64(dim_550531, map_arg1_582694);
            bool empty_slice_582696 = j_m_i_582695 == (int64_t) 0;
            int64_t m_582697 = sub64(j_m_i_582695, (int64_t) 1);
            int64_t i_p_m_t_s_582698 = add64(map_arg1_582694, m_582697);
            bool zzero_leq_i_p_m_t_s_582699 = sle64((int64_t) 0, i_p_m_t_s_582698);
            bool i_p_m_t_s_leq_w_582700 = slt64(i_p_m_t_s_582698, dim_550531);
            bool zzero_lte_i_582701 = sle64((int64_t) 0, map_arg1_582694);
            bool i_lte_j_582702 = sle64(map_arg1_582694, dim_550531);
            bool y_582703 = i_p_m_t_s_leq_w_582700 && zzero_lte_i_582701;
            bool y_582704 = zzero_leq_i_p_m_t_s_582699 && y_582703;
            bool forwards_ok_582705 = i_lte_j_582702 && y_582704;
            bool ok_or_empty_582706 = empty_slice_582696 || forwards_ok_582705;
            bool index_certs_582707;
            
            if (!ok_or_empty_582706) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582694, ":", (long long) dim_550531, "] out of bounds for array of shape [", (long long) dim_550531, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586491 = (int64_t) 4 * j_m_i_582695;
            float this_x_582693 = ((float *) mem_586479)[i_582689];
            
            if (mem_586492_cached_sizze_588444 < bytes_586491) {
                err = lexical_realloc(ctx, &mem_586492, &mem_586492_cached_sizze_588444, bytes_586491);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586073 = 0; i_586073 < j_m_i_582695; i_586073++) {
                int64_t slice_586367 = map_arg1_582694 + i_586073;
                float eta_p_582710 = ((float *) mem_586479)[slice_586367];
                float defunc_0_ftimes_res_582711 = eta_p_582710 * eta_p_582710;
                
                ((float *) mem_586492)[i_586073] = defunc_0_ftimes_res_582711;
            }
            
            float defunc_0_foldl_res_582712;
            float acc_582714 = 0.0F;
            
            for (int64_t i_582713 = 0; i_582713 < j_m_i_582695; i_582713++) {
                float b_582715 = ((float *) mem_586492)[i_582713];
                float defunc_0_f_res_582716 = acc_582714 + b_582715;
                float acc_tmp_588027 = defunc_0_f_res_582716;
                
                acc_582714 = acc_tmp_588027;
            }
            defunc_0_foldl_res_582712 = acc_582714;
            
            float sqrt_res_582717 = futrts_sqrt32(defunc_0_foldl_res_582712);
            float atan2_res_582718 = futrts_atan2_32(sqrt_res_582717, this_x_582693);
            
            ((float *) mem_586487)[i_582689] = atan2_res_582718;
        }
        for (int64_t i_586077 = 0; i_586077 < arg_574118; i_586077++) {
            float eta_p_582721 = ((float *) mem_586487)[i_586077];
            float eta_p_582722 = ((float *) mem_586443)[i_586077];
            int64_t eta_p_582723 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586077];
            int64_t eta_p_582724 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586077];
            float i64_res_582725 = sitofp_i64_f32(eta_p_582723);
            float defunc_0_fover_res_582726 = eta_p_582721 / eta_p_582722;
            float defunc_0_ftimes_res_582727 = i64_res_582725 * defunc_0_fover_res_582726;
            int64_t f32_res_582728 = fptosi_f32_i64(defunc_0_ftimes_res_582727);
            bool cond_582729 = slt64(f32_res_582728, (int64_t) 0);
            int64_t defunc_0_f_res_582730;
            
            if (cond_582729) {
                defunc_0_f_res_582730 = (int64_t) 0;
            } else {
                bool cond_582731 = sle64(eta_p_582724, f32_res_582728);
                int64_t defunc_0_f_res_f_res_582732;
                
                if (cond_582731) {
                    int64_t defunc_0_f_res_f_res_t_res_582979 = sub64(eta_p_582724, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582732 = defunc_0_f_res_f_res_t_res_582979;
                } else {
                    defunc_0_f_res_f_res_582732 = f32_res_582728;
                }
                defunc_0_f_res_582730 = defunc_0_f_res_f_res_582732;
            }
            ((int64_t *) mem_586503)[i_586077] = defunc_0_f_res_582730;
        }
        
        int64_t defunc_0_foldl_res_582734;
        int64_t acc_582736 = (int64_t) 0;
        
        for (int64_t i_582735 = 0; i_582735 < arg_574118; i_582735++) {
            int64_t b_582737 = ((int64_t *) mem_586503)[i_582735];
            int64_t defunc_0_f_res_582738 = add64(acc_582736, b_582737);
            int64_t acc_tmp_588029 = defunc_0_f_res_582738;
            
            acc_582736 = acc_tmp_588029;
        }
        defunc_0_foldl_res_582734 = acc_582736;
        
        int64_t zp_lhs_582739 = mul64(total_angle_no_550544, defunc_0_foldl_res_582673);
        int64_t get_id_from_grid_angle_res_582740 = add64(defunc_0_foldl_res_582734, zp_lhs_582739);
        bool x_582741 = sle64((int64_t) 0, get_id_from_grid_angle_res_582740);
        bool y_582742 = slt64(get_id_from_grid_angle_res_582740, total_part_no_550546);
        bool bounds_check_582743 = x_582741 && y_582742;
        bool index_certs_582744;
        
        if (!bounds_check_582743) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582740, "] out of bounds for array of shape [", (long long) total_part_no_550546, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582747 = slt64(get_id_from_grid_angle_res_582740, dzlz7bUskBzitotal_part_noz7dUzg_550536);
        bool bounds_check_582748 = x_582741 && y_582747;
        bool index_certs_582749;
        
        if (!bounds_check_582748) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582740, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_550536, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586084 = ((int64_t *) xys_mem_586420.mem)[write_iter_586079];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586469, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, write_iter_586079 * dim_550531, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_550531});
        
        int64_t pref_582745 = ((int64_t *) mem_586433.mem)[get_id_from_grid_angle_res_582740];
        int64_t zp_lhs_582746 = add64(pref_582745, write_iter_586079);
        int64_t zm_rhs_582750 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582740];
        int64_t defunc_0_f_res_582751 = sub64(zp_lhs_582746, zm_rhs_582750);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582751) && slt64(defunc_0_f_res_582751, zp_lhs_574158)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_550531 - (int64_t) 1, dim_550531))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586458.mem, defunc_0_f_res_582751 * dim_550531, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586469, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_550531});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582751) && slt64(defunc_0_f_res_582751, zp_lhs_574158)) {
            ((int64_t *) mem_586460.mem)[defunc_0_f_res_582751] = write_iv_586084;
        }
    }
    
    int64_t zeze_rhs_574313 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_550536, (int64_t) 1);
    
    if (mem_586525_cached_sizze_588446 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586525, &mem_586525_cached_sizze_588446, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586527_cached_sizze_588447 < bytes_586470) {
        err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588447, bytes_586470);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586535_cached_sizze_588448 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_586535, &mem_586535_cached_sizze_588448, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586543_cached_sizze_588449 < bytes_586486) {
        err = lexical_realloc(ctx, &mem_586543, &mem_586543_cached_sizze_588449, bytes_586486);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586559_cached_sizze_588451 < bytes_586502) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588451, bytes_586502);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586103 = 0; write_iter_586103 < dz2083U_550537; write_iter_586103++) {
        for (int64_t i_586089 = 0; i_586089 < dim_550531; i_586089++) {
            float eta_p_582935 = ((float *) xys_mem_586423.mem)[write_iter_586103 * dim_550531 + i_586089];
            float eta_p_582936 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586089];
            float eta_p_582937 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586089];
            int64_t eta_p_582939 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586089];
            float defunc_0_f_res_582940 = eta_p_582935 - eta_p_582936;
            float defunc_0_f_res_582942 = defunc_0_f_res_582940 / eta_p_582937;
            int64_t f32_res_582944 = fptosi_f32_i64(defunc_0_f_res_582942);
            int64_t max_res_582946 = smax64((int64_t) 0, f32_res_582944);
            int64_t zm_lhs_582952 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586089];
            int64_t min_arg1_582953 = sub64(zm_lhs_582952, (int64_t) 1);
            int64_t min_res_582954 = smin64(max_res_582946, min_arg1_582953);
            int64_t defunc_0_f_res_582956 = mul64(eta_p_582939, min_res_582954);
            
            ((int64_t *) mem_586527)[i_586089] = defunc_0_f_res_582956;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_550531; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586527)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588033 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588033;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_550532);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_550532, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586093 = 0; i_586093 < dim_550531; i_586093++) {
            float eta_p_582548 = ((float *) xys_mem_586423.mem)[write_iter_586103 * dim_550531 + i_586093];
            float eta_p_582549 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_550531 + i_586093];
            float defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((float *) mem_586535)[i_586093] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588035 = 0; nest_i_588035 < arg_574118; nest_i_588035++) {
            ((float *) mem_586543)[nest_i_588035] = 0.0F;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_574118; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_550531);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_550531, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_550531, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_550531);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_550531);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_550531, "] out of bounds for array of shape [", (long long) dim_550531, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:569:50-60\n   #7  ftSkyline.fut:1007:17-1013:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586547 = (int64_t) 4 * j_m_i_582559;
            float this_x_582557 = ((float *) mem_586535)[i_582553];
            
            if (mem_586548_cached_sizze_588450 < bytes_586547) {
                err = lexical_realloc(ctx, &mem_586548, &mem_586548_cached_sizze_588450, bytes_586547);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586097 = 0; i_586097 < j_m_i_582559; i_586097++) {
                int64_t slice_586362 = map_arg1_582558 + i_586097;
                float eta_p_582574 = ((float *) mem_586535)[slice_586362];
                float defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((float *) mem_586548)[i_586097] = defunc_0_ftimes_res_582575;
            }
            
            float defunc_0_foldl_res_582576;
            float acc_582578 = 0.0F;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                float b_582579 = ((float *) mem_586548)[i_582577];
                float defunc_0_f_res_582580 = acc_582578 + b_582579;
                float acc_tmp_588038 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588038;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            float sqrt_res_582581 = futrts_sqrt32(defunc_0_foldl_res_582576);
            float atan2_res_582582 = futrts_atan2_32(sqrt_res_582581, this_x_582557);
            
            ((float *) mem_586543)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586101 = 0; i_586101 < arg_574118; i_586101++) {
            float eta_p_582585 = ((float *) mem_586543)[i_586101];
            float eta_p_582586 = ((float *) mem_586441)[i_586101];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586101];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586101];
            float i64_res_582589 = sitofp_i64_f32(eta_p_582587);
            float defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            float defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f32_res_582592 = fptosi_f32_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f32_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f32_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_582986 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_582986;
                } else {
                    defunc_0_f_res_f_res_582596 = f32_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586559)[i_586101] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_574118; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586559)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588040 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588040;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_550544, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_550546);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_550546, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582630 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_550536);
        bool bounds_check_582631 = x_582605 && y_582630;
        bool index_certs_582632;
        
        if (!bounds_check_582631) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_550536, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:1007:17-1013:80\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586108 = ((int64_t *) xys_mem_586424.mem)[write_iter_586103];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586525, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586423.mem, write_iter_586103 * dim_550531, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_550531});
        
        int64_t pref_582609 = ((int64_t *) mem_586433.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_574313;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_582990 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_582991 = sub64(dz2083U_550534, zm_rhs_582990);
            
            post_582611 = post_t_res_582991;
        } else {
            int64_t zm_lhs_582617 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582618 = sle64((int64_t) 0, zm_lhs_582617);
            bool y_582619 = slt64(zm_lhs_582617, dzlz7bUskBzitotal_part_noz7dUzg_550536);
            bool bounds_check_582620 = x_582618 && y_582619;
            bool index_certs_582621;
            
            if (!bounds_check_582620) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582617, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_550536, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:569:50-60\n   #5  ftSkyline.fut:1007:17-1013:80\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582622 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582617];
            int64_t zm_rhs_582626 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582627 = sub64(zm_lhs_582622, zm_rhs_582626);
            
            post_582611 = post_f_res_582627;
        }
        
        int64_t zp_lhs_582628 = add64(pref_582609, write_iter_586103);
        int64_t zm_lhs_582629 = add64(post_582611, zp_lhs_582628);
        int64_t zm_rhs_582633 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582634 = sub64(zm_lhs_582629, zm_rhs_582633);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582634) && slt64(defunc_0_f_res_582634, zp_lhs_574158)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_550531 - (int64_t) 1, dim_550531))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586458.mem, defunc_0_f_res_582634 * dim_550531, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586525, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_550531});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582634) && slt64(defunc_0_f_res_582634, zp_lhs_574158)) {
            ((int64_t *) mem_586460.mem)[defunc_0_f_res_582634] = write_iv_586108;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586425, "mem_586425") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586433, "mem_586433") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586458, "mem_586458") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586460, "mem_586460") != 0)
        return 1;
    prim_out_588011 = zp_lhs_574158;
    if (memblock_set(ctx, &*mem_out_p_588433, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588434, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588435, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588436, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588437 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586441);
        free(mem_586443);
        free(mem_586469);
        free(mem_586471);
        free(mem_586479);
        free(mem_586487);
        free(mem_586492);
        free(mem_586503);
        free(mem_586525);
        free(mem_586527);
        free(mem_586535);
        free(mem_586543);
        free(mem_586548);
        free(mem_586559);
        if (memblock_unref(ctx, &mem_586460, "mem_586460") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586458, "mem_586458") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586433, "mem_586433") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586425, "mem_586425") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_3_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588452, struct memblock *mem_out_p_588453, struct memblock *mem_out_p_588454, struct memblock *mem_out_p_588455, int64_t *out_prim_out_588456, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, int64_t dim_366050, int64_t dz2080U_366051, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052, int64_t dz2083U_366053, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_366054, int64_t dzlz7bUskBzitotal_part_noz7dUzg_366055, int64_t dz2083U_366056, int64_t dz2083U_366057, int64_t total_angle_no_366064, int64_t total_grid_no_366065, int64_t total_part_no_366066)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586445_cached_sizze_588457 = 0;
    unsigned char *mem_586445 = NULL;
    int64_t mem_586447_cached_sizze_588458 = 0;
    unsigned char *mem_586447 = NULL;
    int64_t mem_586449_cached_sizze_588459 = 0;
    unsigned char *mem_586449 = NULL;
    int64_t mem_586481_cached_sizze_588460 = 0;
    unsigned char *mem_586481 = NULL;
    int64_t mem_586483_cached_sizze_588461 = 0;
    unsigned char *mem_586483 = NULL;
    int64_t mem_586491_cached_sizze_588462 = 0;
    unsigned char *mem_586491 = NULL;
    int64_t mem_586499_cached_sizze_588463 = 0;
    unsigned char *mem_586499 = NULL;
    int64_t mem_586504_cached_sizze_588464 = 0;
    unsigned char *mem_586504 = NULL;
    int64_t mem_586515_cached_sizze_588465 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586537_cached_sizze_588466 = 0;
    unsigned char *mem_586537 = NULL;
    int64_t mem_586539_cached_sizze_588467 = 0;
    unsigned char *mem_586539 = NULL;
    int64_t mem_586547_cached_sizze_588468 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586555_cached_sizze_588469 = 0;
    unsigned char *mem_586555 = NULL;
    int64_t mem_586560_cached_sizze_588470 = 0;
    unsigned char *mem_586560 = NULL;
    int64_t mem_586571_cached_sizze_588471 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586593_cached_sizze_588472 = 0;
    unsigned char *mem_586593 = NULL;
    int64_t mem_586595_cached_sizze_588473 = 0;
    unsigned char *mem_586595 = NULL;
    int64_t mem_586603_cached_sizze_588474 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586611_cached_sizze_588475 = 0;
    unsigned char *mem_586611 = NULL;
    int64_t mem_586616_cached_sizze_588476 = 0;
    unsigned char *mem_586616 = NULL;
    int64_t mem_586627_cached_sizze_588477 = 0;
    unsigned char *mem_586627 = NULL;
    struct memblock mem_586472;
    
    mem_586472.references = NULL;
    
    struct memblock mem_586470;
    
    mem_586470.references = NULL;
    
    struct memblock mem_586437;
    
    mem_586437.references = NULL;
    
    struct memblock mem_586429;
    
    mem_586429.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_573366 = sub64(dim_366050, (int64_t) 1);
    bool assert_cond_t_res_573367 = arg_573366 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052;
    bool assert_c_573368;
    
    if (!assert_cond_t_res_573367) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_573372 = dzlz7bUskBzitotal_grid_noz7dUzg_366054 == total_grid_no_366065;
    bool empty_or_match_cert_573373;
    
    if (!dim_match_573372) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_573375 = dzlz7bUskBzitotal_part_noz7dUzg_366055 == total_part_no_366066;
    bool empty_or_match_cert_573376;
    
    if (!dim_match_573375) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_573379;
    
    if (!dim_match_573372) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_573381;
    
    if (!dim_match_573375) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586436 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_366055;
    int64_t zp_lhs_573398 = add64(dz2083U_366053, dz2083U_366056);
    int64_t zp_lhs_573399 = add64(dz2083U_366057, zp_lhs_573398);
    bool dim_match_573401 = total_part_no_366066 == dzlz7bUskBzitotal_part_noz7dUzg_366055;
    bool empty_or_match_cert_573402;
    
    if (!dim_match_573401) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:565:57-67\n   #3  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_573403 = slt64((int64_t) 0, dz2080U_366051);
    bool index_certs_573404;
    
    if (!y_573403) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_366051, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586444 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052;
    bool empty_or_match_cert_573419;
    
    if (!assert_cond_t_res_573367) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586468 = (int64_t) 8 * zp_lhs_573399;
    int64_t bytes_586469 = dim_366050 * binop_x_586468;
    int64_t bytes_586480 = (int64_t) 8 * dim_366050;
    int64_t bytes_586498 = (int64_t) 8 * arg_573366;
    
    if (memblock_alloc(ctx, &mem_586429, dzlz7bUskBzitotal_grid_noz7dUzg_366054, "mem_586429")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_366054; i_586050++) {
        bool eta_p_573383 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_573384 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_573385 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool cond_573387 = eta_p_573383 || eta_p_573384;
        bool cond_573388 = eta_p_573385 || cond_573387;
        
        ((bool *) mem_586429.mem)[i_586050] = cond_573388;
    }
    if (memblock_alloc(ctx, &mem_586437, bytes_586436, "mem_586437")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_366055; i_586054++) {
        int64_t eta_p_573391 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_573392 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_573393 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t zp_lhs_573395 = add64(eta_p_573391, eta_p_573392);
        int64_t zp_lhs_573396 = add64(eta_p_573393, zp_lhs_573395);
        
        ((int64_t *) mem_586437.mem)[i_586054] = zp_lhs_573396;
    }
    if (mem_586445_cached_sizze_588457 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586445, &mem_586445_cached_sizze_588457, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586447_cached_sizze_588458 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586447, &mem_586447_cached_sizze_588458, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586449_cached_sizze_588459 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586449, &mem_586449_cached_sizze_588459, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586062 = 0; i_586062 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052; i_586062++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582923 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586062];
        double i64_res_582924 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582923);
        double defunc_0_fover_res_582925 = 1.5707963267948966 / i64_res_582924;
        
        ((double *) mem_586445)[i_586062] = defunc_0_fover_res_582925;
        ((double *) mem_586447)[i_586062] = defunc_0_fover_res_582925;
        ((double *) mem_586449)[i_586062] = defunc_0_fover_res_582925;
    }
    if (memblock_alloc(ctx, &mem_586470, bytes_586469, "mem_586470")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588017 = 0; nest_i_588017 < zp_lhs_573399; nest_i_588017++) {
        for (int64_t nest_i_588018 = 0; nest_i_588018 < dim_366050; nest_i_588018++) {
            ((double *) mem_586470.mem)[nest_i_588017 * dim_366050 + nest_i_588018] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586472, binop_x_586468, "mem_586472")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588019 = 0; nest_i_588019 < zp_lhs_573399; nest_i_588019++) {
        ((int64_t *) mem_586472.mem)[nest_i_588019] = (int64_t) -1;
    }
    if (mem_586481_cached_sizze_588460 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586481, &mem_586481_cached_sizze_588460, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586483_cached_sizze_588461 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586483, &mem_586483_cached_sizze_588461, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586491_cached_sizze_588462 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586491, &mem_586491_cached_sizze_588462, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586499_cached_sizze_588463 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586499, &mem_586499_cached_sizze_588463, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586515_cached_sizze_588465 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588465, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586082 = 0; write_iter_586082 < dz2083U_366053; write_iter_586082++) {
        for (int64_t i_586068 = 0; i_586068 < dim_366050; i_586068++) {
            double eta_p_583009 = ((double *) xys_mem_586419.mem)[write_iter_586082 * dim_366050 + i_586068];
            double eta_p_583010 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586068];
            double eta_p_583011 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586068];
            int64_t eta_p_583013 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586068];
            double defunc_0_f_res_583014 = eta_p_583009 - eta_p_583010;
            double defunc_0_f_res_583016 = defunc_0_f_res_583014 / eta_p_583011;
            int64_t f64_res_583018 = fptosi_f64_i64(defunc_0_f_res_583016);
            int64_t max_res_583020 = smax64((int64_t) 0, f64_res_583018);
            int64_t zm_lhs_583026 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586068];
            int64_t min_arg1_583027 = sub64(zm_lhs_583026, (int64_t) 1);
            int64_t min_res_583028 = smin64(max_res_583020, min_arg1_583027);
            int64_t defunc_0_f_res_583030 = mul64(eta_p_583013, min_res_583028);
            
            ((int64_t *) mem_586483)[i_586068] = defunc_0_f_res_583030;
        }
        
        int64_t defunc_0_foldl_res_582816;
        int64_t acc_582818 = (int64_t) 0;
        
        for (int64_t i_582817 = 0; i_582817 < dim_366050; i_582817++) {
            int64_t b_582819 = ((int64_t *) mem_586483)[i_582817];
            int64_t defunc_0_f_res_582820 = add64(acc_582818, b_582819);
            int64_t acc_tmp_588023 = defunc_0_f_res_582820;
            
            acc_582818 = acc_tmp_588023;
        }
        defunc_0_foldl_res_582816 = acc_582818;
        
        bool x_582821 = sle64((int64_t) 0, defunc_0_foldl_res_582816);
        bool y_582822 = slt64(defunc_0_foldl_res_582816, dz2080U_366051);
        bool bounds_check_582823 = x_582821 && y_582822;
        bool index_certs_582824;
        
        if (!bounds_check_582823) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582816, "] out of bounds for array of shape [", (long long) dz2080U_366051, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586072 = 0; i_586072 < dim_366050; i_586072++) {
            double eta_p_582827 = ((double *) xys_mem_586419.mem)[write_iter_586082 * dim_366050 + i_586072];
            double eta_p_582828 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582816 * dim_366050 + i_586072];
            double defunc_0_f_res_582829 = eta_p_582827 - eta_p_582828;
            
            ((double *) mem_586491)[i_586072] = defunc_0_f_res_582829;
        }
        for (int64_t nest_i_588025 = 0; nest_i_588025 < arg_573366; nest_i_588025++) {
            ((double *) mem_586499)[nest_i_588025] = 0.0;
        }
        for (int64_t i_582832 = 0; i_582832 < arg_573366; i_582832++) {
            bool y_582834 = slt64(i_582832, dim_366050);
            bool index_certs_582835;
            
            if (!y_582834) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582832, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582837 = add64((int64_t) 1, i_582832);
            int64_t j_m_i_582838 = sub64(dim_366050, map_arg1_582837);
            bool empty_slice_582839 = j_m_i_582838 == (int64_t) 0;
            int64_t m_582840 = sub64(j_m_i_582838, (int64_t) 1);
            int64_t i_p_m_t_s_582841 = add64(map_arg1_582837, m_582840);
            bool zzero_leq_i_p_m_t_s_582842 = sle64((int64_t) 0, i_p_m_t_s_582841);
            bool i_p_m_t_s_leq_w_582843 = slt64(i_p_m_t_s_582841, dim_366050);
            bool zzero_lte_i_582844 = sle64((int64_t) 0, map_arg1_582837);
            bool i_lte_j_582845 = sle64(map_arg1_582837, dim_366050);
            bool y_582846 = i_p_m_t_s_leq_w_582843 && zzero_lte_i_582844;
            bool y_582847 = zzero_leq_i_p_m_t_s_582842 && y_582846;
            bool forwards_ok_582848 = i_lte_j_582845 && y_582847;
            bool ok_or_empty_582849 = empty_slice_582839 || forwards_ok_582848;
            bool index_certs_582850;
            
            if (!ok_or_empty_582849) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582837, ":", (long long) dim_366050, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586503 = (int64_t) 8 * j_m_i_582838;
            double this_x_582836 = ((double *) mem_586491)[i_582832];
            
            if (mem_586504_cached_sizze_588464 < bytes_586503) {
                err = lexical_realloc(ctx, &mem_586504, &mem_586504_cached_sizze_588464, bytes_586503);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586076 = 0; i_586076 < j_m_i_582838; i_586076++) {
                int64_t slice_586372 = map_arg1_582837 + i_586076;
                double eta_p_582853 = ((double *) mem_586491)[slice_586372];
                double defunc_0_ftimes_res_582854 = eta_p_582853 * eta_p_582853;
                
                ((double *) mem_586504)[i_586076] = defunc_0_ftimes_res_582854;
            }
            
            double defunc_0_foldl_res_582855;
            double acc_582857 = 0.0;
            
            for (int64_t i_582856 = 0; i_582856 < j_m_i_582838; i_582856++) {
                double b_582858 = ((double *) mem_586504)[i_582856];
                double defunc_0_f_res_582859 = acc_582857 + b_582858;
                double acc_tmp_588028 = defunc_0_f_res_582859;
                
                acc_582857 = acc_tmp_588028;
            }
            defunc_0_foldl_res_582855 = acc_582857;
            
            double sqrt_res_582860 = futrts_sqrt64(defunc_0_foldl_res_582855);
            double atan2_res_582861 = futrts_atan2_64(sqrt_res_582860, this_x_582836);
            
            ((double *) mem_586499)[i_582832] = atan2_res_582861;
        }
        for (int64_t i_586080 = 0; i_586080 < arg_573366; i_586080++) {
            double eta_p_582864 = ((double *) mem_586499)[i_586080];
            double eta_p_582865 = ((double *) mem_586449)[i_586080];
            int64_t eta_p_582866 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586080];
            int64_t eta_p_582867 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586080];
            double i64_res_582868 = sitofp_i64_f64(eta_p_582866);
            double defunc_0_fover_res_582869 = eta_p_582864 / eta_p_582865;
            double defunc_0_ftimes_res_582870 = i64_res_582868 * defunc_0_fover_res_582869;
            int64_t f64_res_582871 = fptosi_f64_i64(defunc_0_ftimes_res_582870);
            bool cond_582872 = slt64(f64_res_582871, (int64_t) 0);
            int64_t defunc_0_f_res_582873;
            
            if (cond_582872) {
                defunc_0_f_res_582873 = (int64_t) 0;
            } else {
                bool cond_582874 = sle64(eta_p_582867, f64_res_582871);
                int64_t defunc_0_f_res_f_res_582875;
                
                if (cond_582874) {
                    int64_t defunc_0_f_res_f_res_t_res_583265 = sub64(eta_p_582867, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582875 = defunc_0_f_res_f_res_t_res_583265;
                } else {
                    defunc_0_f_res_f_res_582875 = f64_res_582871;
                }
                defunc_0_f_res_582873 = defunc_0_f_res_f_res_582875;
            }
            ((int64_t *) mem_586515)[i_586080] = defunc_0_f_res_582873;
        }
        
        int64_t defunc_0_foldl_res_582877;
        int64_t acc_582879 = (int64_t) 0;
        
        for (int64_t i_582878 = 0; i_582878 < arg_573366; i_582878++) {
            int64_t b_582880 = ((int64_t *) mem_586515)[i_582878];
            int64_t defunc_0_f_res_582881 = add64(acc_582879, b_582880);
            int64_t acc_tmp_588030 = defunc_0_f_res_582881;
            
            acc_582879 = acc_tmp_588030;
        }
        defunc_0_foldl_res_582877 = acc_582879;
        
        int64_t zp_lhs_582882 = mul64(total_angle_no_366064, defunc_0_foldl_res_582816);
        int64_t get_id_from_grid_angle_res_582883 = add64(defunc_0_foldl_res_582877, zp_lhs_582882);
        bool x_582884 = sle64((int64_t) 0, get_id_from_grid_angle_res_582883);
        bool y_582885 = slt64(get_id_from_grid_angle_res_582883, total_part_no_366066);
        bool bounds_check_582886 = x_582884 && y_582885;
        bool index_certs_582887;
        
        if (!bounds_check_582886) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582883, "] out of bounds for array of shape [", (long long) total_part_no_366066, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582890 = slt64(get_id_from_grid_angle_res_582883, dzlz7bUskBzitotal_part_noz7dUzg_366055);
        bool bounds_check_582891 = x_582884 && y_582890;
        bool index_certs_582892;
        
        if (!bounds_check_582891) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582883, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_366055, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586087 = ((int64_t *) xys_mem_586420.mem)[write_iter_586082];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586481, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, write_iter_586082 * dim_366050, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        
        int64_t pref_582888 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582883];
        int64_t zp_lhs_582889 = add64(pref_582888, write_iter_586082);
        int64_t zm_rhs_582893 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582883];
        int64_t defunc_0_f_res_582894 = sub64(zp_lhs_582889, zm_rhs_582893);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582894) && slt64(defunc_0_f_res_582894, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_366050 - (int64_t) 1, dim_366050))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586470.mem, defunc_0_f_res_582894 * dim_366050, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586481, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582894) && slt64(defunc_0_f_res_582894, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582894] = write_iv_586087;
        }
    }
    
    int64_t zeze_rhs_573554 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_366055, (int64_t) 1);
    
    if (mem_586537_cached_sizze_588466 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586537, &mem_586537_cached_sizze_588466, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586539_cached_sizze_588467 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586539, &mem_586539_cached_sizze_588467, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586547_cached_sizze_588468 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_588468, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586555_cached_sizze_588469 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586555, &mem_586555_cached_sizze_588469, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586571_cached_sizze_588471 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588471, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586106 = 0; write_iter_586106 < dz2083U_366056; write_iter_586106++) {
        for (int64_t i_586092 = 0; i_586092 < dim_366050; i_586092++) {
            double eta_p_583107 = ((double *) xys_mem_586423.mem)[write_iter_586106 * dim_366050 + i_586092];
            double eta_p_583108 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586092];
            double eta_p_583109 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586092];
            int64_t eta_p_583111 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586092];
            double defunc_0_f_res_583112 = eta_p_583107 - eta_p_583108;
            double defunc_0_f_res_583114 = defunc_0_f_res_583112 / eta_p_583109;
            int64_t f64_res_583116 = fptosi_f64_i64(defunc_0_f_res_583114);
            int64_t max_res_583118 = smax64((int64_t) 0, f64_res_583116);
            int64_t zm_lhs_583124 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586092];
            int64_t min_arg1_583125 = sub64(zm_lhs_583124, (int64_t) 1);
            int64_t min_res_583126 = smin64(max_res_583118, min_arg1_583125);
            int64_t defunc_0_f_res_583128 = mul64(eta_p_583111, min_res_583126);
            
            ((int64_t *) mem_586539)[i_586092] = defunc_0_f_res_583128;
        }
        
        int64_t defunc_0_foldl_res_582680;
        int64_t acc_582682 = (int64_t) 0;
        
        for (int64_t i_582681 = 0; i_582681 < dim_366050; i_582681++) {
            int64_t b_582683 = ((int64_t *) mem_586539)[i_582681];
            int64_t defunc_0_f_res_582684 = add64(acc_582682, b_582683);
            int64_t acc_tmp_588034 = defunc_0_f_res_582684;
            
            acc_582682 = acc_tmp_588034;
        }
        defunc_0_foldl_res_582680 = acc_582682;
        
        bool x_582685 = sle64((int64_t) 0, defunc_0_foldl_res_582680);
        bool y_582686 = slt64(defunc_0_foldl_res_582680, dz2080U_366051);
        bool bounds_check_582687 = x_582685 && y_582686;
        bool index_certs_582688;
        
        if (!bounds_check_582687) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582680, "] out of bounds for array of shape [", (long long) dz2080U_366051, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586096 = 0; i_586096 < dim_366050; i_586096++) {
            double eta_p_582691 = ((double *) xys_mem_586423.mem)[write_iter_586106 * dim_366050 + i_586096];
            double eta_p_582692 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582680 * dim_366050 + i_586096];
            double defunc_0_f_res_582693 = eta_p_582691 - eta_p_582692;
            
            ((double *) mem_586547)[i_586096] = defunc_0_f_res_582693;
        }
        for (int64_t nest_i_588036 = 0; nest_i_588036 < arg_573366; nest_i_588036++) {
            ((double *) mem_586555)[nest_i_588036] = 0.0;
        }
        for (int64_t i_582696 = 0; i_582696 < arg_573366; i_582696++) {
            bool y_582698 = slt64(i_582696, dim_366050);
            bool index_certs_582699;
            
            if (!y_582698) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582696, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582701 = add64((int64_t) 1, i_582696);
            int64_t j_m_i_582702 = sub64(dim_366050, map_arg1_582701);
            bool empty_slice_582703 = j_m_i_582702 == (int64_t) 0;
            int64_t m_582704 = sub64(j_m_i_582702, (int64_t) 1);
            int64_t i_p_m_t_s_582705 = add64(map_arg1_582701, m_582704);
            bool zzero_leq_i_p_m_t_s_582706 = sle64((int64_t) 0, i_p_m_t_s_582705);
            bool i_p_m_t_s_leq_w_582707 = slt64(i_p_m_t_s_582705, dim_366050);
            bool zzero_lte_i_582708 = sle64((int64_t) 0, map_arg1_582701);
            bool i_lte_j_582709 = sle64(map_arg1_582701, dim_366050);
            bool y_582710 = i_p_m_t_s_leq_w_582707 && zzero_lte_i_582708;
            bool y_582711 = zzero_leq_i_p_m_t_s_582706 && y_582710;
            bool forwards_ok_582712 = i_lte_j_582709 && y_582711;
            bool ok_or_empty_582713 = empty_slice_582703 || forwards_ok_582712;
            bool index_certs_582714;
            
            if (!ok_or_empty_582713) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582701, ":", (long long) dim_366050, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586559 = (int64_t) 8 * j_m_i_582702;
            double this_x_582700 = ((double *) mem_586547)[i_582696];
            
            if (mem_586560_cached_sizze_588470 < bytes_586559) {
                err = lexical_realloc(ctx, &mem_586560, &mem_586560_cached_sizze_588470, bytes_586559);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586100 = 0; i_586100 < j_m_i_582702; i_586100++) {
                int64_t slice_586367 = map_arg1_582701 + i_586100;
                double eta_p_582717 = ((double *) mem_586547)[slice_586367];
                double defunc_0_ftimes_res_582718 = eta_p_582717 * eta_p_582717;
                
                ((double *) mem_586560)[i_586100] = defunc_0_ftimes_res_582718;
            }
            
            double defunc_0_foldl_res_582719;
            double acc_582721 = 0.0;
            
            for (int64_t i_582720 = 0; i_582720 < j_m_i_582702; i_582720++) {
                double b_582722 = ((double *) mem_586560)[i_582720];
                double defunc_0_f_res_582723 = acc_582721 + b_582722;
                double acc_tmp_588039 = defunc_0_f_res_582723;
                
                acc_582721 = acc_tmp_588039;
            }
            defunc_0_foldl_res_582719 = acc_582721;
            
            double sqrt_res_582724 = futrts_sqrt64(defunc_0_foldl_res_582719);
            double atan2_res_582725 = futrts_atan2_64(sqrt_res_582724, this_x_582700);
            
            ((double *) mem_586555)[i_582696] = atan2_res_582725;
        }
        for (int64_t i_586104 = 0; i_586104 < arg_573366; i_586104++) {
            double eta_p_582728 = ((double *) mem_586555)[i_586104];
            double eta_p_582729 = ((double *) mem_586447)[i_586104];
            int64_t eta_p_582730 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586104];
            int64_t eta_p_582731 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586104];
            double i64_res_582732 = sitofp_i64_f64(eta_p_582730);
            double defunc_0_fover_res_582733 = eta_p_582728 / eta_p_582729;
            double defunc_0_ftimes_res_582734 = i64_res_582732 * defunc_0_fover_res_582733;
            int64_t f64_res_582735 = fptosi_f64_i64(defunc_0_ftimes_res_582734);
            bool cond_582736 = slt64(f64_res_582735, (int64_t) 0);
            int64_t defunc_0_f_res_582737;
            
            if (cond_582736) {
                defunc_0_f_res_582737 = (int64_t) 0;
            } else {
                bool cond_582738 = sle64(eta_p_582731, f64_res_582735);
                int64_t defunc_0_f_res_f_res_582739;
                
                if (cond_582738) {
                    int64_t defunc_0_f_res_f_res_t_res_583272 = sub64(eta_p_582731, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582739 = defunc_0_f_res_f_res_t_res_583272;
                } else {
                    defunc_0_f_res_f_res_582739 = f64_res_582735;
                }
                defunc_0_f_res_582737 = defunc_0_f_res_f_res_582739;
            }
            ((int64_t *) mem_586571)[i_586104] = defunc_0_f_res_582737;
        }
        
        int64_t defunc_0_foldl_res_582741;
        int64_t acc_582743 = (int64_t) 0;
        
        for (int64_t i_582742 = 0; i_582742 < arg_573366; i_582742++) {
            int64_t b_582744 = ((int64_t *) mem_586571)[i_582742];
            int64_t defunc_0_f_res_582745 = add64(acc_582743, b_582744);
            int64_t acc_tmp_588041 = defunc_0_f_res_582745;
            
            acc_582743 = acc_tmp_588041;
        }
        defunc_0_foldl_res_582741 = acc_582743;
        
        int64_t zp_lhs_582746 = mul64(total_angle_no_366064, defunc_0_foldl_res_582680);
        int64_t get_id_from_grid_angle_res_582747 = add64(defunc_0_foldl_res_582741, zp_lhs_582746);
        bool x_582748 = sle64((int64_t) 0, get_id_from_grid_angle_res_582747);
        bool y_582749 = slt64(get_id_from_grid_angle_res_582747, total_part_no_366066);
        bool bounds_check_582750 = x_582748 && y_582749;
        bool index_certs_582751;
        
        if (!bounds_check_582750) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582747, "] out of bounds for array of shape [", (long long) total_part_no_366066, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582773 = slt64(get_id_from_grid_angle_res_582747, dzlz7bUskBzitotal_part_noz7dUzg_366055);
        bool bounds_check_582774 = x_582748 && y_582773;
        bool index_certs_582775;
        
        if (!bounds_check_582774) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582747, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_366055, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586111 = ((int64_t *) xys_mem_586424.mem)[write_iter_586106];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586537, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586423.mem, write_iter_586106 * dim_366050, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        
        int64_t pref_582752 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582747];
        bool cond_582753 = get_id_from_grid_angle_res_582747 == zeze_rhs_573554;
        int64_t post_582754;
        
        if (cond_582753) {
            int64_t zm_rhs_583276 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582747];
            int64_t post_t_res_583277 = sub64(dz2083U_366053, zm_rhs_583276);
            
            post_582754 = post_t_res_583277;
        } else {
            int64_t zm_lhs_582760 = add64((int64_t) 1, get_id_from_grid_angle_res_582747);
            bool x_582761 = sle64((int64_t) 0, zm_lhs_582760);
            bool y_582762 = slt64(zm_lhs_582760, dzlz7bUskBzitotal_part_noz7dUzg_366055);
            bool bounds_check_582763 = x_582761 && y_582762;
            bool index_certs_582764;
            
            if (!bounds_check_582763) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582760, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_366055, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582765 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582760];
            int64_t zm_rhs_582769 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582747];
            int64_t post_f_res_582770 = sub64(zm_lhs_582765, zm_rhs_582769);
            
            post_582754 = post_f_res_582770;
        }
        
        int64_t zp_lhs_582771 = add64(pref_582752, write_iter_586106);
        int64_t zm_lhs_582772 = add64(post_582754, zp_lhs_582771);
        int64_t zm_rhs_582776 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582747];
        int64_t defunc_0_f_res_582777 = sub64(zm_lhs_582772, zm_rhs_582776);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582777) && slt64(defunc_0_f_res_582777, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_366050 - (int64_t) 1, dim_366050))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586470.mem, defunc_0_f_res_582777 * dim_366050, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586537, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582777) && slt64(defunc_0_f_res_582777, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582777] = write_iv_586111;
        }
    }
    if (mem_586593_cached_sizze_588472 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586593, &mem_586593_cached_sizze_588472, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586595_cached_sizze_588473 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586595, &mem_586595_cached_sizze_588473, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586603_cached_sizze_588474 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588474, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586611_cached_sizze_588475 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586611, &mem_586611_cached_sizze_588475, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586627_cached_sizze_588477 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586627, &mem_586627_cached_sizze_588477, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586130 = 0; write_iter_586130 < dz2083U_366057; write_iter_586130++) {
        for (int64_t i_586116 = 0; i_586116 < dim_366050; i_586116++) {
            double eta_p_583215 = ((double *) xys_mem_586427.mem)[write_iter_586130 * dim_366050 + i_586116];
            double eta_p_583216 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586116];
            double eta_p_583217 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586116];
            int64_t eta_p_583219 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586116];
            double defunc_0_f_res_583220 = eta_p_583215 - eta_p_583216;
            double defunc_0_f_res_583222 = defunc_0_f_res_583220 / eta_p_583217;
            int64_t f64_res_583224 = fptosi_f64_i64(defunc_0_f_res_583222);
            int64_t max_res_583226 = smax64((int64_t) 0, f64_res_583224);
            int64_t zm_lhs_583232 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586116];
            int64_t min_arg1_583233 = sub64(zm_lhs_583232, (int64_t) 1);
            int64_t min_res_583234 = smin64(max_res_583226, min_arg1_583233);
            int64_t defunc_0_f_res_583236 = mul64(eta_p_583219, min_res_583234);
            
            ((int64_t *) mem_586595)[i_586116] = defunc_0_f_res_583236;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_366050; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586595)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588045 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588045;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_366051);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_366051, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586120 = 0; i_586120 < dim_366050; i_586120++) {
            double eta_p_582548 = ((double *) xys_mem_586427.mem)[write_iter_586130 * dim_366050 + i_586120];
            double eta_p_582549 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_366050 + i_586120];
            double defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((double *) mem_586603)[i_586120] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588047 = 0; nest_i_588047 < arg_573366; nest_i_588047++) {
            ((double *) mem_586611)[nest_i_588047] = 0.0;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_573366; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_366050);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_366050, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_366050);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_366050);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_366050, "] out of bounds for array of shape [", (long long) dim_366050, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586615 = (int64_t) 8 * j_m_i_582559;
            double this_x_582557 = ((double *) mem_586603)[i_582553];
            
            if (mem_586616_cached_sizze_588476 < bytes_586615) {
                err = lexical_realloc(ctx, &mem_586616, &mem_586616_cached_sizze_588476, bytes_586615);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586124 = 0; i_586124 < j_m_i_582559; i_586124++) {
                int64_t slice_586362 = map_arg1_582558 + i_586124;
                double eta_p_582574 = ((double *) mem_586603)[slice_586362];
                double defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((double *) mem_586616)[i_586124] = defunc_0_ftimes_res_582575;
            }
            
            double defunc_0_foldl_res_582576;
            double acc_582578 = 0.0;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                double b_582579 = ((double *) mem_586616)[i_582577];
                double defunc_0_f_res_582580 = acc_582578 + b_582579;
                double acc_tmp_588050 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588050;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            double sqrt_res_582581 = futrts_sqrt64(defunc_0_foldl_res_582576);
            double atan2_res_582582 = futrts_atan2_64(sqrt_res_582581, this_x_582557);
            
            ((double *) mem_586611)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586128 = 0; i_586128 < arg_573366; i_586128++) {
            double eta_p_582585 = ((double *) mem_586611)[i_586128];
            double eta_p_582586 = ((double *) mem_586445)[i_586128];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586128];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586128];
            double i64_res_582589 = sitofp_i64_f64(eta_p_582587);
            double defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            double defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f64_res_582592 = fptosi_f64_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f64_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f64_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583284 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583284;
                } else {
                    defunc_0_f_res_f_res_582596 = f64_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586627)[i_586128] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_573366; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586627)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588052 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588052;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_366064, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_366066);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_366066, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582637 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_366055);
        bool bounds_check_582638 = x_582605 && y_582637;
        bool index_certs_582639;
        
        if (!bounds_check_582638) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_366055, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586135 = ((int64_t *) xys_mem_586428.mem)[write_iter_586130];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586593, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586427.mem, write_iter_586130 * dim_366050, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        
        int64_t pref_582609 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_573554;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_583289 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583290 = sub64(zp_lhs_573398, zm_rhs_583289);
            int64_t zm_rhs_583291 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583292 = sub64(zm_lhs_583290, zm_rhs_583291);
            
            post_582611 = post_t_res_583292;
        } else {
            int64_t zp_lhs_582620 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582621 = sle64((int64_t) 0, zp_lhs_582620);
            bool y_582622 = slt64(zp_lhs_582620, dzlz7bUskBzitotal_part_noz7dUzg_366055);
            bool bounds_check_582623 = x_582621 && y_582622;
            bool index_certs_582624;
            
            if (!bounds_check_582623) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582620, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_366055, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:852:17-859:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582625 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582620];
            int64_t zp_rhs_582626 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582620];
            int64_t zm_lhs_582627 = add64(zp_lhs_582625, zp_rhs_582626);
            int64_t zm_rhs_582631 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582632 = sub64(zm_lhs_582627, zm_rhs_582631);
            int64_t zm_rhs_582633 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582634 = sub64(zm_lhs_582632, zm_rhs_582633);
            
            post_582611 = post_f_res_582634;
        }
        
        int64_t zp_lhs_582635 = add64(pref_582609, write_iter_586130);
        int64_t zm_lhs_582636 = add64(post_582611, zp_lhs_582635);
        int64_t zm_rhs_582640 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582641 = sub64(zm_lhs_582636, zm_rhs_582640);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582641) && slt64(defunc_0_f_res_582641, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_366050 - (int64_t) 1, dim_366050))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586470.mem, defunc_0_f_res_582641 * dim_366050, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586593, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_366050});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582641) && slt64(defunc_0_f_res_582641, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582641] = write_iv_586135;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586429, "mem_586429") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586437, "mem_586437") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586470, "mem_586470") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586472, "mem_586472") != 0)
        return 1;
    prim_out_588011 = zp_lhs_573399;
    if (memblock_set(ctx, &*mem_out_p_588452, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588453, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588454, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588455, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588456 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586445);
        free(mem_586447);
        free(mem_586449);
        free(mem_586481);
        free(mem_586483);
        free(mem_586491);
        free(mem_586499);
        free(mem_586504);
        free(mem_586515);
        free(mem_586537);
        free(mem_586539);
        free(mem_586547);
        free(mem_586555);
        free(mem_586560);
        free(mem_586571);
        free(mem_586593);
        free(mem_586595);
        free(mem_586603);
        free(mem_586611);
        free(mem_586616);
        free(mem_586627);
        if (memblock_unref(ctx, &mem_586472, "mem_586472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586470, "mem_586470") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586437, "mem_586437") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586429, "mem_586429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_3_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588478, struct memblock *mem_out_p_588479, struct memblock *mem_out_p_588480, struct memblock *mem_out_p_588481, int64_t *out_prim_out_588482, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, int64_t dim_529835, int64_t dz2080U_529836, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837, int64_t dz2083U_529838, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_529839, int64_t dzlz7bUskBzitotal_part_noz7dUzg_529840, int64_t dz2083U_529841, int64_t dz2083U_529842, int64_t total_angle_no_529849, int64_t total_grid_no_529850, int64_t total_part_no_529851)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586445_cached_sizze_588483 = 0;
    unsigned char *mem_586445 = NULL;
    int64_t mem_586447_cached_sizze_588484 = 0;
    unsigned char *mem_586447 = NULL;
    int64_t mem_586449_cached_sizze_588485 = 0;
    unsigned char *mem_586449 = NULL;
    int64_t mem_586481_cached_sizze_588486 = 0;
    unsigned char *mem_586481 = NULL;
    int64_t mem_586483_cached_sizze_588487 = 0;
    unsigned char *mem_586483 = NULL;
    int64_t mem_586491_cached_sizze_588488 = 0;
    unsigned char *mem_586491 = NULL;
    int64_t mem_586499_cached_sizze_588489 = 0;
    unsigned char *mem_586499 = NULL;
    int64_t mem_586504_cached_sizze_588490 = 0;
    unsigned char *mem_586504 = NULL;
    int64_t mem_586515_cached_sizze_588491 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586537_cached_sizze_588492 = 0;
    unsigned char *mem_586537 = NULL;
    int64_t mem_586539_cached_sizze_588493 = 0;
    unsigned char *mem_586539 = NULL;
    int64_t mem_586547_cached_sizze_588494 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586555_cached_sizze_588495 = 0;
    unsigned char *mem_586555 = NULL;
    int64_t mem_586560_cached_sizze_588496 = 0;
    unsigned char *mem_586560 = NULL;
    int64_t mem_586571_cached_sizze_588497 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586593_cached_sizze_588498 = 0;
    unsigned char *mem_586593 = NULL;
    int64_t mem_586595_cached_sizze_588499 = 0;
    unsigned char *mem_586595 = NULL;
    int64_t mem_586603_cached_sizze_588500 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586611_cached_sizze_588501 = 0;
    unsigned char *mem_586611 = NULL;
    int64_t mem_586616_cached_sizze_588502 = 0;
    unsigned char *mem_586616 = NULL;
    int64_t mem_586627_cached_sizze_588503 = 0;
    unsigned char *mem_586627 = NULL;
    struct memblock mem_586472;
    
    mem_586472.references = NULL;
    
    struct memblock mem_586470;
    
    mem_586470.references = NULL;
    
    struct memblock mem_586437;
    
    mem_586437.references = NULL;
    
    struct memblock mem_586429;
    
    mem_586429.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_573366 = sub64(dim_529835, (int64_t) 1);
    bool assert_cond_t_res_573367 = arg_573366 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837;
    bool assert_c_573368;
    
    if (!assert_cond_t_res_573367) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_573372 = dzlz7bUskBzitotal_grid_noz7dUzg_529839 == total_grid_no_529850;
    bool empty_or_match_cert_573373;
    
    if (!dim_match_573372) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_573375 = dzlz7bUskBzitotal_part_noz7dUzg_529840 == total_part_no_529851;
    bool empty_or_match_cert_573376;
    
    if (!dim_match_573375) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:566:13-21\n   #1  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_573379;
    
    if (!dim_match_573372) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool empty_or_match_cert_573381;
    
    if (!dim_match_573375) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:565:57-67\n   #2  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586436 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_529840;
    int64_t zp_lhs_573398 = add64(dz2083U_529838, dz2083U_529841);
    int64_t zp_lhs_573399 = add64(dz2083U_529842, zp_lhs_573398);
    bool dim_match_573401 = total_part_no_529851 == dzlz7bUskBzitotal_part_noz7dUzg_529840;
    bool empty_or_match_cert_573402;
    
    if (!dim_match_573401) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:565:57-67\n   #3  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_573403 = slt64((int64_t) 0, dz2080U_529836);
    bool index_certs_573404;
    
    if (!y_573403) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_529836, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586444 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837;
    bool empty_or_match_cert_573419;
    
    if (!assert_cond_t_res_573367) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586468 = (int64_t) 4 * zp_lhs_573399;
    int64_t bytes_586469 = dim_529835 * binop_x_586468;
    int64_t bytes_586471 = (int64_t) 8 * zp_lhs_573399;
    int64_t bytes_586480 = (int64_t) 4 * dim_529835;
    int64_t bytes_586482 = (int64_t) 8 * dim_529835;
    int64_t bytes_586498 = (int64_t) 4 * arg_573366;
    int64_t bytes_586514 = (int64_t) 8 * arg_573366;
    
    if (memblock_alloc(ctx, &mem_586429, dzlz7bUskBzitotal_grid_noz7dUzg_529839, "mem_586429")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_529839; i_586050++) {
        bool eta_p_573383 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_573384 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_573385 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool cond_573387 = eta_p_573383 || eta_p_573384;
        bool cond_573388 = eta_p_573385 || cond_573387;
        
        ((bool *) mem_586429.mem)[i_586050] = cond_573388;
    }
    if (memblock_alloc(ctx, &mem_586437, bytes_586436, "mem_586437")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_529840; i_586054++) {
        int64_t eta_p_573391 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_573392 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_573393 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t zp_lhs_573395 = add64(eta_p_573391, eta_p_573392);
        int64_t zp_lhs_573396 = add64(eta_p_573393, zp_lhs_573395);
        
        ((int64_t *) mem_586437.mem)[i_586054] = zp_lhs_573396;
    }
    if (mem_586445_cached_sizze_588483 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586445, &mem_586445_cached_sizze_588483, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586447_cached_sizze_588484 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586447, &mem_586447_cached_sizze_588484, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586449_cached_sizze_588485 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_586449, &mem_586449_cached_sizze_588485, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586062 = 0; i_586062 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837; i_586062++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582923 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586062];
        float i64_res_582924 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582923);
        float defunc_0_fover_res_582925 = 1.5707964F / i64_res_582924;
        
        ((float *) mem_586445)[i_586062] = defunc_0_fover_res_582925;
        ((float *) mem_586447)[i_586062] = defunc_0_fover_res_582925;
        ((float *) mem_586449)[i_586062] = defunc_0_fover_res_582925;
    }
    if (memblock_alloc(ctx, &mem_586470, bytes_586469, "mem_586470")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588017 = 0; nest_i_588017 < zp_lhs_573399; nest_i_588017++) {
        for (int64_t nest_i_588018 = 0; nest_i_588018 < dim_529835; nest_i_588018++) {
            ((float *) mem_586470.mem)[nest_i_588017 * dim_529835 + nest_i_588018] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586472, bytes_586471, "mem_586472")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588019 = 0; nest_i_588019 < zp_lhs_573399; nest_i_588019++) {
        ((int64_t *) mem_586472.mem)[nest_i_588019] = (int64_t) -1;
    }
    if (mem_586481_cached_sizze_588486 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586481, &mem_586481_cached_sizze_588486, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586483_cached_sizze_588487 < bytes_586482) {
        err = lexical_realloc(ctx, &mem_586483, &mem_586483_cached_sizze_588487, bytes_586482);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586491_cached_sizze_588488 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586491, &mem_586491_cached_sizze_588488, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586499_cached_sizze_588489 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586499, &mem_586499_cached_sizze_588489, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586515_cached_sizze_588491 < bytes_586514) {
        err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588491, bytes_586514);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586082 = 0; write_iter_586082 < dz2083U_529838; write_iter_586082++) {
        for (int64_t i_586068 = 0; i_586068 < dim_529835; i_586068++) {
            float eta_p_583009 = ((float *) xys_mem_586419.mem)[write_iter_586082 * dim_529835 + i_586068];
            float eta_p_583010 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586068];
            float eta_p_583011 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586068];
            int64_t eta_p_583013 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586068];
            float defunc_0_f_res_583014 = eta_p_583009 - eta_p_583010;
            float defunc_0_f_res_583016 = defunc_0_f_res_583014 / eta_p_583011;
            int64_t f32_res_583018 = fptosi_f32_i64(defunc_0_f_res_583016);
            int64_t max_res_583020 = smax64((int64_t) 0, f32_res_583018);
            int64_t zm_lhs_583026 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586068];
            int64_t min_arg1_583027 = sub64(zm_lhs_583026, (int64_t) 1);
            int64_t min_res_583028 = smin64(max_res_583020, min_arg1_583027);
            int64_t defunc_0_f_res_583030 = mul64(eta_p_583013, min_res_583028);
            
            ((int64_t *) mem_586483)[i_586068] = defunc_0_f_res_583030;
        }
        
        int64_t defunc_0_foldl_res_582816;
        int64_t acc_582818 = (int64_t) 0;
        
        for (int64_t i_582817 = 0; i_582817 < dim_529835; i_582817++) {
            int64_t b_582819 = ((int64_t *) mem_586483)[i_582817];
            int64_t defunc_0_f_res_582820 = add64(acc_582818, b_582819);
            int64_t acc_tmp_588023 = defunc_0_f_res_582820;
            
            acc_582818 = acc_tmp_588023;
        }
        defunc_0_foldl_res_582816 = acc_582818;
        
        bool x_582821 = sle64((int64_t) 0, defunc_0_foldl_res_582816);
        bool y_582822 = slt64(defunc_0_foldl_res_582816, dz2080U_529836);
        bool bounds_check_582823 = x_582821 && y_582822;
        bool index_certs_582824;
        
        if (!bounds_check_582823) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582816, "] out of bounds for array of shape [", (long long) dz2080U_529836, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586072 = 0; i_586072 < dim_529835; i_586072++) {
            float eta_p_582827 = ((float *) xys_mem_586419.mem)[write_iter_586082 * dim_529835 + i_586072];
            float eta_p_582828 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582816 * dim_529835 + i_586072];
            float defunc_0_f_res_582829 = eta_p_582827 - eta_p_582828;
            
            ((float *) mem_586491)[i_586072] = defunc_0_f_res_582829;
        }
        for (int64_t nest_i_588025 = 0; nest_i_588025 < arg_573366; nest_i_588025++) {
            ((float *) mem_586499)[nest_i_588025] = 0.0F;
        }
        for (int64_t i_582832 = 0; i_582832 < arg_573366; i_582832++) {
            bool y_582834 = slt64(i_582832, dim_529835);
            bool index_certs_582835;
            
            if (!y_582834) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582832, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582837 = add64((int64_t) 1, i_582832);
            int64_t j_m_i_582838 = sub64(dim_529835, map_arg1_582837);
            bool empty_slice_582839 = j_m_i_582838 == (int64_t) 0;
            int64_t m_582840 = sub64(j_m_i_582838, (int64_t) 1);
            int64_t i_p_m_t_s_582841 = add64(map_arg1_582837, m_582840);
            bool zzero_leq_i_p_m_t_s_582842 = sle64((int64_t) 0, i_p_m_t_s_582841);
            bool i_p_m_t_s_leq_w_582843 = slt64(i_p_m_t_s_582841, dim_529835);
            bool zzero_lte_i_582844 = sle64((int64_t) 0, map_arg1_582837);
            bool i_lte_j_582845 = sle64(map_arg1_582837, dim_529835);
            bool y_582846 = i_p_m_t_s_leq_w_582843 && zzero_lte_i_582844;
            bool y_582847 = zzero_leq_i_p_m_t_s_582842 && y_582846;
            bool forwards_ok_582848 = i_lte_j_582845 && y_582847;
            bool ok_or_empty_582849 = empty_slice_582839 || forwards_ok_582848;
            bool index_certs_582850;
            
            if (!ok_or_empty_582849) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582837, ":", (long long) dim_529835, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586503 = (int64_t) 4 * j_m_i_582838;
            float this_x_582836 = ((float *) mem_586491)[i_582832];
            
            if (mem_586504_cached_sizze_588490 < bytes_586503) {
                err = lexical_realloc(ctx, &mem_586504, &mem_586504_cached_sizze_588490, bytes_586503);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586076 = 0; i_586076 < j_m_i_582838; i_586076++) {
                int64_t slice_586372 = map_arg1_582837 + i_586076;
                float eta_p_582853 = ((float *) mem_586491)[slice_586372];
                float defunc_0_ftimes_res_582854 = eta_p_582853 * eta_p_582853;
                
                ((float *) mem_586504)[i_586076] = defunc_0_ftimes_res_582854;
            }
            
            float defunc_0_foldl_res_582855;
            float acc_582857 = 0.0F;
            
            for (int64_t i_582856 = 0; i_582856 < j_m_i_582838; i_582856++) {
                float b_582858 = ((float *) mem_586504)[i_582856];
                float defunc_0_f_res_582859 = acc_582857 + b_582858;
                float acc_tmp_588028 = defunc_0_f_res_582859;
                
                acc_582857 = acc_tmp_588028;
            }
            defunc_0_foldl_res_582855 = acc_582857;
            
            float sqrt_res_582860 = futrts_sqrt32(defunc_0_foldl_res_582855);
            float atan2_res_582861 = futrts_atan2_32(sqrt_res_582860, this_x_582836);
            
            ((float *) mem_586499)[i_582832] = atan2_res_582861;
        }
        for (int64_t i_586080 = 0; i_586080 < arg_573366; i_586080++) {
            float eta_p_582864 = ((float *) mem_586499)[i_586080];
            float eta_p_582865 = ((float *) mem_586449)[i_586080];
            int64_t eta_p_582866 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586080];
            int64_t eta_p_582867 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586080];
            float i64_res_582868 = sitofp_i64_f32(eta_p_582866);
            float defunc_0_fover_res_582869 = eta_p_582864 / eta_p_582865;
            float defunc_0_ftimes_res_582870 = i64_res_582868 * defunc_0_fover_res_582869;
            int64_t f32_res_582871 = fptosi_f32_i64(defunc_0_ftimes_res_582870);
            bool cond_582872 = slt64(f32_res_582871, (int64_t) 0);
            int64_t defunc_0_f_res_582873;
            
            if (cond_582872) {
                defunc_0_f_res_582873 = (int64_t) 0;
            } else {
                bool cond_582874 = sle64(eta_p_582867, f32_res_582871);
                int64_t defunc_0_f_res_f_res_582875;
                
                if (cond_582874) {
                    int64_t defunc_0_f_res_f_res_t_res_583265 = sub64(eta_p_582867, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582875 = defunc_0_f_res_f_res_t_res_583265;
                } else {
                    defunc_0_f_res_f_res_582875 = f32_res_582871;
                }
                defunc_0_f_res_582873 = defunc_0_f_res_f_res_582875;
            }
            ((int64_t *) mem_586515)[i_586080] = defunc_0_f_res_582873;
        }
        
        int64_t defunc_0_foldl_res_582877;
        int64_t acc_582879 = (int64_t) 0;
        
        for (int64_t i_582878 = 0; i_582878 < arg_573366; i_582878++) {
            int64_t b_582880 = ((int64_t *) mem_586515)[i_582878];
            int64_t defunc_0_f_res_582881 = add64(acc_582879, b_582880);
            int64_t acc_tmp_588030 = defunc_0_f_res_582881;
            
            acc_582879 = acc_tmp_588030;
        }
        defunc_0_foldl_res_582877 = acc_582879;
        
        int64_t zp_lhs_582882 = mul64(total_angle_no_529849, defunc_0_foldl_res_582816);
        int64_t get_id_from_grid_angle_res_582883 = add64(defunc_0_foldl_res_582877, zp_lhs_582882);
        bool x_582884 = sle64((int64_t) 0, get_id_from_grid_angle_res_582883);
        bool y_582885 = slt64(get_id_from_grid_angle_res_582883, total_part_no_529851);
        bool bounds_check_582886 = x_582884 && y_582885;
        bool index_certs_582887;
        
        if (!bounds_check_582886) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582883, "] out of bounds for array of shape [", (long long) total_part_no_529851, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582890 = slt64(get_id_from_grid_angle_res_582883, dzlz7bUskBzitotal_part_noz7dUzg_529840);
        bool bounds_check_582891 = x_582884 && y_582890;
        bool index_certs_582892;
        
        if (!bounds_check_582891) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582883, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_529840, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586087 = ((int64_t *) xys_mem_586420.mem)[write_iter_586082];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586481, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, write_iter_586082 * dim_529835, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        
        int64_t pref_582888 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582883];
        int64_t zp_lhs_582889 = add64(pref_582888, write_iter_586082);
        int64_t zm_rhs_582893 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582883];
        int64_t defunc_0_f_res_582894 = sub64(zp_lhs_582889, zm_rhs_582893);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582894) && slt64(defunc_0_f_res_582894, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_529835 - (int64_t) 1, dim_529835))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586470.mem, defunc_0_f_res_582894 * dim_529835, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586481, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582894) && slt64(defunc_0_f_res_582894, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582894] = write_iv_586087;
        }
    }
    
    int64_t zeze_rhs_573554 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_529840, (int64_t) 1);
    
    if (mem_586537_cached_sizze_588492 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586537, &mem_586537_cached_sizze_588492, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586539_cached_sizze_588493 < bytes_586482) {
        err = lexical_realloc(ctx, &mem_586539, &mem_586539_cached_sizze_588493, bytes_586482);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586547_cached_sizze_588494 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_588494, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586555_cached_sizze_588495 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586555, &mem_586555_cached_sizze_588495, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586571_cached_sizze_588497 < bytes_586514) {
        err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588497, bytes_586514);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586106 = 0; write_iter_586106 < dz2083U_529841; write_iter_586106++) {
        for (int64_t i_586092 = 0; i_586092 < dim_529835; i_586092++) {
            float eta_p_583107 = ((float *) xys_mem_586423.mem)[write_iter_586106 * dim_529835 + i_586092];
            float eta_p_583108 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586092];
            float eta_p_583109 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586092];
            int64_t eta_p_583111 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586092];
            float defunc_0_f_res_583112 = eta_p_583107 - eta_p_583108;
            float defunc_0_f_res_583114 = defunc_0_f_res_583112 / eta_p_583109;
            int64_t f32_res_583116 = fptosi_f32_i64(defunc_0_f_res_583114);
            int64_t max_res_583118 = smax64((int64_t) 0, f32_res_583116);
            int64_t zm_lhs_583124 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586092];
            int64_t min_arg1_583125 = sub64(zm_lhs_583124, (int64_t) 1);
            int64_t min_res_583126 = smin64(max_res_583118, min_arg1_583125);
            int64_t defunc_0_f_res_583128 = mul64(eta_p_583111, min_res_583126);
            
            ((int64_t *) mem_586539)[i_586092] = defunc_0_f_res_583128;
        }
        
        int64_t defunc_0_foldl_res_582680;
        int64_t acc_582682 = (int64_t) 0;
        
        for (int64_t i_582681 = 0; i_582681 < dim_529835; i_582681++) {
            int64_t b_582683 = ((int64_t *) mem_586539)[i_582681];
            int64_t defunc_0_f_res_582684 = add64(acc_582682, b_582683);
            int64_t acc_tmp_588034 = defunc_0_f_res_582684;
            
            acc_582682 = acc_tmp_588034;
        }
        defunc_0_foldl_res_582680 = acc_582682;
        
        bool x_582685 = sle64((int64_t) 0, defunc_0_foldl_res_582680);
        bool y_582686 = slt64(defunc_0_foldl_res_582680, dz2080U_529836);
        bool bounds_check_582687 = x_582685 && y_582686;
        bool index_certs_582688;
        
        if (!bounds_check_582687) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582680, "] out of bounds for array of shape [", (long long) dz2080U_529836, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586096 = 0; i_586096 < dim_529835; i_586096++) {
            float eta_p_582691 = ((float *) xys_mem_586423.mem)[write_iter_586106 * dim_529835 + i_586096];
            float eta_p_582692 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582680 * dim_529835 + i_586096];
            float defunc_0_f_res_582693 = eta_p_582691 - eta_p_582692;
            
            ((float *) mem_586547)[i_586096] = defunc_0_f_res_582693;
        }
        for (int64_t nest_i_588036 = 0; nest_i_588036 < arg_573366; nest_i_588036++) {
            ((float *) mem_586555)[nest_i_588036] = 0.0F;
        }
        for (int64_t i_582696 = 0; i_582696 < arg_573366; i_582696++) {
            bool y_582698 = slt64(i_582696, dim_529835);
            bool index_certs_582699;
            
            if (!y_582698) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582696, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582701 = add64((int64_t) 1, i_582696);
            int64_t j_m_i_582702 = sub64(dim_529835, map_arg1_582701);
            bool empty_slice_582703 = j_m_i_582702 == (int64_t) 0;
            int64_t m_582704 = sub64(j_m_i_582702, (int64_t) 1);
            int64_t i_p_m_t_s_582705 = add64(map_arg1_582701, m_582704);
            bool zzero_leq_i_p_m_t_s_582706 = sle64((int64_t) 0, i_p_m_t_s_582705);
            bool i_p_m_t_s_leq_w_582707 = slt64(i_p_m_t_s_582705, dim_529835);
            bool zzero_lte_i_582708 = sle64((int64_t) 0, map_arg1_582701);
            bool i_lte_j_582709 = sle64(map_arg1_582701, dim_529835);
            bool y_582710 = i_p_m_t_s_leq_w_582707 && zzero_lte_i_582708;
            bool y_582711 = zzero_leq_i_p_m_t_s_582706 && y_582710;
            bool forwards_ok_582712 = i_lte_j_582709 && y_582711;
            bool ok_or_empty_582713 = empty_slice_582703 || forwards_ok_582712;
            bool index_certs_582714;
            
            if (!ok_or_empty_582713) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582701, ":", (long long) dim_529835, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586559 = (int64_t) 4 * j_m_i_582702;
            float this_x_582700 = ((float *) mem_586547)[i_582696];
            
            if (mem_586560_cached_sizze_588496 < bytes_586559) {
                err = lexical_realloc(ctx, &mem_586560, &mem_586560_cached_sizze_588496, bytes_586559);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586100 = 0; i_586100 < j_m_i_582702; i_586100++) {
                int64_t slice_586367 = map_arg1_582701 + i_586100;
                float eta_p_582717 = ((float *) mem_586547)[slice_586367];
                float defunc_0_ftimes_res_582718 = eta_p_582717 * eta_p_582717;
                
                ((float *) mem_586560)[i_586100] = defunc_0_ftimes_res_582718;
            }
            
            float defunc_0_foldl_res_582719;
            float acc_582721 = 0.0F;
            
            for (int64_t i_582720 = 0; i_582720 < j_m_i_582702; i_582720++) {
                float b_582722 = ((float *) mem_586560)[i_582720];
                float defunc_0_f_res_582723 = acc_582721 + b_582722;
                float acc_tmp_588039 = defunc_0_f_res_582723;
                
                acc_582721 = acc_tmp_588039;
            }
            defunc_0_foldl_res_582719 = acc_582721;
            
            float sqrt_res_582724 = futrts_sqrt32(defunc_0_foldl_res_582719);
            float atan2_res_582725 = futrts_atan2_32(sqrt_res_582724, this_x_582700);
            
            ((float *) mem_586555)[i_582696] = atan2_res_582725;
        }
        for (int64_t i_586104 = 0; i_586104 < arg_573366; i_586104++) {
            float eta_p_582728 = ((float *) mem_586555)[i_586104];
            float eta_p_582729 = ((float *) mem_586447)[i_586104];
            int64_t eta_p_582730 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586104];
            int64_t eta_p_582731 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586104];
            float i64_res_582732 = sitofp_i64_f32(eta_p_582730);
            float defunc_0_fover_res_582733 = eta_p_582728 / eta_p_582729;
            float defunc_0_ftimes_res_582734 = i64_res_582732 * defunc_0_fover_res_582733;
            int64_t f32_res_582735 = fptosi_f32_i64(defunc_0_ftimes_res_582734);
            bool cond_582736 = slt64(f32_res_582735, (int64_t) 0);
            int64_t defunc_0_f_res_582737;
            
            if (cond_582736) {
                defunc_0_f_res_582737 = (int64_t) 0;
            } else {
                bool cond_582738 = sle64(eta_p_582731, f32_res_582735);
                int64_t defunc_0_f_res_f_res_582739;
                
                if (cond_582738) {
                    int64_t defunc_0_f_res_f_res_t_res_583272 = sub64(eta_p_582731, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582739 = defunc_0_f_res_f_res_t_res_583272;
                } else {
                    defunc_0_f_res_f_res_582739 = f32_res_582735;
                }
                defunc_0_f_res_582737 = defunc_0_f_res_f_res_582739;
            }
            ((int64_t *) mem_586571)[i_586104] = defunc_0_f_res_582737;
        }
        
        int64_t defunc_0_foldl_res_582741;
        int64_t acc_582743 = (int64_t) 0;
        
        for (int64_t i_582742 = 0; i_582742 < arg_573366; i_582742++) {
            int64_t b_582744 = ((int64_t *) mem_586571)[i_582742];
            int64_t defunc_0_f_res_582745 = add64(acc_582743, b_582744);
            int64_t acc_tmp_588041 = defunc_0_f_res_582745;
            
            acc_582743 = acc_tmp_588041;
        }
        defunc_0_foldl_res_582741 = acc_582743;
        
        int64_t zp_lhs_582746 = mul64(total_angle_no_529849, defunc_0_foldl_res_582680);
        int64_t get_id_from_grid_angle_res_582747 = add64(defunc_0_foldl_res_582741, zp_lhs_582746);
        bool x_582748 = sle64((int64_t) 0, get_id_from_grid_angle_res_582747);
        bool y_582749 = slt64(get_id_from_grid_angle_res_582747, total_part_no_529851);
        bool bounds_check_582750 = x_582748 && y_582749;
        bool index_certs_582751;
        
        if (!bounds_check_582750) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582747, "] out of bounds for array of shape [", (long long) total_part_no_529851, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582773 = slt64(get_id_from_grid_angle_res_582747, dzlz7bUskBzitotal_part_noz7dUzg_529840);
        bool bounds_check_582774 = x_582748 && y_582773;
        bool index_certs_582775;
        
        if (!bounds_check_582774) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582747, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_529840, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586111 = ((int64_t *) xys_mem_586424.mem)[write_iter_586106];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586537, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586423.mem, write_iter_586106 * dim_529835, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        
        int64_t pref_582752 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582747];
        bool cond_582753 = get_id_from_grid_angle_res_582747 == zeze_rhs_573554;
        int64_t post_582754;
        
        if (cond_582753) {
            int64_t zm_rhs_583276 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582747];
            int64_t post_t_res_583277 = sub64(dz2083U_529838, zm_rhs_583276);
            
            post_582754 = post_t_res_583277;
        } else {
            int64_t zm_lhs_582760 = add64((int64_t) 1, get_id_from_grid_angle_res_582747);
            bool x_582761 = sle64((int64_t) 0, zm_lhs_582760);
            bool y_582762 = slt64(zm_lhs_582760, dzlz7bUskBzitotal_part_noz7dUzg_529840);
            bool bounds_check_582763 = x_582761 && y_582762;
            bool index_certs_582764;
            
            if (!bounds_check_582763) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582760, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_529840, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582765 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582760];
            int64_t zm_rhs_582769 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582747];
            int64_t post_f_res_582770 = sub64(zm_lhs_582765, zm_rhs_582769);
            
            post_582754 = post_f_res_582770;
        }
        
        int64_t zp_lhs_582771 = add64(pref_582752, write_iter_586106);
        int64_t zm_lhs_582772 = add64(post_582754, zp_lhs_582771);
        int64_t zm_rhs_582776 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582747];
        int64_t defunc_0_f_res_582777 = sub64(zm_lhs_582772, zm_rhs_582776);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582777) && slt64(defunc_0_f_res_582777, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_529835 - (int64_t) 1, dim_529835))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586470.mem, defunc_0_f_res_582777 * dim_529835, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586537, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582777) && slt64(defunc_0_f_res_582777, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582777] = write_iv_586111;
        }
    }
    if (mem_586593_cached_sizze_588498 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586593, &mem_586593_cached_sizze_588498, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586595_cached_sizze_588499 < bytes_586482) {
        err = lexical_realloc(ctx, &mem_586595, &mem_586595_cached_sizze_588499, bytes_586482);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586603_cached_sizze_588500 < bytes_586480) {
        err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588500, bytes_586480);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586611_cached_sizze_588501 < bytes_586498) {
        err = lexical_realloc(ctx, &mem_586611, &mem_586611_cached_sizze_588501, bytes_586498);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586627_cached_sizze_588503 < bytes_586514) {
        err = lexical_realloc(ctx, &mem_586627, &mem_586627_cached_sizze_588503, bytes_586514);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586130 = 0; write_iter_586130 < dz2083U_529842; write_iter_586130++) {
        for (int64_t i_586116 = 0; i_586116 < dim_529835; i_586116++) {
            float eta_p_583215 = ((float *) xys_mem_586427.mem)[write_iter_586130 * dim_529835 + i_586116];
            float eta_p_583216 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586116];
            float eta_p_583217 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586116];
            int64_t eta_p_583219 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586116];
            float defunc_0_f_res_583220 = eta_p_583215 - eta_p_583216;
            float defunc_0_f_res_583222 = defunc_0_f_res_583220 / eta_p_583217;
            int64_t f32_res_583224 = fptosi_f32_i64(defunc_0_f_res_583222);
            int64_t max_res_583226 = smax64((int64_t) 0, f32_res_583224);
            int64_t zm_lhs_583232 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586116];
            int64_t min_arg1_583233 = sub64(zm_lhs_583232, (int64_t) 1);
            int64_t min_res_583234 = smin64(max_res_583226, min_arg1_583233);
            int64_t defunc_0_f_res_583236 = mul64(eta_p_583219, min_res_583234);
            
            ((int64_t *) mem_586595)[i_586116] = defunc_0_f_res_583236;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_529835; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586595)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588045 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588045;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_529836);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_529836, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586120 = 0; i_586120 < dim_529835; i_586120++) {
            float eta_p_582548 = ((float *) xys_mem_586427.mem)[write_iter_586130 * dim_529835 + i_586120];
            float eta_p_582549 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_529835 + i_586120];
            float defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((float *) mem_586603)[i_586120] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588047 = 0; nest_i_588047 < arg_573366; nest_i_588047++) {
            ((float *) mem_586611)[nest_i_588047] = 0.0F;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_573366; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_529835);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_529835, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_529835);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_529835);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_529835, "] out of bounds for array of shape [", (long long) dim_529835, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:565:57-67\n   #6  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586615 = (int64_t) 4 * j_m_i_582559;
            float this_x_582557 = ((float *) mem_586603)[i_582553];
            
            if (mem_586616_cached_sizze_588502 < bytes_586615) {
                err = lexical_realloc(ctx, &mem_586616, &mem_586616_cached_sizze_588502, bytes_586615);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586124 = 0; i_586124 < j_m_i_582559; i_586124++) {
                int64_t slice_586362 = map_arg1_582558 + i_586124;
                float eta_p_582574 = ((float *) mem_586603)[slice_586362];
                float defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((float *) mem_586616)[i_586124] = defunc_0_ftimes_res_582575;
            }
            
            float defunc_0_foldl_res_582576;
            float acc_582578 = 0.0F;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                float b_582579 = ((float *) mem_586616)[i_582577];
                float defunc_0_f_res_582580 = acc_582578 + b_582579;
                float acc_tmp_588050 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588050;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            float sqrt_res_582581 = futrts_sqrt32(defunc_0_foldl_res_582576);
            float atan2_res_582582 = futrts_atan2_32(sqrt_res_582581, this_x_582557);
            
            ((float *) mem_586611)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586128 = 0; i_586128 < arg_573366; i_586128++) {
            float eta_p_582585 = ((float *) mem_586611)[i_586128];
            float eta_p_582586 = ((float *) mem_586445)[i_586128];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586128];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586128];
            float i64_res_582589 = sitofp_i64_f32(eta_p_582587);
            float defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            float defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f32_res_582592 = fptosi_f32_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f32_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f32_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583284 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583284;
                } else {
                    defunc_0_f_res_f_res_582596 = f32_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586627)[i_586128] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_573366; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586627)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588052 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588052;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_529849, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_529851);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_529851, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582637 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_529840);
        bool bounds_check_582638 = x_582605 && y_582637;
        bool index_certs_582639;
        
        if (!bounds_check_582638) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_529840, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586135 = ((int64_t *) xys_mem_586428.mem)[write_iter_586130];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586593, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586427.mem, write_iter_586130 * dim_529835, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        
        int64_t pref_582609 = ((int64_t *) mem_586437.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_573554;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_583289 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583290 = sub64(zp_lhs_573398, zm_rhs_583289);
            int64_t zm_rhs_583291 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583292 = sub64(zm_lhs_583290, zm_rhs_583291);
            
            post_582611 = post_t_res_583292;
        } else {
            int64_t zp_lhs_582620 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582621 = sle64((int64_t) 0, zp_lhs_582620);
            bool y_582622 = slt64(zp_lhs_582620, dzlz7bUskBzitotal_part_noz7dUzg_529840);
            bool bounds_check_582623 = x_582621 && y_582622;
            bool index_certs_582624;
            
            if (!bounds_check_582623) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582620, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_529840, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:565:57-67\n   #4  ftSkyline.fut:999:17-1006:85\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582625 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582620];
            int64_t zp_rhs_582626 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582620];
            int64_t zm_lhs_582627 = add64(zp_lhs_582625, zp_rhs_582626);
            int64_t zm_rhs_582631 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582632 = sub64(zm_lhs_582627, zm_rhs_582631);
            int64_t zm_rhs_582633 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582634 = sub64(zm_lhs_582632, zm_rhs_582633);
            
            post_582611 = post_f_res_582634;
        }
        
        int64_t zp_lhs_582635 = add64(pref_582609, write_iter_586130);
        int64_t zm_lhs_582636 = add64(post_582611, zp_lhs_582635);
        int64_t zm_rhs_582640 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582641 = sub64(zm_lhs_582636, zm_rhs_582640);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582641) && slt64(defunc_0_f_res_582641, zp_lhs_573399)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_529835 - (int64_t) 1, dim_529835))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586470.mem, defunc_0_f_res_582641 * dim_529835, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586593, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_529835});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582641) && slt64(defunc_0_f_res_582641, zp_lhs_573399)) {
            ((int64_t *) mem_586472.mem)[defunc_0_f_res_582641] = write_iv_586135;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586429, "mem_586429") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586437, "mem_586437") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586470, "mem_586470") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586472, "mem_586472") != 0)
        return 1;
    prim_out_588011 = zp_lhs_573399;
    if (memblock_set(ctx, &*mem_out_p_588478, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588479, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588480, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588481, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588482 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586445);
        free(mem_586447);
        free(mem_586449);
        free(mem_586481);
        free(mem_586483);
        free(mem_586491);
        free(mem_586499);
        free(mem_586504);
        free(mem_586515);
        free(mem_586537);
        free(mem_586539);
        free(mem_586547);
        free(mem_586555);
        free(mem_586560);
        free(mem_586571);
        free(mem_586593);
        free(mem_586595);
        free(mem_586603);
        free(mem_586611);
        free(mem_586616);
        free(mem_586627);
        if (memblock_unref(ctx, &mem_586472, "mem_586472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586470, "mem_586470") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586437, "mem_586437") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586429, "mem_586429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_4_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588504, struct memblock *mem_out_p_588505, struct memblock *mem_out_p_588506, struct memblock *mem_out_p_588507, int64_t *out_prim_out_588508, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, int64_t dim_345683, int64_t dz2080U_345684, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685, int64_t dz2083U_345686, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_345687, int64_t dzlz7bUskBzitotal_part_noz7dUzg_345688, int64_t dz2083U_345689, int64_t dz2083U_345690, int64_t dz2083U_345691, int64_t total_angle_no_345698, int64_t total_grid_no_345699, int64_t total_part_no_345700)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586449_cached_sizze_588509 = 0;
    unsigned char *mem_586449 = NULL;
    int64_t mem_586451_cached_sizze_588510 = 0;
    unsigned char *mem_586451 = NULL;
    int64_t mem_586453_cached_sizze_588511 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_588512 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586493_cached_sizze_588513 = 0;
    unsigned char *mem_586493 = NULL;
    int64_t mem_586495_cached_sizze_588514 = 0;
    unsigned char *mem_586495 = NULL;
    int64_t mem_586503_cached_sizze_588515 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586511_cached_sizze_588516 = 0;
    unsigned char *mem_586511 = NULL;
    int64_t mem_586516_cached_sizze_588517 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586527_cached_sizze_588518 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586549_cached_sizze_588519 = 0;
    unsigned char *mem_586549 = NULL;
    int64_t mem_586551_cached_sizze_588520 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586559_cached_sizze_588521 = 0;
    unsigned char *mem_586559 = NULL;
    int64_t mem_586567_cached_sizze_588522 = 0;
    unsigned char *mem_586567 = NULL;
    int64_t mem_586572_cached_sizze_588523 = 0;
    unsigned char *mem_586572 = NULL;
    int64_t mem_586583_cached_sizze_588524 = 0;
    unsigned char *mem_586583 = NULL;
    int64_t mem_586605_cached_sizze_588525 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586607_cached_sizze_588526 = 0;
    unsigned char *mem_586607 = NULL;
    int64_t mem_586615_cached_sizze_588527 = 0;
    unsigned char *mem_586615 = NULL;
    int64_t mem_586623_cached_sizze_588528 = 0;
    unsigned char *mem_586623 = NULL;
    int64_t mem_586628_cached_sizze_588529 = 0;
    unsigned char *mem_586628 = NULL;
    int64_t mem_586639_cached_sizze_588530 = 0;
    unsigned char *mem_586639 = NULL;
    int64_t mem_586661_cached_sizze_588531 = 0;
    unsigned char *mem_586661 = NULL;
    int64_t mem_586663_cached_sizze_588532 = 0;
    unsigned char *mem_586663 = NULL;
    int64_t mem_586671_cached_sizze_588533 = 0;
    unsigned char *mem_586671 = NULL;
    int64_t mem_586679_cached_sizze_588534 = 0;
    unsigned char *mem_586679 = NULL;
    int64_t mem_586684_cached_sizze_588535 = 0;
    unsigned char *mem_586684 = NULL;
    int64_t mem_586695_cached_sizze_588536 = 0;
    unsigned char *mem_586695 = NULL;
    struct memblock mem_586484;
    
    mem_586484.references = NULL;
    
    struct memblock mem_586482;
    
    mem_586482.references = NULL;
    
    struct memblock mem_586441;
    
    mem_586441.references = NULL;
    
    struct memblock mem_586433;
    
    mem_586433.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_572699 = sub64(dim_345683, (int64_t) 1);
    bool assert_cond_t_res_572700 = arg_572699 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685;
    bool assert_c_572701;
    
    if (!assert_cond_t_res_572700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_572703 = dzlz7bUskBzitotal_grid_noz7dUzg_345687 == total_grid_no_345699;
    bool empty_or_match_cert_572704;
    
    if (!dim_match_572703) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_572705 = dzlz7bUskBzitotal_part_noz7dUzg_345688 == total_part_no_345700;
    bool empty_or_match_cert_572706;
    
    if (!dim_match_572705) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586440 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_345688;
    int64_t zp_lhs_572723 = add64(dz2083U_345686, dz2083U_345689);
    int64_t zp_lhs_572724 = add64(dz2083U_345690, zp_lhs_572723);
    int64_t zp_lhs_572725 = add64(dz2083U_345691, zp_lhs_572724);
    bool dim_match_572727 = total_part_no_345700 == dzlz7bUskBzitotal_part_noz7dUzg_345688;
    bool empty_or_match_cert_572728;
    
    if (!dim_match_572727) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_572729 = slt64((int64_t) 0, dz2080U_345684);
    bool index_certs_572730;
    
    if (!y_572729) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_345684, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586448 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685;
    bool empty_or_match_cert_572745;
    
    if (!assert_cond_t_res_572700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586480 = (int64_t) 8 * zp_lhs_572725;
    int64_t bytes_586481 = dim_345683 * binop_x_586480;
    int64_t bytes_586492 = (int64_t) 8 * dim_345683;
    int64_t bytes_586510 = (int64_t) 8 * arg_572699;
    
    if (memblock_alloc(ctx, &mem_586433, dzlz7bUskBzitotal_grid_noz7dUzg_345687, "mem_586433")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_345687; i_586050++) {
        bool eta_p_572708 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_572709 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_572710 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool eta_p_572711 = ((bool *) isPartitionDominated_mem_586429.mem)[i_586050];
        bool cond_572712 = eta_p_572708 || eta_p_572709;
        bool cond_572713 = eta_p_572710 || cond_572712;
        bool cond_572714 = eta_p_572711 || cond_572713;
        
        ((bool *) mem_586433.mem)[i_586050] = cond_572714;
    }
    if (memblock_alloc(ctx, &mem_586441, bytes_586440, "mem_586441")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_345688; i_586054++) {
        int64_t eta_p_572716 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_572717 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_572718 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t eta_p_572719 = ((int64_t *) part_idx_mem_586430.mem)[i_586054];
        int64_t zp_lhs_572720 = add64(eta_p_572716, eta_p_572717);
        int64_t zp_lhs_572721 = add64(eta_p_572718, zp_lhs_572720);
        int64_t zp_lhs_572722 = add64(eta_p_572719, zp_lhs_572721);
        
        ((int64_t *) mem_586441.mem)[i_586054] = zp_lhs_572722;
    }
    if (mem_586449_cached_sizze_588509 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586449, &mem_586449_cached_sizze_588509, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586451_cached_sizze_588510 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586451, &mem_586451_cached_sizze_588510, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586453_cached_sizze_588511 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588511, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586455_cached_sizze_588512 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_588512, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586064 = 0; i_586064 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685; i_586064++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583104 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586064];
        double i64_res_583105 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583104);
        double defunc_0_fover_res_583106 = 1.5707963267948966 / i64_res_583105;
        
        ((double *) mem_586449)[i_586064] = defunc_0_fover_res_583106;
        ((double *) mem_586451)[i_586064] = defunc_0_fover_res_583106;
        ((double *) mem_586453)[i_586064] = defunc_0_fover_res_583106;
        ((double *) mem_586455)[i_586064] = defunc_0_fover_res_583106;
    }
    if (memblock_alloc(ctx, &mem_586482, bytes_586481, "mem_586482")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588018 = 0; nest_i_588018 < zp_lhs_572725; nest_i_588018++) {
        for (int64_t nest_i_588019 = 0; nest_i_588019 < dim_345683; nest_i_588019++) {
            ((double *) mem_586482.mem)[nest_i_588018 * dim_345683 + nest_i_588019] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586484, binop_x_586480, "mem_586484")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588020 = 0; nest_i_588020 < zp_lhs_572725; nest_i_588020++) {
        ((int64_t *) mem_586484.mem)[nest_i_588020] = (int64_t) -1;
    }
    if (mem_586493_cached_sizze_588513 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586493, &mem_586493_cached_sizze_588513, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586495_cached_sizze_588514 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586495, &mem_586495_cached_sizze_588514, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586503_cached_sizze_588515 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588515, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586511_cached_sizze_588516 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586511, &mem_586511_cached_sizze_588516, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586527_cached_sizze_588518 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588518, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586085 = 0; write_iter_586085 < dz2083U_345686; write_iter_586085++) {
        for (int64_t i_586071 = 0; i_586071 < dim_345683; i_586071++) {
            double eta_p_583200 = ((double *) xys_mem_586419.mem)[write_iter_586085 * dim_345683 + i_586071];
            double eta_p_583201 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586071];
            double eta_p_583202 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586071];
            int64_t eta_p_583204 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586071];
            double defunc_0_f_res_583205 = eta_p_583200 - eta_p_583201;
            double defunc_0_f_res_583207 = defunc_0_f_res_583205 / eta_p_583202;
            int64_t f64_res_583209 = fptosi_f64_i64(defunc_0_f_res_583207);
            int64_t max_res_583211 = smax64((int64_t) 0, f64_res_583209);
            int64_t zm_lhs_583217 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586071];
            int64_t min_arg1_583218 = sub64(zm_lhs_583217, (int64_t) 1);
            int64_t min_res_583219 = smin64(max_res_583211, min_arg1_583218);
            int64_t defunc_0_f_res_583221 = mul64(eta_p_583204, min_res_583219);
            
            ((int64_t *) mem_586495)[i_586071] = defunc_0_f_res_583221;
        }
        
        int64_t defunc_0_foldl_res_582966;
        int64_t acc_582968 = (int64_t) 0;
        
        for (int64_t i_582967 = 0; i_582967 < dim_345683; i_582967++) {
            int64_t b_582969 = ((int64_t *) mem_586495)[i_582967];
            int64_t defunc_0_f_res_582970 = add64(acc_582968, b_582969);
            int64_t acc_tmp_588024 = defunc_0_f_res_582970;
            
            acc_582968 = acc_tmp_588024;
        }
        defunc_0_foldl_res_582966 = acc_582968;
        
        bool x_582971 = sle64((int64_t) 0, defunc_0_foldl_res_582966);
        bool y_582972 = slt64(defunc_0_foldl_res_582966, dz2080U_345684);
        bool bounds_check_582973 = x_582971 && y_582972;
        bool index_certs_582974;
        
        if (!bounds_check_582973) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582966, "] out of bounds for array of shape [", (long long) dz2080U_345684, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586075 = 0; i_586075 < dim_345683; i_586075++) {
            double eta_p_582977 = ((double *) xys_mem_586419.mem)[write_iter_586085 * dim_345683 + i_586075];
            double eta_p_582978 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582966 * dim_345683 + i_586075];
            double defunc_0_f_res_582979 = eta_p_582977 - eta_p_582978;
            
            ((double *) mem_586503)[i_586075] = defunc_0_f_res_582979;
        }
        for (int64_t nest_i_588026 = 0; nest_i_588026 < arg_572699; nest_i_588026++) {
            ((double *) mem_586511)[nest_i_588026] = 0.0;
        }
        for (int64_t i_582982 = 0; i_582982 < arg_572699; i_582982++) {
            bool y_582984 = slt64(i_582982, dim_345683);
            bool index_certs_582985;
            
            if (!y_582984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582982, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582987 = add64((int64_t) 1, i_582982);
            int64_t j_m_i_582988 = sub64(dim_345683, map_arg1_582987);
            bool empty_slice_582989 = j_m_i_582988 == (int64_t) 0;
            int64_t m_582990 = sub64(j_m_i_582988, (int64_t) 1);
            int64_t i_p_m_t_s_582991 = add64(map_arg1_582987, m_582990);
            bool zzero_leq_i_p_m_t_s_582992 = sle64((int64_t) 0, i_p_m_t_s_582991);
            bool i_p_m_t_s_leq_w_582993 = slt64(i_p_m_t_s_582991, dim_345683);
            bool zzero_lte_i_582994 = sle64((int64_t) 0, map_arg1_582987);
            bool i_lte_j_582995 = sle64(map_arg1_582987, dim_345683);
            bool y_582996 = i_p_m_t_s_leq_w_582993 && zzero_lte_i_582994;
            bool y_582997 = zzero_leq_i_p_m_t_s_582992 && y_582996;
            bool forwards_ok_582998 = i_lte_j_582995 && y_582997;
            bool ok_or_empty_582999 = empty_slice_582989 || forwards_ok_582998;
            bool index_certs_583000;
            
            if (!ok_or_empty_582999) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582987, ":", (long long) dim_345683, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586515 = (int64_t) 8 * j_m_i_582988;
            double this_x_582986 = ((double *) mem_586503)[i_582982];
            
            if (mem_586516_cached_sizze_588517 < bytes_586515) {
                err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588517, bytes_586515);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586079 = 0; i_586079 < j_m_i_582988; i_586079++) {
                int64_t slice_586377 = map_arg1_582987 + i_586079;
                double eta_p_583003 = ((double *) mem_586503)[slice_586377];
                double defunc_0_ftimes_res_583004 = eta_p_583003 * eta_p_583003;
                
                ((double *) mem_586516)[i_586079] = defunc_0_ftimes_res_583004;
            }
            
            double defunc_0_foldl_res_583005;
            double acc_583007 = 0.0;
            
            for (int64_t i_583006 = 0; i_583006 < j_m_i_582988; i_583006++) {
                double b_583008 = ((double *) mem_586516)[i_583006];
                double defunc_0_f_res_583009 = acc_583007 + b_583008;
                double acc_tmp_588029 = defunc_0_f_res_583009;
                
                acc_583007 = acc_tmp_588029;
            }
            defunc_0_foldl_res_583005 = acc_583007;
            
            double sqrt_res_583010 = futrts_sqrt64(defunc_0_foldl_res_583005);
            double atan2_res_583011 = futrts_atan2_64(sqrt_res_583010, this_x_582986);
            
            ((double *) mem_586511)[i_582982] = atan2_res_583011;
        }
        for (int64_t i_586083 = 0; i_586083 < arg_572699; i_586083++) {
            double eta_p_583014 = ((double *) mem_586511)[i_586083];
            double eta_p_583015 = ((double *) mem_586455)[i_586083];
            int64_t eta_p_583016 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586083];
            int64_t eta_p_583017 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586083];
            double i64_res_583018 = sitofp_i64_f64(eta_p_583016);
            double defunc_0_fover_res_583019 = eta_p_583014 / eta_p_583015;
            double defunc_0_ftimes_res_583020 = i64_res_583018 * defunc_0_fover_res_583019;
            int64_t f64_res_583021 = fptosi_f64_i64(defunc_0_ftimes_res_583020);
            bool cond_583022 = slt64(f64_res_583021, (int64_t) 0);
            int64_t defunc_0_f_res_583023;
            
            if (cond_583022) {
                defunc_0_f_res_583023 = (int64_t) 0;
            } else {
                bool cond_583024 = sle64(eta_p_583017, f64_res_583021);
                int64_t defunc_0_f_res_f_res_583025;
                
                if (cond_583024) {
                    int64_t defunc_0_f_res_f_res_t_res_583576 = sub64(eta_p_583017, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583025 = defunc_0_f_res_f_res_t_res_583576;
                } else {
                    defunc_0_f_res_f_res_583025 = f64_res_583021;
                }
                defunc_0_f_res_583023 = defunc_0_f_res_f_res_583025;
            }
            ((int64_t *) mem_586527)[i_586083] = defunc_0_f_res_583023;
        }
        
        int64_t defunc_0_foldl_res_583027;
        int64_t acc_583029 = (int64_t) 0;
        
        for (int64_t i_583028 = 0; i_583028 < arg_572699; i_583028++) {
            int64_t b_583030 = ((int64_t *) mem_586527)[i_583028];
            int64_t defunc_0_f_res_583031 = add64(acc_583029, b_583030);
            int64_t acc_tmp_588031 = defunc_0_f_res_583031;
            
            acc_583029 = acc_tmp_588031;
        }
        defunc_0_foldl_res_583027 = acc_583029;
        
        int64_t zp_lhs_583032 = mul64(total_angle_no_345698, defunc_0_foldl_res_582966);
        int64_t get_id_from_grid_angle_res_583033 = add64(defunc_0_foldl_res_583027, zp_lhs_583032);
        bool x_583034 = sle64((int64_t) 0, get_id_from_grid_angle_res_583033);
        bool y_583035 = slt64(get_id_from_grid_angle_res_583033, total_part_no_345700);
        bool bounds_check_583036 = x_583034 && y_583035;
        bool index_certs_583037;
        
        if (!bounds_check_583036) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583033, "] out of bounds for array of shape [", (long long) total_part_no_345700, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583040 = slt64(get_id_from_grid_angle_res_583033, dzlz7bUskBzitotal_part_noz7dUzg_345688);
        bool bounds_check_583041 = x_583034 && y_583040;
        bool index_certs_583042;
        
        if (!bounds_check_583041) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583033, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586090 = ((int64_t *) xys_mem_586420.mem)[write_iter_586085];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586493, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, write_iter_586085 * dim_345683, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        
        int64_t pref_583038 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_583033];
        int64_t zp_lhs_583039 = add64(pref_583038, write_iter_586085);
        int64_t zm_rhs_583043 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583033];
        int64_t defunc_0_f_res_583044 = sub64(zp_lhs_583039, zm_rhs_583043);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583044) && slt64(defunc_0_f_res_583044, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_345683 - (int64_t) 1, dim_345683))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586482.mem, defunc_0_f_res_583044 * dim_345683, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586493, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583044) && slt64(defunc_0_f_res_583044, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_583044] = write_iv_586090;
        }
    }
    
    int64_t zeze_rhs_572880 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_345688, (int64_t) 1);
    
    if (mem_586549_cached_sizze_588519 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586549, &mem_586549_cached_sizze_588519, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586551_cached_sizze_588520 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588520, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586559_cached_sizze_588521 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588521, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586567_cached_sizze_588522 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586567, &mem_586567_cached_sizze_588522, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586583_cached_sizze_588524 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586583, &mem_586583_cached_sizze_588524, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586109 = 0; write_iter_586109 < dz2083U_345689; write_iter_586109++) {
        for (int64_t i_586095 = 0; i_586095 < dim_345683; i_586095++) {
            double eta_p_583298 = ((double *) xys_mem_586423.mem)[write_iter_586109 * dim_345683 + i_586095];
            double eta_p_583299 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586095];
            double eta_p_583300 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586095];
            int64_t eta_p_583302 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586095];
            double defunc_0_f_res_583303 = eta_p_583298 - eta_p_583299;
            double defunc_0_f_res_583305 = defunc_0_f_res_583303 / eta_p_583300;
            int64_t f64_res_583307 = fptosi_f64_i64(defunc_0_f_res_583305);
            int64_t max_res_583309 = smax64((int64_t) 0, f64_res_583307);
            int64_t zm_lhs_583315 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586095];
            int64_t min_arg1_583316 = sub64(zm_lhs_583315, (int64_t) 1);
            int64_t min_res_583317 = smin64(max_res_583309, min_arg1_583316);
            int64_t defunc_0_f_res_583319 = mul64(eta_p_583302, min_res_583317);
            
            ((int64_t *) mem_586551)[i_586095] = defunc_0_f_res_583319;
        }
        
        int64_t defunc_0_foldl_res_582830;
        int64_t acc_582832 = (int64_t) 0;
        
        for (int64_t i_582831 = 0; i_582831 < dim_345683; i_582831++) {
            int64_t b_582833 = ((int64_t *) mem_586551)[i_582831];
            int64_t defunc_0_f_res_582834 = add64(acc_582832, b_582833);
            int64_t acc_tmp_588035 = defunc_0_f_res_582834;
            
            acc_582832 = acc_tmp_588035;
        }
        defunc_0_foldl_res_582830 = acc_582832;
        
        bool x_582835 = sle64((int64_t) 0, defunc_0_foldl_res_582830);
        bool y_582836 = slt64(defunc_0_foldl_res_582830, dz2080U_345684);
        bool bounds_check_582837 = x_582835 && y_582836;
        bool index_certs_582838;
        
        if (!bounds_check_582837) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582830, "] out of bounds for array of shape [", (long long) dz2080U_345684, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586099 = 0; i_586099 < dim_345683; i_586099++) {
            double eta_p_582841 = ((double *) xys_mem_586423.mem)[write_iter_586109 * dim_345683 + i_586099];
            double eta_p_582842 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582830 * dim_345683 + i_586099];
            double defunc_0_f_res_582843 = eta_p_582841 - eta_p_582842;
            
            ((double *) mem_586559)[i_586099] = defunc_0_f_res_582843;
        }
        for (int64_t nest_i_588037 = 0; nest_i_588037 < arg_572699; nest_i_588037++) {
            ((double *) mem_586567)[nest_i_588037] = 0.0;
        }
        for (int64_t i_582846 = 0; i_582846 < arg_572699; i_582846++) {
            bool y_582848 = slt64(i_582846, dim_345683);
            bool index_certs_582849;
            
            if (!y_582848) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582846, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582851 = add64((int64_t) 1, i_582846);
            int64_t j_m_i_582852 = sub64(dim_345683, map_arg1_582851);
            bool empty_slice_582853 = j_m_i_582852 == (int64_t) 0;
            int64_t m_582854 = sub64(j_m_i_582852, (int64_t) 1);
            int64_t i_p_m_t_s_582855 = add64(map_arg1_582851, m_582854);
            bool zzero_leq_i_p_m_t_s_582856 = sle64((int64_t) 0, i_p_m_t_s_582855);
            bool i_p_m_t_s_leq_w_582857 = slt64(i_p_m_t_s_582855, dim_345683);
            bool zzero_lte_i_582858 = sle64((int64_t) 0, map_arg1_582851);
            bool i_lte_j_582859 = sle64(map_arg1_582851, dim_345683);
            bool y_582860 = i_p_m_t_s_leq_w_582857 && zzero_lte_i_582858;
            bool y_582861 = zzero_leq_i_p_m_t_s_582856 && y_582860;
            bool forwards_ok_582862 = i_lte_j_582859 && y_582861;
            bool ok_or_empty_582863 = empty_slice_582853 || forwards_ok_582862;
            bool index_certs_582864;
            
            if (!ok_or_empty_582863) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582851, ":", (long long) dim_345683, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586571 = (int64_t) 8 * j_m_i_582852;
            double this_x_582850 = ((double *) mem_586559)[i_582846];
            
            if (mem_586572_cached_sizze_588523 < bytes_586571) {
                err = lexical_realloc(ctx, &mem_586572, &mem_586572_cached_sizze_588523, bytes_586571);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586103 = 0; i_586103 < j_m_i_582852; i_586103++) {
                int64_t slice_586372 = map_arg1_582851 + i_586103;
                double eta_p_582867 = ((double *) mem_586559)[slice_586372];
                double defunc_0_ftimes_res_582868 = eta_p_582867 * eta_p_582867;
                
                ((double *) mem_586572)[i_586103] = defunc_0_ftimes_res_582868;
            }
            
            double defunc_0_foldl_res_582869;
            double acc_582871 = 0.0;
            
            for (int64_t i_582870 = 0; i_582870 < j_m_i_582852; i_582870++) {
                double b_582872 = ((double *) mem_586572)[i_582870];
                double defunc_0_f_res_582873 = acc_582871 + b_582872;
                double acc_tmp_588040 = defunc_0_f_res_582873;
                
                acc_582871 = acc_tmp_588040;
            }
            defunc_0_foldl_res_582869 = acc_582871;
            
            double sqrt_res_582874 = futrts_sqrt64(defunc_0_foldl_res_582869);
            double atan2_res_582875 = futrts_atan2_64(sqrt_res_582874, this_x_582850);
            
            ((double *) mem_586567)[i_582846] = atan2_res_582875;
        }
        for (int64_t i_586107 = 0; i_586107 < arg_572699; i_586107++) {
            double eta_p_582878 = ((double *) mem_586567)[i_586107];
            double eta_p_582879 = ((double *) mem_586453)[i_586107];
            int64_t eta_p_582880 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586107];
            int64_t eta_p_582881 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586107];
            double i64_res_582882 = sitofp_i64_f64(eta_p_582880);
            double defunc_0_fover_res_582883 = eta_p_582878 / eta_p_582879;
            double defunc_0_ftimes_res_582884 = i64_res_582882 * defunc_0_fover_res_582883;
            int64_t f64_res_582885 = fptosi_f64_i64(defunc_0_ftimes_res_582884);
            bool cond_582886 = slt64(f64_res_582885, (int64_t) 0);
            int64_t defunc_0_f_res_582887;
            
            if (cond_582886) {
                defunc_0_f_res_582887 = (int64_t) 0;
            } else {
                bool cond_582888 = sle64(eta_p_582881, f64_res_582885);
                int64_t defunc_0_f_res_f_res_582889;
                
                if (cond_582888) {
                    int64_t defunc_0_f_res_f_res_t_res_583583 = sub64(eta_p_582881, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582889 = defunc_0_f_res_f_res_t_res_583583;
                } else {
                    defunc_0_f_res_f_res_582889 = f64_res_582885;
                }
                defunc_0_f_res_582887 = defunc_0_f_res_f_res_582889;
            }
            ((int64_t *) mem_586583)[i_586107] = defunc_0_f_res_582887;
        }
        
        int64_t defunc_0_foldl_res_582891;
        int64_t acc_582893 = (int64_t) 0;
        
        for (int64_t i_582892 = 0; i_582892 < arg_572699; i_582892++) {
            int64_t b_582894 = ((int64_t *) mem_586583)[i_582892];
            int64_t defunc_0_f_res_582895 = add64(acc_582893, b_582894);
            int64_t acc_tmp_588042 = defunc_0_f_res_582895;
            
            acc_582893 = acc_tmp_588042;
        }
        defunc_0_foldl_res_582891 = acc_582893;
        
        int64_t zp_lhs_582896 = mul64(total_angle_no_345698, defunc_0_foldl_res_582830);
        int64_t get_id_from_grid_angle_res_582897 = add64(defunc_0_foldl_res_582891, zp_lhs_582896);
        bool x_582898 = sle64((int64_t) 0, get_id_from_grid_angle_res_582897);
        bool y_582899 = slt64(get_id_from_grid_angle_res_582897, total_part_no_345700);
        bool bounds_check_582900 = x_582898 && y_582899;
        bool index_certs_582901;
        
        if (!bounds_check_582900) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582897, "] out of bounds for array of shape [", (long long) total_part_no_345700, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582923 = slt64(get_id_from_grid_angle_res_582897, dzlz7bUskBzitotal_part_noz7dUzg_345688);
        bool bounds_check_582924 = x_582898 && y_582923;
        bool index_certs_582925;
        
        if (!bounds_check_582924) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582897, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586114 = ((int64_t *) xys_mem_586424.mem)[write_iter_586109];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586549, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586423.mem, write_iter_586109 * dim_345683, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        
        int64_t pref_582902 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582897];
        bool cond_582903 = get_id_from_grid_angle_res_582897 == zeze_rhs_572880;
        int64_t post_582904;
        
        if (cond_582903) {
            int64_t zm_rhs_583587 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582897];
            int64_t post_t_res_583588 = sub64(dz2083U_345686, zm_rhs_583587);
            
            post_582904 = post_t_res_583588;
        } else {
            int64_t zm_lhs_582910 = add64((int64_t) 1, get_id_from_grid_angle_res_582897);
            bool x_582911 = sle64((int64_t) 0, zm_lhs_582910);
            bool y_582912 = slt64(zm_lhs_582910, dzlz7bUskBzitotal_part_noz7dUzg_345688);
            bool bounds_check_582913 = x_582911 && y_582912;
            bool index_certs_582914;
            
            if (!bounds_check_582913) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582910, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582915 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582910];
            int64_t zm_rhs_582919 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582897];
            int64_t post_f_res_582920 = sub64(zm_lhs_582915, zm_rhs_582919);
            
            post_582904 = post_f_res_582920;
        }
        
        int64_t zp_lhs_582921 = add64(pref_582902, write_iter_586109);
        int64_t zm_lhs_582922 = add64(post_582904, zp_lhs_582921);
        int64_t zm_rhs_582926 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582897];
        int64_t defunc_0_f_res_582927 = sub64(zm_lhs_582922, zm_rhs_582926);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582927) && slt64(defunc_0_f_res_582927, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_345683 - (int64_t) 1, dim_345683))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586482.mem, defunc_0_f_res_582927 * dim_345683, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586549, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582927) && slt64(defunc_0_f_res_582927, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582927] = write_iv_586114;
        }
    }
    if (mem_586605_cached_sizze_588525 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_588525, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586607_cached_sizze_588526 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_588526, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586615_cached_sizze_588527 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586615, &mem_586615_cached_sizze_588527, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586623_cached_sizze_588528 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586623, &mem_586623_cached_sizze_588528, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586639_cached_sizze_588530 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586639, &mem_586639_cached_sizze_588530, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586133 = 0; write_iter_586133 < dz2083U_345690; write_iter_586133++) {
        for (int64_t i_586119 = 0; i_586119 < dim_345683; i_586119++) {
            double eta_p_583406 = ((double *) xys_mem_586427.mem)[write_iter_586133 * dim_345683 + i_586119];
            double eta_p_583407 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586119];
            double eta_p_583408 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586119];
            int64_t eta_p_583410 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586119];
            double defunc_0_f_res_583411 = eta_p_583406 - eta_p_583407;
            double defunc_0_f_res_583413 = defunc_0_f_res_583411 / eta_p_583408;
            int64_t f64_res_583415 = fptosi_f64_i64(defunc_0_f_res_583413);
            int64_t max_res_583417 = smax64((int64_t) 0, f64_res_583415);
            int64_t zm_lhs_583423 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586119];
            int64_t min_arg1_583424 = sub64(zm_lhs_583423, (int64_t) 1);
            int64_t min_res_583425 = smin64(max_res_583417, min_arg1_583424);
            int64_t defunc_0_f_res_583427 = mul64(eta_p_583410, min_res_583425);
            
            ((int64_t *) mem_586607)[i_586119] = defunc_0_f_res_583427;
        }
        
        int64_t defunc_0_foldl_res_582687;
        int64_t acc_582689 = (int64_t) 0;
        
        for (int64_t i_582688 = 0; i_582688 < dim_345683; i_582688++) {
            int64_t b_582690 = ((int64_t *) mem_586607)[i_582688];
            int64_t defunc_0_f_res_582691 = add64(acc_582689, b_582690);
            int64_t acc_tmp_588046 = defunc_0_f_res_582691;
            
            acc_582689 = acc_tmp_588046;
        }
        defunc_0_foldl_res_582687 = acc_582689;
        
        bool x_582692 = sle64((int64_t) 0, defunc_0_foldl_res_582687);
        bool y_582693 = slt64(defunc_0_foldl_res_582687, dz2080U_345684);
        bool bounds_check_582694 = x_582692 && y_582693;
        bool index_certs_582695;
        
        if (!bounds_check_582694) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582687, "] out of bounds for array of shape [", (long long) dz2080U_345684, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586123 = 0; i_586123 < dim_345683; i_586123++) {
            double eta_p_582698 = ((double *) xys_mem_586427.mem)[write_iter_586133 * dim_345683 + i_586123];
            double eta_p_582699 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582687 * dim_345683 + i_586123];
            double defunc_0_f_res_582700 = eta_p_582698 - eta_p_582699;
            
            ((double *) mem_586615)[i_586123] = defunc_0_f_res_582700;
        }
        for (int64_t nest_i_588048 = 0; nest_i_588048 < arg_572699; nest_i_588048++) {
            ((double *) mem_586623)[nest_i_588048] = 0.0;
        }
        for (int64_t i_582703 = 0; i_582703 < arg_572699; i_582703++) {
            bool y_582705 = slt64(i_582703, dim_345683);
            bool index_certs_582706;
            
            if (!y_582705) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582703, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582708 = add64((int64_t) 1, i_582703);
            int64_t j_m_i_582709 = sub64(dim_345683, map_arg1_582708);
            bool empty_slice_582710 = j_m_i_582709 == (int64_t) 0;
            int64_t m_582711 = sub64(j_m_i_582709, (int64_t) 1);
            int64_t i_p_m_t_s_582712 = add64(map_arg1_582708, m_582711);
            bool zzero_leq_i_p_m_t_s_582713 = sle64((int64_t) 0, i_p_m_t_s_582712);
            bool i_p_m_t_s_leq_w_582714 = slt64(i_p_m_t_s_582712, dim_345683);
            bool zzero_lte_i_582715 = sle64((int64_t) 0, map_arg1_582708);
            bool i_lte_j_582716 = sle64(map_arg1_582708, dim_345683);
            bool y_582717 = i_p_m_t_s_leq_w_582714 && zzero_lte_i_582715;
            bool y_582718 = zzero_leq_i_p_m_t_s_582713 && y_582717;
            bool forwards_ok_582719 = i_lte_j_582716 && y_582718;
            bool ok_or_empty_582720 = empty_slice_582710 || forwards_ok_582719;
            bool index_certs_582721;
            
            if (!ok_or_empty_582720) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582708, ":", (long long) dim_345683, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586627 = (int64_t) 8 * j_m_i_582709;
            double this_x_582707 = ((double *) mem_586615)[i_582703];
            
            if (mem_586628_cached_sizze_588529 < bytes_586627) {
                err = lexical_realloc(ctx, &mem_586628, &mem_586628_cached_sizze_588529, bytes_586627);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586127 = 0; i_586127 < j_m_i_582709; i_586127++) {
                int64_t slice_586367 = map_arg1_582708 + i_586127;
                double eta_p_582724 = ((double *) mem_586615)[slice_586367];
                double defunc_0_ftimes_res_582725 = eta_p_582724 * eta_p_582724;
                
                ((double *) mem_586628)[i_586127] = defunc_0_ftimes_res_582725;
            }
            
            double defunc_0_foldl_res_582726;
            double acc_582728 = 0.0;
            
            for (int64_t i_582727 = 0; i_582727 < j_m_i_582709; i_582727++) {
                double b_582729 = ((double *) mem_586628)[i_582727];
                double defunc_0_f_res_582730 = acc_582728 + b_582729;
                double acc_tmp_588051 = defunc_0_f_res_582730;
                
                acc_582728 = acc_tmp_588051;
            }
            defunc_0_foldl_res_582726 = acc_582728;
            
            double sqrt_res_582731 = futrts_sqrt64(defunc_0_foldl_res_582726);
            double atan2_res_582732 = futrts_atan2_64(sqrt_res_582731, this_x_582707);
            
            ((double *) mem_586623)[i_582703] = atan2_res_582732;
        }
        for (int64_t i_586131 = 0; i_586131 < arg_572699; i_586131++) {
            double eta_p_582735 = ((double *) mem_586623)[i_586131];
            double eta_p_582736 = ((double *) mem_586451)[i_586131];
            int64_t eta_p_582737 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586131];
            int64_t eta_p_582738 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586131];
            double i64_res_582739 = sitofp_i64_f64(eta_p_582737);
            double defunc_0_fover_res_582740 = eta_p_582735 / eta_p_582736;
            double defunc_0_ftimes_res_582741 = i64_res_582739 * defunc_0_fover_res_582740;
            int64_t f64_res_582742 = fptosi_f64_i64(defunc_0_ftimes_res_582741);
            bool cond_582743 = slt64(f64_res_582742, (int64_t) 0);
            int64_t defunc_0_f_res_582744;
            
            if (cond_582743) {
                defunc_0_f_res_582744 = (int64_t) 0;
            } else {
                bool cond_582745 = sle64(eta_p_582738, f64_res_582742);
                int64_t defunc_0_f_res_f_res_582746;
                
                if (cond_582745) {
                    int64_t defunc_0_f_res_f_res_t_res_583595 = sub64(eta_p_582738, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582746 = defunc_0_f_res_f_res_t_res_583595;
                } else {
                    defunc_0_f_res_f_res_582746 = f64_res_582742;
                }
                defunc_0_f_res_582744 = defunc_0_f_res_f_res_582746;
            }
            ((int64_t *) mem_586639)[i_586131] = defunc_0_f_res_582744;
        }
        
        int64_t defunc_0_foldl_res_582748;
        int64_t acc_582750 = (int64_t) 0;
        
        for (int64_t i_582749 = 0; i_582749 < arg_572699; i_582749++) {
            int64_t b_582751 = ((int64_t *) mem_586639)[i_582749];
            int64_t defunc_0_f_res_582752 = add64(acc_582750, b_582751);
            int64_t acc_tmp_588053 = defunc_0_f_res_582752;
            
            acc_582750 = acc_tmp_588053;
        }
        defunc_0_foldl_res_582748 = acc_582750;
        
        int64_t zp_lhs_582753 = mul64(total_angle_no_345698, defunc_0_foldl_res_582687);
        int64_t get_id_from_grid_angle_res_582754 = add64(defunc_0_foldl_res_582748, zp_lhs_582753);
        bool x_582755 = sle64((int64_t) 0, get_id_from_grid_angle_res_582754);
        bool y_582756 = slt64(get_id_from_grid_angle_res_582754, total_part_no_345700);
        bool bounds_check_582757 = x_582755 && y_582756;
        bool index_certs_582758;
        
        if (!bounds_check_582757) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582754, "] out of bounds for array of shape [", (long long) total_part_no_345700, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582787 = slt64(get_id_from_grid_angle_res_582754, dzlz7bUskBzitotal_part_noz7dUzg_345688);
        bool bounds_check_582788 = x_582755 && y_582787;
        bool index_certs_582789;
        
        if (!bounds_check_582788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582754, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586138 = ((int64_t *) xys_mem_586428.mem)[write_iter_586133];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586427.mem, write_iter_586133 * dim_345683, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        
        int64_t pref_582759 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582754];
        bool cond_582760 = get_id_from_grid_angle_res_582754 == zeze_rhs_572880;
        int64_t post_582761;
        
        if (cond_582760) {
            int64_t zm_rhs_583600 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582754];
            int64_t zm_lhs_583601 = sub64(zp_lhs_572723, zm_rhs_583600);
            int64_t zm_rhs_583602 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582754];
            int64_t post_t_res_583603 = sub64(zm_lhs_583601, zm_rhs_583602);
            
            post_582761 = post_t_res_583603;
        } else {
            int64_t zp_lhs_582770 = add64((int64_t) 1, get_id_from_grid_angle_res_582754);
            bool x_582771 = sle64((int64_t) 0, zp_lhs_582770);
            bool y_582772 = slt64(zp_lhs_582770, dzlz7bUskBzitotal_part_noz7dUzg_345688);
            bool bounds_check_582773 = x_582771 && y_582772;
            bool index_certs_582774;
            
            if (!bounds_check_582773) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582770, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582775 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582770];
            int64_t zp_rhs_582776 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582770];
            int64_t zm_lhs_582777 = add64(zp_lhs_582775, zp_rhs_582776);
            int64_t zm_rhs_582781 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582754];
            int64_t zm_lhs_582782 = sub64(zm_lhs_582777, zm_rhs_582781);
            int64_t zm_rhs_582783 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582754];
            int64_t post_f_res_582784 = sub64(zm_lhs_582782, zm_rhs_582783);
            
            post_582761 = post_f_res_582784;
        }
        
        int64_t zp_lhs_582785 = add64(pref_582759, write_iter_586133);
        int64_t zm_lhs_582786 = add64(post_582761, zp_lhs_582785);
        int64_t zm_rhs_582790 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582754];
        int64_t defunc_0_f_res_582791 = sub64(zm_lhs_582786, zm_rhs_582790);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582791) && slt64(defunc_0_f_res_582791, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_345683 - (int64_t) 1, dim_345683))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586482.mem, defunc_0_f_res_582791 * dim_345683, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582791) && slt64(defunc_0_f_res_582791, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582791] = write_iv_586138;
        }
    }
    if (mem_586661_cached_sizze_588531 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586661, &mem_586661_cached_sizze_588531, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586663_cached_sizze_588532 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586663, &mem_586663_cached_sizze_588532, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586671_cached_sizze_588533 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586671, &mem_586671_cached_sizze_588533, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586679_cached_sizze_588534 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586679, &mem_586679_cached_sizze_588534, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586695_cached_sizze_588536 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586695, &mem_586695_cached_sizze_588536, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586157 = 0; write_iter_586157 < dz2083U_345691; write_iter_586157++) {
        for (int64_t i_586143 = 0; i_586143 < dim_345683; i_586143++) {
            double eta_p_583520 = ((double *) xys_mem_586431.mem)[write_iter_586157 * dim_345683 + i_586143];
            double eta_p_583521 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586143];
            double eta_p_583522 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586143];
            int64_t eta_p_583524 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586143];
            double defunc_0_f_res_583525 = eta_p_583520 - eta_p_583521;
            double defunc_0_f_res_583527 = defunc_0_f_res_583525 / eta_p_583522;
            int64_t f64_res_583529 = fptosi_f64_i64(defunc_0_f_res_583527);
            int64_t max_res_583531 = smax64((int64_t) 0, f64_res_583529);
            int64_t zm_lhs_583537 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586143];
            int64_t min_arg1_583538 = sub64(zm_lhs_583537, (int64_t) 1);
            int64_t min_res_583539 = smin64(max_res_583531, min_arg1_583538);
            int64_t defunc_0_f_res_583541 = mul64(eta_p_583524, min_res_583539);
            
            ((int64_t *) mem_586663)[i_586143] = defunc_0_f_res_583541;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_345683; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586663)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588057 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588057;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_345684);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_345684, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586147 = 0; i_586147 < dim_345683; i_586147++) {
            double eta_p_582548 = ((double *) xys_mem_586431.mem)[write_iter_586157 * dim_345683 + i_586147];
            double eta_p_582549 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_345683 + i_586147];
            double defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((double *) mem_586671)[i_586147] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588059 = 0; nest_i_588059 < arg_572699; nest_i_588059++) {
            ((double *) mem_586679)[nest_i_588059] = 0.0;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_572699; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_345683);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_345683, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_345683);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_345683);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_345683, "] out of bounds for array of shape [", (long long) dim_345683, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586683 = (int64_t) 8 * j_m_i_582559;
            double this_x_582557 = ((double *) mem_586671)[i_582553];
            
            if (mem_586684_cached_sizze_588535 < bytes_586683) {
                err = lexical_realloc(ctx, &mem_586684, &mem_586684_cached_sizze_588535, bytes_586683);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586151 = 0; i_586151 < j_m_i_582559; i_586151++) {
                int64_t slice_586362 = map_arg1_582558 + i_586151;
                double eta_p_582574 = ((double *) mem_586671)[slice_586362];
                double defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((double *) mem_586684)[i_586151] = defunc_0_ftimes_res_582575;
            }
            
            double defunc_0_foldl_res_582576;
            double acc_582578 = 0.0;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                double b_582579 = ((double *) mem_586684)[i_582577];
                double defunc_0_f_res_582580 = acc_582578 + b_582579;
                double acc_tmp_588062 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588062;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            double sqrt_res_582581 = futrts_sqrt64(defunc_0_foldl_res_582576);
            double atan2_res_582582 = futrts_atan2_64(sqrt_res_582581, this_x_582557);
            
            ((double *) mem_586679)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586155 = 0; i_586155 < arg_572699; i_586155++) {
            double eta_p_582585 = ((double *) mem_586679)[i_586155];
            double eta_p_582586 = ((double *) mem_586449)[i_586155];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586155];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586155];
            double i64_res_582589 = sitofp_i64_f64(eta_p_582587);
            double defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            double defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f64_res_582592 = fptosi_f64_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f64_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f64_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583610 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583610;
                } else {
                    defunc_0_f_res_f_res_582596 = f64_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586695)[i_586155] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_572699; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586695)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588064 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588064;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_345698, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_345700);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_345700, "].", "-> #0  ftSkyline.fut:514:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582644 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_345688);
        bool bounds_check_582645 = x_582605 && y_582644;
        bool index_certs_582646;
        
        if (!bounds_check_582645) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:522:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586162 = ((int64_t *) xys_mem_586432.mem)[write_iter_586157];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586661, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586431.mem, write_iter_586157 * dim_345683, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        
        int64_t pref_582609 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_572880;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_583616 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583617 = sub64(zp_lhs_572724, zm_rhs_583616);
            int64_t zm_rhs_583618 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583619 = sub64(zm_lhs_583617, zm_rhs_583618);
            int64_t zm_rhs_583620 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583621 = sub64(zm_lhs_583619, zm_rhs_583620);
            
            post_582611 = post_t_res_583621;
        } else {
            int64_t zp_lhs_582623 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582624 = sle64((int64_t) 0, zp_lhs_582623);
            bool y_582625 = slt64(zp_lhs_582623, dzlz7bUskBzitotal_part_noz7dUzg_345688);
            bool bounds_check_582626 = x_582624 && y_582625;
            bool index_certs_582627;
            
            if (!bounds_check_582626) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582623, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_345688, "].", "-> #0  ftSkyline.fut:520:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:843:17-851:91\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582628 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582623];
            int64_t zp_rhs_582629 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582623];
            int64_t zp_lhs_582630 = add64(zp_lhs_582628, zp_rhs_582629);
            int64_t zp_rhs_582631 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582623];
            int64_t zm_lhs_582632 = add64(zp_lhs_582630, zp_rhs_582631);
            int64_t zm_rhs_582636 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582637 = sub64(zm_lhs_582632, zm_rhs_582636);
            int64_t zm_rhs_582638 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582639 = sub64(zm_lhs_582637, zm_rhs_582638);
            int64_t zm_rhs_582640 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582641 = sub64(zm_lhs_582639, zm_rhs_582640);
            
            post_582611 = post_f_res_582641;
        }
        
        int64_t zp_lhs_582642 = add64(pref_582609, write_iter_586157);
        int64_t zm_lhs_582643 = add64(post_582611, zp_lhs_582642);
        int64_t zm_rhs_582647 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582648 = sub64(zm_lhs_582643, zm_rhs_582647);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582648) && slt64(defunc_0_f_res_582648, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_345683 - (int64_t) 1, dim_345683))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586482.mem, defunc_0_f_res_582648 * dim_345683, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586661, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_345683});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582648) && slt64(defunc_0_f_res_582648, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582648] = write_iv_586162;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586433, "mem_586433") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586441, "mem_586441") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586482, "mem_586482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586484, "mem_586484") != 0)
        return 1;
    prim_out_588011 = zp_lhs_572725;
    if (memblock_set(ctx, &*mem_out_p_588504, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588505, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588506, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588507, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588508 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586449);
        free(mem_586451);
        free(mem_586453);
        free(mem_586455);
        free(mem_586493);
        free(mem_586495);
        free(mem_586503);
        free(mem_586511);
        free(mem_586516);
        free(mem_586527);
        free(mem_586549);
        free(mem_586551);
        free(mem_586559);
        free(mem_586567);
        free(mem_586572);
        free(mem_586583);
        free(mem_586605);
        free(mem_586607);
        free(mem_586615);
        free(mem_586623);
        free(mem_586628);
        free(mem_586639);
        free(mem_586661);
        free(mem_586663);
        free(mem_586671);
        free(mem_586679);
        free(mem_586684);
        free(mem_586695);
        if (memblock_unref(ctx, &mem_586484, "mem_586484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586482, "mem_586482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586441, "mem_586441") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586433, "mem_586433") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_4_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588537, struct memblock *mem_out_p_588538, struct memblock *mem_out_p_588539, struct memblock *mem_out_p_588540, int64_t *out_prim_out_588541, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, int64_t dim_509468, int64_t dz2080U_509469, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470, int64_t dz2083U_509471, int64_t dzlz7bUskBzitotal_grid_noz7dUzg_509472, int64_t dzlz7bUskBzitotal_part_noz7dUzg_509473, int64_t dz2083U_509474, int64_t dz2083U_509475, int64_t dz2083U_509476, int64_t total_angle_no_509483, int64_t total_grid_no_509484, int64_t total_part_no_509485)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586449_cached_sizze_588542 = 0;
    unsigned char *mem_586449 = NULL;
    int64_t mem_586451_cached_sizze_588543 = 0;
    unsigned char *mem_586451 = NULL;
    int64_t mem_586453_cached_sizze_588544 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_588545 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586493_cached_sizze_588546 = 0;
    unsigned char *mem_586493 = NULL;
    int64_t mem_586495_cached_sizze_588547 = 0;
    unsigned char *mem_586495 = NULL;
    int64_t mem_586503_cached_sizze_588548 = 0;
    unsigned char *mem_586503 = NULL;
    int64_t mem_586511_cached_sizze_588549 = 0;
    unsigned char *mem_586511 = NULL;
    int64_t mem_586516_cached_sizze_588550 = 0;
    unsigned char *mem_586516 = NULL;
    int64_t mem_586527_cached_sizze_588551 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586549_cached_sizze_588552 = 0;
    unsigned char *mem_586549 = NULL;
    int64_t mem_586551_cached_sizze_588553 = 0;
    unsigned char *mem_586551 = NULL;
    int64_t mem_586559_cached_sizze_588554 = 0;
    unsigned char *mem_586559 = NULL;
    int64_t mem_586567_cached_sizze_588555 = 0;
    unsigned char *mem_586567 = NULL;
    int64_t mem_586572_cached_sizze_588556 = 0;
    unsigned char *mem_586572 = NULL;
    int64_t mem_586583_cached_sizze_588557 = 0;
    unsigned char *mem_586583 = NULL;
    int64_t mem_586605_cached_sizze_588558 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586607_cached_sizze_588559 = 0;
    unsigned char *mem_586607 = NULL;
    int64_t mem_586615_cached_sizze_588560 = 0;
    unsigned char *mem_586615 = NULL;
    int64_t mem_586623_cached_sizze_588561 = 0;
    unsigned char *mem_586623 = NULL;
    int64_t mem_586628_cached_sizze_588562 = 0;
    unsigned char *mem_586628 = NULL;
    int64_t mem_586639_cached_sizze_588563 = 0;
    unsigned char *mem_586639 = NULL;
    int64_t mem_586661_cached_sizze_588564 = 0;
    unsigned char *mem_586661 = NULL;
    int64_t mem_586663_cached_sizze_588565 = 0;
    unsigned char *mem_586663 = NULL;
    int64_t mem_586671_cached_sizze_588566 = 0;
    unsigned char *mem_586671 = NULL;
    int64_t mem_586679_cached_sizze_588567 = 0;
    unsigned char *mem_586679 = NULL;
    int64_t mem_586684_cached_sizze_588568 = 0;
    unsigned char *mem_586684 = NULL;
    int64_t mem_586695_cached_sizze_588569 = 0;
    unsigned char *mem_586695 = NULL;
    struct memblock mem_586484;
    
    mem_586484.references = NULL;
    
    struct memblock mem_586482;
    
    mem_586482.references = NULL;
    
    struct memblock mem_586441;
    
    mem_586441.references = NULL;
    
    struct memblock mem_586433;
    
    mem_586433.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_572699 = sub64(dim_509468, (int64_t) 1);
    bool assert_cond_t_res_572700 = arg_572699 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470;
    bool assert_c_572701;
    
    if (!assert_cond_t_res_572700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_572703 = dzlz7bUskBzitotal_grid_noz7dUzg_509472 == total_grid_no_509484;
    bool empty_or_match_cert_572704;
    
    if (!dim_match_572703) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_572705 = dzlz7bUskBzitotal_part_noz7dUzg_509473 == total_part_no_509485;
    bool empty_or_match_cert_572706;
    
    if (!dim_match_572705) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:562:13-21\n   #1  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586440 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_509473;
    int64_t zp_lhs_572723 = add64(dz2083U_509471, dz2083U_509474);
    int64_t zp_lhs_572724 = add64(dz2083U_509475, zp_lhs_572723);
    int64_t zp_lhs_572725 = add64(dz2083U_509476, zp_lhs_572724);
    bool dim_match_572727 = total_part_no_509485 == dzlz7bUskBzitotal_part_noz7dUzg_509473;
    bool empty_or_match_cert_572728;
    
    if (!dim_match_572727) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:561:64-74\n   #2  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_572729 = slt64((int64_t) 0, dz2080U_509469);
    bool index_certs_572730;
    
    if (!y_572729) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_509469, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586448 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470;
    bool empty_or_match_cert_572745;
    
    if (!assert_cond_t_res_572700) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586480 = (int64_t) 4 * zp_lhs_572725;
    int64_t bytes_586481 = dim_509468 * binop_x_586480;
    int64_t bytes_586483 = (int64_t) 8 * zp_lhs_572725;
    int64_t bytes_586492 = (int64_t) 4 * dim_509468;
    int64_t bytes_586494 = (int64_t) 8 * dim_509468;
    int64_t bytes_586510 = (int64_t) 4 * arg_572699;
    int64_t bytes_586526 = (int64_t) 8 * arg_572699;
    
    if (memblock_alloc(ctx, &mem_586433, dzlz7bUskBzitotal_grid_noz7dUzg_509472, "mem_586433")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dzlz7bUskBzitotal_grid_noz7dUzg_509472; i_586050++) {
        bool eta_p_572708 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_572709 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_572710 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool eta_p_572711 = ((bool *) isPartitionDominated_mem_586429.mem)[i_586050];
        bool cond_572712 = eta_p_572708 || eta_p_572709;
        bool cond_572713 = eta_p_572710 || cond_572712;
        bool cond_572714 = eta_p_572711 || cond_572713;
        
        ((bool *) mem_586433.mem)[i_586050] = cond_572714;
    }
    if (memblock_alloc(ctx, &mem_586441, bytes_586440, "mem_586441")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_509473; i_586054++) {
        int64_t eta_p_572716 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_572717 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_572718 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t eta_p_572719 = ((int64_t *) part_idx_mem_586430.mem)[i_586054];
        int64_t zp_lhs_572720 = add64(eta_p_572716, eta_p_572717);
        int64_t zp_lhs_572721 = add64(eta_p_572718, zp_lhs_572720);
        int64_t zp_lhs_572722 = add64(eta_p_572719, zp_lhs_572721);
        
        ((int64_t *) mem_586441.mem)[i_586054] = zp_lhs_572722;
    }
    if (mem_586449_cached_sizze_588542 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586449, &mem_586449_cached_sizze_588542, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586451_cached_sizze_588543 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586451, &mem_586451_cached_sizze_588543, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586453_cached_sizze_588544 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588544, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586455_cached_sizze_588545 < bytes_586448) {
        err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_588545, bytes_586448);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586064 = 0; i_586064 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470; i_586064++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583104 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586064];
        float i64_res_583105 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583104);
        float defunc_0_fover_res_583106 = 1.5707964F / i64_res_583105;
        
        ((float *) mem_586449)[i_586064] = defunc_0_fover_res_583106;
        ((float *) mem_586451)[i_586064] = defunc_0_fover_res_583106;
        ((float *) mem_586453)[i_586064] = defunc_0_fover_res_583106;
        ((float *) mem_586455)[i_586064] = defunc_0_fover_res_583106;
    }
    if (memblock_alloc(ctx, &mem_586482, bytes_586481, "mem_586482")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588018 = 0; nest_i_588018 < zp_lhs_572725; nest_i_588018++) {
        for (int64_t nest_i_588019 = 0; nest_i_588019 < dim_509468; nest_i_588019++) {
            ((float *) mem_586482.mem)[nest_i_588018 * dim_509468 + nest_i_588019] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586484, bytes_586483, "mem_586484")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588020 = 0; nest_i_588020 < zp_lhs_572725; nest_i_588020++) {
        ((int64_t *) mem_586484.mem)[nest_i_588020] = (int64_t) -1;
    }
    if (mem_586493_cached_sizze_588546 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586493, &mem_586493_cached_sizze_588546, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586495_cached_sizze_588547 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586495, &mem_586495_cached_sizze_588547, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586503_cached_sizze_588548 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586503, &mem_586503_cached_sizze_588548, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586511_cached_sizze_588549 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586511, &mem_586511_cached_sizze_588549, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586527_cached_sizze_588551 < bytes_586526) {
        err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588551, bytes_586526);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586085 = 0; write_iter_586085 < dz2083U_509471; write_iter_586085++) {
        for (int64_t i_586071 = 0; i_586071 < dim_509468; i_586071++) {
            float eta_p_583200 = ((float *) xys_mem_586419.mem)[write_iter_586085 * dim_509468 + i_586071];
            float eta_p_583201 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586071];
            float eta_p_583202 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586071];
            int64_t eta_p_583204 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586071];
            float defunc_0_f_res_583205 = eta_p_583200 - eta_p_583201;
            float defunc_0_f_res_583207 = defunc_0_f_res_583205 / eta_p_583202;
            int64_t f32_res_583209 = fptosi_f32_i64(defunc_0_f_res_583207);
            int64_t max_res_583211 = smax64((int64_t) 0, f32_res_583209);
            int64_t zm_lhs_583217 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586071];
            int64_t min_arg1_583218 = sub64(zm_lhs_583217, (int64_t) 1);
            int64_t min_res_583219 = smin64(max_res_583211, min_arg1_583218);
            int64_t defunc_0_f_res_583221 = mul64(eta_p_583204, min_res_583219);
            
            ((int64_t *) mem_586495)[i_586071] = defunc_0_f_res_583221;
        }
        
        int64_t defunc_0_foldl_res_582966;
        int64_t acc_582968 = (int64_t) 0;
        
        for (int64_t i_582967 = 0; i_582967 < dim_509468; i_582967++) {
            int64_t b_582969 = ((int64_t *) mem_586495)[i_582967];
            int64_t defunc_0_f_res_582970 = add64(acc_582968, b_582969);
            int64_t acc_tmp_588024 = defunc_0_f_res_582970;
            
            acc_582968 = acc_tmp_588024;
        }
        defunc_0_foldl_res_582966 = acc_582968;
        
        bool x_582971 = sle64((int64_t) 0, defunc_0_foldl_res_582966);
        bool y_582972 = slt64(defunc_0_foldl_res_582966, dz2080U_509469);
        bool bounds_check_582973 = x_582971 && y_582972;
        bool index_certs_582974;
        
        if (!bounds_check_582973) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582966, "] out of bounds for array of shape [", (long long) dz2080U_509469, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586075 = 0; i_586075 < dim_509468; i_586075++) {
            float eta_p_582977 = ((float *) xys_mem_586419.mem)[write_iter_586085 * dim_509468 + i_586075];
            float eta_p_582978 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582966 * dim_509468 + i_586075];
            float defunc_0_f_res_582979 = eta_p_582977 - eta_p_582978;
            
            ((float *) mem_586503)[i_586075] = defunc_0_f_res_582979;
        }
        for (int64_t nest_i_588026 = 0; nest_i_588026 < arg_572699; nest_i_588026++) {
            ((float *) mem_586511)[nest_i_588026] = 0.0F;
        }
        for (int64_t i_582982 = 0; i_582982 < arg_572699; i_582982++) {
            bool y_582984 = slt64(i_582982, dim_509468);
            bool index_certs_582985;
            
            if (!y_582984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582982, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582987 = add64((int64_t) 1, i_582982);
            int64_t j_m_i_582988 = sub64(dim_509468, map_arg1_582987);
            bool empty_slice_582989 = j_m_i_582988 == (int64_t) 0;
            int64_t m_582990 = sub64(j_m_i_582988, (int64_t) 1);
            int64_t i_p_m_t_s_582991 = add64(map_arg1_582987, m_582990);
            bool zzero_leq_i_p_m_t_s_582992 = sle64((int64_t) 0, i_p_m_t_s_582991);
            bool i_p_m_t_s_leq_w_582993 = slt64(i_p_m_t_s_582991, dim_509468);
            bool zzero_lte_i_582994 = sle64((int64_t) 0, map_arg1_582987);
            bool i_lte_j_582995 = sle64(map_arg1_582987, dim_509468);
            bool y_582996 = i_p_m_t_s_leq_w_582993 && zzero_lte_i_582994;
            bool y_582997 = zzero_leq_i_p_m_t_s_582992 && y_582996;
            bool forwards_ok_582998 = i_lte_j_582995 && y_582997;
            bool ok_or_empty_582999 = empty_slice_582989 || forwards_ok_582998;
            bool index_certs_583000;
            
            if (!ok_or_empty_582999) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582987, ":", (long long) dim_509468, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586515 = (int64_t) 4 * j_m_i_582988;
            float this_x_582986 = ((float *) mem_586503)[i_582982];
            
            if (mem_586516_cached_sizze_588550 < bytes_586515) {
                err = lexical_realloc(ctx, &mem_586516, &mem_586516_cached_sizze_588550, bytes_586515);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586079 = 0; i_586079 < j_m_i_582988; i_586079++) {
                int64_t slice_586377 = map_arg1_582987 + i_586079;
                float eta_p_583003 = ((float *) mem_586503)[slice_586377];
                float defunc_0_ftimes_res_583004 = eta_p_583003 * eta_p_583003;
                
                ((float *) mem_586516)[i_586079] = defunc_0_ftimes_res_583004;
            }
            
            float defunc_0_foldl_res_583005;
            float acc_583007 = 0.0F;
            
            for (int64_t i_583006 = 0; i_583006 < j_m_i_582988; i_583006++) {
                float b_583008 = ((float *) mem_586516)[i_583006];
                float defunc_0_f_res_583009 = acc_583007 + b_583008;
                float acc_tmp_588029 = defunc_0_f_res_583009;
                
                acc_583007 = acc_tmp_588029;
            }
            defunc_0_foldl_res_583005 = acc_583007;
            
            float sqrt_res_583010 = futrts_sqrt32(defunc_0_foldl_res_583005);
            float atan2_res_583011 = futrts_atan2_32(sqrt_res_583010, this_x_582986);
            
            ((float *) mem_586511)[i_582982] = atan2_res_583011;
        }
        for (int64_t i_586083 = 0; i_586083 < arg_572699; i_586083++) {
            float eta_p_583014 = ((float *) mem_586511)[i_586083];
            float eta_p_583015 = ((float *) mem_586455)[i_586083];
            int64_t eta_p_583016 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586083];
            int64_t eta_p_583017 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586083];
            float i64_res_583018 = sitofp_i64_f32(eta_p_583016);
            float defunc_0_fover_res_583019 = eta_p_583014 / eta_p_583015;
            float defunc_0_ftimes_res_583020 = i64_res_583018 * defunc_0_fover_res_583019;
            int64_t f32_res_583021 = fptosi_f32_i64(defunc_0_ftimes_res_583020);
            bool cond_583022 = slt64(f32_res_583021, (int64_t) 0);
            int64_t defunc_0_f_res_583023;
            
            if (cond_583022) {
                defunc_0_f_res_583023 = (int64_t) 0;
            } else {
                bool cond_583024 = sle64(eta_p_583017, f32_res_583021);
                int64_t defunc_0_f_res_f_res_583025;
                
                if (cond_583024) {
                    int64_t defunc_0_f_res_f_res_t_res_583576 = sub64(eta_p_583017, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583025 = defunc_0_f_res_f_res_t_res_583576;
                } else {
                    defunc_0_f_res_f_res_583025 = f32_res_583021;
                }
                defunc_0_f_res_583023 = defunc_0_f_res_f_res_583025;
            }
            ((int64_t *) mem_586527)[i_586083] = defunc_0_f_res_583023;
        }
        
        int64_t defunc_0_foldl_res_583027;
        int64_t acc_583029 = (int64_t) 0;
        
        for (int64_t i_583028 = 0; i_583028 < arg_572699; i_583028++) {
            int64_t b_583030 = ((int64_t *) mem_586527)[i_583028];
            int64_t defunc_0_f_res_583031 = add64(acc_583029, b_583030);
            int64_t acc_tmp_588031 = defunc_0_f_res_583031;
            
            acc_583029 = acc_tmp_588031;
        }
        defunc_0_foldl_res_583027 = acc_583029;
        
        int64_t zp_lhs_583032 = mul64(total_angle_no_509483, defunc_0_foldl_res_582966);
        int64_t get_id_from_grid_angle_res_583033 = add64(defunc_0_foldl_res_583027, zp_lhs_583032);
        bool x_583034 = sle64((int64_t) 0, get_id_from_grid_angle_res_583033);
        bool y_583035 = slt64(get_id_from_grid_angle_res_583033, total_part_no_509485);
        bool bounds_check_583036 = x_583034 && y_583035;
        bool index_certs_583037;
        
        if (!bounds_check_583036) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583033, "] out of bounds for array of shape [", (long long) total_part_no_509485, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583040 = slt64(get_id_from_grid_angle_res_583033, dzlz7bUskBzitotal_part_noz7dUzg_509473);
        bool bounds_check_583041 = x_583034 && y_583040;
        bool index_certs_583042;
        
        if (!bounds_check_583041) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583033, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586090 = ((int64_t *) xys_mem_586420.mem)[write_iter_586085];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586493, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, write_iter_586085 * dim_509468, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        
        int64_t pref_583038 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_583033];
        int64_t zp_lhs_583039 = add64(pref_583038, write_iter_586085);
        int64_t zm_rhs_583043 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583033];
        int64_t defunc_0_f_res_583044 = sub64(zp_lhs_583039, zm_rhs_583043);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583044) && slt64(defunc_0_f_res_583044, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_509468 - (int64_t) 1, dim_509468))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586482.mem, defunc_0_f_res_583044 * dim_509468, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586493, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583044) && slt64(defunc_0_f_res_583044, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_583044] = write_iv_586090;
        }
    }
    
    int64_t zeze_rhs_572880 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_509473, (int64_t) 1);
    
    if (mem_586549_cached_sizze_588552 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586549, &mem_586549_cached_sizze_588552, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586551_cached_sizze_588553 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586551, &mem_586551_cached_sizze_588553, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586559_cached_sizze_588554 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586559, &mem_586559_cached_sizze_588554, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586567_cached_sizze_588555 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586567, &mem_586567_cached_sizze_588555, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586583_cached_sizze_588557 < bytes_586526) {
        err = lexical_realloc(ctx, &mem_586583, &mem_586583_cached_sizze_588557, bytes_586526);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586109 = 0; write_iter_586109 < dz2083U_509474; write_iter_586109++) {
        for (int64_t i_586095 = 0; i_586095 < dim_509468; i_586095++) {
            float eta_p_583298 = ((float *) xys_mem_586423.mem)[write_iter_586109 * dim_509468 + i_586095];
            float eta_p_583299 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586095];
            float eta_p_583300 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586095];
            int64_t eta_p_583302 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586095];
            float defunc_0_f_res_583303 = eta_p_583298 - eta_p_583299;
            float defunc_0_f_res_583305 = defunc_0_f_res_583303 / eta_p_583300;
            int64_t f32_res_583307 = fptosi_f32_i64(defunc_0_f_res_583305);
            int64_t max_res_583309 = smax64((int64_t) 0, f32_res_583307);
            int64_t zm_lhs_583315 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586095];
            int64_t min_arg1_583316 = sub64(zm_lhs_583315, (int64_t) 1);
            int64_t min_res_583317 = smin64(max_res_583309, min_arg1_583316);
            int64_t defunc_0_f_res_583319 = mul64(eta_p_583302, min_res_583317);
            
            ((int64_t *) mem_586551)[i_586095] = defunc_0_f_res_583319;
        }
        
        int64_t defunc_0_foldl_res_582830;
        int64_t acc_582832 = (int64_t) 0;
        
        for (int64_t i_582831 = 0; i_582831 < dim_509468; i_582831++) {
            int64_t b_582833 = ((int64_t *) mem_586551)[i_582831];
            int64_t defunc_0_f_res_582834 = add64(acc_582832, b_582833);
            int64_t acc_tmp_588035 = defunc_0_f_res_582834;
            
            acc_582832 = acc_tmp_588035;
        }
        defunc_0_foldl_res_582830 = acc_582832;
        
        bool x_582835 = sle64((int64_t) 0, defunc_0_foldl_res_582830);
        bool y_582836 = slt64(defunc_0_foldl_res_582830, dz2080U_509469);
        bool bounds_check_582837 = x_582835 && y_582836;
        bool index_certs_582838;
        
        if (!bounds_check_582837) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582830, "] out of bounds for array of shape [", (long long) dz2080U_509469, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586099 = 0; i_586099 < dim_509468; i_586099++) {
            float eta_p_582841 = ((float *) xys_mem_586423.mem)[write_iter_586109 * dim_509468 + i_586099];
            float eta_p_582842 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582830 * dim_509468 + i_586099];
            float defunc_0_f_res_582843 = eta_p_582841 - eta_p_582842;
            
            ((float *) mem_586559)[i_586099] = defunc_0_f_res_582843;
        }
        for (int64_t nest_i_588037 = 0; nest_i_588037 < arg_572699; nest_i_588037++) {
            ((float *) mem_586567)[nest_i_588037] = 0.0F;
        }
        for (int64_t i_582846 = 0; i_582846 < arg_572699; i_582846++) {
            bool y_582848 = slt64(i_582846, dim_509468);
            bool index_certs_582849;
            
            if (!y_582848) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582846, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582851 = add64((int64_t) 1, i_582846);
            int64_t j_m_i_582852 = sub64(dim_509468, map_arg1_582851);
            bool empty_slice_582853 = j_m_i_582852 == (int64_t) 0;
            int64_t m_582854 = sub64(j_m_i_582852, (int64_t) 1);
            int64_t i_p_m_t_s_582855 = add64(map_arg1_582851, m_582854);
            bool zzero_leq_i_p_m_t_s_582856 = sle64((int64_t) 0, i_p_m_t_s_582855);
            bool i_p_m_t_s_leq_w_582857 = slt64(i_p_m_t_s_582855, dim_509468);
            bool zzero_lte_i_582858 = sle64((int64_t) 0, map_arg1_582851);
            bool i_lte_j_582859 = sle64(map_arg1_582851, dim_509468);
            bool y_582860 = i_p_m_t_s_leq_w_582857 && zzero_lte_i_582858;
            bool y_582861 = zzero_leq_i_p_m_t_s_582856 && y_582860;
            bool forwards_ok_582862 = i_lte_j_582859 && y_582861;
            bool ok_or_empty_582863 = empty_slice_582853 || forwards_ok_582862;
            bool index_certs_582864;
            
            if (!ok_or_empty_582863) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582851, ":", (long long) dim_509468, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586571 = (int64_t) 4 * j_m_i_582852;
            float this_x_582850 = ((float *) mem_586559)[i_582846];
            
            if (mem_586572_cached_sizze_588556 < bytes_586571) {
                err = lexical_realloc(ctx, &mem_586572, &mem_586572_cached_sizze_588556, bytes_586571);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586103 = 0; i_586103 < j_m_i_582852; i_586103++) {
                int64_t slice_586372 = map_arg1_582851 + i_586103;
                float eta_p_582867 = ((float *) mem_586559)[slice_586372];
                float defunc_0_ftimes_res_582868 = eta_p_582867 * eta_p_582867;
                
                ((float *) mem_586572)[i_586103] = defunc_0_ftimes_res_582868;
            }
            
            float defunc_0_foldl_res_582869;
            float acc_582871 = 0.0F;
            
            for (int64_t i_582870 = 0; i_582870 < j_m_i_582852; i_582870++) {
                float b_582872 = ((float *) mem_586572)[i_582870];
                float defunc_0_f_res_582873 = acc_582871 + b_582872;
                float acc_tmp_588040 = defunc_0_f_res_582873;
                
                acc_582871 = acc_tmp_588040;
            }
            defunc_0_foldl_res_582869 = acc_582871;
            
            float sqrt_res_582874 = futrts_sqrt32(defunc_0_foldl_res_582869);
            float atan2_res_582875 = futrts_atan2_32(sqrt_res_582874, this_x_582850);
            
            ((float *) mem_586567)[i_582846] = atan2_res_582875;
        }
        for (int64_t i_586107 = 0; i_586107 < arg_572699; i_586107++) {
            float eta_p_582878 = ((float *) mem_586567)[i_586107];
            float eta_p_582879 = ((float *) mem_586453)[i_586107];
            int64_t eta_p_582880 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586107];
            int64_t eta_p_582881 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586107];
            float i64_res_582882 = sitofp_i64_f32(eta_p_582880);
            float defunc_0_fover_res_582883 = eta_p_582878 / eta_p_582879;
            float defunc_0_ftimes_res_582884 = i64_res_582882 * defunc_0_fover_res_582883;
            int64_t f32_res_582885 = fptosi_f32_i64(defunc_0_ftimes_res_582884);
            bool cond_582886 = slt64(f32_res_582885, (int64_t) 0);
            int64_t defunc_0_f_res_582887;
            
            if (cond_582886) {
                defunc_0_f_res_582887 = (int64_t) 0;
            } else {
                bool cond_582888 = sle64(eta_p_582881, f32_res_582885);
                int64_t defunc_0_f_res_f_res_582889;
                
                if (cond_582888) {
                    int64_t defunc_0_f_res_f_res_t_res_583583 = sub64(eta_p_582881, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582889 = defunc_0_f_res_f_res_t_res_583583;
                } else {
                    defunc_0_f_res_f_res_582889 = f32_res_582885;
                }
                defunc_0_f_res_582887 = defunc_0_f_res_f_res_582889;
            }
            ((int64_t *) mem_586583)[i_586107] = defunc_0_f_res_582887;
        }
        
        int64_t defunc_0_foldl_res_582891;
        int64_t acc_582893 = (int64_t) 0;
        
        for (int64_t i_582892 = 0; i_582892 < arg_572699; i_582892++) {
            int64_t b_582894 = ((int64_t *) mem_586583)[i_582892];
            int64_t defunc_0_f_res_582895 = add64(acc_582893, b_582894);
            int64_t acc_tmp_588042 = defunc_0_f_res_582895;
            
            acc_582893 = acc_tmp_588042;
        }
        defunc_0_foldl_res_582891 = acc_582893;
        
        int64_t zp_lhs_582896 = mul64(total_angle_no_509483, defunc_0_foldl_res_582830);
        int64_t get_id_from_grid_angle_res_582897 = add64(defunc_0_foldl_res_582891, zp_lhs_582896);
        bool x_582898 = sle64((int64_t) 0, get_id_from_grid_angle_res_582897);
        bool y_582899 = slt64(get_id_from_grid_angle_res_582897, total_part_no_509485);
        bool bounds_check_582900 = x_582898 && y_582899;
        bool index_certs_582901;
        
        if (!bounds_check_582900) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582897, "] out of bounds for array of shape [", (long long) total_part_no_509485, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582923 = slt64(get_id_from_grid_angle_res_582897, dzlz7bUskBzitotal_part_noz7dUzg_509473);
        bool bounds_check_582924 = x_582898 && y_582923;
        bool index_certs_582925;
        
        if (!bounds_check_582924) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582897, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586114 = ((int64_t *) xys_mem_586424.mem)[write_iter_586109];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586549, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586423.mem, write_iter_586109 * dim_509468, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        
        int64_t pref_582902 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582897];
        bool cond_582903 = get_id_from_grid_angle_res_582897 == zeze_rhs_572880;
        int64_t post_582904;
        
        if (cond_582903) {
            int64_t zm_rhs_583587 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582897];
            int64_t post_t_res_583588 = sub64(dz2083U_509471, zm_rhs_583587);
            
            post_582904 = post_t_res_583588;
        } else {
            int64_t zm_lhs_582910 = add64((int64_t) 1, get_id_from_grid_angle_res_582897);
            bool x_582911 = sle64((int64_t) 0, zm_lhs_582910);
            bool y_582912 = slt64(zm_lhs_582910, dzlz7bUskBzitotal_part_noz7dUzg_509473);
            bool bounds_check_582913 = x_582911 && y_582912;
            bool index_certs_582914;
            
            if (!bounds_check_582913) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_582910, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_582915 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_582910];
            int64_t zm_rhs_582919 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582897];
            int64_t post_f_res_582920 = sub64(zm_lhs_582915, zm_rhs_582919);
            
            post_582904 = post_f_res_582920;
        }
        
        int64_t zp_lhs_582921 = add64(pref_582902, write_iter_586109);
        int64_t zm_lhs_582922 = add64(post_582904, zp_lhs_582921);
        int64_t zm_rhs_582926 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582897];
        int64_t defunc_0_f_res_582927 = sub64(zm_lhs_582922, zm_rhs_582926);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582927) && slt64(defunc_0_f_res_582927, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_509468 - (int64_t) 1, dim_509468))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586482.mem, defunc_0_f_res_582927 * dim_509468, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586549, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582927) && slt64(defunc_0_f_res_582927, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582927] = write_iv_586114;
        }
    }
    if (mem_586605_cached_sizze_588558 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_588558, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586607_cached_sizze_588559 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_588559, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586615_cached_sizze_588560 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586615, &mem_586615_cached_sizze_588560, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586623_cached_sizze_588561 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586623, &mem_586623_cached_sizze_588561, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586639_cached_sizze_588563 < bytes_586526) {
        err = lexical_realloc(ctx, &mem_586639, &mem_586639_cached_sizze_588563, bytes_586526);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586133 = 0; write_iter_586133 < dz2083U_509475; write_iter_586133++) {
        for (int64_t i_586119 = 0; i_586119 < dim_509468; i_586119++) {
            float eta_p_583406 = ((float *) xys_mem_586427.mem)[write_iter_586133 * dim_509468 + i_586119];
            float eta_p_583407 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586119];
            float eta_p_583408 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586119];
            int64_t eta_p_583410 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586119];
            float defunc_0_f_res_583411 = eta_p_583406 - eta_p_583407;
            float defunc_0_f_res_583413 = defunc_0_f_res_583411 / eta_p_583408;
            int64_t f32_res_583415 = fptosi_f32_i64(defunc_0_f_res_583413);
            int64_t max_res_583417 = smax64((int64_t) 0, f32_res_583415);
            int64_t zm_lhs_583423 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586119];
            int64_t min_arg1_583424 = sub64(zm_lhs_583423, (int64_t) 1);
            int64_t min_res_583425 = smin64(max_res_583417, min_arg1_583424);
            int64_t defunc_0_f_res_583427 = mul64(eta_p_583410, min_res_583425);
            
            ((int64_t *) mem_586607)[i_586119] = defunc_0_f_res_583427;
        }
        
        int64_t defunc_0_foldl_res_582687;
        int64_t acc_582689 = (int64_t) 0;
        
        for (int64_t i_582688 = 0; i_582688 < dim_509468; i_582688++) {
            int64_t b_582690 = ((int64_t *) mem_586607)[i_582688];
            int64_t defunc_0_f_res_582691 = add64(acc_582689, b_582690);
            int64_t acc_tmp_588046 = defunc_0_f_res_582691;
            
            acc_582689 = acc_tmp_588046;
        }
        defunc_0_foldl_res_582687 = acc_582689;
        
        bool x_582692 = sle64((int64_t) 0, defunc_0_foldl_res_582687);
        bool y_582693 = slt64(defunc_0_foldl_res_582687, dz2080U_509469);
        bool bounds_check_582694 = x_582692 && y_582693;
        bool index_certs_582695;
        
        if (!bounds_check_582694) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582687, "] out of bounds for array of shape [", (long long) dz2080U_509469, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586123 = 0; i_586123 < dim_509468; i_586123++) {
            float eta_p_582698 = ((float *) xys_mem_586427.mem)[write_iter_586133 * dim_509468 + i_586123];
            float eta_p_582699 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582687 * dim_509468 + i_586123];
            float defunc_0_f_res_582700 = eta_p_582698 - eta_p_582699;
            
            ((float *) mem_586615)[i_586123] = defunc_0_f_res_582700;
        }
        for (int64_t nest_i_588048 = 0; nest_i_588048 < arg_572699; nest_i_588048++) {
            ((float *) mem_586623)[nest_i_588048] = 0.0F;
        }
        for (int64_t i_582703 = 0; i_582703 < arg_572699; i_582703++) {
            bool y_582705 = slt64(i_582703, dim_509468);
            bool index_certs_582706;
            
            if (!y_582705) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582703, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582708 = add64((int64_t) 1, i_582703);
            int64_t j_m_i_582709 = sub64(dim_509468, map_arg1_582708);
            bool empty_slice_582710 = j_m_i_582709 == (int64_t) 0;
            int64_t m_582711 = sub64(j_m_i_582709, (int64_t) 1);
            int64_t i_p_m_t_s_582712 = add64(map_arg1_582708, m_582711);
            bool zzero_leq_i_p_m_t_s_582713 = sle64((int64_t) 0, i_p_m_t_s_582712);
            bool i_p_m_t_s_leq_w_582714 = slt64(i_p_m_t_s_582712, dim_509468);
            bool zzero_lte_i_582715 = sle64((int64_t) 0, map_arg1_582708);
            bool i_lte_j_582716 = sle64(map_arg1_582708, dim_509468);
            bool y_582717 = i_p_m_t_s_leq_w_582714 && zzero_lte_i_582715;
            bool y_582718 = zzero_leq_i_p_m_t_s_582713 && y_582717;
            bool forwards_ok_582719 = i_lte_j_582716 && y_582718;
            bool ok_or_empty_582720 = empty_slice_582710 || forwards_ok_582719;
            bool index_certs_582721;
            
            if (!ok_or_empty_582720) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582708, ":", (long long) dim_509468, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586627 = (int64_t) 4 * j_m_i_582709;
            float this_x_582707 = ((float *) mem_586615)[i_582703];
            
            if (mem_586628_cached_sizze_588562 < bytes_586627) {
                err = lexical_realloc(ctx, &mem_586628, &mem_586628_cached_sizze_588562, bytes_586627);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586127 = 0; i_586127 < j_m_i_582709; i_586127++) {
                int64_t slice_586367 = map_arg1_582708 + i_586127;
                float eta_p_582724 = ((float *) mem_586615)[slice_586367];
                float defunc_0_ftimes_res_582725 = eta_p_582724 * eta_p_582724;
                
                ((float *) mem_586628)[i_586127] = defunc_0_ftimes_res_582725;
            }
            
            float defunc_0_foldl_res_582726;
            float acc_582728 = 0.0F;
            
            for (int64_t i_582727 = 0; i_582727 < j_m_i_582709; i_582727++) {
                float b_582729 = ((float *) mem_586628)[i_582727];
                float defunc_0_f_res_582730 = acc_582728 + b_582729;
                float acc_tmp_588051 = defunc_0_f_res_582730;
                
                acc_582728 = acc_tmp_588051;
            }
            defunc_0_foldl_res_582726 = acc_582728;
            
            float sqrt_res_582731 = futrts_sqrt32(defunc_0_foldl_res_582726);
            float atan2_res_582732 = futrts_atan2_32(sqrt_res_582731, this_x_582707);
            
            ((float *) mem_586623)[i_582703] = atan2_res_582732;
        }
        for (int64_t i_586131 = 0; i_586131 < arg_572699; i_586131++) {
            float eta_p_582735 = ((float *) mem_586623)[i_586131];
            float eta_p_582736 = ((float *) mem_586451)[i_586131];
            int64_t eta_p_582737 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586131];
            int64_t eta_p_582738 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586131];
            float i64_res_582739 = sitofp_i64_f32(eta_p_582737);
            float defunc_0_fover_res_582740 = eta_p_582735 / eta_p_582736;
            float defunc_0_ftimes_res_582741 = i64_res_582739 * defunc_0_fover_res_582740;
            int64_t f32_res_582742 = fptosi_f32_i64(defunc_0_ftimes_res_582741);
            bool cond_582743 = slt64(f32_res_582742, (int64_t) 0);
            int64_t defunc_0_f_res_582744;
            
            if (cond_582743) {
                defunc_0_f_res_582744 = (int64_t) 0;
            } else {
                bool cond_582745 = sle64(eta_p_582738, f32_res_582742);
                int64_t defunc_0_f_res_f_res_582746;
                
                if (cond_582745) {
                    int64_t defunc_0_f_res_f_res_t_res_583595 = sub64(eta_p_582738, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582746 = defunc_0_f_res_f_res_t_res_583595;
                } else {
                    defunc_0_f_res_f_res_582746 = f32_res_582742;
                }
                defunc_0_f_res_582744 = defunc_0_f_res_f_res_582746;
            }
            ((int64_t *) mem_586639)[i_586131] = defunc_0_f_res_582744;
        }
        
        int64_t defunc_0_foldl_res_582748;
        int64_t acc_582750 = (int64_t) 0;
        
        for (int64_t i_582749 = 0; i_582749 < arg_572699; i_582749++) {
            int64_t b_582751 = ((int64_t *) mem_586639)[i_582749];
            int64_t defunc_0_f_res_582752 = add64(acc_582750, b_582751);
            int64_t acc_tmp_588053 = defunc_0_f_res_582752;
            
            acc_582750 = acc_tmp_588053;
        }
        defunc_0_foldl_res_582748 = acc_582750;
        
        int64_t zp_lhs_582753 = mul64(total_angle_no_509483, defunc_0_foldl_res_582687);
        int64_t get_id_from_grid_angle_res_582754 = add64(defunc_0_foldl_res_582748, zp_lhs_582753);
        bool x_582755 = sle64((int64_t) 0, get_id_from_grid_angle_res_582754);
        bool y_582756 = slt64(get_id_from_grid_angle_res_582754, total_part_no_509485);
        bool bounds_check_582757 = x_582755 && y_582756;
        bool index_certs_582758;
        
        if (!bounds_check_582757) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582754, "] out of bounds for array of shape [", (long long) total_part_no_509485, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582787 = slt64(get_id_from_grid_angle_res_582754, dzlz7bUskBzitotal_part_noz7dUzg_509473);
        bool bounds_check_582788 = x_582755 && y_582787;
        bool index_certs_582789;
        
        if (!bounds_check_582788) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582754, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586138 = ((int64_t *) xys_mem_586428.mem)[write_iter_586133];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586427.mem, write_iter_586133 * dim_509468, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        
        int64_t pref_582759 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582754];
        bool cond_582760 = get_id_from_grid_angle_res_582754 == zeze_rhs_572880;
        int64_t post_582761;
        
        if (cond_582760) {
            int64_t zm_rhs_583600 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582754];
            int64_t zm_lhs_583601 = sub64(zp_lhs_572723, zm_rhs_583600);
            int64_t zm_rhs_583602 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582754];
            int64_t post_t_res_583603 = sub64(zm_lhs_583601, zm_rhs_583602);
            
            post_582761 = post_t_res_583603;
        } else {
            int64_t zp_lhs_582770 = add64((int64_t) 1, get_id_from_grid_angle_res_582754);
            bool x_582771 = sle64((int64_t) 0, zp_lhs_582770);
            bool y_582772 = slt64(zp_lhs_582770, dzlz7bUskBzitotal_part_noz7dUzg_509473);
            bool bounds_check_582773 = x_582771 && y_582772;
            bool index_certs_582774;
            
            if (!bounds_check_582773) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582770, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582775 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582770];
            int64_t zp_rhs_582776 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582770];
            int64_t zm_lhs_582777 = add64(zp_lhs_582775, zp_rhs_582776);
            int64_t zm_rhs_582781 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582754];
            int64_t zm_lhs_582782 = sub64(zm_lhs_582777, zm_rhs_582781);
            int64_t zm_rhs_582783 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582754];
            int64_t post_f_res_582784 = sub64(zm_lhs_582782, zm_rhs_582783);
            
            post_582761 = post_f_res_582784;
        }
        
        int64_t zp_lhs_582785 = add64(pref_582759, write_iter_586133);
        int64_t zm_lhs_582786 = add64(post_582761, zp_lhs_582785);
        int64_t zm_rhs_582790 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582754];
        int64_t defunc_0_f_res_582791 = sub64(zm_lhs_582786, zm_rhs_582790);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582791) && slt64(defunc_0_f_res_582791, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_509468 - (int64_t) 1, dim_509468))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586482.mem, defunc_0_f_res_582791 * dim_509468, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582791) && slt64(defunc_0_f_res_582791, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582791] = write_iv_586138;
        }
    }
    if (mem_586661_cached_sizze_588564 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586661, &mem_586661_cached_sizze_588564, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586663_cached_sizze_588565 < bytes_586494) {
        err = lexical_realloc(ctx, &mem_586663, &mem_586663_cached_sizze_588565, bytes_586494);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586671_cached_sizze_588566 < bytes_586492) {
        err = lexical_realloc(ctx, &mem_586671, &mem_586671_cached_sizze_588566, bytes_586492);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586679_cached_sizze_588567 < bytes_586510) {
        err = lexical_realloc(ctx, &mem_586679, &mem_586679_cached_sizze_588567, bytes_586510);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586695_cached_sizze_588569 < bytes_586526) {
        err = lexical_realloc(ctx, &mem_586695, &mem_586695_cached_sizze_588569, bytes_586526);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586157 = 0; write_iter_586157 < dz2083U_509476; write_iter_586157++) {
        for (int64_t i_586143 = 0; i_586143 < dim_509468; i_586143++) {
            float eta_p_583520 = ((float *) xys_mem_586431.mem)[write_iter_586157 * dim_509468 + i_586143];
            float eta_p_583521 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586143];
            float eta_p_583522 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586143];
            int64_t eta_p_583524 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586143];
            float defunc_0_f_res_583525 = eta_p_583520 - eta_p_583521;
            float defunc_0_f_res_583527 = defunc_0_f_res_583525 / eta_p_583522;
            int64_t f32_res_583529 = fptosi_f32_i64(defunc_0_f_res_583527);
            int64_t max_res_583531 = smax64((int64_t) 0, f32_res_583529);
            int64_t zm_lhs_583537 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586143];
            int64_t min_arg1_583538 = sub64(zm_lhs_583537, (int64_t) 1);
            int64_t min_res_583539 = smin64(max_res_583531, min_arg1_583538);
            int64_t defunc_0_f_res_583541 = mul64(eta_p_583524, min_res_583539);
            
            ((int64_t *) mem_586663)[i_586143] = defunc_0_f_res_583541;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_509468; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586663)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588057 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588057;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_509469);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_509469, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586147 = 0; i_586147 < dim_509468; i_586147++) {
            float eta_p_582548 = ((float *) xys_mem_586431.mem)[write_iter_586157 * dim_509468 + i_586147];
            float eta_p_582549 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_509468 + i_586147];
            float defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((float *) mem_586671)[i_586147] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588059 = 0; nest_i_588059 < arg_572699; nest_i_588059++) {
            ((float *) mem_586679)[nest_i_588059] = 0.0F;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_572699; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_509468);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_509468, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_509468);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_509468);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_509468, "] out of bounds for array of shape [", (long long) dim_509468, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:561:64-74\n   #5  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586683 = (int64_t) 4 * j_m_i_582559;
            float this_x_582557 = ((float *) mem_586671)[i_582553];
            
            if (mem_586684_cached_sizze_588568 < bytes_586683) {
                err = lexical_realloc(ctx, &mem_586684, &mem_586684_cached_sizze_588568, bytes_586683);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586151 = 0; i_586151 < j_m_i_582559; i_586151++) {
                int64_t slice_586362 = map_arg1_582558 + i_586151;
                float eta_p_582574 = ((float *) mem_586671)[slice_586362];
                float defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((float *) mem_586684)[i_586151] = defunc_0_ftimes_res_582575;
            }
            
            float defunc_0_foldl_res_582576;
            float acc_582578 = 0.0F;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                float b_582579 = ((float *) mem_586684)[i_582577];
                float defunc_0_f_res_582580 = acc_582578 + b_582579;
                float acc_tmp_588062 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588062;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            float sqrt_res_582581 = futrts_sqrt32(defunc_0_foldl_res_582576);
            float atan2_res_582582 = futrts_atan2_32(sqrt_res_582581, this_x_582557);
            
            ((float *) mem_586679)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586155 = 0; i_586155 < arg_572699; i_586155++) {
            float eta_p_582585 = ((float *) mem_586679)[i_586155];
            float eta_p_582586 = ((float *) mem_586449)[i_586155];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586155];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586155];
            float i64_res_582589 = sitofp_i64_f32(eta_p_582587);
            float defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            float defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f32_res_582592 = fptosi_f32_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f32_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f32_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583610 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583610;
                } else {
                    defunc_0_f_res_f_res_582596 = f32_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586695)[i_586155] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_572699; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586695)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588064 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588064;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_509483, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_509485);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_509485, "].", "-> #0  ftSkyline.fut:514:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582644 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_509473);
        bool bounds_check_582645 = x_582605 && y_582644;
        bool index_certs_582646;
        
        if (!bounds_check_582645) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:522:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586162 = ((int64_t *) xys_mem_586432.mem)[write_iter_586157];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586661, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586431.mem, write_iter_586157 * dim_509468, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        
        int64_t pref_582609 = ((int64_t *) mem_586441.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_572880;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_rhs_583616 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583617 = sub64(zp_lhs_572724, zm_rhs_583616);
            int64_t zm_rhs_583618 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583619 = sub64(zm_lhs_583617, zm_rhs_583618);
            int64_t zm_rhs_583620 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583621 = sub64(zm_lhs_583619, zm_rhs_583620);
            
            post_582611 = post_t_res_583621;
        } else {
            int64_t zp_lhs_582623 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582624 = sle64((int64_t) 0, zp_lhs_582623);
            bool y_582625 = slt64(zp_lhs_582623, dzlz7bUskBzitotal_part_noz7dUzg_509473);
            bool bounds_check_582626 = x_582624 && y_582625;
            bool index_certs_582627;
            
            if (!bounds_check_582626) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582623, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_509473, "].", "-> #0  ftSkyline.fut:520:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:561:64-74\n   #3  ftSkyline.fut:990:17-998:90\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582628 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582623];
            int64_t zp_rhs_582629 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582623];
            int64_t zp_lhs_582630 = add64(zp_lhs_582628, zp_rhs_582629);
            int64_t zp_rhs_582631 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582623];
            int64_t zm_lhs_582632 = add64(zp_lhs_582630, zp_rhs_582631);
            int64_t zm_rhs_582636 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582637 = sub64(zm_lhs_582632, zm_rhs_582636);
            int64_t zm_rhs_582638 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582639 = sub64(zm_lhs_582637, zm_rhs_582638);
            int64_t zm_rhs_582640 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582641 = sub64(zm_lhs_582639, zm_rhs_582640);
            
            post_582611 = post_f_res_582641;
        }
        
        int64_t zp_lhs_582642 = add64(pref_582609, write_iter_586157);
        int64_t zm_lhs_582643 = add64(post_582611, zp_lhs_582642);
        int64_t zm_rhs_582647 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582648 = sub64(zm_lhs_582643, zm_rhs_582647);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582648) && slt64(defunc_0_f_res_582648, zp_lhs_572725)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_509468 - (int64_t) 1, dim_509468))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586482.mem, defunc_0_f_res_582648 * dim_509468, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586661, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_509468});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582648) && slt64(defunc_0_f_res_582648, zp_lhs_572725)) {
            ((int64_t *) mem_586484.mem)[defunc_0_f_res_582648] = write_iv_586162;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586433, "mem_586433") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586441, "mem_586441") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586482, "mem_586482") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586484, "mem_586484") != 0)
        return 1;
    prim_out_588011 = zp_lhs_572725;
    if (memblock_set(ctx, &*mem_out_p_588537, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588538, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588539, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588540, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588541 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586449);
        free(mem_586451);
        free(mem_586453);
        free(mem_586455);
        free(mem_586493);
        free(mem_586495);
        free(mem_586503);
        free(mem_586511);
        free(mem_586516);
        free(mem_586527);
        free(mem_586549);
        free(mem_586551);
        free(mem_586559);
        free(mem_586567);
        free(mem_586572);
        free(mem_586583);
        free(mem_586605);
        free(mem_586607);
        free(mem_586615);
        free(mem_586623);
        free(mem_586628);
        free(mem_586639);
        free(mem_586661);
        free(mem_586663);
        free(mem_586671);
        free(mem_586679);
        free(mem_586684);
        free(mem_586695);
        if (memblock_unref(ctx, &mem_586484, "mem_586484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586482, "mem_586482") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586441, "mem_586441") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586433, "mem_586433") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_5_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588570, struct memblock *mem_out_p_588571, struct memblock *mem_out_p_588572, struct memblock *mem_out_p_588573, int64_t *out_prim_out_588574, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, struct memblock isPartitionDominated_mem_586433, struct memblock part_idx_mem_586434, struct memblock xys_mem_586435, struct memblock xys_mem_586436, int64_t dim_325730, int64_t dz2080U_325731, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732, int64_t dz2083U_325733, int64_t dz2081U_325734, int64_t dzlz7bUskBzitotal_part_noz7dUzg_325735, int64_t dz2083U_325736, int64_t dz2083U_325737, int64_t dz2083U_325738, int64_t dz2083U_325739, int64_t total_angle_no_325746, int64_t total_grid_no_325747, int64_t total_part_no_325748)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586453_cached_sizze_588575 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_588576 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586457_cached_sizze_588577 = 0;
    unsigned char *mem_586457 = NULL;
    int64_t mem_586459_cached_sizze_588578 = 0;
    unsigned char *mem_586459 = NULL;
    int64_t mem_586461_cached_sizze_588579 = 0;
    unsigned char *mem_586461 = NULL;
    int64_t mem_586505_cached_sizze_588580 = 0;
    unsigned char *mem_586505 = NULL;
    int64_t mem_586507_cached_sizze_588581 = 0;
    unsigned char *mem_586507 = NULL;
    int64_t mem_586515_cached_sizze_588582 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586523_cached_sizze_588583 = 0;
    unsigned char *mem_586523 = NULL;
    int64_t mem_586528_cached_sizze_588584 = 0;
    unsigned char *mem_586528 = NULL;
    int64_t mem_586539_cached_sizze_588585 = 0;
    unsigned char *mem_586539 = NULL;
    int64_t mem_586561_cached_sizze_588586 = 0;
    unsigned char *mem_586561 = NULL;
    int64_t mem_586563_cached_sizze_588587 = 0;
    unsigned char *mem_586563 = NULL;
    int64_t mem_586571_cached_sizze_588588 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586579_cached_sizze_588589 = 0;
    unsigned char *mem_586579 = NULL;
    int64_t mem_586584_cached_sizze_588590 = 0;
    unsigned char *mem_586584 = NULL;
    int64_t mem_586595_cached_sizze_588591 = 0;
    unsigned char *mem_586595 = NULL;
    int64_t mem_586617_cached_sizze_588592 = 0;
    unsigned char *mem_586617 = NULL;
    int64_t mem_586619_cached_sizze_588593 = 0;
    unsigned char *mem_586619 = NULL;
    int64_t mem_586627_cached_sizze_588594 = 0;
    unsigned char *mem_586627 = NULL;
    int64_t mem_586635_cached_sizze_588595 = 0;
    unsigned char *mem_586635 = NULL;
    int64_t mem_586640_cached_sizze_588596 = 0;
    unsigned char *mem_586640 = NULL;
    int64_t mem_586651_cached_sizze_588597 = 0;
    unsigned char *mem_586651 = NULL;
    int64_t mem_586673_cached_sizze_588598 = 0;
    unsigned char *mem_586673 = NULL;
    int64_t mem_586675_cached_sizze_588599 = 0;
    unsigned char *mem_586675 = NULL;
    int64_t mem_586683_cached_sizze_588600 = 0;
    unsigned char *mem_586683 = NULL;
    int64_t mem_586691_cached_sizze_588601 = 0;
    unsigned char *mem_586691 = NULL;
    int64_t mem_586696_cached_sizze_588602 = 0;
    unsigned char *mem_586696 = NULL;
    int64_t mem_586707_cached_sizze_588603 = 0;
    unsigned char *mem_586707 = NULL;
    int64_t mem_586729_cached_sizze_588604 = 0;
    unsigned char *mem_586729 = NULL;
    int64_t mem_586731_cached_sizze_588605 = 0;
    unsigned char *mem_586731 = NULL;
    int64_t mem_586739_cached_sizze_588606 = 0;
    unsigned char *mem_586739 = NULL;
    int64_t mem_586747_cached_sizze_588607 = 0;
    unsigned char *mem_586747 = NULL;
    int64_t mem_586752_cached_sizze_588608 = 0;
    unsigned char *mem_586752 = NULL;
    int64_t mem_586763_cached_sizze_588609 = 0;
    unsigned char *mem_586763 = NULL;
    struct memblock mem_586496;
    
    mem_586496.references = NULL;
    
    struct memblock mem_586494;
    
    mem_586494.references = NULL;
    
    struct memblock mem_586445;
    
    mem_586445.references = NULL;
    
    struct memblock mem_586437;
    
    mem_586437.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_571866 = sub64(dim_325730, (int64_t) 1);
    bool assert_cond_t_res_571867 = arg_571866 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732;
    bool assert_c_571868;
    
    if (!assert_cond_t_res_571867) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:833:17-842:96\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586444 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_325735;
    int64_t zp_lhs_571889 = add64(dz2083U_325733, dz2083U_325736);
    int64_t zp_lhs_571890 = add64(dz2083U_325737, zp_lhs_571889);
    int64_t zp_lhs_571891 = add64(dz2083U_325738, zp_lhs_571890);
    int64_t n_total_571892 = add64(dz2083U_325739, zp_lhs_571891);
    bool dim_match_571894 = total_part_no_325748 == dzlz7bUskBzitotal_part_noz7dUzg_325735;
    bool empty_or_match_cert_571895;
    
    if (!dim_match_571894) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:833:17-842:96\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_571896 = slt64((int64_t) 0, dz2080U_325731);
    bool index_certs_571897;
    
    if (!y_571896) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586452 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732;
    bool empty_or_match_cert_571911;
    
    if (!assert_cond_t_res_571867) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586492 = (int64_t) 8 * n_total_571892;
    int64_t bytes_586493 = dim_325730 * binop_x_586492;
    int64_t bytes_586504 = (int64_t) 8 * dim_325730;
    int64_t bytes_586522 = (int64_t) 8 * arg_571866;
    
    if (memblock_alloc(ctx, &mem_586437, dz2081U_325734, "mem_586437")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dz2081U_325734; i_586050++) {
        bool eta_p_571870 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_571871 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_571872 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool eta_p_571873 = ((bool *) isPartitionDominated_mem_586429.mem)[i_586050];
        bool eta_p_571874 = ((bool *) isPartitionDominated_mem_586433.mem)[i_586050];
        bool cond_571875 = eta_p_571870 || eta_p_571871;
        bool cond_571876 = eta_p_571872 || cond_571875;
        bool cond_571877 = eta_p_571873 || cond_571876;
        bool lifted_lambda_res_571878 = eta_p_571874 || cond_571877;
        
        ((bool *) mem_586437.mem)[i_586050] = lifted_lambda_res_571878;
    }
    if (memblock_alloc(ctx, &mem_586445, bytes_586444, "mem_586445")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_325735; i_586054++) {
        int64_t eta_p_571880 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_571881 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_571882 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t eta_p_571883 = ((int64_t *) part_idx_mem_586430.mem)[i_586054];
        int64_t eta_p_571884 = ((int64_t *) part_idx_mem_586434.mem)[i_586054];
        int64_t zp_lhs_571885 = add64(eta_p_571880, eta_p_571881);
        int64_t zp_lhs_571886 = add64(eta_p_571882, zp_lhs_571885);
        int64_t zp_lhs_571887 = add64(eta_p_571883, zp_lhs_571886);
        int64_t lifted_lambda_res_571888 = add64(eta_p_571884, zp_lhs_571887);
        
        ((int64_t *) mem_586445.mem)[i_586054] = lifted_lambda_res_571888;
    }
    if (mem_586453_cached_sizze_588575 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588575, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586455_cached_sizze_588576 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_588576, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586457_cached_sizze_588577 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586457, &mem_586457_cached_sizze_588577, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586459_cached_sizze_588578 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586459, &mem_586459_cached_sizze_588578, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586461_cached_sizze_588579 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586461, &mem_586461_cached_sizze_588579, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586066 = 0; i_586066 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732; i_586066++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583304 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586066];
        double i64_res_583305 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583304);
        double defunc_0_fover_res_583306 = 1.5707963267948966 / i64_res_583305;
        
        ((double *) mem_586453)[i_586066] = defunc_0_fover_res_583306;
        ((double *) mem_586455)[i_586066] = defunc_0_fover_res_583306;
        ((double *) mem_586457)[i_586066] = defunc_0_fover_res_583306;
        ((double *) mem_586459)[i_586066] = defunc_0_fover_res_583306;
        ((double *) mem_586461)[i_586066] = defunc_0_fover_res_583306;
    }
    if (memblock_alloc(ctx, &mem_586494, bytes_586493, "mem_586494")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588019 = 0; nest_i_588019 < n_total_571892; nest_i_588019++) {
        for (int64_t nest_i_588020 = 0; nest_i_588020 < dim_325730; nest_i_588020++) {
            ((double *) mem_586494.mem)[nest_i_588019 * dim_325730 + nest_i_588020] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586496, binop_x_586492, "mem_586496")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588021 = 0; nest_i_588021 < n_total_571892; nest_i_588021++) {
        ((int64_t *) mem_586496.mem)[nest_i_588021] = (int64_t) -1;
    }
    if (mem_586505_cached_sizze_588580 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586505, &mem_586505_cached_sizze_588580, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586507_cached_sizze_588581 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586507, &mem_586507_cached_sizze_588581, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586515_cached_sizze_588582 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588582, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586523_cached_sizze_588583 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586523, &mem_586523_cached_sizze_588583, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586539_cached_sizze_588585 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586539, &mem_586539_cached_sizze_588585, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586088 = 0; write_iter_586088 < dz2083U_325733; write_iter_586088++) {
        for (int64_t i_586074 = 0; i_586074 < dim_325730; i_586074++) {
            double eta_p_583411 = ((double *) xys_mem_586419.mem)[write_iter_586088 * dim_325730 + i_586074];
            double eta_p_583412 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586074];
            double eta_p_583413 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586074];
            int64_t eta_p_583415 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586074];
            double defunc_0_f_res_583416 = eta_p_583411 - eta_p_583412;
            double defunc_0_f_res_583418 = defunc_0_f_res_583416 / eta_p_583413;
            int64_t f64_res_583420 = fptosi_f64_i64(defunc_0_f_res_583418);
            int64_t max_res_583422 = smax64((int64_t) 0, f64_res_583420);
            int64_t zm_lhs_583428 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586074];
            int64_t min_arg1_583429 = sub64(zm_lhs_583428, (int64_t) 1);
            int64_t min_res_583430 = smin64(max_res_583422, min_arg1_583429);
            int64_t defunc_0_f_res_583432 = mul64(eta_p_583415, min_res_583430);
            
            ((int64_t *) mem_586507)[i_586074] = defunc_0_f_res_583432;
        }
        
        int64_t defunc_0_foldl_res_583123;
        int64_t acc_583125 = (int64_t) 0;
        
        for (int64_t i_583124 = 0; i_583124 < dim_325730; i_583124++) {
            int64_t b_583126 = ((int64_t *) mem_586507)[i_583124];
            int64_t defunc_0_f_res_583127 = add64(acc_583125, b_583126);
            int64_t acc_tmp_588025 = defunc_0_f_res_583127;
            
            acc_583125 = acc_tmp_588025;
        }
        defunc_0_foldl_res_583123 = acc_583125;
        
        bool x_583128 = sle64((int64_t) 0, defunc_0_foldl_res_583123);
        bool y_583129 = slt64(defunc_0_foldl_res_583123, dz2080U_325731);
        bool bounds_check_583130 = x_583128 && y_583129;
        bool index_certs_583131;
        
        if (!bounds_check_583130) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_583123, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586078 = 0; i_586078 < dim_325730; i_586078++) {
            double eta_p_583134 = ((double *) xys_mem_586419.mem)[write_iter_586088 * dim_325730 + i_586078];
            double eta_p_583135 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_583123 * dim_325730 + i_586078];
            double defunc_0_f_res_583136 = eta_p_583134 - eta_p_583135;
            
            ((double *) mem_586515)[i_586078] = defunc_0_f_res_583136;
        }
        for (int64_t nest_i_588027 = 0; nest_i_588027 < arg_571866; nest_i_588027++) {
            ((double *) mem_586523)[nest_i_588027] = 0.0;
        }
        for (int64_t i_583139 = 0; i_583139 < arg_571866; i_583139++) {
            bool y_583141 = slt64(i_583139, dim_325730);
            bool index_certs_583142;
            
            if (!y_583141) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_583139, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_583144 = add64((int64_t) 1, i_583139);
            int64_t j_m_i_583145 = sub64(dim_325730, map_arg1_583144);
            bool empty_slice_583146 = j_m_i_583145 == (int64_t) 0;
            int64_t m_583147 = sub64(j_m_i_583145, (int64_t) 1);
            int64_t i_p_m_t_s_583148 = add64(map_arg1_583144, m_583147);
            bool zzero_leq_i_p_m_t_s_583149 = sle64((int64_t) 0, i_p_m_t_s_583148);
            bool i_p_m_t_s_leq_w_583150 = slt64(i_p_m_t_s_583148, dim_325730);
            bool zzero_lte_i_583151 = sle64((int64_t) 0, map_arg1_583144);
            bool i_lte_j_583152 = sle64(map_arg1_583144, dim_325730);
            bool y_583153 = i_p_m_t_s_leq_w_583150 && zzero_lte_i_583151;
            bool y_583154 = zzero_leq_i_p_m_t_s_583149 && y_583153;
            bool forwards_ok_583155 = i_lte_j_583152 && y_583154;
            bool ok_or_empty_583156 = empty_slice_583146 || forwards_ok_583155;
            bool index_certs_583157;
            
            if (!ok_or_empty_583156) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_583144, ":", (long long) dim_325730, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586527 = (int64_t) 8 * j_m_i_583145;
            double this_x_583143 = ((double *) mem_586515)[i_583139];
            
            if (mem_586528_cached_sizze_588584 < bytes_586527) {
                err = lexical_realloc(ctx, &mem_586528, &mem_586528_cached_sizze_588584, bytes_586527);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586082 = 0; i_586082 < j_m_i_583145; i_586082++) {
                int64_t slice_586382 = map_arg1_583144 + i_586082;
                double eta_p_583160 = ((double *) mem_586515)[slice_586382];
                double defunc_0_ftimes_res_583161 = eta_p_583160 * eta_p_583160;
                
                ((double *) mem_586528)[i_586082] = defunc_0_ftimes_res_583161;
            }
            
            double defunc_0_foldl_res_583162;
            double acc_583164 = 0.0;
            
            for (int64_t i_583163 = 0; i_583163 < j_m_i_583145; i_583163++) {
                double b_583165 = ((double *) mem_586528)[i_583163];
                double defunc_0_f_res_583166 = acc_583164 + b_583165;
                double acc_tmp_588030 = defunc_0_f_res_583166;
                
                acc_583164 = acc_tmp_588030;
            }
            defunc_0_foldl_res_583162 = acc_583164;
            
            double sqrt_res_583167 = futrts_sqrt64(defunc_0_foldl_res_583162);
            double atan2_res_583168 = futrts_atan2_64(sqrt_res_583167, this_x_583143);
            
            ((double *) mem_586523)[i_583139] = atan2_res_583168;
        }
        for (int64_t i_586086 = 0; i_586086 < arg_571866; i_586086++) {
            double eta_p_583171 = ((double *) mem_586523)[i_586086];
            double eta_p_583172 = ((double *) mem_586461)[i_586086];
            int64_t eta_p_583173 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586086];
            int64_t eta_p_583174 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586086];
            double i64_res_583175 = sitofp_i64_f64(eta_p_583173);
            double defunc_0_fover_res_583176 = eta_p_583171 / eta_p_583172;
            double defunc_0_ftimes_res_583177 = i64_res_583175 * defunc_0_fover_res_583176;
            int64_t f64_res_583178 = fptosi_f64_i64(defunc_0_ftimes_res_583177);
            bool cond_583179 = slt64(f64_res_583178, (int64_t) 0);
            int64_t defunc_0_f_res_583180;
            
            if (cond_583179) {
                defunc_0_f_res_583180 = (int64_t) 0;
            } else {
                bool cond_583181 = sle64(eta_p_583174, f64_res_583178);
                int64_t defunc_0_f_res_f_res_583182;
                
                if (cond_583181) {
                    int64_t defunc_0_f_res_f_res_t_res_583913 = sub64(eta_p_583174, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583182 = defunc_0_f_res_f_res_t_res_583913;
                } else {
                    defunc_0_f_res_f_res_583182 = f64_res_583178;
                }
                defunc_0_f_res_583180 = defunc_0_f_res_f_res_583182;
            }
            ((int64_t *) mem_586539)[i_586086] = defunc_0_f_res_583180;
        }
        
        int64_t defunc_0_foldl_res_583184;
        int64_t acc_583186 = (int64_t) 0;
        
        for (int64_t i_583185 = 0; i_583185 < arg_571866; i_583185++) {
            int64_t b_583187 = ((int64_t *) mem_586539)[i_583185];
            int64_t defunc_0_f_res_583188 = add64(acc_583186, b_583187);
            int64_t acc_tmp_588032 = defunc_0_f_res_583188;
            
            acc_583186 = acc_tmp_588032;
        }
        defunc_0_foldl_res_583184 = acc_583186;
        
        int64_t zp_lhs_583189 = mul64(total_angle_no_325746, defunc_0_foldl_res_583123);
        int64_t get_id_from_grid_angle_res_583190 = add64(defunc_0_foldl_res_583184, zp_lhs_583189);
        bool x_583191 = sle64((int64_t) 0, get_id_from_grid_angle_res_583190);
        bool y_583192 = slt64(get_id_from_grid_angle_res_583190, total_part_no_325748);
        bool bounds_check_583193 = x_583191 && y_583192;
        bool index_certs_583194;
        
        if (!bounds_check_583193) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583190, "] out of bounds for array of shape [", (long long) total_part_no_325748, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583197 = slt64(get_id_from_grid_angle_res_583190, dzlz7bUskBzitotal_part_noz7dUzg_325735);
        bool bounds_check_583198 = x_583191 && y_583197;
        bool index_certs_583199;
        
        if (!bounds_check_583198) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583190, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586093 = ((int64_t *) xys_mem_586420.mem)[write_iter_586088];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586505, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586419.mem, write_iter_586088 * dim_325730, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        
        int64_t pref_583195 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_583190];
        int64_t zp_lhs_583196 = add64(pref_583195, write_iter_586088);
        int64_t zm_rhs_583200 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583190];
        int64_t defunc_0_f_res_583201 = sub64(zp_lhs_583196, zm_rhs_583200);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583201) && slt64(defunc_0_f_res_583201, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_325730 - (int64_t) 1, dim_325730))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586494.mem, defunc_0_f_res_583201 * dim_325730, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586505, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583201) && slt64(defunc_0_f_res_583201, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_583201] = write_iv_586093;
        }
    }
    
    int64_t zeze_rhs_572046 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_325735, (int64_t) 1);
    
    if (mem_586561_cached_sizze_588586 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586561, &mem_586561_cached_sizze_588586, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586563_cached_sizze_588587 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586563, &mem_586563_cached_sizze_588587, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586571_cached_sizze_588588 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588588, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586579_cached_sizze_588589 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586579, &mem_586579_cached_sizze_588589, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586595_cached_sizze_588591 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586595, &mem_586595_cached_sizze_588591, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586112 = 0; write_iter_586112 < dz2083U_325736; write_iter_586112++) {
        for (int64_t i_586098 = 0; i_586098 < dim_325730; i_586098++) {
            double eta_p_583509 = ((double *) xys_mem_586423.mem)[write_iter_586112 * dim_325730 + i_586098];
            double eta_p_583510 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586098];
            double eta_p_583511 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586098];
            int64_t eta_p_583513 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586098];
            double defunc_0_f_res_583514 = eta_p_583509 - eta_p_583510;
            double defunc_0_f_res_583516 = defunc_0_f_res_583514 / eta_p_583511;
            int64_t f64_res_583518 = fptosi_f64_i64(defunc_0_f_res_583516);
            int64_t max_res_583520 = smax64((int64_t) 0, f64_res_583518);
            int64_t zm_lhs_583526 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586098];
            int64_t min_arg1_583527 = sub64(zm_lhs_583526, (int64_t) 1);
            int64_t min_res_583528 = smin64(max_res_583520, min_arg1_583527);
            int64_t defunc_0_f_res_583530 = mul64(eta_p_583513, min_res_583528);
            
            ((int64_t *) mem_586563)[i_586098] = defunc_0_f_res_583530;
        }
        
        int64_t defunc_0_foldl_res_582987;
        int64_t acc_582989 = (int64_t) 0;
        
        for (int64_t i_582988 = 0; i_582988 < dim_325730; i_582988++) {
            int64_t b_582990 = ((int64_t *) mem_586563)[i_582988];
            int64_t defunc_0_f_res_582991 = add64(acc_582989, b_582990);
            int64_t acc_tmp_588036 = defunc_0_f_res_582991;
            
            acc_582989 = acc_tmp_588036;
        }
        defunc_0_foldl_res_582987 = acc_582989;
        
        bool x_582992 = sle64((int64_t) 0, defunc_0_foldl_res_582987);
        bool y_582993 = slt64(defunc_0_foldl_res_582987, dz2080U_325731);
        bool bounds_check_582994 = x_582992 && y_582993;
        bool index_certs_582995;
        
        if (!bounds_check_582994) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582987, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586102 = 0; i_586102 < dim_325730; i_586102++) {
            double eta_p_582998 = ((double *) xys_mem_586423.mem)[write_iter_586112 * dim_325730 + i_586102];
            double eta_p_582999 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582987 * dim_325730 + i_586102];
            double defunc_0_f_res_583000 = eta_p_582998 - eta_p_582999;
            
            ((double *) mem_586571)[i_586102] = defunc_0_f_res_583000;
        }
        for (int64_t nest_i_588038 = 0; nest_i_588038 < arg_571866; nest_i_588038++) {
            ((double *) mem_586579)[nest_i_588038] = 0.0;
        }
        for (int64_t i_583003 = 0; i_583003 < arg_571866; i_583003++) {
            bool y_583005 = slt64(i_583003, dim_325730);
            bool index_certs_583006;
            
            if (!y_583005) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_583003, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_583008 = add64((int64_t) 1, i_583003);
            int64_t j_m_i_583009 = sub64(dim_325730, map_arg1_583008);
            bool empty_slice_583010 = j_m_i_583009 == (int64_t) 0;
            int64_t m_583011 = sub64(j_m_i_583009, (int64_t) 1);
            int64_t i_p_m_t_s_583012 = add64(map_arg1_583008, m_583011);
            bool zzero_leq_i_p_m_t_s_583013 = sle64((int64_t) 0, i_p_m_t_s_583012);
            bool i_p_m_t_s_leq_w_583014 = slt64(i_p_m_t_s_583012, dim_325730);
            bool zzero_lte_i_583015 = sle64((int64_t) 0, map_arg1_583008);
            bool i_lte_j_583016 = sle64(map_arg1_583008, dim_325730);
            bool y_583017 = i_p_m_t_s_leq_w_583014 && zzero_lte_i_583015;
            bool y_583018 = zzero_leq_i_p_m_t_s_583013 && y_583017;
            bool forwards_ok_583019 = i_lte_j_583016 && y_583018;
            bool ok_or_empty_583020 = empty_slice_583010 || forwards_ok_583019;
            bool index_certs_583021;
            
            if (!ok_or_empty_583020) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_583008, ":", (long long) dim_325730, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586583 = (int64_t) 8 * j_m_i_583009;
            double this_x_583007 = ((double *) mem_586571)[i_583003];
            
            if (mem_586584_cached_sizze_588590 < bytes_586583) {
                err = lexical_realloc(ctx, &mem_586584, &mem_586584_cached_sizze_588590, bytes_586583);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586106 = 0; i_586106 < j_m_i_583009; i_586106++) {
                int64_t slice_586377 = map_arg1_583008 + i_586106;
                double eta_p_583024 = ((double *) mem_586571)[slice_586377];
                double defunc_0_ftimes_res_583025 = eta_p_583024 * eta_p_583024;
                
                ((double *) mem_586584)[i_586106] = defunc_0_ftimes_res_583025;
            }
            
            double defunc_0_foldl_res_583026;
            double acc_583028 = 0.0;
            
            for (int64_t i_583027 = 0; i_583027 < j_m_i_583009; i_583027++) {
                double b_583029 = ((double *) mem_586584)[i_583027];
                double defunc_0_f_res_583030 = acc_583028 + b_583029;
                double acc_tmp_588041 = defunc_0_f_res_583030;
                
                acc_583028 = acc_tmp_588041;
            }
            defunc_0_foldl_res_583026 = acc_583028;
            
            double sqrt_res_583031 = futrts_sqrt64(defunc_0_foldl_res_583026);
            double atan2_res_583032 = futrts_atan2_64(sqrt_res_583031, this_x_583007);
            
            ((double *) mem_586579)[i_583003] = atan2_res_583032;
        }
        for (int64_t i_586110 = 0; i_586110 < arg_571866; i_586110++) {
            double eta_p_583035 = ((double *) mem_586579)[i_586110];
            double eta_p_583036 = ((double *) mem_586459)[i_586110];
            int64_t eta_p_583037 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586110];
            int64_t eta_p_583038 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586110];
            double i64_res_583039 = sitofp_i64_f64(eta_p_583037);
            double defunc_0_fover_res_583040 = eta_p_583035 / eta_p_583036;
            double defunc_0_ftimes_res_583041 = i64_res_583039 * defunc_0_fover_res_583040;
            int64_t f64_res_583042 = fptosi_f64_i64(defunc_0_ftimes_res_583041);
            bool cond_583043 = slt64(f64_res_583042, (int64_t) 0);
            int64_t defunc_0_f_res_583044;
            
            if (cond_583043) {
                defunc_0_f_res_583044 = (int64_t) 0;
            } else {
                bool cond_583045 = sle64(eta_p_583038, f64_res_583042);
                int64_t defunc_0_f_res_f_res_583046;
                
                if (cond_583045) {
                    int64_t defunc_0_f_res_f_res_t_res_583920 = sub64(eta_p_583038, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583046 = defunc_0_f_res_f_res_t_res_583920;
                } else {
                    defunc_0_f_res_f_res_583046 = f64_res_583042;
                }
                defunc_0_f_res_583044 = defunc_0_f_res_f_res_583046;
            }
            ((int64_t *) mem_586595)[i_586110] = defunc_0_f_res_583044;
        }
        
        int64_t defunc_0_foldl_res_583048;
        int64_t acc_583050 = (int64_t) 0;
        
        for (int64_t i_583049 = 0; i_583049 < arg_571866; i_583049++) {
            int64_t b_583051 = ((int64_t *) mem_586595)[i_583049];
            int64_t defunc_0_f_res_583052 = add64(acc_583050, b_583051);
            int64_t acc_tmp_588043 = defunc_0_f_res_583052;
            
            acc_583050 = acc_tmp_588043;
        }
        defunc_0_foldl_res_583048 = acc_583050;
        
        int64_t zp_lhs_583053 = mul64(total_angle_no_325746, defunc_0_foldl_res_582987);
        int64_t get_id_from_grid_angle_res_583054 = add64(defunc_0_foldl_res_583048, zp_lhs_583053);
        bool x_583055 = sle64((int64_t) 0, get_id_from_grid_angle_res_583054);
        bool y_583056 = slt64(get_id_from_grid_angle_res_583054, total_part_no_325748);
        bool bounds_check_583057 = x_583055 && y_583056;
        bool index_certs_583058;
        
        if (!bounds_check_583057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583054, "] out of bounds for array of shape [", (long long) total_part_no_325748, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583080 = slt64(get_id_from_grid_angle_res_583054, dzlz7bUskBzitotal_part_noz7dUzg_325735);
        bool bounds_check_583081 = x_583055 && y_583080;
        bool index_certs_583082;
        
        if (!bounds_check_583081) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583054, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586117 = ((int64_t *) xys_mem_586424.mem)[write_iter_586112];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586561, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586423.mem, write_iter_586112 * dim_325730, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        
        int64_t pref_583059 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_583054];
        bool cond_583060 = get_id_from_grid_angle_res_583054 == zeze_rhs_572046;
        int64_t post_583061;
        
        if (cond_583060) {
            int64_t zm_rhs_583924 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583054];
            int64_t post_t_res_583925 = sub64(dz2083U_325733, zm_rhs_583924);
            
            post_583061 = post_t_res_583925;
        } else {
            int64_t zm_lhs_583067 = add64((int64_t) 1, get_id_from_grid_angle_res_583054);
            bool x_583068 = sle64((int64_t) 0, zm_lhs_583067);
            bool y_583069 = slt64(zm_lhs_583067, dzlz7bUskBzitotal_part_noz7dUzg_325735);
            bool bounds_check_583070 = x_583068 && y_583069;
            bool index_certs_583071;
            
            if (!bounds_check_583070) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_583067, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_583072 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_583067];
            int64_t zm_rhs_583076 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583054];
            int64_t post_f_res_583077 = sub64(zm_lhs_583072, zm_rhs_583076);
            
            post_583061 = post_f_res_583077;
        }
        
        int64_t zp_lhs_583078 = add64(pref_583059, write_iter_586112);
        int64_t zm_lhs_583079 = add64(post_583061, zp_lhs_583078);
        int64_t zm_rhs_583083 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_583054];
        int64_t defunc_0_f_res_583084 = sub64(zm_lhs_583079, zm_rhs_583083);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583084) && slt64(defunc_0_f_res_583084, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_325730 - (int64_t) 1, dim_325730))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586494.mem, defunc_0_f_res_583084 * dim_325730, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586561, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583084) && slt64(defunc_0_f_res_583084, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_583084] = write_iv_586117;
        }
    }
    if (mem_586617_cached_sizze_588592 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586617, &mem_586617_cached_sizze_588592, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586619_cached_sizze_588593 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586619, &mem_586619_cached_sizze_588593, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586627_cached_sizze_588594 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586627, &mem_586627_cached_sizze_588594, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586635_cached_sizze_588595 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586635, &mem_586635_cached_sizze_588595, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586651_cached_sizze_588597 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586651, &mem_586651_cached_sizze_588597, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586136 = 0; write_iter_586136 < dz2083U_325737; write_iter_586136++) {
        for (int64_t i_586122 = 0; i_586122 < dim_325730; i_586122++) {
            double eta_p_583617 = ((double *) xys_mem_586427.mem)[write_iter_586136 * dim_325730 + i_586122];
            double eta_p_583618 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586122];
            double eta_p_583619 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586122];
            int64_t eta_p_583621 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586122];
            double defunc_0_f_res_583622 = eta_p_583617 - eta_p_583618;
            double defunc_0_f_res_583624 = defunc_0_f_res_583622 / eta_p_583619;
            int64_t f64_res_583626 = fptosi_f64_i64(defunc_0_f_res_583624);
            int64_t max_res_583628 = smax64((int64_t) 0, f64_res_583626);
            int64_t zm_lhs_583634 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586122];
            int64_t min_arg1_583635 = sub64(zm_lhs_583634, (int64_t) 1);
            int64_t min_res_583636 = smin64(max_res_583628, min_arg1_583635);
            int64_t defunc_0_f_res_583638 = mul64(eta_p_583621, min_res_583636);
            
            ((int64_t *) mem_586619)[i_586122] = defunc_0_f_res_583638;
        }
        
        int64_t defunc_0_foldl_res_582844;
        int64_t acc_582846 = (int64_t) 0;
        
        for (int64_t i_582845 = 0; i_582845 < dim_325730; i_582845++) {
            int64_t b_582847 = ((int64_t *) mem_586619)[i_582845];
            int64_t defunc_0_f_res_582848 = add64(acc_582846, b_582847);
            int64_t acc_tmp_588047 = defunc_0_f_res_582848;
            
            acc_582846 = acc_tmp_588047;
        }
        defunc_0_foldl_res_582844 = acc_582846;
        
        bool x_582849 = sle64((int64_t) 0, defunc_0_foldl_res_582844);
        bool y_582850 = slt64(defunc_0_foldl_res_582844, dz2080U_325731);
        bool bounds_check_582851 = x_582849 && y_582850;
        bool index_certs_582852;
        
        if (!bounds_check_582851) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582844, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586126 = 0; i_586126 < dim_325730; i_586126++) {
            double eta_p_582855 = ((double *) xys_mem_586427.mem)[write_iter_586136 * dim_325730 + i_586126];
            double eta_p_582856 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582844 * dim_325730 + i_586126];
            double defunc_0_f_res_582857 = eta_p_582855 - eta_p_582856;
            
            ((double *) mem_586627)[i_586126] = defunc_0_f_res_582857;
        }
        for (int64_t nest_i_588049 = 0; nest_i_588049 < arg_571866; nest_i_588049++) {
            ((double *) mem_586635)[nest_i_588049] = 0.0;
        }
        for (int64_t i_582860 = 0; i_582860 < arg_571866; i_582860++) {
            bool y_582862 = slt64(i_582860, dim_325730);
            bool index_certs_582863;
            
            if (!y_582862) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582860, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582865 = add64((int64_t) 1, i_582860);
            int64_t j_m_i_582866 = sub64(dim_325730, map_arg1_582865);
            bool empty_slice_582867 = j_m_i_582866 == (int64_t) 0;
            int64_t m_582868 = sub64(j_m_i_582866, (int64_t) 1);
            int64_t i_p_m_t_s_582869 = add64(map_arg1_582865, m_582868);
            bool zzero_leq_i_p_m_t_s_582870 = sle64((int64_t) 0, i_p_m_t_s_582869);
            bool i_p_m_t_s_leq_w_582871 = slt64(i_p_m_t_s_582869, dim_325730);
            bool zzero_lte_i_582872 = sle64((int64_t) 0, map_arg1_582865);
            bool i_lte_j_582873 = sle64(map_arg1_582865, dim_325730);
            bool y_582874 = i_p_m_t_s_leq_w_582871 && zzero_lte_i_582872;
            bool y_582875 = zzero_leq_i_p_m_t_s_582870 && y_582874;
            bool forwards_ok_582876 = i_lte_j_582873 && y_582875;
            bool ok_or_empty_582877 = empty_slice_582867 || forwards_ok_582876;
            bool index_certs_582878;
            
            if (!ok_or_empty_582877) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582865, ":", (long long) dim_325730, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586639 = (int64_t) 8 * j_m_i_582866;
            double this_x_582864 = ((double *) mem_586627)[i_582860];
            
            if (mem_586640_cached_sizze_588596 < bytes_586639) {
                err = lexical_realloc(ctx, &mem_586640, &mem_586640_cached_sizze_588596, bytes_586639);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586130 = 0; i_586130 < j_m_i_582866; i_586130++) {
                int64_t slice_586372 = map_arg1_582865 + i_586130;
                double eta_p_582881 = ((double *) mem_586627)[slice_586372];
                double defunc_0_ftimes_res_582882 = eta_p_582881 * eta_p_582881;
                
                ((double *) mem_586640)[i_586130] = defunc_0_ftimes_res_582882;
            }
            
            double defunc_0_foldl_res_582883;
            double acc_582885 = 0.0;
            
            for (int64_t i_582884 = 0; i_582884 < j_m_i_582866; i_582884++) {
                double b_582886 = ((double *) mem_586640)[i_582884];
                double defunc_0_f_res_582887 = acc_582885 + b_582886;
                double acc_tmp_588052 = defunc_0_f_res_582887;
                
                acc_582885 = acc_tmp_588052;
            }
            defunc_0_foldl_res_582883 = acc_582885;
            
            double sqrt_res_582888 = futrts_sqrt64(defunc_0_foldl_res_582883);
            double atan2_res_582889 = futrts_atan2_64(sqrt_res_582888, this_x_582864);
            
            ((double *) mem_586635)[i_582860] = atan2_res_582889;
        }
        for (int64_t i_586134 = 0; i_586134 < arg_571866; i_586134++) {
            double eta_p_582892 = ((double *) mem_586635)[i_586134];
            double eta_p_582893 = ((double *) mem_586457)[i_586134];
            int64_t eta_p_582894 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586134];
            int64_t eta_p_582895 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586134];
            double i64_res_582896 = sitofp_i64_f64(eta_p_582894);
            double defunc_0_fover_res_582897 = eta_p_582892 / eta_p_582893;
            double defunc_0_ftimes_res_582898 = i64_res_582896 * defunc_0_fover_res_582897;
            int64_t f64_res_582899 = fptosi_f64_i64(defunc_0_ftimes_res_582898);
            bool cond_582900 = slt64(f64_res_582899, (int64_t) 0);
            int64_t defunc_0_f_res_582901;
            
            if (cond_582900) {
                defunc_0_f_res_582901 = (int64_t) 0;
            } else {
                bool cond_582902 = sle64(eta_p_582895, f64_res_582899);
                int64_t defunc_0_f_res_f_res_582903;
                
                if (cond_582902) {
                    int64_t defunc_0_f_res_f_res_t_res_583932 = sub64(eta_p_582895, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582903 = defunc_0_f_res_f_res_t_res_583932;
                } else {
                    defunc_0_f_res_f_res_582903 = f64_res_582899;
                }
                defunc_0_f_res_582901 = defunc_0_f_res_f_res_582903;
            }
            ((int64_t *) mem_586651)[i_586134] = defunc_0_f_res_582901;
        }
        
        int64_t defunc_0_foldl_res_582905;
        int64_t acc_582907 = (int64_t) 0;
        
        for (int64_t i_582906 = 0; i_582906 < arg_571866; i_582906++) {
            int64_t b_582908 = ((int64_t *) mem_586651)[i_582906];
            int64_t defunc_0_f_res_582909 = add64(acc_582907, b_582908);
            int64_t acc_tmp_588054 = defunc_0_f_res_582909;
            
            acc_582907 = acc_tmp_588054;
        }
        defunc_0_foldl_res_582905 = acc_582907;
        
        int64_t zp_lhs_582910 = mul64(total_angle_no_325746, defunc_0_foldl_res_582844);
        int64_t get_id_from_grid_angle_res_582911 = add64(defunc_0_foldl_res_582905, zp_lhs_582910);
        bool x_582912 = sle64((int64_t) 0, get_id_from_grid_angle_res_582911);
        bool y_582913 = slt64(get_id_from_grid_angle_res_582911, total_part_no_325748);
        bool bounds_check_582914 = x_582912 && y_582913;
        bool index_certs_582915;
        
        if (!bounds_check_582914) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582911, "] out of bounds for array of shape [", (long long) total_part_no_325748, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582944 = slt64(get_id_from_grid_angle_res_582911, dzlz7bUskBzitotal_part_noz7dUzg_325735);
        bool bounds_check_582945 = x_582912 && y_582944;
        bool index_certs_582946;
        
        if (!bounds_check_582945) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582911, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586141 = ((int64_t *) xys_mem_586428.mem)[write_iter_586136];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586617, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586427.mem, write_iter_586136 * dim_325730, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        
        int64_t pref_582916 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582911];
        bool cond_582917 = get_id_from_grid_angle_res_582911 == zeze_rhs_572046;
        int64_t post_582918;
        
        if (cond_582917) {
            int64_t zm_rhs_583937 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582911];
            int64_t zm_lhs_583938 = sub64(zp_lhs_571889, zm_rhs_583937);
            int64_t zm_rhs_583939 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582911];
            int64_t post_t_res_583940 = sub64(zm_lhs_583938, zm_rhs_583939);
            
            post_582918 = post_t_res_583940;
        } else {
            int64_t zp_lhs_582927 = add64((int64_t) 1, get_id_from_grid_angle_res_582911);
            bool x_582928 = sle64((int64_t) 0, zp_lhs_582927);
            bool y_582929 = slt64(zp_lhs_582927, dzlz7bUskBzitotal_part_noz7dUzg_325735);
            bool bounds_check_582930 = x_582928 && y_582929;
            bool index_certs_582931;
            
            if (!bounds_check_582930) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582927, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582932 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582927];
            int64_t zp_rhs_582933 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582927];
            int64_t zm_lhs_582934 = add64(zp_lhs_582932, zp_rhs_582933);
            int64_t zm_rhs_582938 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582911];
            int64_t zm_lhs_582939 = sub64(zm_lhs_582934, zm_rhs_582938);
            int64_t zm_rhs_582940 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582911];
            int64_t post_f_res_582941 = sub64(zm_lhs_582939, zm_rhs_582940);
            
            post_582918 = post_f_res_582941;
        }
        
        int64_t zp_lhs_582942 = add64(pref_582916, write_iter_586136);
        int64_t zm_lhs_582943 = add64(post_582918, zp_lhs_582942);
        int64_t zm_rhs_582947 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582911];
        int64_t defunc_0_f_res_582948 = sub64(zm_lhs_582943, zm_rhs_582947);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582948) && slt64(defunc_0_f_res_582948, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_325730 - (int64_t) 1, dim_325730))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586494.mem, defunc_0_f_res_582948 * dim_325730, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586617, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582948) && slt64(defunc_0_f_res_582948, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582948] = write_iv_586141;
        }
    }
    if (mem_586673_cached_sizze_588598 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586673, &mem_586673_cached_sizze_588598, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586675_cached_sizze_588599 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586675, &mem_586675_cached_sizze_588599, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586683_cached_sizze_588600 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586683, &mem_586683_cached_sizze_588600, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586691_cached_sizze_588601 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586691, &mem_586691_cached_sizze_588601, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586707_cached_sizze_588603 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586707, &mem_586707_cached_sizze_588603, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586160 = 0; write_iter_586160 < dz2083U_325738; write_iter_586160++) {
        for (int64_t i_586146 = 0; i_586146 < dim_325730; i_586146++) {
            double eta_p_583731 = ((double *) xys_mem_586431.mem)[write_iter_586160 * dim_325730 + i_586146];
            double eta_p_583732 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586146];
            double eta_p_583733 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586146];
            int64_t eta_p_583735 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586146];
            double defunc_0_f_res_583736 = eta_p_583731 - eta_p_583732;
            double defunc_0_f_res_583738 = defunc_0_f_res_583736 / eta_p_583733;
            int64_t f64_res_583740 = fptosi_f64_i64(defunc_0_f_res_583738);
            int64_t max_res_583742 = smax64((int64_t) 0, f64_res_583740);
            int64_t zm_lhs_583748 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586146];
            int64_t min_arg1_583749 = sub64(zm_lhs_583748, (int64_t) 1);
            int64_t min_res_583750 = smin64(max_res_583742, min_arg1_583749);
            int64_t defunc_0_f_res_583752 = mul64(eta_p_583735, min_res_583750);
            
            ((int64_t *) mem_586675)[i_586146] = defunc_0_f_res_583752;
        }
        
        int64_t defunc_0_foldl_res_582694;
        int64_t acc_582696 = (int64_t) 0;
        
        for (int64_t i_582695 = 0; i_582695 < dim_325730; i_582695++) {
            int64_t b_582697 = ((int64_t *) mem_586675)[i_582695];
            int64_t defunc_0_f_res_582698 = add64(acc_582696, b_582697);
            int64_t acc_tmp_588058 = defunc_0_f_res_582698;
            
            acc_582696 = acc_tmp_588058;
        }
        defunc_0_foldl_res_582694 = acc_582696;
        
        bool x_582699 = sle64((int64_t) 0, defunc_0_foldl_res_582694);
        bool y_582700 = slt64(defunc_0_foldl_res_582694, dz2080U_325731);
        bool bounds_check_582701 = x_582699 && y_582700;
        bool index_certs_582702;
        
        if (!bounds_check_582701) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582694, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586150 = 0; i_586150 < dim_325730; i_586150++) {
            double eta_p_582705 = ((double *) xys_mem_586431.mem)[write_iter_586160 * dim_325730 + i_586150];
            double eta_p_582706 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582694 * dim_325730 + i_586150];
            double defunc_0_f_res_582707 = eta_p_582705 - eta_p_582706;
            
            ((double *) mem_586683)[i_586150] = defunc_0_f_res_582707;
        }
        for (int64_t nest_i_588060 = 0; nest_i_588060 < arg_571866; nest_i_588060++) {
            ((double *) mem_586691)[nest_i_588060] = 0.0;
        }
        for (int64_t i_582710 = 0; i_582710 < arg_571866; i_582710++) {
            bool y_582712 = slt64(i_582710, dim_325730);
            bool index_certs_582713;
            
            if (!y_582712) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582710, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582715 = add64((int64_t) 1, i_582710);
            int64_t j_m_i_582716 = sub64(dim_325730, map_arg1_582715);
            bool empty_slice_582717 = j_m_i_582716 == (int64_t) 0;
            int64_t m_582718 = sub64(j_m_i_582716, (int64_t) 1);
            int64_t i_p_m_t_s_582719 = add64(map_arg1_582715, m_582718);
            bool zzero_leq_i_p_m_t_s_582720 = sle64((int64_t) 0, i_p_m_t_s_582719);
            bool i_p_m_t_s_leq_w_582721 = slt64(i_p_m_t_s_582719, dim_325730);
            bool zzero_lte_i_582722 = sle64((int64_t) 0, map_arg1_582715);
            bool i_lte_j_582723 = sle64(map_arg1_582715, dim_325730);
            bool y_582724 = i_p_m_t_s_leq_w_582721 && zzero_lte_i_582722;
            bool y_582725 = zzero_leq_i_p_m_t_s_582720 && y_582724;
            bool forwards_ok_582726 = i_lte_j_582723 && y_582725;
            bool ok_or_empty_582727 = empty_slice_582717 || forwards_ok_582726;
            bool index_certs_582728;
            
            if (!ok_or_empty_582727) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582715, ":", (long long) dim_325730, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586695 = (int64_t) 8 * j_m_i_582716;
            double this_x_582714 = ((double *) mem_586683)[i_582710];
            
            if (mem_586696_cached_sizze_588602 < bytes_586695) {
                err = lexical_realloc(ctx, &mem_586696, &mem_586696_cached_sizze_588602, bytes_586695);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586154 = 0; i_586154 < j_m_i_582716; i_586154++) {
                int64_t slice_586367 = map_arg1_582715 + i_586154;
                double eta_p_582731 = ((double *) mem_586683)[slice_586367];
                double defunc_0_ftimes_res_582732 = eta_p_582731 * eta_p_582731;
                
                ((double *) mem_586696)[i_586154] = defunc_0_ftimes_res_582732;
            }
            
            double defunc_0_foldl_res_582733;
            double acc_582735 = 0.0;
            
            for (int64_t i_582734 = 0; i_582734 < j_m_i_582716; i_582734++) {
                double b_582736 = ((double *) mem_586696)[i_582734];
                double defunc_0_f_res_582737 = acc_582735 + b_582736;
                double acc_tmp_588063 = defunc_0_f_res_582737;
                
                acc_582735 = acc_tmp_588063;
            }
            defunc_0_foldl_res_582733 = acc_582735;
            
            double sqrt_res_582738 = futrts_sqrt64(defunc_0_foldl_res_582733);
            double atan2_res_582739 = futrts_atan2_64(sqrt_res_582738, this_x_582714);
            
            ((double *) mem_586691)[i_582710] = atan2_res_582739;
        }
        for (int64_t i_586158 = 0; i_586158 < arg_571866; i_586158++) {
            double eta_p_582742 = ((double *) mem_586691)[i_586158];
            double eta_p_582743 = ((double *) mem_586455)[i_586158];
            int64_t eta_p_582744 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586158];
            int64_t eta_p_582745 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586158];
            double i64_res_582746 = sitofp_i64_f64(eta_p_582744);
            double defunc_0_fover_res_582747 = eta_p_582742 / eta_p_582743;
            double defunc_0_ftimes_res_582748 = i64_res_582746 * defunc_0_fover_res_582747;
            int64_t f64_res_582749 = fptosi_f64_i64(defunc_0_ftimes_res_582748);
            bool cond_582750 = slt64(f64_res_582749, (int64_t) 0);
            int64_t defunc_0_f_res_582751;
            
            if (cond_582750) {
                defunc_0_f_res_582751 = (int64_t) 0;
            } else {
                bool cond_582752 = sle64(eta_p_582745, f64_res_582749);
                int64_t defunc_0_f_res_f_res_582753;
                
                if (cond_582752) {
                    int64_t defunc_0_f_res_f_res_t_res_583947 = sub64(eta_p_582745, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582753 = defunc_0_f_res_f_res_t_res_583947;
                } else {
                    defunc_0_f_res_f_res_582753 = f64_res_582749;
                }
                defunc_0_f_res_582751 = defunc_0_f_res_f_res_582753;
            }
            ((int64_t *) mem_586707)[i_586158] = defunc_0_f_res_582751;
        }
        
        int64_t defunc_0_foldl_res_582755;
        int64_t acc_582757 = (int64_t) 0;
        
        for (int64_t i_582756 = 0; i_582756 < arg_571866; i_582756++) {
            int64_t b_582758 = ((int64_t *) mem_586707)[i_582756];
            int64_t defunc_0_f_res_582759 = add64(acc_582757, b_582758);
            int64_t acc_tmp_588065 = defunc_0_f_res_582759;
            
            acc_582757 = acc_tmp_588065;
        }
        defunc_0_foldl_res_582755 = acc_582757;
        
        int64_t zp_lhs_582760 = mul64(total_angle_no_325746, defunc_0_foldl_res_582694);
        int64_t get_id_from_grid_angle_res_582761 = add64(defunc_0_foldl_res_582755, zp_lhs_582760);
        bool x_582762 = sle64((int64_t) 0, get_id_from_grid_angle_res_582761);
        bool y_582763 = slt64(get_id_from_grid_angle_res_582761, total_part_no_325748);
        bool bounds_check_582764 = x_582762 && y_582763;
        bool index_certs_582765;
        
        if (!bounds_check_582764) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582761, "] out of bounds for array of shape [", (long long) total_part_no_325748, "].", "-> #0  ftSkyline.fut:514:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582801 = slt64(get_id_from_grid_angle_res_582761, dzlz7bUskBzitotal_part_noz7dUzg_325735);
        bool bounds_check_582802 = x_582762 && y_582801;
        bool index_certs_582803;
        
        if (!bounds_check_582802) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582761, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:522:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586165 = ((int64_t *) xys_mem_586432.mem)[write_iter_586160];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586673, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586431.mem, write_iter_586160 * dim_325730, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        
        int64_t pref_582766 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582761];
        bool cond_582767 = get_id_from_grid_angle_res_582761 == zeze_rhs_572046;
        int64_t post_582768;
        
        if (cond_582767) {
            int64_t zm_rhs_583953 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_583954 = sub64(zp_lhs_571890, zm_rhs_583953);
            int64_t zm_rhs_583955 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_583956 = sub64(zm_lhs_583954, zm_rhs_583955);
            int64_t zm_rhs_583957 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582761];
            int64_t post_t_res_583958 = sub64(zm_lhs_583956, zm_rhs_583957);
            
            post_582768 = post_t_res_583958;
        } else {
            int64_t zp_lhs_582780 = add64((int64_t) 1, get_id_from_grid_angle_res_582761);
            bool x_582781 = sle64((int64_t) 0, zp_lhs_582780);
            bool y_582782 = slt64(zp_lhs_582780, dzlz7bUskBzitotal_part_noz7dUzg_325735);
            bool bounds_check_582783 = x_582781 && y_582782;
            bool index_certs_582784;
            
            if (!bounds_check_582783) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582780, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:520:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582785 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582780];
            int64_t zp_rhs_582786 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582780];
            int64_t zp_lhs_582787 = add64(zp_lhs_582785, zp_rhs_582786);
            int64_t zp_rhs_582788 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582780];
            int64_t zm_lhs_582789 = add64(zp_lhs_582787, zp_rhs_582788);
            int64_t zm_rhs_582793 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_582794 = sub64(zm_lhs_582789, zm_rhs_582793);
            int64_t zm_rhs_582795 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_582796 = sub64(zm_lhs_582794, zm_rhs_582795);
            int64_t zm_rhs_582797 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582761];
            int64_t post_f_res_582798 = sub64(zm_lhs_582796, zm_rhs_582797);
            
            post_582768 = post_f_res_582798;
        }
        
        int64_t zp_lhs_582799 = add64(pref_582766, write_iter_586160);
        int64_t zm_lhs_582800 = add64(post_582768, zp_lhs_582799);
        int64_t zm_rhs_582804 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582761];
        int64_t defunc_0_f_res_582805 = sub64(zm_lhs_582800, zm_rhs_582804);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582805) && slt64(defunc_0_f_res_582805, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_325730 - (int64_t) 1, dim_325730))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586494.mem, defunc_0_f_res_582805 * dim_325730, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586673, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582805) && slt64(defunc_0_f_res_582805, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582805] = write_iv_586165;
        }
    }
    if (mem_586729_cached_sizze_588604 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586729, &mem_586729_cached_sizze_588604, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586731_cached_sizze_588605 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586731, &mem_586731_cached_sizze_588605, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586739_cached_sizze_588606 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586739, &mem_586739_cached_sizze_588606, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586747_cached_sizze_588607 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586747, &mem_586747_cached_sizze_588607, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586763_cached_sizze_588609 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586763, &mem_586763_cached_sizze_588609, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586184 = 0; write_iter_586184 < dz2083U_325739; write_iter_586184++) {
        for (int64_t i_586170 = 0; i_586170 < dim_325730; i_586170++) {
            double eta_p_583851 = ((double *) xys_mem_586435.mem)[write_iter_586184 * dim_325730 + i_586170];
            double eta_p_583852 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586170];
            double eta_p_583853 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586170];
            int64_t eta_p_583855 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586170];
            double defunc_0_f_res_583856 = eta_p_583851 - eta_p_583852;
            double defunc_0_f_res_583858 = defunc_0_f_res_583856 / eta_p_583853;
            int64_t f64_res_583860 = fptosi_f64_i64(defunc_0_f_res_583858);
            int64_t max_res_583862 = smax64((int64_t) 0, f64_res_583860);
            int64_t zm_lhs_583868 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586170];
            int64_t min_arg1_583869 = sub64(zm_lhs_583868, (int64_t) 1);
            int64_t min_res_583870 = smin64(max_res_583862, min_arg1_583869);
            int64_t defunc_0_f_res_583872 = mul64(eta_p_583855, min_res_583870);
            
            ((int64_t *) mem_586731)[i_586170] = defunc_0_f_res_583872;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_325730; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586731)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588069 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588069;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_325731);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_325731, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586174 = 0; i_586174 < dim_325730; i_586174++) {
            double eta_p_582548 = ((double *) xys_mem_586435.mem)[write_iter_586184 * dim_325730 + i_586174];
            double eta_p_582549 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_325730 + i_586174];
            double defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((double *) mem_586739)[i_586174] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588071 = 0; nest_i_588071 < arg_571866; nest_i_588071++) {
            ((double *) mem_586747)[nest_i_588071] = 0.0;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_571866; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_325730);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_325730, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_325730);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_325730);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_325730, "] out of bounds for array of shape [", (long long) dim_325730, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586751 = (int64_t) 8 * j_m_i_582559;
            double this_x_582557 = ((double *) mem_586739)[i_582553];
            
            if (mem_586752_cached_sizze_588608 < bytes_586751) {
                err = lexical_realloc(ctx, &mem_586752, &mem_586752_cached_sizze_588608, bytes_586751);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586178 = 0; i_586178 < j_m_i_582559; i_586178++) {
                int64_t slice_586362 = map_arg1_582558 + i_586178;
                double eta_p_582574 = ((double *) mem_586739)[slice_586362];
                double defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((double *) mem_586752)[i_586178] = defunc_0_ftimes_res_582575;
            }
            
            double defunc_0_foldl_res_582576;
            double acc_582578 = 0.0;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                double b_582579 = ((double *) mem_586752)[i_582577];
                double defunc_0_f_res_582580 = acc_582578 + b_582579;
                double acc_tmp_588074 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588074;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            double sqrt_res_582581 = futrts_sqrt64(defunc_0_foldl_res_582576);
            double atan2_res_582582 = futrts_atan2_64(sqrt_res_582581, this_x_582557);
            
            ((double *) mem_586747)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586182 = 0; i_586182 < arg_571866; i_586182++) {
            double eta_p_582585 = ((double *) mem_586747)[i_586182];
            double eta_p_582586 = ((double *) mem_586453)[i_586182];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586182];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586182];
            double i64_res_582589 = sitofp_i64_f64(eta_p_582587);
            double defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            double defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f64_res_582592 = fptosi_f64_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f64_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f64_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583965 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583965;
                } else {
                    defunc_0_f_res_f_res_582596 = f64_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586763)[i_586182] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_571866; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586763)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588076 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588076;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_325746, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_325748);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_325748, "].", "-> #0  ftSkyline.fut:530:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582651 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_325735);
        bool bounds_check_582652 = x_582605 && y_582651;
        bool index_certs_582653;
        
        if (!bounds_check_582652) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:539:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586189 = ((int64_t *) xys_mem_586436.mem)[write_iter_586184];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586729, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xys_mem_586435.mem, write_iter_586184 * dim_325730, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        
        int64_t pref_582609 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_572046;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_lhs_583968 = add64(dz2083U_325738, zp_lhs_571890);
            int64_t zm_rhs_583972 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583973 = sub64(zm_lhs_583968, zm_rhs_583972);
            int64_t zm_rhs_583974 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583975 = sub64(zm_lhs_583973, zm_rhs_583974);
            int64_t zm_rhs_583976 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583977 = sub64(zm_lhs_583975, zm_rhs_583976);
            int64_t zm_rhs_583978 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583979 = sub64(zm_lhs_583977, zm_rhs_583978);
            
            post_582611 = post_t_res_583979;
        } else {
            int64_t zp_lhs_582626 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582627 = sle64((int64_t) 0, zp_lhs_582626);
            bool y_582628 = slt64(zp_lhs_582626, dzlz7bUskBzitotal_part_noz7dUzg_325735);
            bool bounds_check_582629 = x_582627 && y_582628;
            bool index_certs_582630;
            
            if (!bounds_check_582629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582626, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_325735, "].", "-> #0  ftSkyline.fut:537:57-77\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:833:17-842:96\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582631 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582626];
            int64_t zp_rhs_582632 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582626];
            int64_t zp_lhs_582633 = add64(zp_lhs_582631, zp_rhs_582632);
            int64_t zp_rhs_582634 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582626];
            int64_t zp_lhs_582635 = add64(zp_lhs_582633, zp_rhs_582634);
            int64_t zp_rhs_582636 = ((int64_t *) part_idx_mem_586430.mem)[zp_lhs_582626];
            int64_t zm_lhs_582637 = add64(zp_lhs_582635, zp_rhs_582636);
            int64_t zm_rhs_582641 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582642 = sub64(zm_lhs_582637, zm_rhs_582641);
            int64_t zm_rhs_582643 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582644 = sub64(zm_lhs_582642, zm_rhs_582643);
            int64_t zm_rhs_582645 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582646 = sub64(zm_lhs_582644, zm_rhs_582645);
            int64_t zm_rhs_582647 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582648 = sub64(zm_lhs_582646, zm_rhs_582647);
            
            post_582611 = post_f_res_582648;
        }
        
        int64_t zp_lhs_582649 = add64(pref_582609, write_iter_586184);
        int64_t zm_lhs_582650 = add64(post_582611, zp_lhs_582649);
        int64_t zm_rhs_582654 = ((int64_t *) part_idx_mem_586434.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582655 = sub64(zm_lhs_582650, zm_rhs_582654);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582655) && slt64(defunc_0_f_res_582655, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_325730 - (int64_t) 1, dim_325730))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586494.mem, defunc_0_f_res_582655 * dim_325730, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586729, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_325730});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582655) && slt64(defunc_0_f_res_582655, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582655] = write_iv_586189;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586437, "mem_586437") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586445, "mem_586445") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586494, "mem_586494") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586496, "mem_586496") != 0)
        return 1;
    prim_out_588011 = n_total_571892;
    if (memblock_set(ctx, &*mem_out_p_588570, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588571, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588572, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588573, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588574 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586453);
        free(mem_586455);
        free(mem_586457);
        free(mem_586459);
        free(mem_586461);
        free(mem_586505);
        free(mem_586507);
        free(mem_586515);
        free(mem_586523);
        free(mem_586528);
        free(mem_586539);
        free(mem_586561);
        free(mem_586563);
        free(mem_586571);
        free(mem_586579);
        free(mem_586584);
        free(mem_586595);
        free(mem_586617);
        free(mem_586619);
        free(mem_586627);
        free(mem_586635);
        free(mem_586640);
        free(mem_586651);
        free(mem_586673);
        free(mem_586675);
        free(mem_586683);
        free(mem_586691);
        free(mem_586696);
        free(mem_586707);
        free(mem_586729);
        free(mem_586731);
        free(mem_586739);
        free(mem_586747);
        free(mem_586752);
        free(mem_586763);
        if (memblock_unref(ctx, &mem_586496, "mem_586496") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586494, "mem_586494") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586445, "mem_586445") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586437, "mem_586437") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_merge_Skylines_5_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588610, struct memblock *mem_out_p_588611, struct memblock *mem_out_p_588612, struct memblock *mem_out_p_588613, int64_t *out_prim_out_588614, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock isPartitionDominated_mem_586417, struct memblock part_idx_mem_586418, struct memblock xys_mem_586419, struct memblock xys_mem_586420, struct memblock isPartitionDominated_mem_586421, struct memblock part_idx_mem_586422, struct memblock xys_mem_586423, struct memblock xys_mem_586424, struct memblock isPartitionDominated_mem_586425, struct memblock part_idx_mem_586426, struct memblock xys_mem_586427, struct memblock xys_mem_586428, struct memblock isPartitionDominated_mem_586429, struct memblock part_idx_mem_586430, struct memblock xys_mem_586431, struct memblock xys_mem_586432, struct memblock isPartitionDominated_mem_586433, struct memblock part_idx_mem_586434, struct memblock xys_mem_586435, struct memblock xys_mem_586436, int64_t dim_489515, int64_t dz2080U_489516, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517, int64_t dz2083U_489518, int64_t dz2081U_489519, int64_t dzlz7bUskBzitotal_part_noz7dUzg_489520, int64_t dz2083U_489521, int64_t dz2083U_489522, int64_t dz2083U_489523, int64_t dz2083U_489524, int64_t total_angle_no_489531, int64_t total_grid_no_489532, int64_t total_part_no_489533)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586453_cached_sizze_588615 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_588616 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586457_cached_sizze_588617 = 0;
    unsigned char *mem_586457 = NULL;
    int64_t mem_586459_cached_sizze_588618 = 0;
    unsigned char *mem_586459 = NULL;
    int64_t mem_586461_cached_sizze_588619 = 0;
    unsigned char *mem_586461 = NULL;
    int64_t mem_586505_cached_sizze_588620 = 0;
    unsigned char *mem_586505 = NULL;
    int64_t mem_586507_cached_sizze_588621 = 0;
    unsigned char *mem_586507 = NULL;
    int64_t mem_586515_cached_sizze_588622 = 0;
    unsigned char *mem_586515 = NULL;
    int64_t mem_586523_cached_sizze_588623 = 0;
    unsigned char *mem_586523 = NULL;
    int64_t mem_586528_cached_sizze_588624 = 0;
    unsigned char *mem_586528 = NULL;
    int64_t mem_586539_cached_sizze_588625 = 0;
    unsigned char *mem_586539 = NULL;
    int64_t mem_586561_cached_sizze_588626 = 0;
    unsigned char *mem_586561 = NULL;
    int64_t mem_586563_cached_sizze_588627 = 0;
    unsigned char *mem_586563 = NULL;
    int64_t mem_586571_cached_sizze_588628 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586579_cached_sizze_588629 = 0;
    unsigned char *mem_586579 = NULL;
    int64_t mem_586584_cached_sizze_588630 = 0;
    unsigned char *mem_586584 = NULL;
    int64_t mem_586595_cached_sizze_588631 = 0;
    unsigned char *mem_586595 = NULL;
    int64_t mem_586617_cached_sizze_588632 = 0;
    unsigned char *mem_586617 = NULL;
    int64_t mem_586619_cached_sizze_588633 = 0;
    unsigned char *mem_586619 = NULL;
    int64_t mem_586627_cached_sizze_588634 = 0;
    unsigned char *mem_586627 = NULL;
    int64_t mem_586635_cached_sizze_588635 = 0;
    unsigned char *mem_586635 = NULL;
    int64_t mem_586640_cached_sizze_588636 = 0;
    unsigned char *mem_586640 = NULL;
    int64_t mem_586651_cached_sizze_588637 = 0;
    unsigned char *mem_586651 = NULL;
    int64_t mem_586673_cached_sizze_588638 = 0;
    unsigned char *mem_586673 = NULL;
    int64_t mem_586675_cached_sizze_588639 = 0;
    unsigned char *mem_586675 = NULL;
    int64_t mem_586683_cached_sizze_588640 = 0;
    unsigned char *mem_586683 = NULL;
    int64_t mem_586691_cached_sizze_588641 = 0;
    unsigned char *mem_586691 = NULL;
    int64_t mem_586696_cached_sizze_588642 = 0;
    unsigned char *mem_586696 = NULL;
    int64_t mem_586707_cached_sizze_588643 = 0;
    unsigned char *mem_586707 = NULL;
    int64_t mem_586729_cached_sizze_588644 = 0;
    unsigned char *mem_586729 = NULL;
    int64_t mem_586731_cached_sizze_588645 = 0;
    unsigned char *mem_586731 = NULL;
    int64_t mem_586739_cached_sizze_588646 = 0;
    unsigned char *mem_586739 = NULL;
    int64_t mem_586747_cached_sizze_588647 = 0;
    unsigned char *mem_586747 = NULL;
    int64_t mem_586752_cached_sizze_588648 = 0;
    unsigned char *mem_586752 = NULL;
    int64_t mem_586763_cached_sizze_588649 = 0;
    unsigned char *mem_586763 = NULL;
    struct memblock mem_586496;
    
    mem_586496.references = NULL;
    
    struct memblock mem_586494;
    
    mem_586494.references = NULL;
    
    struct memblock mem_586445;
    
    mem_586445.references = NULL;
    
    struct memblock mem_586437;
    
    mem_586437.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t arg_571866 = sub64(dim_489515, (int64_t) 1);
    bool assert_cond_t_res_571867 = arg_571866 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517;
    bool assert_c_571868;
    
    if (!assert_cond_t_res_571867) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:980:17-989:95\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586444 = (int64_t) 8 * dzlz7bUskBzitotal_part_noz7dUzg_489520;
    int64_t zp_lhs_571889 = add64(dz2083U_489518, dz2083U_489521);
    int64_t zp_lhs_571890 = add64(dz2083U_489522, zp_lhs_571889);
    int64_t zp_lhs_571891 = add64(dz2083U_489523, zp_lhs_571890);
    int64_t n_total_571892 = add64(dz2083U_489524, zp_lhs_571891);
    bool dim_match_571894 = total_part_no_489533 == dzlz7bUskBzitotal_part_noz7dUzg_489520;
    bool empty_or_match_cert_571895;
    
    if (!dim_match_571894) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  unknown location\n   #1  ftSkyline.fut:980:17-989:95\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_571896 = slt64((int64_t) 0, dz2080U_489516);
    bool index_certs_571897;
    
    if (!y_571896) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586452 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517;
    bool empty_or_match_cert_571911;
    
    if (!assert_cond_t_res_571867) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586492 = (int64_t) 4 * n_total_571892;
    int64_t bytes_586493 = dim_489515 * binop_x_586492;
    int64_t bytes_586495 = (int64_t) 8 * n_total_571892;
    int64_t bytes_586504 = (int64_t) 4 * dim_489515;
    int64_t bytes_586506 = (int64_t) 8 * dim_489515;
    int64_t bytes_586522 = (int64_t) 4 * arg_571866;
    int64_t bytes_586538 = (int64_t) 8 * arg_571866;
    
    if (memblock_alloc(ctx, &mem_586437, dz2081U_489519, "mem_586437")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < dz2081U_489519; i_586050++) {
        bool eta_p_571870 = ((bool *) isPartitionDominated_mem_586417.mem)[i_586050];
        bool eta_p_571871 = ((bool *) isPartitionDominated_mem_586421.mem)[i_586050];
        bool eta_p_571872 = ((bool *) isPartitionDominated_mem_586425.mem)[i_586050];
        bool eta_p_571873 = ((bool *) isPartitionDominated_mem_586429.mem)[i_586050];
        bool eta_p_571874 = ((bool *) isPartitionDominated_mem_586433.mem)[i_586050];
        bool cond_571875 = eta_p_571870 || eta_p_571871;
        bool cond_571876 = eta_p_571872 || cond_571875;
        bool cond_571877 = eta_p_571873 || cond_571876;
        bool lifted_lambda_res_571878 = eta_p_571874 || cond_571877;
        
        ((bool *) mem_586437.mem)[i_586050] = lifted_lambda_res_571878;
    }
    if (memblock_alloc(ctx, &mem_586445, bytes_586444, "mem_586445")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586054 = 0; i_586054 < dzlz7bUskBzitotal_part_noz7dUzg_489520; i_586054++) {
        int64_t eta_p_571880 = ((int64_t *) part_idx_mem_586418.mem)[i_586054];
        int64_t eta_p_571881 = ((int64_t *) part_idx_mem_586422.mem)[i_586054];
        int64_t eta_p_571882 = ((int64_t *) part_idx_mem_586426.mem)[i_586054];
        int64_t eta_p_571883 = ((int64_t *) part_idx_mem_586430.mem)[i_586054];
        int64_t eta_p_571884 = ((int64_t *) part_idx_mem_586434.mem)[i_586054];
        int64_t zp_lhs_571885 = add64(eta_p_571880, eta_p_571881);
        int64_t zp_lhs_571886 = add64(eta_p_571882, zp_lhs_571885);
        int64_t zp_lhs_571887 = add64(eta_p_571883, zp_lhs_571886);
        int64_t lifted_lambda_res_571888 = add64(eta_p_571884, zp_lhs_571887);
        
        ((int64_t *) mem_586445.mem)[i_586054] = lifted_lambda_res_571888;
    }
    if (mem_586453_cached_sizze_588615 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588615, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586455_cached_sizze_588616 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_588616, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586457_cached_sizze_588617 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586457, &mem_586457_cached_sizze_588617, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586459_cached_sizze_588618 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586459, &mem_586459_cached_sizze_588618, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586461_cached_sizze_588619 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_586461, &mem_586461_cached_sizze_588619, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586066 = 0; i_586066 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517; i_586066++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583304 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586066];
        float i64_res_583305 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_583304);
        float defunc_0_fover_res_583306 = 1.5707964F / i64_res_583305;
        
        ((float *) mem_586453)[i_586066] = defunc_0_fover_res_583306;
        ((float *) mem_586455)[i_586066] = defunc_0_fover_res_583306;
        ((float *) mem_586457)[i_586066] = defunc_0_fover_res_583306;
        ((float *) mem_586459)[i_586066] = defunc_0_fover_res_583306;
        ((float *) mem_586461)[i_586066] = defunc_0_fover_res_583306;
    }
    if (memblock_alloc(ctx, &mem_586494, bytes_586493, "mem_586494")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588019 = 0; nest_i_588019 < n_total_571892; nest_i_588019++) {
        for (int64_t nest_i_588020 = 0; nest_i_588020 < dim_489515; nest_i_588020++) {
            ((float *) mem_586494.mem)[nest_i_588019 * dim_489515 + nest_i_588020] = INFINITY;
        }
    }
    if (memblock_alloc(ctx, &mem_586496, bytes_586495, "mem_586496")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_588021 = 0; nest_i_588021 < n_total_571892; nest_i_588021++) {
        ((int64_t *) mem_586496.mem)[nest_i_588021] = (int64_t) -1;
    }
    if (mem_586505_cached_sizze_588620 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586505, &mem_586505_cached_sizze_588620, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586507_cached_sizze_588621 < bytes_586506) {
        err = lexical_realloc(ctx, &mem_586507, &mem_586507_cached_sizze_588621, bytes_586506);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586515_cached_sizze_588622 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586515, &mem_586515_cached_sizze_588622, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586523_cached_sizze_588623 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586523, &mem_586523_cached_sizze_588623, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586539_cached_sizze_588625 < bytes_586538) {
        err = lexical_realloc(ctx, &mem_586539, &mem_586539_cached_sizze_588625, bytes_586538);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586088 = 0; write_iter_586088 < dz2083U_489518; write_iter_586088++) {
        for (int64_t i_586074 = 0; i_586074 < dim_489515; i_586074++) {
            float eta_p_583411 = ((float *) xys_mem_586419.mem)[write_iter_586088 * dim_489515 + i_586074];
            float eta_p_583412 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586074];
            float eta_p_583413 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586074];
            int64_t eta_p_583415 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586074];
            float defunc_0_f_res_583416 = eta_p_583411 - eta_p_583412;
            float defunc_0_f_res_583418 = defunc_0_f_res_583416 / eta_p_583413;
            int64_t f32_res_583420 = fptosi_f32_i64(defunc_0_f_res_583418);
            int64_t max_res_583422 = smax64((int64_t) 0, f32_res_583420);
            int64_t zm_lhs_583428 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586074];
            int64_t min_arg1_583429 = sub64(zm_lhs_583428, (int64_t) 1);
            int64_t min_res_583430 = smin64(max_res_583422, min_arg1_583429);
            int64_t defunc_0_f_res_583432 = mul64(eta_p_583415, min_res_583430);
            
            ((int64_t *) mem_586507)[i_586074] = defunc_0_f_res_583432;
        }
        
        int64_t defunc_0_foldl_res_583123;
        int64_t acc_583125 = (int64_t) 0;
        
        for (int64_t i_583124 = 0; i_583124 < dim_489515; i_583124++) {
            int64_t b_583126 = ((int64_t *) mem_586507)[i_583124];
            int64_t defunc_0_f_res_583127 = add64(acc_583125, b_583126);
            int64_t acc_tmp_588025 = defunc_0_f_res_583127;
            
            acc_583125 = acc_tmp_588025;
        }
        defunc_0_foldl_res_583123 = acc_583125;
        
        bool x_583128 = sle64((int64_t) 0, defunc_0_foldl_res_583123);
        bool y_583129 = slt64(defunc_0_foldl_res_583123, dz2080U_489516);
        bool bounds_check_583130 = x_583128 && y_583129;
        bool index_certs_583131;
        
        if (!bounds_check_583130) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_583123, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586078 = 0; i_586078 < dim_489515; i_586078++) {
            float eta_p_583134 = ((float *) xys_mem_586419.mem)[write_iter_586088 * dim_489515 + i_586078];
            float eta_p_583135 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_583123 * dim_489515 + i_586078];
            float defunc_0_f_res_583136 = eta_p_583134 - eta_p_583135;
            
            ((float *) mem_586515)[i_586078] = defunc_0_f_res_583136;
        }
        for (int64_t nest_i_588027 = 0; nest_i_588027 < arg_571866; nest_i_588027++) {
            ((float *) mem_586523)[nest_i_588027] = 0.0F;
        }
        for (int64_t i_583139 = 0; i_583139 < arg_571866; i_583139++) {
            bool y_583141 = slt64(i_583139, dim_489515);
            bool index_certs_583142;
            
            if (!y_583141) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_583139, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_583144 = add64((int64_t) 1, i_583139);
            int64_t j_m_i_583145 = sub64(dim_489515, map_arg1_583144);
            bool empty_slice_583146 = j_m_i_583145 == (int64_t) 0;
            int64_t m_583147 = sub64(j_m_i_583145, (int64_t) 1);
            int64_t i_p_m_t_s_583148 = add64(map_arg1_583144, m_583147);
            bool zzero_leq_i_p_m_t_s_583149 = sle64((int64_t) 0, i_p_m_t_s_583148);
            bool i_p_m_t_s_leq_w_583150 = slt64(i_p_m_t_s_583148, dim_489515);
            bool zzero_lte_i_583151 = sle64((int64_t) 0, map_arg1_583144);
            bool i_lte_j_583152 = sle64(map_arg1_583144, dim_489515);
            bool y_583153 = i_p_m_t_s_leq_w_583150 && zzero_lte_i_583151;
            bool y_583154 = zzero_leq_i_p_m_t_s_583149 && y_583153;
            bool forwards_ok_583155 = i_lte_j_583152 && y_583154;
            bool ok_or_empty_583156 = empty_slice_583146 || forwards_ok_583155;
            bool index_certs_583157;
            
            if (!ok_or_empty_583156) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_583144, ":", (long long) dim_489515, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:474:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586527 = (int64_t) 4 * j_m_i_583145;
            float this_x_583143 = ((float *) mem_586515)[i_583139];
            
            if (mem_586528_cached_sizze_588624 < bytes_586527) {
                err = lexical_realloc(ctx, &mem_586528, &mem_586528_cached_sizze_588624, bytes_586527);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586082 = 0; i_586082 < j_m_i_583145; i_586082++) {
                int64_t slice_586382 = map_arg1_583144 + i_586082;
                float eta_p_583160 = ((float *) mem_586515)[slice_586382];
                float defunc_0_ftimes_res_583161 = eta_p_583160 * eta_p_583160;
                
                ((float *) mem_586528)[i_586082] = defunc_0_ftimes_res_583161;
            }
            
            float defunc_0_foldl_res_583162;
            float acc_583164 = 0.0F;
            
            for (int64_t i_583163 = 0; i_583163 < j_m_i_583145; i_583163++) {
                float b_583165 = ((float *) mem_586528)[i_583163];
                float defunc_0_f_res_583166 = acc_583164 + b_583165;
                float acc_tmp_588030 = defunc_0_f_res_583166;
                
                acc_583164 = acc_tmp_588030;
            }
            defunc_0_foldl_res_583162 = acc_583164;
            
            float sqrt_res_583167 = futrts_sqrt32(defunc_0_foldl_res_583162);
            float atan2_res_583168 = futrts_atan2_32(sqrt_res_583167, this_x_583143);
            
            ((float *) mem_586523)[i_583139] = atan2_res_583168;
        }
        for (int64_t i_586086 = 0; i_586086 < arg_571866; i_586086++) {
            float eta_p_583171 = ((float *) mem_586523)[i_586086];
            float eta_p_583172 = ((float *) mem_586461)[i_586086];
            int64_t eta_p_583173 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586086];
            int64_t eta_p_583174 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586086];
            float i64_res_583175 = sitofp_i64_f32(eta_p_583173);
            float defunc_0_fover_res_583176 = eta_p_583171 / eta_p_583172;
            float defunc_0_ftimes_res_583177 = i64_res_583175 * defunc_0_fover_res_583176;
            int64_t f32_res_583178 = fptosi_f32_i64(defunc_0_ftimes_res_583177);
            bool cond_583179 = slt64(f32_res_583178, (int64_t) 0);
            int64_t defunc_0_f_res_583180;
            
            if (cond_583179) {
                defunc_0_f_res_583180 = (int64_t) 0;
            } else {
                bool cond_583181 = sle64(eta_p_583174, f32_res_583178);
                int64_t defunc_0_f_res_f_res_583182;
                
                if (cond_583181) {
                    int64_t defunc_0_f_res_f_res_t_res_583913 = sub64(eta_p_583174, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583182 = defunc_0_f_res_f_res_t_res_583913;
                } else {
                    defunc_0_f_res_f_res_583182 = f32_res_583178;
                }
                defunc_0_f_res_583180 = defunc_0_f_res_f_res_583182;
            }
            ((int64_t *) mem_586539)[i_586086] = defunc_0_f_res_583180;
        }
        
        int64_t defunc_0_foldl_res_583184;
        int64_t acc_583186 = (int64_t) 0;
        
        for (int64_t i_583185 = 0; i_583185 < arg_571866; i_583185++) {
            int64_t b_583187 = ((int64_t *) mem_586539)[i_583185];
            int64_t defunc_0_f_res_583188 = add64(acc_583186, b_583187);
            int64_t acc_tmp_588032 = defunc_0_f_res_583188;
            
            acc_583186 = acc_tmp_588032;
        }
        defunc_0_foldl_res_583184 = acc_583186;
        
        int64_t zp_lhs_583189 = mul64(total_angle_no_489531, defunc_0_foldl_res_583123);
        int64_t get_id_from_grid_angle_res_583190 = add64(defunc_0_foldl_res_583184, zp_lhs_583189);
        bool x_583191 = sle64((int64_t) 0, get_id_from_grid_angle_res_583190);
        bool y_583192 = slt64(get_id_from_grid_angle_res_583190, total_part_no_489533);
        bool bounds_check_583193 = x_583191 && y_583192;
        bool index_certs_583194;
        
        if (!bounds_check_583193) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583190, "] out of bounds for array of shape [", (long long) total_part_no_489533, "].", "-> #0  ftSkyline.fut:475:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583197 = slt64(get_id_from_grid_angle_res_583190, dzlz7bUskBzitotal_part_noz7dUzg_489520);
        bool bounds_check_583198 = x_583191 && y_583197;
        bool index_certs_583199;
        
        if (!bounds_check_583198) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583190, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:477:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586093 = ((int64_t *) xys_mem_586420.mem)[write_iter_586088];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586505, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586419.mem, write_iter_586088 * dim_489515, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        
        int64_t pref_583195 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_583190];
        int64_t zp_lhs_583196 = add64(pref_583195, write_iter_586088);
        int64_t zm_rhs_583200 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583190];
        int64_t defunc_0_f_res_583201 = sub64(zp_lhs_583196, zm_rhs_583200);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583201) && slt64(defunc_0_f_res_583201, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_489515 - (int64_t) 1, dim_489515))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586494.mem, defunc_0_f_res_583201 * dim_489515, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586505, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583201) && slt64(defunc_0_f_res_583201, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_583201] = write_iv_586093;
        }
    }
    
    int64_t zeze_rhs_572046 = sub64(dzlz7bUskBzitotal_part_noz7dUzg_489520, (int64_t) 1);
    
    if (mem_586561_cached_sizze_588626 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586561, &mem_586561_cached_sizze_588626, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586563_cached_sizze_588627 < bytes_586506) {
        err = lexical_realloc(ctx, &mem_586563, &mem_586563_cached_sizze_588627, bytes_586506);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586571_cached_sizze_588628 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588628, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586579_cached_sizze_588629 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586579, &mem_586579_cached_sizze_588629, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586595_cached_sizze_588631 < bytes_586538) {
        err = lexical_realloc(ctx, &mem_586595, &mem_586595_cached_sizze_588631, bytes_586538);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586112 = 0; write_iter_586112 < dz2083U_489521; write_iter_586112++) {
        for (int64_t i_586098 = 0; i_586098 < dim_489515; i_586098++) {
            float eta_p_583509 = ((float *) xys_mem_586423.mem)[write_iter_586112 * dim_489515 + i_586098];
            float eta_p_583510 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586098];
            float eta_p_583511 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586098];
            int64_t eta_p_583513 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586098];
            float defunc_0_f_res_583514 = eta_p_583509 - eta_p_583510;
            float defunc_0_f_res_583516 = defunc_0_f_res_583514 / eta_p_583511;
            int64_t f32_res_583518 = fptosi_f32_i64(defunc_0_f_res_583516);
            int64_t max_res_583520 = smax64((int64_t) 0, f32_res_583518);
            int64_t zm_lhs_583526 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586098];
            int64_t min_arg1_583527 = sub64(zm_lhs_583526, (int64_t) 1);
            int64_t min_res_583528 = smin64(max_res_583520, min_arg1_583527);
            int64_t defunc_0_f_res_583530 = mul64(eta_p_583513, min_res_583528);
            
            ((int64_t *) mem_586563)[i_586098] = defunc_0_f_res_583530;
        }
        
        int64_t defunc_0_foldl_res_582987;
        int64_t acc_582989 = (int64_t) 0;
        
        for (int64_t i_582988 = 0; i_582988 < dim_489515; i_582988++) {
            int64_t b_582990 = ((int64_t *) mem_586563)[i_582988];
            int64_t defunc_0_f_res_582991 = add64(acc_582989, b_582990);
            int64_t acc_tmp_588036 = defunc_0_f_res_582991;
            
            acc_582989 = acc_tmp_588036;
        }
        defunc_0_foldl_res_582987 = acc_582989;
        
        bool x_582992 = sle64((int64_t) 0, defunc_0_foldl_res_582987);
        bool y_582993 = slt64(defunc_0_foldl_res_582987, dz2080U_489516);
        bool bounds_check_582994 = x_582992 && y_582993;
        bool index_certs_582995;
        
        if (!bounds_check_582994) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582987, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586102 = 0; i_586102 < dim_489515; i_586102++) {
            float eta_p_582998 = ((float *) xys_mem_586423.mem)[write_iter_586112 * dim_489515 + i_586102];
            float eta_p_582999 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582987 * dim_489515 + i_586102];
            float defunc_0_f_res_583000 = eta_p_582998 - eta_p_582999;
            
            ((float *) mem_586571)[i_586102] = defunc_0_f_res_583000;
        }
        for (int64_t nest_i_588038 = 0; nest_i_588038 < arg_571866; nest_i_588038++) {
            ((float *) mem_586579)[nest_i_588038] = 0.0F;
        }
        for (int64_t i_583003 = 0; i_583003 < arg_571866; i_583003++) {
            bool y_583005 = slt64(i_583003, dim_489515);
            bool index_certs_583006;
            
            if (!y_583005) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_583003, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_583008 = add64((int64_t) 1, i_583003);
            int64_t j_m_i_583009 = sub64(dim_489515, map_arg1_583008);
            bool empty_slice_583010 = j_m_i_583009 == (int64_t) 0;
            int64_t m_583011 = sub64(j_m_i_583009, (int64_t) 1);
            int64_t i_p_m_t_s_583012 = add64(map_arg1_583008, m_583011);
            bool zzero_leq_i_p_m_t_s_583013 = sle64((int64_t) 0, i_p_m_t_s_583012);
            bool i_p_m_t_s_leq_w_583014 = slt64(i_p_m_t_s_583012, dim_489515);
            bool zzero_lte_i_583015 = sle64((int64_t) 0, map_arg1_583008);
            bool i_lte_j_583016 = sle64(map_arg1_583008, dim_489515);
            bool y_583017 = i_p_m_t_s_leq_w_583014 && zzero_lte_i_583015;
            bool y_583018 = zzero_leq_i_p_m_t_s_583013 && y_583017;
            bool forwards_ok_583019 = i_lte_j_583016 && y_583018;
            bool ok_or_empty_583020 = empty_slice_583010 || forwards_ok_583019;
            bool index_certs_583021;
            
            if (!ok_or_empty_583020) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_583008, ":", (long long) dim_489515, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:484:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586583 = (int64_t) 4 * j_m_i_583009;
            float this_x_583007 = ((float *) mem_586571)[i_583003];
            
            if (mem_586584_cached_sizze_588630 < bytes_586583) {
                err = lexical_realloc(ctx, &mem_586584, &mem_586584_cached_sizze_588630, bytes_586583);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586106 = 0; i_586106 < j_m_i_583009; i_586106++) {
                int64_t slice_586377 = map_arg1_583008 + i_586106;
                float eta_p_583024 = ((float *) mem_586571)[slice_586377];
                float defunc_0_ftimes_res_583025 = eta_p_583024 * eta_p_583024;
                
                ((float *) mem_586584)[i_586106] = defunc_0_ftimes_res_583025;
            }
            
            float defunc_0_foldl_res_583026;
            float acc_583028 = 0.0F;
            
            for (int64_t i_583027 = 0; i_583027 < j_m_i_583009; i_583027++) {
                float b_583029 = ((float *) mem_586584)[i_583027];
                float defunc_0_f_res_583030 = acc_583028 + b_583029;
                float acc_tmp_588041 = defunc_0_f_res_583030;
                
                acc_583028 = acc_tmp_588041;
            }
            defunc_0_foldl_res_583026 = acc_583028;
            
            float sqrt_res_583031 = futrts_sqrt32(defunc_0_foldl_res_583026);
            float atan2_res_583032 = futrts_atan2_32(sqrt_res_583031, this_x_583007);
            
            ((float *) mem_586579)[i_583003] = atan2_res_583032;
        }
        for (int64_t i_586110 = 0; i_586110 < arg_571866; i_586110++) {
            float eta_p_583035 = ((float *) mem_586579)[i_586110];
            float eta_p_583036 = ((float *) mem_586459)[i_586110];
            int64_t eta_p_583037 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586110];
            int64_t eta_p_583038 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586110];
            float i64_res_583039 = sitofp_i64_f32(eta_p_583037);
            float defunc_0_fover_res_583040 = eta_p_583035 / eta_p_583036;
            float defunc_0_ftimes_res_583041 = i64_res_583039 * defunc_0_fover_res_583040;
            int64_t f32_res_583042 = fptosi_f32_i64(defunc_0_ftimes_res_583041);
            bool cond_583043 = slt64(f32_res_583042, (int64_t) 0);
            int64_t defunc_0_f_res_583044;
            
            if (cond_583043) {
                defunc_0_f_res_583044 = (int64_t) 0;
            } else {
                bool cond_583045 = sle64(eta_p_583038, f32_res_583042);
                int64_t defunc_0_f_res_f_res_583046;
                
                if (cond_583045) {
                    int64_t defunc_0_f_res_f_res_t_res_583920 = sub64(eta_p_583038, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_583046 = defunc_0_f_res_f_res_t_res_583920;
                } else {
                    defunc_0_f_res_f_res_583046 = f32_res_583042;
                }
                defunc_0_f_res_583044 = defunc_0_f_res_f_res_583046;
            }
            ((int64_t *) mem_586595)[i_586110] = defunc_0_f_res_583044;
        }
        
        int64_t defunc_0_foldl_res_583048;
        int64_t acc_583050 = (int64_t) 0;
        
        for (int64_t i_583049 = 0; i_583049 < arg_571866; i_583049++) {
            int64_t b_583051 = ((int64_t *) mem_586595)[i_583049];
            int64_t defunc_0_f_res_583052 = add64(acc_583050, b_583051);
            int64_t acc_tmp_588043 = defunc_0_f_res_583052;
            
            acc_583050 = acc_tmp_588043;
        }
        defunc_0_foldl_res_583048 = acc_583050;
        
        int64_t zp_lhs_583053 = mul64(total_angle_no_489531, defunc_0_foldl_res_582987);
        int64_t get_id_from_grid_angle_res_583054 = add64(defunc_0_foldl_res_583048, zp_lhs_583053);
        bool x_583055 = sle64((int64_t) 0, get_id_from_grid_angle_res_583054);
        bool y_583056 = slt64(get_id_from_grid_angle_res_583054, total_part_no_489533);
        bool bounds_check_583057 = x_583055 && y_583056;
        bool index_certs_583058;
        
        if (!bounds_check_583057) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583054, "] out of bounds for array of shape [", (long long) total_part_no_489533, "].", "-> #0  ftSkyline.fut:485:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_583080 = slt64(get_id_from_grid_angle_res_583054, dzlz7bUskBzitotal_part_noz7dUzg_489520);
        bool bounds_check_583081 = x_583055 && y_583080;
        bool index_certs_583082;
        
        if (!bounds_check_583081) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_583054, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:490:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586117 = ((int64_t *) xys_mem_586424.mem)[write_iter_586112];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586561, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586423.mem, write_iter_586112 * dim_489515, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        
        int64_t pref_583059 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_583054];
        bool cond_583060 = get_id_from_grid_angle_res_583054 == zeze_rhs_572046;
        int64_t post_583061;
        
        if (cond_583060) {
            int64_t zm_rhs_583924 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583054];
            int64_t post_t_res_583925 = sub64(dz2083U_489518, zm_rhs_583924);
            
            post_583061 = post_t_res_583925;
        } else {
            int64_t zm_lhs_583067 = add64((int64_t) 1, get_id_from_grid_angle_res_583054);
            bool x_583068 = sle64((int64_t) 0, zm_lhs_583067);
            bool y_583069 = slt64(zm_lhs_583067, dzlz7bUskBzitotal_part_noz7dUzg_489520);
            bool bounds_check_583070 = x_583068 && y_583069;
            bool index_certs_583071;
            
            if (!bounds_check_583070) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zm_lhs_583067, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:489:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zm_lhs_583072 = ((int64_t *) part_idx_mem_586418.mem)[zm_lhs_583067];
            int64_t zm_rhs_583076 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_583054];
            int64_t post_f_res_583077 = sub64(zm_lhs_583072, zm_rhs_583076);
            
            post_583061 = post_f_res_583077;
        }
        
        int64_t zp_lhs_583078 = add64(pref_583059, write_iter_586112);
        int64_t zm_lhs_583079 = add64(post_583061, zp_lhs_583078);
        int64_t zm_rhs_583083 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_583054];
        int64_t defunc_0_f_res_583084 = sub64(zm_lhs_583079, zm_rhs_583083);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_583084) && slt64(defunc_0_f_res_583084, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_489515 - (int64_t) 1, dim_489515))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586494.mem, defunc_0_f_res_583084 * dim_489515, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586561, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_583084) && slt64(defunc_0_f_res_583084, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_583084] = write_iv_586117;
        }
    }
    if (mem_586617_cached_sizze_588632 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586617, &mem_586617_cached_sizze_588632, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586619_cached_sizze_588633 < bytes_586506) {
        err = lexical_realloc(ctx, &mem_586619, &mem_586619_cached_sizze_588633, bytes_586506);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586627_cached_sizze_588634 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586627, &mem_586627_cached_sizze_588634, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586635_cached_sizze_588635 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586635, &mem_586635_cached_sizze_588635, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586651_cached_sizze_588637 < bytes_586538) {
        err = lexical_realloc(ctx, &mem_586651, &mem_586651_cached_sizze_588637, bytes_586538);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586136 = 0; write_iter_586136 < dz2083U_489522; write_iter_586136++) {
        for (int64_t i_586122 = 0; i_586122 < dim_489515; i_586122++) {
            float eta_p_583617 = ((float *) xys_mem_586427.mem)[write_iter_586136 * dim_489515 + i_586122];
            float eta_p_583618 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586122];
            float eta_p_583619 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586122];
            int64_t eta_p_583621 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586122];
            float defunc_0_f_res_583622 = eta_p_583617 - eta_p_583618;
            float defunc_0_f_res_583624 = defunc_0_f_res_583622 / eta_p_583619;
            int64_t f32_res_583626 = fptosi_f32_i64(defunc_0_f_res_583624);
            int64_t max_res_583628 = smax64((int64_t) 0, f32_res_583626);
            int64_t zm_lhs_583634 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586122];
            int64_t min_arg1_583635 = sub64(zm_lhs_583634, (int64_t) 1);
            int64_t min_res_583636 = smin64(max_res_583628, min_arg1_583635);
            int64_t defunc_0_f_res_583638 = mul64(eta_p_583621, min_res_583636);
            
            ((int64_t *) mem_586619)[i_586122] = defunc_0_f_res_583638;
        }
        
        int64_t defunc_0_foldl_res_582844;
        int64_t acc_582846 = (int64_t) 0;
        
        for (int64_t i_582845 = 0; i_582845 < dim_489515; i_582845++) {
            int64_t b_582847 = ((int64_t *) mem_586619)[i_582845];
            int64_t defunc_0_f_res_582848 = add64(acc_582846, b_582847);
            int64_t acc_tmp_588047 = defunc_0_f_res_582848;
            
            acc_582846 = acc_tmp_588047;
        }
        defunc_0_foldl_res_582844 = acc_582846;
        
        bool x_582849 = sle64((int64_t) 0, defunc_0_foldl_res_582844);
        bool y_582850 = slt64(defunc_0_foldl_res_582844, dz2080U_489516);
        bool bounds_check_582851 = x_582849 && y_582850;
        bool index_certs_582852;
        
        if (!bounds_check_582851) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582844, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586126 = 0; i_586126 < dim_489515; i_586126++) {
            float eta_p_582855 = ((float *) xys_mem_586427.mem)[write_iter_586136 * dim_489515 + i_586126];
            float eta_p_582856 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582844 * dim_489515 + i_586126];
            float defunc_0_f_res_582857 = eta_p_582855 - eta_p_582856;
            
            ((float *) mem_586627)[i_586126] = defunc_0_f_res_582857;
        }
        for (int64_t nest_i_588049 = 0; nest_i_588049 < arg_571866; nest_i_588049++) {
            ((float *) mem_586635)[nest_i_588049] = 0.0F;
        }
        for (int64_t i_582860 = 0; i_582860 < arg_571866; i_582860++) {
            bool y_582862 = slt64(i_582860, dim_489515);
            bool index_certs_582863;
            
            if (!y_582862) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582860, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582865 = add64((int64_t) 1, i_582860);
            int64_t j_m_i_582866 = sub64(dim_489515, map_arg1_582865);
            bool empty_slice_582867 = j_m_i_582866 == (int64_t) 0;
            int64_t m_582868 = sub64(j_m_i_582866, (int64_t) 1);
            int64_t i_p_m_t_s_582869 = add64(map_arg1_582865, m_582868);
            bool zzero_leq_i_p_m_t_s_582870 = sle64((int64_t) 0, i_p_m_t_s_582869);
            bool i_p_m_t_s_leq_w_582871 = slt64(i_p_m_t_s_582869, dim_489515);
            bool zzero_lte_i_582872 = sle64((int64_t) 0, map_arg1_582865);
            bool i_lte_j_582873 = sle64(map_arg1_582865, dim_489515);
            bool y_582874 = i_p_m_t_s_leq_w_582871 && zzero_lte_i_582872;
            bool y_582875 = zzero_leq_i_p_m_t_s_582870 && y_582874;
            bool forwards_ok_582876 = i_lte_j_582873 && y_582875;
            bool ok_or_empty_582877 = empty_slice_582867 || forwards_ok_582876;
            bool index_certs_582878;
            
            if (!ok_or_empty_582877) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582865, ":", (long long) dim_489515, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:497:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586639 = (int64_t) 4 * j_m_i_582866;
            float this_x_582864 = ((float *) mem_586627)[i_582860];
            
            if (mem_586640_cached_sizze_588636 < bytes_586639) {
                err = lexical_realloc(ctx, &mem_586640, &mem_586640_cached_sizze_588636, bytes_586639);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586130 = 0; i_586130 < j_m_i_582866; i_586130++) {
                int64_t slice_586372 = map_arg1_582865 + i_586130;
                float eta_p_582881 = ((float *) mem_586627)[slice_586372];
                float defunc_0_ftimes_res_582882 = eta_p_582881 * eta_p_582881;
                
                ((float *) mem_586640)[i_586130] = defunc_0_ftimes_res_582882;
            }
            
            float defunc_0_foldl_res_582883;
            float acc_582885 = 0.0F;
            
            for (int64_t i_582884 = 0; i_582884 < j_m_i_582866; i_582884++) {
                float b_582886 = ((float *) mem_586640)[i_582884];
                float defunc_0_f_res_582887 = acc_582885 + b_582886;
                float acc_tmp_588052 = defunc_0_f_res_582887;
                
                acc_582885 = acc_tmp_588052;
            }
            defunc_0_foldl_res_582883 = acc_582885;
            
            float sqrt_res_582888 = futrts_sqrt32(defunc_0_foldl_res_582883);
            float atan2_res_582889 = futrts_atan2_32(sqrt_res_582888, this_x_582864);
            
            ((float *) mem_586635)[i_582860] = atan2_res_582889;
        }
        for (int64_t i_586134 = 0; i_586134 < arg_571866; i_586134++) {
            float eta_p_582892 = ((float *) mem_586635)[i_586134];
            float eta_p_582893 = ((float *) mem_586457)[i_586134];
            int64_t eta_p_582894 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586134];
            int64_t eta_p_582895 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586134];
            float i64_res_582896 = sitofp_i64_f32(eta_p_582894);
            float defunc_0_fover_res_582897 = eta_p_582892 / eta_p_582893;
            float defunc_0_ftimes_res_582898 = i64_res_582896 * defunc_0_fover_res_582897;
            int64_t f32_res_582899 = fptosi_f32_i64(defunc_0_ftimes_res_582898);
            bool cond_582900 = slt64(f32_res_582899, (int64_t) 0);
            int64_t defunc_0_f_res_582901;
            
            if (cond_582900) {
                defunc_0_f_res_582901 = (int64_t) 0;
            } else {
                bool cond_582902 = sle64(eta_p_582895, f32_res_582899);
                int64_t defunc_0_f_res_f_res_582903;
                
                if (cond_582902) {
                    int64_t defunc_0_f_res_f_res_t_res_583932 = sub64(eta_p_582895, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582903 = defunc_0_f_res_f_res_t_res_583932;
                } else {
                    defunc_0_f_res_f_res_582903 = f32_res_582899;
                }
                defunc_0_f_res_582901 = defunc_0_f_res_f_res_582903;
            }
            ((int64_t *) mem_586651)[i_586134] = defunc_0_f_res_582901;
        }
        
        int64_t defunc_0_foldl_res_582905;
        int64_t acc_582907 = (int64_t) 0;
        
        for (int64_t i_582906 = 0; i_582906 < arg_571866; i_582906++) {
            int64_t b_582908 = ((int64_t *) mem_586651)[i_582906];
            int64_t defunc_0_f_res_582909 = add64(acc_582907, b_582908);
            int64_t acc_tmp_588054 = defunc_0_f_res_582909;
            
            acc_582907 = acc_tmp_588054;
        }
        defunc_0_foldl_res_582905 = acc_582907;
        
        int64_t zp_lhs_582910 = mul64(total_angle_no_489531, defunc_0_foldl_res_582844);
        int64_t get_id_from_grid_angle_res_582911 = add64(defunc_0_foldl_res_582905, zp_lhs_582910);
        bool x_582912 = sle64((int64_t) 0, get_id_from_grid_angle_res_582911);
        bool y_582913 = slt64(get_id_from_grid_angle_res_582911, total_part_no_489533);
        bool bounds_check_582914 = x_582912 && y_582913;
        bool index_certs_582915;
        
        if (!bounds_check_582914) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582911, "] out of bounds for array of shape [", (long long) total_part_no_489533, "].", "-> #0  ftSkyline.fut:498:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582944 = slt64(get_id_from_grid_angle_res_582911, dzlz7bUskBzitotal_part_noz7dUzg_489520);
        bool bounds_check_582945 = x_582912 && y_582944;
        bool index_certs_582946;
        
        if (!bounds_check_582945) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582911, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:506:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586141 = ((int64_t *) xys_mem_586428.mem)[write_iter_586136];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586617, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586427.mem, write_iter_586136 * dim_489515, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        
        int64_t pref_582916 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582911];
        bool cond_582917 = get_id_from_grid_angle_res_582911 == zeze_rhs_572046;
        int64_t post_582918;
        
        if (cond_582917) {
            int64_t zm_rhs_583937 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582911];
            int64_t zm_lhs_583938 = sub64(zp_lhs_571889, zm_rhs_583937);
            int64_t zm_rhs_583939 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582911];
            int64_t post_t_res_583940 = sub64(zm_lhs_583938, zm_rhs_583939);
            
            post_582918 = post_t_res_583940;
        } else {
            int64_t zp_lhs_582927 = add64((int64_t) 1, get_id_from_grid_angle_res_582911);
            bool x_582928 = sle64((int64_t) 0, zp_lhs_582927);
            bool y_582929 = slt64(zp_lhs_582927, dzlz7bUskBzitotal_part_noz7dUzg_489520);
            bool bounds_check_582930 = x_582928 && y_582929;
            bool index_certs_582931;
            
            if (!bounds_check_582930) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582927, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:504:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582932 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582927];
            int64_t zp_rhs_582933 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582927];
            int64_t zm_lhs_582934 = add64(zp_lhs_582932, zp_rhs_582933);
            int64_t zm_rhs_582938 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582911];
            int64_t zm_lhs_582939 = sub64(zm_lhs_582934, zm_rhs_582938);
            int64_t zm_rhs_582940 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582911];
            int64_t post_f_res_582941 = sub64(zm_lhs_582939, zm_rhs_582940);
            
            post_582918 = post_f_res_582941;
        }
        
        int64_t zp_lhs_582942 = add64(pref_582916, write_iter_586136);
        int64_t zm_lhs_582943 = add64(post_582918, zp_lhs_582942);
        int64_t zm_rhs_582947 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582911];
        int64_t defunc_0_f_res_582948 = sub64(zm_lhs_582943, zm_rhs_582947);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582948) && slt64(defunc_0_f_res_582948, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_489515 - (int64_t) 1, dim_489515))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586494.mem, defunc_0_f_res_582948 * dim_489515, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586617, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582948) && slt64(defunc_0_f_res_582948, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582948] = write_iv_586141;
        }
    }
    if (mem_586673_cached_sizze_588638 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586673, &mem_586673_cached_sizze_588638, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586675_cached_sizze_588639 < bytes_586506) {
        err = lexical_realloc(ctx, &mem_586675, &mem_586675_cached_sizze_588639, bytes_586506);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586683_cached_sizze_588640 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586683, &mem_586683_cached_sizze_588640, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586691_cached_sizze_588641 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586691, &mem_586691_cached_sizze_588641, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586707_cached_sizze_588643 < bytes_586538) {
        err = lexical_realloc(ctx, &mem_586707, &mem_586707_cached_sizze_588643, bytes_586538);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586160 = 0; write_iter_586160 < dz2083U_489523; write_iter_586160++) {
        for (int64_t i_586146 = 0; i_586146 < dim_489515; i_586146++) {
            float eta_p_583731 = ((float *) xys_mem_586431.mem)[write_iter_586160 * dim_489515 + i_586146];
            float eta_p_583732 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586146];
            float eta_p_583733 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586146];
            int64_t eta_p_583735 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586146];
            float defunc_0_f_res_583736 = eta_p_583731 - eta_p_583732;
            float defunc_0_f_res_583738 = defunc_0_f_res_583736 / eta_p_583733;
            int64_t f32_res_583740 = fptosi_f32_i64(defunc_0_f_res_583738);
            int64_t max_res_583742 = smax64((int64_t) 0, f32_res_583740);
            int64_t zm_lhs_583748 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586146];
            int64_t min_arg1_583749 = sub64(zm_lhs_583748, (int64_t) 1);
            int64_t min_res_583750 = smin64(max_res_583742, min_arg1_583749);
            int64_t defunc_0_f_res_583752 = mul64(eta_p_583735, min_res_583750);
            
            ((int64_t *) mem_586675)[i_586146] = defunc_0_f_res_583752;
        }
        
        int64_t defunc_0_foldl_res_582694;
        int64_t acc_582696 = (int64_t) 0;
        
        for (int64_t i_582695 = 0; i_582695 < dim_489515; i_582695++) {
            int64_t b_582697 = ((int64_t *) mem_586675)[i_582695];
            int64_t defunc_0_f_res_582698 = add64(acc_582696, b_582697);
            int64_t acc_tmp_588058 = defunc_0_f_res_582698;
            
            acc_582696 = acc_tmp_588058;
        }
        defunc_0_foldl_res_582694 = acc_582696;
        
        bool x_582699 = sle64((int64_t) 0, defunc_0_foldl_res_582694);
        bool y_582700 = slt64(defunc_0_foldl_res_582694, dz2080U_489516);
        bool bounds_check_582701 = x_582699 && y_582700;
        bool index_certs_582702;
        
        if (!bounds_check_582701) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582694, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586150 = 0; i_586150 < dim_489515; i_586150++) {
            float eta_p_582705 = ((float *) xys_mem_586431.mem)[write_iter_586160 * dim_489515 + i_586150];
            float eta_p_582706 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582694 * dim_489515 + i_586150];
            float defunc_0_f_res_582707 = eta_p_582705 - eta_p_582706;
            
            ((float *) mem_586683)[i_586150] = defunc_0_f_res_582707;
        }
        for (int64_t nest_i_588060 = 0; nest_i_588060 < arg_571866; nest_i_588060++) {
            ((float *) mem_586691)[nest_i_588060] = 0.0F;
        }
        for (int64_t i_582710 = 0; i_582710 < arg_571866; i_582710++) {
            bool y_582712 = slt64(i_582710, dim_489515);
            bool index_certs_582713;
            
            if (!y_582712) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582710, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582715 = add64((int64_t) 1, i_582710);
            int64_t j_m_i_582716 = sub64(dim_489515, map_arg1_582715);
            bool empty_slice_582717 = j_m_i_582716 == (int64_t) 0;
            int64_t m_582718 = sub64(j_m_i_582716, (int64_t) 1);
            int64_t i_p_m_t_s_582719 = add64(map_arg1_582715, m_582718);
            bool zzero_leq_i_p_m_t_s_582720 = sle64((int64_t) 0, i_p_m_t_s_582719);
            bool i_p_m_t_s_leq_w_582721 = slt64(i_p_m_t_s_582719, dim_489515);
            bool zzero_lte_i_582722 = sle64((int64_t) 0, map_arg1_582715);
            bool i_lte_j_582723 = sle64(map_arg1_582715, dim_489515);
            bool y_582724 = i_p_m_t_s_leq_w_582721 && zzero_lte_i_582722;
            bool y_582725 = zzero_leq_i_p_m_t_s_582720 && y_582724;
            bool forwards_ok_582726 = i_lte_j_582723 && y_582725;
            bool ok_or_empty_582727 = empty_slice_582717 || forwards_ok_582726;
            bool index_certs_582728;
            
            if (!ok_or_empty_582727) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582715, ":", (long long) dim_489515, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:513:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586695 = (int64_t) 4 * j_m_i_582716;
            float this_x_582714 = ((float *) mem_586683)[i_582710];
            
            if (mem_586696_cached_sizze_588642 < bytes_586695) {
                err = lexical_realloc(ctx, &mem_586696, &mem_586696_cached_sizze_588642, bytes_586695);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586154 = 0; i_586154 < j_m_i_582716; i_586154++) {
                int64_t slice_586367 = map_arg1_582715 + i_586154;
                float eta_p_582731 = ((float *) mem_586683)[slice_586367];
                float defunc_0_ftimes_res_582732 = eta_p_582731 * eta_p_582731;
                
                ((float *) mem_586696)[i_586154] = defunc_0_ftimes_res_582732;
            }
            
            float defunc_0_foldl_res_582733;
            float acc_582735 = 0.0F;
            
            for (int64_t i_582734 = 0; i_582734 < j_m_i_582716; i_582734++) {
                float b_582736 = ((float *) mem_586696)[i_582734];
                float defunc_0_f_res_582737 = acc_582735 + b_582736;
                float acc_tmp_588063 = defunc_0_f_res_582737;
                
                acc_582735 = acc_tmp_588063;
            }
            defunc_0_foldl_res_582733 = acc_582735;
            
            float sqrt_res_582738 = futrts_sqrt32(defunc_0_foldl_res_582733);
            float atan2_res_582739 = futrts_atan2_32(sqrt_res_582738, this_x_582714);
            
            ((float *) mem_586691)[i_582710] = atan2_res_582739;
        }
        for (int64_t i_586158 = 0; i_586158 < arg_571866; i_586158++) {
            float eta_p_582742 = ((float *) mem_586691)[i_586158];
            float eta_p_582743 = ((float *) mem_586455)[i_586158];
            int64_t eta_p_582744 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586158];
            int64_t eta_p_582745 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586158];
            float i64_res_582746 = sitofp_i64_f32(eta_p_582744);
            float defunc_0_fover_res_582747 = eta_p_582742 / eta_p_582743;
            float defunc_0_ftimes_res_582748 = i64_res_582746 * defunc_0_fover_res_582747;
            int64_t f32_res_582749 = fptosi_f32_i64(defunc_0_ftimes_res_582748);
            bool cond_582750 = slt64(f32_res_582749, (int64_t) 0);
            int64_t defunc_0_f_res_582751;
            
            if (cond_582750) {
                defunc_0_f_res_582751 = (int64_t) 0;
            } else {
                bool cond_582752 = sle64(eta_p_582745, f32_res_582749);
                int64_t defunc_0_f_res_f_res_582753;
                
                if (cond_582752) {
                    int64_t defunc_0_f_res_f_res_t_res_583947 = sub64(eta_p_582745, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582753 = defunc_0_f_res_f_res_t_res_583947;
                } else {
                    defunc_0_f_res_f_res_582753 = f32_res_582749;
                }
                defunc_0_f_res_582751 = defunc_0_f_res_f_res_582753;
            }
            ((int64_t *) mem_586707)[i_586158] = defunc_0_f_res_582751;
        }
        
        int64_t defunc_0_foldl_res_582755;
        int64_t acc_582757 = (int64_t) 0;
        
        for (int64_t i_582756 = 0; i_582756 < arg_571866; i_582756++) {
            int64_t b_582758 = ((int64_t *) mem_586707)[i_582756];
            int64_t defunc_0_f_res_582759 = add64(acc_582757, b_582758);
            int64_t acc_tmp_588065 = defunc_0_f_res_582759;
            
            acc_582757 = acc_tmp_588065;
        }
        defunc_0_foldl_res_582755 = acc_582757;
        
        int64_t zp_lhs_582760 = mul64(total_angle_no_489531, defunc_0_foldl_res_582694);
        int64_t get_id_from_grid_angle_res_582761 = add64(defunc_0_foldl_res_582755, zp_lhs_582760);
        bool x_582762 = sle64((int64_t) 0, get_id_from_grid_angle_res_582761);
        bool y_582763 = slt64(get_id_from_grid_angle_res_582761, total_part_no_489533);
        bool bounds_check_582764 = x_582762 && y_582763;
        bool index_certs_582765;
        
        if (!bounds_check_582764) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582761, "] out of bounds for array of shape [", (long long) total_part_no_489533, "].", "-> #0  ftSkyline.fut:514:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582801 = slt64(get_id_from_grid_angle_res_582761, dzlz7bUskBzitotal_part_noz7dUzg_489520);
        bool bounds_check_582802 = x_582762 && y_582801;
        bool index_certs_582803;
        
        if (!bounds_check_582802) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582761, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:522:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586165 = ((int64_t *) xys_mem_586432.mem)[write_iter_586160];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586673, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586431.mem, write_iter_586160 * dim_489515, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        
        int64_t pref_582766 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582761];
        bool cond_582767 = get_id_from_grid_angle_res_582761 == zeze_rhs_572046;
        int64_t post_582768;
        
        if (cond_582767) {
            int64_t zm_rhs_583953 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_583954 = sub64(zp_lhs_571890, zm_rhs_583953);
            int64_t zm_rhs_583955 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_583956 = sub64(zm_lhs_583954, zm_rhs_583955);
            int64_t zm_rhs_583957 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582761];
            int64_t post_t_res_583958 = sub64(zm_lhs_583956, zm_rhs_583957);
            
            post_582768 = post_t_res_583958;
        } else {
            int64_t zp_lhs_582780 = add64((int64_t) 1, get_id_from_grid_angle_res_582761);
            bool x_582781 = sle64((int64_t) 0, zp_lhs_582780);
            bool y_582782 = slt64(zp_lhs_582780, dzlz7bUskBzitotal_part_noz7dUzg_489520);
            bool bounds_check_582783 = x_582781 && y_582782;
            bool index_certs_582784;
            
            if (!bounds_check_582783) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582780, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:520:54-74\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582785 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582780];
            int64_t zp_rhs_582786 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582780];
            int64_t zp_lhs_582787 = add64(zp_lhs_582785, zp_rhs_582786);
            int64_t zp_rhs_582788 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582780];
            int64_t zm_lhs_582789 = add64(zp_lhs_582787, zp_rhs_582788);
            int64_t zm_rhs_582793 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_582794 = sub64(zm_lhs_582789, zm_rhs_582793);
            int64_t zm_rhs_582795 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582761];
            int64_t zm_lhs_582796 = sub64(zm_lhs_582794, zm_rhs_582795);
            int64_t zm_rhs_582797 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582761];
            int64_t post_f_res_582798 = sub64(zm_lhs_582796, zm_rhs_582797);
            
            post_582768 = post_f_res_582798;
        }
        
        int64_t zp_lhs_582799 = add64(pref_582766, write_iter_586160);
        int64_t zm_lhs_582800 = add64(post_582768, zp_lhs_582799);
        int64_t zm_rhs_582804 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582761];
        int64_t defunc_0_f_res_582805 = sub64(zm_lhs_582800, zm_rhs_582804);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582805) && slt64(defunc_0_f_res_582805, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_489515 - (int64_t) 1, dim_489515))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586494.mem, defunc_0_f_res_582805 * dim_489515, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586673, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582805) && slt64(defunc_0_f_res_582805, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582805] = write_iv_586165;
        }
    }
    if (mem_586729_cached_sizze_588644 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586729, &mem_586729_cached_sizze_588644, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586731_cached_sizze_588645 < bytes_586506) {
        err = lexical_realloc(ctx, &mem_586731, &mem_586731_cached_sizze_588645, bytes_586506);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586739_cached_sizze_588646 < bytes_586504) {
        err = lexical_realloc(ctx, &mem_586739, &mem_586739_cached_sizze_588646, bytes_586504);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586747_cached_sizze_588647 < bytes_586522) {
        err = lexical_realloc(ctx, &mem_586747, &mem_586747_cached_sizze_588647, bytes_586522);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586763_cached_sizze_588649 < bytes_586538) {
        err = lexical_realloc(ctx, &mem_586763, &mem_586763_cached_sizze_588649, bytes_586538);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586184 = 0; write_iter_586184 < dz2083U_489524; write_iter_586184++) {
        for (int64_t i_586170 = 0; i_586170 < dim_489515; i_586170++) {
            float eta_p_583851 = ((float *) xys_mem_586435.mem)[write_iter_586184 * dim_489515 + i_586170];
            float eta_p_583852 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586170];
            float eta_p_583853 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586170];
            int64_t eta_p_583855 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586170];
            float defunc_0_f_res_583856 = eta_p_583851 - eta_p_583852;
            float defunc_0_f_res_583858 = defunc_0_f_res_583856 / eta_p_583853;
            int64_t f32_res_583860 = fptosi_f32_i64(defunc_0_f_res_583858);
            int64_t max_res_583862 = smax64((int64_t) 0, f32_res_583860);
            int64_t zm_lhs_583868 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586170];
            int64_t min_arg1_583869 = sub64(zm_lhs_583868, (int64_t) 1);
            int64_t min_res_583870 = smin64(max_res_583862, min_arg1_583869);
            int64_t defunc_0_f_res_583872 = mul64(eta_p_583855, min_res_583870);
            
            ((int64_t *) mem_586731)[i_586170] = defunc_0_f_res_583872;
        }
        
        int64_t defunc_0_foldl_res_582537;
        int64_t acc_582539 = (int64_t) 0;
        
        for (int64_t i_582538 = 0; i_582538 < dim_489515; i_582538++) {
            int64_t b_582540 = ((int64_t *) mem_586731)[i_582538];
            int64_t defunc_0_f_res_582541 = add64(acc_582539, b_582540);
            int64_t acc_tmp_588069 = defunc_0_f_res_582541;
            
            acc_582539 = acc_tmp_588069;
        }
        defunc_0_foldl_res_582537 = acc_582539;
        
        bool x_582542 = sle64((int64_t) 0, defunc_0_foldl_res_582537);
        bool y_582543 = slt64(defunc_0_foldl_res_582537, dz2080U_489516);
        bool bounds_check_582544 = x_582542 && y_582543;
        bool index_certs_582545;
        
        if (!bounds_check_582544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582537, "] out of bounds for array of shape [", (long long) dz2080U_489516, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586174 = 0; i_586174 < dim_489515; i_586174++) {
            float eta_p_582548 = ((float *) xys_mem_586435.mem)[write_iter_586184 * dim_489515 + i_586174];
            float eta_p_582549 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582537 * dim_489515 + i_586174];
            float defunc_0_f_res_582550 = eta_p_582548 - eta_p_582549;
            
            ((float *) mem_586739)[i_586174] = defunc_0_f_res_582550;
        }
        for (int64_t nest_i_588071 = 0; nest_i_588071 < arg_571866; nest_i_588071++) {
            ((float *) mem_586747)[nest_i_588071] = 0.0F;
        }
        for (int64_t i_582553 = 0; i_582553 < arg_571866; i_582553++) {
            bool y_582555 = slt64(i_582553, dim_489515);
            bool index_certs_582556;
            
            if (!y_582555) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582553, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582558 = add64((int64_t) 1, i_582553);
            int64_t j_m_i_582559 = sub64(dim_489515, map_arg1_582558);
            bool empty_slice_582560 = j_m_i_582559 == (int64_t) 0;
            int64_t m_582561 = sub64(j_m_i_582559, (int64_t) 1);
            int64_t i_p_m_t_s_582562 = add64(map_arg1_582558, m_582561);
            bool zzero_leq_i_p_m_t_s_582563 = sle64((int64_t) 0, i_p_m_t_s_582562);
            bool i_p_m_t_s_leq_w_582564 = slt64(i_p_m_t_s_582562, dim_489515);
            bool zzero_lte_i_582565 = sle64((int64_t) 0, map_arg1_582558);
            bool i_lte_j_582566 = sle64(map_arg1_582558, dim_489515);
            bool y_582567 = i_p_m_t_s_leq_w_582564 && zzero_lte_i_582565;
            bool y_582568 = zzero_leq_i_p_m_t_s_582563 && y_582567;
            bool forwards_ok_582569 = i_lte_j_582566 && y_582568;
            bool ok_or_empty_582570 = empty_slice_582560 || forwards_ok_582569;
            bool index_certs_582571;
            
            if (!ok_or_empty_582570) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582558, ":", (long long) dim_489515, "] out of bounds for array of shape [", (long long) dim_489515, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:529:91-92\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_586751 = (int64_t) 4 * j_m_i_582559;
            float this_x_582557 = ((float *) mem_586739)[i_582553];
            
            if (mem_586752_cached_sizze_588648 < bytes_586751) {
                err = lexical_realloc(ctx, &mem_586752, &mem_586752_cached_sizze_588648, bytes_586751);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586178 = 0; i_586178 < j_m_i_582559; i_586178++) {
                int64_t slice_586362 = map_arg1_582558 + i_586178;
                float eta_p_582574 = ((float *) mem_586739)[slice_586362];
                float defunc_0_ftimes_res_582575 = eta_p_582574 * eta_p_582574;
                
                ((float *) mem_586752)[i_586178] = defunc_0_ftimes_res_582575;
            }
            
            float defunc_0_foldl_res_582576;
            float acc_582578 = 0.0F;
            
            for (int64_t i_582577 = 0; i_582577 < j_m_i_582559; i_582577++) {
                float b_582579 = ((float *) mem_586752)[i_582577];
                float defunc_0_f_res_582580 = acc_582578 + b_582579;
                float acc_tmp_588074 = defunc_0_f_res_582580;
                
                acc_582578 = acc_tmp_588074;
            }
            defunc_0_foldl_res_582576 = acc_582578;
            
            float sqrt_res_582581 = futrts_sqrt32(defunc_0_foldl_res_582576);
            float atan2_res_582582 = futrts_atan2_32(sqrt_res_582581, this_x_582557);
            
            ((float *) mem_586747)[i_582553] = atan2_res_582582;
        }
        for (int64_t i_586182 = 0; i_586182 < arg_571866; i_586182++) {
            float eta_p_582585 = ((float *) mem_586747)[i_586182];
            float eta_p_582586 = ((float *) mem_586453)[i_586182];
            int64_t eta_p_582587 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586182];
            int64_t eta_p_582588 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586182];
            float i64_res_582589 = sitofp_i64_f32(eta_p_582587);
            float defunc_0_fover_res_582590 = eta_p_582585 / eta_p_582586;
            float defunc_0_ftimes_res_582591 = i64_res_582589 * defunc_0_fover_res_582590;
            int64_t f32_res_582592 = fptosi_f32_i64(defunc_0_ftimes_res_582591);
            bool cond_582593 = slt64(f32_res_582592, (int64_t) 0);
            int64_t defunc_0_f_res_582594;
            
            if (cond_582593) {
                defunc_0_f_res_582594 = (int64_t) 0;
            } else {
                bool cond_582595 = sle64(eta_p_582588, f32_res_582592);
                int64_t defunc_0_f_res_f_res_582596;
                
                if (cond_582595) {
                    int64_t defunc_0_f_res_f_res_t_res_583965 = sub64(eta_p_582588, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582596 = defunc_0_f_res_f_res_t_res_583965;
                } else {
                    defunc_0_f_res_f_res_582596 = f32_res_582592;
                }
                defunc_0_f_res_582594 = defunc_0_f_res_f_res_582596;
            }
            ((int64_t *) mem_586763)[i_586182] = defunc_0_f_res_582594;
        }
        
        int64_t defunc_0_foldl_res_582598;
        int64_t acc_582600 = (int64_t) 0;
        
        for (int64_t i_582599 = 0; i_582599 < arg_571866; i_582599++) {
            int64_t b_582601 = ((int64_t *) mem_586763)[i_582599];
            int64_t defunc_0_f_res_582602 = add64(acc_582600, b_582601);
            int64_t acc_tmp_588076 = defunc_0_f_res_582602;
            
            acc_582600 = acc_tmp_588076;
        }
        defunc_0_foldl_res_582598 = acc_582600;
        
        int64_t zp_lhs_582603 = mul64(total_angle_no_489531, defunc_0_foldl_res_582537);
        int64_t get_id_from_grid_angle_res_582604 = add64(defunc_0_foldl_res_582598, zp_lhs_582603);
        bool x_582605 = sle64((int64_t) 0, get_id_from_grid_angle_res_582604);
        bool y_582606 = slt64(get_id_from_grid_angle_res_582604, total_part_no_489533);
        bool bounds_check_582607 = x_582605 && y_582606;
        bool index_certs_582608;
        
        if (!bounds_check_582607) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) total_part_no_489533, "].", "-> #0  ftSkyline.fut:530:52-70\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_582651 = slt64(get_id_from_grid_angle_res_582604, dzlz7bUskBzitotal_part_noz7dUzg_489520);
        bool bounds_check_582652 = x_582605 && y_582651;
        bool index_certs_582653;
        
        if (!bounds_check_582652) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) get_id_from_grid_angle_res_582604, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:539:62-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t write_iv_586189 = ((int64_t *) xys_mem_586436.mem)[write_iter_586184];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586729, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xys_mem_586435.mem, write_iter_586184 * dim_489515, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        
        int64_t pref_582609 = ((int64_t *) mem_586445.mem)[get_id_from_grid_angle_res_582604];
        bool cond_582610 = get_id_from_grid_angle_res_582604 == zeze_rhs_572046;
        int64_t post_582611;
        
        if (cond_582610) {
            int64_t zm_lhs_583968 = add64(dz2083U_489523, zp_lhs_571890);
            int64_t zm_rhs_583972 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583973 = sub64(zm_lhs_583968, zm_rhs_583972);
            int64_t zm_rhs_583974 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583975 = sub64(zm_lhs_583973, zm_rhs_583974);
            int64_t zm_rhs_583976 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_583977 = sub64(zm_lhs_583975, zm_rhs_583976);
            int64_t zm_rhs_583978 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_t_res_583979 = sub64(zm_lhs_583977, zm_rhs_583978);
            
            post_582611 = post_t_res_583979;
        } else {
            int64_t zp_lhs_582626 = add64((int64_t) 1, get_id_from_grid_angle_res_582604);
            bool x_582627 = sle64((int64_t) 0, zp_lhs_582626);
            bool y_582628 = slt64(zp_lhs_582626, dzlz7bUskBzitotal_part_noz7dUzg_489520);
            bool bounds_check_582629 = x_582627 && y_582628;
            bool index_certs_582630;
            
            if (!bounds_check_582629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zp_lhs_582626, "] out of bounds for array of shape [", (long long) dzlz7bUskBzitotal_part_noz7dUzg_489520, "].", "-> #0  ftSkyline.fut:537:57-77\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:980:17-989:95\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zp_lhs_582631 = ((int64_t *) part_idx_mem_586418.mem)[zp_lhs_582626];
            int64_t zp_rhs_582632 = ((int64_t *) part_idx_mem_586422.mem)[zp_lhs_582626];
            int64_t zp_lhs_582633 = add64(zp_lhs_582631, zp_rhs_582632);
            int64_t zp_rhs_582634 = ((int64_t *) part_idx_mem_586426.mem)[zp_lhs_582626];
            int64_t zp_lhs_582635 = add64(zp_lhs_582633, zp_rhs_582634);
            int64_t zp_rhs_582636 = ((int64_t *) part_idx_mem_586430.mem)[zp_lhs_582626];
            int64_t zm_lhs_582637 = add64(zp_lhs_582635, zp_rhs_582636);
            int64_t zm_rhs_582641 = ((int64_t *) part_idx_mem_586418.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582642 = sub64(zm_lhs_582637, zm_rhs_582641);
            int64_t zm_rhs_582643 = ((int64_t *) part_idx_mem_586422.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582644 = sub64(zm_lhs_582642, zm_rhs_582643);
            int64_t zm_rhs_582645 = ((int64_t *) part_idx_mem_586426.mem)[get_id_from_grid_angle_res_582604];
            int64_t zm_lhs_582646 = sub64(zm_lhs_582644, zm_rhs_582645);
            int64_t zm_rhs_582647 = ((int64_t *) part_idx_mem_586430.mem)[get_id_from_grid_angle_res_582604];
            int64_t post_f_res_582648 = sub64(zm_lhs_582646, zm_rhs_582647);
            
            post_582611 = post_f_res_582648;
        }
        
        int64_t zp_lhs_582649 = add64(pref_582609, write_iter_586184);
        int64_t zm_lhs_582650 = add64(post_582611, zp_lhs_582649);
        int64_t zm_rhs_582654 = ((int64_t *) part_idx_mem_586434.mem)[get_id_from_grid_angle_res_582604];
        int64_t defunc_0_f_res_582655 = sub64(zm_lhs_582650, zm_rhs_582654);
        
        if ((sle64((int64_t) 0, defunc_0_f_res_582655) && slt64(defunc_0_f_res_582655, n_total_571892)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_489515 - (int64_t) 1, dim_489515))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586494.mem, defunc_0_f_res_582655 * dim_489515, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586729, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_489515});
        }
        if (sle64((int64_t) 0, defunc_0_f_res_582655) && slt64(defunc_0_f_res_582655, n_total_571892)) {
            ((int64_t *) mem_586496.mem)[defunc_0_f_res_582655] = write_iv_586189;
        }
    }
    if (memblock_set(ctx, &mem_out_588007, &mem_586437, "mem_586437") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_586445, "mem_586445") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_586494, "mem_586494") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_586496, "mem_586496") != 0)
        return 1;
    prim_out_588011 = n_total_571892;
    if (memblock_set(ctx, &*mem_out_p_588610, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588611, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588612, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588613, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588614 = prim_out_588011;
    
  cleanup:
    {
        free(mem_586453);
        free(mem_586455);
        free(mem_586457);
        free(mem_586459);
        free(mem_586461);
        free(mem_586505);
        free(mem_586507);
        free(mem_586515);
        free(mem_586523);
        free(mem_586528);
        free(mem_586539);
        free(mem_586561);
        free(mem_586563);
        free(mem_586571);
        free(mem_586579);
        free(mem_586584);
        free(mem_586595);
        free(mem_586617);
        free(mem_586619);
        free(mem_586627);
        free(mem_586635);
        free(mem_586640);
        free(mem_586651);
        free(mem_586673);
        free(mem_586675);
        free(mem_586683);
        free(mem_586691);
        free(mem_586696);
        free(mem_586707);
        free(mem_586729);
        free(mem_586731);
        free(mem_586739);
        free(mem_586747);
        free(mem_586752);
        free(mem_586763);
        if (memblock_unref(ctx, &mem_586496, "mem_586496") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586494, "mem_586494") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586445, "mem_586445") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586437, "mem_586437") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588650, struct memblock *mem_out_p_588651, struct memblock *mem_out_p_588652, struct memblock *mem_out_p_588653, int64_t *out_prim_out_588654, int64_t *out_prim_out_588655, int64_t *out_prim_out_588656, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock angle_part_prefix_sum_mem_586417, struct memblock angle_partitions_per_dim_mem_586418, struct memblock grid_part_prefix_sum_mem_586419, struct memblock grid_part_sizze_per_dim_mem_586420, struct memblock grid_partitions_per_dim_mem_586421, struct memblock start_of_grid_partition_mem_586422, struct memblock xs_mem_586423, int64_t dim_274571, int64_t dz2080U_274572, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573, int64_t dz2080U_274574, int64_t n_274575, int64_t total_angle_no_274582, int64_t total_grid_no_274583, int64_t total_part_no_274584, int64_t total_angle_no_274591, int64_t total_grid_no_274592, int64_t total_part_no_274593, int64_t offset_274595, bool use_measure_for_sorting_274596)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586425_cached_sizze_588657 = 0;
    unsigned char *mem_586425 = NULL;
    int64_t mem_586433_cached_sizze_588658 = 0;
    unsigned char *mem_586433 = NULL;
    int64_t mem_586438_cached_sizze_588659 = 0;
    unsigned char *mem_586438 = NULL;
    int64_t mem_586452_cached_sizze_588660 = 0;
    unsigned char *mem_586452 = NULL;
    int64_t mem_586459_cached_sizze_588661 = 0;
    unsigned char *mem_586459 = NULL;
    int64_t mem_586474_cached_sizze_588662 = 0;
    unsigned char *mem_586474 = NULL;
    int64_t mem_586476_cached_sizze_588663 = 0;
    unsigned char *mem_586476 = NULL;
    int64_t mem_586484_cached_sizze_588664 = 0;
    unsigned char *mem_586484 = NULL;
    int64_t mem_586510_cached_sizze_588665 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586519_cached_sizze_588666 = 0;
    unsigned char *mem_586519 = NULL;
    int64_t mem_586527_cached_sizze_588667 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586529_cached_sizze_588668 = 0;
    unsigned char *mem_586529 = NULL;
    int64_t mem_586537_cached_sizze_588669 = 0;
    unsigned char *mem_586537 = NULL;
    int64_t mem_586545_cached_sizze_588670 = 0;
    unsigned char *mem_586545 = NULL;
    int64_t mem_586547_cached_sizze_588671 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586561_cached_sizze_588672 = 0;
    unsigned char *mem_586561 = NULL;
    int64_t mem_586566_cached_sizze_588673 = 0;
    unsigned char *mem_586566 = NULL;
    int64_t mem_586577_cached_sizze_588674 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586603_cached_sizze_588675 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586606_cached_sizze_588676 = 0;
    unsigned char *mem_586606 = NULL;
    int64_t mem_586610_cached_sizze_588677 = 0;
    unsigned char *mem_586610 = NULL;
    int64_t mem_586613_cached_sizze_588678 = 0;
    unsigned char *mem_586613 = NULL;
    int64_t mem_586633_cached_sizze_588679 = 0;
    unsigned char *mem_586633 = NULL;
    int64_t mem_586635_cached_sizze_588680 = 0;
    unsigned char *mem_586635 = NULL;
    int64_t mem_586638_cached_sizze_588681 = 0;
    unsigned char *mem_586638 = NULL;
    int64_t mem_586640_cached_sizze_588682 = 0;
    unsigned char *mem_586640 = NULL;
    int64_t mem_586699_cached_sizze_588683 = 0;
    unsigned char *mem_586699 = NULL;
    int64_t mem_586701_cached_sizze_588684 = 0;
    unsigned char *mem_586701 = NULL;
    int64_t mem_586790_cached_sizze_588685 = 0;
    unsigned char *mem_586790 = NULL;
    int64_t mem_586793_cached_sizze_588686 = 0;
    unsigned char *mem_586793 = NULL;
    int64_t mem_586797_cached_sizze_588687 = 0;
    unsigned char *mem_586797 = NULL;
    int64_t mem_586800_cached_sizze_588688 = 0;
    unsigned char *mem_586800 = NULL;
    int64_t mem_586820_cached_sizze_588689 = 0;
    unsigned char *mem_586820 = NULL;
    int64_t mem_586822_cached_sizze_588690 = 0;
    unsigned char *mem_586822 = NULL;
    int64_t mem_586837_cached_sizze_588691 = 0;
    unsigned char *mem_586837 = NULL;
    int64_t mem_586840_cached_sizze_588692 = 0;
    unsigned char *mem_586840 = NULL;
    int64_t mem_586844_cached_sizze_588693 = 0;
    unsigned char *mem_586844 = NULL;
    int64_t mem_586847_cached_sizze_588694 = 0;
    unsigned char *mem_586847 = NULL;
    int64_t mem_587063_cached_sizze_588695 = 0;
    unsigned char *mem_587063 = NULL;
    int64_t mem_587071_cached_sizze_588696 = 0;
    unsigned char *mem_587071 = NULL;
    int64_t mem_587076_cached_sizze_588697 = 0;
    unsigned char *mem_587076 = NULL;
    int64_t mem_587084_cached_sizze_588698 = 0;
    unsigned char *mem_587084 = NULL;
    int64_t mem_587092_cached_sizze_588699 = 0;
    unsigned char *mem_587092 = NULL;
    int64_t mem_587097_cached_sizze_588700 = 0;
    unsigned char *mem_587097 = NULL;
    int64_t mem_587108_cached_sizze_588701 = 0;
    unsigned char *mem_587108 = NULL;
    int64_t mem_587131_cached_sizze_588702 = 0;
    unsigned char *mem_587131 = NULL;
    int64_t mem_587135_cached_sizze_588703 = 0;
    unsigned char *mem_587135 = NULL;
    int64_t mem_587138_cached_sizze_588704 = 0;
    unsigned char *mem_587138 = NULL;
    int64_t mem_587154_cached_sizze_588705 = 0;
    unsigned char *mem_587154 = NULL;
    int64_t mem_587157_cached_sizze_588706 = 0;
    unsigned char *mem_587157 = NULL;
    int64_t mem_587159_cached_sizze_588707 = 0;
    unsigned char *mem_587159 = NULL;
    int64_t mem_587206_cached_sizze_588708 = 0;
    unsigned char *mem_587206 = NULL;
    int64_t mem_587208_cached_sizze_588709 = 0;
    unsigned char *mem_587208 = NULL;
    int64_t mem_587277_cached_sizze_588710 = 0;
    unsigned char *mem_587277 = NULL;
    int64_t mem_587281_cached_sizze_588711 = 0;
    unsigned char *mem_587281 = NULL;
    int64_t mem_587284_cached_sizze_588712 = 0;
    unsigned char *mem_587284 = NULL;
    int64_t mem_587300_cached_sizze_588713 = 0;
    unsigned char *mem_587300 = NULL;
    int64_t mem_587302_cached_sizze_588714 = 0;
    unsigned char *mem_587302 = NULL;
    int64_t mem_587317_cached_sizze_588715 = 0;
    unsigned char *mem_587317 = NULL;
    int64_t mem_587321_cached_sizze_588716 = 0;
    unsigned char *mem_587321 = NULL;
    int64_t mem_587324_cached_sizze_588717 = 0;
    unsigned char *mem_587324 = NULL;
    int64_t mem_587500_cached_sizze_588718 = 0;
    unsigned char *mem_587500 = NULL;
    int64_t mem_587505_cached_sizze_588719 = 0;
    unsigned char *mem_587505 = NULL;
    int64_t mem_587519_cached_sizze_588720 = 0;
    unsigned char *mem_587519 = NULL;
    int64_t mem_587526_cached_sizze_588721 = 0;
    unsigned char *mem_587526 = NULL;
    int64_t mem_587541_cached_sizze_588722 = 0;
    unsigned char *mem_587541 = NULL;
    int64_t mem_587549_cached_sizze_588723 = 0;
    unsigned char *mem_587549 = NULL;
    int64_t mem_587551_cached_sizze_588724 = 0;
    unsigned char *mem_587551 = NULL;
    int64_t mem_587553_cached_sizze_588725 = 0;
    unsigned char *mem_587553 = NULL;
    int64_t mem_587564_cached_sizze_588726 = 0;
    unsigned char *mem_587564 = NULL;
    int64_t mem_587572_cached_sizze_588727 = 0;
    unsigned char *mem_587572 = NULL;
    int64_t mem_587580_cached_sizze_588728 = 0;
    unsigned char *mem_587580 = NULL;
    int64_t mem_587585_cached_sizze_588729 = 0;
    unsigned char *mem_587585 = NULL;
    int64_t mem_587596_cached_sizze_588730 = 0;
    unsigned char *mem_587596 = NULL;
    int64_t mem_587616_cached_sizze_588731 = 0;
    unsigned char *mem_587616 = NULL;
    int64_t mem_587630_cached_sizze_588732 = 0;
    unsigned char *mem_587630 = NULL;
    int64_t mem_587642_cached_sizze_588733 = 0;
    unsigned char *mem_587642 = NULL;
    int64_t mem_587650_cached_sizze_588734 = 0;
    unsigned char *mem_587650 = NULL;
    struct memblock mem_587658;
    
    mem_587658.references = NULL;
    
    struct memblock mem_587618;
    
    mem_587618.references = NULL;
    
    struct memblock mem_587614;
    
    mem_587614.references = NULL;
    
    struct memblock mem_587515;
    
    mem_587515.references = NULL;
    
    struct memblock mem_587536;
    
    mem_587536.references = NULL;
    
    struct memblock ext_mem_587539;
    
    ext_mem_587539.references = NULL;
    
    struct memblock mem_587061;
    
    mem_587061.references = NULL;
    
    struct memblock mem_587058;
    
    mem_587058.references = NULL;
    
    struct memblock mem_param_tmp_588147;
    
    mem_param_tmp_588147.references = NULL;
    
    struct memblock mem_param_tmp_588146;
    
    mem_param_tmp_588146.references = NULL;
    
    struct memblock mem_param_tmp_588145;
    
    mem_param_tmp_588145.references = NULL;
    
    struct memblock mem_param_tmp_588144;
    
    mem_param_tmp_588144.references = NULL;
    
    struct memblock mem_587035;
    
    mem_587035.references = NULL;
    
    struct memblock mem_587031;
    
    mem_587031.references = NULL;
    
    struct memblock mem_587026;
    
    mem_587026.references = NULL;
    
    struct memblock mem_587022;
    
    mem_587022.references = NULL;
    
    struct memblock mem_586943;
    
    mem_586943.references = NULL;
    
    struct memblock mem_586939;
    
    mem_586939.references = NULL;
    
    struct memblock mem_586934;
    
    mem_586934.references = NULL;
    
    struct memblock mem_586930;
    
    mem_586930.references = NULL;
    
    struct memblock mem_586958;
    
    mem_586958.references = NULL;
    
    struct memblock mem_586955;
    
    mem_586955.references = NULL;
    
    struct memblock mem_586953;
    
    mem_586953.references = NULL;
    
    struct memblock mem_586951;
    
    mem_586951.references = NULL;
    
    struct memblock ext_mem_586992;
    
    ext_mem_586992.references = NULL;
    
    struct memblock ext_mem_586996;
    
    ext_mem_586996.references = NULL;
    
    struct memblock ext_mem_586999;
    
    ext_mem_586999.references = NULL;
    
    struct memblock ext_mem_587002;
    
    ext_mem_587002.references = NULL;
    
    struct memblock mem_param_586787;
    
    mem_param_586787.references = NULL;
    
    struct memblock mem_param_586784;
    
    mem_param_586784.references = NULL;
    
    struct memblock mem_param_586780;
    
    mem_param_586780.references = NULL;
    
    struct memblock mem_param_586777;
    
    mem_param_586777.references = NULL;
    
    struct memblock ext_mem_587046;
    
    ext_mem_587046.references = NULL;
    
    struct memblock ext_mem_587047;
    
    ext_mem_587047.references = NULL;
    
    struct memblock ext_mem_587048;
    
    ext_mem_587048.references = NULL;
    
    struct memblock ext_mem_587049;
    
    ext_mem_587049.references = NULL;
    
    struct memblock mem_586773;
    
    mem_586773.references = NULL;
    
    struct memblock mem_586769;
    
    mem_586769.references = NULL;
    
    struct memblock mem_586764;
    
    mem_586764.references = NULL;
    
    struct memblock mem_586760;
    
    mem_586760.references = NULL;
    
    struct memblock ext_mem_586658;
    
    ext_mem_586658.references = NULL;
    
    struct memblock mem_param_tmp_588120;
    
    mem_param_tmp_588120.references = NULL;
    
    struct memblock ext_mem_586597;
    
    ext_mem_586597.references = NULL;
    
    struct memblock mem_param_586592;
    
    mem_param_586592.references = NULL;
    
    struct memblock ext_mem_586600;
    
    ext_mem_586600.references = NULL;
    
    struct memblock ext_mem_587052;
    
    ext_mem_587052.references = NULL;
    
    struct memblock ext_mem_587056;
    
    ext_mem_587056.references = NULL;
    
    struct memblock mem_587496;
    
    mem_587496.references = NULL;
    
    struct memblock mem_587493;
    
    mem_587493.references = NULL;
    
    struct memblock mem_param_tmp_588071;
    
    mem_param_tmp_588071.references = NULL;
    
    struct memblock mem_param_tmp_588070;
    
    mem_param_tmp_588070.references = NULL;
    
    struct memblock mem_param_tmp_588069;
    
    mem_param_tmp_588069.references = NULL;
    
    struct memblock mem_587473;
    
    mem_587473.references = NULL;
    
    struct memblock mem_587469;
    
    mem_587469.references = NULL;
    
    struct memblock mem_587464;
    
    mem_587464.references = NULL;
    
    struct memblock mem_587400;
    
    mem_587400.references = NULL;
    
    struct memblock mem_587396;
    
    mem_587396.references = NULL;
    
    struct memblock mem_587391;
    
    mem_587391.references = NULL;
    
    struct memblock mem_587413;
    
    mem_587413.references = NULL;
    
    struct memblock mem_587410;
    
    mem_587410.references = NULL;
    
    struct memblock mem_587408;
    
    mem_587408.references = NULL;
    
    struct memblock ext_mem_587441;
    
    ext_mem_587441.references = NULL;
    
    struct memblock ext_mem_587445;
    
    ext_mem_587445.references = NULL;
    
    struct memblock ext_mem_587448;
    
    ext_mem_587448.references = NULL;
    
    struct memblock mem_param_587274;
    
    mem_param_587274.references = NULL;
    
    struct memblock mem_param_587271;
    
    mem_param_587271.references = NULL;
    
    struct memblock mem_param_587267;
    
    mem_param_587267.references = NULL;
    
    struct memblock ext_mem_587482;
    
    ext_mem_587482.references = NULL;
    
    struct memblock ext_mem_587483;
    
    ext_mem_587483.references = NULL;
    
    struct memblock ext_mem_587484;
    
    ext_mem_587484.references = NULL;
    
    struct memblock mem_587263;
    
    mem_587263.references = NULL;
    
    struct memblock mem_587259;
    
    mem_587259.references = NULL;
    
    struct memblock mem_587254;
    
    mem_587254.references = NULL;
    
    struct memblock ext_mem_587174;
    
    ext_mem_587174.references = NULL;
    
    struct memblock mem_param_tmp_588050;
    
    mem_param_tmp_588050.references = NULL;
    
    struct memblock ext_mem_587125;
    
    ext_mem_587125.references = NULL;
    
    struct memblock mem_param_587120;
    
    mem_param_587120.references = NULL;
    
    struct memblock ext_mem_587128;
    
    ext_mem_587128.references = NULL;
    
    struct memblock ext_mem_587487;
    
    ext_mem_587487.references = NULL;
    
    struct memblock ext_mem_587491;
    
    ext_mem_587491.references = NULL;
    
    struct memblock ext_mem_587497;
    
    ext_mem_587497.references = NULL;
    
    struct memblock ext_mem_587498;
    
    ext_mem_587498.references = NULL;
    
    struct memblock mem_586501;
    
    mem_586501.references = NULL;
    
    struct memblock mem_586499;
    
    mem_586499.references = NULL;
    
    struct memblock mem_586448;
    
    mem_586448.references = NULL;
    
    struct memblock mem_586469;
    
    mem_586469.references = NULL;
    
    struct memblock ext_mem_586472;
    
    ext_mem_586472.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_580163 = sub64(dim_274571, (int64_t) 1);
    bool assert_cond_580164 = arg_580163 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573;
    bool assert_c_580165;
    
    if (!assert_cond_580164) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586424 = (int64_t) 8 * n_274575;
    
    if (mem_586425_cached_sizze_588657 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586425, &mem_586425_cached_sizze_588657, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < n_274575; i_586050++) {
        int64_t lifted_lambda_res_580172 = add64(offset_274595, i_586050);
        
        ((int64_t *) mem_586425)[i_586050] = lifted_lambda_res_580172;
    }
    
    int64_t defunc_0_reduce_res_586032;
    int64_t redout_586052 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586053 = 0; i_586053 < dim_274571; i_586053++) {
        int64_t x_580174 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586053];
        int64_t min_res_580177 = smin64(x_580174, redout_586052);
        int64_t redout_tmp_588015 = min_res_580177;
        
        redout_586052 = redout_tmp_588015;
    }
    defunc_0_reduce_res_586032 = redout_586052;
    
    bool cond_580178 = defunc_0_reduce_res_586032 == (int64_t) 1;
    bool bounds_invalid_upwards_580179 = slt64(total_grid_no_274583, (int64_t) 0);
    bool valid_580180 = !bounds_invalid_upwards_580179;
    bool protect_assert_disj_580181 = cond_580178 || valid_580180;
    bool range_valid_c_580182;
    
    if (!protect_assert_disj_580181) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_274583, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:284:65-78\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_580188 = slt64((int64_t) 0, dz2080U_274572);
    bool protect_assert_disj_582349 = cond_580178 || y_580188;
    bool index_certs_580189;
    
    if (!protect_assert_disj_582349) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274572, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:282:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:349:69-71\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586432 = (int64_t) 4 * total_grid_no_274583;
    int64_t bytes_586437 = (int64_t) 8 * dim_274571;
    
    if (cond_580178) {
        if (memblock_alloc(ctx, &mem_586469, total_grid_no_274583, "mem_586469")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588016 = 0; nest_i_588016 < total_grid_no_274583; nest_i_588016++) {
            ((bool *) mem_586469.mem)[nest_i_588016] = 0;
        }
        if (memblock_set(ctx, &ext_mem_586472, &mem_586469, "mem_586469") != 0)
            return 1;
    } else {
        if (mem_586433_cached_sizze_588658 < bytes_586432) {
            err = lexical_realloc(ctx, &mem_586433, &mem_586433_cached_sizze_588658, bytes_586432);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588017 = 0; nest_i_588017 < total_grid_no_274583; nest_i_588017++) {
            ((int32_t *) mem_586433)[nest_i_588017] = 0;
        }
        if (mem_586438_cached_sizze_588659 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586438, &mem_586438_cached_sizze_588659, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586058 = 0; iter_586058 < n_274575; iter_586058++) {
            for (int64_t i_586056 = 0; i_586056 < dim_274571; i_586056++) {
                double eta_p_582805 = ((double *) xs_mem_586423.mem)[iter_586058 * dim_274571 + i_586056];
                double eta_p_582806 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586056];
                double eta_p_582807 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586056];
                int64_t eta_p_582809 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586056];
                double defunc_0_f_res_582810 = eta_p_582805 - eta_p_582806;
                double defunc_0_f_res_582812 = defunc_0_f_res_582810 / eta_p_582807;
                int64_t f64_res_582814 = fptosi_f64_i64(defunc_0_f_res_582812);
                int64_t max_res_582816 = smax64((int64_t) 0, f64_res_582814);
                int64_t zm_lhs_582822 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586056];
                int64_t min_arg1_582823 = sub64(zm_lhs_582822, (int64_t) 1);
                int64_t min_res_582824 = smin64(max_res_582816, min_arg1_582823);
                int64_t defunc_0_f_res_582826 = mul64(eta_p_582809, min_res_582824);
                
                ((int64_t *) mem_586438)[i_586056] = defunc_0_f_res_582826;
            }
            
            int64_t defunc_0_foldl_res_582733;
            int64_t acc_582735 = (int64_t) 0;
            
            for (int64_t i_582734 = 0; i_582734 < dim_274571; i_582734++) {
                int64_t b_582736 = ((int64_t *) mem_586438)[i_582734];
                int64_t defunc_0_f_res_582737 = add64(acc_582735, b_582736);
                int64_t acc_tmp_588020 = defunc_0_f_res_582737;
                
                acc_582735 = acc_tmp_588020;
            }
            defunc_0_foldl_res_582733 = acc_582735;
            
            bool less_than_zzero_586062 = slt64(defunc_0_foldl_res_582733, (int64_t) 0);
            bool greater_than_sizze_586063 = sle64(total_grid_no_274583, defunc_0_foldl_res_582733);
            bool outside_bounds_dim_586064 = less_than_zzero_586062 || greater_than_sizze_586063;
            
            if (!outside_bounds_dim_586064) {
                int32_t read_hist_586066 = ((int32_t *) mem_586433)[defunc_0_foldl_res_582733];
                int32_t defunc_0_op_res_580229 = add32(1, read_hist_586066);
                
                ((int32_t *) mem_586433)[defunc_0_foldl_res_582733] = defunc_0_op_res_580229;
            }
        }
        if (memblock_alloc(ctx, &mem_586448, total_grid_no_274583, "mem_586448")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588021 = 0; nest_i_588021 < total_grid_no_274583; nest_i_588021++) {
            ((bool *) mem_586448.mem)[nest_i_588021] = 0;
        }
        if (mem_586452_cached_sizze_588660 < dim_274571) {
            err = lexical_realloc(ctx, &mem_586452, &mem_586452_cached_sizze_588660, dim_274571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_580234 = 0; i_580234 < total_grid_no_274583; i_580234++) {
            for (int64_t i_586071 = 0; i_586071 < dim_274571; i_586071++) {
                int64_t eta_p_580237 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586071];
                int64_t eta_p_580238 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586071];
                bool defunc_0_f_res_580239;
                
                if (futrts_lifted_lambda_13275(ctx, &defunc_0_f_res_580239, i_580234, eta_p_580237, eta_p_580238) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_586452)[i_586071] = defunc_0_f_res_580239;
            }
            
            bool defunc_0_f_res_580240;
            bool acc_580242 = 0;
            
            for (int64_t i_580241 = 0; i_580241 < dim_274571; i_580241++) {
                bool b_580243 = ((bool *) mem_586452)[i_580241];
                bool defunc_0_f_res_580244 = acc_580242 || b_580243;
                bool acc_tmp_588024 = defunc_0_f_res_580244;
                
                acc_580242 = acc_tmp_588024;
            }
            defunc_0_f_res_580240 = acc_580242;
            if (!defunc_0_f_res_580240) {
                bool y_580246 = slt64(i_580234, dz2080U_274572);
                bool index_certs_580247;
                
                if (!y_580246) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_580234, "] out of bounds for array of shape [", (long long) dz2080U_274572, "].", "-> #0  ftSkyline.fut:292:46-76\n   #1  ftSkyline.fut:349:69-71\n   #2  ftSkyline.fut:805:33-56\n   #3  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_580249 = slt64(i_580234, (int64_t) 0);
                bool valid_580250 = !bounds_invalid_upwards_580249;
                bool range_valid_c_580251;
                
                if (!valid_580250) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_580234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:293:44-50\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_584920;
                bool redout_586077 = 0;
                
                for (int64_t i_586078 = 0; i_586078 < i_580234; i_586078++) {
                    bool cond_582830 = i_586078 == i_580234;
                    bool cond_582831;
                    
                    if (cond_582830) {
                        cond_582831 = 1;
                    } else {
                        bool y_582833 = slt64(i_586078, total_grid_no_274583);
                        bool index_certs_582835;
                        
                        if (!y_582833) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586078, "] out of bounds for array of shape [", (long long) total_grid_no_274583, "].", "-> #0  ftSkyline.fut:295:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_582836 = ((int32_t *) mem_586433)[i_586078];
                        bool cond_f_res_582837 = zeze_lhs_582836 == 0;
                        
                        cond_582831 = cond_f_res_582837;
                    }
                    
                    bool defunc_0_f_res_582838;
                    
                    if (cond_582831) {
                        defunc_0_f_res_582838 = 0;
                    } else {
                        bool y_582840 = slt64(i_586078, dz2080U_274572);
                        bool index_certs_582842;
                        
                        if (!y_582840) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586078, "] out of bounds for array of shape [", (long long) dz2080U_274572, "].", "-> #0  ftSkyline.fut:297:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_586459_cached_sizze_588661 < dim_274571) {
                            err = lexical_realloc(ctx, &mem_586459, &mem_586459_cached_sizze_588661, dim_274571);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586075 = 0; i_586075 < dim_274571; i_586075++) {
                            double eta_p_582845 = ((double *) start_of_grid_partition_mem_586416.mem)[i_580234 * dim_274571 + i_586075];
                            double eta_p_582846 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586078 * dim_274571 + i_586075];
                            bool defunc_0_f_res_582847 = eta_p_582846 < eta_p_582845;
                            
                            ((bool *) mem_586459)[i_586075] = defunc_0_f_res_582847;
                        }
                        
                        bool defunc_0_foldl_res_582848;
                        bool acc_582850 = 1;
                        
                        for (int64_t i_582849 = 0; i_582849 < dim_274571; i_582849++) {
                            bool b_582851 = ((bool *) mem_586459)[i_582849];
                            bool x_582852 = acc_582850 && b_582851;
                            bool acc_tmp_588027 = x_582852;
                            
                            acc_582850 = acc_tmp_588027;
                        }
                        defunc_0_foldl_res_582848 = acc_582850;
                        defunc_0_f_res_582838 = defunc_0_foldl_res_582848;
                    }
                    
                    bool defunc_0_op_res_580285 = defunc_0_f_res_582838 || redout_586077;
                    bool redout_tmp_588025 = defunc_0_op_res_580285;
                    
                    redout_586077 = redout_tmp_588025;
                }
                defunc_0_reduce_res_584920 = redout_586077;
                ((bool *) mem_586448.mem)[i_580234] = defunc_0_reduce_res_584920;
            }
        }
        if (memblock_set(ctx, &ext_mem_586472, &mem_586448, "mem_586448") != 0)
            return 1;
    }
    
    bool index_certs_580295;
    
    if (!y_580188) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274572, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:302:72-76\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:349:69-71\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_586474_cached_sizze_588662 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586474, &mem_586474_cached_sizze_588662, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586476_cached_sizze_588663 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586476, &mem_586476_cached_sizze_588663, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586484_cached_sizze_588664 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_586484, &mem_586484_cached_sizze_588664, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586091;
    int64_t scanacc_586085 = (int64_t) 0;
    
    for (int64_t i_586088 = 0; i_586088 < n_274575; i_586088++) {
        for (int64_t i_586081 = 0; i_586081 < dim_274571; i_586081++) {
            double eta_p_582935 = ((double *) xs_mem_586423.mem)[i_586088 * dim_274571 + i_586081];
            double eta_p_582936 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586081];
            double eta_p_582937 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586081];
            int64_t eta_p_582939 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586081];
            double defunc_0_f_res_582940 = eta_p_582935 - eta_p_582936;
            double defunc_0_f_res_582942 = defunc_0_f_res_582940 / eta_p_582937;
            int64_t f64_res_582944 = fptosi_f64_i64(defunc_0_f_res_582942);
            int64_t max_res_582946 = smax64((int64_t) 0, f64_res_582944);
            int64_t zm_lhs_582952 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586081];
            int64_t min_arg1_582953 = sub64(zm_lhs_582952, (int64_t) 1);
            int64_t min_res_582954 = smin64(max_res_582946, min_arg1_582953);
            int64_t defunc_0_f_res_582956 = mul64(eta_p_582939, min_res_582954);
            
            ((int64_t *) mem_586484)[i_586081] = defunc_0_f_res_582956;
        }
        
        int64_t defunc_0_foldl_res_582687;
        int64_t acc_582689 = (int64_t) 0;
        
        for (int64_t i_582688 = 0; i_582688 < dim_274571; i_582688++) {
            int64_t b_582690 = ((int64_t *) mem_586484)[i_582688];
            int64_t defunc_0_f_res_582691 = add64(acc_582689, b_582690);
            int64_t acc_tmp_588032 = defunc_0_f_res_582691;
            
            acc_582689 = acc_tmp_588032;
        }
        defunc_0_foldl_res_582687 = acc_582689;
        
        bool x_582693 = sle64((int64_t) 0, defunc_0_foldl_res_582687);
        bool y_582694 = slt64(defunc_0_foldl_res_582687, total_grid_no_274583);
        bool bounds_check_582695 = x_582693 && y_582694;
        bool index_certs_582696;
        
        if (!bounds_check_582695) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582687, "] out of bounds for array of shape [", (long long) total_grid_no_274583, "].", "-> #0  ftSkyline.fut:303:42-67\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:349:69-71\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582697 = ((bool *) ext_mem_586472.mem)[defunc_0_foldl_res_582687];
        bool lifted_lambda_res_582698 = !tmp_582697;
        int64_t defunc_0_f_res_582699 = btoi_bool_i64(lifted_lambda_res_582698);
        int64_t defunc_0_op_res_580349 = add64(defunc_0_f_res_582699, scanacc_586085);
        
        ((int64_t *) mem_586474)[i_586088] = defunc_0_op_res_580349;
        ((int64_t *) mem_586476)[i_586088] = defunc_0_f_res_582699;
        
        int64_t scanacc_tmp_588028 = defunc_0_op_res_580349;
        
        scanacc_586085 = scanacc_tmp_588028;
    }
    discard_586091 = scanacc_586085;
    if (memblock_unref(ctx, &ext_mem_586472, "ext_mem_586472") != 0)
        return 1;
    
    bool cond_580350 = n_274575 == (int64_t) 0;
    bool x_580351 = !cond_580350;
    int64_t tmp_580352 = sub64(n_274575, (int64_t) 1);
    bool x_580353 = sle64((int64_t) 0, tmp_580352);
    bool y_580354 = slt64(tmp_580352, n_274575);
    bool bounds_check_580355 = x_580353 && y_580354;
    bool protect_assert_disj_580356 = cond_580350 || bounds_check_580355;
    bool index_certs_580357;
    
    if (!protect_assert_disj_580356) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_580352, "] out of bounds for array of shape [", (long long) n_274575, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_580358;
    
    if (x_580351) {
        int64_t x_584924 = ((int64_t *) mem_586474)[tmp_580352];
        
        m_f_res_580358 = x_584924;
    } else {
        m_f_res_580358 = (int64_t) 0;
    }
    
    int64_t m_580360;
    
    if (cond_580350) {
        m_580360 = (int64_t) 0;
    } else {
        m_580360 = m_f_res_580358;
    }
    
    int64_t m_580370 = sub64(m_580360, (int64_t) 1);
    bool i_p_m_t_s_leq_w_580372 = slt64(m_580370, n_274575);
    bool zzero_leq_i_p_m_t_s_580371 = sle64((int64_t) 0, m_580370);
    bool y_580374 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_580372;
    bool i_lte_j_580373 = sle64((int64_t) 0, m_580360);
    bool forwards_ok_580375 = i_lte_j_580373 && y_580374;
    bool eq_x_zz_580367 = (int64_t) 0 == m_f_res_580358;
    bool p_and_eq_x_y_580368 = x_580351 && eq_x_zz_580367;
    bool empty_slice_580369 = cond_580350 || p_and_eq_x_y_580368;
    bool ok_or_empty_580376 = empty_slice_580369 || forwards_ok_580375;
    bool index_certs_580377;
    
    if (!ok_or_empty_580376) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_580360, "] out of bounds for array of shape [", (long long) n_274575, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586497 = (int64_t) 8 * m_580360;
    int64_t bytes_586498 = dim_274571 * binop_x_586497;
    
    if (memblock_alloc(ctx, &mem_586499, bytes_586498, "mem_586499")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 2, (uint64_t *) mem_586499.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) xs_mem_586423.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {m_580360, dim_274571});
    if (memblock_alloc(ctx, &mem_586501, binop_x_586497, "mem_586501")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586501.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586425, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
    if (mem_586510_cached_sizze_588665 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_588665, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586092 = 0; write_iter_586092 < n_274575; write_iter_586092++) {
        int64_t write_iv_586095 = ((int64_t *) mem_586476)[write_iter_586092];
        int64_t write_iv_586096 = ((int64_t *) mem_586474)[write_iter_586092];
        int64_t write_iv_586098 = ((int64_t *) mem_586425)[write_iter_586092];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586510, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) xs_mem_586423.mem, write_iter_586092 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
        
        bool cond_582643 = write_iv_586095 == (int64_t) 1;
        int64_t lifted_lambda_res_582644;
        
        if (cond_582643) {
            int64_t lifted_lambda_res_t_res_584925 = sub64(write_iv_586096, (int64_t) 1);
            
            lifted_lambda_res_582644 = lifted_lambda_res_t_res_584925;
        } else {
            lifted_lambda_res_582644 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582644) && slt64(lifted_lambda_res_582644, m_580360)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_274571 - (int64_t) 1, dim_274571))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586499.mem, lifted_lambda_res_582644 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586510, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582644) && slt64(lifted_lambda_res_582644, m_580360)) {
            ((int64_t *) mem_586501.mem)[lifted_lambda_res_582644] = write_iv_586098;
        }
    }
    
    bool cond_580409 = !use_measure_for_sorting_274596;
    bool y_581105 = slt64((int64_t) 0, dz2080U_274574);
    bool protect_assert_disj_582327 = cond_580409 || y_581105;
    bool index_certs_581106;
    
    if (!protect_assert_disj_582327) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582329 = assert_cond_580164 || cond_580409;
    bool empty_or_match_cert_581199;
    
    if (!protect_assert_disj_582329) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581230 = sle64(m_580360, (int64_t) 1);
    bool x_581231 = !cond_581230;
    int64_t zp_rhs_581233 = sdiv_safe64(m_580370, (int64_t) 20);
    int64_t min_num_blocks_581234 = add64((int64_t) 1, zp_rhs_581233);
    bool loop_cond_581235 = slt64((int64_t) 1, min_num_blocks_581234);
    bool x_582330;
    int64_t x_582331;
    bool loop_while_581238;
    int64_t x_581239;
    
    loop_while_581238 = loop_cond_581235;
    x_581239 = (int64_t) 1;
    while (loop_while_581238) {
        int64_t loopres_581240 = mul64((int64_t) 2, x_581239);
        bool loop_cond_581241 = slt64(loopres_581240, min_num_blocks_581234);
        bool loop_while_tmp_588035 = loop_cond_581241;
        int64_t x_tmp_588036 = loopres_581240;
        
        loop_while_581238 = loop_while_tmp_588035;
        x_581239 = x_tmp_588036;
    }
    x_582330 = loop_while_581238;
    x_582331 = x_581239;
    
    bool zzero_581242 = x_582331 == (int64_t) 0;
    bool nonzzero_581243 = !zzero_581242;
    bool protect_assert_disj_581244 = cond_581230 || nonzzero_581243;
    bool protect_assert_disj_582335 = cond_580409 || protect_assert_disj_581244;
    bool nonzzero_cert_581245;
    
    if (!protect_assert_disj_582335) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_581246 = sdiv_safe64(m_580370, x_582331);
    int64_t block_sizze_581247 = add64((int64_t) 1, zp_rhs_581246);
    bool y_581248 = slt64((int64_t) 0, m_580360);
    bool protect_assert_disj_581249 = cond_581230 || y_581248;
    bool protect_assert_disj_582337 = cond_580409 || protect_assert_disj_581249;
    bool index_certs_581250;
    
    if (!protect_assert_disj_582337) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582338 = use_measure_for_sorting_274596 && x_581231;
    int64_t reduce_arg1_581255;
    
    if (protect_cond_conj_582338) {
        int64_t x_584926 = ((int64_t *) mem_586501.mem)[(int64_t) 0];
        
        reduce_arg1_581255 = x_584926;
    } else {
        reduce_arg1_581255 = (int64_t) 0;
    }
    
    int64_t flat_dim_581257 = block_sizze_581247 * x_582331;
    int64_t greatest_divisor_leq_than_arg1_581262 = mul64((int64_t) 2, block_sizze_581247);
    int64_t merge_block_sizze_581263;
    
    if (protect_cond_conj_582338) {
        int64_t x_584927;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584927, (int64_t) 8, greatest_divisor_leq_than_arg1_581262) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_581263 = x_584927;
    } else {
        merge_block_sizze_581263 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_581292 = slt64(x_582331, (int64_t) 0);
    bool valid_581293 = !bounds_invalid_upwards_581292;
    bool protect_assert_disj_582319 = cond_581230 || valid_581293;
    bool protect_assert_disj_582341 = cond_580409 || protect_assert_disj_582319;
    bool range_valid_c_581294;
    
    if (!protect_assert_disj_582341) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582331, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:805:33-56\n   #7  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_581296 = slt64(block_sizze_581247, (int64_t) 0);
    bool valid_581297 = !bounds_invalid_upwards_581296;
    bool protect_assert_disj_582321 = cond_581230 || valid_581297;
    bool protect_assert_disj_582343 = cond_580409 || protect_assert_disj_582321;
    bool range_valid_c_581298;
    
    if (!protect_assert_disj_582343) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_581247, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581300 = sle64(block_sizze_581247, (int64_t) 1);
    int64_t tmp_581301 = sub64(block_sizze_581247, (int64_t) 2);
    bool bounds_invalid_upwards_581302 = slt64(tmp_581301, (int64_t) 0);
    int64_t distance_581303 = add64((int64_t) 1, tmp_581301);
    bool valid_581304 = !bounds_invalid_upwards_581302;
    bool protect_assert_disj_581305 = cond_581300 || valid_581304;
    bool protect_assert_disj_582323 = cond_581230 || protect_assert_disj_581305;
    bool protect_assert_disj_582345 = cond_580409 || protect_assert_disj_582323;
    bool range_valid_c_581306;
    
    if (!protect_assert_disj_582345) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_581301, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_581426 = slt64(block_sizze_581247, flat_dim_581257);
    bool zzero_581427 = merge_block_sizze_581263 == (int64_t) 0;
    bool nonzzero_581428 = !zzero_581427;
    bool protect_assert_disj_582290 = use_measure_for_sorting_274596 || y_581105;
    bool index_certs_580418;
    
    if (!protect_assert_disj_582290) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582292 = use_measure_for_sorting_274596 || assert_cond_580164;
    bool empty_or_match_cert_580502;
    
    if (!protect_assert_disj_582292) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582293;
    int64_t x_582294;
    bool loop_while_580538;
    int64_t x_580539;
    
    loop_while_580538 = loop_cond_581235;
    x_580539 = (int64_t) 1;
    while (loop_while_580538) {
        int64_t loopres_580540 = mul64((int64_t) 2, x_580539);
        bool loop_cond_580541 = slt64(loopres_580540, min_num_blocks_581234);
        bool loop_while_tmp_588037 = loop_cond_580541;
        int64_t x_tmp_588038 = loopres_580540;
        
        loop_while_580538 = loop_while_tmp_588037;
        x_580539 = x_tmp_588038;
    }
    x_582293 = loop_while_580538;
    x_582294 = x_580539;
    
    bool zzero_580542 = x_582294 == (int64_t) 0;
    bool nonzzero_580543 = !zzero_580542;
    bool protect_assert_disj_580544 = nonzzero_580543 || cond_581230;
    bool protect_assert_disj_582298 = use_measure_for_sorting_274596 || protect_assert_disj_580544;
    bool nonzzero_cert_580545;
    
    if (!protect_assert_disj_582298) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_580546 = sdiv_safe64(m_580370, x_582294);
    int64_t block_sizze_580547 = add64((int64_t) 1, zp_rhs_580546);
    bool protect_assert_disj_582300 = use_measure_for_sorting_274596 || protect_assert_disj_581249;
    bool index_certs_580550;
    
    if (!protect_assert_disj_582300) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582301 = cond_580409 && x_581231;
    int64_t reduce_arg1_580553;
    
    if (protect_cond_conj_582301) {
        int64_t x_584928 = ((int64_t *) mem_586501.mem)[(int64_t) 0];
        
        reduce_arg1_580553 = x_584928;
    } else {
        reduce_arg1_580553 = (int64_t) 0;
    }
    
    int64_t flat_dim_580555 = block_sizze_580547 * x_582294;
    int64_t greatest_divisor_leq_than_arg1_580559 = mul64((int64_t) 2, block_sizze_580547);
    int64_t merge_block_sizze_580560;
    
    if (protect_cond_conj_582301) {
        int64_t x_584929;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584929, (int64_t) 8, greatest_divisor_leq_than_arg1_580559) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_580560 = x_584929;
    } else {
        merge_block_sizze_580560 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_580578 = slt64(x_582294, (int64_t) 0);
    bool valid_580579 = !bounds_invalid_upwards_580578;
    bool protect_assert_disj_582282 = valid_580579 || cond_581230;
    bool protect_assert_disj_582304 = use_measure_for_sorting_274596 || protect_assert_disj_582282;
    bool range_valid_c_580580;
    
    if (!protect_assert_disj_582304) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582294, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_580582 = slt64(block_sizze_580547, (int64_t) 0);
    bool valid_580583 = !bounds_invalid_upwards_580582;
    bool protect_assert_disj_582284 = valid_580583 || cond_581230;
    bool protect_assert_disj_582306 = use_measure_for_sorting_274596 || protect_assert_disj_582284;
    bool range_valid_c_580584;
    
    if (!protect_assert_disj_582306) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_580547, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_580586 = sle64(block_sizze_580547, (int64_t) 1);
    int64_t tmp_580587 = sub64(block_sizze_580547, (int64_t) 2);
    bool bounds_invalid_upwards_580588 = slt64(tmp_580587, (int64_t) 0);
    int64_t distance_580589 = add64((int64_t) 1, tmp_580587);
    bool valid_580590 = !bounds_invalid_upwards_580588;
    bool protect_assert_disj_580591 = cond_580586 || valid_580590;
    bool protect_assert_disj_582286 = protect_assert_disj_580591 || cond_581230;
    bool protect_assert_disj_582308 = use_measure_for_sorting_274596 || protect_assert_disj_582286;
    bool range_valid_c_580592;
    
    if (!protect_assert_disj_582308) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_580587, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_580680 = slt64(block_sizze_580547, flat_dim_580555);
    bool zzero_580681 = merge_block_sizze_580560 == (int64_t) 0;
    bool nonzzero_580682 = !zzero_580681;
    int64_t bytes_586518 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573;
    int64_t bytes_586560 = (int64_t) 8 * arg_580163;
    int64_t binop_x_586601 = (int64_t) 8 * x_582331;
    int64_t bytes_586602 = block_sizze_581247 * binop_x_586601;
    int64_t bytes_586609 = dim_274571 * bytes_586602;
    int64_t lmad_arg_586631 = dim_274571 * block_sizze_581247;
    int64_t bytes_586632 = (int64_t) 8 * block_sizze_581247;
    int64_t bytes_586637 = dim_274571 * bytes_586632;
    int64_t lmad_arg_586865 = dim_274571 * merge_block_sizze_581263;
    int64_t binop_x_587129 = (int64_t) 8 * x_582294;
    int64_t bytes_587130 = block_sizze_580547 * binop_x_587129;
    int64_t bytes_587134 = dim_274571 * bytes_587130;
    int64_t lmad_arg_587152 = dim_274571 * block_sizze_580547;
    int64_t bytes_587153 = (int64_t) 8 * block_sizze_580547;
    int64_t bytes_587156 = dim_274571 * bytes_587153;
    int64_t lmad_arg_587338 = dim_274571 * merge_block_sizze_580560;
    
    if (cond_580409) {
        if (mem_587063_cached_sizze_588695 < bytes_586518) {
            err = lexical_realloc(ctx, &mem_587063, &mem_587063_cached_sizze_588695, bytes_586518);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586103 = 0; i_586103 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573; i_586103++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_585120 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586103];
            double i64_res_585121 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_585120);
            double defunc_0_fover_res_585122 = 1.5707963267948966 / i64_res_585121;
            
            ((double *) mem_587063)[i_586103] = defunc_0_fover_res_585122;
        }
        if (mem_587071_cached_sizze_588696 < binop_x_586497) {
            err = lexical_realloc(ctx, &mem_587071, &mem_587071_cached_sizze_588696, binop_x_586497);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587076_cached_sizze_588697 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_587076, &mem_587076_cached_sizze_588697, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587084_cached_sizze_588698 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_587084, &mem_587084_cached_sizze_588698, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587092_cached_sizze_588699 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_587092, &mem_587092_cached_sizze_588699, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587108_cached_sizze_588701 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_587108, &mem_587108_cached_sizze_588701, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586123 = 0; i_586123 < m_580360; i_586123++) {
            for (int64_t i_586107 = 0; i_586107 < dim_274571; i_586107++) {
                double eta_p_585129 = ((double *) mem_586499.mem)[i_586123 * dim_274571 + i_586107];
                double eta_p_585130 = ((double *) start_of_grid_partition_mem_586422.mem)[i_586107];
                double eta_p_585131 = ((double *) grid_part_sizze_per_dim_mem_586420.mem)[i_586107];
                int64_t eta_p_585133 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586107];
                double defunc_0_f_res_585134 = eta_p_585129 - eta_p_585130;
                double defunc_0_f_res_585135 = defunc_0_f_res_585134 / eta_p_585131;
                int64_t f64_res_585136 = fptosi_f64_i64(defunc_0_f_res_585135);
                int64_t max_res_585137 = smax64((int64_t) 0, f64_res_585136);
                int64_t zm_lhs_585142 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586107];
                int64_t min_arg1_585143 = sub64(zm_lhs_585142, (int64_t) 1);
                int64_t min_res_585144 = smin64(max_res_585137, min_arg1_585143);
                int64_t defunc_0_f_res_585145 = mul64(eta_p_585133, min_res_585144);
                
                ((int64_t *) mem_587076)[i_586107] = defunc_0_f_res_585145;
            }
            
            int64_t defunc_0_foldl_res_585147;
            int64_t acc_585149 = (int64_t) 0;
            
            for (int64_t i_585148 = 0; i_585148 < dim_274571; i_585148++) {
                int64_t b_585150 = ((int64_t *) mem_587076)[i_585148];
                int64_t defunc_0_f_res_585151 = add64(acc_585149, b_585150);
                int64_t acc_tmp_588042 = defunc_0_f_res_585151;
                
                acc_585149 = acc_tmp_588042;
            }
            defunc_0_foldl_res_585147 = acc_585149;
            
            bool x_585152 = sle64((int64_t) 0, defunc_0_foldl_res_585147);
            bool y_585153 = slt64(defunc_0_foldl_res_585147, dz2080U_274574);
            bool bounds_check_585154 = x_585152 && y_585153;
            bool index_certs_585155;
            
            if (!bounds_check_585154) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_585147, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586111 = 0; i_586111 < dim_274571; i_586111++) {
                double eta_p_585158 = ((double *) mem_586499.mem)[i_586123 * dim_274571 + i_586111];
                double eta_p_585159 = ((double *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_585147 * dim_274571 + i_586111];
                double defunc_0_f_res_585160 = eta_p_585158 - eta_p_585159;
                
                ((double *) mem_587084)[i_586111] = defunc_0_f_res_585160;
            }
            for (int64_t nest_i_588044 = 0; nest_i_588044 < arg_580163; nest_i_588044++) {
                ((double *) mem_587092)[nest_i_588044] = 0.0;
            }
            for (int64_t i_585164 = 0; i_585164 < arg_580163; i_585164++) {
                bool y_585166 = slt64(i_585164, dim_274571);
                bool index_certs_585167;
                
                if (!y_585166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585164, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_585169 = add64((int64_t) 1, i_585164);
                int64_t j_m_i_585170 = sub64(dim_274571, map_arg1_585169);
                bool empty_slice_585171 = j_m_i_585170 == (int64_t) 0;
                int64_t m_585172 = sub64(j_m_i_585170, (int64_t) 1);
                int64_t i_p_m_t_s_585173 = add64(map_arg1_585169, m_585172);
                bool zzero_leq_i_p_m_t_s_585174 = sle64((int64_t) 0, i_p_m_t_s_585173);
                bool i_p_m_t_s_leq_w_585175 = slt64(i_p_m_t_s_585173, dim_274571);
                bool zzero_lte_i_585176 = sle64((int64_t) 0, map_arg1_585169);
                bool i_lte_j_585177 = sle64(map_arg1_585169, dim_274571);
                bool y_585178 = i_p_m_t_s_leq_w_585175 && zzero_lte_i_585176;
                bool y_585179 = zzero_leq_i_p_m_t_s_585174 && y_585178;
                bool forwards_ok_585180 = i_lte_j_585177 && y_585179;
                bool ok_or_empty_585181 = empty_slice_585171 || forwards_ok_585180;
                bool index_certs_585182;
                
                if (!ok_or_empty_585181) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_585169, ":", (long long) dim_274571, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587096 = (int64_t) 8 * j_m_i_585170;
                double this_x_585168 = ((double *) mem_587084)[i_585164];
                
                if (mem_587097_cached_sizze_588700 < bytes_587096) {
                    err = lexical_realloc(ctx, &mem_587097, &mem_587097_cached_sizze_588700, bytes_587096);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586115 = 0; i_586115 < j_m_i_585170; i_586115++) {
                    int64_t slice_586383 = map_arg1_585169 + i_586115;
                    double eta_p_585185 = ((double *) mem_587084)[slice_586383];
                    double defunc_0_ftimes_res_585186 = eta_p_585185 * eta_p_585185;
                    
                    ((double *) mem_587097)[i_586115] = defunc_0_ftimes_res_585186;
                }
                
                double defunc_0_foldl_res_585188;
                double acc_585190 = 0.0;
                
                for (int64_t i_585189 = 0; i_585189 < j_m_i_585170; i_585189++) {
                    double b_585191 = ((double *) mem_587097)[i_585189];
                    double defunc_0_f_res_585192 = acc_585190 + b_585191;
                    double acc_tmp_588047 = defunc_0_f_res_585192;
                    
                    acc_585190 = acc_tmp_588047;
                }
                defunc_0_foldl_res_585188 = acc_585190;
                
                double sqrt_res_585193 = futrts_sqrt64(defunc_0_foldl_res_585188);
                double atan2_res_585194 = futrts_atan2_64(sqrt_res_585193, this_x_585168);
                
                ((double *) mem_587092)[i_585164] = atan2_res_585194;
            }
            for (int64_t i_586119 = 0; i_586119 < arg_580163; i_586119++) {
                double eta_p_585197 = ((double *) mem_587092)[i_586119];
                double eta_p_585198 = ((double *) mem_587063)[i_586119];
                int64_t eta_p_585199 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586119];
                int64_t eta_p_585200 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586119];
                double i64_res_585201 = sitofp_i64_f64(eta_p_585199);
                double defunc_0_fover_res_585202 = eta_p_585197 / eta_p_585198;
                double defunc_0_ftimes_res_585203 = i64_res_585201 * defunc_0_fover_res_585202;
                int64_t f64_res_585204 = fptosi_f64_i64(defunc_0_ftimes_res_585203);
                bool cond_585205 = slt64(f64_res_585204, (int64_t) 0);
                int64_t defunc_0_f_res_585206;
                
                if (cond_585205) {
                    defunc_0_f_res_585206 = (int64_t) 0;
                } else {
                    bool cond_585207 = sle64(eta_p_585200, f64_res_585204);
                    int64_t defunc_0_f_res_f_res_585208;
                    
                    if (cond_585207) {
                        int64_t defunc_0_f_res_f_res_t_res_585209 = sub64(eta_p_585200, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_585208 = defunc_0_f_res_f_res_t_res_585209;
                    } else {
                        defunc_0_f_res_f_res_585208 = f64_res_585204;
                    }
                    defunc_0_f_res_585206 = defunc_0_f_res_f_res_585208;
                }
                ((int64_t *) mem_587108)[i_586119] = defunc_0_f_res_585206;
            }
            
            int64_t defunc_0_foldl_res_585211;
            int64_t acc_585213 = (int64_t) 0;
            
            for (int64_t i_585212 = 0; i_585212 < arg_580163; i_585212++) {
                int64_t b_585214 = ((int64_t *) mem_587108)[i_585212];
                int64_t defunc_0_f_res_585215 = add64(acc_585213, b_585214);
                int64_t acc_tmp_588049 = defunc_0_f_res_585215;
                
                acc_585213 = acc_tmp_588049;
            }
            defunc_0_foldl_res_585211 = acc_585213;
            
            int64_t zp_lhs_585216 = mul64(total_angle_no_274591, defunc_0_foldl_res_585147);
            int64_t get_id_from_grid_angle_res_585217 = add64(defunc_0_foldl_res_585211, zp_lhs_585216);
            
            ((int64_t *) mem_587071)[i_586123] = get_id_from_grid_angle_res_585217;
        }
        
        int64_t reduce_arg1_585220;
        
        if (x_581231) {
            int64_t x_585221 = ((int64_t *) mem_587071)[(int64_t) 0];
            
            reduce_arg1_585220 = x_585221;
        } else {
            reduce_arg1_585220 = (int64_t) 0;
        }
        if (cond_581230) {
            if (memblock_set(ctx, &ext_mem_587491, &mem_586499, "mem_586499") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587487, &mem_586501, "mem_586501") != 0)
                return 1;
        } else {
            int64_t ext_587127;
            int64_t defunc_0_reduce_res_585225;
            int64_t defunc_0_reduce_res_585227;
            int64_t redout_586125;
            int64_t redout_586127;
            int64_t ctx_param_ext_587118;
            
            if (memblock_set(ctx, &mem_param_587120, &mem_586499, "mem_586499") != 0)
                return 1;
            ctx_param_ext_587118 = (int64_t) 0;
            redout_586125 = reduce_arg1_585220;
            redout_586127 = reduce_arg1_580553;
            for (int64_t i_586128 = 0; i_586128 < m_580360; i_586128++) {
                int64_t x_585228 = ((int64_t *) mem_587071)[i_586128];
                int64_t x_585230 = ((int64_t *) mem_586501.mem)[i_586128];
                bool lifted_lambda_res_585237 = sle64(redout_586125, x_585228);
                int64_t defunc_0_op_res_585238;
                
                if (lifted_lambda_res_585237) {
                    defunc_0_op_res_585238 = x_585228;
                } else {
                    defunc_0_op_res_585238 = redout_586125;
                }
                
                int64_t defunc_0_op_res_585239;
                
                if (lifted_lambda_res_585237) {
                    defunc_0_op_res_585239 = x_585230;
                } else {
                    defunc_0_op_res_585239 = redout_586127;
                }
                
                int64_t binop_y_587121 = dim_274571 * i_586128;
                int64_t ext_587124;
                
                if (lifted_lambda_res_585237) {
                    ext_587124 = binop_y_587121;
                } else {
                    ext_587124 = ctx_param_ext_587118;
                }
                if (lifted_lambda_res_585237) {
                    if (memblock_set(ctx, &ext_mem_587125, &mem_586499, "mem_586499") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587125, &mem_param_587120, "mem_param_587120") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588050, &ext_mem_587125, "ext_mem_587125") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588051 = ext_587124;
                int64_t redout_tmp_588052 = defunc_0_op_res_585238;
                int64_t redout_tmp_588054 = defunc_0_op_res_585239;
                
                if (memblock_set(ctx, &mem_param_587120, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
                    return 1;
                ctx_param_ext_587118 = ctx_param_ext_tmp_588051;
                redout_586125 = redout_tmp_588052;
                redout_586127 = redout_tmp_588054;
            }
            if (memblock_set(ctx, &ext_mem_587128, &mem_param_587120, "mem_param_587120") != 0)
                return 1;
            ext_587127 = ctx_param_ext_587118;
            defunc_0_reduce_res_585225 = redout_586125;
            defunc_0_reduce_res_585227 = redout_586127;
            if (mem_587131_cached_sizze_588702 < bytes_587130) {
                err = lexical_realloc(ctx, &mem_587131, &mem_587131_cached_sizze_588702, bytes_587130);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587135_cached_sizze_588703 < bytes_587134) {
                err = lexical_realloc(ctx, &mem_587135, &mem_587135_cached_sizze_588703, bytes_587134);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587138_cached_sizze_588704 < bytes_587130) {
                err = lexical_realloc(ctx, &mem_587138, &mem_587138_cached_sizze_588704, bytes_587130);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587154_cached_sizze_588705 < bytes_587153) {
                err = lexical_realloc(ctx, &mem_587154, &mem_587154_cached_sizze_588705, bytes_587153);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587157_cached_sizze_588706 < bytes_587156) {
                err = lexical_realloc(ctx, &mem_587157, &mem_587157_cached_sizze_588706, bytes_587156);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587159_cached_sizze_588707 < bytes_587153) {
                err = lexical_realloc(ctx, &mem_587159, &mem_587159_cached_sizze_588707, bytes_587153);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586145 = 0; i_586145 < x_582294; i_586145++) {
                int64_t zp_lhs_585256 = mul64(block_sizze_580547, i_586145);
                
                for (int64_t i_586135 = 0; i_586135 < block_sizze_580547; i_586135++) {
                    int64_t k_585261 = add64(zp_lhs_585256, i_586135);
                    bool cond_585262 = slt64(k_585261, m_580360);
                    int64_t binop_y_587170 = dim_274571 * k_585261;
                    int64_t ext_587173;
                    
                    if (cond_585262) {
                        ext_587173 = binop_y_587170;
                    } else {
                        ext_587173 = ext_587127;
                    }
                    
                    int64_t lifted_lambda_res_585263;
                    int64_t lifted_lambda_res_585265;
                    
                    if (cond_585262) {
                        bool x_585266 = sle64((int64_t) 0, k_585261);
                        bool bounds_check_585267 = cond_585262 && x_585266;
                        bool index_certs_585268;
                        
                        if (!bounds_check_585267) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_585261, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585269 = ((int64_t *) mem_587071)[k_585261];
                        int64_t lifted_lambda_res_t_res_585271 = ((int64_t *) mem_586501.mem)[k_585261];
                        
                        if (memblock_set(ctx, &ext_mem_587174, &mem_586499, "mem_586499") != 0)
                            return 1;
                        lifted_lambda_res_585263 = lifted_lambda_res_t_res_585269;
                        lifted_lambda_res_585265 = lifted_lambda_res_t_res_585271;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587174, &ext_mem_587128, "ext_mem_587128") != 0)
                            return 1;
                        lifted_lambda_res_585263 = defunc_0_reduce_res_585225;
                        lifted_lambda_res_585265 = defunc_0_reduce_res_585227;
                    }
                    ((int64_t *) mem_587154)[i_586135] = lifted_lambda_res_585263;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587157, i_586135 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587174.mem, ext_587173, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                    if (memblock_unref(ctx, &ext_mem_587174, "ext_mem_587174") != 0)
                        return 1;
                    ((int64_t *) mem_587159)[i_586135] = lifted_lambda_res_585265;
                }
                if (!cond_580586) {
                    if (mem_587206_cached_sizze_588708 < bytes_586437) {
                        err = lexical_realloc(ctx, &mem_587206, &mem_587206_cached_sizze_588708, bytes_586437);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587208_cached_sizze_588709 < bytes_586437) {
                        err = lexical_realloc(ctx, &mem_587208, &mem_587208_cached_sizze_588709, bytes_586437);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_585281 = 0; i_585281 < distance_580589; i_585281++) {
                        int64_t gt_arg1_585285 = add64((int64_t) 1, i_585281);
                        bool x_585286 = sle64((int64_t) 0, gt_arg1_585285);
                        bool y_585287 = slt64(gt_arg1_585285, block_sizze_580547);
                        bool bounds_check_585288 = x_585286 && y_585287;
                        bool index_certs_585289;
                        
                        if (!bounds_check_585288) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_585285, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_585291 = slt64(i_585281, block_sizze_580547);
                        bool index_certs_585292;
                        
                        if (!y_585291) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585281, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_585290 = ((int64_t *) mem_587154)[gt_arg1_585285];
                        int64_t gt_arg0_585293 = ((int64_t *) mem_587154)[i_585281];
                        bool lifted_lambda_res_585294 = sle64(gt_arg0_585293, gt_arg1_585290);
                        bool defunc_0_lifted_gt_res_585295 = !lifted_lambda_res_585294;
                        bool s_585296;
                        int64_t s_585300;
                        bool loop_while_585301;
                        int64_t j_585305;
                        
                        loop_while_585301 = defunc_0_lifted_gt_res_585295;
                        j_585305 = i_585281;
                        while (loop_while_585301) {
                            bool x_585306 = sle64((int64_t) 0, j_585305);
                            bool y_585307 = slt64(j_585305, block_sizze_580547);
                            bool bounds_check_585308 = x_585306 && y_585307;
                            bool index_certs_585309;
                            
                            if (!bounds_check_585308) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585305, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585314 = add64((int64_t) 1, j_585305);
                            bool x_585315 = sle64((int64_t) 0, copy_arg0_585314);
                            bool y_585316 = slt64(copy_arg0_585314, block_sizze_580547);
                            bool bounds_check_585317 = x_585315 && y_585316;
                            bool index_certs_585318;
                            
                            if (!bounds_check_585317) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_585314, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585310 = ((int64_t *) mem_587154)[j_585305];
                            int64_t copy_arg0_585312 = ((int64_t *) mem_587159)[j_585305];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587206, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587157, (int64_t) 0 + j_585305 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            
                            int64_t copy_arg0_585319 = ((int64_t *) mem_587154)[copy_arg0_585314];
                            int64_t copy_arg0_585321 = ((int64_t *) mem_587159)[copy_arg0_585314];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587208, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587157, (int64_t) 0 + copy_arg0_585314 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_587154)[j_585305] = copy_arg0_585319;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587157, j_585305 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587208, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_587159)[j_585305] = copy_arg0_585321;
                            ((int64_t *) mem_587154)[copy_arg0_585314] = copy_arg0_585310;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587157, copy_arg0_585314 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587206, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_587159)[copy_arg0_585314] = copy_arg0_585312;
                            
                            int64_t tmp_585329 = sub64(j_585305, (int64_t) 1);
                            bool cond_585330 = sle64((int64_t) 0, tmp_585329);
                            bool loop_cond_585331;
                            
                            if (cond_585330) {
                                bool y_585333 = slt64(tmp_585329, block_sizze_580547);
                                bool bounds_check_585334 = cond_585330 && y_585333;
                                bool index_certs_585335;
                                
                                if (!bounds_check_585334) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585329, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585332 = ((int64_t *) mem_587154)[j_585305];
                                int64_t gt_arg0_585336 = ((int64_t *) mem_587154)[tmp_585329];
                                bool lifted_lambda_res_585337 = sle64(gt_arg0_585336, gt_arg1_585332);
                                bool defunc_0_lifted_gt_res_585338 = !lifted_lambda_res_585337;
                                
                                loop_cond_585331 = defunc_0_lifted_gt_res_585338;
                            } else {
                                loop_cond_585331 = 0;
                            }
                            
                            bool loop_while_tmp_588064 = loop_cond_585331;
                            int64_t j_tmp_588068 = tmp_585329;
                            
                            loop_while_585301 = loop_while_tmp_588064;
                            j_585305 = j_tmp_588068;
                        }
                        s_585296 = loop_while_585301;
                        s_585300 = j_585305;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587131, i_586145 * block_sizze_580547, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587154, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580547});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587135, i_586145 * lmad_arg_587152, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) mem_587157, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {block_sizze_580547, dim_274571});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587138, i_586145 * block_sizze_580547, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587159, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580547});
            }
            if (memblock_unref(ctx, &ext_mem_587128, "ext_mem_587128") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587254, bytes_587130, "mem_587254")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587254.mem, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (uint64_t *) mem_587131, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547});
            if (memblock_alloc(ctx, &mem_587259, bytes_587134, "mem_587259")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_587259.mem, (int64_t) 0, (int64_t []) {dim_274571 * block_sizze_580547, dim_274571, (int64_t) 1}, (uint64_t *) mem_587135, (int64_t) 0, (int64_t []) {lmad_arg_587152, dim_274571, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547, dim_274571});
            if (memblock_alloc(ctx, &mem_587263, bytes_587130, "mem_587263")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587263.mem, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (uint64_t *) mem_587138, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547});
            
            int64_t data_585351;
            bool data_585352;
            int64_t data_585356;
            int64_t loop_dz2084Uz2082U_585357;
            bool loop_while_585358;
            int64_t stride_585362;
            
            if (memblock_set(ctx, &mem_param_587267, &mem_587254, "mem_587254") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587271, &mem_587259, "mem_587259") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587274, &mem_587263, "mem_587263") != 0)
                return 1;
            loop_dz2084Uz2082U_585357 = flat_dim_580555;
            loop_while_585358 = loop_cond_580680;
            stride_585362 = block_sizze_580547;
            while (loop_while_585358) {
                int64_t next_stride_585363 = mul64((int64_t) 2, stride_585362);
                bool zzero_585364 = next_stride_585363 == (int64_t) 0;
                bool nonzzero_585365 = !zzero_585364;
                bool nonzzero_cert_585366;
                
                if (!nonzzero_585365) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585367 = sdiv64(flat_dim_580555, next_stride_585363);
                bool bounds_invalid_upwards_585368 = slt64(num_merges_585367, (int64_t) 0);
                bool valid_585369 = !bounds_invalid_upwards_585368;
                bool range_valid_c_585370;
                
                if (!valid_585369) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585367, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585372 = sub64(next_stride_585363, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585373 = sle64((int64_t) 0, m_585372);
                bool cond_585375 = slt64(next_stride_585363, (int64_t) 10);
                bool protect_assert_disj_585376 = nonzzero_580682 || cond_585375;
                bool nonzzero_cert_585377;
                
                if (!protect_assert_disj_585376) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585378 = smod_safe64(next_stride_585363, merge_block_sizze_580560);
                bool num_blocks_585379 = zeze_lhs_585378 == (int64_t) 0;
                bool protect_assert_disj_585380 = cond_585375 || num_blocks_585379;
                bool assert_c_585381;
                
                if (!protect_assert_disj_585380) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585382 = sdiv_safe64(next_stride_585363, merge_block_sizze_580560);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383 = add64((int64_t) 1, num_blocks_585382);
                int64_t j_m_i_585384 = sub64(next_stride_585363, stride_585362);
                int64_t flat_dim_585385 = merge_block_sizze_580560 * num_blocks_585382;
                bool bounds_invalid_upwards_585386 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, (int64_t) 0);
                bool empty_slice_585387 = j_m_i_585384 == (int64_t) 0;
                int64_t m_585388 = sub64(j_m_i_585384, (int64_t) 1);
                bool zzero_lte_i_585389 = sle64((int64_t) 0, stride_585362);
                bool i_lte_j_585390 = sle64(stride_585362, next_stride_585363);
                bool empty_slice_585391 = stride_585362 == (int64_t) 0;
                int64_t m_585392 = sub64(stride_585362, (int64_t) 1);
                bool bounds_invalid_upwards_585393 = slt64(num_blocks_585382, (int64_t) 0);
                bool cond_585394 = slt64((int64_t) 0, stride_585362);
                bool valid_585395 = !bounds_invalid_upwards_585386;
                int64_t i_p_m_t_s_585396 = add64(stride_585362, m_585388);
                bool zzero_leq_i_p_m_t_s_585397 = sle64((int64_t) 0, m_585392);
                bool i_p_m_t_s_leq_w_585398 = slt64(m_585392, next_stride_585363);
                bool valid_585399 = !bounds_invalid_upwards_585393;
                bool i_p_m_t_s_leq_w_585400 = slt64(m_585372, flat_dim_585385);
                bool y_585401 = slt64((int64_t) 0, j_m_i_585384);
                bool protect_assert_disj_585402 = cond_585375 || valid_585395;
                bool range_valid_c_585403;
                
                if (!protect_assert_disj_585402) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585404 = sle64((int64_t) 0, i_p_m_t_s_585396);
                bool i_p_m_t_s_leq_w_585405 = slt64(i_p_m_t_s_585396, next_stride_585363);
                bool y_585406 = zzero_leq_i_p_m_t_s_585397 && i_p_m_t_s_leq_w_585398;
                bool protect_assert_disj_585407 = cond_585375 || valid_585399;
                bool range_valid_c_585408;
                
                if (!protect_assert_disj_585407) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585382, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585409 = zzero_leq_i_p_m_t_s_585373 && i_p_m_t_s_leq_w_585400;
                bool y_585410 = zzero_lte_i_585389 && i_p_m_t_s_leq_w_585405;
                bool forwards_ok_585411 = zzero_lte_i_585389 && y_585406;
                bool ok_or_empty_585412 = zzero_585364 || y_585409;
                bool protect_assert_disj_585413 = cond_585394 || y_585401;
                bool y_585414 = zzero_leq_i_p_m_t_s_585404 && y_585410;
                bool ok_or_empty_585415 = empty_slice_585391 || forwards_ok_585411;
                bool protect_assert_disj_585416 = cond_585375 || ok_or_empty_585412;
                bool index_certs_585417;
                
                if (!protect_assert_disj_585416) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585363, "] out of bounds for array of shape [", (long long) flat_dim_585385, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585418 = !cond_585375;
                bool protect_assert_disj_585419 = protect_assert_disj_585413 || loop_not_taken_585418;
                bool index_certs_585420;
                
                if (!protect_assert_disj_585419) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585421 = i_lte_j_585390 && y_585414;
                bool protect_assert_disj_585422 = cond_585375 || ok_or_empty_585415;
                bool index_certs_585423;
                
                if (!protect_assert_disj_585422) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585362, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585424 = ok_or_empty_585415 || loop_not_taken_585418;
                bool index_certs_585425;
                
                if (!protect_assert_disj_585424) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585362, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585426 = empty_slice_585387 || forwards_ok_585421;
                bool protect_assert_disj_585427 = cond_585375 || ok_or_empty_585426;
                bool index_certs_585428;
                
                if (!protect_assert_disj_585427) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585362, ":] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585429 = loop_not_taken_585418 || ok_or_empty_585426;
                bool index_certs_585430;
                
                if (!protect_assert_disj_585429) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585362, ":] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587275 = (int64_t) 8 * num_merges_585367;
                int64_t bytes_587276 = next_stride_585363 * binop_x_587275;
                int64_t bytes_587280 = dim_274571 * bytes_587276;
                bool i_lte_j_585374 = sle64((int64_t) 0, next_stride_585363);
                
                if (mem_587277_cached_sizze_588710 < bytes_587276) {
                    err = lexical_realloc(ctx, &mem_587277, &mem_587277_cached_sizze_588710, bytes_587276);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587281_cached_sizze_588711 < bytes_587280) {
                    err = lexical_realloc(ctx, &mem_587281, &mem_587281_cached_sizze_588711, bytes_587280);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587284_cached_sizze_588712 < bytes_587276) {
                    err = lexical_realloc(ctx, &mem_587284, &mem_587284_cached_sizze_588712, bytes_587276);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587298 = dim_274571 * next_stride_585363;
                int64_t bytes_587299 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383;
                int64_t binop_x_587315 = (int64_t) 8 * num_blocks_585382;
                int64_t bytes_587316 = merge_block_sizze_580560 * binop_x_587315;
                int64_t bytes_587320 = dim_274571 * bytes_587316;
                int64_t bytes_587407 = (int64_t) 16 * stride_585362;
                int64_t bytes_587412 = dim_274571 * bytes_587407;
                
                for (int64_t i_586172 = 0; i_586172 < num_merges_585367; i_586172++) {
                    int64_t start_585435 = mul64(next_stride_585363, i_586172);
                    int64_t j_m_i_585436 = sub64(loop_dz2084Uz2082U_585357, start_585435);
                    bool empty_slice_585437 = j_m_i_585436 == (int64_t) 0;
                    int64_t m_585438 = sub64(j_m_i_585436, (int64_t) 1);
                    int64_t i_p_m_t_s_585439 = add64(start_585435, m_585438);
                    bool zzero_leq_i_p_m_t_s_585440 = sle64((int64_t) 0, i_p_m_t_s_585439);
                    bool i_p_m_t_s_leq_w_585441 = slt64(i_p_m_t_s_585439, loop_dz2084Uz2082U_585357);
                    bool zzero_lte_i_585442 = sle64((int64_t) 0, start_585435);
                    bool i_lte_j_585443 = sle64(start_585435, loop_dz2084Uz2082U_585357);
                    bool y_585444 = i_p_m_t_s_leq_w_585441 && zzero_lte_i_585442;
                    bool y_585445 = zzero_leq_i_p_m_t_s_585440 && y_585444;
                    bool forwards_ok_585446 = i_lte_j_585443 && y_585445;
                    bool ok_or_empty_585447 = empty_slice_585437 || forwards_ok_585446;
                    bool index_certs_585448;
                    
                    if (!ok_or_empty_585447) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585435, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585357, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585449 = slt64(m_585372, j_m_i_585436);
                    bool y_585450 = zzero_leq_i_p_m_t_s_585373 && i_p_m_t_s_leq_w_585449;
                    bool forwards_ok_585451 = i_lte_j_585374 && y_585450;
                    bool ok_or_empty_585452 = zzero_585364 || forwards_ok_585451;
                    bool index_certs_585453;
                    
                    if (!ok_or_empty_585452) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585363, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:805:33-56\n   #8  ftSkyline.fut:792:17-805:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585463 = stride_585362 + start_585435;
                    int64_t binop_y_587402 = dim_274571 * slice_585463;
                    int64_t binop_y_587404 = dim_274571 * start_585435;
                    int64_t ext_587406;
                    
                    if (cond_585394) {
                        ext_587406 = binop_y_587404;
                    } else {
                        ext_587406 = binop_y_587402;
                    }
                    if (cond_585375) {
                        int64_t dummy_585457;
                        int64_t dummy_585459;
                        
                        if (cond_585394) {
                            int64_t head_res_585460 = ((int64_t *) mem_param_587267.mem)[start_585435];
                            int64_t head_res_585462 = ((int64_t *) mem_param_587274.mem)[start_585435];
                            
                            dummy_585457 = head_res_585460;
                            dummy_585459 = head_res_585462;
                        } else {
                            int64_t head_res_585464 = ((int64_t *) mem_param_587267.mem)[slice_585463];
                            int64_t head_res_585466 = ((int64_t *) mem_param_587274.mem)[slice_585463];
                            
                            dummy_585457 = head_res_585464;
                            dummy_585459 = head_res_585466;
                        }
                        if (memblock_alloc(ctx, &mem_587408, bytes_587407, "mem_587408")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588081 = 0; nest_i_588081 < next_stride_585363; nest_i_588081++) {
                            ((int64_t *) mem_587408.mem)[nest_i_588081] = dummy_585457;
                        }
                        if (memblock_alloc(ctx, &mem_587410, bytes_587407, "mem_587410")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588082 = 0; nest_i_588082 < next_stride_585363; nest_i_588082++) {
                            ((int64_t *) mem_587410.mem)[nest_i_588082] = dummy_585459;
                        }
                        if (memblock_alloc(ctx, &mem_587413, bytes_587412, "mem_587413")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588083 = 0; nest_i_588083 < next_stride_585363; nest_i_588083++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587413.mem, nest_i_588083 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587271.mem, ext_587406, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                        }
                        
                        int64_t data_585470;
                        int64_t i_585475 = (int64_t) 0;
                        
                        for (int64_t k_585474 = 0; k_585474 < next_stride_585363; k_585474++) {
                            int64_t j_585479 = sub64(k_585474, i_585475);
                            bool cond_585480 = j_585479 == j_m_i_585384;
                            bool x_587787 = !cond_585480;
                            bool cond_585482 = slt64(i_585475, stride_585362);
                            bool x_585484 = sle64((int64_t) 0, j_585479);
                            bool y_585485 = slt64(j_585479, j_m_i_585384);
                            bool bounds_check_585486 = x_585484 && y_585485;
                            bool loop_not_taken_587779 = !cond_585482;
                            bool protect_assert_disj_587780 = bounds_check_585486 || loop_not_taken_587779;
                            bool protect_assert_disj_587790 = cond_585480 || protect_assert_disj_587780;
                            bool index_certs_585487;
                            
                            if (!protect_assert_disj_587790) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585479, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585488 = stride_585362 + j_585479;
                            int64_t slice_585489 = start_585435 + slice_585488;
                            bool protect_cond_conj_587791 = cond_585482 && x_587787;
                            int64_t leq_arg1_585490;
                            
                            if (protect_cond_conj_587791) {
                                int64_t x_587781 = ((int64_t *) mem_param_587267.mem)[slice_585489];
                                
                                leq_arg1_585490 = x_587781;
                            } else {
                                leq_arg1_585490 = (int64_t) 0;
                            }
                            
                            bool x_585491 = sle64((int64_t) 0, i_585475);
                            bool bounds_check_585492 = cond_585482 && x_585491;
                            bool protect_assert_disj_587784 = bounds_check_585492 || loop_not_taken_587779;
                            bool protect_assert_disj_587793 = cond_585480 || protect_assert_disj_587784;
                            bool index_certs_585493;
                            
                            if (!protect_assert_disj_587793) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585475, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585494 = start_585435 + i_585475;
                            int64_t leq_arg0_585495;
                            
                            if (protect_cond_conj_587791) {
                                int64_t x_587785 = ((int64_t *) mem_param_587267.mem)[slice_585494];
                                
                                leq_arg0_585495 = x_587785;
                            } else {
                                leq_arg0_585495 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585496 = sle64(leq_arg0_585495, leq_arg1_585490);
                            bool x_587867 = cond_585482 && lifted_lambda_res_585496;
                            bool cond_585481 = cond_585480 || x_587867;
                            bool protect_assert_disj_587695 = cond_585481 || bounds_check_585486;
                            bool index_certs_585513;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585479, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585504 = cond_585482 && x_585491;
                            bool loop_not_taken_587690 = !cond_585481;
                            bool protect_assert_disj_587691 = bounds_check_585504 || loop_not_taken_587690;
                            bool index_certs_585505;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585475, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585515 = start_585435 + slice_585488;
                            int64_t binop_y_587424 = dim_274571 * slice_585515;
                            int64_t binop_y_587426 = dim_274571 * slice_585494;
                            int64_t ext_587428;
                            
                            if (cond_585481) {
                                ext_587428 = binop_y_587426;
                            } else {
                                ext_587428 = binop_y_587424;
                            }
                            
                            int64_t loopres_585497;
                            int64_t loopres_585498;
                            int64_t loopres_585500;
                            
                            if (cond_585481) {
                                int64_t tmp_585501 = add64((int64_t) 1, i_585475);
                                int64_t tmp_585507 = ((int64_t *) mem_param_587267.mem)[slice_585494];
                                int64_t tmp_585509 = ((int64_t *) mem_param_587274.mem)[slice_585494];
                                
                                loopres_585497 = tmp_585501;
                                loopres_585498 = tmp_585507;
                                loopres_585500 = tmp_585509;
                            } else {
                                int64_t tmp_585516 = ((int64_t *) mem_param_587267.mem)[slice_585515];
                                int64_t tmp_585518 = ((int64_t *) mem_param_587274.mem)[slice_585515];
                                
                                loopres_585497 = i_585475;
                                loopres_585498 = tmp_585516;
                                loopres_585500 = tmp_585518;
                            }
                            ((int64_t *) mem_587408.mem)[k_585474] = loopres_585498;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587413.mem, k_585474 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587271.mem, ext_587428, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_587410.mem)[k_585474] = loopres_585500;
                            
                            int64_t i_tmp_588084 = loopres_585497;
                            
                            i_585475 = i_tmp_588084;
                        }
                        data_585470 = i_585475;
                        if (memblock_set(ctx, &ext_mem_587448, &mem_587408, "mem_587408") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587445, &mem_587413, "mem_587413") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587441, &mem_587410, "mem_587410") != 0)
                            return 1;
                    } else {
                        if (mem_587300_cached_sizze_588713 < bytes_587299) {
                            err = lexical_realloc(ctx, &mem_587300, &mem_587300_cached_sizze_588713, bytes_587299);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587302_cached_sizze_588714 < bytes_587299) {
                            err = lexical_realloc(ctx, &mem_587302, &mem_587302_cached_sizze_588714, bytes_587299);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586153 = 0; i_586153 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383; i_586153++) {
                            int64_t split_count_arg3_585526 = mul64(merge_block_sizze_580560, i_586153);
                            int64_t defunc_0_split_count_res_585527;
                            int64_t defunc_0_split_count_res_585528;
                            int64_t defunc_0_split_count_res_585529;
                            int64_t defunc_0_split_count_res_585530;
                            int64_t defunc_0_split_count_res_585531;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585527, &defunc_0_split_count_res_585528, &defunc_0_split_count_res_585529, &defunc_0_split_count_res_585530, &defunc_0_split_count_res_585531, (int64_t) 0, stride_585362, (int64_t) 0, j_m_i_585384, split_count_arg3_585526) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585532 = slt64((int64_t) 0, defunc_0_split_count_res_585531);
                            bool defunc_0_split_count_res_585533;
                            int64_t defunc_0_split_count_res_585534;
                            int64_t defunc_0_split_count_res_585535;
                            int64_t defunc_0_split_count_res_585536;
                            int64_t defunc_0_split_count_res_585537;
                            int64_t defunc_0_split_count_res_585538;
                            bool loop_while_585539;
                            int64_t ss_585540;
                            int64_t ss_585541;
                            int64_t tt_585542;
                            int64_t tt_585543;
                            int64_t count_585544;
                            
                            loop_while_585539 = loop_cond_585532;
                            ss_585540 = defunc_0_split_count_res_585527;
                            ss_585541 = defunc_0_split_count_res_585528;
                            tt_585542 = defunc_0_split_count_res_585529;
                            tt_585543 = defunc_0_split_count_res_585530;
                            count_585544 = defunc_0_split_count_res_585531;
                            while (loop_while_585539) {
                                int64_t zlze_lhs_585545 = sub64(ss_585541, ss_585540);
                                bool cond_585546 = sle64(zlze_lhs_585545, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585547;
                                int64_t defunc_0_lifted_step_res_585548;
                                int64_t defunc_0_lifted_step_res_585549;
                                int64_t defunc_0_lifted_step_res_585550;
                                
                                if (cond_585546) {
                                    int64_t tmp_585551 = add64(tt_585542, count_585544);
                                    
                                    defunc_0_lifted_step_res_585547 = ss_585540;
                                    defunc_0_lifted_step_res_585548 = tmp_585551;
                                    defunc_0_lifted_step_res_585549 = tt_585543;
                                    defunc_0_lifted_step_res_585550 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585552 = sub64(tt_585543, tt_585542);
                                    bool cond_585553 = sle64(zlze_lhs_585552, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585554;
                                    int64_t defunc_0_lifted_step_res_f_res_585555;
                                    int64_t defunc_0_lifted_step_res_f_res_585556;
                                    int64_t defunc_0_lifted_step_res_f_res_585557;
                                    
                                    if (cond_585553) {
                                        int64_t tmp_585558 = add64(ss_585540, count_585544);
                                        
                                        defunc_0_lifted_step_res_f_res_585554 = tmp_585558;
                                        defunc_0_lifted_step_res_f_res_585555 = tt_585542;
                                        defunc_0_lifted_step_res_f_res_585556 = tt_585543;
                                        defunc_0_lifted_step_res_f_res_585557 = (int64_t) 0;
                                    } else {
                                        bool cond_585559 = count_585544 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585560;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585561;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585562;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585563;
                                        
                                        if (cond_585559) {
                                            bool x_585564 = sle64((int64_t) 0, ss_585540);
                                            bool y_585565 = slt64(ss_585540, stride_585362);
                                            bool bounds_check_585566 = x_585564 && y_585565;
                                            bool index_certs_585567;
                                            
                                            if (!bounds_check_585566) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585540, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:805:33-56\n   #13 ftSkyline.fut:792:17-805:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585570 = sle64((int64_t) 0, tt_585542);
                                            bool y_585571 = slt64(tt_585542, j_m_i_585384);
                                            bool bounds_check_585572 = x_585570 && y_585571;
                                            bool index_certs_585573;
                                            
                                            if (!bounds_check_585572) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585542, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:805:33-56\n   #13 ftSkyline.fut:792:17-805:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585568 = start_585435 + ss_585540;
                                            int64_t leq_arg1_585569 = ((int64_t *) mem_param_587267.mem)[slice_585568];
                                            int64_t slice_585574 = stride_585362 + tt_585542;
                                            int64_t slice_585575 = start_585435 + slice_585574;
                                            int64_t leq_arg0_585576 = ((int64_t *) mem_param_587267.mem)[slice_585575];
                                            bool lifted_lambda_res_585577 = sle64(leq_arg0_585576, leq_arg1_585569);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585578;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585579;
                                            
                                            if (lifted_lambda_res_585577) {
                                                int64_t tmp_585580 = add64((int64_t) 1, tt_585542);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585578 = ss_585540;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585579 = tmp_585580;
                                            } else {
                                                int64_t tmp_585581 = add64((int64_t) 1, ss_585540);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585578 = tmp_585581;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585579 = tt_585542;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585560 = defunc_0_lifted_step_res_f_res_f_res_t_res_585578;
                                            defunc_0_lifted_step_res_f_res_f_res_585561 = defunc_0_lifted_step_res_f_res_f_res_t_res_585579;
                                            defunc_0_lifted_step_res_f_res_f_res_585562 = tt_585543;
                                            defunc_0_lifted_step_res_f_res_f_res_585563 = (int64_t) 0;
                                        } else {
                                            int64_t m_585582 = sdiv64(count_585544, (int64_t) 2);
                                            int64_t n_585583 = sub64(count_585544, m_585582);
                                            bool cond_585584 = n_585583 == (int64_t) 0;
                                            int64_t zgze_lhs_585585 = add64(ss_585540, m_585582);
                                            bool cond_f_res_585586 = sle64(ss_585541, zgze_lhs_585585);
                                            bool x_585587 = !cond_585584;
                                            bool y_585588 = cond_f_res_585586 && x_585587;
                                            bool cond_585589 = cond_585584 || y_585588;
                                            bool leq_y_x_585590;
                                            
                                            if (cond_585589) {
                                                leq_y_x_585590 = 1;
                                            } else {
                                                bool x_585591 = sle64((int64_t) 0, zgze_lhs_585585);
                                                bool y_585592 = slt64(zgze_lhs_585585, stride_585362);
                                                bool bounds_check_585593 = x_585591 && y_585592;
                                                bool index_certs_585594;
                                                
                                                if (!bounds_check_585593) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585585, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:805:33-56\n   #13 ftSkyline.fut:792:17-805:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585597 = add64(tt_585542, n_585583);
                                                int64_t leq_arg0_585598 = sub64(zm_lhs_585597, (int64_t) 1);
                                                bool x_585599 = sle64((int64_t) 0, leq_arg0_585598);
                                                bool y_585600 = slt64(leq_arg0_585598, j_m_i_585384);
                                                bool bounds_check_585601 = x_585599 && y_585600;
                                                bool index_certs_585602;
                                                
                                                if (!bounds_check_585601) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585598, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:805:33-56\n   #13 ftSkyline.fut:792:17-805:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585595 = start_585435 + zgze_lhs_585585;
                                                int64_t leq_arg1_585596 = ((int64_t *) mem_param_587267.mem)[slice_585595];
                                                int64_t slice_585603 = stride_585362 + leq_arg0_585598;
                                                int64_t slice_585604 = start_585435 + slice_585603;
                                                int64_t leq_arg0_585605 = ((int64_t *) mem_param_587267.mem)[slice_585604];
                                                bool lifted_lambda_res_585606 = sle64(leq_arg0_585605, leq_arg1_585596);
                                                
                                                leq_y_x_585590 = lifted_lambda_res_585606;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585607;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585608;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585609;
                                            
                                            if (leq_y_x_585590) {
                                                int64_t tmp_585610 = add64(tt_585542, n_585583);
                                                int64_t tmp_585611 = sub64(count_585544, n_585583);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585607 = tmp_585610;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585608 = tt_585543;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585609 = tmp_585611;
                                            } else {
                                                int64_t tmp_585612 = add64(tt_585542, n_585583);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585607 = tt_585542;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585608 = tmp_585612;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585609 = count_585544;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585560 = ss_585540;
                                            defunc_0_lifted_step_res_f_res_f_res_585561 = defunc_0_lifted_step_res_f_res_f_res_f_res_585607;
                                            defunc_0_lifted_step_res_f_res_f_res_585562 = defunc_0_lifted_step_res_f_res_f_res_f_res_585608;
                                            defunc_0_lifted_step_res_f_res_f_res_585563 = defunc_0_lifted_step_res_f_res_f_res_f_res_585609;
                                        }
                                        defunc_0_lifted_step_res_f_res_585554 = defunc_0_lifted_step_res_f_res_f_res_585560;
                                        defunc_0_lifted_step_res_f_res_585555 = defunc_0_lifted_step_res_f_res_f_res_585561;
                                        defunc_0_lifted_step_res_f_res_585556 = defunc_0_lifted_step_res_f_res_f_res_585562;
                                        defunc_0_lifted_step_res_f_res_585557 = defunc_0_lifted_step_res_f_res_f_res_585563;
                                    }
                                    defunc_0_lifted_step_res_585547 = defunc_0_lifted_step_res_f_res_585554;
                                    defunc_0_lifted_step_res_585548 = defunc_0_lifted_step_res_f_res_585555;
                                    defunc_0_lifted_step_res_585549 = defunc_0_lifted_step_res_f_res_585556;
                                    defunc_0_lifted_step_res_585550 = defunc_0_lifted_step_res_f_res_585557;
                                }
                                
                                int64_t loopres_585613;
                                int64_t loopres_585614;
                                int64_t loopres_585615;
                                int64_t loopres_585616;
                                int64_t loopres_585617;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585613, &loopres_585614, &loopres_585615, &loopres_585616, &loopres_585617, defunc_0_lifted_step_res_585547, ss_585541, defunc_0_lifted_step_res_585548, defunc_0_lifted_step_res_585549, defunc_0_lifted_step_res_585550) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585618 = slt64((int64_t) 0, loopres_585617);
                                bool loop_while_tmp_588090 = loop_cond_585618;
                                int64_t ss_tmp_588091 = loopres_585613;
                                int64_t ss_tmp_588092 = loopres_585614;
                                int64_t tt_tmp_588093 = loopres_585615;
                                int64_t tt_tmp_588094 = loopres_585616;
                                int64_t count_tmp_588095 = loopres_585617;
                                
                                loop_while_585539 = loop_while_tmp_588090;
                                ss_585540 = ss_tmp_588091;
                                ss_585541 = ss_tmp_588092;
                                tt_585542 = tt_tmp_588093;
                                tt_585543 = tt_tmp_588094;
                                count_585544 = count_tmp_588095;
                            }
                            defunc_0_split_count_res_585533 = loop_while_585539;
                            defunc_0_split_count_res_585534 = ss_585540;
                            defunc_0_split_count_res_585535 = ss_585541;
                            defunc_0_split_count_res_585536 = tt_585542;
                            defunc_0_split_count_res_585537 = tt_585543;
                            defunc_0_split_count_res_585538 = count_585544;
                            ((int64_t *) mem_587300)[i_586153] = defunc_0_split_count_res_585534;
                            ((int64_t *) mem_587302)[i_586153] = defunc_0_split_count_res_585536;
                        }
                        if (mem_587317_cached_sizze_588715 < bytes_587316) {
                            err = lexical_realloc(ctx, &mem_587317, &mem_587317_cached_sizze_588715, bytes_587316);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587321_cached_sizze_588716 < bytes_587320) {
                            err = lexical_realloc(ctx, &mem_587321, &mem_587321_cached_sizze_588716, bytes_587320);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587324_cached_sizze_588717 < bytes_587316) {
                            err = lexical_realloc(ctx, &mem_587324, &mem_587324_cached_sizze_588717, bytes_587316);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586162 = 0; i_586162 < num_blocks_585382; i_586162++) {
                            bool y_585627 = slt64(i_586162, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383);
                            bool index_certs_585629;
                            
                            if (!y_585627) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585630 = ((int64_t *) mem_587300)[i_586162];
                            int64_t defunc_0_f_res_585631 = ((int64_t *) mem_587302)[i_586162];
                            int64_t tmp_585632 = add64((int64_t) 1, i_586162);
                            bool x_585633 = sle64((int64_t) 0, tmp_585632);
                            bool y_585634 = slt64(tmp_585632, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383);
                            bool bounds_check_585635 = x_585633 && y_585634;
                            bool index_certs_585636;
                            
                            if (!bounds_check_585635) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585632, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585637 = ((int64_t *) mem_587300)[tmp_585632];
                            int64_t defunc_0_f_res_585638 = ((int64_t *) mem_587302)[tmp_585632];
                            int64_t merge_sequential_arg2_585639 = add64(stride_585362, defunc_0_f_res_585631);
                            int64_t merge_sequential_arg2_585640 = add64(stride_585362, defunc_0_f_res_585638);
                            int64_t j_m_i_585641 = sub64(merge_sequential_arg2_585640, merge_sequential_arg2_585639);
                            bool empty_slice_585642 = j_m_i_585641 == (int64_t) 0;
                            int64_t m_585643 = sub64(j_m_i_585641, (int64_t) 1);
                            int64_t i_p_m_t_s_585644 = add64(merge_sequential_arg2_585639, m_585643);
                            bool zzero_leq_i_p_m_t_s_585645 = sle64((int64_t) 0, i_p_m_t_s_585644);
                            bool i_p_m_t_s_leq_w_585646 = slt64(i_p_m_t_s_585644, next_stride_585363);
                            bool zzero_lte_i_585647 = sle64((int64_t) 0, merge_sequential_arg2_585639);
                            bool i_lte_j_585648 = sle64(merge_sequential_arg2_585639, merge_sequential_arg2_585640);
                            bool y_585649 = i_p_m_t_s_leq_w_585646 && zzero_lte_i_585647;
                            bool y_585650 = zzero_leq_i_p_m_t_s_585645 && y_585649;
                            bool forwards_ok_585651 = i_lte_j_585648 && y_585650;
                            bool ok_or_empty_585652 = empty_slice_585642 || forwards_ok_585651;
                            bool index_certs_585653;
                            
                            if (!ok_or_empty_585652) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585639, ":", (long long) merge_sequential_arg2_585640, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585654 = sub64(defunc_0_f_res_585637, defunc_0_f_res_585630);
                            bool empty_slice_585655 = j_m_i_585654 == (int64_t) 0;
                            int64_t m_585656 = sub64(j_m_i_585654, (int64_t) 1);
                            int64_t i_p_m_t_s_585657 = add64(defunc_0_f_res_585630, m_585656);
                            bool zzero_leq_i_p_m_t_s_585658 = sle64((int64_t) 0, i_p_m_t_s_585657);
                            bool i_p_m_t_s_leq_w_585659 = slt64(i_p_m_t_s_585657, next_stride_585363);
                            bool zzero_lte_i_585660 = sle64((int64_t) 0, defunc_0_f_res_585630);
                            bool i_lte_j_585661 = sle64(defunc_0_f_res_585630, defunc_0_f_res_585637);
                            bool y_585662 = i_p_m_t_s_leq_w_585659 && zzero_lte_i_585660;
                            bool y_585663 = zzero_leq_i_p_m_t_s_585658 && y_585662;
                            bool forwards_ok_585664 = i_lte_j_585661 && y_585663;
                            bool ok_or_empty_585665 = empty_slice_585655 || forwards_ok_585664;
                            bool index_certs_585666;
                            
                            if (!ok_or_empty_585665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585630, ":", (long long) defunc_0_f_res_585637, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585667 = slt64((int64_t) 0, j_m_i_585654);
                            bool y_585676 = slt64((int64_t) 0, j_m_i_585641);
                            bool protect_assert_disj_587711 = cond_585667 || y_585676;
                            bool index_certs_585677;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585678 = start_585435 + merge_sequential_arg2_585639;
                            int64_t binop_y_587339 = dim_274571 * slice_585678;
                            int64_t slice_585672 = start_585435 + defunc_0_f_res_585630;
                            int64_t binop_y_587341 = dim_274571 * slice_585672;
                            int64_t ext_587343;
                            
                            if (cond_585667) {
                                ext_587343 = binop_y_587341;
                            } else {
                                ext_587343 = binop_y_587339;
                            }
                            
                            int64_t dummy_585668;
                            int64_t dummy_585670;
                            
                            if (cond_585667) {
                                int64_t head_res_585673 = ((int64_t *) mem_param_587267.mem)[slice_585672];
                                int64_t head_res_585675 = ((int64_t *) mem_param_587274.mem)[slice_585672];
                                
                                dummy_585668 = head_res_585673;
                                dummy_585670 = head_res_585675;
                            } else {
                                int64_t head_res_585679 = ((int64_t *) mem_param_587267.mem)[slice_585678];
                                int64_t head_res_585681 = ((int64_t *) mem_param_587274.mem)[slice_585678];
                                
                                dummy_585668 = head_res_585679;
                                dummy_585670 = head_res_585681;
                            }
                            for (int64_t nest_i_588099 = 0; nest_i_588099 < merge_block_sizze_580560; nest_i_588099++) {
                                ((int64_t *) mem_587317)[i_586162 * merge_block_sizze_580560 + nest_i_588099] = dummy_585668;
                            }
                            for (int64_t nest_i_588100 = 0; nest_i_588100 < merge_block_sizze_580560; nest_i_588100++) {
                                ((int64_t *) mem_587324)[i_586162 * merge_block_sizze_580560 + nest_i_588100] = dummy_585670;
                            }
                            for (int64_t nest_i_588101 = 0; nest_i_588101 < merge_block_sizze_580560; nest_i_588101++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587321, i_586162 * lmad_arg_587338 + nest_i_588101 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587271.mem, ext_587343, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            }
                            
                            int64_t data_585685;
                            int64_t i_585690 = (int64_t) 0;
                            
                            for (int64_t k_585689 = 0; k_585689 < merge_block_sizze_580560; k_585689++) {
                                int64_t j_585694 = sub64(k_585689, i_585690);
                                bool cond_585695 = j_585694 == j_m_i_585641;
                                bool x_587805 = !cond_585695;
                                bool cond_585697 = slt64(i_585690, j_m_i_585654);
                                bool x_585699 = sle64((int64_t) 0, j_585694);
                                bool y_585700 = slt64(j_585694, j_m_i_585641);
                                bool bounds_check_585701 = x_585699 && y_585700;
                                bool loop_not_taken_587797 = !cond_585697;
                                bool protect_assert_disj_587798 = bounds_check_585701 || loop_not_taken_587797;
                                bool protect_assert_disj_587808 = cond_585695 || protect_assert_disj_587798;
                                bool index_certs_585702;
                                
                                if (!protect_assert_disj_587808) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585694, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585703 = merge_sequential_arg2_585639 + j_585694;
                                int64_t slice_585704 = start_585435 + slice_585703;
                                bool protect_cond_conj_587809 = cond_585697 && x_587805;
                                int64_t leq_arg1_585705;
                                
                                if (protect_cond_conj_587809) {
                                    int64_t x_587799 = ((int64_t *) mem_param_587267.mem)[slice_585704];
                                    
                                    leq_arg1_585705 = x_587799;
                                } else {
                                    leq_arg1_585705 = (int64_t) 0;
                                }
                                
                                bool x_585706 = sle64((int64_t) 0, i_585690);
                                bool bounds_check_585707 = cond_585697 && x_585706;
                                bool protect_assert_disj_587802 = bounds_check_585707 || loop_not_taken_587797;
                                bool protect_assert_disj_587811 = cond_585695 || protect_assert_disj_587802;
                                bool index_certs_585708;
                                
                                if (!protect_assert_disj_587811) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585690, "] out of bounds for array of shape [", (long long) j_m_i_585654, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585709 = defunc_0_f_res_585630 + i_585690;
                                int64_t slice_585710 = start_585435 + slice_585709;
                                int64_t leq_arg0_585711;
                                
                                if (protect_cond_conj_587809) {
                                    int64_t x_587803 = ((int64_t *) mem_param_587267.mem)[slice_585710];
                                    
                                    leq_arg0_585711 = x_587803;
                                } else {
                                    leq_arg0_585711 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585712 = sle64(leq_arg0_585711, leq_arg1_585705);
                                bool x_587870 = cond_585697 && lifted_lambda_res_585712;
                                bool cond_585696 = cond_585695 || x_587870;
                                bool protect_assert_disj_587703 = cond_585696 || bounds_check_585701;
                                bool index_certs_585730;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585694, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585720 = cond_585697 && x_585706;
                                bool loop_not_taken_587698 = !cond_585696;
                                bool protect_assert_disj_587699 = bounds_check_585720 || loop_not_taken_587698;
                                bool index_certs_585721;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585690, "] out of bounds for array of shape [", (long long) j_m_i_585654, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585732 = start_585435 + slice_585703;
                                int64_t binop_y_587361 = dim_274571 * slice_585732;
                                int64_t slice_585723 = start_585435 + slice_585709;
                                int64_t binop_y_587363 = dim_274571 * slice_585723;
                                int64_t ext_587365;
                                
                                if (cond_585696) {
                                    ext_587365 = binop_y_587363;
                                } else {
                                    ext_587365 = binop_y_587361;
                                }
                                
                                int64_t loopres_585713;
                                int64_t loopres_585714;
                                int64_t loopres_585716;
                                
                                if (cond_585696) {
                                    int64_t tmp_585717 = add64((int64_t) 1, i_585690);
                                    int64_t tmp_585724 = ((int64_t *) mem_param_587267.mem)[slice_585723];
                                    int64_t tmp_585726 = ((int64_t *) mem_param_587274.mem)[slice_585723];
                                    
                                    loopres_585713 = tmp_585717;
                                    loopres_585714 = tmp_585724;
                                    loopres_585716 = tmp_585726;
                                } else {
                                    int64_t tmp_585733 = ((int64_t *) mem_param_587267.mem)[slice_585732];
                                    int64_t tmp_585735 = ((int64_t *) mem_param_587274.mem)[slice_585732];
                                    
                                    loopres_585713 = i_585690;
                                    loopres_585714 = tmp_585733;
                                    loopres_585716 = tmp_585735;
                                }
                                ((int64_t *) mem_587317)[i_586162 * merge_block_sizze_580560 + k_585689] = loopres_585714;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587321, i_586162 * lmad_arg_587338 + k_585689 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587271.mem, ext_587365, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                                ((int64_t *) mem_587324)[i_586162 * merge_block_sizze_580560 + k_585689] = loopres_585716;
                                
                                int64_t i_tmp_588102 = loopres_585713;
                                
                                i_585690 = i_tmp_588102;
                            }
                            data_585685 = i_585690;
                        }
                        if (memblock_alloc(ctx, &mem_587391, bytes_587316, "mem_587391")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587391.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (uint64_t *) mem_587317, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560});
                        if (memblock_alloc(ctx, &mem_587396, bytes_587320, "mem_587396")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_587396.mem, (int64_t) 0, (int64_t []) {dim_274571 * merge_block_sizze_580560, dim_274571, (int64_t) 1}, (uint64_t *) mem_587321, (int64_t) 0, (int64_t []) {lmad_arg_587338, dim_274571, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560, dim_274571});
                        if (memblock_alloc(ctx, &mem_587400, bytes_587316, "mem_587400")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587400.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (uint64_t *) mem_587324, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560});
                        if (memblock_set(ctx, &ext_mem_587448, &mem_587391, "mem_587391") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587445, &mem_587396, "mem_587396") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587441, &mem_587400, "mem_587400") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587277, i_586172 * next_stride_585363, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587448.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585363});
                    if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587281, i_586172 * lmad_arg_587298, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) ext_mem_587445.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {next_stride_585363, dim_274571});
                    if (memblock_unref(ctx, &ext_mem_587445, "ext_mem_587445") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587284, i_586172 * next_stride_585363, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587441.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585363});
                    if (memblock_unref(ctx, &ext_mem_587441, "ext_mem_587441") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585757 = next_stride_585363 * num_merges_585367;
                
                if (memblock_alloc(ctx, &mem_587464, bytes_587276, "mem_587464")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587464.mem, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (uint64_t *) mem_587277, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363});
                if (memblock_alloc(ctx, &mem_587469, bytes_587280, "mem_587469")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_587469.mem, (int64_t) 0, (int64_t []) {dim_274571 * next_stride_585363, dim_274571, (int64_t) 1}, (uint64_t *) mem_587281, (int64_t) 0, (int64_t []) {lmad_arg_587298, dim_274571, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363, dim_274571});
                if (memblock_alloc(ctx, &mem_587473, bytes_587276, "mem_587473")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587473.mem, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (uint64_t *) mem_587284, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363});
                
                bool loop_cond_585761 = slt64(next_stride_585363, flat_dim_580555);
                
                if (memblock_set(ctx, &mem_param_tmp_588069, &mem_587464, "mem_587464") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588070, &mem_587469, "mem_587469") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588071, &mem_587473, "mem_587473") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588072 = flat_dim_585757;
                bool loop_while_tmp_588073 = loop_cond_585761;
                int64_t stride_tmp_588077 = next_stride_585363;
                
                if (memblock_set(ctx, &mem_param_587267, &mem_param_tmp_588069, "mem_param_tmp_588069") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587271, &mem_param_tmp_588070, "mem_param_tmp_588070") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587274, &mem_param_tmp_588071, "mem_param_tmp_588071") != 0)
                    return 1;
                loop_dz2084Uz2082U_585357 = loop_dz2084Uz2082U_tmp_588072;
                loop_while_585358 = loop_while_tmp_588073;
                stride_585362 = stride_tmp_588077;
            }
            if (memblock_set(ctx, &ext_mem_587484, &mem_param_587267, "mem_param_587267") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587483, &mem_param_587271, "mem_param_587271") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587482, &mem_param_587274, "mem_param_587274") != 0)
                return 1;
            data_585351 = loop_dz2084Uz2082U_585357;
            data_585352 = loop_while_585358;
            data_585356 = stride_585362;
            if (memblock_unref(ctx, &mem_587254, "mem_587254") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587259, "mem_587259") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587263, "mem_587263") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585762 = slt64(m_580370, data_585351);
            bool y_585763 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_585762;
            bool ok_or_empty_585764 = empty_slice_580369 || y_585763;
            bool index_certs_585765;
            
            if (!ok_or_empty_585764) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580360, "] out of bounds for array of shape [", (long long) data_585351, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587491, &ext_mem_587483, "ext_mem_587483") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587487, &ext_mem_587482, "ext_mem_587482") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587493, binop_x_586497, "mem_587493")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587493.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
        if (memblock_unref(ctx, &ext_mem_587487, "ext_mem_587487") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587496, bytes_586498, "mem_587496")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587496.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) ext_mem_587491.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {m_580360, dim_274571});
        if (memblock_unref(ctx, &ext_mem_587491, "ext_mem_587491") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587498, &mem_587496, "mem_587496") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587497, &mem_587493, "mem_587493") != 0)
            return 1;
    } else {
        if (mem_586519_cached_sizze_588666 < bytes_586518) {
            err = lexical_realloc(ctx, &mem_586519, &mem_586519_cached_sizze_588666, bytes_586518);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586178 = 0; i_586178 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573; i_586178++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581195 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586178];
            double i64_res_581196 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581195);
            double defunc_0_fover_res_581197 = 1.5707963267948966 / i64_res_581196;
            
            ((double *) mem_586519)[i_586178] = defunc_0_fover_res_581197;
        }
        if (mem_586527_cached_sizze_588667 < binop_x_586497) {
            err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588667, binop_x_586497);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586529_cached_sizze_588668 < binop_x_586497) {
            err = lexical_realloc(ctx, &mem_586529, &mem_586529_cached_sizze_588668, binop_x_586497);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586537_cached_sizze_588669 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586537, &mem_586537_cached_sizze_588669, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586545_cached_sizze_588670 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586545, &mem_586545_cached_sizze_588670, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586547_cached_sizze_588671 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_588671, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586561_cached_sizze_588672 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_586561, &mem_586561_cached_sizze_588672, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586577_cached_sizze_588674 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588674, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586203 = 0; i_586203 < m_580360; i_586203++) {
            for (int64_t i_586182 = 0; i_586182 < dim_274571; i_586182++) {
                double eta_p_584136 = ((double *) mem_586499.mem)[i_586203 * dim_274571 + i_586182];
                double eta_p_584137 = ((double *) start_of_grid_partition_mem_586422.mem)[i_586182];
                double eta_p_584138 = ((double *) grid_part_sizze_per_dim_mem_586420.mem)[i_586182];
                int64_t eta_p_584140 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586182];
                double defunc_0_f_res_584141 = eta_p_584136 - eta_p_584137;
                double defunc_0_f_res_584143 = defunc_0_f_res_584141 / eta_p_584138;
                int64_t f64_res_584145 = fptosi_f64_i64(defunc_0_f_res_584143);
                int64_t max_res_584147 = smax64((int64_t) 0, f64_res_584145);
                int64_t zm_lhs_584153 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586182];
                int64_t min_arg1_584154 = sub64(zm_lhs_584153, (int64_t) 1);
                int64_t min_res_584155 = smin64(max_res_584147, min_arg1_584154);
                int64_t defunc_0_f_res_584157 = mul64(eta_p_584140, min_res_584155);
                
                ((int64_t *) mem_586537)[i_586182] = defunc_0_f_res_584157;
            }
            
            int64_t defunc_0_foldl_res_581131;
            int64_t acc_581133 = (int64_t) 0;
            
            for (int64_t i_581132 = 0; i_581132 < dim_274571; i_581132++) {
                int64_t b_581134 = ((int64_t *) mem_586537)[i_581132];
                int64_t defunc_0_f_res_581135 = add64(acc_581133, b_581134);
                int64_t acc_tmp_588110 = defunc_0_f_res_581135;
                
                acc_581133 = acc_tmp_588110;
            }
            defunc_0_foldl_res_581131 = acc_581133;
            
            bool x_581136 = sle64((int64_t) 0, defunc_0_foldl_res_581131);
            bool y_581137 = slt64(defunc_0_foldl_res_581131, dz2080U_274574);
            bool bounds_check_581138 = x_581136 && y_581137;
            bool index_certs_581139;
            
            if (!bounds_check_581138) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_581131, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586188 = 0; i_586188 < dim_274571; i_586188++) {
                double eta_p_584065 = ((double *) mem_586499.mem)[i_586203 * dim_274571 + i_586188];
                double eta_p_584066 = ((double *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_581131 * dim_274571 + i_586188];
                double defunc_0_f_res_584067 = eta_p_584065 - eta_p_584066;
                double defunc_0_ftimes_res_584069 = defunc_0_f_res_584067 * defunc_0_f_res_584067;
                
                ((double *) mem_586545)[i_586188] = defunc_0_ftimes_res_584069;
                ((double *) mem_586547)[i_586188] = defunc_0_f_res_584067;
            }
            
            double defunc_0_foldl_res_581149;
            double acc_581151 = 0.0;
            
            for (int64_t i_581150 = 0; i_581150 < dim_274571; i_581150++) {
                double b_581152 = ((double *) mem_586545)[i_581150];
                double defunc_0_f_res_581153 = acc_581151 + b_581152;
                double acc_tmp_588113 = defunc_0_f_res_581153;
                
                acc_581151 = acc_tmp_588113;
            }
            defunc_0_foldl_res_581149 = acc_581151;
            
            double sqrt_res_581154 = futrts_sqrt64(defunc_0_foldl_res_581149);
            
            for (int64_t nest_i_588114 = 0; nest_i_588114 < arg_580163; nest_i_588114++) {
                ((double *) mem_586561)[nest_i_588114] = 0.0;
            }
            for (int64_t i_581157 = 0; i_581157 < arg_580163; i_581157++) {
                bool y_581159 = slt64(i_581157, dim_274571);
                bool index_certs_581160;
                
                if (!y_581159) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581157, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_581162 = add64((int64_t) 1, i_581157);
                int64_t j_m_i_581163 = sub64(dim_274571, map_arg1_581162);
                bool empty_slice_581164 = j_m_i_581163 == (int64_t) 0;
                int64_t m_581165 = sub64(j_m_i_581163, (int64_t) 1);
                int64_t i_p_m_t_s_581166 = add64(map_arg1_581162, m_581165);
                bool zzero_leq_i_p_m_t_s_581167 = sle64((int64_t) 0, i_p_m_t_s_581166);
                bool i_p_m_t_s_leq_w_581168 = slt64(i_p_m_t_s_581166, dim_274571);
                bool zzero_lte_i_581169 = sle64((int64_t) 0, map_arg1_581162);
                bool i_lte_j_581170 = sle64(map_arg1_581162, dim_274571);
                bool y_581171 = i_p_m_t_s_leq_w_581168 && zzero_lte_i_581169;
                bool y_581172 = zzero_leq_i_p_m_t_s_581167 && y_581171;
                bool forwards_ok_581173 = i_lte_j_581170 && y_581172;
                bool ok_or_empty_581174 = empty_slice_581164 || forwards_ok_581173;
                bool index_certs_581175;
                
                if (!ok_or_empty_581174) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_581162, ":", (long long) dim_274571, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586565 = (int64_t) 8 * j_m_i_581163;
                double this_x_581161 = ((double *) mem_586547)[i_581157];
                
                if (mem_586566_cached_sizze_588673 < bytes_586565) {
                    err = lexical_realloc(ctx, &mem_586566, &mem_586566_cached_sizze_588673, bytes_586565);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586193 = 0; i_586193 < j_m_i_581163; i_586193++) {
                    int64_t slice_586398 = map_arg1_581162 + i_586193;
                    double eta_p_581178 = ((double *) mem_586547)[slice_586398];
                    double defunc_0_ftimes_res_581179 = eta_p_581178 * eta_p_581178;
                    
                    ((double *) mem_586566)[i_586193] = defunc_0_ftimes_res_581179;
                }
                
                double defunc_0_foldl_res_581180;
                double acc_581182 = 0.0;
                
                for (int64_t i_581181 = 0; i_581181 < j_m_i_581163; i_581181++) {
                    double b_581183 = ((double *) mem_586566)[i_581181];
                    double defunc_0_f_res_581184 = acc_581182 + b_581183;
                    double acc_tmp_588117 = defunc_0_f_res_581184;
                    
                    acc_581182 = acc_tmp_588117;
                }
                defunc_0_foldl_res_581180 = acc_581182;
                
                double sqrt_res_581185 = futrts_sqrt64(defunc_0_foldl_res_581180);
                double atan2_res_581186 = futrts_atan2_64(sqrt_res_581185, this_x_581161);
                
                ((double *) mem_586561)[i_581157] = atan2_res_581186;
            }
            for (int64_t i_586197 = 0; i_586197 < arg_580163; i_586197++) {
                double eta_p_581204 = ((double *) mem_586561)[i_586197];
                double eta_p_581205 = ((double *) mem_586519)[i_586197];
                int64_t eta_p_581206 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586197];
                int64_t eta_p_581207 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586197];
                double i64_res_581208 = sitofp_i64_f64(eta_p_581206);
                double defunc_0_fover_res_581209 = eta_p_581204 / eta_p_581205;
                double defunc_0_ftimes_res_581210 = i64_res_581208 * defunc_0_fover_res_581209;
                int64_t f64_res_581211 = fptosi_f64_i64(defunc_0_ftimes_res_581210);
                bool cond_581212 = slt64(f64_res_581211, (int64_t) 0);
                int64_t defunc_0_f_res_581213;
                
                if (cond_581212) {
                    defunc_0_f_res_581213 = (int64_t) 0;
                } else {
                    bool cond_581214 = sle64(eta_p_581207, f64_res_581211);
                    int64_t defunc_0_f_res_f_res_581215;
                    
                    if (cond_581214) {
                        int64_t defunc_0_f_res_f_res_t_res_585772 = sub64(eta_p_581207, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_581215 = defunc_0_f_res_f_res_t_res_585772;
                    } else {
                        defunc_0_f_res_f_res_581215 = f64_res_581211;
                    }
                    defunc_0_f_res_581213 = defunc_0_f_res_f_res_581215;
                }
                ((int64_t *) mem_586577)[i_586197] = defunc_0_f_res_581213;
            }
            
            int64_t defunc_0_foldl_res_581217;
            int64_t acc_581219 = (int64_t) 0;
            
            for (int64_t i_581218 = 0; i_581218 < arg_580163; i_581218++) {
                int64_t b_581220 = ((int64_t *) mem_586577)[i_581218];
                int64_t defunc_0_f_res_581221 = add64(acc_581219, b_581220);
                int64_t acc_tmp_588119 = defunc_0_f_res_581221;
                
                acc_581219 = acc_tmp_588119;
            }
            defunc_0_foldl_res_581217 = acc_581219;
            
            int64_t zp_lhs_581222 = mul64(total_angle_no_274591, defunc_0_foldl_res_581131);
            int64_t get_id_from_grid_angle_res_581223 = add64(defunc_0_foldl_res_581217, zp_lhs_581222);
            
            ((int64_t *) mem_586527)[i_586203] = get_id_from_grid_angle_res_581223;
            ((double *) mem_586529)[i_586203] = sqrt_res_581154;
        }
        
        int64_t reduce_arg1_581251;
        
        if (x_581231) {
            int64_t x_585778 = ((int64_t *) mem_586527)[(int64_t) 0];
            
            reduce_arg1_581251 = x_585778;
        } else {
            reduce_arg1_581251 = (int64_t) 0;
        }
        
        double reduce_arg1_581253;
        
        if (x_581231) {
            double x_585779 = ((double *) mem_586529)[(int64_t) 0];
            
            reduce_arg1_581253 = x_585779;
        } else {
            reduce_arg1_581253 = 0.0;
        }
        if (cond_581230) {
            if (memblock_set(ctx, &ext_mem_587056, &mem_586499, "mem_586499") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587052, &mem_586501, "mem_586501") != 0)
                return 1;
        } else {
            int64_t ext_586599;
            int64_t defunc_0_reduce_res_586004;
            double defunc_0_reduce_res_586005;
            int64_t defunc_0_reduce_res_586007;
            int64_t redout_586206;
            double redout_586207;
            int64_t redout_586209;
            int64_t ctx_param_ext_586590;
            
            if (memblock_set(ctx, &mem_param_586592, &mem_586499, "mem_586499") != 0)
                return 1;
            ctx_param_ext_586590 = (int64_t) 0;
            redout_586206 = reduce_arg1_581251;
            redout_586207 = reduce_arg1_581253;
            redout_586209 = reduce_arg1_581255;
            for (int64_t i_586210 = 0; i_586210 < m_580360; i_586210++) {
                int64_t x_581269 = ((int64_t *) mem_586527)[i_586210];
                double x_581270 = ((double *) mem_586529)[i_586210];
                int64_t x_581272 = ((int64_t *) mem_586501.mem)[i_586210];
                bool cond_581281 = slt64(redout_586206, x_581269);
                bool cond_581282 = redout_586206 == x_581269;
                bool zlze_res_581283 = redout_586207 <= x_581270;
                bool x_581284 = cond_581282 && zlze_res_581283;
                bool x_581285 = !cond_581281;
                bool y_581286 = x_581284 && x_581285;
                bool defunc_0_leq_res_581287 = cond_581281 || y_581286;
                int64_t defunc_0_op_res_581288;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581288 = x_581269;
                } else {
                    defunc_0_op_res_581288 = redout_586206;
                }
                
                double defunc_0_op_res_581289;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581289 = x_581270;
                } else {
                    defunc_0_op_res_581289 = redout_586207;
                }
                
                int64_t defunc_0_op_res_581290;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581290 = x_581272;
                } else {
                    defunc_0_op_res_581290 = redout_586209;
                }
                
                int64_t binop_y_586593 = dim_274571 * i_586210;
                int64_t ext_586596;
                
                if (defunc_0_leq_res_581287) {
                    ext_586596 = binop_y_586593;
                } else {
                    ext_586596 = ctx_param_ext_586590;
                }
                if (defunc_0_leq_res_581287) {
                    if (memblock_set(ctx, &ext_mem_586597, &mem_586499, "mem_586499") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586597, &mem_param_586592, "mem_param_586592") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588120, &ext_mem_586597, "ext_mem_586597") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588121 = ext_586596;
                int64_t redout_tmp_588122 = defunc_0_op_res_581288;
                double redout_tmp_588123 = defunc_0_op_res_581289;
                int64_t redout_tmp_588125 = defunc_0_op_res_581290;
                
                if (memblock_set(ctx, &mem_param_586592, &mem_param_tmp_588120, "mem_param_tmp_588120") != 0)
                    return 1;
                ctx_param_ext_586590 = ctx_param_ext_tmp_588121;
                redout_586206 = redout_tmp_588122;
                redout_586207 = redout_tmp_588123;
                redout_586209 = redout_tmp_588125;
            }
            if (memblock_set(ctx, &ext_mem_586600, &mem_param_586592, "mem_param_586592") != 0)
                return 1;
            ext_586599 = ctx_param_ext_586590;
            defunc_0_reduce_res_586004 = redout_586206;
            defunc_0_reduce_res_586005 = redout_586207;
            defunc_0_reduce_res_586007 = redout_586209;
            if (mem_586603_cached_sizze_588675 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588675, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586606_cached_sizze_588676 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586606, &mem_586606_cached_sizze_588676, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586610_cached_sizze_588677 < bytes_586609) {
                err = lexical_realloc(ctx, &mem_586610, &mem_586610_cached_sizze_588677, bytes_586609);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586613_cached_sizze_588678 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586613, &mem_586613_cached_sizze_588678, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586633_cached_sizze_588679 < bytes_586632) {
                err = lexical_realloc(ctx, &mem_586633, &mem_586633_cached_sizze_588679, bytes_586632);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586635_cached_sizze_588680 < bytes_586632) {
                err = lexical_realloc(ctx, &mem_586635, &mem_586635_cached_sizze_588680, bytes_586632);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586638_cached_sizze_588681 < bytes_586637) {
                err = lexical_realloc(ctx, &mem_586638, &mem_586638_cached_sizze_588681, bytes_586637);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586640_cached_sizze_588682 < bytes_586632) {
                err = lexical_realloc(ctx, &mem_586640, &mem_586640_cached_sizze_588682, bytes_586632);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586232 = 0; i_586232 < x_582331; i_586232++) {
                int64_t zp_lhs_581312 = mul64(block_sizze_581247, i_586232);
                
                for (int64_t i_586219 = 0; i_586219 < block_sizze_581247; i_586219++) {
                    int64_t k_581318 = add64(zp_lhs_581312, i_586219);
                    bool cond_581319 = slt64(k_581318, m_580360);
                    int64_t binop_y_586654 = dim_274571 * k_581318;
                    int64_t ext_586657;
                    
                    if (cond_581319) {
                        ext_586657 = binop_y_586654;
                    } else {
                        ext_586657 = ext_586599;
                    }
                    
                    int64_t lifted_lambda_res_581320;
                    double lifted_lambda_res_581321;
                    int64_t lifted_lambda_res_581323;
                    
                    if (cond_581319) {
                        bool x_585780 = sle64((int64_t) 0, k_581318);
                        bool bounds_check_585781 = cond_581319 && x_585780;
                        bool index_certs_585782;
                        
                        if (!bounds_check_585781) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_581318, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585783 = ((int64_t *) mem_586527)[k_581318];
                        double lifted_lambda_res_t_res_585784 = ((double *) mem_586529)[k_581318];
                        int64_t lifted_lambda_res_t_res_585786 = ((int64_t *) mem_586501.mem)[k_581318];
                        
                        if (memblock_set(ctx, &ext_mem_586658, &mem_586499, "mem_586499") != 0)
                            return 1;
                        lifted_lambda_res_581320 = lifted_lambda_res_t_res_585783;
                        lifted_lambda_res_581321 = lifted_lambda_res_t_res_585784;
                        lifted_lambda_res_581323 = lifted_lambda_res_t_res_585786;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586658, &ext_mem_586600, "ext_mem_586600") != 0)
                            return 1;
                        lifted_lambda_res_581320 = defunc_0_reduce_res_586004;
                        lifted_lambda_res_581321 = defunc_0_reduce_res_586005;
                        lifted_lambda_res_581323 = defunc_0_reduce_res_586007;
                    }
                    ((int64_t *) mem_586633)[i_586219] = lifted_lambda_res_581320;
                    ((double *) mem_586635)[i_586219] = lifted_lambda_res_581321;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586638, i_586219 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586658.mem, ext_586657, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                    if (memblock_unref(ctx, &ext_mem_586658, "ext_mem_586658") != 0)
                        return 1;
                    ((int64_t *) mem_586640)[i_586219] = lifted_lambda_res_581323;
                }
                if (!cond_581300) {
                    if (mem_586699_cached_sizze_588683 < bytes_586437) {
                        err = lexical_realloc(ctx, &mem_586699, &mem_586699_cached_sizze_588683, bytes_586437);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586701_cached_sizze_588684 < bytes_586437) {
                        err = lexical_realloc(ctx, &mem_586701, &mem_586701_cached_sizze_588684, bytes_586437);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_581339 = 0; i_581339 < distance_581303; i_581339++) {
                        int64_t gt_arg1_581344 = add64((int64_t) 1, i_581339);
                        bool x_581345 = sle64((int64_t) 0, gt_arg1_581344);
                        bool y_581346 = slt64(gt_arg1_581344, block_sizze_581247);
                        bool bounds_check_581347 = x_581345 && y_581346;
                        bool index_certs_581348;
                        
                        if (!bounds_check_581347) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_581344, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_581351 = slt64(i_581339, block_sizze_581247);
                        bool index_certs_581352;
                        
                        if (!y_581351) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581339, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_581349 = ((int64_t *) mem_586633)[gt_arg1_581344];
                        double gt_arg1_581350 = ((double *) mem_586635)[gt_arg1_581344];
                        int64_t gt_arg0_581353 = ((int64_t *) mem_586633)[i_581339];
                        double gt_arg0_581354 = ((double *) mem_586635)[i_581339];
                        bool cond_581355 = slt64(gt_arg0_581353, gt_arg1_581349);
                        bool cond_581356 = gt_arg0_581353 == gt_arg1_581349;
                        bool zlze_res_581357 = gt_arg0_581354 <= gt_arg1_581350;
                        bool x_581358 = cond_581356 && zlze_res_581357;
                        bool x_581359 = !cond_581355;
                        bool y_581360 = x_581358 && x_581359;
                        bool defunc_0_leq_res_581361 = cond_581355 || y_581360;
                        bool defunc_0_lifted_gt_res_581362 = !defunc_0_leq_res_581361;
                        bool s_581363;
                        int64_t s_581368;
                        bool loop_while_581369;
                        int64_t j_581374;
                        
                        loop_while_581369 = defunc_0_lifted_gt_res_581362;
                        j_581374 = i_581339;
                        while (loop_while_581369) {
                            bool x_581375 = sle64((int64_t) 0, j_581374);
                            bool y_581376 = slt64(j_581374, block_sizze_581247);
                            bool bounds_check_581377 = x_581375 && y_581376;
                            bool index_certs_581378;
                            
                            if (!bounds_check_581377) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581374, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581384 = add64((int64_t) 1, j_581374);
                            bool x_581385 = sle64((int64_t) 0, copy_arg0_581384);
                            bool y_581386 = slt64(copy_arg0_581384, block_sizze_581247);
                            bool bounds_check_581387 = x_581385 && y_581386;
                            bool index_certs_581388;
                            
                            if (!bounds_check_581387) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_581384, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581379 = ((int64_t *) mem_586633)[j_581374];
                            double copy_arg0_581380 = ((double *) mem_586635)[j_581374];
                            int64_t copy_arg0_581382 = ((int64_t *) mem_586640)[j_581374];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586699, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586638, (int64_t) 0 + j_581374 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            
                            int64_t copy_arg0_581389 = ((int64_t *) mem_586633)[copy_arg0_581384];
                            double copy_arg0_581390 = ((double *) mem_586635)[copy_arg0_581384];
                            int64_t copy_arg0_581392 = ((int64_t *) mem_586640)[copy_arg0_581384];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586701, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586638, (int64_t) 0 + copy_arg0_581384 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_586633)[j_581374] = copy_arg0_581389;
                            ((double *) mem_586635)[j_581374] = copy_arg0_581390;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586638, j_581374 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586701, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_586640)[j_581374] = copy_arg0_581392;
                            ((int64_t *) mem_586633)[copy_arg0_581384] = copy_arg0_581379;
                            ((double *) mem_586635)[copy_arg0_581384] = copy_arg0_581380;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586638, copy_arg0_581384 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586699, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_586640)[copy_arg0_581384] = copy_arg0_581382;
                            
                            int64_t tmp_581402 = sub64(j_581374, (int64_t) 1);
                            bool cond_581403 = sle64((int64_t) 0, tmp_581402);
                            bool loop_cond_581404;
                            
                            if (cond_581403) {
                                bool y_585789 = slt64(tmp_581402, block_sizze_581247);
                                bool bounds_check_585790 = cond_581403 && y_585789;
                                bool index_certs_585791;
                                
                                if (!bounds_check_585790) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581402, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585787 = ((int64_t *) mem_586633)[j_581374];
                                double gt_arg1_585788 = ((double *) mem_586635)[j_581374];
                                int64_t gt_arg0_585792 = ((int64_t *) mem_586633)[tmp_581402];
                                double gt_arg0_585793 = ((double *) mem_586635)[tmp_581402];
                                bool cond_585794 = slt64(gt_arg0_585792, gt_arg1_585787);
                                bool cond_585795 = gt_arg0_585792 == gt_arg1_585787;
                                bool zlze_res_585796 = gt_arg0_585793 <= gt_arg1_585788;
                                bool x_585797 = cond_585795 && zlze_res_585796;
                                bool x_585798 = !cond_585794;
                                bool y_585799 = x_585797 && x_585798;
                                bool defunc_0_leq_res_585800 = cond_585794 || y_585799;
                                bool defunc_0_lifted_gt_res_585801 = !defunc_0_leq_res_585800;
                                
                                loop_cond_581404 = defunc_0_lifted_gt_res_585801;
                            } else {
                                loop_cond_581404 = 0;
                            }
                            
                            bool loop_while_tmp_588138 = loop_cond_581404;
                            int64_t j_tmp_588143 = tmp_581402;
                            
                            loop_while_581369 = loop_while_tmp_588138;
                            j_581374 = j_tmp_588143;
                        }
                        s_581363 = loop_while_581369;
                        s_581368 = j_581374;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586603, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586633, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586606, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586635, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586610, i_586232 * lmad_arg_586631, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) mem_586638, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {block_sizze_581247, dim_274571});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586613, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586640, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
            }
            if (memblock_unref(ctx, &ext_mem_586600, "ext_mem_586600") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586760, bytes_586602, "mem_586760")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586760.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint64_t *) mem_586603, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            if (memblock_alloc(ctx, &mem_586764, bytes_586602, "mem_586764")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586764.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint64_t *) mem_586606, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            if (memblock_alloc(ctx, &mem_586769, bytes_586609, "mem_586769")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_586769.mem, (int64_t) 0, (int64_t []) {dim_274571 * block_sizze_581247, dim_274571, (int64_t) 1}, (uint64_t *) mem_586610, (int64_t) 0, (int64_t []) {lmad_arg_586631, dim_274571, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247, dim_274571});
            if (memblock_alloc(ctx, &mem_586773, bytes_586602, "mem_586773")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586773.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint64_t *) mem_586613, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            
            int64_t data_581429;
            bool data_581430;
            int64_t data_581435;
            int64_t loop_dz2084Uz2082U_581436;
            bool loop_while_581437;
            int64_t stride_581442;
            
            if (memblock_set(ctx, &mem_param_586777, &mem_586760, "mem_586760") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586780, &mem_586764, "mem_586764") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586784, &mem_586769, "mem_586769") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586787, &mem_586773, "mem_586773") != 0)
                return 1;
            loop_dz2084Uz2082U_581436 = flat_dim_581257;
            loop_while_581437 = loop_cond_581426;
            stride_581442 = block_sizze_581247;
            while (loop_while_581437) {
                int64_t next_stride_581443 = mul64((int64_t) 2, stride_581442);
                bool zzero_581444 = next_stride_581443 == (int64_t) 0;
                bool nonzzero_581445 = !zzero_581444;
                bool nonzzero_cert_581446;
                
                if (!nonzzero_581445) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_581447 = sdiv64(flat_dim_581257, next_stride_581443);
                bool bounds_invalid_upwards_581448 = slt64(num_merges_581447, (int64_t) 0);
                bool valid_581449 = !bounds_invalid_upwards_581448;
                bool range_valid_c_581450;
                
                if (!valid_581449) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_581447, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:805:33-56\n   #7  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_581452 = sub64(next_stride_581443, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_581453 = sle64((int64_t) 0, m_581452);
                bool cond_581455 = slt64(next_stride_581443, (int64_t) 10);
                bool protect_assert_disj_581456 = nonzzero_581428 || cond_581455;
                bool nonzzero_cert_581457;
                
                if (!protect_assert_disj_581456) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_581458 = smod_safe64(next_stride_581443, merge_block_sizze_581263);
                bool num_blocks_581459 = zeze_lhs_581458 == (int64_t) 0;
                bool protect_assert_disj_581460 = cond_581455 || num_blocks_581459;
                bool assert_c_581461;
                
                if (!protect_assert_disj_581460) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_581464 = sdiv_safe64(next_stride_581443, merge_block_sizze_581263);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465 = add64((int64_t) 1, num_blocks_581464);
                int64_t j_m_i_581466 = sub64(next_stride_581443, stride_581442);
                int64_t flat_dim_581467 = merge_block_sizze_581263 * num_blocks_581464;
                bool bounds_invalid_upwards_581468 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, (int64_t) 0);
                bool zzero_lte_i_581469 = sle64((int64_t) 0, stride_581442);
                bool i_lte_j_581470 = sle64(stride_581442, next_stride_581443);
                bool empty_slice_581471 = stride_581442 == (int64_t) 0;
                int64_t m_581472 = sub64(stride_581442, (int64_t) 1);
                bool bounds_invalid_upwards_581473 = slt64(num_blocks_581464, (int64_t) 0);
                bool empty_slice_581474 = j_m_i_581466 == (int64_t) 0;
                int64_t m_581475 = sub64(j_m_i_581466, (int64_t) 1);
                bool cond_581476 = slt64((int64_t) 0, stride_581442);
                bool valid_581477 = !bounds_invalid_upwards_581468;
                bool zzero_leq_i_p_m_t_s_581478 = sle64((int64_t) 0, m_581472);
                bool i_p_m_t_s_leq_w_581479 = slt64(m_581472, next_stride_581443);
                bool valid_581480 = !bounds_invalid_upwards_581473;
                bool i_p_m_t_s_leq_w_581481 = slt64(m_581452, flat_dim_581467);
                int64_t i_p_m_t_s_581482 = add64(stride_581442, m_581475);
                bool y_581483 = slt64((int64_t) 0, j_m_i_581466);
                bool protect_assert_disj_581484 = cond_581455 || valid_581477;
                bool range_valid_c_581485;
                
                if (!protect_assert_disj_581484) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581486 = zzero_leq_i_p_m_t_s_581478 && i_p_m_t_s_leq_w_581479;
                bool protect_assert_disj_581487 = cond_581455 || valid_581480;
                bool range_valid_c_581488;
                
                if (!protect_assert_disj_581487) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_581464, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581489 = zzero_leq_i_p_m_t_s_581453 && i_p_m_t_s_leq_w_581481;
                bool zzero_leq_i_p_m_t_s_581490 = sle64((int64_t) 0, i_p_m_t_s_581482);
                bool i_p_m_t_s_leq_w_581491 = slt64(i_p_m_t_s_581482, next_stride_581443);
                bool forwards_ok_581492 = zzero_lte_i_581469 && y_581486;
                bool ok_or_empty_581493 = zzero_581444 || y_581489;
                bool y_581494 = zzero_lte_i_581469 && i_p_m_t_s_leq_w_581491;
                bool protect_assert_disj_581495 = cond_581476 || y_581483;
                bool ok_or_empty_581496 = empty_slice_581471 || forwards_ok_581492;
                bool protect_assert_disj_581497 = cond_581455 || ok_or_empty_581493;
                bool index_certs_581498;
                
                if (!protect_assert_disj_581497) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581443, "] out of bounds for array of shape [", (long long) flat_dim_581467, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581499 = zzero_leq_i_p_m_t_s_581490 && y_581494;
                bool loop_not_taken_581500 = !cond_581455;
                bool protect_assert_disj_581501 = protect_assert_disj_581495 || loop_not_taken_581500;
                bool index_certs_581502;
                
                if (!protect_assert_disj_581501) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581503 = cond_581455 || ok_or_empty_581496;
                bool index_certs_581504;
                
                if (!protect_assert_disj_581503) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581442, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_581505 = i_lte_j_581470 && y_581499;
                bool protect_assert_disj_581506 = ok_or_empty_581496 || loop_not_taken_581500;
                bool index_certs_581507;
                
                if (!protect_assert_disj_581506) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581442, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_581508 = empty_slice_581474 || forwards_ok_581505;
                bool protect_assert_disj_581509 = loop_not_taken_581500 || ok_or_empty_581508;
                bool index_certs_581510;
                
                if (!protect_assert_disj_581509) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581442, ":] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581511 = cond_581455 || ok_or_empty_581508;
                bool index_certs_581512;
                
                if (!protect_assert_disj_581511) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581442, ":] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586788 = (int64_t) 8 * num_merges_581447;
                int64_t bytes_586789 = next_stride_581443 * binop_x_586788;
                int64_t bytes_586796 = dim_274571 * bytes_586789;
                bool i_lte_j_581454 = sle64((int64_t) 0, next_stride_581443);
                
                if (mem_586790_cached_sizze_588685 < bytes_586789) {
                    err = lexical_realloc(ctx, &mem_586790, &mem_586790_cached_sizze_588685, bytes_586789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586793_cached_sizze_588686 < bytes_586789) {
                    err = lexical_realloc(ctx, &mem_586793, &mem_586793_cached_sizze_588686, bytes_586789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586797_cached_sizze_588687 < bytes_586796) {
                    err = lexical_realloc(ctx, &mem_586797, &mem_586797_cached_sizze_588687, bytes_586796);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586800_cached_sizze_588688 < bytes_586789) {
                    err = lexical_realloc(ctx, &mem_586800, &mem_586800_cached_sizze_588688, bytes_586789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586818 = dim_274571 * next_stride_581443;
                int64_t bytes_586819 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465;
                int64_t binop_x_586835 = (int64_t) 8 * num_blocks_581464;
                int64_t bytes_586836 = merge_block_sizze_581263 * binop_x_586835;
                int64_t bytes_586843 = dim_274571 * bytes_586836;
                int64_t bytes_586950 = (int64_t) 16 * stride_581442;
                int64_t bytes_586957 = dim_274571 * bytes_586950;
                
                for (int64_t i_586265 = 0; i_586265 < num_merges_581447; i_586265++) {
                    int64_t start_581518 = mul64(next_stride_581443, i_586265);
                    int64_t j_m_i_581519 = sub64(loop_dz2084Uz2082U_581436, start_581518);
                    bool empty_slice_581520 = j_m_i_581519 == (int64_t) 0;
                    int64_t m_581521 = sub64(j_m_i_581519, (int64_t) 1);
                    int64_t i_p_m_t_s_581522 = add64(start_581518, m_581521);
                    bool zzero_leq_i_p_m_t_s_581523 = sle64((int64_t) 0, i_p_m_t_s_581522);
                    bool i_p_m_t_s_leq_w_581524 = slt64(i_p_m_t_s_581522, loop_dz2084Uz2082U_581436);
                    bool zzero_lte_i_581525 = sle64((int64_t) 0, start_581518);
                    bool i_lte_j_581526 = sle64(start_581518, loop_dz2084Uz2082U_581436);
                    bool y_581527 = i_p_m_t_s_leq_w_581524 && zzero_lte_i_581525;
                    bool y_581528 = zzero_leq_i_p_m_t_s_581523 && y_581527;
                    bool forwards_ok_581529 = i_lte_j_581526 && y_581528;
                    bool ok_or_empty_581530 = empty_slice_581520 || forwards_ok_581529;
                    bool index_certs_581531;
                    
                    if (!ok_or_empty_581530) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_581518, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_581436, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_581532 = slt64(m_581452, j_m_i_581519);
                    bool y_581533 = zzero_leq_i_p_m_t_s_581453 && i_p_m_t_s_leq_w_581532;
                    bool forwards_ok_581534 = i_lte_j_581454 && y_581533;
                    bool ok_or_empty_581535 = zzero_581444 || forwards_ok_581534;
                    bool index_certs_581536;
                    
                    if (!ok_or_empty_581535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581443, "] out of bounds for array of shape [", (long long) j_m_i_581519, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:805:33-56\n   #9  ftSkyline.fut:792:17-805:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585849 = stride_581442 + start_581518;
                    int64_t binop_y_586945 = dim_274571 * slice_585849;
                    int64_t binop_y_586947 = dim_274571 * start_581518;
                    int64_t ext_586949;
                    
                    if (cond_581476) {
                        ext_586949 = binop_y_586947;
                    } else {
                        ext_586949 = binop_y_586945;
                    }
                    if (cond_581455) {
                        int64_t dummy_585841;
                        double dummy_585842;
                        int64_t dummy_585844;
                        
                        if (cond_581476) {
                            int64_t head_res_585845 = ((int64_t *) mem_param_586777.mem)[start_581518];
                            double head_res_585846 = ((double *) mem_param_586780.mem)[start_581518];
                            int64_t head_res_585848 = ((int64_t *) mem_param_586787.mem)[start_581518];
                            
                            dummy_585841 = head_res_585845;
                            dummy_585842 = head_res_585846;
                            dummy_585844 = head_res_585848;
                        } else {
                            int64_t head_res_585850 = ((int64_t *) mem_param_586777.mem)[slice_585849];
                            double head_res_585851 = ((double *) mem_param_586780.mem)[slice_585849];
                            int64_t head_res_585853 = ((int64_t *) mem_param_586787.mem)[slice_585849];
                            
                            dummy_585841 = head_res_585850;
                            dummy_585842 = head_res_585851;
                            dummy_585844 = head_res_585853;
                        }
                        if (memblock_alloc(ctx, &mem_586951, bytes_586950, "mem_586951")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588159 = 0; nest_i_588159 < next_stride_581443; nest_i_588159++) {
                            ((int64_t *) mem_586951.mem)[nest_i_588159] = dummy_585841;
                        }
                        if (memblock_alloc(ctx, &mem_586953, bytes_586950, "mem_586953")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588160 = 0; nest_i_588160 < next_stride_581443; nest_i_588160++) {
                            ((double *) mem_586953.mem)[nest_i_588160] = dummy_585842;
                        }
                        if (memblock_alloc(ctx, &mem_586955, bytes_586950, "mem_586955")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588161 = 0; nest_i_588161 < next_stride_581443; nest_i_588161++) {
                            ((int64_t *) mem_586955.mem)[nest_i_588161] = dummy_585844;
                        }
                        if (memblock_alloc(ctx, &mem_586958, bytes_586957, "mem_586958")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588162 = 0; nest_i_588162 < next_stride_581443; nest_i_588162++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586958.mem, nest_i_588162 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586784.mem, ext_586949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                        }
                        
                        int64_t data_585858;
                        int64_t i_585864 = (int64_t) 0;
                        
                        for (int64_t k_585863 = 0; k_585863 < next_stride_581443; k_585863++) {
                            int64_t j_585869 = sub64(k_585863, i_585864);
                            bool cond_585870 = j_585869 == j_m_i_581466;
                            bool x_587830 = !cond_585870;
                            bool cond_585872 = slt64(i_585864, stride_581442);
                            bool x_585874 = sle64((int64_t) 0, j_585869);
                            bool y_585875 = slt64(j_585869, j_m_i_581466);
                            bool bounds_check_585876 = x_585874 && y_585875;
                            bool loop_not_taken_587818 = !cond_585872;
                            bool protect_assert_disj_587819 = bounds_check_585876 || loop_not_taken_587818;
                            bool protect_assert_disj_587833 = cond_585870 || protect_assert_disj_587819;
                            bool index_certs_585877;
                            
                            if (!protect_assert_disj_587833) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585869, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585878 = stride_581442 + j_585869;
                            int64_t slice_585879 = start_581518 + slice_585878;
                            bool protect_cond_conj_587834 = cond_585872 && x_587830;
                            int64_t leq_arg1_585880;
                            
                            if (protect_cond_conj_587834) {
                                int64_t x_587820 = ((int64_t *) mem_param_586777.mem)[slice_585879];
                                
                                leq_arg1_585880 = x_587820;
                            } else {
                                leq_arg1_585880 = (int64_t) 0;
                            }
                            
                            double leq_arg1_585881;
                            
                            if (protect_cond_conj_587834) {
                                double x_587822 = ((double *) mem_param_586780.mem)[slice_585879];
                                
                                leq_arg1_585881 = x_587822;
                            } else {
                                leq_arg1_585881 = 0.0;
                            }
                            
                            bool x_585882 = sle64((int64_t) 0, i_585864);
                            bool bounds_check_585883 = cond_585872 && x_585882;
                            bool protect_assert_disj_587825 = bounds_check_585883 || loop_not_taken_587818;
                            bool protect_assert_disj_587837 = cond_585870 || protect_assert_disj_587825;
                            bool index_certs_585884;
                            
                            if (!protect_assert_disj_587837) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585864, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585885 = start_581518 + i_585864;
                            int64_t leq_arg0_585886;
                            
                            if (protect_cond_conj_587834) {
                                int64_t x_587826 = ((int64_t *) mem_param_586777.mem)[slice_585885];
                                
                                leq_arg0_585886 = x_587826;
                            } else {
                                leq_arg0_585886 = (int64_t) 0;
                            }
                            
                            double leq_arg0_585887;
                            
                            if (protect_cond_conj_587834) {
                                double x_587828 = ((double *) mem_param_586780.mem)[slice_585885];
                                
                                leq_arg0_585887 = x_587828;
                            } else {
                                leq_arg0_585887 = 0.0;
                            }
                            
                            bool cond_585888 = slt64(leq_arg0_585886, leq_arg1_585880);
                            bool cond_585889 = leq_arg0_585886 == leq_arg1_585880;
                            bool zlze_res_585890 = leq_arg0_585887 <= leq_arg1_585881;
                            bool x_585891 = cond_585889 && zlze_res_585890;
                            bool x_585892 = !cond_585888;
                            bool y_585893 = x_585891 && x_585892;
                            bool defunc_0_leq_res_585894 = cond_585888 || y_585893;
                            bool x_587873 = cond_585872 && defunc_0_leq_res_585894;
                            bool cond_585871 = cond_585870 || x_587873;
                            bool protect_assert_disj_587734 = cond_585871 || bounds_check_585876;
                            bool index_certs_585913;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585869, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585903 = cond_585872 && x_585882;
                            bool loop_not_taken_587729 = !cond_585871;
                            bool protect_assert_disj_587730 = bounds_check_585903 || loop_not_taken_587729;
                            bool index_certs_585904;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585864, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:805:33-56\n   #10 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585915 = start_581518 + slice_585878;
                            int64_t binop_y_586972 = dim_274571 * slice_585915;
                            int64_t binop_y_586974 = dim_274571 * slice_585885;
                            int64_t ext_586976;
                            
                            if (cond_585871) {
                                ext_586976 = binop_y_586974;
                            } else {
                                ext_586976 = binop_y_586972;
                            }
                            
                            int64_t loopres_585895;
                            int64_t loopres_585896;
                            double loopres_585897;
                            int64_t loopres_585899;
                            
                            if (cond_585871) {
                                int64_t tmp_585900 = add64((int64_t) 1, i_585864);
                                int64_t tmp_585906 = ((int64_t *) mem_param_586777.mem)[slice_585885];
                                double tmp_585907 = ((double *) mem_param_586780.mem)[slice_585885];
                                int64_t tmp_585909 = ((int64_t *) mem_param_586787.mem)[slice_585885];
                                
                                loopres_585895 = tmp_585900;
                                loopres_585896 = tmp_585906;
                                loopres_585897 = tmp_585907;
                                loopres_585899 = tmp_585909;
                            } else {
                                int64_t tmp_585916 = ((int64_t *) mem_param_586777.mem)[slice_585915];
                                double tmp_585917 = ((double *) mem_param_586780.mem)[slice_585915];
                                int64_t tmp_585919 = ((int64_t *) mem_param_586787.mem)[slice_585915];
                                
                                loopres_585895 = i_585864;
                                loopres_585896 = tmp_585916;
                                loopres_585897 = tmp_585917;
                                loopres_585899 = tmp_585919;
                            }
                            ((int64_t *) mem_586951.mem)[k_585863] = loopres_585896;
                            ((double *) mem_586953.mem)[k_585863] = loopres_585897;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586958.mem, k_585863 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586784.mem, ext_586976, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            ((int64_t *) mem_586955.mem)[k_585863] = loopres_585899;
                            
                            int64_t i_tmp_588163 = loopres_585895;
                            
                            i_585864 = i_tmp_588163;
                        }
                        data_585858 = i_585864;
                        if (memblock_set(ctx, &ext_mem_587002, &mem_586951, "mem_586951") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586999, &mem_586953, "mem_586953") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586996, &mem_586958, "mem_586958") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586992, &mem_586955, "mem_586955") != 0)
                            return 1;
                    } else {
                        if (mem_586820_cached_sizze_588689 < bytes_586819) {
                            err = lexical_realloc(ctx, &mem_586820, &mem_586820_cached_sizze_588689, bytes_586819);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586822_cached_sizze_588690 < bytes_586819) {
                            err = lexical_realloc(ctx, &mem_586822, &mem_586822_cached_sizze_588690, bytes_586819);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586241 = 0; i_586241 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465; i_586241++) {
                            int64_t split_count_arg3_581628 = mul64(merge_block_sizze_581263, i_586241);
                            int64_t defunc_0_split_count_res_581629;
                            int64_t defunc_0_split_count_res_581630;
                            int64_t defunc_0_split_count_res_581631;
                            int64_t defunc_0_split_count_res_581632;
                            int64_t defunc_0_split_count_res_581633;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_581629, &defunc_0_split_count_res_581630, &defunc_0_split_count_res_581631, &defunc_0_split_count_res_581632, &defunc_0_split_count_res_581633, (int64_t) 0, stride_581442, (int64_t) 0, j_m_i_581466, split_count_arg3_581628) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_581634 = slt64((int64_t) 0, defunc_0_split_count_res_581633);
                            bool defunc_0_split_count_res_581635;
                            int64_t defunc_0_split_count_res_581636;
                            int64_t defunc_0_split_count_res_581637;
                            int64_t defunc_0_split_count_res_581638;
                            int64_t defunc_0_split_count_res_581639;
                            int64_t defunc_0_split_count_res_581640;
                            bool loop_while_581641;
                            int64_t ss_581642;
                            int64_t ss_581643;
                            int64_t tt_581644;
                            int64_t tt_581645;
                            int64_t count_581646;
                            
                            loop_while_581641 = loop_cond_581634;
                            ss_581642 = defunc_0_split_count_res_581629;
                            ss_581643 = defunc_0_split_count_res_581630;
                            tt_581644 = defunc_0_split_count_res_581631;
                            tt_581645 = defunc_0_split_count_res_581632;
                            count_581646 = defunc_0_split_count_res_581633;
                            while (loop_while_581641) {
                                int64_t zlze_lhs_581647 = sub64(ss_581643, ss_581642);
                                bool cond_581648 = sle64(zlze_lhs_581647, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_581649;
                                int64_t defunc_0_lifted_step_res_581650;
                                int64_t defunc_0_lifted_step_res_581651;
                                int64_t defunc_0_lifted_step_res_581652;
                                
                                if (cond_581648) {
                                    int64_t tmp_585924 = add64(tt_581644, count_581646);
                                    
                                    defunc_0_lifted_step_res_581649 = ss_581642;
                                    defunc_0_lifted_step_res_581650 = tmp_585924;
                                    defunc_0_lifted_step_res_581651 = tt_581645;
                                    defunc_0_lifted_step_res_581652 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_581654 = sub64(tt_581645, tt_581644);
                                    bool cond_581655 = sle64(zlze_lhs_581654, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_581656;
                                    int64_t defunc_0_lifted_step_res_f_res_581657;
                                    int64_t defunc_0_lifted_step_res_f_res_581658;
                                    int64_t defunc_0_lifted_step_res_f_res_581659;
                                    
                                    if (cond_581655) {
                                        int64_t tmp_585925 = add64(ss_581642, count_581646);
                                        
                                        defunc_0_lifted_step_res_f_res_581656 = tmp_585925;
                                        defunc_0_lifted_step_res_f_res_581657 = tt_581644;
                                        defunc_0_lifted_step_res_f_res_581658 = tt_581645;
                                        defunc_0_lifted_step_res_f_res_581659 = (int64_t) 0;
                                    } else {
                                        bool cond_581661 = count_581646 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581662;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581663;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581664;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581665;
                                        
                                        if (cond_581661) {
                                            bool x_585927 = sle64((int64_t) 0, ss_581642);
                                            bool y_585928 = slt64(ss_581642, stride_581442);
                                            bool bounds_check_585929 = x_585927 && y_585928;
                                            bool index_certs_585930;
                                            
                                            if (!bounds_check_585929) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_581642, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:805:33-56\n   #14 ftSkyline.fut:792:17-805:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585934 = sle64((int64_t) 0, tt_581644);
                                            bool y_585935 = slt64(tt_581644, j_m_i_581466);
                                            bool bounds_check_585936 = x_585934 && y_585935;
                                            bool index_certs_585937;
                                            
                                            if (!bounds_check_585936) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_581644, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:805:33-56\n   #14 ftSkyline.fut:792:17-805:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585931 = start_581518 + ss_581642;
                                            int64_t leq_arg1_585932 = ((int64_t *) mem_param_586777.mem)[slice_585931];
                                            double leq_arg1_585933 = ((double *) mem_param_586780.mem)[slice_585931];
                                            int64_t slice_585938 = stride_581442 + tt_581644;
                                            int64_t slice_585939 = start_581518 + slice_585938;
                                            int64_t leq_arg0_585940 = ((int64_t *) mem_param_586777.mem)[slice_585939];
                                            double leq_arg0_585941 = ((double *) mem_param_586780.mem)[slice_585939];
                                            bool cond_585942 = slt64(leq_arg0_585940, leq_arg1_585932);
                                            bool cond_585943 = leq_arg0_585940 == leq_arg1_585932;
                                            bool zlze_res_585944 = leq_arg0_585941 <= leq_arg1_585933;
                                            bool x_585945 = cond_585943 && zlze_res_585944;
                                            bool x_585946 = !cond_585942;
                                            bool y_585947 = x_585945 && x_585946;
                                            bool defunc_0_leq_res_585948 = cond_585942 || y_585947;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585949;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585950;
                                            
                                            if (defunc_0_leq_res_585948) {
                                                int64_t tmp_585951 = add64((int64_t) 1, tt_581644);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585949 = ss_581642;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585950 = tmp_585951;
                                            } else {
                                                int64_t tmp_585952 = add64((int64_t) 1, ss_581642);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585949 = tmp_585952;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585950 = tt_581644;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581662 = defunc_0_lifted_step_res_f_res_f_res_t_res_585949;
                                            defunc_0_lifted_step_res_f_res_f_res_581663 = defunc_0_lifted_step_res_f_res_f_res_t_res_585950;
                                            defunc_0_lifted_step_res_f_res_f_res_581664 = tt_581645;
                                            defunc_0_lifted_step_res_f_res_f_res_581665 = (int64_t) 0;
                                        } else {
                                            int64_t m_581692 = sdiv64(count_581646, (int64_t) 2);
                                            int64_t n_581693 = sub64(count_581646, m_581692);
                                            bool cond_581694 = n_581693 == (int64_t) 0;
                                            int64_t zgze_lhs_581695 = add64(ss_581642, m_581692);
                                            bool cond_f_res_581696 = sle64(ss_581643, zgze_lhs_581695);
                                            bool x_581697 = !cond_581694;
                                            bool y_581698 = cond_f_res_581696 && x_581697;
                                            bool cond_581699 = cond_581694 || y_581698;
                                            bool leq_y_x_581700;
                                            
                                            if (cond_581699) {
                                                leq_y_x_581700 = 1;
                                            } else {
                                                bool x_581701 = sle64((int64_t) 0, zgze_lhs_581695);
                                                bool y_581702 = slt64(zgze_lhs_581695, stride_581442);
                                                bool bounds_check_581703 = x_581701 && y_581702;
                                                bool index_certs_581704;
                                                
                                                if (!bounds_check_581703) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_581695, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:805:33-56\n   #14 ftSkyline.fut:792:17-805:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_581708 = add64(tt_581644, n_581693);
                                                int64_t leq_arg0_581709 = sub64(zm_lhs_581708, (int64_t) 1);
                                                bool x_581710 = sle64((int64_t) 0, leq_arg0_581709);
                                                bool y_581711 = slt64(leq_arg0_581709, j_m_i_581466);
                                                bool bounds_check_581712 = x_581710 && y_581711;
                                                bool index_certs_581713;
                                                
                                                if (!bounds_check_581712) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_581709, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:805:33-56\n   #14 ftSkyline.fut:792:17-805:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_581705 = start_581518 + zgze_lhs_581695;
                                                int64_t leq_arg1_581706 = ((int64_t *) mem_param_586777.mem)[slice_581705];
                                                double leq_arg1_581707 = ((double *) mem_param_586780.mem)[slice_581705];
                                                int64_t slice_581714 = stride_581442 + leq_arg0_581709;
                                                int64_t slice_581715 = start_581518 + slice_581714;
                                                int64_t leq_arg0_581716 = ((int64_t *) mem_param_586777.mem)[slice_581715];
                                                double leq_arg0_581717 = ((double *) mem_param_586780.mem)[slice_581715];
                                                bool cond_581718 = slt64(leq_arg0_581716, leq_arg1_581706);
                                                bool cond_581719 = leq_arg0_581716 == leq_arg1_581706;
                                                bool zlze_res_581720 = leq_arg0_581717 <= leq_arg1_581707;
                                                bool x_581721 = cond_581719 && zlze_res_581720;
                                                bool x_581722 = !cond_581718;
                                                bool y_581723 = x_581721 && x_581722;
                                                bool defunc_0_leq_res_581724 = cond_581718 || y_581723;
                                                
                                                leq_y_x_581700 = defunc_0_leq_res_581724;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581725;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581726;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581727;
                                            
                                            if (leq_y_x_581700) {
                                                int64_t tmp_585953 = add64(tt_581644, n_581693);
                                                int64_t tmp_585954 = sub64(count_581646, n_581693);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581725 = tmp_585953;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581726 = tt_581645;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581727 = tmp_585954;
                                            } else {
                                                int64_t tmp_581730 = add64(tt_581644, n_581693);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581725 = tt_581644;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581726 = tmp_581730;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581727 = count_581646;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581662 = ss_581642;
                                            defunc_0_lifted_step_res_f_res_f_res_581663 = defunc_0_lifted_step_res_f_res_f_res_f_res_581725;
                                            defunc_0_lifted_step_res_f_res_f_res_581664 = defunc_0_lifted_step_res_f_res_f_res_f_res_581726;
                                            defunc_0_lifted_step_res_f_res_f_res_581665 = defunc_0_lifted_step_res_f_res_f_res_f_res_581727;
                                        }
                                        defunc_0_lifted_step_res_f_res_581656 = defunc_0_lifted_step_res_f_res_f_res_581662;
                                        defunc_0_lifted_step_res_f_res_581657 = defunc_0_lifted_step_res_f_res_f_res_581663;
                                        defunc_0_lifted_step_res_f_res_581658 = defunc_0_lifted_step_res_f_res_f_res_581664;
                                        defunc_0_lifted_step_res_f_res_581659 = defunc_0_lifted_step_res_f_res_f_res_581665;
                                    }
                                    defunc_0_lifted_step_res_581649 = defunc_0_lifted_step_res_f_res_581656;
                                    defunc_0_lifted_step_res_581650 = defunc_0_lifted_step_res_f_res_581657;
                                    defunc_0_lifted_step_res_581651 = defunc_0_lifted_step_res_f_res_581658;
                                    defunc_0_lifted_step_res_581652 = defunc_0_lifted_step_res_f_res_581659;
                                }
                                
                                int64_t loopres_581731;
                                int64_t loopres_581732;
                                int64_t loopres_581733;
                                int64_t loopres_581734;
                                int64_t loopres_581735;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_581731, &loopres_581732, &loopres_581733, &loopres_581734, &loopres_581735, defunc_0_lifted_step_res_581649, ss_581643, defunc_0_lifted_step_res_581650, defunc_0_lifted_step_res_581651, defunc_0_lifted_step_res_581652) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_581736 = slt64((int64_t) 0, loopres_581735);
                                bool loop_while_tmp_588170 = loop_cond_581736;
                                int64_t ss_tmp_588171 = loopres_581731;
                                int64_t ss_tmp_588172 = loopres_581732;
                                int64_t tt_tmp_588173 = loopres_581733;
                                int64_t tt_tmp_588174 = loopres_581734;
                                int64_t count_tmp_588175 = loopres_581735;
                                
                                loop_while_581641 = loop_while_tmp_588170;
                                ss_581642 = ss_tmp_588171;
                                ss_581643 = ss_tmp_588172;
                                tt_581644 = tt_tmp_588173;
                                tt_581645 = tt_tmp_588174;
                                count_581646 = count_tmp_588175;
                            }
                            defunc_0_split_count_res_581635 = loop_while_581641;
                            defunc_0_split_count_res_581636 = ss_581642;
                            defunc_0_split_count_res_581637 = ss_581643;
                            defunc_0_split_count_res_581638 = tt_581644;
                            defunc_0_split_count_res_581639 = tt_581645;
                            defunc_0_split_count_res_581640 = count_581646;
                            ((int64_t *) mem_586820)[i_586241] = defunc_0_split_count_res_581636;
                            ((int64_t *) mem_586822)[i_586241] = defunc_0_split_count_res_581638;
                        }
                        if (mem_586837_cached_sizze_588691 < bytes_586836) {
                            err = lexical_realloc(ctx, &mem_586837, &mem_586837_cached_sizze_588691, bytes_586836);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586840_cached_sizze_588692 < bytes_586836) {
                            err = lexical_realloc(ctx, &mem_586840, &mem_586840_cached_sizze_588692, bytes_586836);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586844_cached_sizze_588693 < bytes_586843) {
                            err = lexical_realloc(ctx, &mem_586844, &mem_586844_cached_sizze_588693, bytes_586843);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586847_cached_sizze_588694 < bytes_586836) {
                            err = lexical_realloc(ctx, &mem_586847, &mem_586847_cached_sizze_588694, bytes_586836);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586252 = 0; i_586252 < num_blocks_581464; i_586252++) {
                            bool y_581744 = slt64(i_586252, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465);
                            bool index_certs_581746;
                            
                            if (!y_581744) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586252, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581747 = ((int64_t *) mem_586820)[i_586252];
                            int64_t defunc_0_f_res_581748 = ((int64_t *) mem_586822)[i_586252];
                            int64_t tmp_581749 = add64((int64_t) 1, i_586252);
                            bool x_581750 = sle64((int64_t) 0, tmp_581749);
                            bool y_581751 = slt64(tmp_581749, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465);
                            bool bounds_check_581752 = x_581750 && y_581751;
                            bool index_certs_581753;
                            
                            if (!bounds_check_581752) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581749, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581754 = ((int64_t *) mem_586820)[tmp_581749];
                            int64_t defunc_0_f_res_581755 = ((int64_t *) mem_586822)[tmp_581749];
                            int64_t merge_sequential_arg2_581756 = add64(stride_581442, defunc_0_f_res_581748);
                            int64_t merge_sequential_arg2_581757 = add64(stride_581442, defunc_0_f_res_581755);
                            int64_t j_m_i_581758 = sub64(merge_sequential_arg2_581757, merge_sequential_arg2_581756);
                            bool empty_slice_581759 = j_m_i_581758 == (int64_t) 0;
                            int64_t m_581760 = sub64(j_m_i_581758, (int64_t) 1);
                            int64_t i_p_m_t_s_581761 = add64(merge_sequential_arg2_581756, m_581760);
                            bool zzero_leq_i_p_m_t_s_581762 = sle64((int64_t) 0, i_p_m_t_s_581761);
                            bool i_p_m_t_s_leq_w_581763 = slt64(i_p_m_t_s_581761, next_stride_581443);
                            bool zzero_lte_i_581764 = sle64((int64_t) 0, merge_sequential_arg2_581756);
                            bool i_lte_j_581765 = sle64(merge_sequential_arg2_581756, merge_sequential_arg2_581757);
                            bool y_581766 = i_p_m_t_s_leq_w_581763 && zzero_lte_i_581764;
                            bool y_581767 = zzero_leq_i_p_m_t_s_581762 && y_581766;
                            bool forwards_ok_581768 = i_lte_j_581765 && y_581767;
                            bool ok_or_empty_581769 = empty_slice_581759 || forwards_ok_581768;
                            bool index_certs_581770;
                            
                            if (!ok_or_empty_581769) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_581756, ":", (long long) merge_sequential_arg2_581757, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_581771 = sub64(defunc_0_f_res_581754, defunc_0_f_res_581747);
                            bool empty_slice_581772 = j_m_i_581771 == (int64_t) 0;
                            int64_t m_581773 = sub64(j_m_i_581771, (int64_t) 1);
                            int64_t i_p_m_t_s_581774 = add64(defunc_0_f_res_581747, m_581773);
                            bool zzero_leq_i_p_m_t_s_581775 = sle64((int64_t) 0, i_p_m_t_s_581774);
                            bool i_p_m_t_s_leq_w_581776 = slt64(i_p_m_t_s_581774, next_stride_581443);
                            bool zzero_lte_i_581777 = sle64((int64_t) 0, defunc_0_f_res_581747);
                            bool i_lte_j_581778 = sle64(defunc_0_f_res_581747, defunc_0_f_res_581754);
                            bool y_581779 = i_p_m_t_s_leq_w_581776 && zzero_lte_i_581777;
                            bool y_581780 = zzero_leq_i_p_m_t_s_581775 && y_581779;
                            bool forwards_ok_581781 = i_lte_j_581778 && y_581780;
                            bool ok_or_empty_581782 = empty_slice_581772 || forwards_ok_581781;
                            bool index_certs_581783;
                            
                            if (!ok_or_empty_581782) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_581747, ":", (long long) defunc_0_f_res_581754, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:805:33-56\n   #11 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_581784 = slt64((int64_t) 0, j_m_i_581771);
                            bool y_581795 = slt64((int64_t) 0, j_m_i_581758);
                            bool protect_assert_disj_587750 = cond_581784 || y_581795;
                            bool index_certs_581796;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:805:33-56\n   #13 ftSkyline.fut:792:17-805:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_581797 = start_581518 + merge_sequential_arg2_581756;
                            int64_t binop_y_586866 = dim_274571 * slice_581797;
                            int64_t slice_585956 = start_581518 + defunc_0_f_res_581747;
                            int64_t binop_y_586868 = dim_274571 * slice_585956;
                            int64_t ext_586870;
                            
                            if (cond_581784) {
                                ext_586870 = binop_y_586868;
                            } else {
                                ext_586870 = binop_y_586866;
                            }
                            
                            int64_t dummy_581785;
                            double dummy_581786;
                            int64_t dummy_581788;
                            
                            if (cond_581784) {
                                int64_t head_res_585957 = ((int64_t *) mem_param_586777.mem)[slice_585956];
                                double head_res_585958 = ((double *) mem_param_586780.mem)[slice_585956];
                                int64_t head_res_585960 = ((int64_t *) mem_param_586787.mem)[slice_585956];
                                
                                dummy_581785 = head_res_585957;
                                dummy_581786 = head_res_585958;
                                dummy_581788 = head_res_585960;
                            } else {
                                int64_t head_res_581798 = ((int64_t *) mem_param_586777.mem)[slice_581797];
                                double head_res_581799 = ((double *) mem_param_586780.mem)[slice_581797];
                                int64_t head_res_581801 = ((int64_t *) mem_param_586787.mem)[slice_581797];
                                
                                dummy_581785 = head_res_581798;
                                dummy_581786 = head_res_581799;
                                dummy_581788 = head_res_581801;
                            }
                            for (int64_t nest_i_588180 = 0; nest_i_588180 < merge_block_sizze_581263; nest_i_588180++) {
                                ((int64_t *) mem_586837)[i_586252 * merge_block_sizze_581263 + nest_i_588180] = dummy_581785;
                            }
                            for (int64_t nest_i_588181 = 0; nest_i_588181 < merge_block_sizze_581263; nest_i_588181++) {
                                ((double *) mem_586840)[i_586252 * merge_block_sizze_581263 + nest_i_588181] = dummy_581786;
                            }
                            for (int64_t nest_i_588182 = 0; nest_i_588182 < merge_block_sizze_581263; nest_i_588182++) {
                                ((int64_t *) mem_586847)[i_586252 * merge_block_sizze_581263 + nest_i_588182] = dummy_581788;
                            }
                            for (int64_t nest_i_588183 = 0; nest_i_588183 < merge_block_sizze_581263; nest_i_588183++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586844, i_586252 * lmad_arg_586865 + nest_i_588183 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586784.mem, ext_586870, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                            }
                            
                            int64_t data_581806;
                            int64_t i_581812 = (int64_t) 0;
                            
                            for (int64_t k_581811 = 0; k_581811 < merge_block_sizze_581263; k_581811++) {
                                int64_t j_581817 = sub64(k_581811, i_581812);
                                bool cond_581818 = j_581817 == j_m_i_581758;
                                bool x_587854 = !cond_581818;
                                bool cond_581820 = slt64(i_581812, j_m_i_581771);
                                bool x_585961 = sle64((int64_t) 0, j_581817);
                                bool y_585962 = slt64(j_581817, j_m_i_581758);
                                bool bounds_check_585963 = x_585961 && y_585962;
                                bool loop_not_taken_587842 = !cond_581820;
                                bool protect_assert_disj_587843 = bounds_check_585963 || loop_not_taken_587842;
                                bool protect_assert_disj_587857 = cond_581818 || protect_assert_disj_587843;
                                bool index_certs_585964;
                                
                                if (!protect_assert_disj_587857) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581817, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585965 = merge_sequential_arg2_581756 + j_581817;
                                int64_t slice_585966 = start_581518 + slice_585965;
                                bool protect_cond_conj_587858 = cond_581820 && x_587854;
                                int64_t leq_arg1_585967;
                                
                                if (protect_cond_conj_587858) {
                                    int64_t x_587844 = ((int64_t *) mem_param_586777.mem)[slice_585966];
                                    
                                    leq_arg1_585967 = x_587844;
                                } else {
                                    leq_arg1_585967 = (int64_t) 0;
                                }
                                
                                double leq_arg1_585968;
                                
                                if (protect_cond_conj_587858) {
                                    double x_587846 = ((double *) mem_param_586780.mem)[slice_585966];
                                    
                                    leq_arg1_585968 = x_587846;
                                } else {
                                    leq_arg1_585968 = 0.0;
                                }
                                
                                bool x_585969 = sle64((int64_t) 0, i_581812);
                                bool bounds_check_585970 = cond_581820 && x_585969;
                                bool protect_assert_disj_587849 = bounds_check_585970 || loop_not_taken_587842;
                                bool protect_assert_disj_587861 = cond_581818 || protect_assert_disj_587849;
                                bool index_certs_585971;
                                
                                if (!protect_assert_disj_587861) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581812, "] out of bounds for array of shape [", (long long) j_m_i_581771, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585972 = defunc_0_f_res_581747 + i_581812;
                                int64_t slice_585973 = start_581518 + slice_585972;
                                int64_t leq_arg0_585974;
                                
                                if (protect_cond_conj_587858) {
                                    int64_t x_587850 = ((int64_t *) mem_param_586777.mem)[slice_585973];
                                    
                                    leq_arg0_585974 = x_587850;
                                } else {
                                    leq_arg0_585974 = (int64_t) 0;
                                }
                                
                                double leq_arg0_585975;
                                
                                if (protect_cond_conj_587858) {
                                    double x_587852 = ((double *) mem_param_586780.mem)[slice_585973];
                                    
                                    leq_arg0_585975 = x_587852;
                                } else {
                                    leq_arg0_585975 = 0.0;
                                }
                                
                                bool cond_585976 = slt64(leq_arg0_585974, leq_arg1_585967);
                                bool cond_585977 = leq_arg0_585974 == leq_arg1_585967;
                                bool zlze_res_585978 = leq_arg0_585975 <= leq_arg1_585968;
                                bool x_585979 = cond_585977 && zlze_res_585978;
                                bool x_585980 = !cond_585976;
                                bool y_585981 = x_585979 && x_585980;
                                bool defunc_0_leq_res_585982 = cond_585976 || y_585981;
                                bool x_587876 = cond_581820 && defunc_0_leq_res_585982;
                                bool cond_581819 = cond_581818 || x_587876;
                                bool protect_assert_disj_587742 = cond_581819 || bounds_check_585963;
                                bool index_certs_581863;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581817, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585986 = cond_581820 && x_585969;
                                bool loop_not_taken_587737 = !cond_581819;
                                bool protect_assert_disj_587738 = bounds_check_585986 || loop_not_taken_587737;
                                bool index_certs_585987;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581812, "] out of bounds for array of shape [", (long long) j_m_i_581771, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:805:33-56\n   #12 ftSkyline.fut:792:17-805:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_581865 = start_581518 + slice_585965;
                                int64_t binop_y_586893 = dim_274571 * slice_581865;
                                int64_t slice_585989 = start_581518 + slice_585972;
                                int64_t binop_y_586895 = dim_274571 * slice_585989;
                                int64_t ext_586897;
                                
                                if (cond_581819) {
                                    ext_586897 = binop_y_586895;
                                } else {
                                    ext_586897 = binop_y_586893;
                                }
                                
                                int64_t loopres_581844;
                                int64_t loopres_581845;
                                double loopres_581846;
                                int64_t loopres_581848;
                                
                                if (cond_581819) {
                                    int64_t tmp_585983 = add64((int64_t) 1, i_581812);
                                    int64_t tmp_585990 = ((int64_t *) mem_param_586777.mem)[slice_585989];
                                    double tmp_585991 = ((double *) mem_param_586780.mem)[slice_585989];
                                    int64_t tmp_585993 = ((int64_t *) mem_param_586787.mem)[slice_585989];
                                    
                                    loopres_581844 = tmp_585983;
                                    loopres_581845 = tmp_585990;
                                    loopres_581846 = tmp_585991;
                                    loopres_581848 = tmp_585993;
                                } else {
                                    int64_t tmp_581866 = ((int64_t *) mem_param_586777.mem)[slice_581865];
                                    double tmp_581867 = ((double *) mem_param_586780.mem)[slice_581865];
                                    int64_t tmp_581869 = ((int64_t *) mem_param_586787.mem)[slice_581865];
                                    
                                    loopres_581844 = i_581812;
                                    loopres_581845 = tmp_581866;
                                    loopres_581846 = tmp_581867;
                                    loopres_581848 = tmp_581869;
                                }
                                ((int64_t *) mem_586837)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581845;
                                ((double *) mem_586840)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581846;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586844, i_586252 * lmad_arg_586865 + k_581811 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586784.mem, ext_586897, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
                                ((int64_t *) mem_586847)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581848;
                                
                                int64_t i_tmp_588184 = loopres_581844;
                                
                                i_581812 = i_tmp_588184;
                            }
                            data_581806 = i_581812;
                        }
                        if (memblock_alloc(ctx, &mem_586930, bytes_586836, "mem_586930")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586930.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint64_t *) mem_586837, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_alloc(ctx, &mem_586934, bytes_586836, "mem_586934")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586934.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint64_t *) mem_586840, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_alloc(ctx, &mem_586939, bytes_586843, "mem_586939")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_586939.mem, (int64_t) 0, (int64_t []) {dim_274571 * merge_block_sizze_581263, dim_274571, (int64_t) 1}, (uint64_t *) mem_586844, (int64_t) 0, (int64_t []) {lmad_arg_586865, dim_274571, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263, dim_274571});
                        if (memblock_alloc(ctx, &mem_586943, bytes_586836, "mem_586943")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586943.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint64_t *) mem_586847, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_set(ctx, &ext_mem_587002, &mem_586930, "mem_586930") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586999, &mem_586934, "mem_586934") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586996, &mem_586939, "mem_586939") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586992, &mem_586943, "mem_586943") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586790, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587002.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_587002, "ext_mem_587002") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586793, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586999.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_586999, "ext_mem_586999") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_586797, i_586265 * lmad_arg_586818, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) ext_mem_586996.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {next_stride_581443, dim_274571});
                    if (memblock_unref(ctx, &ext_mem_586996, "ext_mem_586996") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586800, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586992.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_586992, "ext_mem_586992") != 0)
                        return 1;
                }
                
                int64_t flat_dim_581882 = next_stride_581443 * num_merges_581447;
                
                if (memblock_alloc(ctx, &mem_587022, bytes_586789, "mem_587022")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587022.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint64_t *) mem_586790, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                if (memblock_alloc(ctx, &mem_587026, bytes_586789, "mem_587026")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587026.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint64_t *) mem_586793, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                if (memblock_alloc(ctx, &mem_587031, bytes_586796, "mem_587031")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_587031.mem, (int64_t) 0, (int64_t []) {dim_274571 * next_stride_581443, dim_274571, (int64_t) 1}, (uint64_t *) mem_586797, (int64_t) 0, (int64_t []) {lmad_arg_586818, dim_274571, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443, dim_274571});
                if (memblock_alloc(ctx, &mem_587035, bytes_586789, "mem_587035")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587035.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint64_t *) mem_586800, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                
                bool loop_cond_581889 = slt64(next_stride_581443, flat_dim_581257);
                
                if (memblock_set(ctx, &mem_param_tmp_588144, &mem_587022, "mem_587022") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588145, &mem_587026, "mem_587026") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588146, &mem_587031, "mem_587031") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588147, &mem_587035, "mem_587035") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588148 = flat_dim_581882;
                bool loop_while_tmp_588149 = loop_cond_581889;
                int64_t stride_tmp_588154 = next_stride_581443;
                
                if (memblock_set(ctx, &mem_param_586777, &mem_param_tmp_588144, "mem_param_tmp_588144") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586780, &mem_param_tmp_588145, "mem_param_tmp_588145") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586784, &mem_param_tmp_588146, "mem_param_tmp_588146") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586787, &mem_param_tmp_588147, "mem_param_tmp_588147") != 0)
                    return 1;
                loop_dz2084Uz2082U_581436 = loop_dz2084Uz2082U_tmp_588148;
                loop_while_581437 = loop_while_tmp_588149;
                stride_581442 = stride_tmp_588154;
            }
            if (memblock_set(ctx, &ext_mem_587049, &mem_param_586777, "mem_param_586777") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587048, &mem_param_586780, "mem_param_586780") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587047, &mem_param_586784, "mem_param_586784") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587046, &mem_param_586787, "mem_param_586787") != 0)
                return 1;
            data_581429 = loop_dz2084Uz2082U_581436;
            data_581430 = loop_while_581437;
            data_581435 = stride_581442;
            if (memblock_unref(ctx, &mem_586760, "mem_586760") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586764, "mem_586764") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586769, "mem_586769") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586773, "mem_586773") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_581892 = slt64(m_580370, data_581429);
            bool y_581893 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_581892;
            bool ok_or_empty_581894 = empty_slice_580369 || y_581893;
            bool index_certs_581895;
            
            if (!ok_or_empty_581894) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580360, "] out of bounds for array of shape [", (long long) data_581429, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587056, &ext_mem_587047, "ext_mem_587047") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587052, &ext_mem_587046, "ext_mem_587046") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587058, binop_x_586497, "mem_587058")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587052.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
        if (memblock_unref(ctx, &ext_mem_587052, "ext_mem_587052") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587061, bytes_586498, "mem_587061")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587061.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) ext_mem_587056.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {m_580360, dim_274571});
        if (memblock_unref(ctx, &ext_mem_587056, "ext_mem_587056") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587498, &mem_587061, "mem_587061") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587497, &mem_587058, "mem_587058") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586501, "mem_586501") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_586037;
    int64_t redout_586270 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586271 = 0; i_586271 < dim_274571; i_586271++) {
        int64_t x_581910 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586271];
        int64_t min_res_581913 = smin64(x_581910, redout_586270);
        int64_t redout_tmp_588189 = min_res_581913;
        
        redout_586270 = redout_tmp_588189;
    }
    defunc_0_reduce_res_586037 = redout_586270;
    
    bool cond_581914 = defunc_0_reduce_res_586037 == (int64_t) 1;
    bool bounds_invalid_upwards_581915 = slt64(total_grid_no_274592, (int64_t) 0);
    bool valid_581916 = !bounds_invalid_upwards_581915;
    bool protect_assert_disj_581917 = cond_581914 || valid_581916;
    bool range_valid_c_581918;
    
    if (!protect_assert_disj_581917) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_274592, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582271 = y_581105 || cond_581914;
    bool index_certs_581925;
    
    if (!protect_assert_disj_582271) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:805:33-56\n   #5  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587499 = (int64_t) 4 * total_grid_no_274592;
    
    if (cond_581914) {
        if (memblock_alloc(ctx, &mem_587536, total_grid_no_274592, "mem_587536")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < total_grid_no_274592; nest_i_588190++) {
            ((bool *) mem_587536.mem)[nest_i_588190] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587539, &mem_587536, "mem_587536") != 0)
            return 1;
    } else {
        if (mem_587500_cached_sizze_588718 < bytes_587499) {
            err = lexical_realloc(ctx, &mem_587500, &mem_587500_cached_sizze_588718, bytes_587499);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588191 = 0; nest_i_588191 < total_grid_no_274592; nest_i_588191++) {
            ((int32_t *) mem_587500)[nest_i_588191] = 0;
        }
        if (mem_587505_cached_sizze_588719 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_587505, &mem_587505_cached_sizze_588719, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586276 = 0; iter_586276 < m_580360; iter_586276++) {
            for (int64_t i_586274 = 0; i_586274 < dim_274571; i_586274++) {
                double eta_p_584752 = ((double *) ext_mem_587498.mem)[iter_586276 * dim_274571 + i_586274];
                double eta_p_584753 = ((double *) start_of_grid_partition_mem_586422.mem)[i_586274];
                double eta_p_584754 = ((double *) grid_part_sizze_per_dim_mem_586420.mem)[i_586274];
                int64_t eta_p_584756 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586274];
                double defunc_0_f_res_584757 = eta_p_584752 - eta_p_584753;
                double defunc_0_f_res_584759 = defunc_0_f_res_584757 / eta_p_584754;
                int64_t f64_res_584761 = fptosi_f64_i64(defunc_0_f_res_584759);
                int64_t max_res_584763 = smax64((int64_t) 0, f64_res_584761);
                int64_t zm_lhs_584769 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586274];
                int64_t min_arg1_584770 = sub64(zm_lhs_584769, (int64_t) 1);
                int64_t min_res_584771 = smin64(max_res_584763, min_arg1_584770);
                int64_t defunc_0_f_res_584773 = mul64(eta_p_584756, min_res_584771);
                
                ((int64_t *) mem_587505)[i_586274] = defunc_0_f_res_584773;
            }
            
            int64_t defunc_0_foldl_res_584680;
            int64_t acc_584682 = (int64_t) 0;
            
            for (int64_t i_584681 = 0; i_584681 < dim_274571; i_584681++) {
                int64_t b_584683 = ((int64_t *) mem_587505)[i_584681];
                int64_t defunc_0_f_res_584684 = add64(acc_584682, b_584683);
                int64_t acc_tmp_588194 = defunc_0_f_res_584684;
                
                acc_584682 = acc_tmp_588194;
            }
            defunc_0_foldl_res_584680 = acc_584682;
            
            bool less_than_zzero_586280 = slt64(defunc_0_foldl_res_584680, (int64_t) 0);
            bool greater_than_sizze_586281 = sle64(total_grid_no_274592, defunc_0_foldl_res_584680);
            bool outside_bounds_dim_586282 = less_than_zzero_586280 || greater_than_sizze_586281;
            
            if (!outside_bounds_dim_586282) {
                int32_t read_hist_586284 = ((int32_t *) mem_587500)[defunc_0_foldl_res_584680];
                int32_t defunc_0_op_res_581965 = add32(1, read_hist_586284);
                
                ((int32_t *) mem_587500)[defunc_0_foldl_res_584680] = defunc_0_op_res_581965;
            }
        }
        if (memblock_alloc(ctx, &mem_587515, total_grid_no_274592, "mem_587515")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588195 = 0; nest_i_588195 < total_grid_no_274592; nest_i_588195++) {
            ((bool *) mem_587515.mem)[nest_i_588195] = 0;
        }
        if (mem_587519_cached_sizze_588720 < dim_274571) {
            err = lexical_realloc(ctx, &mem_587519, &mem_587519_cached_sizze_588720, dim_274571);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_581970 = 0; i_581970 < total_grid_no_274592; i_581970++) {
            for (int64_t i_586289 = 0; i_586289 < dim_274571; i_586289++) {
                int64_t eta_p_581973 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586289];
                int64_t eta_p_581974 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586289];
                bool defunc_0_f_res_581975;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_581975, i_581970, eta_p_581973, eta_p_581974) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587519)[i_586289] = defunc_0_f_res_581975;
            }
            
            bool defunc_0_f_res_581976;
            bool acc_581978 = 0;
            
            for (int64_t i_581977 = 0; i_581977 < dim_274571; i_581977++) {
                bool b_581979 = ((bool *) mem_587519)[i_581977];
                bool defunc_0_f_res_581980 = acc_581978 || b_581979;
                bool acc_tmp_588198 = defunc_0_f_res_581980;
                
                acc_581978 = acc_tmp_588198;
            }
            defunc_0_f_res_581976 = acc_581978;
            if (!defunc_0_f_res_581976) {
                bool y_581982 = slt64(i_581970, dz2080U_274574);
                bool index_certs_581983;
                
                if (!y_581982) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581970, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:351:58-85\n   #2  ftSkyline.fut:805:33-56\n   #3  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_581985 = slt64(i_581970, (int64_t) 0);
                bool valid_581986 = !bounds_invalid_upwards_581985;
                bool range_valid_c_581987;
                
                if (!valid_581986) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_581970, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_586019;
                bool redout_586295 = 0;
                
                for (int64_t i_586296 = 0; i_586296 < i_581970; i_586296++) {
                    bool cond_584777 = i_586296 == i_581970;
                    bool cond_584778;
                    
                    if (cond_584777) {
                        cond_584778 = 1;
                    } else {
                        bool y_584780 = slt64(i_586296, total_grid_no_274592);
                        bool index_certs_584782;
                        
                        if (!y_584780) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586296, "] out of bounds for array of shape [", (long long) total_grid_no_274592, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584783 = ((int32_t *) mem_587500)[i_586296];
                        bool cond_f_res_584784 = zeze_lhs_584783 == 0;
                        
                        cond_584778 = cond_f_res_584784;
                    }
                    
                    bool defunc_0_f_res_584785;
                    
                    if (cond_584778) {
                        defunc_0_f_res_584785 = 0;
                    } else {
                        bool y_584787 = slt64(i_586296, dz2080U_274574);
                        bool index_certs_584789;
                        
                        if (!y_584787) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586296, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587526_cached_sizze_588721 < dim_274571) {
                            err = lexical_realloc(ctx, &mem_587526, &mem_587526_cached_sizze_588721, dim_274571);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586293 = 0; i_586293 < dim_274571; i_586293++) {
                            double eta_p_584792 = ((double *) start_of_grid_partition_mem_586422.mem)[i_581970 * dim_274571 + i_586293];
                            double eta_p_584793 = ((double *) start_of_grid_partition_mem_586422.mem)[i_586296 * dim_274571 + i_586293];
                            bool defunc_0_f_res_584794 = eta_p_584793 < eta_p_584792;
                            
                            ((bool *) mem_587526)[i_586293] = defunc_0_f_res_584794;
                        }
                        
                        bool defunc_0_foldl_res_584795;
                        bool acc_584797 = 1;
                        
                        for (int64_t i_584796 = 0; i_584796 < dim_274571; i_584796++) {
                            bool b_584798 = ((bool *) mem_587526)[i_584796];
                            bool x_584799 = acc_584797 && b_584798;
                            bool acc_tmp_588201 = x_584799;
                            
                            acc_584797 = acc_tmp_588201;
                        }
                        defunc_0_foldl_res_584795 = acc_584797;
                        defunc_0_f_res_584785 = defunc_0_foldl_res_584795;
                    }
                    
                    bool defunc_0_op_res_582021 = defunc_0_f_res_584785 || redout_586295;
                    bool redout_tmp_588199 = defunc_0_op_res_582021;
                    
                    redout_586295 = redout_tmp_588199;
                }
                defunc_0_reduce_res_586019 = redout_586295;
                ((bool *) mem_587515.mem)[i_581970] = defunc_0_reduce_res_586019;
            }
        }
        if (memblock_set(ctx, &ext_mem_587539, &mem_587515, "mem_587515") != 0)
            return 1;
    }
    
    bool index_certs_582034;
    
    if (!y_581105) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587541_cached_sizze_588722 < bytes_586518) {
        err = lexical_realloc(ctx, &mem_587541, &mem_587541_cached_sizze_588722, bytes_586518);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586299 = 0; i_586299 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573; i_586299++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582114 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586299];
        double i64_res_582115 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582114);
        double defunc_0_fover_res_582116 = 1.5707963267948966 / i64_res_582115;
        
        ((double *) mem_587541)[i_586299] = defunc_0_fover_res_582116;
    }
    
    bool empty_or_match_cert_582118;
    
    if (!assert_cond_580164) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_582155 = total_angle_no_274591 == (int64_t) 0;
    bool nonzzero_582156 = !zzero_582155;
    bool nonzzero_cert_582157;
    
    if (!nonzzero_582156) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:805:33-56\n   #7  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587549_cached_sizze_588723 < binop_x_586497) {
        err = lexical_realloc(ctx, &mem_587549, &mem_587549_cached_sizze_588723, binop_x_586497);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587551_cached_sizze_588724 < binop_x_586497) {
        err = lexical_realloc(ctx, &mem_587551, &mem_587551_cached_sizze_588724, binop_x_586497);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587553_cached_sizze_588725 < binop_x_586497) {
        err = lexical_realloc(ctx, &mem_587553, &mem_587553_cached_sizze_588725, binop_x_586497);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587564_cached_sizze_588726 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_587564, &mem_587564_cached_sizze_588726, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587572_cached_sizze_588727 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_587572, &mem_587572_cached_sizze_588727, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587580_cached_sizze_588728 < bytes_586560) {
        err = lexical_realloc(ctx, &mem_587580, &mem_587580_cached_sizze_588728, bytes_586560);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587596_cached_sizze_588730 < bytes_586560) {
        err = lexical_realloc(ctx, &mem_587596, &mem_587596_cached_sizze_588730, bytes_586560);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586328;
    int64_t scanacc_586320 = (int64_t) 0;
    
    for (int64_t i_586324 = 0; i_586324 < m_580360; i_586324++) {
        for (int64_t i_586303 = 0; i_586303 < dim_274571; i_586303++) {
            double eta_p_584882 = ((double *) ext_mem_587498.mem)[i_586324 * dim_274571 + i_586303];
            double eta_p_584883 = ((double *) start_of_grid_partition_mem_586422.mem)[i_586303];
            double eta_p_584884 = ((double *) grid_part_sizze_per_dim_mem_586420.mem)[i_586303];
            int64_t eta_p_584886 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586303];
            double defunc_0_f_res_584887 = eta_p_584882 - eta_p_584883;
            double defunc_0_f_res_584889 = defunc_0_f_res_584887 / eta_p_584884;
            int64_t f64_res_584891 = fptosi_f64_i64(defunc_0_f_res_584889);
            int64_t max_res_584893 = smax64((int64_t) 0, f64_res_584891);
            int64_t zm_lhs_584899 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586303];
            int64_t min_arg1_584900 = sub64(zm_lhs_584899, (int64_t) 1);
            int64_t min_res_584901 = smin64(max_res_584893, min_arg1_584900);
            int64_t defunc_0_f_res_584903 = mul64(eta_p_584886, min_res_584901);
            
            ((int64_t *) mem_587564)[i_586303] = defunc_0_f_res_584903;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_274571; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587564)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588208 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588208;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_274574);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_274574, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586307 = 0; i_586307 < dim_274571; i_586307++) {
            double eta_p_582571 = ((double *) ext_mem_587498.mem)[i_586324 * dim_274571 + i_586307];
            double eta_p_582572 = ((double *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_582560 * dim_274571 + i_586307];
            double defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((double *) mem_587572)[i_586307] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588210 = 0; nest_i_588210 < arg_580163; nest_i_588210++) {
            ((double *) mem_587580)[nest_i_588210] = 0.0;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_580163; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_274571);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_274571, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_274571);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_274571);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_274571, "] out of bounds for array of shape [", (long long) dim_274571, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587584 = (int64_t) 8 * j_m_i_582582;
            double this_x_582580 = ((double *) mem_587572)[i_582576];
            
            if (mem_587585_cached_sizze_588729 < bytes_587584) {
                err = lexical_realloc(ctx, &mem_587585, &mem_587585_cached_sizze_588729, bytes_587584);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586311 = 0; i_586311 < j_m_i_582582; i_586311++) {
                int64_t slice_586364 = map_arg1_582581 + i_586311;
                double eta_p_582597 = ((double *) mem_587572)[slice_586364];
                double defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((double *) mem_587585)[i_586311] = defunc_0_ftimes_res_582598;
            }
            
            double defunc_0_foldl_res_582599;
            double acc_582601 = 0.0;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                double b_582602 = ((double *) mem_587585)[i_582600];
                double defunc_0_f_res_582603 = acc_582601 + b_582602;
                double acc_tmp_588213 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588213;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            double sqrt_res_582604 = futrts_sqrt64(defunc_0_foldl_res_582599);
            double atan2_res_582605 = futrts_atan2_64(sqrt_res_582604, this_x_582580);
            
            ((double *) mem_587580)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586315 = 0; i_586315 < arg_580163; i_586315++) {
            double eta_p_582608 = ((double *) mem_587580)[i_586315];
            double eta_p_582609 = ((double *) mem_587541)[i_586315];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586315];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586315];
            double i64_res_582612 = sitofp_i64_f64(eta_p_582610);
            double defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            double defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f64_res_582615 = fptosi_f64_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f64_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f64_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_586024 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_586024;
                } else {
                    defunc_0_f_res_f_res_582619 = f64_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587596)[i_586315] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_580163; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587596)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588215 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588215;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_274591, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_274591);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_274592);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_274592, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:805:33-56\n   #6  ftSkyline.fut:792:17-805:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587539.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_582172 = add64(defunc_0_f_res_582636, scanacc_586320);
        
        ((int64_t *) mem_587549)[i_586324] = defunc_0_op_res_582172;
        ((int64_t *) mem_587551)[i_586324] = defunc_0_f_res_582636;
        ((int64_t *) mem_587553)[i_586324] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588203 = defunc_0_op_res_582172;
        
        scanacc_586320 = scanacc_tmp_588203;
    }
    discard_586328 = scanacc_586320;
    
    bool x_582174 = !empty_slice_580369;
    bool y_582177 = slt64(m_580370, m_580360);
    bool bounds_check_582178 = zzero_leq_i_p_m_t_s_580371 && y_582177;
    bool protect_assert_disj_582179 = empty_slice_580369 || bounds_check_582178;
    bool index_certs_582180;
    
    if (!protect_assert_disj_582179) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_580370, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_582181;
    
    if (x_582174) {
        int64_t x_586029 = ((int64_t *) mem_587549)[m_580370];
        
        m_f_res_582181 = x_586029;
    } else {
        m_f_res_582181 = (int64_t) 0;
    }
    
    int64_t m_582183;
    
    if (empty_slice_580369) {
        m_582183 = (int64_t) 0;
    } else {
        m_582183 = m_f_res_582181;
    }
    
    int64_t m_582194 = sub64(m_582183, (int64_t) 1);
    bool i_p_m_t_s_leq_w_582196 = slt64(m_582194, m_580360);
    bool zzero_leq_i_p_m_t_s_582195 = sle64((int64_t) 0, m_582194);
    bool y_582198 = zzero_leq_i_p_m_t_s_582195 && i_p_m_t_s_leq_w_582196;
    bool i_lte_j_582197 = sle64((int64_t) 0, m_582183);
    bool forwards_ok_582199 = i_lte_j_582197 && y_582198;
    bool eq_x_zz_582190 = (int64_t) 0 == m_f_res_582181;
    bool p_and_eq_x_y_582192 = x_582174 && eq_x_zz_582190;
    bool empty_slice_582193 = empty_slice_580369 || p_and_eq_x_y_582192;
    bool ok_or_empty_582200 = empty_slice_582193 || forwards_ok_582199;
    bool index_certs_582201;
    
    if (!ok_or_empty_582200) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_582183, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587612 = (int64_t) 8 * m_582183;
    int64_t bytes_587613 = dim_274571 * binop_x_587612;
    bool bounds_invalid_upwards_582233 = slt64(total_part_no_274593, (int64_t) 0);
    bool valid_582234 = !bounds_invalid_upwards_582233;
    bool range_valid_c_582235;
    
    if (!valid_582234) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_274593, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:805:33-56\n   #4  ftSkyline.fut:792:17-805:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587641 = (int64_t) 8 * total_part_no_274593;
    
    if (memblock_alloc(ctx, &mem_587614, bytes_587613, "mem_587614")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587614.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (uint64_t *) ext_mem_587498.mem, (int64_t) 0, (int64_t []) {dim_274571, (int64_t) 1}, (int64_t []) {m_582183, dim_274571});
    if (mem_587616_cached_sizze_588731 < binop_x_587612) {
        err = lexical_realloc(ctx, &mem_587616, &mem_587616_cached_sizze_588731, binop_x_587612);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587616, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587553, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582183});
    if (memblock_alloc(ctx, &mem_587618, binop_x_587612, "mem_587618")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587618.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587497.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582183});
    if (mem_587630_cached_sizze_588732 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_587630, &mem_587630_cached_sizze_588732, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586329 = 0; write_iter_586329 < m_580360; write_iter_586329++) {
        int64_t write_iv_586333 = ((int64_t *) mem_587551)[write_iter_586329];
        int64_t write_iv_586334 = ((int64_t *) mem_587549)[write_iter_586329];
        int64_t write_iv_586336 = ((int64_t *) ext_mem_587497.mem)[write_iter_586329];
        int64_t write_iv_586337 = ((int64_t *) mem_587553)[write_iter_586329];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587630, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587498.mem, write_iter_586329 * dim_274571, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
        
        bool cond_582515 = write_iv_586333 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_586030 = sub64(write_iv_586334, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_586030;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_274571 - (int64_t) 1, dim_274571))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587614.mem, lifted_lambda_res_582516 * dim_274571, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587630, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_274571});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) {
            ((int64_t *) mem_587618.mem)[lifted_lambda_res_582516] = write_iv_586336;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) {
            ((int64_t *) mem_587616)[lifted_lambda_res_582516] = write_iv_586337;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587497, "ext_mem_587497") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587498, "ext_mem_587498") != 0)
        return 1;
    if (mem_587642_cached_sizze_588733 < bytes_587641) {
        err = lexical_realloc(ctx, &mem_587642, &mem_587642_cached_sizze_588733, bytes_587641);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588219 = 0; nest_i_588219 < total_part_no_274593; nest_i_588219++) {
        ((int64_t *) mem_587642)[nest_i_588219] = (int64_t) 0;
    }
    for (int64_t iter_586341 = 0; iter_586341 < m_582183; iter_586341++) {
        int64_t pixel_586343 = ((int64_t *) mem_587616)[iter_586341];
        bool less_than_zzero_586345 = slt64(pixel_586343, (int64_t) 0);
        bool greater_than_sizze_586346 = sle64(total_part_no_274593, pixel_586343);
        bool outside_bounds_dim_586347 = less_than_zzero_586345 || greater_than_sizze_586346;
        
        if (!outside_bounds_dim_586347) {
            int64_t read_hist_586349 = ((int64_t *) mem_587642)[pixel_586343];
            int64_t defunc_0_op_res_582240 = add64((int64_t) 1, read_hist_586349);
            
            ((int64_t *) mem_587642)[pixel_586343] = defunc_0_op_res_582240;
        }
    }
    if (mem_587650_cached_sizze_588734 < bytes_587641) {
        err = lexical_realloc(ctx, &mem_587650, &mem_587650_cached_sizze_588734, bytes_587641);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586357;
    int64_t scanacc_586353 = (int64_t) 0;
    
    for (int64_t i_586355 = 0; i_586355 < total_part_no_274593; i_586355++) {
        int64_t x_582244 = ((int64_t *) mem_587642)[i_586355];
        int64_t defunc_0_op_res_582247 = add64(x_582244, scanacc_586353);
        
        ((int64_t *) mem_587650)[i_586355] = defunc_0_op_res_582247;
        
        int64_t scanacc_tmp_588221 = defunc_0_op_res_582247;
        
        scanacc_586353 = scanacc_tmp_588221;
    }
    discard_586357 = scanacc_586353;
    if (memblock_alloc(ctx, &mem_587658, bytes_587641, "mem_587658")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586360 = 0; i_586360 < total_part_no_274593; i_586360++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586360);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_274593);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587650)[tmp_582504];
        bool cond_582507 = i_586360 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587658.mem)[i_586360] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587539, "ext_mem_587539") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587658, "mem_587658") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587614, "mem_587614") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587618, "mem_587618") != 0)
        return 1;
    prim_out_588011 = total_grid_no_274592;
    prim_out_588012 = total_part_no_274593;
    prim_out_588013 = m_582183;
    if (memblock_set(ctx, &*mem_out_p_588650, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588651, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588652, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588653, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588654 = prim_out_588011;
    *out_prim_out_588655 = prim_out_588012;
    *out_prim_out_588656 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586425);
        free(mem_586433);
        free(mem_586438);
        free(mem_586452);
        free(mem_586459);
        free(mem_586474);
        free(mem_586476);
        free(mem_586484);
        free(mem_586510);
        free(mem_586519);
        free(mem_586527);
        free(mem_586529);
        free(mem_586537);
        free(mem_586545);
        free(mem_586547);
        free(mem_586561);
        free(mem_586566);
        free(mem_586577);
        free(mem_586603);
        free(mem_586606);
        free(mem_586610);
        free(mem_586613);
        free(mem_586633);
        free(mem_586635);
        free(mem_586638);
        free(mem_586640);
        free(mem_586699);
        free(mem_586701);
        free(mem_586790);
        free(mem_586793);
        free(mem_586797);
        free(mem_586800);
        free(mem_586820);
        free(mem_586822);
        free(mem_586837);
        free(mem_586840);
        free(mem_586844);
        free(mem_586847);
        free(mem_587063);
        free(mem_587071);
        free(mem_587076);
        free(mem_587084);
        free(mem_587092);
        free(mem_587097);
        free(mem_587108);
        free(mem_587131);
        free(mem_587135);
        free(mem_587138);
        free(mem_587154);
        free(mem_587157);
        free(mem_587159);
        free(mem_587206);
        free(mem_587208);
        free(mem_587277);
        free(mem_587281);
        free(mem_587284);
        free(mem_587300);
        free(mem_587302);
        free(mem_587317);
        free(mem_587321);
        free(mem_587324);
        free(mem_587500);
        free(mem_587505);
        free(mem_587519);
        free(mem_587526);
        free(mem_587541);
        free(mem_587549);
        free(mem_587551);
        free(mem_587553);
        free(mem_587564);
        free(mem_587572);
        free(mem_587580);
        free(mem_587585);
        free(mem_587596);
        free(mem_587616);
        free(mem_587630);
        free(mem_587642);
        free(mem_587650);
        if (memblock_unref(ctx, &mem_587658, "mem_587658") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587618, "mem_587618") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587614, "mem_587614") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587515, "mem_587515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587536, "mem_587536") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587539, "ext_mem_587539") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587061, "mem_587061") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587058, "mem_587058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588147, "mem_param_tmp_588147") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588146, "mem_param_tmp_588146") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588145, "mem_param_tmp_588145") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588144, "mem_param_tmp_588144") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587035, "mem_587035") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587031, "mem_587031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587022, "mem_587022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586943, "mem_586943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586939, "mem_586939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586934, "mem_586934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586930, "mem_586930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586958, "mem_586958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586955, "mem_586955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586953, "mem_586953") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586951, "mem_586951") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586992, "ext_mem_586992") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586996, "ext_mem_586996") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586999, "ext_mem_586999") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587002, "ext_mem_587002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586787, "mem_param_586787") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586784, "mem_param_586784") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586780, "mem_param_586780") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586777, "mem_param_586777") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587046, "ext_mem_587046") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587047, "ext_mem_587047") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587048, "ext_mem_587048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587049, "ext_mem_587049") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586773, "mem_586773") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586769, "mem_586769") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586764, "mem_586764") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586760, "mem_586760") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586658, "ext_mem_586658") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588120, "mem_param_tmp_588120") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586597, "ext_mem_586597") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586592, "mem_param_586592") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586600, "ext_mem_586600") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587052, "ext_mem_587052") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587056, "ext_mem_587056") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587496, "mem_587496") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587493, "mem_587493") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588071, "mem_param_tmp_588071") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588070, "mem_param_tmp_588070") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588069, "mem_param_tmp_588069") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587473, "mem_587473") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587469, "mem_587469") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587464, "mem_587464") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587396, "mem_587396") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587391, "mem_587391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587413, "mem_587413") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587410, "mem_587410") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587408, "mem_587408") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587441, "ext_mem_587441") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587445, "ext_mem_587445") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587274, "mem_param_587274") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587271, "mem_param_587271") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587267, "mem_param_587267") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587482, "ext_mem_587482") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587483, "ext_mem_587483") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587484, "ext_mem_587484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587263, "mem_587263") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587259, "mem_587259") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587254, "mem_587254") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587174, "ext_mem_587174") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587125, "ext_mem_587125") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587120, "mem_param_587120") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587128, "ext_mem_587128") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587487, "ext_mem_587487") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587491, "ext_mem_587491") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587497, "ext_mem_587497") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587498, "ext_mem_587498") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586501, "mem_586501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586448, "mem_586448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586469, "mem_586469") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586472, "ext_mem_586472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588735, struct memblock *mem_out_p_588736, struct memblock *mem_out_p_588737, struct memblock *mem_out_p_588738, int64_t *out_prim_out_588739, int64_t *out_prim_out_588740, int64_t *out_prim_out_588741, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock angle_part_prefix_sum_mem_586417, struct memblock angle_partitions_per_dim_mem_586418, struct memblock grid_part_prefix_sum_mem_586419, struct memblock grid_part_sizze_per_dim_mem_586420, struct memblock grid_partitions_per_dim_mem_586421, struct memblock start_of_grid_partition_mem_586422, struct memblock xs_mem_586423, int64_t dim_438949, int64_t dz2080U_438950, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951, int64_t dz2080U_438952, int64_t n_438953, int64_t total_angle_no_438960, int64_t total_grid_no_438961, int64_t total_part_no_438962, int64_t total_angle_no_438969, int64_t total_grid_no_438970, int64_t total_part_no_438971, int64_t offset_438973, bool use_measure_for_sorting_438974)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586425_cached_sizze_588742 = 0;
    unsigned char *mem_586425 = NULL;
    int64_t mem_586433_cached_sizze_588743 = 0;
    unsigned char *mem_586433 = NULL;
    int64_t mem_586438_cached_sizze_588744 = 0;
    unsigned char *mem_586438 = NULL;
    int64_t mem_586452_cached_sizze_588745 = 0;
    unsigned char *mem_586452 = NULL;
    int64_t mem_586459_cached_sizze_588746 = 0;
    unsigned char *mem_586459 = NULL;
    int64_t mem_586474_cached_sizze_588747 = 0;
    unsigned char *mem_586474 = NULL;
    int64_t mem_586476_cached_sizze_588748 = 0;
    unsigned char *mem_586476 = NULL;
    int64_t mem_586484_cached_sizze_588749 = 0;
    unsigned char *mem_586484 = NULL;
    int64_t mem_586510_cached_sizze_588750 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586519_cached_sizze_588751 = 0;
    unsigned char *mem_586519 = NULL;
    int64_t mem_586527_cached_sizze_588752 = 0;
    unsigned char *mem_586527 = NULL;
    int64_t mem_586529_cached_sizze_588753 = 0;
    unsigned char *mem_586529 = NULL;
    int64_t mem_586537_cached_sizze_588754 = 0;
    unsigned char *mem_586537 = NULL;
    int64_t mem_586545_cached_sizze_588755 = 0;
    unsigned char *mem_586545 = NULL;
    int64_t mem_586547_cached_sizze_588756 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586561_cached_sizze_588757 = 0;
    unsigned char *mem_586561 = NULL;
    int64_t mem_586566_cached_sizze_588758 = 0;
    unsigned char *mem_586566 = NULL;
    int64_t mem_586577_cached_sizze_588759 = 0;
    unsigned char *mem_586577 = NULL;
    int64_t mem_586603_cached_sizze_588760 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586606_cached_sizze_588761 = 0;
    unsigned char *mem_586606 = NULL;
    int64_t mem_586610_cached_sizze_588762 = 0;
    unsigned char *mem_586610 = NULL;
    int64_t mem_586613_cached_sizze_588763 = 0;
    unsigned char *mem_586613 = NULL;
    int64_t mem_586633_cached_sizze_588764 = 0;
    unsigned char *mem_586633 = NULL;
    int64_t mem_586635_cached_sizze_588765 = 0;
    unsigned char *mem_586635 = NULL;
    int64_t mem_586638_cached_sizze_588766 = 0;
    unsigned char *mem_586638 = NULL;
    int64_t mem_586640_cached_sizze_588767 = 0;
    unsigned char *mem_586640 = NULL;
    int64_t mem_586699_cached_sizze_588768 = 0;
    unsigned char *mem_586699 = NULL;
    int64_t mem_586701_cached_sizze_588769 = 0;
    unsigned char *mem_586701 = NULL;
    int64_t mem_586790_cached_sizze_588770 = 0;
    unsigned char *mem_586790 = NULL;
    int64_t mem_586793_cached_sizze_588771 = 0;
    unsigned char *mem_586793 = NULL;
    int64_t mem_586797_cached_sizze_588772 = 0;
    unsigned char *mem_586797 = NULL;
    int64_t mem_586800_cached_sizze_588773 = 0;
    unsigned char *mem_586800 = NULL;
    int64_t mem_586820_cached_sizze_588774 = 0;
    unsigned char *mem_586820 = NULL;
    int64_t mem_586822_cached_sizze_588775 = 0;
    unsigned char *mem_586822 = NULL;
    int64_t mem_586837_cached_sizze_588776 = 0;
    unsigned char *mem_586837 = NULL;
    int64_t mem_586840_cached_sizze_588777 = 0;
    unsigned char *mem_586840 = NULL;
    int64_t mem_586844_cached_sizze_588778 = 0;
    unsigned char *mem_586844 = NULL;
    int64_t mem_586847_cached_sizze_588779 = 0;
    unsigned char *mem_586847 = NULL;
    int64_t mem_587063_cached_sizze_588780 = 0;
    unsigned char *mem_587063 = NULL;
    int64_t mem_587071_cached_sizze_588781 = 0;
    unsigned char *mem_587071 = NULL;
    int64_t mem_587076_cached_sizze_588782 = 0;
    unsigned char *mem_587076 = NULL;
    int64_t mem_587084_cached_sizze_588783 = 0;
    unsigned char *mem_587084 = NULL;
    int64_t mem_587092_cached_sizze_588784 = 0;
    unsigned char *mem_587092 = NULL;
    int64_t mem_587097_cached_sizze_588785 = 0;
    unsigned char *mem_587097 = NULL;
    int64_t mem_587108_cached_sizze_588786 = 0;
    unsigned char *mem_587108 = NULL;
    int64_t mem_587131_cached_sizze_588787 = 0;
    unsigned char *mem_587131 = NULL;
    int64_t mem_587135_cached_sizze_588788 = 0;
    unsigned char *mem_587135 = NULL;
    int64_t mem_587138_cached_sizze_588789 = 0;
    unsigned char *mem_587138 = NULL;
    int64_t mem_587154_cached_sizze_588790 = 0;
    unsigned char *mem_587154 = NULL;
    int64_t mem_587157_cached_sizze_588791 = 0;
    unsigned char *mem_587157 = NULL;
    int64_t mem_587159_cached_sizze_588792 = 0;
    unsigned char *mem_587159 = NULL;
    int64_t mem_587206_cached_sizze_588793 = 0;
    unsigned char *mem_587206 = NULL;
    int64_t mem_587208_cached_sizze_588794 = 0;
    unsigned char *mem_587208 = NULL;
    int64_t mem_587277_cached_sizze_588795 = 0;
    unsigned char *mem_587277 = NULL;
    int64_t mem_587281_cached_sizze_588796 = 0;
    unsigned char *mem_587281 = NULL;
    int64_t mem_587284_cached_sizze_588797 = 0;
    unsigned char *mem_587284 = NULL;
    int64_t mem_587300_cached_sizze_588798 = 0;
    unsigned char *mem_587300 = NULL;
    int64_t mem_587302_cached_sizze_588799 = 0;
    unsigned char *mem_587302 = NULL;
    int64_t mem_587317_cached_sizze_588800 = 0;
    unsigned char *mem_587317 = NULL;
    int64_t mem_587321_cached_sizze_588801 = 0;
    unsigned char *mem_587321 = NULL;
    int64_t mem_587324_cached_sizze_588802 = 0;
    unsigned char *mem_587324 = NULL;
    int64_t mem_587500_cached_sizze_588803 = 0;
    unsigned char *mem_587500 = NULL;
    int64_t mem_587505_cached_sizze_588804 = 0;
    unsigned char *mem_587505 = NULL;
    int64_t mem_587519_cached_sizze_588805 = 0;
    unsigned char *mem_587519 = NULL;
    int64_t mem_587526_cached_sizze_588806 = 0;
    unsigned char *mem_587526 = NULL;
    int64_t mem_587541_cached_sizze_588807 = 0;
    unsigned char *mem_587541 = NULL;
    int64_t mem_587549_cached_sizze_588808 = 0;
    unsigned char *mem_587549 = NULL;
    int64_t mem_587551_cached_sizze_588809 = 0;
    unsigned char *mem_587551 = NULL;
    int64_t mem_587553_cached_sizze_588810 = 0;
    unsigned char *mem_587553 = NULL;
    int64_t mem_587564_cached_sizze_588811 = 0;
    unsigned char *mem_587564 = NULL;
    int64_t mem_587572_cached_sizze_588812 = 0;
    unsigned char *mem_587572 = NULL;
    int64_t mem_587580_cached_sizze_588813 = 0;
    unsigned char *mem_587580 = NULL;
    int64_t mem_587585_cached_sizze_588814 = 0;
    unsigned char *mem_587585 = NULL;
    int64_t mem_587596_cached_sizze_588815 = 0;
    unsigned char *mem_587596 = NULL;
    int64_t mem_587616_cached_sizze_588816 = 0;
    unsigned char *mem_587616 = NULL;
    int64_t mem_587630_cached_sizze_588817 = 0;
    unsigned char *mem_587630 = NULL;
    int64_t mem_587642_cached_sizze_588818 = 0;
    unsigned char *mem_587642 = NULL;
    int64_t mem_587650_cached_sizze_588819 = 0;
    unsigned char *mem_587650 = NULL;
    struct memblock mem_587658;
    
    mem_587658.references = NULL;
    
    struct memblock mem_587618;
    
    mem_587618.references = NULL;
    
    struct memblock mem_587614;
    
    mem_587614.references = NULL;
    
    struct memblock mem_587515;
    
    mem_587515.references = NULL;
    
    struct memblock mem_587536;
    
    mem_587536.references = NULL;
    
    struct memblock ext_mem_587539;
    
    ext_mem_587539.references = NULL;
    
    struct memblock mem_587061;
    
    mem_587061.references = NULL;
    
    struct memblock mem_587058;
    
    mem_587058.references = NULL;
    
    struct memblock mem_param_tmp_588147;
    
    mem_param_tmp_588147.references = NULL;
    
    struct memblock mem_param_tmp_588146;
    
    mem_param_tmp_588146.references = NULL;
    
    struct memblock mem_param_tmp_588145;
    
    mem_param_tmp_588145.references = NULL;
    
    struct memblock mem_param_tmp_588144;
    
    mem_param_tmp_588144.references = NULL;
    
    struct memblock mem_587035;
    
    mem_587035.references = NULL;
    
    struct memblock mem_587031;
    
    mem_587031.references = NULL;
    
    struct memblock mem_587026;
    
    mem_587026.references = NULL;
    
    struct memblock mem_587022;
    
    mem_587022.references = NULL;
    
    struct memblock mem_586943;
    
    mem_586943.references = NULL;
    
    struct memblock mem_586939;
    
    mem_586939.references = NULL;
    
    struct memblock mem_586934;
    
    mem_586934.references = NULL;
    
    struct memblock mem_586930;
    
    mem_586930.references = NULL;
    
    struct memblock mem_586958;
    
    mem_586958.references = NULL;
    
    struct memblock mem_586955;
    
    mem_586955.references = NULL;
    
    struct memblock mem_586953;
    
    mem_586953.references = NULL;
    
    struct memblock mem_586951;
    
    mem_586951.references = NULL;
    
    struct memblock ext_mem_586992;
    
    ext_mem_586992.references = NULL;
    
    struct memblock ext_mem_586996;
    
    ext_mem_586996.references = NULL;
    
    struct memblock ext_mem_586999;
    
    ext_mem_586999.references = NULL;
    
    struct memblock ext_mem_587002;
    
    ext_mem_587002.references = NULL;
    
    struct memblock mem_param_586787;
    
    mem_param_586787.references = NULL;
    
    struct memblock mem_param_586784;
    
    mem_param_586784.references = NULL;
    
    struct memblock mem_param_586780;
    
    mem_param_586780.references = NULL;
    
    struct memblock mem_param_586777;
    
    mem_param_586777.references = NULL;
    
    struct memblock ext_mem_587046;
    
    ext_mem_587046.references = NULL;
    
    struct memblock ext_mem_587047;
    
    ext_mem_587047.references = NULL;
    
    struct memblock ext_mem_587048;
    
    ext_mem_587048.references = NULL;
    
    struct memblock ext_mem_587049;
    
    ext_mem_587049.references = NULL;
    
    struct memblock mem_586773;
    
    mem_586773.references = NULL;
    
    struct memblock mem_586769;
    
    mem_586769.references = NULL;
    
    struct memblock mem_586764;
    
    mem_586764.references = NULL;
    
    struct memblock mem_586760;
    
    mem_586760.references = NULL;
    
    struct memblock ext_mem_586658;
    
    ext_mem_586658.references = NULL;
    
    struct memblock mem_param_tmp_588120;
    
    mem_param_tmp_588120.references = NULL;
    
    struct memblock ext_mem_586597;
    
    ext_mem_586597.references = NULL;
    
    struct memblock mem_param_586592;
    
    mem_param_586592.references = NULL;
    
    struct memblock ext_mem_586600;
    
    ext_mem_586600.references = NULL;
    
    struct memblock ext_mem_587052;
    
    ext_mem_587052.references = NULL;
    
    struct memblock ext_mem_587056;
    
    ext_mem_587056.references = NULL;
    
    struct memblock mem_587496;
    
    mem_587496.references = NULL;
    
    struct memblock mem_587493;
    
    mem_587493.references = NULL;
    
    struct memblock mem_param_tmp_588071;
    
    mem_param_tmp_588071.references = NULL;
    
    struct memblock mem_param_tmp_588070;
    
    mem_param_tmp_588070.references = NULL;
    
    struct memblock mem_param_tmp_588069;
    
    mem_param_tmp_588069.references = NULL;
    
    struct memblock mem_587473;
    
    mem_587473.references = NULL;
    
    struct memblock mem_587469;
    
    mem_587469.references = NULL;
    
    struct memblock mem_587464;
    
    mem_587464.references = NULL;
    
    struct memblock mem_587400;
    
    mem_587400.references = NULL;
    
    struct memblock mem_587396;
    
    mem_587396.references = NULL;
    
    struct memblock mem_587391;
    
    mem_587391.references = NULL;
    
    struct memblock mem_587413;
    
    mem_587413.references = NULL;
    
    struct memblock mem_587410;
    
    mem_587410.references = NULL;
    
    struct memblock mem_587408;
    
    mem_587408.references = NULL;
    
    struct memblock ext_mem_587441;
    
    ext_mem_587441.references = NULL;
    
    struct memblock ext_mem_587445;
    
    ext_mem_587445.references = NULL;
    
    struct memblock ext_mem_587448;
    
    ext_mem_587448.references = NULL;
    
    struct memblock mem_param_587274;
    
    mem_param_587274.references = NULL;
    
    struct memblock mem_param_587271;
    
    mem_param_587271.references = NULL;
    
    struct memblock mem_param_587267;
    
    mem_param_587267.references = NULL;
    
    struct memblock ext_mem_587482;
    
    ext_mem_587482.references = NULL;
    
    struct memblock ext_mem_587483;
    
    ext_mem_587483.references = NULL;
    
    struct memblock ext_mem_587484;
    
    ext_mem_587484.references = NULL;
    
    struct memblock mem_587263;
    
    mem_587263.references = NULL;
    
    struct memblock mem_587259;
    
    mem_587259.references = NULL;
    
    struct memblock mem_587254;
    
    mem_587254.references = NULL;
    
    struct memblock ext_mem_587174;
    
    ext_mem_587174.references = NULL;
    
    struct memblock mem_param_tmp_588050;
    
    mem_param_tmp_588050.references = NULL;
    
    struct memblock ext_mem_587125;
    
    ext_mem_587125.references = NULL;
    
    struct memblock mem_param_587120;
    
    mem_param_587120.references = NULL;
    
    struct memblock ext_mem_587128;
    
    ext_mem_587128.references = NULL;
    
    struct memblock ext_mem_587487;
    
    ext_mem_587487.references = NULL;
    
    struct memblock ext_mem_587491;
    
    ext_mem_587491.references = NULL;
    
    struct memblock ext_mem_587497;
    
    ext_mem_587497.references = NULL;
    
    struct memblock ext_mem_587498;
    
    ext_mem_587498.references = NULL;
    
    struct memblock mem_586501;
    
    mem_586501.references = NULL;
    
    struct memblock mem_586499;
    
    mem_586499.references = NULL;
    
    struct memblock mem_586448;
    
    mem_586448.references = NULL;
    
    struct memblock mem_586469;
    
    mem_586469.references = NULL;
    
    struct memblock ext_mem_586472;
    
    ext_mem_586472.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_580163 = sub64(dim_438949, (int64_t) 1);
    bool assert_cond_580164 = arg_580163 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951;
    bool assert_c_580165;
    
    if (!assert_cond_580164) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586424 = (int64_t) 8 * n_438953;
    
    if (mem_586425_cached_sizze_588742 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586425, &mem_586425_cached_sizze_588742, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < n_438953; i_586050++) {
        int64_t lifted_lambda_res_580172 = add64(offset_438973, i_586050);
        
        ((int64_t *) mem_586425)[i_586050] = lifted_lambda_res_580172;
    }
    
    int64_t defunc_0_reduce_res_586032;
    int64_t redout_586052 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586053 = 0; i_586053 < dim_438949; i_586053++) {
        int64_t x_580174 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586053];
        int64_t min_res_580177 = smin64(x_580174, redout_586052);
        int64_t redout_tmp_588015 = min_res_580177;
        
        redout_586052 = redout_tmp_588015;
    }
    defunc_0_reduce_res_586032 = redout_586052;
    
    bool cond_580178 = defunc_0_reduce_res_586032 == (int64_t) 1;
    bool bounds_invalid_upwards_580179 = slt64(total_grid_no_438961, (int64_t) 0);
    bool valid_580180 = !bounds_invalid_upwards_580179;
    bool protect_assert_disj_580181 = cond_580178 || valid_580180;
    bool range_valid_c_580182;
    
    if (!protect_assert_disj_580181) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_438961, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:284:65-78\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_580188 = slt64((int64_t) 0, dz2080U_438950);
    bool protect_assert_disj_582349 = cond_580178 || y_580188;
    bool index_certs_580189;
    
    if (!protect_assert_disj_582349) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438950, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:282:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:349:69-71\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586432 = (int64_t) 4 * total_grid_no_438961;
    int64_t bytes_586437 = (int64_t) 8 * dim_438949;
    
    if (cond_580178) {
        if (memblock_alloc(ctx, &mem_586469, total_grid_no_438961, "mem_586469")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588016 = 0; nest_i_588016 < total_grid_no_438961; nest_i_588016++) {
            ((bool *) mem_586469.mem)[nest_i_588016] = 0;
        }
        if (memblock_set(ctx, &ext_mem_586472, &mem_586469, "mem_586469") != 0)
            return 1;
    } else {
        if (mem_586433_cached_sizze_588743 < bytes_586432) {
            err = lexical_realloc(ctx, &mem_586433, &mem_586433_cached_sizze_588743, bytes_586432);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588017 = 0; nest_i_588017 < total_grid_no_438961; nest_i_588017++) {
            ((int32_t *) mem_586433)[nest_i_588017] = 0;
        }
        if (mem_586438_cached_sizze_588744 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586438, &mem_586438_cached_sizze_588744, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586058 = 0; iter_586058 < n_438953; iter_586058++) {
            for (int64_t i_586056 = 0; i_586056 < dim_438949; i_586056++) {
                float eta_p_582805 = ((float *) xs_mem_586423.mem)[iter_586058 * dim_438949 + i_586056];
                float eta_p_582806 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586056];
                float eta_p_582807 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586056];
                int64_t eta_p_582809 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586056];
                float defunc_0_f_res_582810 = eta_p_582805 - eta_p_582806;
                float defunc_0_f_res_582812 = defunc_0_f_res_582810 / eta_p_582807;
                int64_t f32_res_582814 = fptosi_f32_i64(defunc_0_f_res_582812);
                int64_t max_res_582816 = smax64((int64_t) 0, f32_res_582814);
                int64_t zm_lhs_582822 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586056];
                int64_t min_arg1_582823 = sub64(zm_lhs_582822, (int64_t) 1);
                int64_t min_res_582824 = smin64(max_res_582816, min_arg1_582823);
                int64_t defunc_0_f_res_582826 = mul64(eta_p_582809, min_res_582824);
                
                ((int64_t *) mem_586438)[i_586056] = defunc_0_f_res_582826;
            }
            
            int64_t defunc_0_foldl_res_582733;
            int64_t acc_582735 = (int64_t) 0;
            
            for (int64_t i_582734 = 0; i_582734 < dim_438949; i_582734++) {
                int64_t b_582736 = ((int64_t *) mem_586438)[i_582734];
                int64_t defunc_0_f_res_582737 = add64(acc_582735, b_582736);
                int64_t acc_tmp_588020 = defunc_0_f_res_582737;
                
                acc_582735 = acc_tmp_588020;
            }
            defunc_0_foldl_res_582733 = acc_582735;
            
            bool less_than_zzero_586062 = slt64(defunc_0_foldl_res_582733, (int64_t) 0);
            bool greater_than_sizze_586063 = sle64(total_grid_no_438961, defunc_0_foldl_res_582733);
            bool outside_bounds_dim_586064 = less_than_zzero_586062 || greater_than_sizze_586063;
            
            if (!outside_bounds_dim_586064) {
                int32_t read_hist_586066 = ((int32_t *) mem_586433)[defunc_0_foldl_res_582733];
                int32_t defunc_0_op_res_580229 = add32(1, read_hist_586066);
                
                ((int32_t *) mem_586433)[defunc_0_foldl_res_582733] = defunc_0_op_res_580229;
            }
        }
        if (memblock_alloc(ctx, &mem_586448, total_grid_no_438961, "mem_586448")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588021 = 0; nest_i_588021 < total_grid_no_438961; nest_i_588021++) {
            ((bool *) mem_586448.mem)[nest_i_588021] = 0;
        }
        if (mem_586452_cached_sizze_588745 < dim_438949) {
            err = lexical_realloc(ctx, &mem_586452, &mem_586452_cached_sizze_588745, dim_438949);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_580234 = 0; i_580234 < total_grid_no_438961; i_580234++) {
            for (int64_t i_586071 = 0; i_586071 < dim_438949; i_586071++) {
                int64_t eta_p_580237 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586071];
                int64_t eta_p_580238 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586071];
                bool defunc_0_f_res_580239;
                
                if (futrts_lifted_lambda_13275(ctx, &defunc_0_f_res_580239, i_580234, eta_p_580237, eta_p_580238) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_586452)[i_586071] = defunc_0_f_res_580239;
            }
            
            bool defunc_0_f_res_580240;
            bool acc_580242 = 0;
            
            for (int64_t i_580241 = 0; i_580241 < dim_438949; i_580241++) {
                bool b_580243 = ((bool *) mem_586452)[i_580241];
                bool defunc_0_f_res_580244 = acc_580242 || b_580243;
                bool acc_tmp_588024 = defunc_0_f_res_580244;
                
                acc_580242 = acc_tmp_588024;
            }
            defunc_0_f_res_580240 = acc_580242;
            if (!defunc_0_f_res_580240) {
                bool y_580246 = slt64(i_580234, dz2080U_438950);
                bool index_certs_580247;
                
                if (!y_580246) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_580234, "] out of bounds for array of shape [", (long long) dz2080U_438950, "].", "-> #0  ftSkyline.fut:292:46-76\n   #1  ftSkyline.fut:349:69-71\n   #2  ftSkyline.fut:952:33-56\n   #3  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_580249 = slt64(i_580234, (int64_t) 0);
                bool valid_580250 = !bounds_invalid_upwards_580249;
                bool range_valid_c_580251;
                
                if (!valid_580250) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_580234, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:293:44-50\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_584920;
                bool redout_586077 = 0;
                
                for (int64_t i_586078 = 0; i_586078 < i_580234; i_586078++) {
                    bool cond_582830 = i_586078 == i_580234;
                    bool cond_582831;
                    
                    if (cond_582830) {
                        cond_582831 = 1;
                    } else {
                        bool y_582833 = slt64(i_586078, total_grid_no_438961);
                        bool index_certs_582835;
                        
                        if (!y_582833) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586078, "] out of bounds for array of shape [", (long long) total_grid_no_438961, "].", "-> #0  ftSkyline.fut:295:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_582836 = ((int32_t *) mem_586433)[i_586078];
                        bool cond_f_res_582837 = zeze_lhs_582836 == 0;
                        
                        cond_582831 = cond_f_res_582837;
                    }
                    
                    bool defunc_0_f_res_582838;
                    
                    if (cond_582831) {
                        defunc_0_f_res_582838 = 0;
                    } else {
                        bool y_582840 = slt64(i_586078, dz2080U_438950);
                        bool index_certs_582842;
                        
                        if (!y_582840) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586078, "] out of bounds for array of shape [", (long long) dz2080U_438950, "].", "-> #0  ftSkyline.fut:297:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_586459_cached_sizze_588746 < dim_438949) {
                            err = lexical_realloc(ctx, &mem_586459, &mem_586459_cached_sizze_588746, dim_438949);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586075 = 0; i_586075 < dim_438949; i_586075++) {
                            float eta_p_582845 = ((float *) start_of_grid_partition_mem_586416.mem)[i_580234 * dim_438949 + i_586075];
                            float eta_p_582846 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586078 * dim_438949 + i_586075];
                            bool defunc_0_f_res_582847 = eta_p_582846 < eta_p_582845;
                            
                            ((bool *) mem_586459)[i_586075] = defunc_0_f_res_582847;
                        }
                        
                        bool defunc_0_foldl_res_582848;
                        bool acc_582850 = 1;
                        
                        for (int64_t i_582849 = 0; i_582849 < dim_438949; i_582849++) {
                            bool b_582851 = ((bool *) mem_586459)[i_582849];
                            bool x_582852 = acc_582850 && b_582851;
                            bool acc_tmp_588027 = x_582852;
                            
                            acc_582850 = acc_tmp_588027;
                        }
                        defunc_0_foldl_res_582848 = acc_582850;
                        defunc_0_f_res_582838 = defunc_0_foldl_res_582848;
                    }
                    
                    bool defunc_0_op_res_580285 = defunc_0_f_res_582838 || redout_586077;
                    bool redout_tmp_588025 = defunc_0_op_res_580285;
                    
                    redout_586077 = redout_tmp_588025;
                }
                defunc_0_reduce_res_584920 = redout_586077;
                ((bool *) mem_586448.mem)[i_580234] = defunc_0_reduce_res_584920;
            }
        }
        if (memblock_set(ctx, &ext_mem_586472, &mem_586448, "mem_586448") != 0)
            return 1;
    }
    
    bool index_certs_580295;
    
    if (!y_580188) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438950, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:302:72-76\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:349:69-71\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_586474_cached_sizze_588747 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586474, &mem_586474_cached_sizze_588747, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586476_cached_sizze_588748 < bytes_586424) {
        err = lexical_realloc(ctx, &mem_586476, &mem_586476_cached_sizze_588748, bytes_586424);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586484_cached_sizze_588749 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_586484, &mem_586484_cached_sizze_588749, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586091;
    int64_t scanacc_586085 = (int64_t) 0;
    
    for (int64_t i_586088 = 0; i_586088 < n_438953; i_586088++) {
        for (int64_t i_586081 = 0; i_586081 < dim_438949; i_586081++) {
            float eta_p_582935 = ((float *) xs_mem_586423.mem)[i_586088 * dim_438949 + i_586081];
            float eta_p_582936 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586081];
            float eta_p_582937 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586081];
            int64_t eta_p_582939 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586081];
            float defunc_0_f_res_582940 = eta_p_582935 - eta_p_582936;
            float defunc_0_f_res_582942 = defunc_0_f_res_582940 / eta_p_582937;
            int64_t f32_res_582944 = fptosi_f32_i64(defunc_0_f_res_582942);
            int64_t max_res_582946 = smax64((int64_t) 0, f32_res_582944);
            int64_t zm_lhs_582952 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586081];
            int64_t min_arg1_582953 = sub64(zm_lhs_582952, (int64_t) 1);
            int64_t min_res_582954 = smin64(max_res_582946, min_arg1_582953);
            int64_t defunc_0_f_res_582956 = mul64(eta_p_582939, min_res_582954);
            
            ((int64_t *) mem_586484)[i_586081] = defunc_0_f_res_582956;
        }
        
        int64_t defunc_0_foldl_res_582687;
        int64_t acc_582689 = (int64_t) 0;
        
        for (int64_t i_582688 = 0; i_582688 < dim_438949; i_582688++) {
            int64_t b_582690 = ((int64_t *) mem_586484)[i_582688];
            int64_t defunc_0_f_res_582691 = add64(acc_582689, b_582690);
            int64_t acc_tmp_588032 = defunc_0_f_res_582691;
            
            acc_582689 = acc_tmp_588032;
        }
        defunc_0_foldl_res_582687 = acc_582689;
        
        bool x_582693 = sle64((int64_t) 0, defunc_0_foldl_res_582687);
        bool y_582694 = slt64(defunc_0_foldl_res_582687, total_grid_no_438961);
        bool bounds_check_582695 = x_582693 && y_582694;
        bool index_certs_582696;
        
        if (!bounds_check_582695) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582687, "] out of bounds for array of shape [", (long long) total_grid_no_438961, "].", "-> #0  ftSkyline.fut:303:42-67\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:349:69-71\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582697 = ((bool *) ext_mem_586472.mem)[defunc_0_foldl_res_582687];
        bool lifted_lambda_res_582698 = !tmp_582697;
        int64_t defunc_0_f_res_582699 = btoi_bool_i64(lifted_lambda_res_582698);
        int64_t defunc_0_op_res_580349 = add64(defunc_0_f_res_582699, scanacc_586085);
        
        ((int64_t *) mem_586474)[i_586088] = defunc_0_op_res_580349;
        ((int64_t *) mem_586476)[i_586088] = defunc_0_f_res_582699;
        
        int64_t scanacc_tmp_588028 = defunc_0_op_res_580349;
        
        scanacc_586085 = scanacc_tmp_588028;
    }
    discard_586091 = scanacc_586085;
    if (memblock_unref(ctx, &ext_mem_586472, "ext_mem_586472") != 0)
        return 1;
    
    bool cond_580350 = n_438953 == (int64_t) 0;
    bool x_580351 = !cond_580350;
    int64_t tmp_580352 = sub64(n_438953, (int64_t) 1);
    bool x_580353 = sle64((int64_t) 0, tmp_580352);
    bool y_580354 = slt64(tmp_580352, n_438953);
    bool bounds_check_580355 = x_580353 && y_580354;
    bool protect_assert_disj_580356 = cond_580350 || bounds_check_580355;
    bool index_certs_580357;
    
    if (!protect_assert_disj_580356) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_580352, "] out of bounds for array of shape [", (long long) n_438953, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_580358;
    
    if (x_580351) {
        int64_t x_584924 = ((int64_t *) mem_586474)[tmp_580352];
        
        m_f_res_580358 = x_584924;
    } else {
        m_f_res_580358 = (int64_t) 0;
    }
    
    int64_t m_580360;
    
    if (cond_580350) {
        m_580360 = (int64_t) 0;
    } else {
        m_580360 = m_f_res_580358;
    }
    
    int64_t m_580370 = sub64(m_580360, (int64_t) 1);
    bool i_p_m_t_s_leq_w_580372 = slt64(m_580370, n_438953);
    bool zzero_leq_i_p_m_t_s_580371 = sle64((int64_t) 0, m_580370);
    bool y_580374 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_580372;
    bool i_lte_j_580373 = sle64((int64_t) 0, m_580360);
    bool forwards_ok_580375 = i_lte_j_580373 && y_580374;
    bool eq_x_zz_580367 = (int64_t) 0 == m_f_res_580358;
    bool p_and_eq_x_y_580368 = x_580351 && eq_x_zz_580367;
    bool empty_slice_580369 = cond_580350 || p_and_eq_x_y_580368;
    bool ok_or_empty_580376 = empty_slice_580369 || forwards_ok_580375;
    bool index_certs_580377;
    
    if (!ok_or_empty_580376) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_580360, "] out of bounds for array of shape [", (long long) n_438953, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:349:69-71\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_586497 = (int64_t) 4 * m_580360;
    int64_t bytes_586498 = dim_438949 * binop_x_586497;
    
    if (memblock_alloc(ctx, &mem_586499, bytes_586498, "mem_586499")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 2, (uint32_t *) mem_586499.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) xs_mem_586423.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {m_580360, dim_438949});
    
    int64_t bytes_586500 = (int64_t) 8 * m_580360;
    
    if (memblock_alloc(ctx, &mem_586501, bytes_586500, "mem_586501")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586501.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586425, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
    
    int64_t bytes_586509 = (int64_t) 4 * dim_438949;
    
    if (mem_586510_cached_sizze_588750 < bytes_586509) {
        err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_588750, bytes_586509);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586092 = 0; write_iter_586092 < n_438953; write_iter_586092++) {
        int64_t write_iv_586095 = ((int64_t *) mem_586476)[write_iter_586092];
        int64_t write_iv_586096 = ((int64_t *) mem_586474)[write_iter_586092];
        int64_t write_iv_586098 = ((int64_t *) mem_586425)[write_iter_586092];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586510, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) xs_mem_586423.mem, write_iter_586092 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
        
        bool cond_582643 = write_iv_586095 == (int64_t) 1;
        int64_t lifted_lambda_res_582644;
        
        if (cond_582643) {
            int64_t lifted_lambda_res_t_res_584925 = sub64(write_iv_586096, (int64_t) 1);
            
            lifted_lambda_res_582644 = lifted_lambda_res_t_res_584925;
        } else {
            lifted_lambda_res_582644 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582644) && slt64(lifted_lambda_res_582644, m_580360)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_438949 - (int64_t) 1, dim_438949))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586499.mem, lifted_lambda_res_582644 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586510, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582644) && slt64(lifted_lambda_res_582644, m_580360)) {
            ((int64_t *) mem_586501.mem)[lifted_lambda_res_582644] = write_iv_586098;
        }
    }
    
    bool cond_580409 = !use_measure_for_sorting_438974;
    bool y_581105 = slt64((int64_t) 0, dz2080U_438952);
    bool protect_assert_disj_582327 = cond_580409 || y_581105;
    bool index_certs_581106;
    
    if (!protect_assert_disj_582327) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582329 = assert_cond_580164 || cond_580409;
    bool empty_or_match_cert_581199;
    
    if (!protect_assert_disj_582329) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581230 = sle64(m_580360, (int64_t) 1);
    bool x_581231 = !cond_581230;
    int64_t zp_rhs_581233 = sdiv_safe64(m_580370, (int64_t) 20);
    int64_t min_num_blocks_581234 = add64((int64_t) 1, zp_rhs_581233);
    bool loop_cond_581235 = slt64((int64_t) 1, min_num_blocks_581234);
    bool x_582330;
    int64_t x_582331;
    bool loop_while_581238;
    int64_t x_581239;
    
    loop_while_581238 = loop_cond_581235;
    x_581239 = (int64_t) 1;
    while (loop_while_581238) {
        int64_t loopres_581240 = mul64((int64_t) 2, x_581239);
        bool loop_cond_581241 = slt64(loopres_581240, min_num_blocks_581234);
        bool loop_while_tmp_588035 = loop_cond_581241;
        int64_t x_tmp_588036 = loopres_581240;
        
        loop_while_581238 = loop_while_tmp_588035;
        x_581239 = x_tmp_588036;
    }
    x_582330 = loop_while_581238;
    x_582331 = x_581239;
    
    bool zzero_581242 = x_582331 == (int64_t) 0;
    bool nonzzero_581243 = !zzero_581242;
    bool protect_assert_disj_581244 = cond_581230 || nonzzero_581243;
    bool protect_assert_disj_582335 = cond_580409 || protect_assert_disj_581244;
    bool nonzzero_cert_581245;
    
    if (!protect_assert_disj_582335) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_581246 = sdiv_safe64(m_580370, x_582331);
    int64_t block_sizze_581247 = add64((int64_t) 1, zp_rhs_581246);
    bool y_581248 = slt64((int64_t) 0, m_580360);
    bool protect_assert_disj_581249 = cond_581230 || y_581248;
    bool protect_assert_disj_582337 = cond_580409 || protect_assert_disj_581249;
    bool index_certs_581250;
    
    if (!protect_assert_disj_582337) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582338 = use_measure_for_sorting_438974 && x_581231;
    int64_t reduce_arg1_581255;
    
    if (protect_cond_conj_582338) {
        int64_t x_584926 = ((int64_t *) mem_586501.mem)[(int64_t) 0];
        
        reduce_arg1_581255 = x_584926;
    } else {
        reduce_arg1_581255 = (int64_t) 0;
    }
    
    int64_t flat_dim_581257 = block_sizze_581247 * x_582331;
    int64_t greatest_divisor_leq_than_arg1_581262 = mul64((int64_t) 2, block_sizze_581247);
    int64_t merge_block_sizze_581263;
    
    if (protect_cond_conj_582338) {
        int64_t x_584927;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584927, (int64_t) 8, greatest_divisor_leq_than_arg1_581262) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_581263 = x_584927;
    } else {
        merge_block_sizze_581263 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_581292 = slt64(x_582331, (int64_t) 0);
    bool valid_581293 = !bounds_invalid_upwards_581292;
    bool protect_assert_disj_582319 = cond_581230 || valid_581293;
    bool protect_assert_disj_582341 = cond_580409 || protect_assert_disj_582319;
    bool range_valid_c_581294;
    
    if (!protect_assert_disj_582341) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582331, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:952:33-56\n   #7  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_581296 = slt64(block_sizze_581247, (int64_t) 0);
    bool valid_581297 = !bounds_invalid_upwards_581296;
    bool protect_assert_disj_582321 = cond_581230 || valid_581297;
    bool protect_assert_disj_582343 = cond_580409 || protect_assert_disj_582321;
    bool range_valid_c_581298;
    
    if (!protect_assert_disj_582343) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_581247, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581300 = sle64(block_sizze_581247, (int64_t) 1);
    int64_t tmp_581301 = sub64(block_sizze_581247, (int64_t) 2);
    bool bounds_invalid_upwards_581302 = slt64(tmp_581301, (int64_t) 0);
    int64_t distance_581303 = add64((int64_t) 1, tmp_581301);
    bool valid_581304 = !bounds_invalid_upwards_581302;
    bool protect_assert_disj_581305 = cond_581300 || valid_581304;
    bool protect_assert_disj_582323 = cond_581230 || protect_assert_disj_581305;
    bool protect_assert_disj_582345 = cond_580409 || protect_assert_disj_582323;
    bool range_valid_c_581306;
    
    if (!protect_assert_disj_582345) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_581301, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_581426 = slt64(block_sizze_581247, flat_dim_581257);
    bool zzero_581427 = merge_block_sizze_581263 == (int64_t) 0;
    bool nonzzero_581428 = !zzero_581427;
    bool protect_assert_disj_582290 = use_measure_for_sorting_438974 || y_581105;
    bool index_certs_580418;
    
    if (!protect_assert_disj_582290) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582292 = use_measure_for_sorting_438974 || assert_cond_580164;
    bool empty_or_match_cert_580502;
    
    if (!protect_assert_disj_582292) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582293;
    int64_t x_582294;
    bool loop_while_580538;
    int64_t x_580539;
    
    loop_while_580538 = loop_cond_581235;
    x_580539 = (int64_t) 1;
    while (loop_while_580538) {
        int64_t loopres_580540 = mul64((int64_t) 2, x_580539);
        bool loop_cond_580541 = slt64(loopres_580540, min_num_blocks_581234);
        bool loop_while_tmp_588037 = loop_cond_580541;
        int64_t x_tmp_588038 = loopres_580540;
        
        loop_while_580538 = loop_while_tmp_588037;
        x_580539 = x_tmp_588038;
    }
    x_582293 = loop_while_580538;
    x_582294 = x_580539;
    
    bool zzero_580542 = x_582294 == (int64_t) 0;
    bool nonzzero_580543 = !zzero_580542;
    bool protect_assert_disj_580544 = nonzzero_580543 || cond_581230;
    bool protect_assert_disj_582298 = use_measure_for_sorting_438974 || protect_assert_disj_580544;
    bool nonzzero_cert_580545;
    
    if (!protect_assert_disj_582298) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_580546 = sdiv_safe64(m_580370, x_582294);
    int64_t block_sizze_580547 = add64((int64_t) 1, zp_rhs_580546);
    bool protect_assert_disj_582300 = use_measure_for_sorting_438974 || protect_assert_disj_581249;
    bool index_certs_580550;
    
    if (!protect_assert_disj_582300) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582301 = cond_580409 && x_581231;
    int64_t reduce_arg1_580553;
    
    if (protect_cond_conj_582301) {
        int64_t x_584928 = ((int64_t *) mem_586501.mem)[(int64_t) 0];
        
        reduce_arg1_580553 = x_584928;
    } else {
        reduce_arg1_580553 = (int64_t) 0;
    }
    
    int64_t flat_dim_580555 = block_sizze_580547 * x_582294;
    int64_t greatest_divisor_leq_than_arg1_580559 = mul64((int64_t) 2, block_sizze_580547);
    int64_t merge_block_sizze_580560;
    
    if (protect_cond_conj_582301) {
        int64_t x_584929;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584929, (int64_t) 8, greatest_divisor_leq_than_arg1_580559) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_580560 = x_584929;
    } else {
        merge_block_sizze_580560 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_580578 = slt64(x_582294, (int64_t) 0);
    bool valid_580579 = !bounds_invalid_upwards_580578;
    bool protect_assert_disj_582282 = valid_580579 || cond_581230;
    bool protect_assert_disj_582304 = use_measure_for_sorting_438974 || protect_assert_disj_582282;
    bool range_valid_c_580580;
    
    if (!protect_assert_disj_582304) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582294, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_580582 = slt64(block_sizze_580547, (int64_t) 0);
    bool valid_580583 = !bounds_invalid_upwards_580582;
    bool protect_assert_disj_582284 = valid_580583 || cond_581230;
    bool protect_assert_disj_582306 = use_measure_for_sorting_438974 || protect_assert_disj_582284;
    bool range_valid_c_580584;
    
    if (!protect_assert_disj_582306) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_580547, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_580586 = sle64(block_sizze_580547, (int64_t) 1);
    int64_t tmp_580587 = sub64(block_sizze_580547, (int64_t) 2);
    bool bounds_invalid_upwards_580588 = slt64(tmp_580587, (int64_t) 0);
    int64_t distance_580589 = add64((int64_t) 1, tmp_580587);
    bool valid_580590 = !bounds_invalid_upwards_580588;
    bool protect_assert_disj_580591 = cond_580586 || valid_580590;
    bool protect_assert_disj_582286 = protect_assert_disj_580591 || cond_581230;
    bool protect_assert_disj_582308 = use_measure_for_sorting_438974 || protect_assert_disj_582286;
    bool range_valid_c_580592;
    
    if (!protect_assert_disj_582308) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_580587, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_580680 = slt64(block_sizze_580547, flat_dim_580555);
    bool zzero_580681 = merge_block_sizze_580560 == (int64_t) 0;
    bool nonzzero_580682 = !zzero_580681;
    int64_t bytes_586518 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951;
    int64_t bytes_586560 = (int64_t) 4 * arg_580163;
    int64_t bytes_586576 = (int64_t) 8 * arg_580163;
    int64_t binop_x_586601 = (int64_t) 8 * x_582331;
    int64_t bytes_586602 = block_sizze_581247 * binop_x_586601;
    int64_t binop_x_586604 = (int64_t) 4 * x_582331;
    int64_t bytes_586605 = block_sizze_581247 * binop_x_586604;
    int64_t bytes_586609 = dim_438949 * bytes_586605;
    int64_t lmad_arg_586631 = dim_438949 * block_sizze_581247;
    int64_t bytes_586632 = (int64_t) 8 * block_sizze_581247;
    int64_t bytes_586634 = (int64_t) 4 * block_sizze_581247;
    int64_t bytes_586637 = dim_438949 * bytes_586634;
    int64_t lmad_arg_586865 = dim_438949 * merge_block_sizze_581263;
    int64_t binop_x_587129 = (int64_t) 8 * x_582294;
    int64_t bytes_587130 = block_sizze_580547 * binop_x_587129;
    int64_t binop_x_587132 = (int64_t) 4 * x_582294;
    int64_t binop_x_587133 = block_sizze_580547 * binop_x_587132;
    int64_t bytes_587134 = dim_438949 * binop_x_587133;
    int64_t lmad_arg_587152 = dim_438949 * block_sizze_580547;
    int64_t bytes_587153 = (int64_t) 8 * block_sizze_580547;
    int64_t binop_x_587155 = (int64_t) 4 * block_sizze_580547;
    int64_t bytes_587156 = dim_438949 * binop_x_587155;
    int64_t lmad_arg_587338 = dim_438949 * merge_block_sizze_580560;
    
    if (cond_580409) {
        if (mem_587063_cached_sizze_588780 < bytes_586518) {
            err = lexical_realloc(ctx, &mem_587063, &mem_587063_cached_sizze_588780, bytes_586518);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586103 = 0; i_586103 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951; i_586103++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_585120 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586103];
            float i64_res_585121 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_585120);
            float defunc_0_fover_res_585122 = 1.5707964F / i64_res_585121;
            
            ((float *) mem_587063)[i_586103] = defunc_0_fover_res_585122;
        }
        if (mem_587071_cached_sizze_588781 < bytes_586500) {
            err = lexical_realloc(ctx, &mem_587071, &mem_587071_cached_sizze_588781, bytes_586500);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587076_cached_sizze_588782 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_587076, &mem_587076_cached_sizze_588782, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587084_cached_sizze_588783 < bytes_586509) {
            err = lexical_realloc(ctx, &mem_587084, &mem_587084_cached_sizze_588783, bytes_586509);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587092_cached_sizze_588784 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_587092, &mem_587092_cached_sizze_588784, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587108_cached_sizze_588786 < bytes_586576) {
            err = lexical_realloc(ctx, &mem_587108, &mem_587108_cached_sizze_588786, bytes_586576);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586123 = 0; i_586123 < m_580360; i_586123++) {
            for (int64_t i_586107 = 0; i_586107 < dim_438949; i_586107++) {
                float eta_p_585129 = ((float *) mem_586499.mem)[i_586123 * dim_438949 + i_586107];
                float eta_p_585130 = ((float *) start_of_grid_partition_mem_586422.mem)[i_586107];
                float eta_p_585131 = ((float *) grid_part_sizze_per_dim_mem_586420.mem)[i_586107];
                int64_t eta_p_585133 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586107];
                float defunc_0_f_res_585134 = eta_p_585129 - eta_p_585130;
                float defunc_0_f_res_585135 = defunc_0_f_res_585134 / eta_p_585131;
                int64_t f32_res_585136 = fptosi_f32_i64(defunc_0_f_res_585135);
                int64_t max_res_585137 = smax64((int64_t) 0, f32_res_585136);
                int64_t zm_lhs_585142 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586107];
                int64_t min_arg1_585143 = sub64(zm_lhs_585142, (int64_t) 1);
                int64_t min_res_585144 = smin64(max_res_585137, min_arg1_585143);
                int64_t defunc_0_f_res_585145 = mul64(eta_p_585133, min_res_585144);
                
                ((int64_t *) mem_587076)[i_586107] = defunc_0_f_res_585145;
            }
            
            int64_t defunc_0_foldl_res_585147;
            int64_t acc_585149 = (int64_t) 0;
            
            for (int64_t i_585148 = 0; i_585148 < dim_438949; i_585148++) {
                int64_t b_585150 = ((int64_t *) mem_587076)[i_585148];
                int64_t defunc_0_f_res_585151 = add64(acc_585149, b_585150);
                int64_t acc_tmp_588042 = defunc_0_f_res_585151;
                
                acc_585149 = acc_tmp_588042;
            }
            defunc_0_foldl_res_585147 = acc_585149;
            
            bool x_585152 = sle64((int64_t) 0, defunc_0_foldl_res_585147);
            bool y_585153 = slt64(defunc_0_foldl_res_585147, dz2080U_438952);
            bool bounds_check_585154 = x_585152 && y_585153;
            bool index_certs_585155;
            
            if (!bounds_check_585154) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_585147, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586111 = 0; i_586111 < dim_438949; i_586111++) {
                float eta_p_585158 = ((float *) mem_586499.mem)[i_586123 * dim_438949 + i_586111];
                float eta_p_585159 = ((float *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_585147 * dim_438949 + i_586111];
                float defunc_0_f_res_585160 = eta_p_585158 - eta_p_585159;
                
                ((float *) mem_587084)[i_586111] = defunc_0_f_res_585160;
            }
            for (int64_t nest_i_588044 = 0; nest_i_588044 < arg_580163; nest_i_588044++) {
                ((float *) mem_587092)[nest_i_588044] = 0.0F;
            }
            for (int64_t i_585164 = 0; i_585164 < arg_580163; i_585164++) {
                bool y_585166 = slt64(i_585164, dim_438949);
                bool index_certs_585167;
                
                if (!y_585166) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585164, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_585169 = add64((int64_t) 1, i_585164);
                int64_t j_m_i_585170 = sub64(dim_438949, map_arg1_585169);
                bool empty_slice_585171 = j_m_i_585170 == (int64_t) 0;
                int64_t m_585172 = sub64(j_m_i_585170, (int64_t) 1);
                int64_t i_p_m_t_s_585173 = add64(map_arg1_585169, m_585172);
                bool zzero_leq_i_p_m_t_s_585174 = sle64((int64_t) 0, i_p_m_t_s_585173);
                bool i_p_m_t_s_leq_w_585175 = slt64(i_p_m_t_s_585173, dim_438949);
                bool zzero_lte_i_585176 = sle64((int64_t) 0, map_arg1_585169);
                bool i_lte_j_585177 = sle64(map_arg1_585169, dim_438949);
                bool y_585178 = i_p_m_t_s_leq_w_585175 && zzero_lte_i_585176;
                bool y_585179 = zzero_leq_i_p_m_t_s_585174 && y_585178;
                bool forwards_ok_585180 = i_lte_j_585177 && y_585179;
                bool ok_or_empty_585181 = empty_slice_585171 || forwards_ok_585180;
                bool index_certs_585182;
                
                if (!ok_or_empty_585181) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_585169, ":", (long long) dim_438949, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587096 = (int64_t) 4 * j_m_i_585170;
                float this_x_585168 = ((float *) mem_587084)[i_585164];
                
                if (mem_587097_cached_sizze_588785 < bytes_587096) {
                    err = lexical_realloc(ctx, &mem_587097, &mem_587097_cached_sizze_588785, bytes_587096);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586115 = 0; i_586115 < j_m_i_585170; i_586115++) {
                    int64_t slice_586383 = map_arg1_585169 + i_586115;
                    float eta_p_585185 = ((float *) mem_587084)[slice_586383];
                    float defunc_0_ftimes_res_585186 = eta_p_585185 * eta_p_585185;
                    
                    ((float *) mem_587097)[i_586115] = defunc_0_ftimes_res_585186;
                }
                
                float defunc_0_foldl_res_585188;
                float acc_585190 = 0.0F;
                
                for (int64_t i_585189 = 0; i_585189 < j_m_i_585170; i_585189++) {
                    float b_585191 = ((float *) mem_587097)[i_585189];
                    float defunc_0_f_res_585192 = acc_585190 + b_585191;
                    float acc_tmp_588047 = defunc_0_f_res_585192;
                    
                    acc_585190 = acc_tmp_588047;
                }
                defunc_0_foldl_res_585188 = acc_585190;
                
                float sqrt_res_585193 = futrts_sqrt32(defunc_0_foldl_res_585188);
                float atan2_res_585194 = futrts_atan2_32(sqrt_res_585193, this_x_585168);
                
                ((float *) mem_587092)[i_585164] = atan2_res_585194;
            }
            for (int64_t i_586119 = 0; i_586119 < arg_580163; i_586119++) {
                float eta_p_585197 = ((float *) mem_587092)[i_586119];
                float eta_p_585198 = ((float *) mem_587063)[i_586119];
                int64_t eta_p_585199 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586119];
                int64_t eta_p_585200 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586119];
                float i64_res_585201 = sitofp_i64_f32(eta_p_585199);
                float defunc_0_fover_res_585202 = eta_p_585197 / eta_p_585198;
                float defunc_0_ftimes_res_585203 = i64_res_585201 * defunc_0_fover_res_585202;
                int64_t f32_res_585204 = fptosi_f32_i64(defunc_0_ftimes_res_585203);
                bool cond_585205 = slt64(f32_res_585204, (int64_t) 0);
                int64_t defunc_0_f_res_585206;
                
                if (cond_585205) {
                    defunc_0_f_res_585206 = (int64_t) 0;
                } else {
                    bool cond_585207 = sle64(eta_p_585200, f32_res_585204);
                    int64_t defunc_0_f_res_f_res_585208;
                    
                    if (cond_585207) {
                        int64_t defunc_0_f_res_f_res_t_res_585209 = sub64(eta_p_585200, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_585208 = defunc_0_f_res_f_res_t_res_585209;
                    } else {
                        defunc_0_f_res_f_res_585208 = f32_res_585204;
                    }
                    defunc_0_f_res_585206 = defunc_0_f_res_f_res_585208;
                }
                ((int64_t *) mem_587108)[i_586119] = defunc_0_f_res_585206;
            }
            
            int64_t defunc_0_foldl_res_585211;
            int64_t acc_585213 = (int64_t) 0;
            
            for (int64_t i_585212 = 0; i_585212 < arg_580163; i_585212++) {
                int64_t b_585214 = ((int64_t *) mem_587108)[i_585212];
                int64_t defunc_0_f_res_585215 = add64(acc_585213, b_585214);
                int64_t acc_tmp_588049 = defunc_0_f_res_585215;
                
                acc_585213 = acc_tmp_588049;
            }
            defunc_0_foldl_res_585211 = acc_585213;
            
            int64_t zp_lhs_585216 = mul64(total_angle_no_438969, defunc_0_foldl_res_585147);
            int64_t get_id_from_grid_angle_res_585217 = add64(defunc_0_foldl_res_585211, zp_lhs_585216);
            
            ((int64_t *) mem_587071)[i_586123] = get_id_from_grid_angle_res_585217;
        }
        
        int64_t reduce_arg1_585220;
        
        if (x_581231) {
            int64_t x_585221 = ((int64_t *) mem_587071)[(int64_t) 0];
            
            reduce_arg1_585220 = x_585221;
        } else {
            reduce_arg1_585220 = (int64_t) 0;
        }
        if (cond_581230) {
            if (memblock_set(ctx, &ext_mem_587491, &mem_586499, "mem_586499") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587487, &mem_586501, "mem_586501") != 0)
                return 1;
        } else {
            int64_t ext_587127;
            int64_t defunc_0_reduce_res_585225;
            int64_t defunc_0_reduce_res_585227;
            int64_t redout_586125;
            int64_t redout_586127;
            int64_t ctx_param_ext_587118;
            
            if (memblock_set(ctx, &mem_param_587120, &mem_586499, "mem_586499") != 0)
                return 1;
            ctx_param_ext_587118 = (int64_t) 0;
            redout_586125 = reduce_arg1_585220;
            redout_586127 = reduce_arg1_580553;
            for (int64_t i_586128 = 0; i_586128 < m_580360; i_586128++) {
                int64_t x_585228 = ((int64_t *) mem_587071)[i_586128];
                int64_t x_585230 = ((int64_t *) mem_586501.mem)[i_586128];
                bool lifted_lambda_res_585237 = sle64(redout_586125, x_585228);
                int64_t defunc_0_op_res_585238;
                
                if (lifted_lambda_res_585237) {
                    defunc_0_op_res_585238 = x_585228;
                } else {
                    defunc_0_op_res_585238 = redout_586125;
                }
                
                int64_t defunc_0_op_res_585239;
                
                if (lifted_lambda_res_585237) {
                    defunc_0_op_res_585239 = x_585230;
                } else {
                    defunc_0_op_res_585239 = redout_586127;
                }
                
                int64_t binop_y_587121 = dim_438949 * i_586128;
                int64_t ext_587124;
                
                if (lifted_lambda_res_585237) {
                    ext_587124 = binop_y_587121;
                } else {
                    ext_587124 = ctx_param_ext_587118;
                }
                if (lifted_lambda_res_585237) {
                    if (memblock_set(ctx, &ext_mem_587125, &mem_586499, "mem_586499") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587125, &mem_param_587120, "mem_param_587120") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588050, &ext_mem_587125, "ext_mem_587125") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588051 = ext_587124;
                int64_t redout_tmp_588052 = defunc_0_op_res_585238;
                int64_t redout_tmp_588054 = defunc_0_op_res_585239;
                
                if (memblock_set(ctx, &mem_param_587120, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
                    return 1;
                ctx_param_ext_587118 = ctx_param_ext_tmp_588051;
                redout_586125 = redout_tmp_588052;
                redout_586127 = redout_tmp_588054;
            }
            if (memblock_set(ctx, &ext_mem_587128, &mem_param_587120, "mem_param_587120") != 0)
                return 1;
            ext_587127 = ctx_param_ext_587118;
            defunc_0_reduce_res_585225 = redout_586125;
            defunc_0_reduce_res_585227 = redout_586127;
            if (mem_587131_cached_sizze_588787 < bytes_587130) {
                err = lexical_realloc(ctx, &mem_587131, &mem_587131_cached_sizze_588787, bytes_587130);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587135_cached_sizze_588788 < bytes_587134) {
                err = lexical_realloc(ctx, &mem_587135, &mem_587135_cached_sizze_588788, bytes_587134);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587138_cached_sizze_588789 < bytes_587130) {
                err = lexical_realloc(ctx, &mem_587138, &mem_587138_cached_sizze_588789, bytes_587130);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587154_cached_sizze_588790 < bytes_587153) {
                err = lexical_realloc(ctx, &mem_587154, &mem_587154_cached_sizze_588790, bytes_587153);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587157_cached_sizze_588791 < bytes_587156) {
                err = lexical_realloc(ctx, &mem_587157, &mem_587157_cached_sizze_588791, bytes_587156);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587159_cached_sizze_588792 < bytes_587153) {
                err = lexical_realloc(ctx, &mem_587159, &mem_587159_cached_sizze_588792, bytes_587153);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586145 = 0; i_586145 < x_582294; i_586145++) {
                int64_t zp_lhs_585256 = mul64(block_sizze_580547, i_586145);
                
                for (int64_t i_586135 = 0; i_586135 < block_sizze_580547; i_586135++) {
                    int64_t k_585261 = add64(zp_lhs_585256, i_586135);
                    bool cond_585262 = slt64(k_585261, m_580360);
                    int64_t binop_y_587170 = dim_438949 * k_585261;
                    int64_t ext_587173;
                    
                    if (cond_585262) {
                        ext_587173 = binop_y_587170;
                    } else {
                        ext_587173 = ext_587127;
                    }
                    
                    int64_t lifted_lambda_res_585263;
                    int64_t lifted_lambda_res_585265;
                    
                    if (cond_585262) {
                        bool x_585266 = sle64((int64_t) 0, k_585261);
                        bool bounds_check_585267 = cond_585262 && x_585266;
                        bool index_certs_585268;
                        
                        if (!bounds_check_585267) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_585261, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585269 = ((int64_t *) mem_587071)[k_585261];
                        int64_t lifted_lambda_res_t_res_585271 = ((int64_t *) mem_586501.mem)[k_585261];
                        
                        if (memblock_set(ctx, &ext_mem_587174, &mem_586499, "mem_586499") != 0)
                            return 1;
                        lifted_lambda_res_585263 = lifted_lambda_res_t_res_585269;
                        lifted_lambda_res_585265 = lifted_lambda_res_t_res_585271;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587174, &ext_mem_587128, "ext_mem_587128") != 0)
                            return 1;
                        lifted_lambda_res_585263 = defunc_0_reduce_res_585225;
                        lifted_lambda_res_585265 = defunc_0_reduce_res_585227;
                    }
                    ((int64_t *) mem_587154)[i_586135] = lifted_lambda_res_585263;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_587157, i_586135 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587174.mem, ext_587173, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                    if (memblock_unref(ctx, &ext_mem_587174, "ext_mem_587174") != 0)
                        return 1;
                    ((int64_t *) mem_587159)[i_586135] = lifted_lambda_res_585265;
                }
                if (!cond_580586) {
                    if (mem_587206_cached_sizze_588793 < bytes_586509) {
                        err = lexical_realloc(ctx, &mem_587206, &mem_587206_cached_sizze_588793, bytes_586509);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587208_cached_sizze_588794 < bytes_586509) {
                        err = lexical_realloc(ctx, &mem_587208, &mem_587208_cached_sizze_588794, bytes_586509);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_585281 = 0; i_585281 < distance_580589; i_585281++) {
                        int64_t gt_arg1_585285 = add64((int64_t) 1, i_585281);
                        bool x_585286 = sle64((int64_t) 0, gt_arg1_585285);
                        bool y_585287 = slt64(gt_arg1_585285, block_sizze_580547);
                        bool bounds_check_585288 = x_585286 && y_585287;
                        bool index_certs_585289;
                        
                        if (!bounds_check_585288) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_585285, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_585291 = slt64(i_585281, block_sizze_580547);
                        bool index_certs_585292;
                        
                        if (!y_585291) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585281, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_585290 = ((int64_t *) mem_587154)[gt_arg1_585285];
                        int64_t gt_arg0_585293 = ((int64_t *) mem_587154)[i_585281];
                        bool lifted_lambda_res_585294 = sle64(gt_arg0_585293, gt_arg1_585290);
                        bool defunc_0_lifted_gt_res_585295 = !lifted_lambda_res_585294;
                        bool s_585296;
                        int64_t s_585300;
                        bool loop_while_585301;
                        int64_t j_585305;
                        
                        loop_while_585301 = defunc_0_lifted_gt_res_585295;
                        j_585305 = i_585281;
                        while (loop_while_585301) {
                            bool x_585306 = sle64((int64_t) 0, j_585305);
                            bool y_585307 = slt64(j_585305, block_sizze_580547);
                            bool bounds_check_585308 = x_585306 && y_585307;
                            bool index_certs_585309;
                            
                            if (!bounds_check_585308) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585305, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585314 = add64((int64_t) 1, j_585305);
                            bool x_585315 = sle64((int64_t) 0, copy_arg0_585314);
                            bool y_585316 = slt64(copy_arg0_585314, block_sizze_580547);
                            bool bounds_check_585317 = x_585315 && y_585316;
                            bool index_certs_585318;
                            
                            if (!bounds_check_585317) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_585314, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585310 = ((int64_t *) mem_587154)[j_585305];
                            int64_t copy_arg0_585312 = ((int64_t *) mem_587159)[j_585305];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587206, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587157, (int64_t) 0 + j_585305 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            
                            int64_t copy_arg0_585319 = ((int64_t *) mem_587154)[copy_arg0_585314];
                            int64_t copy_arg0_585321 = ((int64_t *) mem_587159)[copy_arg0_585314];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587208, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587157, (int64_t) 0 + copy_arg0_585314 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_587154)[j_585305] = copy_arg0_585319;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587157, j_585305 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587208, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_587159)[j_585305] = copy_arg0_585321;
                            ((int64_t *) mem_587154)[copy_arg0_585314] = copy_arg0_585310;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587157, copy_arg0_585314 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587206, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_587159)[copy_arg0_585314] = copy_arg0_585312;
                            
                            int64_t tmp_585329 = sub64(j_585305, (int64_t) 1);
                            bool cond_585330 = sle64((int64_t) 0, tmp_585329);
                            bool loop_cond_585331;
                            
                            if (cond_585330) {
                                bool y_585333 = slt64(tmp_585329, block_sizze_580547);
                                bool bounds_check_585334 = cond_585330 && y_585333;
                                bool index_certs_585335;
                                
                                if (!bounds_check_585334) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585329, "] out of bounds for array of shape [", (long long) block_sizze_580547, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585332 = ((int64_t *) mem_587154)[j_585305];
                                int64_t gt_arg0_585336 = ((int64_t *) mem_587154)[tmp_585329];
                                bool lifted_lambda_res_585337 = sle64(gt_arg0_585336, gt_arg1_585332);
                                bool defunc_0_lifted_gt_res_585338 = !lifted_lambda_res_585337;
                                
                                loop_cond_585331 = defunc_0_lifted_gt_res_585338;
                            } else {
                                loop_cond_585331 = 0;
                            }
                            
                            bool loop_while_tmp_588064 = loop_cond_585331;
                            int64_t j_tmp_588068 = tmp_585329;
                            
                            loop_while_585301 = loop_while_tmp_588064;
                            j_585305 = j_tmp_588068;
                        }
                        s_585296 = loop_while_585301;
                        s_585300 = j_585305;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587131, i_586145 * block_sizze_580547, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587154, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580547});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_587135, i_586145 * lmad_arg_587152, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) mem_587157, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {block_sizze_580547, dim_438949});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587138, i_586145 * block_sizze_580547, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587159, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580547});
            }
            if (memblock_unref(ctx, &ext_mem_587128, "ext_mem_587128") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587254, bytes_587130, "mem_587254")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587254.mem, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (uint64_t *) mem_587131, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547});
            if (memblock_alloc(ctx, &mem_587259, bytes_587134, "mem_587259")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_587259.mem, (int64_t) 0, (int64_t []) {dim_438949 * block_sizze_580547, dim_438949, (int64_t) 1}, (uint32_t *) mem_587135, (int64_t) 0, (int64_t []) {lmad_arg_587152, dim_438949, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547, dim_438949});
            if (memblock_alloc(ctx, &mem_587263, bytes_587130, "mem_587263")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587263.mem, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (uint64_t *) mem_587138, (int64_t) 0, (int64_t []) {block_sizze_580547, (int64_t) 1}, (int64_t []) {x_582294, block_sizze_580547});
            
            int64_t data_585351;
            bool data_585352;
            int64_t data_585356;
            int64_t loop_dz2084Uz2082U_585357;
            bool loop_while_585358;
            int64_t stride_585362;
            
            if (memblock_set(ctx, &mem_param_587267, &mem_587254, "mem_587254") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587271, &mem_587259, "mem_587259") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587274, &mem_587263, "mem_587263") != 0)
                return 1;
            loop_dz2084Uz2082U_585357 = flat_dim_580555;
            loop_while_585358 = loop_cond_580680;
            stride_585362 = block_sizze_580547;
            while (loop_while_585358) {
                int64_t next_stride_585363 = mul64((int64_t) 2, stride_585362);
                bool zzero_585364 = next_stride_585363 == (int64_t) 0;
                bool nonzzero_585365 = !zzero_585364;
                bool nonzzero_cert_585366;
                
                if (!nonzzero_585365) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585367 = sdiv64(flat_dim_580555, next_stride_585363);
                bool bounds_invalid_upwards_585368 = slt64(num_merges_585367, (int64_t) 0);
                bool valid_585369 = !bounds_invalid_upwards_585368;
                bool range_valid_c_585370;
                
                if (!valid_585369) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585367, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585372 = sub64(next_stride_585363, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585373 = sle64((int64_t) 0, m_585372);
                bool cond_585375 = slt64(next_stride_585363, (int64_t) 10);
                bool protect_assert_disj_585376 = nonzzero_580682 || cond_585375;
                bool nonzzero_cert_585377;
                
                if (!protect_assert_disj_585376) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585378 = smod_safe64(next_stride_585363, merge_block_sizze_580560);
                bool num_blocks_585379 = zeze_lhs_585378 == (int64_t) 0;
                bool protect_assert_disj_585380 = cond_585375 || num_blocks_585379;
                bool assert_c_585381;
                
                if (!protect_assert_disj_585380) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585382 = sdiv_safe64(next_stride_585363, merge_block_sizze_580560);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383 = add64((int64_t) 1, num_blocks_585382);
                int64_t j_m_i_585384 = sub64(next_stride_585363, stride_585362);
                int64_t flat_dim_585385 = merge_block_sizze_580560 * num_blocks_585382;
                bool bounds_invalid_upwards_585386 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, (int64_t) 0);
                bool empty_slice_585387 = j_m_i_585384 == (int64_t) 0;
                int64_t m_585388 = sub64(j_m_i_585384, (int64_t) 1);
                bool zzero_lte_i_585389 = sle64((int64_t) 0, stride_585362);
                bool i_lte_j_585390 = sle64(stride_585362, next_stride_585363);
                bool empty_slice_585391 = stride_585362 == (int64_t) 0;
                int64_t m_585392 = sub64(stride_585362, (int64_t) 1);
                bool bounds_invalid_upwards_585393 = slt64(num_blocks_585382, (int64_t) 0);
                bool cond_585394 = slt64((int64_t) 0, stride_585362);
                bool valid_585395 = !bounds_invalid_upwards_585386;
                int64_t i_p_m_t_s_585396 = add64(stride_585362, m_585388);
                bool zzero_leq_i_p_m_t_s_585397 = sle64((int64_t) 0, m_585392);
                bool i_p_m_t_s_leq_w_585398 = slt64(m_585392, next_stride_585363);
                bool valid_585399 = !bounds_invalid_upwards_585393;
                bool i_p_m_t_s_leq_w_585400 = slt64(m_585372, flat_dim_585385);
                bool y_585401 = slt64((int64_t) 0, j_m_i_585384);
                bool protect_assert_disj_585402 = cond_585375 || valid_585395;
                bool range_valid_c_585403;
                
                if (!protect_assert_disj_585402) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585404 = sle64((int64_t) 0, i_p_m_t_s_585396);
                bool i_p_m_t_s_leq_w_585405 = slt64(i_p_m_t_s_585396, next_stride_585363);
                bool y_585406 = zzero_leq_i_p_m_t_s_585397 && i_p_m_t_s_leq_w_585398;
                bool protect_assert_disj_585407 = cond_585375 || valid_585399;
                bool range_valid_c_585408;
                
                if (!protect_assert_disj_585407) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585382, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585409 = zzero_leq_i_p_m_t_s_585373 && i_p_m_t_s_leq_w_585400;
                bool y_585410 = zzero_lte_i_585389 && i_p_m_t_s_leq_w_585405;
                bool forwards_ok_585411 = zzero_lte_i_585389 && y_585406;
                bool ok_or_empty_585412 = zzero_585364 || y_585409;
                bool protect_assert_disj_585413 = cond_585394 || y_585401;
                bool y_585414 = zzero_leq_i_p_m_t_s_585404 && y_585410;
                bool ok_or_empty_585415 = empty_slice_585391 || forwards_ok_585411;
                bool protect_assert_disj_585416 = cond_585375 || ok_or_empty_585412;
                bool index_certs_585417;
                
                if (!protect_assert_disj_585416) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585363, "] out of bounds for array of shape [", (long long) flat_dim_585385, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585418 = !cond_585375;
                bool protect_assert_disj_585419 = protect_assert_disj_585413 || loop_not_taken_585418;
                bool index_certs_585420;
                
                if (!protect_assert_disj_585419) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585421 = i_lte_j_585390 && y_585414;
                bool protect_assert_disj_585422 = cond_585375 || ok_or_empty_585415;
                bool index_certs_585423;
                
                if (!protect_assert_disj_585422) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585362, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585424 = ok_or_empty_585415 || loop_not_taken_585418;
                bool index_certs_585425;
                
                if (!protect_assert_disj_585424) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585362, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585426 = empty_slice_585387 || forwards_ok_585421;
                bool protect_assert_disj_585427 = cond_585375 || ok_or_empty_585426;
                bool index_certs_585428;
                
                if (!protect_assert_disj_585427) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585362, ":] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585429 = loop_not_taken_585418 || ok_or_empty_585426;
                bool index_certs_585430;
                
                if (!protect_assert_disj_585429) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585362, ":] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587275 = (int64_t) 8 * num_merges_585367;
                int64_t bytes_587276 = next_stride_585363 * binop_x_587275;
                int64_t binop_x_587278 = (int64_t) 4 * num_merges_585367;
                int64_t binop_x_587279 = next_stride_585363 * binop_x_587278;
                int64_t bytes_587280 = dim_438949 * binop_x_587279;
                bool i_lte_j_585374 = sle64((int64_t) 0, next_stride_585363);
                
                if (mem_587277_cached_sizze_588795 < bytes_587276) {
                    err = lexical_realloc(ctx, &mem_587277, &mem_587277_cached_sizze_588795, bytes_587276);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587281_cached_sizze_588796 < bytes_587280) {
                    err = lexical_realloc(ctx, &mem_587281, &mem_587281_cached_sizze_588796, bytes_587280);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587284_cached_sizze_588797 < bytes_587276) {
                    err = lexical_realloc(ctx, &mem_587284, &mem_587284_cached_sizze_588797, bytes_587276);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587298 = dim_438949 * next_stride_585363;
                int64_t bytes_587299 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383;
                int64_t binop_x_587315 = (int64_t) 8 * num_blocks_585382;
                int64_t bytes_587316 = merge_block_sizze_580560 * binop_x_587315;
                int64_t binop_x_587318 = (int64_t) 4 * num_blocks_585382;
                int64_t binop_x_587319 = merge_block_sizze_580560 * binop_x_587318;
                int64_t bytes_587320 = dim_438949 * binop_x_587319;
                int64_t bytes_587407 = (int64_t) 16 * stride_585362;
                int64_t binop_x_587411 = (int64_t) 8 * stride_585362;
                int64_t bytes_587412 = dim_438949 * binop_x_587411;
                
                for (int64_t i_586172 = 0; i_586172 < num_merges_585367; i_586172++) {
                    int64_t start_585435 = mul64(next_stride_585363, i_586172);
                    int64_t j_m_i_585436 = sub64(loop_dz2084Uz2082U_585357, start_585435);
                    bool empty_slice_585437 = j_m_i_585436 == (int64_t) 0;
                    int64_t m_585438 = sub64(j_m_i_585436, (int64_t) 1);
                    int64_t i_p_m_t_s_585439 = add64(start_585435, m_585438);
                    bool zzero_leq_i_p_m_t_s_585440 = sle64((int64_t) 0, i_p_m_t_s_585439);
                    bool i_p_m_t_s_leq_w_585441 = slt64(i_p_m_t_s_585439, loop_dz2084Uz2082U_585357);
                    bool zzero_lte_i_585442 = sle64((int64_t) 0, start_585435);
                    bool i_lte_j_585443 = sle64(start_585435, loop_dz2084Uz2082U_585357);
                    bool y_585444 = i_p_m_t_s_leq_w_585441 && zzero_lte_i_585442;
                    bool y_585445 = zzero_leq_i_p_m_t_s_585440 && y_585444;
                    bool forwards_ok_585446 = i_lte_j_585443 && y_585445;
                    bool ok_or_empty_585447 = empty_slice_585437 || forwards_ok_585446;
                    bool index_certs_585448;
                    
                    if (!ok_or_empty_585447) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585435, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585357, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585449 = slt64(m_585372, j_m_i_585436);
                    bool y_585450 = zzero_leq_i_p_m_t_s_585373 && i_p_m_t_s_leq_w_585449;
                    bool forwards_ok_585451 = i_lte_j_585374 && y_585450;
                    bool ok_or_empty_585452 = zzero_585364 || forwards_ok_585451;
                    bool index_certs_585453;
                    
                    if (!ok_or_empty_585452) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585363, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:351:58-85\n   #7  ftSkyline.fut:952:33-56\n   #8  ftSkyline.fut:939:17-952:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585463 = stride_585362 + start_585435;
                    int64_t binop_y_587402 = dim_438949 * slice_585463;
                    int64_t binop_y_587404 = dim_438949 * start_585435;
                    int64_t ext_587406;
                    
                    if (cond_585394) {
                        ext_587406 = binop_y_587404;
                    } else {
                        ext_587406 = binop_y_587402;
                    }
                    if (cond_585375) {
                        int64_t dummy_585457;
                        int64_t dummy_585459;
                        
                        if (cond_585394) {
                            int64_t head_res_585460 = ((int64_t *) mem_param_587267.mem)[start_585435];
                            int64_t head_res_585462 = ((int64_t *) mem_param_587274.mem)[start_585435];
                            
                            dummy_585457 = head_res_585460;
                            dummy_585459 = head_res_585462;
                        } else {
                            int64_t head_res_585464 = ((int64_t *) mem_param_587267.mem)[slice_585463];
                            int64_t head_res_585466 = ((int64_t *) mem_param_587274.mem)[slice_585463];
                            
                            dummy_585457 = head_res_585464;
                            dummy_585459 = head_res_585466;
                        }
                        if (memblock_alloc(ctx, &mem_587408, bytes_587407, "mem_587408")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588081 = 0; nest_i_588081 < next_stride_585363; nest_i_588081++) {
                            ((int64_t *) mem_587408.mem)[nest_i_588081] = dummy_585457;
                        }
                        if (memblock_alloc(ctx, &mem_587410, bytes_587407, "mem_587410")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588082 = 0; nest_i_588082 < next_stride_585363; nest_i_588082++) {
                            ((int64_t *) mem_587410.mem)[nest_i_588082] = dummy_585459;
                        }
                        if (memblock_alloc(ctx, &mem_587413, bytes_587412, "mem_587413")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588083 = 0; nest_i_588083 < next_stride_585363; nest_i_588083++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587413.mem, nest_i_588083 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587271.mem, ext_587406, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                        }
                        
                        int64_t data_585470;
                        int64_t i_585475 = (int64_t) 0;
                        
                        for (int64_t k_585474 = 0; k_585474 < next_stride_585363; k_585474++) {
                            int64_t j_585479 = sub64(k_585474, i_585475);
                            bool cond_585480 = j_585479 == j_m_i_585384;
                            bool x_587787 = !cond_585480;
                            bool cond_585482 = slt64(i_585475, stride_585362);
                            bool x_585484 = sle64((int64_t) 0, j_585479);
                            bool y_585485 = slt64(j_585479, j_m_i_585384);
                            bool bounds_check_585486 = x_585484 && y_585485;
                            bool loop_not_taken_587779 = !cond_585482;
                            bool protect_assert_disj_587780 = bounds_check_585486 || loop_not_taken_587779;
                            bool protect_assert_disj_587790 = cond_585480 || protect_assert_disj_587780;
                            bool index_certs_585487;
                            
                            if (!protect_assert_disj_587790) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585479, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585488 = stride_585362 + j_585479;
                            int64_t slice_585489 = start_585435 + slice_585488;
                            bool protect_cond_conj_587791 = cond_585482 && x_587787;
                            int64_t leq_arg1_585490;
                            
                            if (protect_cond_conj_587791) {
                                int64_t x_587781 = ((int64_t *) mem_param_587267.mem)[slice_585489];
                                
                                leq_arg1_585490 = x_587781;
                            } else {
                                leq_arg1_585490 = (int64_t) 0;
                            }
                            
                            bool x_585491 = sle64((int64_t) 0, i_585475);
                            bool bounds_check_585492 = cond_585482 && x_585491;
                            bool protect_assert_disj_587784 = bounds_check_585492 || loop_not_taken_587779;
                            bool protect_assert_disj_587793 = cond_585480 || protect_assert_disj_587784;
                            bool index_certs_585493;
                            
                            if (!protect_assert_disj_587793) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585475, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585494 = start_585435 + i_585475;
                            int64_t leq_arg0_585495;
                            
                            if (protect_cond_conj_587791) {
                                int64_t x_587785 = ((int64_t *) mem_param_587267.mem)[slice_585494];
                                
                                leq_arg0_585495 = x_587785;
                            } else {
                                leq_arg0_585495 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585496 = sle64(leq_arg0_585495, leq_arg1_585490);
                            bool x_587867 = cond_585482 && lifted_lambda_res_585496;
                            bool cond_585481 = cond_585480 || x_587867;
                            bool protect_assert_disj_587695 = cond_585481 || bounds_check_585486;
                            bool index_certs_585513;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585479, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585504 = cond_585482 && x_585491;
                            bool loop_not_taken_587690 = !cond_585481;
                            bool protect_assert_disj_587691 = bounds_check_585504 || loop_not_taken_587690;
                            bool index_certs_585505;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585475, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585515 = start_585435 + slice_585488;
                            int64_t binop_y_587424 = dim_438949 * slice_585515;
                            int64_t binop_y_587426 = dim_438949 * slice_585494;
                            int64_t ext_587428;
                            
                            if (cond_585481) {
                                ext_587428 = binop_y_587426;
                            } else {
                                ext_587428 = binop_y_587424;
                            }
                            
                            int64_t loopres_585497;
                            int64_t loopres_585498;
                            int64_t loopres_585500;
                            
                            if (cond_585481) {
                                int64_t tmp_585501 = add64((int64_t) 1, i_585475);
                                int64_t tmp_585507 = ((int64_t *) mem_param_587267.mem)[slice_585494];
                                int64_t tmp_585509 = ((int64_t *) mem_param_587274.mem)[slice_585494];
                                
                                loopres_585497 = tmp_585501;
                                loopres_585498 = tmp_585507;
                                loopres_585500 = tmp_585509;
                            } else {
                                int64_t tmp_585516 = ((int64_t *) mem_param_587267.mem)[slice_585515];
                                int64_t tmp_585518 = ((int64_t *) mem_param_587274.mem)[slice_585515];
                                
                                loopres_585497 = i_585475;
                                loopres_585498 = tmp_585516;
                                loopres_585500 = tmp_585518;
                            }
                            ((int64_t *) mem_587408.mem)[k_585474] = loopres_585498;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587413.mem, k_585474 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587271.mem, ext_587428, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_587410.mem)[k_585474] = loopres_585500;
                            
                            int64_t i_tmp_588084 = loopres_585497;
                            
                            i_585475 = i_tmp_588084;
                        }
                        data_585470 = i_585475;
                        if (memblock_set(ctx, &ext_mem_587448, &mem_587408, "mem_587408") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587445, &mem_587413, "mem_587413") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587441, &mem_587410, "mem_587410") != 0)
                            return 1;
                    } else {
                        if (mem_587300_cached_sizze_588798 < bytes_587299) {
                            err = lexical_realloc(ctx, &mem_587300, &mem_587300_cached_sizze_588798, bytes_587299);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587302_cached_sizze_588799 < bytes_587299) {
                            err = lexical_realloc(ctx, &mem_587302, &mem_587302_cached_sizze_588799, bytes_587299);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586153 = 0; i_586153 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383; i_586153++) {
                            int64_t split_count_arg3_585526 = mul64(merge_block_sizze_580560, i_586153);
                            int64_t defunc_0_split_count_res_585527;
                            int64_t defunc_0_split_count_res_585528;
                            int64_t defunc_0_split_count_res_585529;
                            int64_t defunc_0_split_count_res_585530;
                            int64_t defunc_0_split_count_res_585531;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585527, &defunc_0_split_count_res_585528, &defunc_0_split_count_res_585529, &defunc_0_split_count_res_585530, &defunc_0_split_count_res_585531, (int64_t) 0, stride_585362, (int64_t) 0, j_m_i_585384, split_count_arg3_585526) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585532 = slt64((int64_t) 0, defunc_0_split_count_res_585531);
                            bool defunc_0_split_count_res_585533;
                            int64_t defunc_0_split_count_res_585534;
                            int64_t defunc_0_split_count_res_585535;
                            int64_t defunc_0_split_count_res_585536;
                            int64_t defunc_0_split_count_res_585537;
                            int64_t defunc_0_split_count_res_585538;
                            bool loop_while_585539;
                            int64_t ss_585540;
                            int64_t ss_585541;
                            int64_t tt_585542;
                            int64_t tt_585543;
                            int64_t count_585544;
                            
                            loop_while_585539 = loop_cond_585532;
                            ss_585540 = defunc_0_split_count_res_585527;
                            ss_585541 = defunc_0_split_count_res_585528;
                            tt_585542 = defunc_0_split_count_res_585529;
                            tt_585543 = defunc_0_split_count_res_585530;
                            count_585544 = defunc_0_split_count_res_585531;
                            while (loop_while_585539) {
                                int64_t zlze_lhs_585545 = sub64(ss_585541, ss_585540);
                                bool cond_585546 = sle64(zlze_lhs_585545, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585547;
                                int64_t defunc_0_lifted_step_res_585548;
                                int64_t defunc_0_lifted_step_res_585549;
                                int64_t defunc_0_lifted_step_res_585550;
                                
                                if (cond_585546) {
                                    int64_t tmp_585551 = add64(tt_585542, count_585544);
                                    
                                    defunc_0_lifted_step_res_585547 = ss_585540;
                                    defunc_0_lifted_step_res_585548 = tmp_585551;
                                    defunc_0_lifted_step_res_585549 = tt_585543;
                                    defunc_0_lifted_step_res_585550 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585552 = sub64(tt_585543, tt_585542);
                                    bool cond_585553 = sle64(zlze_lhs_585552, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585554;
                                    int64_t defunc_0_lifted_step_res_f_res_585555;
                                    int64_t defunc_0_lifted_step_res_f_res_585556;
                                    int64_t defunc_0_lifted_step_res_f_res_585557;
                                    
                                    if (cond_585553) {
                                        int64_t tmp_585558 = add64(ss_585540, count_585544);
                                        
                                        defunc_0_lifted_step_res_f_res_585554 = tmp_585558;
                                        defunc_0_lifted_step_res_f_res_585555 = tt_585542;
                                        defunc_0_lifted_step_res_f_res_585556 = tt_585543;
                                        defunc_0_lifted_step_res_f_res_585557 = (int64_t) 0;
                                    } else {
                                        bool cond_585559 = count_585544 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585560;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585561;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585562;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585563;
                                        
                                        if (cond_585559) {
                                            bool x_585564 = sle64((int64_t) 0, ss_585540);
                                            bool y_585565 = slt64(ss_585540, stride_585362);
                                            bool bounds_check_585566 = x_585564 && y_585565;
                                            bool index_certs_585567;
                                            
                                            if (!bounds_check_585566) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585540, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:952:33-56\n   #13 ftSkyline.fut:939:17-952:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585570 = sle64((int64_t) 0, tt_585542);
                                            bool y_585571 = slt64(tt_585542, j_m_i_585384);
                                            bool bounds_check_585572 = x_585570 && y_585571;
                                            bool index_certs_585573;
                                            
                                            if (!bounds_check_585572) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585542, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:952:33-56\n   #13 ftSkyline.fut:939:17-952:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585568 = start_585435 + ss_585540;
                                            int64_t leq_arg1_585569 = ((int64_t *) mem_param_587267.mem)[slice_585568];
                                            int64_t slice_585574 = stride_585362 + tt_585542;
                                            int64_t slice_585575 = start_585435 + slice_585574;
                                            int64_t leq_arg0_585576 = ((int64_t *) mem_param_587267.mem)[slice_585575];
                                            bool lifted_lambda_res_585577 = sle64(leq_arg0_585576, leq_arg1_585569);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585578;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585579;
                                            
                                            if (lifted_lambda_res_585577) {
                                                int64_t tmp_585580 = add64((int64_t) 1, tt_585542);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585578 = ss_585540;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585579 = tmp_585580;
                                            } else {
                                                int64_t tmp_585581 = add64((int64_t) 1, ss_585540);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585578 = tmp_585581;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585579 = tt_585542;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585560 = defunc_0_lifted_step_res_f_res_f_res_t_res_585578;
                                            defunc_0_lifted_step_res_f_res_f_res_585561 = defunc_0_lifted_step_res_f_res_f_res_t_res_585579;
                                            defunc_0_lifted_step_res_f_res_f_res_585562 = tt_585543;
                                            defunc_0_lifted_step_res_f_res_f_res_585563 = (int64_t) 0;
                                        } else {
                                            int64_t m_585582 = sdiv64(count_585544, (int64_t) 2);
                                            int64_t n_585583 = sub64(count_585544, m_585582);
                                            bool cond_585584 = n_585583 == (int64_t) 0;
                                            int64_t zgze_lhs_585585 = add64(ss_585540, m_585582);
                                            bool cond_f_res_585586 = sle64(ss_585541, zgze_lhs_585585);
                                            bool x_585587 = !cond_585584;
                                            bool y_585588 = cond_f_res_585586 && x_585587;
                                            bool cond_585589 = cond_585584 || y_585588;
                                            bool leq_y_x_585590;
                                            
                                            if (cond_585589) {
                                                leq_y_x_585590 = 1;
                                            } else {
                                                bool x_585591 = sle64((int64_t) 0, zgze_lhs_585585);
                                                bool y_585592 = slt64(zgze_lhs_585585, stride_585362);
                                                bool bounds_check_585593 = x_585591 && y_585592;
                                                bool index_certs_585594;
                                                
                                                if (!bounds_check_585593) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585585, "] out of bounds for array of shape [", (long long) stride_585362, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:952:33-56\n   #13 ftSkyline.fut:939:17-952:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585597 = add64(tt_585542, n_585583);
                                                int64_t leq_arg0_585598 = sub64(zm_lhs_585597, (int64_t) 1);
                                                bool x_585599 = sle64((int64_t) 0, leq_arg0_585598);
                                                bool y_585600 = slt64(leq_arg0_585598, j_m_i_585384);
                                                bool bounds_check_585601 = x_585599 && y_585600;
                                                bool index_certs_585602;
                                                
                                                if (!bounds_check_585601) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585598, "] out of bounds for array of shape [", (long long) j_m_i_585384, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:952:33-56\n   #13 ftSkyline.fut:939:17-952:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585595 = start_585435 + zgze_lhs_585585;
                                                int64_t leq_arg1_585596 = ((int64_t *) mem_param_587267.mem)[slice_585595];
                                                int64_t slice_585603 = stride_585362 + leq_arg0_585598;
                                                int64_t slice_585604 = start_585435 + slice_585603;
                                                int64_t leq_arg0_585605 = ((int64_t *) mem_param_587267.mem)[slice_585604];
                                                bool lifted_lambda_res_585606 = sle64(leq_arg0_585605, leq_arg1_585596);
                                                
                                                leq_y_x_585590 = lifted_lambda_res_585606;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585607;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585608;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585609;
                                            
                                            if (leq_y_x_585590) {
                                                int64_t tmp_585610 = add64(tt_585542, n_585583);
                                                int64_t tmp_585611 = sub64(count_585544, n_585583);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585607 = tmp_585610;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585608 = tt_585543;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585609 = tmp_585611;
                                            } else {
                                                int64_t tmp_585612 = add64(tt_585542, n_585583);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585607 = tt_585542;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585608 = tmp_585612;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585609 = count_585544;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585560 = ss_585540;
                                            defunc_0_lifted_step_res_f_res_f_res_585561 = defunc_0_lifted_step_res_f_res_f_res_f_res_585607;
                                            defunc_0_lifted_step_res_f_res_f_res_585562 = defunc_0_lifted_step_res_f_res_f_res_f_res_585608;
                                            defunc_0_lifted_step_res_f_res_f_res_585563 = defunc_0_lifted_step_res_f_res_f_res_f_res_585609;
                                        }
                                        defunc_0_lifted_step_res_f_res_585554 = defunc_0_lifted_step_res_f_res_f_res_585560;
                                        defunc_0_lifted_step_res_f_res_585555 = defunc_0_lifted_step_res_f_res_f_res_585561;
                                        defunc_0_lifted_step_res_f_res_585556 = defunc_0_lifted_step_res_f_res_f_res_585562;
                                        defunc_0_lifted_step_res_f_res_585557 = defunc_0_lifted_step_res_f_res_f_res_585563;
                                    }
                                    defunc_0_lifted_step_res_585547 = defunc_0_lifted_step_res_f_res_585554;
                                    defunc_0_lifted_step_res_585548 = defunc_0_lifted_step_res_f_res_585555;
                                    defunc_0_lifted_step_res_585549 = defunc_0_lifted_step_res_f_res_585556;
                                    defunc_0_lifted_step_res_585550 = defunc_0_lifted_step_res_f_res_585557;
                                }
                                
                                int64_t loopres_585613;
                                int64_t loopres_585614;
                                int64_t loopres_585615;
                                int64_t loopres_585616;
                                int64_t loopres_585617;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585613, &loopres_585614, &loopres_585615, &loopres_585616, &loopres_585617, defunc_0_lifted_step_res_585547, ss_585541, defunc_0_lifted_step_res_585548, defunc_0_lifted_step_res_585549, defunc_0_lifted_step_res_585550) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585618 = slt64((int64_t) 0, loopres_585617);
                                bool loop_while_tmp_588090 = loop_cond_585618;
                                int64_t ss_tmp_588091 = loopres_585613;
                                int64_t ss_tmp_588092 = loopres_585614;
                                int64_t tt_tmp_588093 = loopres_585615;
                                int64_t tt_tmp_588094 = loopres_585616;
                                int64_t count_tmp_588095 = loopres_585617;
                                
                                loop_while_585539 = loop_while_tmp_588090;
                                ss_585540 = ss_tmp_588091;
                                ss_585541 = ss_tmp_588092;
                                tt_585542 = tt_tmp_588093;
                                tt_585543 = tt_tmp_588094;
                                count_585544 = count_tmp_588095;
                            }
                            defunc_0_split_count_res_585533 = loop_while_585539;
                            defunc_0_split_count_res_585534 = ss_585540;
                            defunc_0_split_count_res_585535 = ss_585541;
                            defunc_0_split_count_res_585536 = tt_585542;
                            defunc_0_split_count_res_585537 = tt_585543;
                            defunc_0_split_count_res_585538 = count_585544;
                            ((int64_t *) mem_587300)[i_586153] = defunc_0_split_count_res_585534;
                            ((int64_t *) mem_587302)[i_586153] = defunc_0_split_count_res_585536;
                        }
                        if (mem_587317_cached_sizze_588800 < bytes_587316) {
                            err = lexical_realloc(ctx, &mem_587317, &mem_587317_cached_sizze_588800, bytes_587316);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587321_cached_sizze_588801 < bytes_587320) {
                            err = lexical_realloc(ctx, &mem_587321, &mem_587321_cached_sizze_588801, bytes_587320);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587324_cached_sizze_588802 < bytes_587316) {
                            err = lexical_realloc(ctx, &mem_587324, &mem_587324_cached_sizze_588802, bytes_587316);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586162 = 0; i_586162 < num_blocks_585382; i_586162++) {
                            bool y_585627 = slt64(i_586162, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383);
                            bool index_certs_585629;
                            
                            if (!y_585627) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586162, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585630 = ((int64_t *) mem_587300)[i_586162];
                            int64_t defunc_0_f_res_585631 = ((int64_t *) mem_587302)[i_586162];
                            int64_t tmp_585632 = add64((int64_t) 1, i_586162);
                            bool x_585633 = sle64((int64_t) 0, tmp_585632);
                            bool y_585634 = slt64(tmp_585632, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383);
                            bool bounds_check_585635 = x_585633 && y_585634;
                            bool index_certs_585636;
                            
                            if (!bounds_check_585635) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585632, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585383, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585637 = ((int64_t *) mem_587300)[tmp_585632];
                            int64_t defunc_0_f_res_585638 = ((int64_t *) mem_587302)[tmp_585632];
                            int64_t merge_sequential_arg2_585639 = add64(stride_585362, defunc_0_f_res_585631);
                            int64_t merge_sequential_arg2_585640 = add64(stride_585362, defunc_0_f_res_585638);
                            int64_t j_m_i_585641 = sub64(merge_sequential_arg2_585640, merge_sequential_arg2_585639);
                            bool empty_slice_585642 = j_m_i_585641 == (int64_t) 0;
                            int64_t m_585643 = sub64(j_m_i_585641, (int64_t) 1);
                            int64_t i_p_m_t_s_585644 = add64(merge_sequential_arg2_585639, m_585643);
                            bool zzero_leq_i_p_m_t_s_585645 = sle64((int64_t) 0, i_p_m_t_s_585644);
                            bool i_p_m_t_s_leq_w_585646 = slt64(i_p_m_t_s_585644, next_stride_585363);
                            bool zzero_lte_i_585647 = sle64((int64_t) 0, merge_sequential_arg2_585639);
                            bool i_lte_j_585648 = sle64(merge_sequential_arg2_585639, merge_sequential_arg2_585640);
                            bool y_585649 = i_p_m_t_s_leq_w_585646 && zzero_lte_i_585647;
                            bool y_585650 = zzero_leq_i_p_m_t_s_585645 && y_585649;
                            bool forwards_ok_585651 = i_lte_j_585648 && y_585650;
                            bool ok_or_empty_585652 = empty_slice_585642 || forwards_ok_585651;
                            bool index_certs_585653;
                            
                            if (!ok_or_empty_585652) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585639, ":", (long long) merge_sequential_arg2_585640, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585654 = sub64(defunc_0_f_res_585637, defunc_0_f_res_585630);
                            bool empty_slice_585655 = j_m_i_585654 == (int64_t) 0;
                            int64_t m_585656 = sub64(j_m_i_585654, (int64_t) 1);
                            int64_t i_p_m_t_s_585657 = add64(defunc_0_f_res_585630, m_585656);
                            bool zzero_leq_i_p_m_t_s_585658 = sle64((int64_t) 0, i_p_m_t_s_585657);
                            bool i_p_m_t_s_leq_w_585659 = slt64(i_p_m_t_s_585657, next_stride_585363);
                            bool zzero_lte_i_585660 = sle64((int64_t) 0, defunc_0_f_res_585630);
                            bool i_lte_j_585661 = sle64(defunc_0_f_res_585630, defunc_0_f_res_585637);
                            bool y_585662 = i_p_m_t_s_leq_w_585659 && zzero_lte_i_585660;
                            bool y_585663 = zzero_leq_i_p_m_t_s_585658 && y_585662;
                            bool forwards_ok_585664 = i_lte_j_585661 && y_585663;
                            bool ok_or_empty_585665 = empty_slice_585655 || forwards_ok_585664;
                            bool index_certs_585666;
                            
                            if (!ok_or_empty_585665) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585630, ":", (long long) defunc_0_f_res_585637, "] out of bounds for array of shape [", (long long) next_stride_585363, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585667 = slt64((int64_t) 0, j_m_i_585654);
                            bool y_585676 = slt64((int64_t) 0, j_m_i_585641);
                            bool protect_assert_disj_587711 = cond_585667 || y_585676;
                            bool index_certs_585677;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585678 = start_585435 + merge_sequential_arg2_585639;
                            int64_t binop_y_587339 = dim_438949 * slice_585678;
                            int64_t slice_585672 = start_585435 + defunc_0_f_res_585630;
                            int64_t binop_y_587341 = dim_438949 * slice_585672;
                            int64_t ext_587343;
                            
                            if (cond_585667) {
                                ext_587343 = binop_y_587341;
                            } else {
                                ext_587343 = binop_y_587339;
                            }
                            
                            int64_t dummy_585668;
                            int64_t dummy_585670;
                            
                            if (cond_585667) {
                                int64_t head_res_585673 = ((int64_t *) mem_param_587267.mem)[slice_585672];
                                int64_t head_res_585675 = ((int64_t *) mem_param_587274.mem)[slice_585672];
                                
                                dummy_585668 = head_res_585673;
                                dummy_585670 = head_res_585675;
                            } else {
                                int64_t head_res_585679 = ((int64_t *) mem_param_587267.mem)[slice_585678];
                                int64_t head_res_585681 = ((int64_t *) mem_param_587274.mem)[slice_585678];
                                
                                dummy_585668 = head_res_585679;
                                dummy_585670 = head_res_585681;
                            }
                            for (int64_t nest_i_588099 = 0; nest_i_588099 < merge_block_sizze_580560; nest_i_588099++) {
                                ((int64_t *) mem_587317)[i_586162 * merge_block_sizze_580560 + nest_i_588099] = dummy_585668;
                            }
                            for (int64_t nest_i_588100 = 0; nest_i_588100 < merge_block_sizze_580560; nest_i_588100++) {
                                ((int64_t *) mem_587324)[i_586162 * merge_block_sizze_580560 + nest_i_588100] = dummy_585670;
                            }
                            for (int64_t nest_i_588101 = 0; nest_i_588101 < merge_block_sizze_580560; nest_i_588101++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587321, i_586162 * lmad_arg_587338 + nest_i_588101 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587271.mem, ext_587343, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            }
                            
                            int64_t data_585685;
                            int64_t i_585690 = (int64_t) 0;
                            
                            for (int64_t k_585689 = 0; k_585689 < merge_block_sizze_580560; k_585689++) {
                                int64_t j_585694 = sub64(k_585689, i_585690);
                                bool cond_585695 = j_585694 == j_m_i_585641;
                                bool x_587805 = !cond_585695;
                                bool cond_585697 = slt64(i_585690, j_m_i_585654);
                                bool x_585699 = sle64((int64_t) 0, j_585694);
                                bool y_585700 = slt64(j_585694, j_m_i_585641);
                                bool bounds_check_585701 = x_585699 && y_585700;
                                bool loop_not_taken_587797 = !cond_585697;
                                bool protect_assert_disj_587798 = bounds_check_585701 || loop_not_taken_587797;
                                bool protect_assert_disj_587808 = cond_585695 || protect_assert_disj_587798;
                                bool index_certs_585702;
                                
                                if (!protect_assert_disj_587808) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585694, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585703 = merge_sequential_arg2_585639 + j_585694;
                                int64_t slice_585704 = start_585435 + slice_585703;
                                bool protect_cond_conj_587809 = cond_585697 && x_587805;
                                int64_t leq_arg1_585705;
                                
                                if (protect_cond_conj_587809) {
                                    int64_t x_587799 = ((int64_t *) mem_param_587267.mem)[slice_585704];
                                    
                                    leq_arg1_585705 = x_587799;
                                } else {
                                    leq_arg1_585705 = (int64_t) 0;
                                }
                                
                                bool x_585706 = sle64((int64_t) 0, i_585690);
                                bool bounds_check_585707 = cond_585697 && x_585706;
                                bool protect_assert_disj_587802 = bounds_check_585707 || loop_not_taken_587797;
                                bool protect_assert_disj_587811 = cond_585695 || protect_assert_disj_587802;
                                bool index_certs_585708;
                                
                                if (!protect_assert_disj_587811) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585690, "] out of bounds for array of shape [", (long long) j_m_i_585654, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585709 = defunc_0_f_res_585630 + i_585690;
                                int64_t slice_585710 = start_585435 + slice_585709;
                                int64_t leq_arg0_585711;
                                
                                if (protect_cond_conj_587809) {
                                    int64_t x_587803 = ((int64_t *) mem_param_587267.mem)[slice_585710];
                                    
                                    leq_arg0_585711 = x_587803;
                                } else {
                                    leq_arg0_585711 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585712 = sle64(leq_arg0_585711, leq_arg1_585705);
                                bool x_587870 = cond_585697 && lifted_lambda_res_585712;
                                bool cond_585696 = cond_585695 || x_587870;
                                bool protect_assert_disj_587703 = cond_585696 || bounds_check_585701;
                                bool index_certs_585730;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585694, "] out of bounds for array of shape [", (long long) j_m_i_585641, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585720 = cond_585697 && x_585706;
                                bool loop_not_taken_587698 = !cond_585696;
                                bool protect_assert_disj_587699 = bounds_check_585720 || loop_not_taken_587698;
                                bool index_certs_585721;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585690, "] out of bounds for array of shape [", (long long) j_m_i_585654, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585732 = start_585435 + slice_585703;
                                int64_t binop_y_587361 = dim_438949 * slice_585732;
                                int64_t slice_585723 = start_585435 + slice_585709;
                                int64_t binop_y_587363 = dim_438949 * slice_585723;
                                int64_t ext_587365;
                                
                                if (cond_585696) {
                                    ext_587365 = binop_y_587363;
                                } else {
                                    ext_587365 = binop_y_587361;
                                }
                                
                                int64_t loopres_585713;
                                int64_t loopres_585714;
                                int64_t loopres_585716;
                                
                                if (cond_585696) {
                                    int64_t tmp_585717 = add64((int64_t) 1, i_585690);
                                    int64_t tmp_585724 = ((int64_t *) mem_param_587267.mem)[slice_585723];
                                    int64_t tmp_585726 = ((int64_t *) mem_param_587274.mem)[slice_585723];
                                    
                                    loopres_585713 = tmp_585717;
                                    loopres_585714 = tmp_585724;
                                    loopres_585716 = tmp_585726;
                                } else {
                                    int64_t tmp_585733 = ((int64_t *) mem_param_587267.mem)[slice_585732];
                                    int64_t tmp_585735 = ((int64_t *) mem_param_587274.mem)[slice_585732];
                                    
                                    loopres_585713 = i_585690;
                                    loopres_585714 = tmp_585733;
                                    loopres_585716 = tmp_585735;
                                }
                                ((int64_t *) mem_587317)[i_586162 * merge_block_sizze_580560 + k_585689] = loopres_585714;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587321, i_586162 * lmad_arg_587338 + k_585689 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587271.mem, ext_587365, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                                ((int64_t *) mem_587324)[i_586162 * merge_block_sizze_580560 + k_585689] = loopres_585716;
                                
                                int64_t i_tmp_588102 = loopres_585713;
                                
                                i_585690 = i_tmp_588102;
                            }
                            data_585685 = i_585690;
                        }
                        if (memblock_alloc(ctx, &mem_587391, bytes_587316, "mem_587391")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587391.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (uint64_t *) mem_587317, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560});
                        if (memblock_alloc(ctx, &mem_587396, bytes_587320, "mem_587396")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_587396.mem, (int64_t) 0, (int64_t []) {dim_438949 * merge_block_sizze_580560, dim_438949, (int64_t) 1}, (uint32_t *) mem_587321, (int64_t) 0, (int64_t []) {lmad_arg_587338, dim_438949, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560, dim_438949});
                        if (memblock_alloc(ctx, &mem_587400, bytes_587316, "mem_587400")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587400.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (uint64_t *) mem_587324, (int64_t) 0, (int64_t []) {merge_block_sizze_580560, (int64_t) 1}, (int64_t []) {num_blocks_585382, merge_block_sizze_580560});
                        if (memblock_set(ctx, &ext_mem_587448, &mem_587391, "mem_587391") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587445, &mem_587396, "mem_587396") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587441, &mem_587400, "mem_587400") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587277, i_586172 * next_stride_585363, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587448.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585363});
                    if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587281, i_586172 * lmad_arg_587298, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) ext_mem_587445.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {next_stride_585363, dim_438949});
                    if (memblock_unref(ctx, &ext_mem_587445, "ext_mem_587445") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587284, i_586172 * next_stride_585363, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587441.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585363});
                    if (memblock_unref(ctx, &ext_mem_587441, "ext_mem_587441") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585757 = next_stride_585363 * num_merges_585367;
                
                if (memblock_alloc(ctx, &mem_587464, bytes_587276, "mem_587464")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587464.mem, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (uint64_t *) mem_587277, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363});
                if (memblock_alloc(ctx, &mem_587469, bytes_587280, "mem_587469")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_587469.mem, (int64_t) 0, (int64_t []) {dim_438949 * next_stride_585363, dim_438949, (int64_t) 1}, (uint32_t *) mem_587281, (int64_t) 0, (int64_t []) {lmad_arg_587298, dim_438949, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363, dim_438949});
                if (memblock_alloc(ctx, &mem_587473, bytes_587276, "mem_587473")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587473.mem, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (uint64_t *) mem_587284, (int64_t) 0, (int64_t []) {next_stride_585363, (int64_t) 1}, (int64_t []) {num_merges_585367, next_stride_585363});
                
                bool loop_cond_585761 = slt64(next_stride_585363, flat_dim_580555);
                
                if (memblock_set(ctx, &mem_param_tmp_588069, &mem_587464, "mem_587464") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588070, &mem_587469, "mem_587469") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588071, &mem_587473, "mem_587473") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588072 = flat_dim_585757;
                bool loop_while_tmp_588073 = loop_cond_585761;
                int64_t stride_tmp_588077 = next_stride_585363;
                
                if (memblock_set(ctx, &mem_param_587267, &mem_param_tmp_588069, "mem_param_tmp_588069") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587271, &mem_param_tmp_588070, "mem_param_tmp_588070") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587274, &mem_param_tmp_588071, "mem_param_tmp_588071") != 0)
                    return 1;
                loop_dz2084Uz2082U_585357 = loop_dz2084Uz2082U_tmp_588072;
                loop_while_585358 = loop_while_tmp_588073;
                stride_585362 = stride_tmp_588077;
            }
            if (memblock_set(ctx, &ext_mem_587484, &mem_param_587267, "mem_param_587267") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587483, &mem_param_587271, "mem_param_587271") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587482, &mem_param_587274, "mem_param_587274") != 0)
                return 1;
            data_585351 = loop_dz2084Uz2082U_585357;
            data_585352 = loop_while_585358;
            data_585356 = stride_585362;
            if (memblock_unref(ctx, &mem_587254, "mem_587254") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587259, "mem_587259") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587263, "mem_587263") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585762 = slt64(m_580370, data_585351);
            bool y_585763 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_585762;
            bool ok_or_empty_585764 = empty_slice_580369 || y_585763;
            bool index_certs_585765;
            
            if (!ok_or_empty_585764) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580360, "] out of bounds for array of shape [", (long long) data_585351, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587491, &ext_mem_587483, "ext_mem_587483") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587487, &ext_mem_587482, "ext_mem_587482") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587493, bytes_586500, "mem_587493")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587493.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587487.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
        if (memblock_unref(ctx, &ext_mem_587487, "ext_mem_587487") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587496, bytes_586498, "mem_587496")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_587496.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) ext_mem_587491.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {m_580360, dim_438949});
        if (memblock_unref(ctx, &ext_mem_587491, "ext_mem_587491") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587498, &mem_587496, "mem_587496") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587497, &mem_587493, "mem_587493") != 0)
            return 1;
    } else {
        if (mem_586519_cached_sizze_588751 < bytes_586518) {
            err = lexical_realloc(ctx, &mem_586519, &mem_586519_cached_sizze_588751, bytes_586518);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586178 = 0; i_586178 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951; i_586178++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581195 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586178];
            float i64_res_581196 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581195);
            float defunc_0_fover_res_581197 = 1.5707964F / i64_res_581196;
            
            ((float *) mem_586519)[i_586178] = defunc_0_fover_res_581197;
        }
        if (mem_586527_cached_sizze_588752 < bytes_586500) {
            err = lexical_realloc(ctx, &mem_586527, &mem_586527_cached_sizze_588752, bytes_586500);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586529_cached_sizze_588753 < binop_x_586497) {
            err = lexical_realloc(ctx, &mem_586529, &mem_586529_cached_sizze_588753, binop_x_586497);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586537_cached_sizze_588754 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_586537, &mem_586537_cached_sizze_588754, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586545_cached_sizze_588755 < bytes_586509) {
            err = lexical_realloc(ctx, &mem_586545, &mem_586545_cached_sizze_588755, bytes_586509);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586547_cached_sizze_588756 < bytes_586509) {
            err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_588756, bytes_586509);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586561_cached_sizze_588757 < bytes_586560) {
            err = lexical_realloc(ctx, &mem_586561, &mem_586561_cached_sizze_588757, bytes_586560);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586577_cached_sizze_588759 < bytes_586576) {
            err = lexical_realloc(ctx, &mem_586577, &mem_586577_cached_sizze_588759, bytes_586576);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586203 = 0; i_586203 < m_580360; i_586203++) {
            for (int64_t i_586182 = 0; i_586182 < dim_438949; i_586182++) {
                float eta_p_584136 = ((float *) mem_586499.mem)[i_586203 * dim_438949 + i_586182];
                float eta_p_584137 = ((float *) start_of_grid_partition_mem_586422.mem)[i_586182];
                float eta_p_584138 = ((float *) grid_part_sizze_per_dim_mem_586420.mem)[i_586182];
                int64_t eta_p_584140 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586182];
                float defunc_0_f_res_584141 = eta_p_584136 - eta_p_584137;
                float defunc_0_f_res_584143 = defunc_0_f_res_584141 / eta_p_584138;
                int64_t f32_res_584145 = fptosi_f32_i64(defunc_0_f_res_584143);
                int64_t max_res_584147 = smax64((int64_t) 0, f32_res_584145);
                int64_t zm_lhs_584153 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586182];
                int64_t min_arg1_584154 = sub64(zm_lhs_584153, (int64_t) 1);
                int64_t min_res_584155 = smin64(max_res_584147, min_arg1_584154);
                int64_t defunc_0_f_res_584157 = mul64(eta_p_584140, min_res_584155);
                
                ((int64_t *) mem_586537)[i_586182] = defunc_0_f_res_584157;
            }
            
            int64_t defunc_0_foldl_res_581131;
            int64_t acc_581133 = (int64_t) 0;
            
            for (int64_t i_581132 = 0; i_581132 < dim_438949; i_581132++) {
                int64_t b_581134 = ((int64_t *) mem_586537)[i_581132];
                int64_t defunc_0_f_res_581135 = add64(acc_581133, b_581134);
                int64_t acc_tmp_588110 = defunc_0_f_res_581135;
                
                acc_581133 = acc_tmp_588110;
            }
            defunc_0_foldl_res_581131 = acc_581133;
            
            bool x_581136 = sle64((int64_t) 0, defunc_0_foldl_res_581131);
            bool y_581137 = slt64(defunc_0_foldl_res_581131, dz2080U_438952);
            bool bounds_check_581138 = x_581136 && y_581137;
            bool index_certs_581139;
            
            if (!bounds_check_581138) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_581131, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586188 = 0; i_586188 < dim_438949; i_586188++) {
                float eta_p_584065 = ((float *) mem_586499.mem)[i_586203 * dim_438949 + i_586188];
                float eta_p_584066 = ((float *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_581131 * dim_438949 + i_586188];
                float defunc_0_f_res_584067 = eta_p_584065 - eta_p_584066;
                float defunc_0_ftimes_res_584069 = defunc_0_f_res_584067 * defunc_0_f_res_584067;
                
                ((float *) mem_586545)[i_586188] = defunc_0_ftimes_res_584069;
                ((float *) mem_586547)[i_586188] = defunc_0_f_res_584067;
            }
            
            float defunc_0_foldl_res_581149;
            float acc_581151 = 0.0F;
            
            for (int64_t i_581150 = 0; i_581150 < dim_438949; i_581150++) {
                float b_581152 = ((float *) mem_586545)[i_581150];
                float defunc_0_f_res_581153 = acc_581151 + b_581152;
                float acc_tmp_588113 = defunc_0_f_res_581153;
                
                acc_581151 = acc_tmp_588113;
            }
            defunc_0_foldl_res_581149 = acc_581151;
            
            float sqrt_res_581154 = futrts_sqrt32(defunc_0_foldl_res_581149);
            
            for (int64_t nest_i_588114 = 0; nest_i_588114 < arg_580163; nest_i_588114++) {
                ((float *) mem_586561)[nest_i_588114] = 0.0F;
            }
            for (int64_t i_581157 = 0; i_581157 < arg_580163; i_581157++) {
                bool y_581159 = slt64(i_581157, dim_438949);
                bool index_certs_581160;
                
                if (!y_581159) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581157, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_581162 = add64((int64_t) 1, i_581157);
                int64_t j_m_i_581163 = sub64(dim_438949, map_arg1_581162);
                bool empty_slice_581164 = j_m_i_581163 == (int64_t) 0;
                int64_t m_581165 = sub64(j_m_i_581163, (int64_t) 1);
                int64_t i_p_m_t_s_581166 = add64(map_arg1_581162, m_581165);
                bool zzero_leq_i_p_m_t_s_581167 = sle64((int64_t) 0, i_p_m_t_s_581166);
                bool i_p_m_t_s_leq_w_581168 = slt64(i_p_m_t_s_581166, dim_438949);
                bool zzero_lte_i_581169 = sle64((int64_t) 0, map_arg1_581162);
                bool i_lte_j_581170 = sle64(map_arg1_581162, dim_438949);
                bool y_581171 = i_p_m_t_s_leq_w_581168 && zzero_lte_i_581169;
                bool y_581172 = zzero_leq_i_p_m_t_s_581167 && y_581171;
                bool forwards_ok_581173 = i_lte_j_581170 && y_581172;
                bool ok_or_empty_581174 = empty_slice_581164 || forwards_ok_581173;
                bool index_certs_581175;
                
                if (!ok_or_empty_581174) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_581162, ":", (long long) dim_438949, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586565 = (int64_t) 4 * j_m_i_581163;
                float this_x_581161 = ((float *) mem_586547)[i_581157];
                
                if (mem_586566_cached_sizze_588758 < bytes_586565) {
                    err = lexical_realloc(ctx, &mem_586566, &mem_586566_cached_sizze_588758, bytes_586565);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586193 = 0; i_586193 < j_m_i_581163; i_586193++) {
                    int64_t slice_586398 = map_arg1_581162 + i_586193;
                    float eta_p_581178 = ((float *) mem_586547)[slice_586398];
                    float defunc_0_ftimes_res_581179 = eta_p_581178 * eta_p_581178;
                    
                    ((float *) mem_586566)[i_586193] = defunc_0_ftimes_res_581179;
                }
                
                float defunc_0_foldl_res_581180;
                float acc_581182 = 0.0F;
                
                for (int64_t i_581181 = 0; i_581181 < j_m_i_581163; i_581181++) {
                    float b_581183 = ((float *) mem_586566)[i_581181];
                    float defunc_0_f_res_581184 = acc_581182 + b_581183;
                    float acc_tmp_588117 = defunc_0_f_res_581184;
                    
                    acc_581182 = acc_tmp_588117;
                }
                defunc_0_foldl_res_581180 = acc_581182;
                
                float sqrt_res_581185 = futrts_sqrt32(defunc_0_foldl_res_581180);
                float atan2_res_581186 = futrts_atan2_32(sqrt_res_581185, this_x_581161);
                
                ((float *) mem_586561)[i_581157] = atan2_res_581186;
            }
            for (int64_t i_586197 = 0; i_586197 < arg_580163; i_586197++) {
                float eta_p_581204 = ((float *) mem_586561)[i_586197];
                float eta_p_581205 = ((float *) mem_586519)[i_586197];
                int64_t eta_p_581206 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586197];
                int64_t eta_p_581207 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586197];
                float i64_res_581208 = sitofp_i64_f32(eta_p_581206);
                float defunc_0_fover_res_581209 = eta_p_581204 / eta_p_581205;
                float defunc_0_ftimes_res_581210 = i64_res_581208 * defunc_0_fover_res_581209;
                int64_t f32_res_581211 = fptosi_f32_i64(defunc_0_ftimes_res_581210);
                bool cond_581212 = slt64(f32_res_581211, (int64_t) 0);
                int64_t defunc_0_f_res_581213;
                
                if (cond_581212) {
                    defunc_0_f_res_581213 = (int64_t) 0;
                } else {
                    bool cond_581214 = sle64(eta_p_581207, f32_res_581211);
                    int64_t defunc_0_f_res_f_res_581215;
                    
                    if (cond_581214) {
                        int64_t defunc_0_f_res_f_res_t_res_585772 = sub64(eta_p_581207, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_581215 = defunc_0_f_res_f_res_t_res_585772;
                    } else {
                        defunc_0_f_res_f_res_581215 = f32_res_581211;
                    }
                    defunc_0_f_res_581213 = defunc_0_f_res_f_res_581215;
                }
                ((int64_t *) mem_586577)[i_586197] = defunc_0_f_res_581213;
            }
            
            int64_t defunc_0_foldl_res_581217;
            int64_t acc_581219 = (int64_t) 0;
            
            for (int64_t i_581218 = 0; i_581218 < arg_580163; i_581218++) {
                int64_t b_581220 = ((int64_t *) mem_586577)[i_581218];
                int64_t defunc_0_f_res_581221 = add64(acc_581219, b_581220);
                int64_t acc_tmp_588119 = defunc_0_f_res_581221;
                
                acc_581219 = acc_tmp_588119;
            }
            defunc_0_foldl_res_581217 = acc_581219;
            
            int64_t zp_lhs_581222 = mul64(total_angle_no_438969, defunc_0_foldl_res_581131);
            int64_t get_id_from_grid_angle_res_581223 = add64(defunc_0_foldl_res_581217, zp_lhs_581222);
            
            ((int64_t *) mem_586527)[i_586203] = get_id_from_grid_angle_res_581223;
            ((float *) mem_586529)[i_586203] = sqrt_res_581154;
        }
        
        int64_t reduce_arg1_581251;
        
        if (x_581231) {
            int64_t x_585778 = ((int64_t *) mem_586527)[(int64_t) 0];
            
            reduce_arg1_581251 = x_585778;
        } else {
            reduce_arg1_581251 = (int64_t) 0;
        }
        
        float reduce_arg1_581253;
        
        if (x_581231) {
            float x_585779 = ((float *) mem_586529)[(int64_t) 0];
            
            reduce_arg1_581253 = x_585779;
        } else {
            reduce_arg1_581253 = 0.0F;
        }
        if (cond_581230) {
            if (memblock_set(ctx, &ext_mem_587056, &mem_586499, "mem_586499") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587052, &mem_586501, "mem_586501") != 0)
                return 1;
        } else {
            int64_t ext_586599;
            int64_t defunc_0_reduce_res_586004;
            float defunc_0_reduce_res_586005;
            int64_t defunc_0_reduce_res_586007;
            int64_t redout_586206;
            float redout_586207;
            int64_t redout_586209;
            int64_t ctx_param_ext_586590;
            
            if (memblock_set(ctx, &mem_param_586592, &mem_586499, "mem_586499") != 0)
                return 1;
            ctx_param_ext_586590 = (int64_t) 0;
            redout_586206 = reduce_arg1_581251;
            redout_586207 = reduce_arg1_581253;
            redout_586209 = reduce_arg1_581255;
            for (int64_t i_586210 = 0; i_586210 < m_580360; i_586210++) {
                int64_t x_581269 = ((int64_t *) mem_586527)[i_586210];
                float x_581270 = ((float *) mem_586529)[i_586210];
                int64_t x_581272 = ((int64_t *) mem_586501.mem)[i_586210];
                bool cond_581281 = slt64(redout_586206, x_581269);
                bool cond_581282 = redout_586206 == x_581269;
                bool zlze_res_581283 = redout_586207 <= x_581270;
                bool x_581284 = cond_581282 && zlze_res_581283;
                bool x_581285 = !cond_581281;
                bool y_581286 = x_581284 && x_581285;
                bool defunc_0_leq_res_581287 = cond_581281 || y_581286;
                int64_t defunc_0_op_res_581288;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581288 = x_581269;
                } else {
                    defunc_0_op_res_581288 = redout_586206;
                }
                
                float defunc_0_op_res_581289;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581289 = x_581270;
                } else {
                    defunc_0_op_res_581289 = redout_586207;
                }
                
                int64_t defunc_0_op_res_581290;
                
                if (defunc_0_leq_res_581287) {
                    defunc_0_op_res_581290 = x_581272;
                } else {
                    defunc_0_op_res_581290 = redout_586209;
                }
                
                int64_t binop_y_586593 = dim_438949 * i_586210;
                int64_t ext_586596;
                
                if (defunc_0_leq_res_581287) {
                    ext_586596 = binop_y_586593;
                } else {
                    ext_586596 = ctx_param_ext_586590;
                }
                if (defunc_0_leq_res_581287) {
                    if (memblock_set(ctx, &ext_mem_586597, &mem_586499, "mem_586499") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586597, &mem_param_586592, "mem_param_586592") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588120, &ext_mem_586597, "ext_mem_586597") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588121 = ext_586596;
                int64_t redout_tmp_588122 = defunc_0_op_res_581288;
                float redout_tmp_588123 = defunc_0_op_res_581289;
                int64_t redout_tmp_588125 = defunc_0_op_res_581290;
                
                if (memblock_set(ctx, &mem_param_586592, &mem_param_tmp_588120, "mem_param_tmp_588120") != 0)
                    return 1;
                ctx_param_ext_586590 = ctx_param_ext_tmp_588121;
                redout_586206 = redout_tmp_588122;
                redout_586207 = redout_tmp_588123;
                redout_586209 = redout_tmp_588125;
            }
            if (memblock_set(ctx, &ext_mem_586600, &mem_param_586592, "mem_param_586592") != 0)
                return 1;
            ext_586599 = ctx_param_ext_586590;
            defunc_0_reduce_res_586004 = redout_586206;
            defunc_0_reduce_res_586005 = redout_586207;
            defunc_0_reduce_res_586007 = redout_586209;
            if (mem_586603_cached_sizze_588760 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588760, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586606_cached_sizze_588761 < bytes_586605) {
                err = lexical_realloc(ctx, &mem_586606, &mem_586606_cached_sizze_588761, bytes_586605);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586610_cached_sizze_588762 < bytes_586609) {
                err = lexical_realloc(ctx, &mem_586610, &mem_586610_cached_sizze_588762, bytes_586609);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586613_cached_sizze_588763 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586613, &mem_586613_cached_sizze_588763, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586633_cached_sizze_588764 < bytes_586632) {
                err = lexical_realloc(ctx, &mem_586633, &mem_586633_cached_sizze_588764, bytes_586632);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586635_cached_sizze_588765 < bytes_586634) {
                err = lexical_realloc(ctx, &mem_586635, &mem_586635_cached_sizze_588765, bytes_586634);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586638_cached_sizze_588766 < bytes_586637) {
                err = lexical_realloc(ctx, &mem_586638, &mem_586638_cached_sizze_588766, bytes_586637);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586640_cached_sizze_588767 < bytes_586632) {
                err = lexical_realloc(ctx, &mem_586640, &mem_586640_cached_sizze_588767, bytes_586632);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586232 = 0; i_586232 < x_582331; i_586232++) {
                int64_t zp_lhs_581312 = mul64(block_sizze_581247, i_586232);
                
                for (int64_t i_586219 = 0; i_586219 < block_sizze_581247; i_586219++) {
                    int64_t k_581318 = add64(zp_lhs_581312, i_586219);
                    bool cond_581319 = slt64(k_581318, m_580360);
                    int64_t binop_y_586654 = dim_438949 * k_581318;
                    int64_t ext_586657;
                    
                    if (cond_581319) {
                        ext_586657 = binop_y_586654;
                    } else {
                        ext_586657 = ext_586599;
                    }
                    
                    int64_t lifted_lambda_res_581320;
                    float lifted_lambda_res_581321;
                    int64_t lifted_lambda_res_581323;
                    
                    if (cond_581319) {
                        bool x_585780 = sle64((int64_t) 0, k_581318);
                        bool bounds_check_585781 = cond_581319 && x_585780;
                        bool index_certs_585782;
                        
                        if (!bounds_check_585781) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_581318, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585783 = ((int64_t *) mem_586527)[k_581318];
                        float lifted_lambda_res_t_res_585784 = ((float *) mem_586529)[k_581318];
                        int64_t lifted_lambda_res_t_res_585786 = ((int64_t *) mem_586501.mem)[k_581318];
                        
                        if (memblock_set(ctx, &ext_mem_586658, &mem_586499, "mem_586499") != 0)
                            return 1;
                        lifted_lambda_res_581320 = lifted_lambda_res_t_res_585783;
                        lifted_lambda_res_581321 = lifted_lambda_res_t_res_585784;
                        lifted_lambda_res_581323 = lifted_lambda_res_t_res_585786;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586658, &ext_mem_586600, "ext_mem_586600") != 0)
                            return 1;
                        lifted_lambda_res_581320 = defunc_0_reduce_res_586004;
                        lifted_lambda_res_581321 = defunc_0_reduce_res_586005;
                        lifted_lambda_res_581323 = defunc_0_reduce_res_586007;
                    }
                    ((int64_t *) mem_586633)[i_586219] = lifted_lambda_res_581320;
                    ((float *) mem_586635)[i_586219] = lifted_lambda_res_581321;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586638, i_586219 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586658.mem, ext_586657, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                    if (memblock_unref(ctx, &ext_mem_586658, "ext_mem_586658") != 0)
                        return 1;
                    ((int64_t *) mem_586640)[i_586219] = lifted_lambda_res_581323;
                }
                if (!cond_581300) {
                    if (mem_586699_cached_sizze_588768 < bytes_586509) {
                        err = lexical_realloc(ctx, &mem_586699, &mem_586699_cached_sizze_588768, bytes_586509);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586701_cached_sizze_588769 < bytes_586509) {
                        err = lexical_realloc(ctx, &mem_586701, &mem_586701_cached_sizze_588769, bytes_586509);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_581339 = 0; i_581339 < distance_581303; i_581339++) {
                        int64_t gt_arg1_581344 = add64((int64_t) 1, i_581339);
                        bool x_581345 = sle64((int64_t) 0, gt_arg1_581344);
                        bool y_581346 = slt64(gt_arg1_581344, block_sizze_581247);
                        bool bounds_check_581347 = x_581345 && y_581346;
                        bool index_certs_581348;
                        
                        if (!bounds_check_581347) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_581344, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_581351 = slt64(i_581339, block_sizze_581247);
                        bool index_certs_581352;
                        
                        if (!y_581351) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581339, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_581349 = ((int64_t *) mem_586633)[gt_arg1_581344];
                        float gt_arg1_581350 = ((float *) mem_586635)[gt_arg1_581344];
                        int64_t gt_arg0_581353 = ((int64_t *) mem_586633)[i_581339];
                        float gt_arg0_581354 = ((float *) mem_586635)[i_581339];
                        bool cond_581355 = slt64(gt_arg0_581353, gt_arg1_581349);
                        bool cond_581356 = gt_arg0_581353 == gt_arg1_581349;
                        bool zlze_res_581357 = gt_arg0_581354 <= gt_arg1_581350;
                        bool x_581358 = cond_581356 && zlze_res_581357;
                        bool x_581359 = !cond_581355;
                        bool y_581360 = x_581358 && x_581359;
                        bool defunc_0_leq_res_581361 = cond_581355 || y_581360;
                        bool defunc_0_lifted_gt_res_581362 = !defunc_0_leq_res_581361;
                        bool s_581363;
                        int64_t s_581368;
                        bool loop_while_581369;
                        int64_t j_581374;
                        
                        loop_while_581369 = defunc_0_lifted_gt_res_581362;
                        j_581374 = i_581339;
                        while (loop_while_581369) {
                            bool x_581375 = sle64((int64_t) 0, j_581374);
                            bool y_581376 = slt64(j_581374, block_sizze_581247);
                            bool bounds_check_581377 = x_581375 && y_581376;
                            bool index_certs_581378;
                            
                            if (!bounds_check_581377) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581374, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581384 = add64((int64_t) 1, j_581374);
                            bool x_581385 = sle64((int64_t) 0, copy_arg0_581384);
                            bool y_581386 = slt64(copy_arg0_581384, block_sizze_581247);
                            bool bounds_check_581387 = x_581385 && y_581386;
                            bool index_certs_581388;
                            
                            if (!bounds_check_581387) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_581384, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581379 = ((int64_t *) mem_586633)[j_581374];
                            float copy_arg0_581380 = ((float *) mem_586635)[j_581374];
                            int64_t copy_arg0_581382 = ((int64_t *) mem_586640)[j_581374];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586699, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586638, (int64_t) 0 + j_581374 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            
                            int64_t copy_arg0_581389 = ((int64_t *) mem_586633)[copy_arg0_581384];
                            float copy_arg0_581390 = ((float *) mem_586635)[copy_arg0_581384];
                            int64_t copy_arg0_581392 = ((int64_t *) mem_586640)[copy_arg0_581384];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586701, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586638, (int64_t) 0 + copy_arg0_581384 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_586633)[j_581374] = copy_arg0_581389;
                            ((float *) mem_586635)[j_581374] = copy_arg0_581390;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586638, j_581374 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586701, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_586640)[j_581374] = copy_arg0_581392;
                            ((int64_t *) mem_586633)[copy_arg0_581384] = copy_arg0_581379;
                            ((float *) mem_586635)[copy_arg0_581384] = copy_arg0_581380;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586638, copy_arg0_581384 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586699, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_586640)[copy_arg0_581384] = copy_arg0_581382;
                            
                            int64_t tmp_581402 = sub64(j_581374, (int64_t) 1);
                            bool cond_581403 = sle64((int64_t) 0, tmp_581402);
                            bool loop_cond_581404;
                            
                            if (cond_581403) {
                                bool y_585789 = slt64(tmp_581402, block_sizze_581247);
                                bool bounds_check_585790 = cond_581403 && y_585789;
                                bool index_certs_585791;
                                
                                if (!bounds_check_585790) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581402, "] out of bounds for array of shape [", (long long) block_sizze_581247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585787 = ((int64_t *) mem_586633)[j_581374];
                                float gt_arg1_585788 = ((float *) mem_586635)[j_581374];
                                int64_t gt_arg0_585792 = ((int64_t *) mem_586633)[tmp_581402];
                                float gt_arg0_585793 = ((float *) mem_586635)[tmp_581402];
                                bool cond_585794 = slt64(gt_arg0_585792, gt_arg1_585787);
                                bool cond_585795 = gt_arg0_585792 == gt_arg1_585787;
                                bool zlze_res_585796 = gt_arg0_585793 <= gt_arg1_585788;
                                bool x_585797 = cond_585795 && zlze_res_585796;
                                bool x_585798 = !cond_585794;
                                bool y_585799 = x_585797 && x_585798;
                                bool defunc_0_leq_res_585800 = cond_585794 || y_585799;
                                bool defunc_0_lifted_gt_res_585801 = !defunc_0_leq_res_585800;
                                
                                loop_cond_581404 = defunc_0_lifted_gt_res_585801;
                            } else {
                                loop_cond_581404 = 0;
                            }
                            
                            bool loop_while_tmp_588138 = loop_cond_581404;
                            int64_t j_tmp_588143 = tmp_581402;
                            
                            loop_while_581369 = loop_while_tmp_588138;
                            j_581374 = j_tmp_588143;
                        }
                        s_581363 = loop_while_581369;
                        s_581368 = j_581374;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586603, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586633, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586606, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586635, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_586610, i_586232 * lmad_arg_586631, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) mem_586638, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {block_sizze_581247, dim_438949});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586613, i_586232 * block_sizze_581247, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586640, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581247});
            }
            if (memblock_unref(ctx, &ext_mem_586600, "ext_mem_586600") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586760, bytes_586602, "mem_586760")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586760.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint64_t *) mem_586603, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            if (memblock_alloc(ctx, &mem_586764, bytes_586605, "mem_586764")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_586764.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint32_t *) mem_586606, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            if (memblock_alloc(ctx, &mem_586769, bytes_586609, "mem_586769")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_586769.mem, (int64_t) 0, (int64_t []) {dim_438949 * block_sizze_581247, dim_438949, (int64_t) 1}, (uint32_t *) mem_586610, (int64_t) 0, (int64_t []) {lmad_arg_586631, dim_438949, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247, dim_438949});
            if (memblock_alloc(ctx, &mem_586773, bytes_586602, "mem_586773")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586773.mem, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (uint64_t *) mem_586613, (int64_t) 0, (int64_t []) {block_sizze_581247, (int64_t) 1}, (int64_t []) {x_582331, block_sizze_581247});
            
            int64_t data_581429;
            bool data_581430;
            int64_t data_581435;
            int64_t loop_dz2084Uz2082U_581436;
            bool loop_while_581437;
            int64_t stride_581442;
            
            if (memblock_set(ctx, &mem_param_586777, &mem_586760, "mem_586760") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586780, &mem_586764, "mem_586764") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586784, &mem_586769, "mem_586769") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586787, &mem_586773, "mem_586773") != 0)
                return 1;
            loop_dz2084Uz2082U_581436 = flat_dim_581257;
            loop_while_581437 = loop_cond_581426;
            stride_581442 = block_sizze_581247;
            while (loop_while_581437) {
                int64_t next_stride_581443 = mul64((int64_t) 2, stride_581442);
                bool zzero_581444 = next_stride_581443 == (int64_t) 0;
                bool nonzzero_581445 = !zzero_581444;
                bool nonzzero_cert_581446;
                
                if (!nonzzero_581445) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_581447 = sdiv64(flat_dim_581257, next_stride_581443);
                bool bounds_invalid_upwards_581448 = slt64(num_merges_581447, (int64_t) 0);
                bool valid_581449 = !bounds_invalid_upwards_581448;
                bool range_valid_c_581450;
                
                if (!valid_581449) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_581447, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:952:33-56\n   #7  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_581452 = sub64(next_stride_581443, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_581453 = sle64((int64_t) 0, m_581452);
                bool cond_581455 = slt64(next_stride_581443, (int64_t) 10);
                bool protect_assert_disj_581456 = nonzzero_581428 || cond_581455;
                bool nonzzero_cert_581457;
                
                if (!protect_assert_disj_581456) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_581458 = smod_safe64(next_stride_581443, merge_block_sizze_581263);
                bool num_blocks_581459 = zeze_lhs_581458 == (int64_t) 0;
                bool protect_assert_disj_581460 = cond_581455 || num_blocks_581459;
                bool assert_c_581461;
                
                if (!protect_assert_disj_581460) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_581464 = sdiv_safe64(next_stride_581443, merge_block_sizze_581263);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465 = add64((int64_t) 1, num_blocks_581464);
                int64_t j_m_i_581466 = sub64(next_stride_581443, stride_581442);
                int64_t flat_dim_581467 = merge_block_sizze_581263 * num_blocks_581464;
                bool bounds_invalid_upwards_581468 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, (int64_t) 0);
                bool zzero_lte_i_581469 = sle64((int64_t) 0, stride_581442);
                bool i_lte_j_581470 = sle64(stride_581442, next_stride_581443);
                bool empty_slice_581471 = stride_581442 == (int64_t) 0;
                int64_t m_581472 = sub64(stride_581442, (int64_t) 1);
                bool bounds_invalid_upwards_581473 = slt64(num_blocks_581464, (int64_t) 0);
                bool empty_slice_581474 = j_m_i_581466 == (int64_t) 0;
                int64_t m_581475 = sub64(j_m_i_581466, (int64_t) 1);
                bool cond_581476 = slt64((int64_t) 0, stride_581442);
                bool valid_581477 = !bounds_invalid_upwards_581468;
                bool zzero_leq_i_p_m_t_s_581478 = sle64((int64_t) 0, m_581472);
                bool i_p_m_t_s_leq_w_581479 = slt64(m_581472, next_stride_581443);
                bool valid_581480 = !bounds_invalid_upwards_581473;
                bool i_p_m_t_s_leq_w_581481 = slt64(m_581452, flat_dim_581467);
                int64_t i_p_m_t_s_581482 = add64(stride_581442, m_581475);
                bool y_581483 = slt64((int64_t) 0, j_m_i_581466);
                bool protect_assert_disj_581484 = cond_581455 || valid_581477;
                bool range_valid_c_581485;
                
                if (!protect_assert_disj_581484) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581486 = zzero_leq_i_p_m_t_s_581478 && i_p_m_t_s_leq_w_581479;
                bool protect_assert_disj_581487 = cond_581455 || valid_581480;
                bool range_valid_c_581488;
                
                if (!protect_assert_disj_581487) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_581464, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581489 = zzero_leq_i_p_m_t_s_581453 && i_p_m_t_s_leq_w_581481;
                bool zzero_leq_i_p_m_t_s_581490 = sle64((int64_t) 0, i_p_m_t_s_581482);
                bool i_p_m_t_s_leq_w_581491 = slt64(i_p_m_t_s_581482, next_stride_581443);
                bool forwards_ok_581492 = zzero_lte_i_581469 && y_581486;
                bool ok_or_empty_581493 = zzero_581444 || y_581489;
                bool y_581494 = zzero_lte_i_581469 && i_p_m_t_s_leq_w_581491;
                bool protect_assert_disj_581495 = cond_581476 || y_581483;
                bool ok_or_empty_581496 = empty_slice_581471 || forwards_ok_581492;
                bool protect_assert_disj_581497 = cond_581455 || ok_or_empty_581493;
                bool index_certs_581498;
                
                if (!protect_assert_disj_581497) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581443, "] out of bounds for array of shape [", (long long) flat_dim_581467, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581499 = zzero_leq_i_p_m_t_s_581490 && y_581494;
                bool loop_not_taken_581500 = !cond_581455;
                bool protect_assert_disj_581501 = protect_assert_disj_581495 || loop_not_taken_581500;
                bool index_certs_581502;
                
                if (!protect_assert_disj_581501) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581503 = cond_581455 || ok_or_empty_581496;
                bool index_certs_581504;
                
                if (!protect_assert_disj_581503) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581442, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_581505 = i_lte_j_581470 && y_581499;
                bool protect_assert_disj_581506 = ok_or_empty_581496 || loop_not_taken_581500;
                bool index_certs_581507;
                
                if (!protect_assert_disj_581506) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581442, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_581508 = empty_slice_581474 || forwards_ok_581505;
                bool protect_assert_disj_581509 = loop_not_taken_581500 || ok_or_empty_581508;
                bool index_certs_581510;
                
                if (!protect_assert_disj_581509) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581442, ":] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581511 = cond_581455 || ok_or_empty_581508;
                bool index_certs_581512;
                
                if (!protect_assert_disj_581511) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581442, ":] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586788 = (int64_t) 8 * num_merges_581447;
                int64_t bytes_586789 = next_stride_581443 * binop_x_586788;
                int64_t binop_x_586791 = (int64_t) 4 * num_merges_581447;
                int64_t bytes_586792 = next_stride_581443 * binop_x_586791;
                int64_t bytes_586796 = dim_438949 * bytes_586792;
                bool i_lte_j_581454 = sle64((int64_t) 0, next_stride_581443);
                
                if (mem_586790_cached_sizze_588770 < bytes_586789) {
                    err = lexical_realloc(ctx, &mem_586790, &mem_586790_cached_sizze_588770, bytes_586789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586793_cached_sizze_588771 < bytes_586792) {
                    err = lexical_realloc(ctx, &mem_586793, &mem_586793_cached_sizze_588771, bytes_586792);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586797_cached_sizze_588772 < bytes_586796) {
                    err = lexical_realloc(ctx, &mem_586797, &mem_586797_cached_sizze_588772, bytes_586796);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586800_cached_sizze_588773 < bytes_586789) {
                    err = lexical_realloc(ctx, &mem_586800, &mem_586800_cached_sizze_588773, bytes_586789);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586818 = dim_438949 * next_stride_581443;
                int64_t bytes_586819 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465;
                int64_t binop_x_586835 = (int64_t) 8 * num_blocks_581464;
                int64_t bytes_586836 = merge_block_sizze_581263 * binop_x_586835;
                int64_t binop_x_586838 = (int64_t) 4 * num_blocks_581464;
                int64_t bytes_586839 = merge_block_sizze_581263 * binop_x_586838;
                int64_t bytes_586843 = dim_438949 * bytes_586839;
                int64_t bytes_586950 = (int64_t) 16 * stride_581442;
                int64_t bytes_586952 = (int64_t) 8 * stride_581442;
                int64_t bytes_586957 = dim_438949 * bytes_586952;
                
                for (int64_t i_586265 = 0; i_586265 < num_merges_581447; i_586265++) {
                    int64_t start_581518 = mul64(next_stride_581443, i_586265);
                    int64_t j_m_i_581519 = sub64(loop_dz2084Uz2082U_581436, start_581518);
                    bool empty_slice_581520 = j_m_i_581519 == (int64_t) 0;
                    int64_t m_581521 = sub64(j_m_i_581519, (int64_t) 1);
                    int64_t i_p_m_t_s_581522 = add64(start_581518, m_581521);
                    bool zzero_leq_i_p_m_t_s_581523 = sle64((int64_t) 0, i_p_m_t_s_581522);
                    bool i_p_m_t_s_leq_w_581524 = slt64(i_p_m_t_s_581522, loop_dz2084Uz2082U_581436);
                    bool zzero_lte_i_581525 = sle64((int64_t) 0, start_581518);
                    bool i_lte_j_581526 = sle64(start_581518, loop_dz2084Uz2082U_581436);
                    bool y_581527 = i_p_m_t_s_leq_w_581524 && zzero_lte_i_581525;
                    bool y_581528 = zzero_leq_i_p_m_t_s_581523 && y_581527;
                    bool forwards_ok_581529 = i_lte_j_581526 && y_581528;
                    bool ok_or_empty_581530 = empty_slice_581520 || forwards_ok_581529;
                    bool index_certs_581531;
                    
                    if (!ok_or_empty_581530) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_581518, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_581436, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_581532 = slt64(m_581452, j_m_i_581519);
                    bool y_581533 = zzero_leq_i_p_m_t_s_581453 && i_p_m_t_s_leq_w_581532;
                    bool forwards_ok_581534 = i_lte_j_581454 && y_581533;
                    bool ok_or_empty_581535 = zzero_581444 || forwards_ok_581534;
                    bool index_certs_581536;
                    
                    if (!ok_or_empty_581535) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581443, "] out of bounds for array of shape [", (long long) j_m_i_581519, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:351:58-85\n   #8  ftSkyline.fut:952:33-56\n   #9  ftSkyline.fut:939:17-952:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585849 = stride_581442 + start_581518;
                    int64_t binop_y_586945 = dim_438949 * slice_585849;
                    int64_t binop_y_586947 = dim_438949 * start_581518;
                    int64_t ext_586949;
                    
                    if (cond_581476) {
                        ext_586949 = binop_y_586947;
                    } else {
                        ext_586949 = binop_y_586945;
                    }
                    if (cond_581455) {
                        int64_t dummy_585841;
                        float dummy_585842;
                        int64_t dummy_585844;
                        
                        if (cond_581476) {
                            int64_t head_res_585845 = ((int64_t *) mem_param_586777.mem)[start_581518];
                            float head_res_585846 = ((float *) mem_param_586780.mem)[start_581518];
                            int64_t head_res_585848 = ((int64_t *) mem_param_586787.mem)[start_581518];
                            
                            dummy_585841 = head_res_585845;
                            dummy_585842 = head_res_585846;
                            dummy_585844 = head_res_585848;
                        } else {
                            int64_t head_res_585850 = ((int64_t *) mem_param_586777.mem)[slice_585849];
                            float head_res_585851 = ((float *) mem_param_586780.mem)[slice_585849];
                            int64_t head_res_585853 = ((int64_t *) mem_param_586787.mem)[slice_585849];
                            
                            dummy_585841 = head_res_585850;
                            dummy_585842 = head_res_585851;
                            dummy_585844 = head_res_585853;
                        }
                        if (memblock_alloc(ctx, &mem_586951, bytes_586950, "mem_586951")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588159 = 0; nest_i_588159 < next_stride_581443; nest_i_588159++) {
                            ((int64_t *) mem_586951.mem)[nest_i_588159] = dummy_585841;
                        }
                        if (memblock_alloc(ctx, &mem_586953, bytes_586952, "mem_586953")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588160 = 0; nest_i_588160 < next_stride_581443; nest_i_588160++) {
                            ((float *) mem_586953.mem)[nest_i_588160] = dummy_585842;
                        }
                        if (memblock_alloc(ctx, &mem_586955, bytes_586950, "mem_586955")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588161 = 0; nest_i_588161 < next_stride_581443; nest_i_588161++) {
                            ((int64_t *) mem_586955.mem)[nest_i_588161] = dummy_585844;
                        }
                        if (memblock_alloc(ctx, &mem_586958, bytes_586957, "mem_586958")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588162 = 0; nest_i_588162 < next_stride_581443; nest_i_588162++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586958.mem, nest_i_588162 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586784.mem, ext_586949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                        }
                        
                        int64_t data_585858;
                        int64_t i_585864 = (int64_t) 0;
                        
                        for (int64_t k_585863 = 0; k_585863 < next_stride_581443; k_585863++) {
                            int64_t j_585869 = sub64(k_585863, i_585864);
                            bool cond_585870 = j_585869 == j_m_i_581466;
                            bool x_587830 = !cond_585870;
                            bool cond_585872 = slt64(i_585864, stride_581442);
                            bool x_585874 = sle64((int64_t) 0, j_585869);
                            bool y_585875 = slt64(j_585869, j_m_i_581466);
                            bool bounds_check_585876 = x_585874 && y_585875;
                            bool loop_not_taken_587818 = !cond_585872;
                            bool protect_assert_disj_587819 = bounds_check_585876 || loop_not_taken_587818;
                            bool protect_assert_disj_587833 = cond_585870 || protect_assert_disj_587819;
                            bool index_certs_585877;
                            
                            if (!protect_assert_disj_587833) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585869, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585878 = stride_581442 + j_585869;
                            int64_t slice_585879 = start_581518 + slice_585878;
                            bool protect_cond_conj_587834 = cond_585872 && x_587830;
                            int64_t leq_arg1_585880;
                            
                            if (protect_cond_conj_587834) {
                                int64_t x_587820 = ((int64_t *) mem_param_586777.mem)[slice_585879];
                                
                                leq_arg1_585880 = x_587820;
                            } else {
                                leq_arg1_585880 = (int64_t) 0;
                            }
                            
                            float leq_arg1_585881;
                            
                            if (protect_cond_conj_587834) {
                                float x_587822 = ((float *) mem_param_586780.mem)[slice_585879];
                                
                                leq_arg1_585881 = x_587822;
                            } else {
                                leq_arg1_585881 = 0.0F;
                            }
                            
                            bool x_585882 = sle64((int64_t) 0, i_585864);
                            bool bounds_check_585883 = cond_585872 && x_585882;
                            bool protect_assert_disj_587825 = bounds_check_585883 || loop_not_taken_587818;
                            bool protect_assert_disj_587837 = cond_585870 || protect_assert_disj_587825;
                            bool index_certs_585884;
                            
                            if (!protect_assert_disj_587837) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585864, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585885 = start_581518 + i_585864;
                            int64_t leq_arg0_585886;
                            
                            if (protect_cond_conj_587834) {
                                int64_t x_587826 = ((int64_t *) mem_param_586777.mem)[slice_585885];
                                
                                leq_arg0_585886 = x_587826;
                            } else {
                                leq_arg0_585886 = (int64_t) 0;
                            }
                            
                            float leq_arg0_585887;
                            
                            if (protect_cond_conj_587834) {
                                float x_587828 = ((float *) mem_param_586780.mem)[slice_585885];
                                
                                leq_arg0_585887 = x_587828;
                            } else {
                                leq_arg0_585887 = 0.0F;
                            }
                            
                            bool cond_585888 = slt64(leq_arg0_585886, leq_arg1_585880);
                            bool cond_585889 = leq_arg0_585886 == leq_arg1_585880;
                            bool zlze_res_585890 = leq_arg0_585887 <= leq_arg1_585881;
                            bool x_585891 = cond_585889 && zlze_res_585890;
                            bool x_585892 = !cond_585888;
                            bool y_585893 = x_585891 && x_585892;
                            bool defunc_0_leq_res_585894 = cond_585888 || y_585893;
                            bool x_587873 = cond_585872 && defunc_0_leq_res_585894;
                            bool cond_585871 = cond_585870 || x_587873;
                            bool protect_assert_disj_587734 = cond_585871 || bounds_check_585876;
                            bool index_certs_585913;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585869, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585903 = cond_585872 && x_585882;
                            bool loop_not_taken_587729 = !cond_585871;
                            bool protect_assert_disj_587730 = bounds_check_585903 || loop_not_taken_587729;
                            bool index_certs_585904;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585864, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:351:58-85\n   #9  ftSkyline.fut:952:33-56\n   #10 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585915 = start_581518 + slice_585878;
                            int64_t binop_y_586972 = dim_438949 * slice_585915;
                            int64_t binop_y_586974 = dim_438949 * slice_585885;
                            int64_t ext_586976;
                            
                            if (cond_585871) {
                                ext_586976 = binop_y_586974;
                            } else {
                                ext_586976 = binop_y_586972;
                            }
                            
                            int64_t loopres_585895;
                            int64_t loopres_585896;
                            float loopres_585897;
                            int64_t loopres_585899;
                            
                            if (cond_585871) {
                                int64_t tmp_585900 = add64((int64_t) 1, i_585864);
                                int64_t tmp_585906 = ((int64_t *) mem_param_586777.mem)[slice_585885];
                                float tmp_585907 = ((float *) mem_param_586780.mem)[slice_585885];
                                int64_t tmp_585909 = ((int64_t *) mem_param_586787.mem)[slice_585885];
                                
                                loopres_585895 = tmp_585900;
                                loopres_585896 = tmp_585906;
                                loopres_585897 = tmp_585907;
                                loopres_585899 = tmp_585909;
                            } else {
                                int64_t tmp_585916 = ((int64_t *) mem_param_586777.mem)[slice_585915];
                                float tmp_585917 = ((float *) mem_param_586780.mem)[slice_585915];
                                int64_t tmp_585919 = ((int64_t *) mem_param_586787.mem)[slice_585915];
                                
                                loopres_585895 = i_585864;
                                loopres_585896 = tmp_585916;
                                loopres_585897 = tmp_585917;
                                loopres_585899 = tmp_585919;
                            }
                            ((int64_t *) mem_586951.mem)[k_585863] = loopres_585896;
                            ((float *) mem_586953.mem)[k_585863] = loopres_585897;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586958.mem, k_585863 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586784.mem, ext_586976, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            ((int64_t *) mem_586955.mem)[k_585863] = loopres_585899;
                            
                            int64_t i_tmp_588163 = loopres_585895;
                            
                            i_585864 = i_tmp_588163;
                        }
                        data_585858 = i_585864;
                        if (memblock_set(ctx, &ext_mem_587002, &mem_586951, "mem_586951") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586999, &mem_586953, "mem_586953") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586996, &mem_586958, "mem_586958") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586992, &mem_586955, "mem_586955") != 0)
                            return 1;
                    } else {
                        if (mem_586820_cached_sizze_588774 < bytes_586819) {
                            err = lexical_realloc(ctx, &mem_586820, &mem_586820_cached_sizze_588774, bytes_586819);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586822_cached_sizze_588775 < bytes_586819) {
                            err = lexical_realloc(ctx, &mem_586822, &mem_586822_cached_sizze_588775, bytes_586819);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586241 = 0; i_586241 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465; i_586241++) {
                            int64_t split_count_arg3_581628 = mul64(merge_block_sizze_581263, i_586241);
                            int64_t defunc_0_split_count_res_581629;
                            int64_t defunc_0_split_count_res_581630;
                            int64_t defunc_0_split_count_res_581631;
                            int64_t defunc_0_split_count_res_581632;
                            int64_t defunc_0_split_count_res_581633;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_581629, &defunc_0_split_count_res_581630, &defunc_0_split_count_res_581631, &defunc_0_split_count_res_581632, &defunc_0_split_count_res_581633, (int64_t) 0, stride_581442, (int64_t) 0, j_m_i_581466, split_count_arg3_581628) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_581634 = slt64((int64_t) 0, defunc_0_split_count_res_581633);
                            bool defunc_0_split_count_res_581635;
                            int64_t defunc_0_split_count_res_581636;
                            int64_t defunc_0_split_count_res_581637;
                            int64_t defunc_0_split_count_res_581638;
                            int64_t defunc_0_split_count_res_581639;
                            int64_t defunc_0_split_count_res_581640;
                            bool loop_while_581641;
                            int64_t ss_581642;
                            int64_t ss_581643;
                            int64_t tt_581644;
                            int64_t tt_581645;
                            int64_t count_581646;
                            
                            loop_while_581641 = loop_cond_581634;
                            ss_581642 = defunc_0_split_count_res_581629;
                            ss_581643 = defunc_0_split_count_res_581630;
                            tt_581644 = defunc_0_split_count_res_581631;
                            tt_581645 = defunc_0_split_count_res_581632;
                            count_581646 = defunc_0_split_count_res_581633;
                            while (loop_while_581641) {
                                int64_t zlze_lhs_581647 = sub64(ss_581643, ss_581642);
                                bool cond_581648 = sle64(zlze_lhs_581647, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_581649;
                                int64_t defunc_0_lifted_step_res_581650;
                                int64_t defunc_0_lifted_step_res_581651;
                                int64_t defunc_0_lifted_step_res_581652;
                                
                                if (cond_581648) {
                                    int64_t tmp_585924 = add64(tt_581644, count_581646);
                                    
                                    defunc_0_lifted_step_res_581649 = ss_581642;
                                    defunc_0_lifted_step_res_581650 = tmp_585924;
                                    defunc_0_lifted_step_res_581651 = tt_581645;
                                    defunc_0_lifted_step_res_581652 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_581654 = sub64(tt_581645, tt_581644);
                                    bool cond_581655 = sle64(zlze_lhs_581654, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_581656;
                                    int64_t defunc_0_lifted_step_res_f_res_581657;
                                    int64_t defunc_0_lifted_step_res_f_res_581658;
                                    int64_t defunc_0_lifted_step_res_f_res_581659;
                                    
                                    if (cond_581655) {
                                        int64_t tmp_585925 = add64(ss_581642, count_581646);
                                        
                                        defunc_0_lifted_step_res_f_res_581656 = tmp_585925;
                                        defunc_0_lifted_step_res_f_res_581657 = tt_581644;
                                        defunc_0_lifted_step_res_f_res_581658 = tt_581645;
                                        defunc_0_lifted_step_res_f_res_581659 = (int64_t) 0;
                                    } else {
                                        bool cond_581661 = count_581646 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581662;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581663;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581664;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581665;
                                        
                                        if (cond_581661) {
                                            bool x_585927 = sle64((int64_t) 0, ss_581642);
                                            bool y_585928 = slt64(ss_581642, stride_581442);
                                            bool bounds_check_585929 = x_585927 && y_585928;
                                            bool index_certs_585930;
                                            
                                            if (!bounds_check_585929) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_581642, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:952:33-56\n   #14 ftSkyline.fut:939:17-952:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585934 = sle64((int64_t) 0, tt_581644);
                                            bool y_585935 = slt64(tt_581644, j_m_i_581466);
                                            bool bounds_check_585936 = x_585934 && y_585935;
                                            bool index_certs_585937;
                                            
                                            if (!bounds_check_585936) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_581644, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:952:33-56\n   #14 ftSkyline.fut:939:17-952:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585931 = start_581518 + ss_581642;
                                            int64_t leq_arg1_585932 = ((int64_t *) mem_param_586777.mem)[slice_585931];
                                            float leq_arg1_585933 = ((float *) mem_param_586780.mem)[slice_585931];
                                            int64_t slice_585938 = stride_581442 + tt_581644;
                                            int64_t slice_585939 = start_581518 + slice_585938;
                                            int64_t leq_arg0_585940 = ((int64_t *) mem_param_586777.mem)[slice_585939];
                                            float leq_arg0_585941 = ((float *) mem_param_586780.mem)[slice_585939];
                                            bool cond_585942 = slt64(leq_arg0_585940, leq_arg1_585932);
                                            bool cond_585943 = leq_arg0_585940 == leq_arg1_585932;
                                            bool zlze_res_585944 = leq_arg0_585941 <= leq_arg1_585933;
                                            bool x_585945 = cond_585943 && zlze_res_585944;
                                            bool x_585946 = !cond_585942;
                                            bool y_585947 = x_585945 && x_585946;
                                            bool defunc_0_leq_res_585948 = cond_585942 || y_585947;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585949;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585950;
                                            
                                            if (defunc_0_leq_res_585948) {
                                                int64_t tmp_585951 = add64((int64_t) 1, tt_581644);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585949 = ss_581642;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585950 = tmp_585951;
                                            } else {
                                                int64_t tmp_585952 = add64((int64_t) 1, ss_581642);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585949 = tmp_585952;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585950 = tt_581644;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581662 = defunc_0_lifted_step_res_f_res_f_res_t_res_585949;
                                            defunc_0_lifted_step_res_f_res_f_res_581663 = defunc_0_lifted_step_res_f_res_f_res_t_res_585950;
                                            defunc_0_lifted_step_res_f_res_f_res_581664 = tt_581645;
                                            defunc_0_lifted_step_res_f_res_f_res_581665 = (int64_t) 0;
                                        } else {
                                            int64_t m_581692 = sdiv64(count_581646, (int64_t) 2);
                                            int64_t n_581693 = sub64(count_581646, m_581692);
                                            bool cond_581694 = n_581693 == (int64_t) 0;
                                            int64_t zgze_lhs_581695 = add64(ss_581642, m_581692);
                                            bool cond_f_res_581696 = sle64(ss_581643, zgze_lhs_581695);
                                            bool x_581697 = !cond_581694;
                                            bool y_581698 = cond_f_res_581696 && x_581697;
                                            bool cond_581699 = cond_581694 || y_581698;
                                            bool leq_y_x_581700;
                                            
                                            if (cond_581699) {
                                                leq_y_x_581700 = 1;
                                            } else {
                                                bool x_581701 = sle64((int64_t) 0, zgze_lhs_581695);
                                                bool y_581702 = slt64(zgze_lhs_581695, stride_581442);
                                                bool bounds_check_581703 = x_581701 && y_581702;
                                                bool index_certs_581704;
                                                
                                                if (!bounds_check_581703) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_581695, "] out of bounds for array of shape [", (long long) stride_581442, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:952:33-56\n   #14 ftSkyline.fut:939:17-952:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_581708 = add64(tt_581644, n_581693);
                                                int64_t leq_arg0_581709 = sub64(zm_lhs_581708, (int64_t) 1);
                                                bool x_581710 = sle64((int64_t) 0, leq_arg0_581709);
                                                bool y_581711 = slt64(leq_arg0_581709, j_m_i_581466);
                                                bool bounds_check_581712 = x_581710 && y_581711;
                                                bool index_certs_581713;
                                                
                                                if (!bounds_check_581712) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_581709, "] out of bounds for array of shape [", (long long) j_m_i_581466, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:351:58-85\n   #13 ftSkyline.fut:952:33-56\n   #14 ftSkyline.fut:939:17-952:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_581705 = start_581518 + zgze_lhs_581695;
                                                int64_t leq_arg1_581706 = ((int64_t *) mem_param_586777.mem)[slice_581705];
                                                float leq_arg1_581707 = ((float *) mem_param_586780.mem)[slice_581705];
                                                int64_t slice_581714 = stride_581442 + leq_arg0_581709;
                                                int64_t slice_581715 = start_581518 + slice_581714;
                                                int64_t leq_arg0_581716 = ((int64_t *) mem_param_586777.mem)[slice_581715];
                                                float leq_arg0_581717 = ((float *) mem_param_586780.mem)[slice_581715];
                                                bool cond_581718 = slt64(leq_arg0_581716, leq_arg1_581706);
                                                bool cond_581719 = leq_arg0_581716 == leq_arg1_581706;
                                                bool zlze_res_581720 = leq_arg0_581717 <= leq_arg1_581707;
                                                bool x_581721 = cond_581719 && zlze_res_581720;
                                                bool x_581722 = !cond_581718;
                                                bool y_581723 = x_581721 && x_581722;
                                                bool defunc_0_leq_res_581724 = cond_581718 || y_581723;
                                                
                                                leq_y_x_581700 = defunc_0_leq_res_581724;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581725;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581726;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581727;
                                            
                                            if (leq_y_x_581700) {
                                                int64_t tmp_585953 = add64(tt_581644, n_581693);
                                                int64_t tmp_585954 = sub64(count_581646, n_581693);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581725 = tmp_585953;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581726 = tt_581645;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581727 = tmp_585954;
                                            } else {
                                                int64_t tmp_581730 = add64(tt_581644, n_581693);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581725 = tt_581644;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581726 = tmp_581730;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581727 = count_581646;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581662 = ss_581642;
                                            defunc_0_lifted_step_res_f_res_f_res_581663 = defunc_0_lifted_step_res_f_res_f_res_f_res_581725;
                                            defunc_0_lifted_step_res_f_res_f_res_581664 = defunc_0_lifted_step_res_f_res_f_res_f_res_581726;
                                            defunc_0_lifted_step_res_f_res_f_res_581665 = defunc_0_lifted_step_res_f_res_f_res_f_res_581727;
                                        }
                                        defunc_0_lifted_step_res_f_res_581656 = defunc_0_lifted_step_res_f_res_f_res_581662;
                                        defunc_0_lifted_step_res_f_res_581657 = defunc_0_lifted_step_res_f_res_f_res_581663;
                                        defunc_0_lifted_step_res_f_res_581658 = defunc_0_lifted_step_res_f_res_f_res_581664;
                                        defunc_0_lifted_step_res_f_res_581659 = defunc_0_lifted_step_res_f_res_f_res_581665;
                                    }
                                    defunc_0_lifted_step_res_581649 = defunc_0_lifted_step_res_f_res_581656;
                                    defunc_0_lifted_step_res_581650 = defunc_0_lifted_step_res_f_res_581657;
                                    defunc_0_lifted_step_res_581651 = defunc_0_lifted_step_res_f_res_581658;
                                    defunc_0_lifted_step_res_581652 = defunc_0_lifted_step_res_f_res_581659;
                                }
                                
                                int64_t loopres_581731;
                                int64_t loopres_581732;
                                int64_t loopres_581733;
                                int64_t loopres_581734;
                                int64_t loopres_581735;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_581731, &loopres_581732, &loopres_581733, &loopres_581734, &loopres_581735, defunc_0_lifted_step_res_581649, ss_581643, defunc_0_lifted_step_res_581650, defunc_0_lifted_step_res_581651, defunc_0_lifted_step_res_581652) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_581736 = slt64((int64_t) 0, loopres_581735);
                                bool loop_while_tmp_588170 = loop_cond_581736;
                                int64_t ss_tmp_588171 = loopres_581731;
                                int64_t ss_tmp_588172 = loopres_581732;
                                int64_t tt_tmp_588173 = loopres_581733;
                                int64_t tt_tmp_588174 = loopres_581734;
                                int64_t count_tmp_588175 = loopres_581735;
                                
                                loop_while_581641 = loop_while_tmp_588170;
                                ss_581642 = ss_tmp_588171;
                                ss_581643 = ss_tmp_588172;
                                tt_581644 = tt_tmp_588173;
                                tt_581645 = tt_tmp_588174;
                                count_581646 = count_tmp_588175;
                            }
                            defunc_0_split_count_res_581635 = loop_while_581641;
                            defunc_0_split_count_res_581636 = ss_581642;
                            defunc_0_split_count_res_581637 = ss_581643;
                            defunc_0_split_count_res_581638 = tt_581644;
                            defunc_0_split_count_res_581639 = tt_581645;
                            defunc_0_split_count_res_581640 = count_581646;
                            ((int64_t *) mem_586820)[i_586241] = defunc_0_split_count_res_581636;
                            ((int64_t *) mem_586822)[i_586241] = defunc_0_split_count_res_581638;
                        }
                        if (mem_586837_cached_sizze_588776 < bytes_586836) {
                            err = lexical_realloc(ctx, &mem_586837, &mem_586837_cached_sizze_588776, bytes_586836);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586840_cached_sizze_588777 < bytes_586839) {
                            err = lexical_realloc(ctx, &mem_586840, &mem_586840_cached_sizze_588777, bytes_586839);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586844_cached_sizze_588778 < bytes_586843) {
                            err = lexical_realloc(ctx, &mem_586844, &mem_586844_cached_sizze_588778, bytes_586843);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586847_cached_sizze_588779 < bytes_586836) {
                            err = lexical_realloc(ctx, &mem_586847, &mem_586847_cached_sizze_588779, bytes_586836);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586252 = 0; i_586252 < num_blocks_581464; i_586252++) {
                            bool y_581744 = slt64(i_586252, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465);
                            bool index_certs_581746;
                            
                            if (!y_581744) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586252, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581747 = ((int64_t *) mem_586820)[i_586252];
                            int64_t defunc_0_f_res_581748 = ((int64_t *) mem_586822)[i_586252];
                            int64_t tmp_581749 = add64((int64_t) 1, i_586252);
                            bool x_581750 = sle64((int64_t) 0, tmp_581749);
                            bool y_581751 = slt64(tmp_581749, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465);
                            bool bounds_check_581752 = x_581750 && y_581751;
                            bool index_certs_581753;
                            
                            if (!bounds_check_581752) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581749, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581465, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581754 = ((int64_t *) mem_586820)[tmp_581749];
                            int64_t defunc_0_f_res_581755 = ((int64_t *) mem_586822)[tmp_581749];
                            int64_t merge_sequential_arg2_581756 = add64(stride_581442, defunc_0_f_res_581748);
                            int64_t merge_sequential_arg2_581757 = add64(stride_581442, defunc_0_f_res_581755);
                            int64_t j_m_i_581758 = sub64(merge_sequential_arg2_581757, merge_sequential_arg2_581756);
                            bool empty_slice_581759 = j_m_i_581758 == (int64_t) 0;
                            int64_t m_581760 = sub64(j_m_i_581758, (int64_t) 1);
                            int64_t i_p_m_t_s_581761 = add64(merge_sequential_arg2_581756, m_581760);
                            bool zzero_leq_i_p_m_t_s_581762 = sle64((int64_t) 0, i_p_m_t_s_581761);
                            bool i_p_m_t_s_leq_w_581763 = slt64(i_p_m_t_s_581761, next_stride_581443);
                            bool zzero_lte_i_581764 = sle64((int64_t) 0, merge_sequential_arg2_581756);
                            bool i_lte_j_581765 = sle64(merge_sequential_arg2_581756, merge_sequential_arg2_581757);
                            bool y_581766 = i_p_m_t_s_leq_w_581763 && zzero_lte_i_581764;
                            bool y_581767 = zzero_leq_i_p_m_t_s_581762 && y_581766;
                            bool forwards_ok_581768 = i_lte_j_581765 && y_581767;
                            bool ok_or_empty_581769 = empty_slice_581759 || forwards_ok_581768;
                            bool index_certs_581770;
                            
                            if (!ok_or_empty_581769) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_581756, ":", (long long) merge_sequential_arg2_581757, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_581771 = sub64(defunc_0_f_res_581754, defunc_0_f_res_581747);
                            bool empty_slice_581772 = j_m_i_581771 == (int64_t) 0;
                            int64_t m_581773 = sub64(j_m_i_581771, (int64_t) 1);
                            int64_t i_p_m_t_s_581774 = add64(defunc_0_f_res_581747, m_581773);
                            bool zzero_leq_i_p_m_t_s_581775 = sle64((int64_t) 0, i_p_m_t_s_581774);
                            bool i_p_m_t_s_leq_w_581776 = slt64(i_p_m_t_s_581774, next_stride_581443);
                            bool zzero_lte_i_581777 = sle64((int64_t) 0, defunc_0_f_res_581747);
                            bool i_lte_j_581778 = sle64(defunc_0_f_res_581747, defunc_0_f_res_581754);
                            bool y_581779 = i_p_m_t_s_leq_w_581776 && zzero_lte_i_581777;
                            bool y_581780 = zzero_leq_i_p_m_t_s_581775 && y_581779;
                            bool forwards_ok_581781 = i_lte_j_581778 && y_581780;
                            bool ok_or_empty_581782 = empty_slice_581772 || forwards_ok_581781;
                            bool index_certs_581783;
                            
                            if (!ok_or_empty_581782) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_581747, ":", (long long) defunc_0_f_res_581754, "] out of bounds for array of shape [", (long long) next_stride_581443, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:351:58-85\n   #10 ftSkyline.fut:952:33-56\n   #11 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_581784 = slt64((int64_t) 0, j_m_i_581771);
                            bool y_581795 = slt64((int64_t) 0, j_m_i_581758);
                            bool protect_assert_disj_587750 = cond_581784 || y_581795;
                            bool index_certs_581796;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:351:58-85\n   #12 ftSkyline.fut:952:33-56\n   #13 ftSkyline.fut:939:17-952:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_581797 = start_581518 + merge_sequential_arg2_581756;
                            int64_t binop_y_586866 = dim_438949 * slice_581797;
                            int64_t slice_585956 = start_581518 + defunc_0_f_res_581747;
                            int64_t binop_y_586868 = dim_438949 * slice_585956;
                            int64_t ext_586870;
                            
                            if (cond_581784) {
                                ext_586870 = binop_y_586868;
                            } else {
                                ext_586870 = binop_y_586866;
                            }
                            
                            int64_t dummy_581785;
                            float dummy_581786;
                            int64_t dummy_581788;
                            
                            if (cond_581784) {
                                int64_t head_res_585957 = ((int64_t *) mem_param_586777.mem)[slice_585956];
                                float head_res_585958 = ((float *) mem_param_586780.mem)[slice_585956];
                                int64_t head_res_585960 = ((int64_t *) mem_param_586787.mem)[slice_585956];
                                
                                dummy_581785 = head_res_585957;
                                dummy_581786 = head_res_585958;
                                dummy_581788 = head_res_585960;
                            } else {
                                int64_t head_res_581798 = ((int64_t *) mem_param_586777.mem)[slice_581797];
                                float head_res_581799 = ((float *) mem_param_586780.mem)[slice_581797];
                                int64_t head_res_581801 = ((int64_t *) mem_param_586787.mem)[slice_581797];
                                
                                dummy_581785 = head_res_581798;
                                dummy_581786 = head_res_581799;
                                dummy_581788 = head_res_581801;
                            }
                            for (int64_t nest_i_588180 = 0; nest_i_588180 < merge_block_sizze_581263; nest_i_588180++) {
                                ((int64_t *) mem_586837)[i_586252 * merge_block_sizze_581263 + nest_i_588180] = dummy_581785;
                            }
                            for (int64_t nest_i_588181 = 0; nest_i_588181 < merge_block_sizze_581263; nest_i_588181++) {
                                ((float *) mem_586840)[i_586252 * merge_block_sizze_581263 + nest_i_588181] = dummy_581786;
                            }
                            for (int64_t nest_i_588182 = 0; nest_i_588182 < merge_block_sizze_581263; nest_i_588182++) {
                                ((int64_t *) mem_586847)[i_586252 * merge_block_sizze_581263 + nest_i_588182] = dummy_581788;
                            }
                            for (int64_t nest_i_588183 = 0; nest_i_588183 < merge_block_sizze_581263; nest_i_588183++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586844, i_586252 * lmad_arg_586865 + nest_i_588183 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586784.mem, ext_586870, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                            }
                            
                            int64_t data_581806;
                            int64_t i_581812 = (int64_t) 0;
                            
                            for (int64_t k_581811 = 0; k_581811 < merge_block_sizze_581263; k_581811++) {
                                int64_t j_581817 = sub64(k_581811, i_581812);
                                bool cond_581818 = j_581817 == j_m_i_581758;
                                bool x_587854 = !cond_581818;
                                bool cond_581820 = slt64(i_581812, j_m_i_581771);
                                bool x_585961 = sle64((int64_t) 0, j_581817);
                                bool y_585962 = slt64(j_581817, j_m_i_581758);
                                bool bounds_check_585963 = x_585961 && y_585962;
                                bool loop_not_taken_587842 = !cond_581820;
                                bool protect_assert_disj_587843 = bounds_check_585963 || loop_not_taken_587842;
                                bool protect_assert_disj_587857 = cond_581818 || protect_assert_disj_587843;
                                bool index_certs_585964;
                                
                                if (!protect_assert_disj_587857) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581817, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585965 = merge_sequential_arg2_581756 + j_581817;
                                int64_t slice_585966 = start_581518 + slice_585965;
                                bool protect_cond_conj_587858 = cond_581820 && x_587854;
                                int64_t leq_arg1_585967;
                                
                                if (protect_cond_conj_587858) {
                                    int64_t x_587844 = ((int64_t *) mem_param_586777.mem)[slice_585966];
                                    
                                    leq_arg1_585967 = x_587844;
                                } else {
                                    leq_arg1_585967 = (int64_t) 0;
                                }
                                
                                float leq_arg1_585968;
                                
                                if (protect_cond_conj_587858) {
                                    float x_587846 = ((float *) mem_param_586780.mem)[slice_585966];
                                    
                                    leq_arg1_585968 = x_587846;
                                } else {
                                    leq_arg1_585968 = 0.0F;
                                }
                                
                                bool x_585969 = sle64((int64_t) 0, i_581812);
                                bool bounds_check_585970 = cond_581820 && x_585969;
                                bool protect_assert_disj_587849 = bounds_check_585970 || loop_not_taken_587842;
                                bool protect_assert_disj_587861 = cond_581818 || protect_assert_disj_587849;
                                bool index_certs_585971;
                                
                                if (!protect_assert_disj_587861) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581812, "] out of bounds for array of shape [", (long long) j_m_i_581771, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585972 = defunc_0_f_res_581747 + i_581812;
                                int64_t slice_585973 = start_581518 + slice_585972;
                                int64_t leq_arg0_585974;
                                
                                if (protect_cond_conj_587858) {
                                    int64_t x_587850 = ((int64_t *) mem_param_586777.mem)[slice_585973];
                                    
                                    leq_arg0_585974 = x_587850;
                                } else {
                                    leq_arg0_585974 = (int64_t) 0;
                                }
                                
                                float leq_arg0_585975;
                                
                                if (protect_cond_conj_587858) {
                                    float x_587852 = ((float *) mem_param_586780.mem)[slice_585973];
                                    
                                    leq_arg0_585975 = x_587852;
                                } else {
                                    leq_arg0_585975 = 0.0F;
                                }
                                
                                bool cond_585976 = slt64(leq_arg0_585974, leq_arg1_585967);
                                bool cond_585977 = leq_arg0_585974 == leq_arg1_585967;
                                bool zlze_res_585978 = leq_arg0_585975 <= leq_arg1_585968;
                                bool x_585979 = cond_585977 && zlze_res_585978;
                                bool x_585980 = !cond_585976;
                                bool y_585981 = x_585979 && x_585980;
                                bool defunc_0_leq_res_585982 = cond_585976 || y_585981;
                                bool x_587876 = cond_581820 && defunc_0_leq_res_585982;
                                bool cond_581819 = cond_581818 || x_587876;
                                bool protect_assert_disj_587742 = cond_581819 || bounds_check_585963;
                                bool index_certs_581863;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581817, "] out of bounds for array of shape [", (long long) j_m_i_581758, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585986 = cond_581820 && x_585969;
                                bool loop_not_taken_587737 = !cond_581819;
                                bool protect_assert_disj_587738 = bounds_check_585986 || loop_not_taken_587737;
                                bool index_certs_585987;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581812, "] out of bounds for array of shape [", (long long) j_m_i_581771, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:351:58-85\n   #11 ftSkyline.fut:952:33-56\n   #12 ftSkyline.fut:939:17-952:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_581865 = start_581518 + slice_585965;
                                int64_t binop_y_586893 = dim_438949 * slice_581865;
                                int64_t slice_585989 = start_581518 + slice_585972;
                                int64_t binop_y_586895 = dim_438949 * slice_585989;
                                int64_t ext_586897;
                                
                                if (cond_581819) {
                                    ext_586897 = binop_y_586895;
                                } else {
                                    ext_586897 = binop_y_586893;
                                }
                                
                                int64_t loopres_581844;
                                int64_t loopres_581845;
                                float loopres_581846;
                                int64_t loopres_581848;
                                
                                if (cond_581819) {
                                    int64_t tmp_585983 = add64((int64_t) 1, i_581812);
                                    int64_t tmp_585990 = ((int64_t *) mem_param_586777.mem)[slice_585989];
                                    float tmp_585991 = ((float *) mem_param_586780.mem)[slice_585989];
                                    int64_t tmp_585993 = ((int64_t *) mem_param_586787.mem)[slice_585989];
                                    
                                    loopres_581844 = tmp_585983;
                                    loopres_581845 = tmp_585990;
                                    loopres_581846 = tmp_585991;
                                    loopres_581848 = tmp_585993;
                                } else {
                                    int64_t tmp_581866 = ((int64_t *) mem_param_586777.mem)[slice_581865];
                                    float tmp_581867 = ((float *) mem_param_586780.mem)[slice_581865];
                                    int64_t tmp_581869 = ((int64_t *) mem_param_586787.mem)[slice_581865];
                                    
                                    loopres_581844 = i_581812;
                                    loopres_581845 = tmp_581866;
                                    loopres_581846 = tmp_581867;
                                    loopres_581848 = tmp_581869;
                                }
                                ((int64_t *) mem_586837)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581845;
                                ((float *) mem_586840)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581846;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586844, i_586252 * lmad_arg_586865 + k_581811 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586784.mem, ext_586897, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
                                ((int64_t *) mem_586847)[i_586252 * merge_block_sizze_581263 + k_581811] = loopres_581848;
                                
                                int64_t i_tmp_588184 = loopres_581844;
                                
                                i_581812 = i_tmp_588184;
                            }
                            data_581806 = i_581812;
                        }
                        if (memblock_alloc(ctx, &mem_586930, bytes_586836, "mem_586930")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586930.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint64_t *) mem_586837, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_alloc(ctx, &mem_586934, bytes_586839, "mem_586934")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 2, (uint32_t *) mem_586934.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint32_t *) mem_586840, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_alloc(ctx, &mem_586939, bytes_586843, "mem_586939")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_586939.mem, (int64_t) 0, (int64_t []) {dim_438949 * merge_block_sizze_581263, dim_438949, (int64_t) 1}, (uint32_t *) mem_586844, (int64_t) 0, (int64_t []) {lmad_arg_586865, dim_438949, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263, dim_438949});
                        if (memblock_alloc(ctx, &mem_586943, bytes_586836, "mem_586943")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586943.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (uint64_t *) mem_586847, (int64_t) 0, (int64_t []) {merge_block_sizze_581263, (int64_t) 1}, (int64_t []) {num_blocks_581464, merge_block_sizze_581263});
                        if (memblock_set(ctx, &ext_mem_587002, &mem_586930, "mem_586930") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586999, &mem_586934, "mem_586934") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586996, &mem_586939, "mem_586939") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586992, &mem_586943, "mem_586943") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586790, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587002.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_587002, "ext_mem_587002") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586793, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586999.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_586999, "ext_mem_586999") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_586797, i_586265 * lmad_arg_586818, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) ext_mem_586996.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {next_stride_581443, dim_438949});
                    if (memblock_unref(ctx, &ext_mem_586996, "ext_mem_586996") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586800, i_586265 * next_stride_581443, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586992.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581443});
                    if (memblock_unref(ctx, &ext_mem_586992, "ext_mem_586992") != 0)
                        return 1;
                }
                
                int64_t flat_dim_581882 = next_stride_581443 * num_merges_581447;
                
                if (memblock_alloc(ctx, &mem_587022, bytes_586789, "mem_587022")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587022.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint64_t *) mem_586790, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                if (memblock_alloc(ctx, &mem_587026, bytes_586792, "mem_587026")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_587026.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint32_t *) mem_586793, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                if (memblock_alloc(ctx, &mem_587031, bytes_586796, "mem_587031")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_587031.mem, (int64_t) 0, (int64_t []) {dim_438949 * next_stride_581443, dim_438949, (int64_t) 1}, (uint32_t *) mem_586797, (int64_t) 0, (int64_t []) {lmad_arg_586818, dim_438949, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443, dim_438949});
                if (memblock_alloc(ctx, &mem_587035, bytes_586789, "mem_587035")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587035.mem, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (uint64_t *) mem_586800, (int64_t) 0, (int64_t []) {next_stride_581443, (int64_t) 1}, (int64_t []) {num_merges_581447, next_stride_581443});
                
                bool loop_cond_581889 = slt64(next_stride_581443, flat_dim_581257);
                
                if (memblock_set(ctx, &mem_param_tmp_588144, &mem_587022, "mem_587022") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588145, &mem_587026, "mem_587026") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588146, &mem_587031, "mem_587031") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588147, &mem_587035, "mem_587035") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588148 = flat_dim_581882;
                bool loop_while_tmp_588149 = loop_cond_581889;
                int64_t stride_tmp_588154 = next_stride_581443;
                
                if (memblock_set(ctx, &mem_param_586777, &mem_param_tmp_588144, "mem_param_tmp_588144") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586780, &mem_param_tmp_588145, "mem_param_tmp_588145") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586784, &mem_param_tmp_588146, "mem_param_tmp_588146") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586787, &mem_param_tmp_588147, "mem_param_tmp_588147") != 0)
                    return 1;
                loop_dz2084Uz2082U_581436 = loop_dz2084Uz2082U_tmp_588148;
                loop_while_581437 = loop_while_tmp_588149;
                stride_581442 = stride_tmp_588154;
            }
            if (memblock_set(ctx, &ext_mem_587049, &mem_param_586777, "mem_param_586777") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587048, &mem_param_586780, "mem_param_586780") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587047, &mem_param_586784, "mem_param_586784") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587046, &mem_param_586787, "mem_param_586787") != 0)
                return 1;
            data_581429 = loop_dz2084Uz2082U_581436;
            data_581430 = loop_while_581437;
            data_581435 = stride_581442;
            if (memblock_unref(ctx, &mem_586760, "mem_586760") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586764, "mem_586764") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586769, "mem_586769") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586773, "mem_586773") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_581892 = slt64(m_580370, data_581429);
            bool y_581893 = zzero_leq_i_p_m_t_s_580371 && i_p_m_t_s_leq_w_581892;
            bool ok_or_empty_581894 = empty_slice_580369 || y_581893;
            bool index_certs_581895;
            
            if (!ok_or_empty_581894) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580360, "] out of bounds for array of shape [", (long long) data_581429, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587056, &ext_mem_587047, "ext_mem_587047") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587052, &ext_mem_587046, "ext_mem_587046") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587058, bytes_586500, "mem_587058")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587052.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580360});
        if (memblock_unref(ctx, &ext_mem_587052, "ext_mem_587052") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587061, bytes_586498, "mem_587061")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_587061.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) ext_mem_587056.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {m_580360, dim_438949});
        if (memblock_unref(ctx, &ext_mem_587056, "ext_mem_587056") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587498, &mem_587061, "mem_587061") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587497, &mem_587058, "mem_587058") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586501, "mem_586501") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_586037;
    int64_t redout_586270 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586271 = 0; i_586271 < dim_438949; i_586271++) {
        int64_t x_581910 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586271];
        int64_t min_res_581913 = smin64(x_581910, redout_586270);
        int64_t redout_tmp_588189 = min_res_581913;
        
        redout_586270 = redout_tmp_588189;
    }
    defunc_0_reduce_res_586037 = redout_586270;
    
    bool cond_581914 = defunc_0_reduce_res_586037 == (int64_t) 1;
    bool bounds_invalid_upwards_581915 = slt64(total_grid_no_438970, (int64_t) 0);
    bool valid_581916 = !bounds_invalid_upwards_581915;
    bool protect_assert_disj_581917 = cond_581914 || valid_581916;
    bool range_valid_c_581918;
    
    if (!protect_assert_disj_581917) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_438970, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582271 = y_581105 || cond_581914;
    bool index_certs_581925;
    
    if (!protect_assert_disj_582271) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:351:58-85\n   #4  ftSkyline.fut:952:33-56\n   #5  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587499 = (int64_t) 4 * total_grid_no_438970;
    
    if (cond_581914) {
        if (memblock_alloc(ctx, &mem_587536, total_grid_no_438970, "mem_587536")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < total_grid_no_438970; nest_i_588190++) {
            ((bool *) mem_587536.mem)[nest_i_588190] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587539, &mem_587536, "mem_587536") != 0)
            return 1;
    } else {
        if (mem_587500_cached_sizze_588803 < bytes_587499) {
            err = lexical_realloc(ctx, &mem_587500, &mem_587500_cached_sizze_588803, bytes_587499);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588191 = 0; nest_i_588191 < total_grid_no_438970; nest_i_588191++) {
            ((int32_t *) mem_587500)[nest_i_588191] = 0;
        }
        if (mem_587505_cached_sizze_588804 < bytes_586437) {
            err = lexical_realloc(ctx, &mem_587505, &mem_587505_cached_sizze_588804, bytes_586437);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586276 = 0; iter_586276 < m_580360; iter_586276++) {
            for (int64_t i_586274 = 0; i_586274 < dim_438949; i_586274++) {
                float eta_p_584752 = ((float *) ext_mem_587498.mem)[iter_586276 * dim_438949 + i_586274];
                float eta_p_584753 = ((float *) start_of_grid_partition_mem_586422.mem)[i_586274];
                float eta_p_584754 = ((float *) grid_part_sizze_per_dim_mem_586420.mem)[i_586274];
                int64_t eta_p_584756 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586274];
                float defunc_0_f_res_584757 = eta_p_584752 - eta_p_584753;
                float defunc_0_f_res_584759 = defunc_0_f_res_584757 / eta_p_584754;
                int64_t f32_res_584761 = fptosi_f32_i64(defunc_0_f_res_584759);
                int64_t max_res_584763 = smax64((int64_t) 0, f32_res_584761);
                int64_t zm_lhs_584769 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586274];
                int64_t min_arg1_584770 = sub64(zm_lhs_584769, (int64_t) 1);
                int64_t min_res_584771 = smin64(max_res_584763, min_arg1_584770);
                int64_t defunc_0_f_res_584773 = mul64(eta_p_584756, min_res_584771);
                
                ((int64_t *) mem_587505)[i_586274] = defunc_0_f_res_584773;
            }
            
            int64_t defunc_0_foldl_res_584680;
            int64_t acc_584682 = (int64_t) 0;
            
            for (int64_t i_584681 = 0; i_584681 < dim_438949; i_584681++) {
                int64_t b_584683 = ((int64_t *) mem_587505)[i_584681];
                int64_t defunc_0_f_res_584684 = add64(acc_584682, b_584683);
                int64_t acc_tmp_588194 = defunc_0_f_res_584684;
                
                acc_584682 = acc_tmp_588194;
            }
            defunc_0_foldl_res_584680 = acc_584682;
            
            bool less_than_zzero_586280 = slt64(defunc_0_foldl_res_584680, (int64_t) 0);
            bool greater_than_sizze_586281 = sle64(total_grid_no_438970, defunc_0_foldl_res_584680);
            bool outside_bounds_dim_586282 = less_than_zzero_586280 || greater_than_sizze_586281;
            
            if (!outside_bounds_dim_586282) {
                int32_t read_hist_586284 = ((int32_t *) mem_587500)[defunc_0_foldl_res_584680];
                int32_t defunc_0_op_res_581965 = add32(1, read_hist_586284);
                
                ((int32_t *) mem_587500)[defunc_0_foldl_res_584680] = defunc_0_op_res_581965;
            }
        }
        if (memblock_alloc(ctx, &mem_587515, total_grid_no_438970, "mem_587515")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588195 = 0; nest_i_588195 < total_grid_no_438970; nest_i_588195++) {
            ((bool *) mem_587515.mem)[nest_i_588195] = 0;
        }
        if (mem_587519_cached_sizze_588805 < dim_438949) {
            err = lexical_realloc(ctx, &mem_587519, &mem_587519_cached_sizze_588805, dim_438949);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_581970 = 0; i_581970 < total_grid_no_438970; i_581970++) {
            for (int64_t i_586289 = 0; i_586289 < dim_438949; i_586289++) {
                int64_t eta_p_581973 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586289];
                int64_t eta_p_581974 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586289];
                bool defunc_0_f_res_581975;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_581975, i_581970, eta_p_581973, eta_p_581974) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587519)[i_586289] = defunc_0_f_res_581975;
            }
            
            bool defunc_0_f_res_581976;
            bool acc_581978 = 0;
            
            for (int64_t i_581977 = 0; i_581977 < dim_438949; i_581977++) {
                bool b_581979 = ((bool *) mem_587519)[i_581977];
                bool defunc_0_f_res_581980 = acc_581978 || b_581979;
                bool acc_tmp_588198 = defunc_0_f_res_581980;
                
                acc_581978 = acc_tmp_588198;
            }
            defunc_0_f_res_581976 = acc_581978;
            if (!defunc_0_f_res_581976) {
                bool y_581982 = slt64(i_581970, dz2080U_438952);
                bool index_certs_581983;
                
                if (!y_581982) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581970, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:351:58-85\n   #2  ftSkyline.fut:952:33-56\n   #3  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_581985 = slt64(i_581970, (int64_t) 0);
                bool valid_581986 = !bounds_invalid_upwards_581985;
                bool range_valid_c_581987;
                
                if (!valid_581986) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_581970, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_586019;
                bool redout_586295 = 0;
                
                for (int64_t i_586296 = 0; i_586296 < i_581970; i_586296++) {
                    bool cond_584777 = i_586296 == i_581970;
                    bool cond_584778;
                    
                    if (cond_584777) {
                        cond_584778 = 1;
                    } else {
                        bool y_584780 = slt64(i_586296, total_grid_no_438970);
                        bool index_certs_584782;
                        
                        if (!y_584780) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586296, "] out of bounds for array of shape [", (long long) total_grid_no_438970, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584783 = ((int32_t *) mem_587500)[i_586296];
                        bool cond_f_res_584784 = zeze_lhs_584783 == 0;
                        
                        cond_584778 = cond_f_res_584784;
                    }
                    
                    bool defunc_0_f_res_584785;
                    
                    if (cond_584778) {
                        defunc_0_f_res_584785 = 0;
                    } else {
                        bool y_584787 = slt64(i_586296, dz2080U_438952);
                        bool index_certs_584789;
                        
                        if (!y_584787) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586296, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587526_cached_sizze_588806 < dim_438949) {
                            err = lexical_realloc(ctx, &mem_587526, &mem_587526_cached_sizze_588806, dim_438949);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586293 = 0; i_586293 < dim_438949; i_586293++) {
                            float eta_p_584792 = ((float *) start_of_grid_partition_mem_586422.mem)[i_581970 * dim_438949 + i_586293];
                            float eta_p_584793 = ((float *) start_of_grid_partition_mem_586422.mem)[i_586296 * dim_438949 + i_586293];
                            bool defunc_0_f_res_584794 = eta_p_584793 < eta_p_584792;
                            
                            ((bool *) mem_587526)[i_586293] = defunc_0_f_res_584794;
                        }
                        
                        bool defunc_0_foldl_res_584795;
                        bool acc_584797 = 1;
                        
                        for (int64_t i_584796 = 0; i_584796 < dim_438949; i_584796++) {
                            bool b_584798 = ((bool *) mem_587526)[i_584796];
                            bool x_584799 = acc_584797 && b_584798;
                            bool acc_tmp_588201 = x_584799;
                            
                            acc_584797 = acc_tmp_588201;
                        }
                        defunc_0_foldl_res_584795 = acc_584797;
                        defunc_0_f_res_584785 = defunc_0_foldl_res_584795;
                    }
                    
                    bool defunc_0_op_res_582021 = defunc_0_f_res_584785 || redout_586295;
                    bool redout_tmp_588199 = defunc_0_op_res_582021;
                    
                    redout_586295 = redout_tmp_588199;
                }
                defunc_0_reduce_res_586019 = redout_586295;
                ((bool *) mem_587515.mem)[i_581970] = defunc_0_reduce_res_586019;
            }
        }
        if (memblock_set(ctx, &ext_mem_587539, &mem_587515, "mem_587515") != 0)
            return 1;
    }
    
    bool index_certs_582034;
    
    if (!y_581105) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587541_cached_sizze_588807 < bytes_586518) {
        err = lexical_realloc(ctx, &mem_587541, &mem_587541_cached_sizze_588807, bytes_586518);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586299 = 0; i_586299 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951; i_586299++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582114 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586299];
        float i64_res_582115 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_582114);
        float defunc_0_fover_res_582116 = 1.5707964F / i64_res_582115;
        
        ((float *) mem_587541)[i_586299] = defunc_0_fover_res_582116;
    }
    
    bool empty_or_match_cert_582118;
    
    if (!assert_cond_580164) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_582155 = total_angle_no_438969 == (int64_t) 0;
    bool nonzzero_582156 = !zzero_582155;
    bool nonzzero_cert_582157;
    
    if (!nonzzero_582156) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:351:58-85\n   #6  ftSkyline.fut:952:33-56\n   #7  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587549_cached_sizze_588808 < bytes_586500) {
        err = lexical_realloc(ctx, &mem_587549, &mem_587549_cached_sizze_588808, bytes_586500);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587551_cached_sizze_588809 < bytes_586500) {
        err = lexical_realloc(ctx, &mem_587551, &mem_587551_cached_sizze_588809, bytes_586500);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587553_cached_sizze_588810 < bytes_586500) {
        err = lexical_realloc(ctx, &mem_587553, &mem_587553_cached_sizze_588810, bytes_586500);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587564_cached_sizze_588811 < bytes_586437) {
        err = lexical_realloc(ctx, &mem_587564, &mem_587564_cached_sizze_588811, bytes_586437);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587572_cached_sizze_588812 < bytes_586509) {
        err = lexical_realloc(ctx, &mem_587572, &mem_587572_cached_sizze_588812, bytes_586509);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587580_cached_sizze_588813 < bytes_586560) {
        err = lexical_realloc(ctx, &mem_587580, &mem_587580_cached_sizze_588813, bytes_586560);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587596_cached_sizze_588815 < bytes_586576) {
        err = lexical_realloc(ctx, &mem_587596, &mem_587596_cached_sizze_588815, bytes_586576);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586328;
    int64_t scanacc_586320 = (int64_t) 0;
    
    for (int64_t i_586324 = 0; i_586324 < m_580360; i_586324++) {
        for (int64_t i_586303 = 0; i_586303 < dim_438949; i_586303++) {
            float eta_p_584882 = ((float *) ext_mem_587498.mem)[i_586324 * dim_438949 + i_586303];
            float eta_p_584883 = ((float *) start_of_grid_partition_mem_586422.mem)[i_586303];
            float eta_p_584884 = ((float *) grid_part_sizze_per_dim_mem_586420.mem)[i_586303];
            int64_t eta_p_584886 = ((int64_t *) grid_part_prefix_sum_mem_586419.mem)[i_586303];
            float defunc_0_f_res_584887 = eta_p_584882 - eta_p_584883;
            float defunc_0_f_res_584889 = defunc_0_f_res_584887 / eta_p_584884;
            int64_t f32_res_584891 = fptosi_f32_i64(defunc_0_f_res_584889);
            int64_t max_res_584893 = smax64((int64_t) 0, f32_res_584891);
            int64_t zm_lhs_584899 = ((int64_t *) grid_partitions_per_dim_mem_586421.mem)[i_586303];
            int64_t min_arg1_584900 = sub64(zm_lhs_584899, (int64_t) 1);
            int64_t min_res_584901 = smin64(max_res_584893, min_arg1_584900);
            int64_t defunc_0_f_res_584903 = mul64(eta_p_584886, min_res_584901);
            
            ((int64_t *) mem_587564)[i_586303] = defunc_0_f_res_584903;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_438949; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587564)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588208 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588208;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_438952);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_438952, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586307 = 0; i_586307 < dim_438949; i_586307++) {
            float eta_p_582571 = ((float *) ext_mem_587498.mem)[i_586324 * dim_438949 + i_586307];
            float eta_p_582572 = ((float *) start_of_grid_partition_mem_586422.mem)[defunc_0_foldl_res_582560 * dim_438949 + i_586307];
            float defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((float *) mem_587572)[i_586307] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588210 = 0; nest_i_588210 < arg_580163; nest_i_588210++) {
            ((float *) mem_587580)[nest_i_588210] = 0.0F;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_580163; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_438949);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_438949, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_438949);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_438949);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_438949, "] out of bounds for array of shape [", (long long) dim_438949, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587584 = (int64_t) 4 * j_m_i_582582;
            float this_x_582580 = ((float *) mem_587572)[i_582576];
            
            if (mem_587585_cached_sizze_588814 < bytes_587584) {
                err = lexical_realloc(ctx, &mem_587585, &mem_587585_cached_sizze_588814, bytes_587584);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586311 = 0; i_586311 < j_m_i_582582; i_586311++) {
                int64_t slice_586364 = map_arg1_582581 + i_586311;
                float eta_p_582597 = ((float *) mem_587572)[slice_586364];
                float defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((float *) mem_587585)[i_586311] = defunc_0_ftimes_res_582598;
            }
            
            float defunc_0_foldl_res_582599;
            float acc_582601 = 0.0F;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                float b_582602 = ((float *) mem_587585)[i_582600];
                float defunc_0_f_res_582603 = acc_582601 + b_582602;
                float acc_tmp_588213 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588213;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            float sqrt_res_582604 = futrts_sqrt32(defunc_0_foldl_res_582599);
            float atan2_res_582605 = futrts_atan2_32(sqrt_res_582604, this_x_582580);
            
            ((float *) mem_587580)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586315 = 0; i_586315 < arg_580163; i_586315++) {
            float eta_p_582608 = ((float *) mem_587580)[i_586315];
            float eta_p_582609 = ((float *) mem_587541)[i_586315];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586417.mem)[i_586315];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586418.mem)[i_586315];
            float i64_res_582612 = sitofp_i64_f32(eta_p_582610);
            float defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            float defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f32_res_582615 = fptosi_f32_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f32_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f32_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_586024 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_586024;
                } else {
                    defunc_0_f_res_f_res_582619 = f32_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587596)[i_586315] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_580163; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587596)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588215 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588215;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_438969, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_438969);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_438970);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_438970, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:351:58-85\n   #5  ftSkyline.fut:952:33-56\n   #6  ftSkyline.fut:939:17-952:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587539.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_582172 = add64(defunc_0_f_res_582636, scanacc_586320);
        
        ((int64_t *) mem_587549)[i_586324] = defunc_0_op_res_582172;
        ((int64_t *) mem_587551)[i_586324] = defunc_0_f_res_582636;
        ((int64_t *) mem_587553)[i_586324] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588203 = defunc_0_op_res_582172;
        
        scanacc_586320 = scanacc_tmp_588203;
    }
    discard_586328 = scanacc_586320;
    
    bool x_582174 = !empty_slice_580369;
    bool y_582177 = slt64(m_580370, m_580360);
    bool bounds_check_582178 = zzero_leq_i_p_m_t_s_580371 && y_582177;
    bool protect_assert_disj_582179 = empty_slice_580369 || bounds_check_582178;
    bool index_certs_582180;
    
    if (!protect_assert_disj_582179) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_580370, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_582181;
    
    if (x_582174) {
        int64_t x_586029 = ((int64_t *) mem_587549)[m_580370];
        
        m_f_res_582181 = x_586029;
    } else {
        m_f_res_582181 = (int64_t) 0;
    }
    
    int64_t m_582183;
    
    if (empty_slice_580369) {
        m_582183 = (int64_t) 0;
    } else {
        m_582183 = m_f_res_582181;
    }
    
    int64_t m_582194 = sub64(m_582183, (int64_t) 1);
    bool i_p_m_t_s_leq_w_582196 = slt64(m_582194, m_580360);
    bool zzero_leq_i_p_m_t_s_582195 = sle64((int64_t) 0, m_582194);
    bool y_582198 = zzero_leq_i_p_m_t_s_582195 && i_p_m_t_s_leq_w_582196;
    bool i_lte_j_582197 = sle64((int64_t) 0, m_582183);
    bool forwards_ok_582199 = i_lte_j_582197 && y_582198;
    bool eq_x_zz_582190 = (int64_t) 0 == m_f_res_582181;
    bool p_and_eq_x_y_582192 = x_582174 && eq_x_zz_582190;
    bool empty_slice_582193 = empty_slice_580369 || p_and_eq_x_y_582192;
    bool ok_or_empty_582200 = empty_slice_582193 || forwards_ok_582199;
    bool index_certs_582201;
    
    if (!ok_or_empty_582200) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_582183, "] out of bounds for array of shape [", (long long) m_580360, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587612 = (int64_t) 4 * m_582183;
    int64_t bytes_587613 = dim_438949 * binop_x_587612;
    int64_t bytes_587615 = (int64_t) 8 * m_582183;
    bool bounds_invalid_upwards_582233 = slt64(total_part_no_438971, (int64_t) 0);
    bool valid_582234 = !bounds_invalid_upwards_582233;
    bool range_valid_c_582235;
    
    if (!valid_582234) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_438971, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:351:58-85\n   #3  ftSkyline.fut:952:33-56\n   #4  ftSkyline.fut:939:17-952:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587641 = (int64_t) 8 * total_part_no_438971;
    
    if (memblock_alloc(ctx, &mem_587614, bytes_587613, "mem_587614")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587614.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (uint32_t *) ext_mem_587498.mem, (int64_t) 0, (int64_t []) {dim_438949, (int64_t) 1}, (int64_t []) {m_582183, dim_438949});
    if (mem_587616_cached_sizze_588816 < bytes_587615) {
        err = lexical_realloc(ctx, &mem_587616, &mem_587616_cached_sizze_588816, bytes_587615);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587616, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587553, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582183});
    if (memblock_alloc(ctx, &mem_587618, bytes_587615, "mem_587618")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587618.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587497.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582183});
    if (mem_587630_cached_sizze_588817 < bytes_586509) {
        err = lexical_realloc(ctx, &mem_587630, &mem_587630_cached_sizze_588817, bytes_586509);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586329 = 0; write_iter_586329 < m_580360; write_iter_586329++) {
        int64_t write_iv_586333 = ((int64_t *) mem_587551)[write_iter_586329];
        int64_t write_iv_586334 = ((int64_t *) mem_587549)[write_iter_586329];
        int64_t write_iv_586336 = ((int64_t *) ext_mem_587497.mem)[write_iter_586329];
        int64_t write_iv_586337 = ((int64_t *) mem_587553)[write_iter_586329];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_587630, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587498.mem, write_iter_586329 * dim_438949, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
        
        bool cond_582515 = write_iv_586333 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_586030 = sub64(write_iv_586334, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_586030;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_438949 - (int64_t) 1, dim_438949))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587614.mem, lifted_lambda_res_582516 * dim_438949, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587630, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_438949});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) {
            ((int64_t *) mem_587618.mem)[lifted_lambda_res_582516] = write_iv_586336;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582183)) {
            ((int64_t *) mem_587616)[lifted_lambda_res_582516] = write_iv_586337;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587497, "ext_mem_587497") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587498, "ext_mem_587498") != 0)
        return 1;
    if (mem_587642_cached_sizze_588818 < bytes_587641) {
        err = lexical_realloc(ctx, &mem_587642, &mem_587642_cached_sizze_588818, bytes_587641);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588219 = 0; nest_i_588219 < total_part_no_438971; nest_i_588219++) {
        ((int64_t *) mem_587642)[nest_i_588219] = (int64_t) 0;
    }
    for (int64_t iter_586341 = 0; iter_586341 < m_582183; iter_586341++) {
        int64_t pixel_586343 = ((int64_t *) mem_587616)[iter_586341];
        bool less_than_zzero_586345 = slt64(pixel_586343, (int64_t) 0);
        bool greater_than_sizze_586346 = sle64(total_part_no_438971, pixel_586343);
        bool outside_bounds_dim_586347 = less_than_zzero_586345 || greater_than_sizze_586346;
        
        if (!outside_bounds_dim_586347) {
            int64_t read_hist_586349 = ((int64_t *) mem_587642)[pixel_586343];
            int64_t defunc_0_op_res_582240 = add64((int64_t) 1, read_hist_586349);
            
            ((int64_t *) mem_587642)[pixel_586343] = defunc_0_op_res_582240;
        }
    }
    if (mem_587650_cached_sizze_588819 < bytes_587641) {
        err = lexical_realloc(ctx, &mem_587650, &mem_587650_cached_sizze_588819, bytes_587641);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586357;
    int64_t scanacc_586353 = (int64_t) 0;
    
    for (int64_t i_586355 = 0; i_586355 < total_part_no_438971; i_586355++) {
        int64_t x_582244 = ((int64_t *) mem_587642)[i_586355];
        int64_t defunc_0_op_res_582247 = add64(x_582244, scanacc_586353);
        
        ((int64_t *) mem_587650)[i_586355] = defunc_0_op_res_582247;
        
        int64_t scanacc_tmp_588221 = defunc_0_op_res_582247;
        
        scanacc_586353 = scanacc_tmp_588221;
    }
    discard_586357 = scanacc_586353;
    if (memblock_alloc(ctx, &mem_587658, bytes_587641, "mem_587658")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586360 = 0; i_586360 < total_part_no_438971; i_586360++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586360);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_438971);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587650)[tmp_582504];
        bool cond_582507 = i_586360 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587658.mem)[i_586360] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587539, "ext_mem_587539") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587658, "mem_587658") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587614, "mem_587614") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587618, "mem_587618") != 0)
        return 1;
    prim_out_588011 = total_grid_no_438970;
    prim_out_588012 = total_part_no_438971;
    prim_out_588013 = m_582183;
    if (memblock_set(ctx, &*mem_out_p_588735, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588736, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588737, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588738, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588739 = prim_out_588011;
    *out_prim_out_588740 = prim_out_588012;
    *out_prim_out_588741 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586425);
        free(mem_586433);
        free(mem_586438);
        free(mem_586452);
        free(mem_586459);
        free(mem_586474);
        free(mem_586476);
        free(mem_586484);
        free(mem_586510);
        free(mem_586519);
        free(mem_586527);
        free(mem_586529);
        free(mem_586537);
        free(mem_586545);
        free(mem_586547);
        free(mem_586561);
        free(mem_586566);
        free(mem_586577);
        free(mem_586603);
        free(mem_586606);
        free(mem_586610);
        free(mem_586613);
        free(mem_586633);
        free(mem_586635);
        free(mem_586638);
        free(mem_586640);
        free(mem_586699);
        free(mem_586701);
        free(mem_586790);
        free(mem_586793);
        free(mem_586797);
        free(mem_586800);
        free(mem_586820);
        free(mem_586822);
        free(mem_586837);
        free(mem_586840);
        free(mem_586844);
        free(mem_586847);
        free(mem_587063);
        free(mem_587071);
        free(mem_587076);
        free(mem_587084);
        free(mem_587092);
        free(mem_587097);
        free(mem_587108);
        free(mem_587131);
        free(mem_587135);
        free(mem_587138);
        free(mem_587154);
        free(mem_587157);
        free(mem_587159);
        free(mem_587206);
        free(mem_587208);
        free(mem_587277);
        free(mem_587281);
        free(mem_587284);
        free(mem_587300);
        free(mem_587302);
        free(mem_587317);
        free(mem_587321);
        free(mem_587324);
        free(mem_587500);
        free(mem_587505);
        free(mem_587519);
        free(mem_587526);
        free(mem_587541);
        free(mem_587549);
        free(mem_587551);
        free(mem_587553);
        free(mem_587564);
        free(mem_587572);
        free(mem_587580);
        free(mem_587585);
        free(mem_587596);
        free(mem_587616);
        free(mem_587630);
        free(mem_587642);
        free(mem_587650);
        if (memblock_unref(ctx, &mem_587658, "mem_587658") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587618, "mem_587618") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587614, "mem_587614") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587515, "mem_587515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587536, "mem_587536") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587539, "ext_mem_587539") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587061, "mem_587061") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587058, "mem_587058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588147, "mem_param_tmp_588147") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588146, "mem_param_tmp_588146") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588145, "mem_param_tmp_588145") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588144, "mem_param_tmp_588144") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587035, "mem_587035") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587031, "mem_587031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587022, "mem_587022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586943, "mem_586943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586939, "mem_586939") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586934, "mem_586934") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586930, "mem_586930") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586958, "mem_586958") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586955, "mem_586955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586953, "mem_586953") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586951, "mem_586951") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586992, "ext_mem_586992") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586996, "ext_mem_586996") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586999, "ext_mem_586999") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587002, "ext_mem_587002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586787, "mem_param_586787") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586784, "mem_param_586784") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586780, "mem_param_586780") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586777, "mem_param_586777") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587046, "ext_mem_587046") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587047, "ext_mem_587047") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587048, "ext_mem_587048") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587049, "ext_mem_587049") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586773, "mem_586773") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586769, "mem_586769") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586764, "mem_586764") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586760, "mem_586760") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586658, "ext_mem_586658") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588120, "mem_param_tmp_588120") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586597, "ext_mem_586597") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586592, "mem_param_586592") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586600, "ext_mem_586600") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587052, "ext_mem_587052") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587056, "ext_mem_587056") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587496, "mem_587496") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587493, "mem_587493") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588071, "mem_param_tmp_588071") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588070, "mem_param_tmp_588070") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588069, "mem_param_tmp_588069") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587473, "mem_587473") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587469, "mem_587469") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587464, "mem_587464") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587396, "mem_587396") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587391, "mem_587391") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587413, "mem_587413") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587410, "mem_587410") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587408, "mem_587408") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587441, "ext_mem_587441") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587445, "ext_mem_587445") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587274, "mem_param_587274") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587271, "mem_param_587271") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587267, "mem_param_587267") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587482, "ext_mem_587482") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587483, "ext_mem_587483") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587484, "ext_mem_587484") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587263, "mem_587263") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587259, "mem_587259") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587254, "mem_587254") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587174, "ext_mem_587174") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587125, "ext_mem_587125") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587120, "mem_param_587120") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587128, "ext_mem_587128") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587487, "ext_mem_587487") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587491, "ext_mem_587491") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587497, "ext_mem_587497") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587498, "ext_mem_587498") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586501, "mem_586501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586499, "mem_586499") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586448, "mem_586448") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586469, "mem_586469") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586472, "ext_mem_586472") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588820, struct memblock *mem_out_p_588821, struct memblock *mem_out_p_588822, struct memblock *mem_out_p_588823, int64_t *out_prim_out_588824, int64_t *out_prim_out_588825, int64_t *out_prim_out_588826, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_293582, int64_t dz2080U_293583, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584, int64_t n_293585, int64_t total_angle_no_293592, int64_t total_grid_no_293593, int64_t total_part_no_293594, int64_t offset_293596, bool use_measure_for_sorting_293597)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586419_cached_sizze_588827 = 0;
    unsigned char *mem_586419 = NULL;
    int64_t mem_586427_cached_sizze_588828 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586429_cached_sizze_588829 = 0;
    unsigned char *mem_586429 = NULL;
    int64_t mem_586436_cached_sizze_588830 = 0;
    unsigned char *mem_586436 = NULL;
    int64_t mem_586443_cached_sizze_588831 = 0;
    unsigned char *mem_586443 = NULL;
    int64_t mem_586457_cached_sizze_588832 = 0;
    unsigned char *mem_586457 = NULL;
    int64_t mem_586484_cached_sizze_588833 = 0;
    unsigned char *mem_586484 = NULL;
    int64_t mem_586492_cached_sizze_588834 = 0;
    unsigned char *mem_586492 = NULL;
    int64_t mem_586494_cached_sizze_588835 = 0;
    unsigned char *mem_586494 = NULL;
    int64_t mem_586502_cached_sizze_588836 = 0;
    unsigned char *mem_586502 = NULL;
    int64_t mem_586510_cached_sizze_588837 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586512_cached_sizze_588838 = 0;
    unsigned char *mem_586512 = NULL;
    int64_t mem_586526_cached_sizze_588839 = 0;
    unsigned char *mem_586526 = NULL;
    int64_t mem_586531_cached_sizze_588840 = 0;
    unsigned char *mem_586531 = NULL;
    int64_t mem_586542_cached_sizze_588841 = 0;
    unsigned char *mem_586542 = NULL;
    int64_t mem_586568_cached_sizze_588842 = 0;
    unsigned char *mem_586568 = NULL;
    int64_t mem_586571_cached_sizze_588843 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586575_cached_sizze_588844 = 0;
    unsigned char *mem_586575 = NULL;
    int64_t mem_586578_cached_sizze_588845 = 0;
    unsigned char *mem_586578 = NULL;
    int64_t mem_586598_cached_sizze_588846 = 0;
    unsigned char *mem_586598 = NULL;
    int64_t mem_586600_cached_sizze_588847 = 0;
    unsigned char *mem_586600 = NULL;
    int64_t mem_586603_cached_sizze_588848 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586605_cached_sizze_588849 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586664_cached_sizze_588850 = 0;
    unsigned char *mem_586664 = NULL;
    int64_t mem_586666_cached_sizze_588851 = 0;
    unsigned char *mem_586666 = NULL;
    int64_t mem_586755_cached_sizze_588852 = 0;
    unsigned char *mem_586755 = NULL;
    int64_t mem_586758_cached_sizze_588853 = 0;
    unsigned char *mem_586758 = NULL;
    int64_t mem_586762_cached_sizze_588854 = 0;
    unsigned char *mem_586762 = NULL;
    int64_t mem_586765_cached_sizze_588855 = 0;
    unsigned char *mem_586765 = NULL;
    int64_t mem_586785_cached_sizze_588856 = 0;
    unsigned char *mem_586785 = NULL;
    int64_t mem_586787_cached_sizze_588857 = 0;
    unsigned char *mem_586787 = NULL;
    int64_t mem_586802_cached_sizze_588858 = 0;
    unsigned char *mem_586802 = NULL;
    int64_t mem_586805_cached_sizze_588859 = 0;
    unsigned char *mem_586805 = NULL;
    int64_t mem_586809_cached_sizze_588860 = 0;
    unsigned char *mem_586809 = NULL;
    int64_t mem_586812_cached_sizze_588861 = 0;
    unsigned char *mem_586812 = NULL;
    int64_t mem_587028_cached_sizze_588862 = 0;
    unsigned char *mem_587028 = NULL;
    int64_t mem_587036_cached_sizze_588863 = 0;
    unsigned char *mem_587036 = NULL;
    int64_t mem_587041_cached_sizze_588864 = 0;
    unsigned char *mem_587041 = NULL;
    int64_t mem_587049_cached_sizze_588865 = 0;
    unsigned char *mem_587049 = NULL;
    int64_t mem_587057_cached_sizze_588866 = 0;
    unsigned char *mem_587057 = NULL;
    int64_t mem_587062_cached_sizze_588867 = 0;
    unsigned char *mem_587062 = NULL;
    int64_t mem_587073_cached_sizze_588868 = 0;
    unsigned char *mem_587073 = NULL;
    int64_t mem_587096_cached_sizze_588869 = 0;
    unsigned char *mem_587096 = NULL;
    int64_t mem_587100_cached_sizze_588870 = 0;
    unsigned char *mem_587100 = NULL;
    int64_t mem_587103_cached_sizze_588871 = 0;
    unsigned char *mem_587103 = NULL;
    int64_t mem_587119_cached_sizze_588872 = 0;
    unsigned char *mem_587119 = NULL;
    int64_t mem_587122_cached_sizze_588873 = 0;
    unsigned char *mem_587122 = NULL;
    int64_t mem_587124_cached_sizze_588874 = 0;
    unsigned char *mem_587124 = NULL;
    int64_t mem_587171_cached_sizze_588875 = 0;
    unsigned char *mem_587171 = NULL;
    int64_t mem_587173_cached_sizze_588876 = 0;
    unsigned char *mem_587173 = NULL;
    int64_t mem_587242_cached_sizze_588877 = 0;
    unsigned char *mem_587242 = NULL;
    int64_t mem_587246_cached_sizze_588878 = 0;
    unsigned char *mem_587246 = NULL;
    int64_t mem_587249_cached_sizze_588879 = 0;
    unsigned char *mem_587249 = NULL;
    int64_t mem_587265_cached_sizze_588880 = 0;
    unsigned char *mem_587265 = NULL;
    int64_t mem_587267_cached_sizze_588881 = 0;
    unsigned char *mem_587267 = NULL;
    int64_t mem_587282_cached_sizze_588882 = 0;
    unsigned char *mem_587282 = NULL;
    int64_t mem_587286_cached_sizze_588883 = 0;
    unsigned char *mem_587286 = NULL;
    int64_t mem_587289_cached_sizze_588884 = 0;
    unsigned char *mem_587289 = NULL;
    int64_t mem_587465_cached_sizze_588885 = 0;
    unsigned char *mem_587465 = NULL;
    int64_t mem_587470_cached_sizze_588886 = 0;
    unsigned char *mem_587470 = NULL;
    int64_t mem_587484_cached_sizze_588887 = 0;
    unsigned char *mem_587484 = NULL;
    int64_t mem_587491_cached_sizze_588888 = 0;
    unsigned char *mem_587491 = NULL;
    int64_t mem_587506_cached_sizze_588889 = 0;
    unsigned char *mem_587506 = NULL;
    int64_t mem_587514_cached_sizze_588890 = 0;
    unsigned char *mem_587514 = NULL;
    int64_t mem_587516_cached_sizze_588891 = 0;
    unsigned char *mem_587516 = NULL;
    int64_t mem_587518_cached_sizze_588892 = 0;
    unsigned char *mem_587518 = NULL;
    int64_t mem_587529_cached_sizze_588893 = 0;
    unsigned char *mem_587529 = NULL;
    int64_t mem_587537_cached_sizze_588894 = 0;
    unsigned char *mem_587537 = NULL;
    int64_t mem_587545_cached_sizze_588895 = 0;
    unsigned char *mem_587545 = NULL;
    int64_t mem_587550_cached_sizze_588896 = 0;
    unsigned char *mem_587550 = NULL;
    int64_t mem_587561_cached_sizze_588897 = 0;
    unsigned char *mem_587561 = NULL;
    int64_t mem_587581_cached_sizze_588898 = 0;
    unsigned char *mem_587581 = NULL;
    int64_t mem_587595_cached_sizze_588899 = 0;
    unsigned char *mem_587595 = NULL;
    int64_t mem_587607_cached_sizze_588900 = 0;
    unsigned char *mem_587607 = NULL;
    int64_t mem_587615_cached_sizze_588901 = 0;
    unsigned char *mem_587615 = NULL;
    struct memblock mem_587623;
    
    mem_587623.references = NULL;
    
    struct memblock mem_587583;
    
    mem_587583.references = NULL;
    
    struct memblock mem_587579;
    
    mem_587579.references = NULL;
    
    struct memblock mem_587480;
    
    mem_587480.references = NULL;
    
    struct memblock mem_587501;
    
    mem_587501.references = NULL;
    
    struct memblock ext_mem_587504;
    
    ext_mem_587504.references = NULL;
    
    struct memblock mem_587026;
    
    mem_587026.references = NULL;
    
    struct memblock mem_587023;
    
    mem_587023.references = NULL;
    
    struct memblock mem_param_tmp_588142;
    
    mem_param_tmp_588142.references = NULL;
    
    struct memblock mem_param_tmp_588141;
    
    mem_param_tmp_588141.references = NULL;
    
    struct memblock mem_param_tmp_588140;
    
    mem_param_tmp_588140.references = NULL;
    
    struct memblock mem_param_tmp_588139;
    
    mem_param_tmp_588139.references = NULL;
    
    struct memblock mem_587000;
    
    mem_587000.references = NULL;
    
    struct memblock mem_586996;
    
    mem_586996.references = NULL;
    
    struct memblock mem_586991;
    
    mem_586991.references = NULL;
    
    struct memblock mem_586987;
    
    mem_586987.references = NULL;
    
    struct memblock mem_586908;
    
    mem_586908.references = NULL;
    
    struct memblock mem_586904;
    
    mem_586904.references = NULL;
    
    struct memblock mem_586899;
    
    mem_586899.references = NULL;
    
    struct memblock mem_586895;
    
    mem_586895.references = NULL;
    
    struct memblock mem_586923;
    
    mem_586923.references = NULL;
    
    struct memblock mem_586920;
    
    mem_586920.references = NULL;
    
    struct memblock mem_586918;
    
    mem_586918.references = NULL;
    
    struct memblock mem_586916;
    
    mem_586916.references = NULL;
    
    struct memblock ext_mem_586957;
    
    ext_mem_586957.references = NULL;
    
    struct memblock ext_mem_586961;
    
    ext_mem_586961.references = NULL;
    
    struct memblock ext_mem_586964;
    
    ext_mem_586964.references = NULL;
    
    struct memblock ext_mem_586967;
    
    ext_mem_586967.references = NULL;
    
    struct memblock mem_param_586752;
    
    mem_param_586752.references = NULL;
    
    struct memblock mem_param_586749;
    
    mem_param_586749.references = NULL;
    
    struct memblock mem_param_586745;
    
    mem_param_586745.references = NULL;
    
    struct memblock mem_param_586742;
    
    mem_param_586742.references = NULL;
    
    struct memblock ext_mem_587011;
    
    ext_mem_587011.references = NULL;
    
    struct memblock ext_mem_587012;
    
    ext_mem_587012.references = NULL;
    
    struct memblock ext_mem_587013;
    
    ext_mem_587013.references = NULL;
    
    struct memblock ext_mem_587014;
    
    ext_mem_587014.references = NULL;
    
    struct memblock mem_586738;
    
    mem_586738.references = NULL;
    
    struct memblock mem_586734;
    
    mem_586734.references = NULL;
    
    struct memblock mem_586729;
    
    mem_586729.references = NULL;
    
    struct memblock mem_586725;
    
    mem_586725.references = NULL;
    
    struct memblock ext_mem_586623;
    
    ext_mem_586623.references = NULL;
    
    struct memblock mem_param_tmp_588115;
    
    mem_param_tmp_588115.references = NULL;
    
    struct memblock ext_mem_586562;
    
    ext_mem_586562.references = NULL;
    
    struct memblock mem_param_586557;
    
    mem_param_586557.references = NULL;
    
    struct memblock ext_mem_586565;
    
    ext_mem_586565.references = NULL;
    
    struct memblock ext_mem_587017;
    
    ext_mem_587017.references = NULL;
    
    struct memblock ext_mem_587021;
    
    ext_mem_587021.references = NULL;
    
    struct memblock mem_587461;
    
    mem_587461.references = NULL;
    
    struct memblock mem_587458;
    
    mem_587458.references = NULL;
    
    struct memblock mem_param_tmp_588066;
    
    mem_param_tmp_588066.references = NULL;
    
    struct memblock mem_param_tmp_588065;
    
    mem_param_tmp_588065.references = NULL;
    
    struct memblock mem_param_tmp_588064;
    
    mem_param_tmp_588064.references = NULL;
    
    struct memblock mem_587438;
    
    mem_587438.references = NULL;
    
    struct memblock mem_587434;
    
    mem_587434.references = NULL;
    
    struct memblock mem_587429;
    
    mem_587429.references = NULL;
    
    struct memblock mem_587365;
    
    mem_587365.references = NULL;
    
    struct memblock mem_587361;
    
    mem_587361.references = NULL;
    
    struct memblock mem_587356;
    
    mem_587356.references = NULL;
    
    struct memblock mem_587378;
    
    mem_587378.references = NULL;
    
    struct memblock mem_587375;
    
    mem_587375.references = NULL;
    
    struct memblock mem_587373;
    
    mem_587373.references = NULL;
    
    struct memblock ext_mem_587406;
    
    ext_mem_587406.references = NULL;
    
    struct memblock ext_mem_587410;
    
    ext_mem_587410.references = NULL;
    
    struct memblock ext_mem_587413;
    
    ext_mem_587413.references = NULL;
    
    struct memblock mem_param_587239;
    
    mem_param_587239.references = NULL;
    
    struct memblock mem_param_587236;
    
    mem_param_587236.references = NULL;
    
    struct memblock mem_param_587232;
    
    mem_param_587232.references = NULL;
    
    struct memblock ext_mem_587447;
    
    ext_mem_587447.references = NULL;
    
    struct memblock ext_mem_587448;
    
    ext_mem_587448.references = NULL;
    
    struct memblock ext_mem_587449;
    
    ext_mem_587449.references = NULL;
    
    struct memblock mem_587228;
    
    mem_587228.references = NULL;
    
    struct memblock mem_587224;
    
    mem_587224.references = NULL;
    
    struct memblock mem_587219;
    
    mem_587219.references = NULL;
    
    struct memblock ext_mem_587139;
    
    ext_mem_587139.references = NULL;
    
    struct memblock mem_param_tmp_588045;
    
    mem_param_tmp_588045.references = NULL;
    
    struct memblock ext_mem_587090;
    
    ext_mem_587090.references = NULL;
    
    struct memblock mem_param_587085;
    
    mem_param_587085.references = NULL;
    
    struct memblock ext_mem_587093;
    
    ext_mem_587093.references = NULL;
    
    struct memblock ext_mem_587452;
    
    ext_mem_587452.references = NULL;
    
    struct memblock ext_mem_587456;
    
    ext_mem_587456.references = NULL;
    
    struct memblock ext_mem_587462;
    
    ext_mem_587462.references = NULL;
    
    struct memblock ext_mem_587463;
    
    ext_mem_587463.references = NULL;
    
    struct memblock mem_586468;
    
    mem_586468.references = NULL;
    
    struct memblock mem_586466;
    
    mem_586466.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_580153 = sub64(dim_293582, (int64_t) 1);
    bool assert_cond_580154 = arg_580153 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584;
    bool assert_c_580155;
    
    if (!assert_cond_580154) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_580163 = slt64((int64_t) 0, dz2080U_293583);
    bool index_certs_580164;
    
    if (!y_580163) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:319:59-89\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586418 = (int64_t) 8 * dim_293582;
    
    if (mem_586419_cached_sizze_588827 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_586419, &mem_586419_cached_sizze_588827, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_585813;
    double defunc_0_reduce_comm_res_585814;
    int64_t redout_586052;
    double redout_586053;
    
    redout_586052 = n_293585;
    redout_586053 = INFINITY;
    for (int64_t i_586054 = 0; i_586054 < n_293585; i_586054++) {
        for (int64_t i_586050 = 0; i_586050 < dim_293582; i_586050++) {
            double eta_p_582717 = ((double *) xs_mem_586417.mem)[i_586054 * dim_293582 + i_586050];
            double eta_p_582718 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586050];
            double defunc_0_f_res_582719 = eta_p_582717 - eta_p_582718;
            double defunc_0_ftimes_res_582721 = defunc_0_f_res_582719 * defunc_0_f_res_582719;
            
            ((double *) mem_586419)[i_586050] = defunc_0_ftimes_res_582721;
        }
        
        double defunc_0_f_res_582710;
        double acc_582712 = 0.0;
        
        for (int64_t i_582711 = 0; i_582711 < dim_293582; i_582711++) {
            double b_582713 = ((double *) mem_586419)[i_582711];
            double defunc_0_f_res_582714 = acc_582712 + b_582713;
            double acc_tmp_588017 = defunc_0_f_res_582714;
            
            acc_582712 = acc_tmp_588017;
        }
        defunc_0_f_res_582710 = acc_582712;
        
        bool zl_res_580193 = redout_586053 < defunc_0_f_res_582710;
        bool zeze_res_580194 = redout_586053 == defunc_0_f_res_582710;
        bool cond_f_res_t_res_580195 = slt64(redout_586052, i_586054);
        bool x_580196 = zeze_res_580194 && cond_f_res_t_res_580195;
        bool x_580197 = !zl_res_580193;
        bool y_580198 = x_580196 && x_580197;
        bool cond_580199 = zl_res_580193 || y_580198;
        int64_t defunc_0_op_res_580200;
        
        if (cond_580199) {
            defunc_0_op_res_580200 = redout_586052;
        } else {
            defunc_0_op_res_580200 = i_586054;
        }
        
        double defunc_0_op_res_580201;
        
        if (cond_580199) {
            defunc_0_op_res_580201 = redout_586053;
        } else {
            defunc_0_op_res_580201 = defunc_0_f_res_582710;
        }
        
        int64_t redout_tmp_588014 = defunc_0_op_res_580200;
        double redout_tmp_588015 = defunc_0_op_res_580201;
        
        redout_586052 = redout_tmp_588014;
        redout_586053 = redout_tmp_588015;
    }
    defunc_0_reduce_comm_res_585813 = redout_586052;
    defunc_0_reduce_comm_res_585814 = redout_586053;
    
    bool x_580202 = sle64((int64_t) 0, defunc_0_reduce_comm_res_585813);
    bool y_580203 = slt64(defunc_0_reduce_comm_res_585813, n_293585);
    bool bounds_check_580204 = x_580202 && y_580203;
    bool index_certs_580205;
    
    if (!bounds_check_580204) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_reduce_comm_res_585813, "] out of bounds for array of shape [", (long long) n_293585, "].", "-> #0  ftSkyline.fut:324:20-34\n   #1  ftSkyline.fut:360:65-67\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586426 = (int64_t) 8 * n_293585;
    
    if (mem_586427_cached_sizze_588828 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_588828, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586429_cached_sizze_588829 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586429, &mem_586429_cached_sizze_588829, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586436_cached_sizze_588830 < dim_293582) {
        err = lexical_realloc(ctx, &mem_586436, &mem_586436_cached_sizze_588830, dim_293582);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586071;
    int64_t scanacc_586065 = (int64_t) 0;
    
    for (int64_t i_586068 = 0; i_586068 < n_293585; i_586068++) {
        for (int64_t i_586057 = 0; i_586057 < dim_293582; i_586057++) {
            double eta_p_582654 = ((double *) xs_mem_586417.mem)[i_586068 * dim_293582 + i_586057];
            double eta_p_582655 = ((double *) xs_mem_586417.mem)[defunc_0_reduce_comm_res_585813 * dim_293582 + i_586057];
            bool defunc_0_f_res_582656 = eta_p_582655 <= eta_p_582654;
            
            ((bool *) mem_586436)[i_586057] = defunc_0_f_res_582656;
        }
        
        bool defunc_0_foldl_res_582657;
        bool acc_582659 = 1;
        
        for (int64_t i_582658 = 0; i_582658 < dim_293582; i_582658++) {
            bool b_582660 = ((bool *) mem_586436)[i_582658];
            bool x_582661 = acc_582659 && b_582660;
            bool acc_tmp_588022 = x_582661;
            
            acc_582659 = acc_tmp_588022;
        }
        defunc_0_foldl_res_582657 = acc_582659;
        
        bool defunc_0_f_res_582662;
        
        if (defunc_0_foldl_res_582657) {
            if (mem_586443_cached_sizze_588831 < dim_293582) {
                err = lexical_realloc(ctx, &mem_586443, &mem_586443_cached_sizze_588831, dim_293582);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586061 = 0; i_586061 < dim_293582; i_586061++) {
                double eta_p_584696 = ((double *) xs_mem_586417.mem)[i_586068 * dim_293582 + i_586061];
                double eta_p_584697 = ((double *) xs_mem_586417.mem)[defunc_0_reduce_comm_res_585813 * dim_293582 + i_586061];
                bool defunc_0_f_res_584698 = eta_p_584697 < eta_p_584696;
                
                ((bool *) mem_586443)[i_586061] = defunc_0_f_res_584698;
            }
            
            bool defunc_0_foldl_res_584700;
            bool acc_584702 = 0;
            
            for (int64_t i_584701 = 0; i_584701 < dim_293582; i_584701++) {
                bool b_584703 = ((bool *) mem_586443)[i_584701];
                bool defunc_0_f_res_584704 = acc_584702 || b_584703;
                bool acc_tmp_588024 = defunc_0_f_res_584704;
                
                acc_584702 = acc_tmp_588024;
            }
            defunc_0_foldl_res_584700 = acc_584702;
            defunc_0_f_res_582662 = defunc_0_foldl_res_584700;
        } else {
            defunc_0_f_res_582662 = 0;
        }
        
        bool lifted_lambda_res_582673 = !defunc_0_f_res_582662;
        int64_t defunc_0_f_res_582674 = btoi_bool_i64(lifted_lambda_res_582673);
        int64_t defunc_0_op_res_580236 = add64(defunc_0_f_res_582674, scanacc_586065);
        
        ((int64_t *) mem_586427)[i_586068] = defunc_0_op_res_580236;
        ((int64_t *) mem_586429)[i_586068] = defunc_0_f_res_582674;
        
        int64_t scanacc_tmp_588018 = defunc_0_op_res_580236;
        
        scanacc_586065 = scanacc_tmp_588018;
    }
    discard_586071 = scanacc_586065;
    
    bool cond_580237 = n_293585 == (int64_t) 0;
    bool x_580238 = !cond_580237;
    int64_t tmp_580239 = sub64(n_293585, (int64_t) 1);
    bool x_580240 = sle64((int64_t) 0, tmp_580239);
    bool y_580241 = slt64(tmp_580239, n_293585);
    bool bounds_check_580242 = x_580240 && y_580241;
    bool protect_assert_disj_580243 = cond_580237 || bounds_check_580242;
    bool index_certs_580244;
    
    if (!protect_assert_disj_580243) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_580239, "] out of bounds for array of shape [", (long long) n_293585, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_580245;
    
    if (x_580238) {
        int64_t x_584706 = ((int64_t *) mem_586427)[tmp_580239];
        
        m_f_res_580245 = x_584706;
    } else {
        m_f_res_580245 = (int64_t) 0;
    }
    
    int64_t m_580247;
    
    if (cond_580237) {
        m_580247 = (int64_t) 0;
    } else {
        m_580247 = m_f_res_580245;
    }
    
    int64_t m_580257 = sub64(m_580247, (int64_t) 1);
    bool i_p_m_t_s_leq_w_580259 = slt64(m_580257, n_293585);
    bool zzero_leq_i_p_m_t_s_580258 = sle64((int64_t) 0, m_580257);
    bool y_580261 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_580259;
    bool i_lte_j_580260 = sle64((int64_t) 0, m_580247);
    bool forwards_ok_580262 = i_lte_j_580260 && y_580261;
    bool eq_x_zz_580254 = (int64_t) 0 == m_f_res_580245;
    bool p_and_eq_x_y_580255 = x_580238 && eq_x_zz_580254;
    bool empty_slice_580256 = cond_580237 || p_and_eq_x_y_580255;
    bool ok_or_empty_580263 = empty_slice_580256 || forwards_ok_580262;
    bool index_certs_580264;
    
    if (!ok_or_empty_580263) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_580247, "] out of bounds for array of shape [", (long long) n_293585, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586456 = (int64_t) 8 * m_580247;
    
    if (mem_586457_cached_sizze_588832 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_586457, &mem_586457_cached_sizze_588832, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_588025 = 0; i_588025 < m_580247; i_588025++) {
        int64_t x_588026 = (int64_t) 0 + i_588025 * (int64_t) 1;
        
        ((int64_t *) mem_586457)[i_588025] = x_588026;
    }
    for (int64_t write_iter_586072 = 0; write_iter_586072 < n_293585; write_iter_586072++) {
        int64_t write_iv_586074 = ((int64_t *) mem_586429)[write_iter_586072];
        int64_t write_iv_586075 = ((int64_t *) mem_586427)[write_iter_586072];
        bool cond_582642 = write_iv_586074 == (int64_t) 1;
        int64_t lifted_lambda_res_582643;
        
        if (cond_582642) {
            int64_t lifted_lambda_res_t_res_584707 = sub64(write_iv_586075, (int64_t) 1);
            
            lifted_lambda_res_582643 = lifted_lambda_res_t_res_584707;
        } else {
            lifted_lambda_res_582643 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582643) && slt64(lifted_lambda_res_582643, m_580247)) {
            ((int64_t *) mem_586457)[lifted_lambda_res_582643] = write_iter_586072;
        }
    }
    
    int64_t bytes_586465 = dim_293582 * bytes_586456;
    
    if (memblock_alloc(ctx, &mem_586466, bytes_586465, "mem_586466")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586468, bytes_586456, "mem_586468")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586082 = 0; i_586082 < m_580247; i_586082++) {
        int64_t eta_p_580271 = ((int64_t *) mem_586457)[i_586082];
        bool x_580272 = sle64((int64_t) 0, eta_p_580271);
        bool y_580273 = slt64(eta_p_580271, n_293585);
        bool bounds_check_580274 = x_580272 && y_580273;
        bool index_certs_580275;
        
        if (!bounds_check_580274) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_580271, "] out of bounds for array of shape [", (long long) n_293585, "].", "-> #0  ftSkyline.fut:334:49-54\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:334:37-62\n   #3  ftSkyline.fut:360:65-67\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t index_primexp_582217 = add64(offset_293596, eta_p_580271);
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586466.mem, i_586082 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) xs_mem_586417.mem, eta_p_580271 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
        ((int64_t *) mem_586468.mem)[i_586082] = index_primexp_582217;
    }
    
    bool cond_580278 = !use_measure_for_sorting_293597;
    bool protect_assert_disj_582196 = y_580163 || cond_580278;
    bool index_certs_580975;
    
    if (!protect_assert_disj_582196) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582198 = assert_cond_580154 || cond_580278;
    bool empty_or_match_cert_581068;
    
    if (!protect_assert_disj_582198) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581099 = sle64(m_580247, (int64_t) 1);
    bool x_581100 = !cond_581099;
    int64_t zp_rhs_581102 = sdiv_safe64(m_580257, (int64_t) 20);
    int64_t min_num_blocks_581103 = add64((int64_t) 1, zp_rhs_581102);
    bool loop_cond_581104 = slt64((int64_t) 1, min_num_blocks_581103);
    bool x_582199;
    int64_t x_582200;
    bool loop_while_581107;
    int64_t x_581108;
    
    loop_while_581107 = loop_cond_581104;
    x_581108 = (int64_t) 1;
    while (loop_while_581107) {
        int64_t loopres_581109 = mul64((int64_t) 2, x_581108);
        bool loop_cond_581110 = slt64(loopres_581109, min_num_blocks_581103);
        bool loop_while_tmp_588030 = loop_cond_581110;
        int64_t x_tmp_588031 = loopres_581109;
        
        loop_while_581107 = loop_while_tmp_588030;
        x_581108 = x_tmp_588031;
    }
    x_582199 = loop_while_581107;
    x_582200 = x_581108;
    
    bool zzero_581111 = x_582200 == (int64_t) 0;
    bool nonzzero_581112 = !zzero_581111;
    bool protect_assert_disj_581113 = cond_581099 || nonzzero_581112;
    bool protect_assert_disj_582204 = cond_580278 || protect_assert_disj_581113;
    bool nonzzero_cert_581114;
    
    if (!protect_assert_disj_582204) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_581115 = sdiv_safe64(m_580257, x_582200);
    int64_t block_sizze_581116 = add64((int64_t) 1, zp_rhs_581115);
    bool y_581117 = slt64((int64_t) 0, m_580247);
    bool protect_assert_disj_581118 = cond_581099 || y_581117;
    bool protect_assert_disj_582206 = cond_580278 || protect_assert_disj_581118;
    bool index_certs_581119;
    
    if (!protect_assert_disj_582206) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582207 = use_measure_for_sorting_293597 && x_581100;
    int64_t reduce_arg1_581124;
    
    if (protect_cond_conj_582207) {
        int64_t x_584708 = ((int64_t *) mem_586468.mem)[(int64_t) 0];
        
        reduce_arg1_581124 = x_584708;
    } else {
        reduce_arg1_581124 = (int64_t) 0;
    }
    
    int64_t flat_dim_581126 = block_sizze_581116 * x_582200;
    int64_t greatest_divisor_leq_than_arg1_581131 = mul64((int64_t) 2, block_sizze_581116);
    int64_t merge_block_sizze_581132;
    
    if (protect_cond_conj_582207) {
        int64_t x_584709;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584709, (int64_t) 8, greatest_divisor_leq_than_arg1_581131) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_581132 = x_584709;
    } else {
        merge_block_sizze_581132 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_581161 = slt64(x_582200, (int64_t) 0);
    bool valid_581162 = !bounds_invalid_upwards_581161;
    bool protect_assert_disj_582188 = cond_581099 || valid_581162;
    bool protect_assert_disj_582210 = cond_580278 || protect_assert_disj_582188;
    bool range_valid_c_581163;
    
    if (!protect_assert_disj_582210) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582200, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:818:33-56\n   #6  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_581165 = slt64(block_sizze_581116, (int64_t) 0);
    bool valid_581166 = !bounds_invalid_upwards_581165;
    bool protect_assert_disj_582190 = cond_581099 || valid_581166;
    bool protect_assert_disj_582212 = cond_580278 || protect_assert_disj_582190;
    bool range_valid_c_581167;
    
    if (!protect_assert_disj_582212) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_581116, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581169 = sle64(block_sizze_581116, (int64_t) 1);
    int64_t tmp_581170 = sub64(block_sizze_581116, (int64_t) 2);
    bool bounds_invalid_upwards_581171 = slt64(tmp_581170, (int64_t) 0);
    int64_t distance_581172 = add64((int64_t) 1, tmp_581170);
    bool valid_581173 = !bounds_invalid_upwards_581171;
    bool protect_assert_disj_581174 = cond_581169 || valid_581173;
    bool protect_assert_disj_582192 = cond_581099 || protect_assert_disj_581174;
    bool protect_assert_disj_582214 = cond_580278 || protect_assert_disj_582192;
    bool range_valid_c_581175;
    
    if (!protect_assert_disj_582214) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_581170, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_581295 = slt64(block_sizze_581116, flat_dim_581126);
    bool zzero_581296 = merge_block_sizze_581132 == (int64_t) 0;
    bool nonzzero_581297 = !zzero_581296;
    bool protect_assert_disj_582159 = use_measure_for_sorting_293597 || y_580163;
    bool index_certs_580287;
    
    if (!protect_assert_disj_582159) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582161 = use_measure_for_sorting_293597 || assert_cond_580154;
    bool empty_or_match_cert_580371;
    
    if (!protect_assert_disj_582161) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582162;
    int64_t x_582163;
    bool loop_while_580407;
    int64_t x_580408;
    
    loop_while_580407 = loop_cond_581104;
    x_580408 = (int64_t) 1;
    while (loop_while_580407) {
        int64_t loopres_580409 = mul64((int64_t) 2, x_580408);
        bool loop_cond_580410 = slt64(loopres_580409, min_num_blocks_581103);
        bool loop_while_tmp_588032 = loop_cond_580410;
        int64_t x_tmp_588033 = loopres_580409;
        
        loop_while_580407 = loop_while_tmp_588032;
        x_580408 = x_tmp_588033;
    }
    x_582162 = loop_while_580407;
    x_582163 = x_580408;
    
    bool zzero_580411 = x_582163 == (int64_t) 0;
    bool nonzzero_580412 = !zzero_580411;
    bool protect_assert_disj_580413 = nonzzero_580412 || cond_581099;
    bool protect_assert_disj_582167 = use_measure_for_sorting_293597 || protect_assert_disj_580413;
    bool nonzzero_cert_580414;
    
    if (!protect_assert_disj_582167) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_580415 = sdiv_safe64(m_580257, x_582163);
    int64_t block_sizze_580416 = add64((int64_t) 1, zp_rhs_580415);
    bool protect_assert_disj_582169 = use_measure_for_sorting_293597 || protect_assert_disj_581118;
    bool index_certs_580419;
    
    if (!protect_assert_disj_582169) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582170 = cond_580278 && x_581100;
    int64_t reduce_arg1_580422;
    
    if (protect_cond_conj_582170) {
        int64_t x_584710 = ((int64_t *) mem_586468.mem)[(int64_t) 0];
        
        reduce_arg1_580422 = x_584710;
    } else {
        reduce_arg1_580422 = (int64_t) 0;
    }
    
    int64_t flat_dim_580424 = block_sizze_580416 * x_582163;
    int64_t greatest_divisor_leq_than_arg1_580428 = mul64((int64_t) 2, block_sizze_580416);
    int64_t merge_block_sizze_580429;
    
    if (protect_cond_conj_582170) {
        int64_t x_584711;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584711, (int64_t) 8, greatest_divisor_leq_than_arg1_580428) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_580429 = x_584711;
    } else {
        merge_block_sizze_580429 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_580447 = slt64(x_582163, (int64_t) 0);
    bool valid_580448 = !bounds_invalid_upwards_580447;
    bool protect_assert_disj_582151 = valid_580448 || cond_581099;
    bool protect_assert_disj_582173 = use_measure_for_sorting_293597 || protect_assert_disj_582151;
    bool range_valid_c_580449;
    
    if (!protect_assert_disj_582173) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582163, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_580451 = slt64(block_sizze_580416, (int64_t) 0);
    bool valid_580452 = !bounds_invalid_upwards_580451;
    bool protect_assert_disj_582153 = valid_580452 || cond_581099;
    bool protect_assert_disj_582175 = use_measure_for_sorting_293597 || protect_assert_disj_582153;
    bool range_valid_c_580453;
    
    if (!protect_assert_disj_582175) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_580416, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_580455 = sle64(block_sizze_580416, (int64_t) 1);
    int64_t tmp_580456 = sub64(block_sizze_580416, (int64_t) 2);
    bool bounds_invalid_upwards_580457 = slt64(tmp_580456, (int64_t) 0);
    int64_t distance_580458 = add64((int64_t) 1, tmp_580456);
    bool valid_580459 = !bounds_invalid_upwards_580457;
    bool protect_assert_disj_580460 = cond_580455 || valid_580459;
    bool protect_assert_disj_582155 = protect_assert_disj_580460 || cond_581099;
    bool protect_assert_disj_582177 = use_measure_for_sorting_293597 || protect_assert_disj_582155;
    bool range_valid_c_580461;
    
    if (!protect_assert_disj_582177) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_580456, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_580549 = slt64(block_sizze_580416, flat_dim_580424);
    bool zzero_580550 = merge_block_sizze_580429 == (int64_t) 0;
    bool nonzzero_580551 = !zzero_580550;
    int64_t bytes_586483 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584;
    int64_t bytes_586525 = (int64_t) 8 * arg_580153;
    int64_t binop_x_586566 = (int64_t) 8 * x_582200;
    int64_t bytes_586567 = block_sizze_581116 * binop_x_586566;
    int64_t bytes_586574 = dim_293582 * bytes_586567;
    int64_t lmad_arg_586596 = dim_293582 * block_sizze_581116;
    int64_t bytes_586597 = (int64_t) 8 * block_sizze_581116;
    int64_t bytes_586602 = dim_293582 * bytes_586597;
    int64_t lmad_arg_586830 = dim_293582 * merge_block_sizze_581132;
    int64_t binop_x_587094 = (int64_t) 8 * x_582163;
    int64_t bytes_587095 = block_sizze_580416 * binop_x_587094;
    int64_t bytes_587099 = dim_293582 * bytes_587095;
    int64_t lmad_arg_587117 = dim_293582 * block_sizze_580416;
    int64_t bytes_587118 = (int64_t) 8 * block_sizze_580416;
    int64_t bytes_587121 = dim_293582 * bytes_587118;
    int64_t lmad_arg_587303 = dim_293582 * merge_block_sizze_580429;
    
    if (cond_580278) {
        if (mem_587028_cached_sizze_588862 < bytes_586483) {
            err = lexical_realloc(ctx, &mem_587028, &mem_587028_cached_sizze_588862, bytes_586483);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586087 = 0; i_586087 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584; i_586087++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584902 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586087];
            double i64_res_584903 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584902);
            double defunc_0_fover_res_584904 = 1.5707963267948966 / i64_res_584903;
            
            ((double *) mem_587028)[i_586087] = defunc_0_fover_res_584904;
        }
        if (mem_587036_cached_sizze_588863 < bytes_586456) {
            err = lexical_realloc(ctx, &mem_587036, &mem_587036_cached_sizze_588863, bytes_586456);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587041_cached_sizze_588864 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_587041, &mem_587041_cached_sizze_588864, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587049_cached_sizze_588865 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_587049, &mem_587049_cached_sizze_588865, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587057_cached_sizze_588866 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_587057, &mem_587057_cached_sizze_588866, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587073_cached_sizze_588868 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_587073, &mem_587073_cached_sizze_588868, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586107 = 0; i_586107 < m_580247; i_586107++) {
            for (int64_t i_586091 = 0; i_586091 < dim_293582; i_586091++) {
                double eta_p_584911 = ((double *) mem_586466.mem)[i_586107 * dim_293582 + i_586091];
                double eta_p_584912 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586091];
                double eta_p_584913 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586091];
                int64_t eta_p_584915 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586091];
                double defunc_0_f_res_584916 = eta_p_584911 - eta_p_584912;
                double defunc_0_f_res_584917 = defunc_0_f_res_584916 / eta_p_584913;
                int64_t f64_res_584918 = fptosi_f64_i64(defunc_0_f_res_584917);
                int64_t max_res_584919 = smax64((int64_t) 0, f64_res_584918);
                int64_t zm_lhs_584924 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586091];
                int64_t min_arg1_584925 = sub64(zm_lhs_584924, (int64_t) 1);
                int64_t min_res_584926 = smin64(max_res_584919, min_arg1_584925);
                int64_t defunc_0_f_res_584927 = mul64(eta_p_584915, min_res_584926);
                
                ((int64_t *) mem_587041)[i_586091] = defunc_0_f_res_584927;
            }
            
            int64_t defunc_0_foldl_res_584929;
            int64_t acc_584931 = (int64_t) 0;
            
            for (int64_t i_584930 = 0; i_584930 < dim_293582; i_584930++) {
                int64_t b_584932 = ((int64_t *) mem_587041)[i_584930];
                int64_t defunc_0_f_res_584933 = add64(acc_584931, b_584932);
                int64_t acc_tmp_588037 = defunc_0_f_res_584933;
                
                acc_584931 = acc_tmp_588037;
            }
            defunc_0_foldl_res_584929 = acc_584931;
            
            bool x_584934 = sle64((int64_t) 0, defunc_0_foldl_res_584929);
            bool y_584935 = slt64(defunc_0_foldl_res_584929, dz2080U_293583);
            bool bounds_check_584936 = x_584934 && y_584935;
            bool index_certs_584937;
            
            if (!bounds_check_584936) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_584929, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586095 = 0; i_586095 < dim_293582; i_586095++) {
                double eta_p_584940 = ((double *) mem_586466.mem)[i_586107 * dim_293582 + i_586095];
                double eta_p_584941 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_584929 * dim_293582 + i_586095];
                double defunc_0_f_res_584942 = eta_p_584940 - eta_p_584941;
                
                ((double *) mem_587049)[i_586095] = defunc_0_f_res_584942;
            }
            for (int64_t nest_i_588039 = 0; nest_i_588039 < arg_580153; nest_i_588039++) {
                ((double *) mem_587057)[nest_i_588039] = 0.0;
            }
            for (int64_t i_584946 = 0; i_584946 < arg_580153; i_584946++) {
                bool y_584948 = slt64(i_584946, dim_293582);
                bool index_certs_584949;
                
                if (!y_584948) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584946, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_584951 = add64((int64_t) 1, i_584946);
                int64_t j_m_i_584952 = sub64(dim_293582, map_arg1_584951);
                bool empty_slice_584953 = j_m_i_584952 == (int64_t) 0;
                int64_t m_584954 = sub64(j_m_i_584952, (int64_t) 1);
                int64_t i_p_m_t_s_584955 = add64(map_arg1_584951, m_584954);
                bool zzero_leq_i_p_m_t_s_584956 = sle64((int64_t) 0, i_p_m_t_s_584955);
                bool i_p_m_t_s_leq_w_584957 = slt64(i_p_m_t_s_584955, dim_293582);
                bool zzero_lte_i_584958 = sle64((int64_t) 0, map_arg1_584951);
                bool i_lte_j_584959 = sle64(map_arg1_584951, dim_293582);
                bool y_584960 = i_p_m_t_s_leq_w_584957 && zzero_lte_i_584958;
                bool y_584961 = zzero_leq_i_p_m_t_s_584956 && y_584960;
                bool forwards_ok_584962 = i_lte_j_584959 && y_584961;
                bool ok_or_empty_584963 = empty_slice_584953 || forwards_ok_584962;
                bool index_certs_584964;
                
                if (!ok_or_empty_584963) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_584951, ":", (long long) dim_293582, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587061 = (int64_t) 8 * j_m_i_584952;
                double this_x_584950 = ((double *) mem_587049)[i_584946];
                
                if (mem_587062_cached_sizze_588867 < bytes_587061) {
                    err = lexical_realloc(ctx, &mem_587062, &mem_587062_cached_sizze_588867, bytes_587061);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586099 = 0; i_586099 < j_m_i_584952; i_586099++) {
                    int64_t slice_586383 = map_arg1_584951 + i_586099;
                    double eta_p_584967 = ((double *) mem_587049)[slice_586383];
                    double defunc_0_ftimes_res_584968 = eta_p_584967 * eta_p_584967;
                    
                    ((double *) mem_587062)[i_586099] = defunc_0_ftimes_res_584968;
                }
                
                double defunc_0_foldl_res_584970;
                double acc_584972 = 0.0;
                
                for (int64_t i_584971 = 0; i_584971 < j_m_i_584952; i_584971++) {
                    double b_584973 = ((double *) mem_587062)[i_584971];
                    double defunc_0_f_res_584974 = acc_584972 + b_584973;
                    double acc_tmp_588042 = defunc_0_f_res_584974;
                    
                    acc_584972 = acc_tmp_588042;
                }
                defunc_0_foldl_res_584970 = acc_584972;
                
                double sqrt_res_584975 = futrts_sqrt64(defunc_0_foldl_res_584970);
                double atan2_res_584976 = futrts_atan2_64(sqrt_res_584975, this_x_584950);
                
                ((double *) mem_587057)[i_584946] = atan2_res_584976;
            }
            for (int64_t i_586103 = 0; i_586103 < arg_580153; i_586103++) {
                double eta_p_584979 = ((double *) mem_587057)[i_586103];
                double eta_p_584980 = ((double *) mem_587028)[i_586103];
                int64_t eta_p_584981 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586103];
                int64_t eta_p_584982 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586103];
                double i64_res_584983 = sitofp_i64_f64(eta_p_584981);
                double defunc_0_fover_res_584984 = eta_p_584979 / eta_p_584980;
                double defunc_0_ftimes_res_584985 = i64_res_584983 * defunc_0_fover_res_584984;
                int64_t f64_res_584986 = fptosi_f64_i64(defunc_0_ftimes_res_584985);
                bool cond_584987 = slt64(f64_res_584986, (int64_t) 0);
                int64_t defunc_0_f_res_584988;
                
                if (cond_584987) {
                    defunc_0_f_res_584988 = (int64_t) 0;
                } else {
                    bool cond_584989 = sle64(eta_p_584982, f64_res_584986);
                    int64_t defunc_0_f_res_f_res_584990;
                    
                    if (cond_584989) {
                        int64_t defunc_0_f_res_f_res_t_res_584991 = sub64(eta_p_584982, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_584990 = defunc_0_f_res_f_res_t_res_584991;
                    } else {
                        defunc_0_f_res_f_res_584990 = f64_res_584986;
                    }
                    defunc_0_f_res_584988 = defunc_0_f_res_f_res_584990;
                }
                ((int64_t *) mem_587073)[i_586103] = defunc_0_f_res_584988;
            }
            
            int64_t defunc_0_foldl_res_584993;
            int64_t acc_584995 = (int64_t) 0;
            
            for (int64_t i_584994 = 0; i_584994 < arg_580153; i_584994++) {
                int64_t b_584996 = ((int64_t *) mem_587073)[i_584994];
                int64_t defunc_0_f_res_584997 = add64(acc_584995, b_584996);
                int64_t acc_tmp_588044 = defunc_0_f_res_584997;
                
                acc_584995 = acc_tmp_588044;
            }
            defunc_0_foldl_res_584993 = acc_584995;
            
            int64_t zp_lhs_584998 = mul64(total_angle_no_293592, defunc_0_foldl_res_584929);
            int64_t get_id_from_grid_angle_res_584999 = add64(defunc_0_foldl_res_584993, zp_lhs_584998);
            
            ((int64_t *) mem_587036)[i_586107] = get_id_from_grid_angle_res_584999;
        }
        
        int64_t reduce_arg1_585002;
        
        if (x_581100) {
            int64_t x_585003 = ((int64_t *) mem_587036)[(int64_t) 0];
            
            reduce_arg1_585002 = x_585003;
        } else {
            reduce_arg1_585002 = (int64_t) 0;
        }
        if (cond_581099) {
            if (memblock_set(ctx, &ext_mem_587456, &mem_586466, "mem_586466") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587452, &mem_586468, "mem_586468") != 0)
                return 1;
        } else {
            int64_t ext_587092;
            int64_t defunc_0_reduce_res_585007;
            int64_t defunc_0_reduce_res_585009;
            int64_t redout_586109;
            int64_t redout_586111;
            int64_t ctx_param_ext_587083;
            
            if (memblock_set(ctx, &mem_param_587085, &mem_586466, "mem_586466") != 0)
                return 1;
            ctx_param_ext_587083 = (int64_t) 0;
            redout_586109 = reduce_arg1_585002;
            redout_586111 = reduce_arg1_580422;
            for (int64_t i_586112 = 0; i_586112 < m_580247; i_586112++) {
                int64_t x_585010 = ((int64_t *) mem_587036)[i_586112];
                int64_t x_585012 = ((int64_t *) mem_586468.mem)[i_586112];
                bool lifted_lambda_res_585019 = sle64(redout_586109, x_585010);
                int64_t defunc_0_op_res_585020;
                
                if (lifted_lambda_res_585019) {
                    defunc_0_op_res_585020 = x_585010;
                } else {
                    defunc_0_op_res_585020 = redout_586109;
                }
                
                int64_t defunc_0_op_res_585021;
                
                if (lifted_lambda_res_585019) {
                    defunc_0_op_res_585021 = x_585012;
                } else {
                    defunc_0_op_res_585021 = redout_586111;
                }
                
                int64_t binop_y_587086 = dim_293582 * i_586112;
                int64_t ext_587089;
                
                if (lifted_lambda_res_585019) {
                    ext_587089 = binop_y_587086;
                } else {
                    ext_587089 = ctx_param_ext_587083;
                }
                if (lifted_lambda_res_585019) {
                    if (memblock_set(ctx, &ext_mem_587090, &mem_586466, "mem_586466") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587090, &mem_param_587085, "mem_param_587085") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588045, &ext_mem_587090, "ext_mem_587090") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588046 = ext_587089;
                int64_t redout_tmp_588047 = defunc_0_op_res_585020;
                int64_t redout_tmp_588049 = defunc_0_op_res_585021;
                
                if (memblock_set(ctx, &mem_param_587085, &mem_param_tmp_588045, "mem_param_tmp_588045") != 0)
                    return 1;
                ctx_param_ext_587083 = ctx_param_ext_tmp_588046;
                redout_586109 = redout_tmp_588047;
                redout_586111 = redout_tmp_588049;
            }
            if (memblock_set(ctx, &ext_mem_587093, &mem_param_587085, "mem_param_587085") != 0)
                return 1;
            ext_587092 = ctx_param_ext_587083;
            defunc_0_reduce_res_585007 = redout_586109;
            defunc_0_reduce_res_585009 = redout_586111;
            if (mem_587096_cached_sizze_588869 < bytes_587095) {
                err = lexical_realloc(ctx, &mem_587096, &mem_587096_cached_sizze_588869, bytes_587095);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587100_cached_sizze_588870 < bytes_587099) {
                err = lexical_realloc(ctx, &mem_587100, &mem_587100_cached_sizze_588870, bytes_587099);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587103_cached_sizze_588871 < bytes_587095) {
                err = lexical_realloc(ctx, &mem_587103, &mem_587103_cached_sizze_588871, bytes_587095);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587119_cached_sizze_588872 < bytes_587118) {
                err = lexical_realloc(ctx, &mem_587119, &mem_587119_cached_sizze_588872, bytes_587118);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587122_cached_sizze_588873 < bytes_587121) {
                err = lexical_realloc(ctx, &mem_587122, &mem_587122_cached_sizze_588873, bytes_587121);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587124_cached_sizze_588874 < bytes_587118) {
                err = lexical_realloc(ctx, &mem_587124, &mem_587124_cached_sizze_588874, bytes_587118);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586129 = 0; i_586129 < x_582163; i_586129++) {
                int64_t zp_lhs_585038 = mul64(block_sizze_580416, i_586129);
                
                for (int64_t i_586119 = 0; i_586119 < block_sizze_580416; i_586119++) {
                    int64_t k_585043 = add64(zp_lhs_585038, i_586119);
                    bool cond_585044 = slt64(k_585043, m_580247);
                    int64_t binop_y_587135 = dim_293582 * k_585043;
                    int64_t ext_587138;
                    
                    if (cond_585044) {
                        ext_587138 = binop_y_587135;
                    } else {
                        ext_587138 = ext_587092;
                    }
                    
                    int64_t lifted_lambda_res_585045;
                    int64_t lifted_lambda_res_585047;
                    
                    if (cond_585044) {
                        bool x_585048 = sle64((int64_t) 0, k_585043);
                        bool bounds_check_585049 = cond_585044 && x_585048;
                        bool index_certs_585050;
                        
                        if (!bounds_check_585049) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_585043, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585051 = ((int64_t *) mem_587036)[k_585043];
                        int64_t lifted_lambda_res_t_res_585053 = ((int64_t *) mem_586468.mem)[k_585043];
                        
                        if (memblock_set(ctx, &ext_mem_587139, &mem_586466, "mem_586466") != 0)
                            return 1;
                        lifted_lambda_res_585045 = lifted_lambda_res_t_res_585051;
                        lifted_lambda_res_585047 = lifted_lambda_res_t_res_585053;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587139, &ext_mem_587093, "ext_mem_587093") != 0)
                            return 1;
                        lifted_lambda_res_585045 = defunc_0_reduce_res_585007;
                        lifted_lambda_res_585047 = defunc_0_reduce_res_585009;
                    }
                    ((int64_t *) mem_587119)[i_586119] = lifted_lambda_res_585045;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587122, i_586119 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587139.mem, ext_587138, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                    if (memblock_unref(ctx, &ext_mem_587139, "ext_mem_587139") != 0)
                        return 1;
                    ((int64_t *) mem_587124)[i_586119] = lifted_lambda_res_585047;
                }
                if (!cond_580455) {
                    if (mem_587171_cached_sizze_588875 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_587171, &mem_587171_cached_sizze_588875, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587173_cached_sizze_588876 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_587173, &mem_587173_cached_sizze_588876, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_585063 = 0; i_585063 < distance_580458; i_585063++) {
                        int64_t gt_arg1_585067 = add64((int64_t) 1, i_585063);
                        bool x_585068 = sle64((int64_t) 0, gt_arg1_585067);
                        bool y_585069 = slt64(gt_arg1_585067, block_sizze_580416);
                        bool bounds_check_585070 = x_585068 && y_585069;
                        bool index_certs_585071;
                        
                        if (!bounds_check_585070) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_585067, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_585073 = slt64(i_585063, block_sizze_580416);
                        bool index_certs_585074;
                        
                        if (!y_585073) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585063, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_585072 = ((int64_t *) mem_587119)[gt_arg1_585067];
                        int64_t gt_arg0_585075 = ((int64_t *) mem_587119)[i_585063];
                        bool lifted_lambda_res_585076 = sle64(gt_arg0_585075, gt_arg1_585072);
                        bool defunc_0_lifted_gt_res_585077 = !lifted_lambda_res_585076;
                        bool s_585078;
                        int64_t s_585082;
                        bool loop_while_585083;
                        int64_t j_585087;
                        
                        loop_while_585083 = defunc_0_lifted_gt_res_585077;
                        j_585087 = i_585063;
                        while (loop_while_585083) {
                            bool x_585088 = sle64((int64_t) 0, j_585087);
                            bool y_585089 = slt64(j_585087, block_sizze_580416);
                            bool bounds_check_585090 = x_585088 && y_585089;
                            bool index_certs_585091;
                            
                            if (!bounds_check_585090) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585087, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585096 = add64((int64_t) 1, j_585087);
                            bool x_585097 = sle64((int64_t) 0, copy_arg0_585096);
                            bool y_585098 = slt64(copy_arg0_585096, block_sizze_580416);
                            bool bounds_check_585099 = x_585097 && y_585098;
                            bool index_certs_585100;
                            
                            if (!bounds_check_585099) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_585096, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585092 = ((int64_t *) mem_587119)[j_585087];
                            int64_t copy_arg0_585094 = ((int64_t *) mem_587124)[j_585087];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587171, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587122, (int64_t) 0 + j_585087 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            
                            int64_t copy_arg0_585101 = ((int64_t *) mem_587119)[copy_arg0_585096];
                            int64_t copy_arg0_585103 = ((int64_t *) mem_587124)[copy_arg0_585096];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587173, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587122, (int64_t) 0 + copy_arg0_585096 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_587119)[j_585087] = copy_arg0_585101;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587122, j_585087 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587173, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_587124)[j_585087] = copy_arg0_585103;
                            ((int64_t *) mem_587119)[copy_arg0_585096] = copy_arg0_585092;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587122, copy_arg0_585096 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587171, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_587124)[copy_arg0_585096] = copy_arg0_585094;
                            
                            int64_t tmp_585111 = sub64(j_585087, (int64_t) 1);
                            bool cond_585112 = sle64((int64_t) 0, tmp_585111);
                            bool loop_cond_585113;
                            
                            if (cond_585112) {
                                bool y_585115 = slt64(tmp_585111, block_sizze_580416);
                                bool bounds_check_585116 = cond_585112 && y_585115;
                                bool index_certs_585117;
                                
                                if (!bounds_check_585116) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585111, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585114 = ((int64_t *) mem_587119)[j_585087];
                                int64_t gt_arg0_585118 = ((int64_t *) mem_587119)[tmp_585111];
                                bool lifted_lambda_res_585119 = sle64(gt_arg0_585118, gt_arg1_585114);
                                bool defunc_0_lifted_gt_res_585120 = !lifted_lambda_res_585119;
                                
                                loop_cond_585113 = defunc_0_lifted_gt_res_585120;
                            } else {
                                loop_cond_585113 = 0;
                            }
                            
                            bool loop_while_tmp_588059 = loop_cond_585113;
                            int64_t j_tmp_588063 = tmp_585111;
                            
                            loop_while_585083 = loop_while_tmp_588059;
                            j_585087 = j_tmp_588063;
                        }
                        s_585078 = loop_while_585083;
                        s_585082 = j_585087;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587096, i_586129 * block_sizze_580416, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587119, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580416});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587100, i_586129 * lmad_arg_587117, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) mem_587122, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {block_sizze_580416, dim_293582});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587103, i_586129 * block_sizze_580416, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587124, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580416});
            }
            if (memblock_unref(ctx, &ext_mem_587093, "ext_mem_587093") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587219, bytes_587095, "mem_587219")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587219.mem, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (uint64_t *) mem_587096, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416});
            if (memblock_alloc(ctx, &mem_587224, bytes_587099, "mem_587224")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_587224.mem, (int64_t) 0, (int64_t []) {dim_293582 * block_sizze_580416, dim_293582, (int64_t) 1}, (uint64_t *) mem_587100, (int64_t) 0, (int64_t []) {lmad_arg_587117, dim_293582, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416, dim_293582});
            if (memblock_alloc(ctx, &mem_587228, bytes_587095, "mem_587228")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587228.mem, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (uint64_t *) mem_587103, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416});
            
            int64_t data_585133;
            bool data_585134;
            int64_t data_585138;
            int64_t loop_dz2084Uz2082U_585139;
            bool loop_while_585140;
            int64_t stride_585144;
            
            if (memblock_set(ctx, &mem_param_587232, &mem_587219, "mem_587219") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587236, &mem_587224, "mem_587224") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587239, &mem_587228, "mem_587228") != 0)
                return 1;
            loop_dz2084Uz2082U_585139 = flat_dim_580424;
            loop_while_585140 = loop_cond_580549;
            stride_585144 = block_sizze_580416;
            while (loop_while_585140) {
                int64_t next_stride_585145 = mul64((int64_t) 2, stride_585144);
                bool zzero_585146 = next_stride_585145 == (int64_t) 0;
                bool nonzzero_585147 = !zzero_585146;
                bool nonzzero_cert_585148;
                
                if (!nonzzero_585147) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585149 = sdiv64(flat_dim_580424, next_stride_585145);
                bool bounds_invalid_upwards_585150 = slt64(num_merges_585149, (int64_t) 0);
                bool valid_585151 = !bounds_invalid_upwards_585150;
                bool range_valid_c_585152;
                
                if (!valid_585151) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585149, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585154 = sub64(next_stride_585145, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585155 = sle64((int64_t) 0, m_585154);
                bool cond_585157 = slt64(next_stride_585145, (int64_t) 10);
                bool protect_assert_disj_585158 = nonzzero_580551 || cond_585157;
                bool nonzzero_cert_585159;
                
                if (!protect_assert_disj_585158) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585160 = smod_safe64(next_stride_585145, merge_block_sizze_580429);
                bool num_blocks_585161 = zeze_lhs_585160 == (int64_t) 0;
                bool protect_assert_disj_585162 = cond_585157 || num_blocks_585161;
                bool assert_c_585163;
                
                if (!protect_assert_disj_585162) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585164 = sdiv_safe64(next_stride_585145, merge_block_sizze_580429);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165 = add64((int64_t) 1, num_blocks_585164);
                int64_t j_m_i_585166 = sub64(next_stride_585145, stride_585144);
                int64_t flat_dim_585167 = merge_block_sizze_580429 * num_blocks_585164;
                bool bounds_invalid_upwards_585168 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, (int64_t) 0);
                bool empty_slice_585169 = j_m_i_585166 == (int64_t) 0;
                int64_t m_585170 = sub64(j_m_i_585166, (int64_t) 1);
                bool zzero_lte_i_585171 = sle64((int64_t) 0, stride_585144);
                bool i_lte_j_585172 = sle64(stride_585144, next_stride_585145);
                bool empty_slice_585173 = stride_585144 == (int64_t) 0;
                int64_t m_585174 = sub64(stride_585144, (int64_t) 1);
                bool bounds_invalid_upwards_585175 = slt64(num_blocks_585164, (int64_t) 0);
                bool cond_585176 = slt64((int64_t) 0, stride_585144);
                bool valid_585177 = !bounds_invalid_upwards_585168;
                int64_t i_p_m_t_s_585178 = add64(stride_585144, m_585170);
                bool zzero_leq_i_p_m_t_s_585179 = sle64((int64_t) 0, m_585174);
                bool i_p_m_t_s_leq_w_585180 = slt64(m_585174, next_stride_585145);
                bool valid_585181 = !bounds_invalid_upwards_585175;
                bool i_p_m_t_s_leq_w_585182 = slt64(m_585154, flat_dim_585167);
                bool y_585183 = slt64((int64_t) 0, j_m_i_585166);
                bool protect_assert_disj_585184 = cond_585157 || valid_585177;
                bool range_valid_c_585185;
                
                if (!protect_assert_disj_585184) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585186 = sle64((int64_t) 0, i_p_m_t_s_585178);
                bool i_p_m_t_s_leq_w_585187 = slt64(i_p_m_t_s_585178, next_stride_585145);
                bool y_585188 = zzero_leq_i_p_m_t_s_585179 && i_p_m_t_s_leq_w_585180;
                bool protect_assert_disj_585189 = cond_585157 || valid_585181;
                bool range_valid_c_585190;
                
                if (!protect_assert_disj_585189) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585164, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585191 = zzero_leq_i_p_m_t_s_585155 && i_p_m_t_s_leq_w_585182;
                bool y_585192 = zzero_lte_i_585171 && i_p_m_t_s_leq_w_585187;
                bool forwards_ok_585193 = zzero_lte_i_585171 && y_585188;
                bool ok_or_empty_585194 = zzero_585146 || y_585191;
                bool protect_assert_disj_585195 = cond_585176 || y_585183;
                bool y_585196 = zzero_leq_i_p_m_t_s_585186 && y_585192;
                bool ok_or_empty_585197 = empty_slice_585173 || forwards_ok_585193;
                bool protect_assert_disj_585198 = cond_585157 || ok_or_empty_585194;
                bool index_certs_585199;
                
                if (!protect_assert_disj_585198) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585145, "] out of bounds for array of shape [", (long long) flat_dim_585167, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585200 = !cond_585157;
                bool protect_assert_disj_585201 = protect_assert_disj_585195 || loop_not_taken_585200;
                bool index_certs_585202;
                
                if (!protect_assert_disj_585201) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585203 = i_lte_j_585172 && y_585196;
                bool protect_assert_disj_585204 = cond_585157 || ok_or_empty_585197;
                bool index_certs_585205;
                
                if (!protect_assert_disj_585204) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585144, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585206 = ok_or_empty_585197 || loop_not_taken_585200;
                bool index_certs_585207;
                
                if (!protect_assert_disj_585206) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585144, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585208 = empty_slice_585169 || forwards_ok_585203;
                bool protect_assert_disj_585209 = cond_585157 || ok_or_empty_585208;
                bool index_certs_585210;
                
                if (!protect_assert_disj_585209) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585144, ":] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585211 = loop_not_taken_585200 || ok_or_empty_585208;
                bool index_certs_585212;
                
                if (!protect_assert_disj_585211) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585144, ":] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587240 = (int64_t) 8 * num_merges_585149;
                int64_t bytes_587241 = next_stride_585145 * binop_x_587240;
                int64_t bytes_587245 = dim_293582 * bytes_587241;
                bool i_lte_j_585156 = sle64((int64_t) 0, next_stride_585145);
                
                if (mem_587242_cached_sizze_588877 < bytes_587241) {
                    err = lexical_realloc(ctx, &mem_587242, &mem_587242_cached_sizze_588877, bytes_587241);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587246_cached_sizze_588878 < bytes_587245) {
                    err = lexical_realloc(ctx, &mem_587246, &mem_587246_cached_sizze_588878, bytes_587245);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587249_cached_sizze_588879 < bytes_587241) {
                    err = lexical_realloc(ctx, &mem_587249, &mem_587249_cached_sizze_588879, bytes_587241);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587263 = dim_293582 * next_stride_585145;
                int64_t bytes_587264 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165;
                int64_t binop_x_587280 = (int64_t) 8 * num_blocks_585164;
                int64_t bytes_587281 = merge_block_sizze_580429 * binop_x_587280;
                int64_t bytes_587285 = dim_293582 * bytes_587281;
                int64_t bytes_587372 = (int64_t) 16 * stride_585144;
                int64_t bytes_587377 = dim_293582 * bytes_587372;
                
                for (int64_t i_586156 = 0; i_586156 < num_merges_585149; i_586156++) {
                    int64_t start_585217 = mul64(next_stride_585145, i_586156);
                    int64_t j_m_i_585218 = sub64(loop_dz2084Uz2082U_585139, start_585217);
                    bool empty_slice_585219 = j_m_i_585218 == (int64_t) 0;
                    int64_t m_585220 = sub64(j_m_i_585218, (int64_t) 1);
                    int64_t i_p_m_t_s_585221 = add64(start_585217, m_585220);
                    bool zzero_leq_i_p_m_t_s_585222 = sle64((int64_t) 0, i_p_m_t_s_585221);
                    bool i_p_m_t_s_leq_w_585223 = slt64(i_p_m_t_s_585221, loop_dz2084Uz2082U_585139);
                    bool zzero_lte_i_585224 = sle64((int64_t) 0, start_585217);
                    bool i_lte_j_585225 = sle64(start_585217, loop_dz2084Uz2082U_585139);
                    bool y_585226 = i_p_m_t_s_leq_w_585223 && zzero_lte_i_585224;
                    bool y_585227 = zzero_leq_i_p_m_t_s_585222 && y_585226;
                    bool forwards_ok_585228 = i_lte_j_585225 && y_585227;
                    bool ok_or_empty_585229 = empty_slice_585219 || forwards_ok_585228;
                    bool index_certs_585230;
                    
                    if (!ok_or_empty_585229) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585217, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585139, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585231 = slt64(m_585154, j_m_i_585218);
                    bool y_585232 = zzero_leq_i_p_m_t_s_585155 && i_p_m_t_s_leq_w_585231;
                    bool forwards_ok_585233 = i_lte_j_585156 && y_585232;
                    bool ok_or_empty_585234 = zzero_585146 || forwards_ok_585233;
                    bool index_certs_585235;
                    
                    if (!ok_or_empty_585234) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585145, "] out of bounds for array of shape [", (long long) j_m_i_585218, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:818:33-56\n   #7  ftSkyline.fut:807:17-818:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585245 = stride_585144 + start_585217;
                    int64_t binop_y_587367 = dim_293582 * slice_585245;
                    int64_t binop_y_587369 = dim_293582 * start_585217;
                    int64_t ext_587371;
                    
                    if (cond_585176) {
                        ext_587371 = binop_y_587369;
                    } else {
                        ext_587371 = binop_y_587367;
                    }
                    if (cond_585157) {
                        int64_t dummy_585239;
                        int64_t dummy_585241;
                        
                        if (cond_585176) {
                            int64_t head_res_585242 = ((int64_t *) mem_param_587232.mem)[start_585217];
                            int64_t head_res_585244 = ((int64_t *) mem_param_587239.mem)[start_585217];
                            
                            dummy_585239 = head_res_585242;
                            dummy_585241 = head_res_585244;
                        } else {
                            int64_t head_res_585246 = ((int64_t *) mem_param_587232.mem)[slice_585245];
                            int64_t head_res_585248 = ((int64_t *) mem_param_587239.mem)[slice_585245];
                            
                            dummy_585239 = head_res_585246;
                            dummy_585241 = head_res_585248;
                        }
                        if (memblock_alloc(ctx, &mem_587373, bytes_587372, "mem_587373")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588076 = 0; nest_i_588076 < next_stride_585145; nest_i_588076++) {
                            ((int64_t *) mem_587373.mem)[nest_i_588076] = dummy_585239;
                        }
                        if (memblock_alloc(ctx, &mem_587375, bytes_587372, "mem_587375")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588077 = 0; nest_i_588077 < next_stride_585145; nest_i_588077++) {
                            ((int64_t *) mem_587375.mem)[nest_i_588077] = dummy_585241;
                        }
                        if (memblock_alloc(ctx, &mem_587378, bytes_587377, "mem_587378")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588078 = 0; nest_i_588078 < next_stride_585145; nest_i_588078++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587378.mem, nest_i_588078 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587236.mem, ext_587371, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                        }
                        
                        int64_t data_585252;
                        int64_t i_585257 = (int64_t) 0;
                        
                        for (int64_t k_585256 = 0; k_585256 < next_stride_585145; k_585256++) {
                            int64_t j_585261 = sub64(k_585256, i_585257);
                            bool cond_585262 = j_585261 == j_m_i_585166;
                            bool x_587783 = !cond_585262;
                            bool cond_585264 = slt64(i_585257, stride_585144);
                            bool x_585266 = sle64((int64_t) 0, j_585261);
                            bool y_585267 = slt64(j_585261, j_m_i_585166);
                            bool bounds_check_585268 = x_585266 && y_585267;
                            bool loop_not_taken_587775 = !cond_585264;
                            bool protect_assert_disj_587776 = bounds_check_585268 || loop_not_taken_587775;
                            bool protect_assert_disj_587786 = cond_585262 || protect_assert_disj_587776;
                            bool index_certs_585269;
                            
                            if (!protect_assert_disj_587786) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585261, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585270 = stride_585144 + j_585261;
                            int64_t slice_585271 = start_585217 + slice_585270;
                            bool protect_cond_conj_587787 = cond_585264 && x_587783;
                            int64_t leq_arg1_585272;
                            
                            if (protect_cond_conj_587787) {
                                int64_t x_587777 = ((int64_t *) mem_param_587232.mem)[slice_585271];
                                
                                leq_arg1_585272 = x_587777;
                            } else {
                                leq_arg1_585272 = (int64_t) 0;
                            }
                            
                            bool x_585273 = sle64((int64_t) 0, i_585257);
                            bool bounds_check_585274 = cond_585264 && x_585273;
                            bool protect_assert_disj_587780 = bounds_check_585274 || loop_not_taken_587775;
                            bool protect_assert_disj_587789 = cond_585262 || protect_assert_disj_587780;
                            bool index_certs_585275;
                            
                            if (!protect_assert_disj_587789) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585257, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585276 = start_585217 + i_585257;
                            int64_t leq_arg0_585277;
                            
                            if (protect_cond_conj_587787) {
                                int64_t x_587781 = ((int64_t *) mem_param_587232.mem)[slice_585276];
                                
                                leq_arg0_585277 = x_587781;
                            } else {
                                leq_arg0_585277 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585278 = sle64(leq_arg0_585277, leq_arg1_585272);
                            bool x_587863 = cond_585264 && lifted_lambda_res_585278;
                            bool cond_585263 = cond_585262 || x_587863;
                            bool protect_assert_disj_587695 = cond_585263 || bounds_check_585268;
                            bool index_certs_585295;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585261, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585286 = cond_585264 && x_585273;
                            bool loop_not_taken_587690 = !cond_585263;
                            bool protect_assert_disj_587691 = bounds_check_585286 || loop_not_taken_587690;
                            bool index_certs_585287;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585257, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585297 = start_585217 + slice_585270;
                            int64_t binop_y_587389 = dim_293582 * slice_585297;
                            int64_t binop_y_587391 = dim_293582 * slice_585276;
                            int64_t ext_587393;
                            
                            if (cond_585263) {
                                ext_587393 = binop_y_587391;
                            } else {
                                ext_587393 = binop_y_587389;
                            }
                            
                            int64_t loopres_585279;
                            int64_t loopres_585280;
                            int64_t loopres_585282;
                            
                            if (cond_585263) {
                                int64_t tmp_585283 = add64((int64_t) 1, i_585257);
                                int64_t tmp_585289 = ((int64_t *) mem_param_587232.mem)[slice_585276];
                                int64_t tmp_585291 = ((int64_t *) mem_param_587239.mem)[slice_585276];
                                
                                loopres_585279 = tmp_585283;
                                loopres_585280 = tmp_585289;
                                loopres_585282 = tmp_585291;
                            } else {
                                int64_t tmp_585298 = ((int64_t *) mem_param_587232.mem)[slice_585297];
                                int64_t tmp_585300 = ((int64_t *) mem_param_587239.mem)[slice_585297];
                                
                                loopres_585279 = i_585257;
                                loopres_585280 = tmp_585298;
                                loopres_585282 = tmp_585300;
                            }
                            ((int64_t *) mem_587373.mem)[k_585256] = loopres_585280;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587378.mem, k_585256 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587236.mem, ext_587393, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_587375.mem)[k_585256] = loopres_585282;
                            
                            int64_t i_tmp_588079 = loopres_585279;
                            
                            i_585257 = i_tmp_588079;
                        }
                        data_585252 = i_585257;
                        if (memblock_set(ctx, &ext_mem_587413, &mem_587373, "mem_587373") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587410, &mem_587378, "mem_587378") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587406, &mem_587375, "mem_587375") != 0)
                            return 1;
                    } else {
                        if (mem_587265_cached_sizze_588880 < bytes_587264) {
                            err = lexical_realloc(ctx, &mem_587265, &mem_587265_cached_sizze_588880, bytes_587264);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587267_cached_sizze_588881 < bytes_587264) {
                            err = lexical_realloc(ctx, &mem_587267, &mem_587267_cached_sizze_588881, bytes_587264);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586137 = 0; i_586137 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165; i_586137++) {
                            int64_t split_count_arg3_585308 = mul64(merge_block_sizze_580429, i_586137);
                            int64_t defunc_0_split_count_res_585309;
                            int64_t defunc_0_split_count_res_585310;
                            int64_t defunc_0_split_count_res_585311;
                            int64_t defunc_0_split_count_res_585312;
                            int64_t defunc_0_split_count_res_585313;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585309, &defunc_0_split_count_res_585310, &defunc_0_split_count_res_585311, &defunc_0_split_count_res_585312, &defunc_0_split_count_res_585313, (int64_t) 0, stride_585144, (int64_t) 0, j_m_i_585166, split_count_arg3_585308) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585314 = slt64((int64_t) 0, defunc_0_split_count_res_585313);
                            bool defunc_0_split_count_res_585315;
                            int64_t defunc_0_split_count_res_585316;
                            int64_t defunc_0_split_count_res_585317;
                            int64_t defunc_0_split_count_res_585318;
                            int64_t defunc_0_split_count_res_585319;
                            int64_t defunc_0_split_count_res_585320;
                            bool loop_while_585321;
                            int64_t ss_585322;
                            int64_t ss_585323;
                            int64_t tt_585324;
                            int64_t tt_585325;
                            int64_t count_585326;
                            
                            loop_while_585321 = loop_cond_585314;
                            ss_585322 = defunc_0_split_count_res_585309;
                            ss_585323 = defunc_0_split_count_res_585310;
                            tt_585324 = defunc_0_split_count_res_585311;
                            tt_585325 = defunc_0_split_count_res_585312;
                            count_585326 = defunc_0_split_count_res_585313;
                            while (loop_while_585321) {
                                int64_t zlze_lhs_585327 = sub64(ss_585323, ss_585322);
                                bool cond_585328 = sle64(zlze_lhs_585327, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585329;
                                int64_t defunc_0_lifted_step_res_585330;
                                int64_t defunc_0_lifted_step_res_585331;
                                int64_t defunc_0_lifted_step_res_585332;
                                
                                if (cond_585328) {
                                    int64_t tmp_585333 = add64(tt_585324, count_585326);
                                    
                                    defunc_0_lifted_step_res_585329 = ss_585322;
                                    defunc_0_lifted_step_res_585330 = tmp_585333;
                                    defunc_0_lifted_step_res_585331 = tt_585325;
                                    defunc_0_lifted_step_res_585332 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585334 = sub64(tt_585325, tt_585324);
                                    bool cond_585335 = sle64(zlze_lhs_585334, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585336;
                                    int64_t defunc_0_lifted_step_res_f_res_585337;
                                    int64_t defunc_0_lifted_step_res_f_res_585338;
                                    int64_t defunc_0_lifted_step_res_f_res_585339;
                                    
                                    if (cond_585335) {
                                        int64_t tmp_585340 = add64(ss_585322, count_585326);
                                        
                                        defunc_0_lifted_step_res_f_res_585336 = tmp_585340;
                                        defunc_0_lifted_step_res_f_res_585337 = tt_585324;
                                        defunc_0_lifted_step_res_f_res_585338 = tt_585325;
                                        defunc_0_lifted_step_res_f_res_585339 = (int64_t) 0;
                                    } else {
                                        bool cond_585341 = count_585326 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585342;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585343;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585344;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585345;
                                        
                                        if (cond_585341) {
                                            bool x_585346 = sle64((int64_t) 0, ss_585322);
                                            bool y_585347 = slt64(ss_585322, stride_585144);
                                            bool bounds_check_585348 = x_585346 && y_585347;
                                            bool index_certs_585349;
                                            
                                            if (!bounds_check_585348) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585322, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:818:33-56\n   #12 ftSkyline.fut:807:17-818:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585352 = sle64((int64_t) 0, tt_585324);
                                            bool y_585353 = slt64(tt_585324, j_m_i_585166);
                                            bool bounds_check_585354 = x_585352 && y_585353;
                                            bool index_certs_585355;
                                            
                                            if (!bounds_check_585354) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585324, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:818:33-56\n   #12 ftSkyline.fut:807:17-818:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585350 = start_585217 + ss_585322;
                                            int64_t leq_arg1_585351 = ((int64_t *) mem_param_587232.mem)[slice_585350];
                                            int64_t slice_585356 = stride_585144 + tt_585324;
                                            int64_t slice_585357 = start_585217 + slice_585356;
                                            int64_t leq_arg0_585358 = ((int64_t *) mem_param_587232.mem)[slice_585357];
                                            bool lifted_lambda_res_585359 = sle64(leq_arg0_585358, leq_arg1_585351);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585360;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585361;
                                            
                                            if (lifted_lambda_res_585359) {
                                                int64_t tmp_585362 = add64((int64_t) 1, tt_585324);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585360 = ss_585322;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585361 = tmp_585362;
                                            } else {
                                                int64_t tmp_585363 = add64((int64_t) 1, ss_585322);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585360 = tmp_585363;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585361 = tt_585324;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585342 = defunc_0_lifted_step_res_f_res_f_res_t_res_585360;
                                            defunc_0_lifted_step_res_f_res_f_res_585343 = defunc_0_lifted_step_res_f_res_f_res_t_res_585361;
                                            defunc_0_lifted_step_res_f_res_f_res_585344 = tt_585325;
                                            defunc_0_lifted_step_res_f_res_f_res_585345 = (int64_t) 0;
                                        } else {
                                            int64_t m_585364 = sdiv64(count_585326, (int64_t) 2);
                                            int64_t n_585365 = sub64(count_585326, m_585364);
                                            bool cond_585366 = n_585365 == (int64_t) 0;
                                            int64_t zgze_lhs_585367 = add64(ss_585322, m_585364);
                                            bool cond_f_res_585368 = sle64(ss_585323, zgze_lhs_585367);
                                            bool x_585369 = !cond_585366;
                                            bool y_585370 = cond_f_res_585368 && x_585369;
                                            bool cond_585371 = cond_585366 || y_585370;
                                            bool leq_y_x_585372;
                                            
                                            if (cond_585371) {
                                                leq_y_x_585372 = 1;
                                            } else {
                                                bool x_585373 = sle64((int64_t) 0, zgze_lhs_585367);
                                                bool y_585374 = slt64(zgze_lhs_585367, stride_585144);
                                                bool bounds_check_585375 = x_585373 && y_585374;
                                                bool index_certs_585376;
                                                
                                                if (!bounds_check_585375) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585367, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:818:33-56\n   #12 ftSkyline.fut:807:17-818:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585379 = add64(tt_585324, n_585365);
                                                int64_t leq_arg0_585380 = sub64(zm_lhs_585379, (int64_t) 1);
                                                bool x_585381 = sle64((int64_t) 0, leq_arg0_585380);
                                                bool y_585382 = slt64(leq_arg0_585380, j_m_i_585166);
                                                bool bounds_check_585383 = x_585381 && y_585382;
                                                bool index_certs_585384;
                                                
                                                if (!bounds_check_585383) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585380, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:818:33-56\n   #12 ftSkyline.fut:807:17-818:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585377 = start_585217 + zgze_lhs_585367;
                                                int64_t leq_arg1_585378 = ((int64_t *) mem_param_587232.mem)[slice_585377];
                                                int64_t slice_585385 = stride_585144 + leq_arg0_585380;
                                                int64_t slice_585386 = start_585217 + slice_585385;
                                                int64_t leq_arg0_585387 = ((int64_t *) mem_param_587232.mem)[slice_585386];
                                                bool lifted_lambda_res_585388 = sle64(leq_arg0_585387, leq_arg1_585378);
                                                
                                                leq_y_x_585372 = lifted_lambda_res_585388;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585389;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585390;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585391;
                                            
                                            if (leq_y_x_585372) {
                                                int64_t tmp_585392 = add64(tt_585324, n_585365);
                                                int64_t tmp_585393 = sub64(count_585326, n_585365);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585389 = tmp_585392;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585390 = tt_585325;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585391 = tmp_585393;
                                            } else {
                                                int64_t tmp_585394 = add64(tt_585324, n_585365);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585389 = tt_585324;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585390 = tmp_585394;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585391 = count_585326;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585342 = ss_585322;
                                            defunc_0_lifted_step_res_f_res_f_res_585343 = defunc_0_lifted_step_res_f_res_f_res_f_res_585389;
                                            defunc_0_lifted_step_res_f_res_f_res_585344 = defunc_0_lifted_step_res_f_res_f_res_f_res_585390;
                                            defunc_0_lifted_step_res_f_res_f_res_585345 = defunc_0_lifted_step_res_f_res_f_res_f_res_585391;
                                        }
                                        defunc_0_lifted_step_res_f_res_585336 = defunc_0_lifted_step_res_f_res_f_res_585342;
                                        defunc_0_lifted_step_res_f_res_585337 = defunc_0_lifted_step_res_f_res_f_res_585343;
                                        defunc_0_lifted_step_res_f_res_585338 = defunc_0_lifted_step_res_f_res_f_res_585344;
                                        defunc_0_lifted_step_res_f_res_585339 = defunc_0_lifted_step_res_f_res_f_res_585345;
                                    }
                                    defunc_0_lifted_step_res_585329 = defunc_0_lifted_step_res_f_res_585336;
                                    defunc_0_lifted_step_res_585330 = defunc_0_lifted_step_res_f_res_585337;
                                    defunc_0_lifted_step_res_585331 = defunc_0_lifted_step_res_f_res_585338;
                                    defunc_0_lifted_step_res_585332 = defunc_0_lifted_step_res_f_res_585339;
                                }
                                
                                int64_t loopres_585395;
                                int64_t loopres_585396;
                                int64_t loopres_585397;
                                int64_t loopres_585398;
                                int64_t loopres_585399;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585395, &loopres_585396, &loopres_585397, &loopres_585398, &loopres_585399, defunc_0_lifted_step_res_585329, ss_585323, defunc_0_lifted_step_res_585330, defunc_0_lifted_step_res_585331, defunc_0_lifted_step_res_585332) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585400 = slt64((int64_t) 0, loopres_585399);
                                bool loop_while_tmp_588085 = loop_cond_585400;
                                int64_t ss_tmp_588086 = loopres_585395;
                                int64_t ss_tmp_588087 = loopres_585396;
                                int64_t tt_tmp_588088 = loopres_585397;
                                int64_t tt_tmp_588089 = loopres_585398;
                                int64_t count_tmp_588090 = loopres_585399;
                                
                                loop_while_585321 = loop_while_tmp_588085;
                                ss_585322 = ss_tmp_588086;
                                ss_585323 = ss_tmp_588087;
                                tt_585324 = tt_tmp_588088;
                                tt_585325 = tt_tmp_588089;
                                count_585326 = count_tmp_588090;
                            }
                            defunc_0_split_count_res_585315 = loop_while_585321;
                            defunc_0_split_count_res_585316 = ss_585322;
                            defunc_0_split_count_res_585317 = ss_585323;
                            defunc_0_split_count_res_585318 = tt_585324;
                            defunc_0_split_count_res_585319 = tt_585325;
                            defunc_0_split_count_res_585320 = count_585326;
                            ((int64_t *) mem_587265)[i_586137] = defunc_0_split_count_res_585316;
                            ((int64_t *) mem_587267)[i_586137] = defunc_0_split_count_res_585318;
                        }
                        if (mem_587282_cached_sizze_588882 < bytes_587281) {
                            err = lexical_realloc(ctx, &mem_587282, &mem_587282_cached_sizze_588882, bytes_587281);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587286_cached_sizze_588883 < bytes_587285) {
                            err = lexical_realloc(ctx, &mem_587286, &mem_587286_cached_sizze_588883, bytes_587285);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587289_cached_sizze_588884 < bytes_587281) {
                            err = lexical_realloc(ctx, &mem_587289, &mem_587289_cached_sizze_588884, bytes_587281);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586146 = 0; i_586146 < num_blocks_585164; i_586146++) {
                            bool y_585409 = slt64(i_586146, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165);
                            bool index_certs_585411;
                            
                            if (!y_585409) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586146, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585412 = ((int64_t *) mem_587265)[i_586146];
                            int64_t defunc_0_f_res_585413 = ((int64_t *) mem_587267)[i_586146];
                            int64_t tmp_585414 = add64((int64_t) 1, i_586146);
                            bool x_585415 = sle64((int64_t) 0, tmp_585414);
                            bool y_585416 = slt64(tmp_585414, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165);
                            bool bounds_check_585417 = x_585415 && y_585416;
                            bool index_certs_585418;
                            
                            if (!bounds_check_585417) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585414, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585419 = ((int64_t *) mem_587265)[tmp_585414];
                            int64_t defunc_0_f_res_585420 = ((int64_t *) mem_587267)[tmp_585414];
                            int64_t merge_sequential_arg2_585421 = add64(stride_585144, defunc_0_f_res_585413);
                            int64_t merge_sequential_arg2_585422 = add64(stride_585144, defunc_0_f_res_585420);
                            int64_t j_m_i_585423 = sub64(merge_sequential_arg2_585422, merge_sequential_arg2_585421);
                            bool empty_slice_585424 = j_m_i_585423 == (int64_t) 0;
                            int64_t m_585425 = sub64(j_m_i_585423, (int64_t) 1);
                            int64_t i_p_m_t_s_585426 = add64(merge_sequential_arg2_585421, m_585425);
                            bool zzero_leq_i_p_m_t_s_585427 = sle64((int64_t) 0, i_p_m_t_s_585426);
                            bool i_p_m_t_s_leq_w_585428 = slt64(i_p_m_t_s_585426, next_stride_585145);
                            bool zzero_lte_i_585429 = sle64((int64_t) 0, merge_sequential_arg2_585421);
                            bool i_lte_j_585430 = sle64(merge_sequential_arg2_585421, merge_sequential_arg2_585422);
                            bool y_585431 = i_p_m_t_s_leq_w_585428 && zzero_lte_i_585429;
                            bool y_585432 = zzero_leq_i_p_m_t_s_585427 && y_585431;
                            bool forwards_ok_585433 = i_lte_j_585430 && y_585432;
                            bool ok_or_empty_585434 = empty_slice_585424 || forwards_ok_585433;
                            bool index_certs_585435;
                            
                            if (!ok_or_empty_585434) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585421, ":", (long long) merge_sequential_arg2_585422, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585436 = sub64(defunc_0_f_res_585419, defunc_0_f_res_585412);
                            bool empty_slice_585437 = j_m_i_585436 == (int64_t) 0;
                            int64_t m_585438 = sub64(j_m_i_585436, (int64_t) 1);
                            int64_t i_p_m_t_s_585439 = add64(defunc_0_f_res_585412, m_585438);
                            bool zzero_leq_i_p_m_t_s_585440 = sle64((int64_t) 0, i_p_m_t_s_585439);
                            bool i_p_m_t_s_leq_w_585441 = slt64(i_p_m_t_s_585439, next_stride_585145);
                            bool zzero_lte_i_585442 = sle64((int64_t) 0, defunc_0_f_res_585412);
                            bool i_lte_j_585443 = sle64(defunc_0_f_res_585412, defunc_0_f_res_585419);
                            bool y_585444 = i_p_m_t_s_leq_w_585441 && zzero_lte_i_585442;
                            bool y_585445 = zzero_leq_i_p_m_t_s_585440 && y_585444;
                            bool forwards_ok_585446 = i_lte_j_585443 && y_585445;
                            bool ok_or_empty_585447 = empty_slice_585437 || forwards_ok_585446;
                            bool index_certs_585448;
                            
                            if (!ok_or_empty_585447) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585412, ":", (long long) defunc_0_f_res_585419, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585449 = slt64((int64_t) 0, j_m_i_585436);
                            bool y_585458 = slt64((int64_t) 0, j_m_i_585423);
                            bool protect_assert_disj_587711 = cond_585449 || y_585458;
                            bool index_certs_585459;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585460 = start_585217 + merge_sequential_arg2_585421;
                            int64_t binop_y_587304 = dim_293582 * slice_585460;
                            int64_t slice_585454 = start_585217 + defunc_0_f_res_585412;
                            int64_t binop_y_587306 = dim_293582 * slice_585454;
                            int64_t ext_587308;
                            
                            if (cond_585449) {
                                ext_587308 = binop_y_587306;
                            } else {
                                ext_587308 = binop_y_587304;
                            }
                            
                            int64_t dummy_585450;
                            int64_t dummy_585452;
                            
                            if (cond_585449) {
                                int64_t head_res_585455 = ((int64_t *) mem_param_587232.mem)[slice_585454];
                                int64_t head_res_585457 = ((int64_t *) mem_param_587239.mem)[slice_585454];
                                
                                dummy_585450 = head_res_585455;
                                dummy_585452 = head_res_585457;
                            } else {
                                int64_t head_res_585461 = ((int64_t *) mem_param_587232.mem)[slice_585460];
                                int64_t head_res_585463 = ((int64_t *) mem_param_587239.mem)[slice_585460];
                                
                                dummy_585450 = head_res_585461;
                                dummy_585452 = head_res_585463;
                            }
                            for (int64_t nest_i_588094 = 0; nest_i_588094 < merge_block_sizze_580429; nest_i_588094++) {
                                ((int64_t *) mem_587282)[i_586146 * merge_block_sizze_580429 + nest_i_588094] = dummy_585450;
                            }
                            for (int64_t nest_i_588095 = 0; nest_i_588095 < merge_block_sizze_580429; nest_i_588095++) {
                                ((int64_t *) mem_587289)[i_586146 * merge_block_sizze_580429 + nest_i_588095] = dummy_585452;
                            }
                            for (int64_t nest_i_588096 = 0; nest_i_588096 < merge_block_sizze_580429; nest_i_588096++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587286, i_586146 * lmad_arg_587303 + nest_i_588096 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587236.mem, ext_587308, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            }
                            
                            int64_t data_585467;
                            int64_t i_585472 = (int64_t) 0;
                            
                            for (int64_t k_585471 = 0; k_585471 < merge_block_sizze_580429; k_585471++) {
                                int64_t j_585476 = sub64(k_585471, i_585472);
                                bool cond_585477 = j_585476 == j_m_i_585423;
                                bool x_587801 = !cond_585477;
                                bool cond_585479 = slt64(i_585472, j_m_i_585436);
                                bool x_585481 = sle64((int64_t) 0, j_585476);
                                bool y_585482 = slt64(j_585476, j_m_i_585423);
                                bool bounds_check_585483 = x_585481 && y_585482;
                                bool loop_not_taken_587793 = !cond_585479;
                                bool protect_assert_disj_587794 = bounds_check_585483 || loop_not_taken_587793;
                                bool protect_assert_disj_587804 = cond_585477 || protect_assert_disj_587794;
                                bool index_certs_585484;
                                
                                if (!protect_assert_disj_587804) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585476, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585485 = merge_sequential_arg2_585421 + j_585476;
                                int64_t slice_585486 = start_585217 + slice_585485;
                                bool protect_cond_conj_587805 = cond_585479 && x_587801;
                                int64_t leq_arg1_585487;
                                
                                if (protect_cond_conj_587805) {
                                    int64_t x_587795 = ((int64_t *) mem_param_587232.mem)[slice_585486];
                                    
                                    leq_arg1_585487 = x_587795;
                                } else {
                                    leq_arg1_585487 = (int64_t) 0;
                                }
                                
                                bool x_585488 = sle64((int64_t) 0, i_585472);
                                bool bounds_check_585489 = cond_585479 && x_585488;
                                bool protect_assert_disj_587798 = bounds_check_585489 || loop_not_taken_587793;
                                bool protect_assert_disj_587807 = cond_585477 || protect_assert_disj_587798;
                                bool index_certs_585490;
                                
                                if (!protect_assert_disj_587807) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585472, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585491 = defunc_0_f_res_585412 + i_585472;
                                int64_t slice_585492 = start_585217 + slice_585491;
                                int64_t leq_arg0_585493;
                                
                                if (protect_cond_conj_587805) {
                                    int64_t x_587799 = ((int64_t *) mem_param_587232.mem)[slice_585492];
                                    
                                    leq_arg0_585493 = x_587799;
                                } else {
                                    leq_arg0_585493 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585494 = sle64(leq_arg0_585493, leq_arg1_585487);
                                bool x_587866 = cond_585479 && lifted_lambda_res_585494;
                                bool cond_585478 = cond_585477 || x_587866;
                                bool protect_assert_disj_587703 = cond_585478 || bounds_check_585483;
                                bool index_certs_585512;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585476, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585502 = cond_585479 && x_585488;
                                bool loop_not_taken_587698 = !cond_585478;
                                bool protect_assert_disj_587699 = bounds_check_585502 || loop_not_taken_587698;
                                bool index_certs_585503;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585472, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585514 = start_585217 + slice_585485;
                                int64_t binop_y_587326 = dim_293582 * slice_585514;
                                int64_t slice_585505 = start_585217 + slice_585491;
                                int64_t binop_y_587328 = dim_293582 * slice_585505;
                                int64_t ext_587330;
                                
                                if (cond_585478) {
                                    ext_587330 = binop_y_587328;
                                } else {
                                    ext_587330 = binop_y_587326;
                                }
                                
                                int64_t loopres_585495;
                                int64_t loopres_585496;
                                int64_t loopres_585498;
                                
                                if (cond_585478) {
                                    int64_t tmp_585499 = add64((int64_t) 1, i_585472);
                                    int64_t tmp_585506 = ((int64_t *) mem_param_587232.mem)[slice_585505];
                                    int64_t tmp_585508 = ((int64_t *) mem_param_587239.mem)[slice_585505];
                                    
                                    loopres_585495 = tmp_585499;
                                    loopres_585496 = tmp_585506;
                                    loopres_585498 = tmp_585508;
                                } else {
                                    int64_t tmp_585515 = ((int64_t *) mem_param_587232.mem)[slice_585514];
                                    int64_t tmp_585517 = ((int64_t *) mem_param_587239.mem)[slice_585514];
                                    
                                    loopres_585495 = i_585472;
                                    loopres_585496 = tmp_585515;
                                    loopres_585498 = tmp_585517;
                                }
                                ((int64_t *) mem_587282)[i_586146 * merge_block_sizze_580429 + k_585471] = loopres_585496;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587286, i_586146 * lmad_arg_587303 + k_585471 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587236.mem, ext_587330, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                                ((int64_t *) mem_587289)[i_586146 * merge_block_sizze_580429 + k_585471] = loopres_585498;
                                
                                int64_t i_tmp_588097 = loopres_585495;
                                
                                i_585472 = i_tmp_588097;
                            }
                            data_585467 = i_585472;
                        }
                        if (memblock_alloc(ctx, &mem_587356, bytes_587281, "mem_587356")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587356.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (uint64_t *) mem_587282, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429});
                        if (memblock_alloc(ctx, &mem_587361, bytes_587285, "mem_587361")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_587361.mem, (int64_t) 0, (int64_t []) {dim_293582 * merge_block_sizze_580429, dim_293582, (int64_t) 1}, (uint64_t *) mem_587286, (int64_t) 0, (int64_t []) {lmad_arg_587303, dim_293582, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429, dim_293582});
                        if (memblock_alloc(ctx, &mem_587365, bytes_587281, "mem_587365")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587365.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (uint64_t *) mem_587289, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429});
                        if (memblock_set(ctx, &ext_mem_587413, &mem_587356, "mem_587356") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587410, &mem_587361, "mem_587361") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587406, &mem_587365, "mem_587365") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587242, i_586156 * next_stride_585145, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587413.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585145});
                    if (memblock_unref(ctx, &ext_mem_587413, "ext_mem_587413") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587246, i_586156 * lmad_arg_587263, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) ext_mem_587410.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {next_stride_585145, dim_293582});
                    if (memblock_unref(ctx, &ext_mem_587410, "ext_mem_587410") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587249, i_586156 * next_stride_585145, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587406.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585145});
                    if (memblock_unref(ctx, &ext_mem_587406, "ext_mem_587406") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585539 = next_stride_585145 * num_merges_585149;
                
                if (memblock_alloc(ctx, &mem_587429, bytes_587241, "mem_587429")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587429.mem, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (uint64_t *) mem_587242, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145});
                if (memblock_alloc(ctx, &mem_587434, bytes_587245, "mem_587434")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_587434.mem, (int64_t) 0, (int64_t []) {dim_293582 * next_stride_585145, dim_293582, (int64_t) 1}, (uint64_t *) mem_587246, (int64_t) 0, (int64_t []) {lmad_arg_587263, dim_293582, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145, dim_293582});
                if (memblock_alloc(ctx, &mem_587438, bytes_587241, "mem_587438")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587438.mem, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (uint64_t *) mem_587249, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145});
                
                bool loop_cond_585543 = slt64(next_stride_585145, flat_dim_580424);
                
                if (memblock_set(ctx, &mem_param_tmp_588064, &mem_587429, "mem_587429") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588065, &mem_587434, "mem_587434") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588066, &mem_587438, "mem_587438") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588067 = flat_dim_585539;
                bool loop_while_tmp_588068 = loop_cond_585543;
                int64_t stride_tmp_588072 = next_stride_585145;
                
                if (memblock_set(ctx, &mem_param_587232, &mem_param_tmp_588064, "mem_param_tmp_588064") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587236, &mem_param_tmp_588065, "mem_param_tmp_588065") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587239, &mem_param_tmp_588066, "mem_param_tmp_588066") != 0)
                    return 1;
                loop_dz2084Uz2082U_585139 = loop_dz2084Uz2082U_tmp_588067;
                loop_while_585140 = loop_while_tmp_588068;
                stride_585144 = stride_tmp_588072;
            }
            if (memblock_set(ctx, &ext_mem_587449, &mem_param_587232, "mem_param_587232") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587448, &mem_param_587236, "mem_param_587236") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587447, &mem_param_587239, "mem_param_587239") != 0)
                return 1;
            data_585133 = loop_dz2084Uz2082U_585139;
            data_585134 = loop_while_585140;
            data_585138 = stride_585144;
            if (memblock_unref(ctx, &mem_587219, "mem_587219") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587224, "mem_587224") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587228, "mem_587228") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585544 = slt64(m_580257, data_585133);
            bool y_585545 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_585544;
            bool ok_or_empty_585546 = empty_slice_580256 || y_585545;
            bool index_certs_585547;
            
            if (!ok_or_empty_585546) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580247, "] out of bounds for array of shape [", (long long) data_585133, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587456, &ext_mem_587448, "ext_mem_587448") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587452, &ext_mem_587447, "ext_mem_587447") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587458, bytes_586456, "mem_587458")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587458.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587452.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580247});
        if (memblock_unref(ctx, &ext_mem_587452, "ext_mem_587452") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587461, bytes_586465, "mem_587461")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587461.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) ext_mem_587456.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {m_580247, dim_293582});
        if (memblock_unref(ctx, &ext_mem_587456, "ext_mem_587456") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587463, &mem_587461, "mem_587461") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587462, &mem_587458, "mem_587458") != 0)
            return 1;
    } else {
        if (mem_586484_cached_sizze_588833 < bytes_586483) {
            err = lexical_realloc(ctx, &mem_586484, &mem_586484_cached_sizze_588833, bytes_586483);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586162 = 0; i_586162 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584; i_586162++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581064 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586162];
            double i64_res_581065 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581064);
            double defunc_0_fover_res_581066 = 1.5707963267948966 / i64_res_581065;
            
            ((double *) mem_586484)[i_586162] = defunc_0_fover_res_581066;
        }
        if (mem_586492_cached_sizze_588834 < bytes_586456) {
            err = lexical_realloc(ctx, &mem_586492, &mem_586492_cached_sizze_588834, bytes_586456);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586494_cached_sizze_588835 < bytes_586456) {
            err = lexical_realloc(ctx, &mem_586494, &mem_586494_cached_sizze_588835, bytes_586456);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586502_cached_sizze_588836 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586502, &mem_586502_cached_sizze_588836, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586510_cached_sizze_588837 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_588837, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586512_cached_sizze_588838 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586512, &mem_586512_cached_sizze_588838, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586526_cached_sizze_588839 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_586526, &mem_586526_cached_sizze_588839, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586542_cached_sizze_588841 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_586542, &mem_586542_cached_sizze_588841, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586187 = 0; i_586187 < m_580247; i_586187++) {
            for (int64_t i_586166 = 0; i_586166 < dim_293582; i_586166++) {
                double eta_p_583913 = ((double *) mem_586466.mem)[i_586187 * dim_293582 + i_586166];
                double eta_p_583914 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586166];
                double eta_p_583915 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586166];
                int64_t eta_p_583917 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586166];
                double defunc_0_f_res_583918 = eta_p_583913 - eta_p_583914;
                double defunc_0_f_res_583920 = defunc_0_f_res_583918 / eta_p_583915;
                int64_t f64_res_583922 = fptosi_f64_i64(defunc_0_f_res_583920);
                int64_t max_res_583924 = smax64((int64_t) 0, f64_res_583922);
                int64_t zm_lhs_583930 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586166];
                int64_t min_arg1_583931 = sub64(zm_lhs_583930, (int64_t) 1);
                int64_t min_res_583932 = smin64(max_res_583924, min_arg1_583931);
                int64_t defunc_0_f_res_583934 = mul64(eta_p_583917, min_res_583932);
                
                ((int64_t *) mem_586502)[i_586166] = defunc_0_f_res_583934;
            }
            
            int64_t defunc_0_foldl_res_581000;
            int64_t acc_581002 = (int64_t) 0;
            
            for (int64_t i_581001 = 0; i_581001 < dim_293582; i_581001++) {
                int64_t b_581003 = ((int64_t *) mem_586502)[i_581001];
                int64_t defunc_0_f_res_581004 = add64(acc_581002, b_581003);
                int64_t acc_tmp_588105 = defunc_0_f_res_581004;
                
                acc_581002 = acc_tmp_588105;
            }
            defunc_0_foldl_res_581000 = acc_581002;
            
            bool x_581005 = sle64((int64_t) 0, defunc_0_foldl_res_581000);
            bool y_581006 = slt64(defunc_0_foldl_res_581000, dz2080U_293583);
            bool bounds_check_581007 = x_581005 && y_581006;
            bool index_certs_581008;
            
            if (!bounds_check_581007) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_581000, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586172 = 0; i_586172 < dim_293582; i_586172++) {
                double eta_p_583842 = ((double *) mem_586466.mem)[i_586187 * dim_293582 + i_586172];
                double eta_p_583843 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_581000 * dim_293582 + i_586172];
                double defunc_0_f_res_583844 = eta_p_583842 - eta_p_583843;
                double defunc_0_ftimes_res_583846 = defunc_0_f_res_583844 * defunc_0_f_res_583844;
                
                ((double *) mem_586510)[i_586172] = defunc_0_ftimes_res_583846;
                ((double *) mem_586512)[i_586172] = defunc_0_f_res_583844;
            }
            
            double defunc_0_foldl_res_581018;
            double acc_581020 = 0.0;
            
            for (int64_t i_581019 = 0; i_581019 < dim_293582; i_581019++) {
                double b_581021 = ((double *) mem_586510)[i_581019];
                double defunc_0_f_res_581022 = acc_581020 + b_581021;
                double acc_tmp_588108 = defunc_0_f_res_581022;
                
                acc_581020 = acc_tmp_588108;
            }
            defunc_0_foldl_res_581018 = acc_581020;
            
            double sqrt_res_581023 = futrts_sqrt64(defunc_0_foldl_res_581018);
            
            for (int64_t nest_i_588109 = 0; nest_i_588109 < arg_580153; nest_i_588109++) {
                ((double *) mem_586526)[nest_i_588109] = 0.0;
            }
            for (int64_t i_581026 = 0; i_581026 < arg_580153; i_581026++) {
                bool y_581028 = slt64(i_581026, dim_293582);
                bool index_certs_581029;
                
                if (!y_581028) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581026, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_581031 = add64((int64_t) 1, i_581026);
                int64_t j_m_i_581032 = sub64(dim_293582, map_arg1_581031);
                bool empty_slice_581033 = j_m_i_581032 == (int64_t) 0;
                int64_t m_581034 = sub64(j_m_i_581032, (int64_t) 1);
                int64_t i_p_m_t_s_581035 = add64(map_arg1_581031, m_581034);
                bool zzero_leq_i_p_m_t_s_581036 = sle64((int64_t) 0, i_p_m_t_s_581035);
                bool i_p_m_t_s_leq_w_581037 = slt64(i_p_m_t_s_581035, dim_293582);
                bool zzero_lte_i_581038 = sle64((int64_t) 0, map_arg1_581031);
                bool i_lte_j_581039 = sle64(map_arg1_581031, dim_293582);
                bool y_581040 = i_p_m_t_s_leq_w_581037 && zzero_lte_i_581038;
                bool y_581041 = zzero_leq_i_p_m_t_s_581036 && y_581040;
                bool forwards_ok_581042 = i_lte_j_581039 && y_581041;
                bool ok_or_empty_581043 = empty_slice_581033 || forwards_ok_581042;
                bool index_certs_581044;
                
                if (!ok_or_empty_581043) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_581031, ":", (long long) dim_293582, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586530 = (int64_t) 8 * j_m_i_581032;
                double this_x_581030 = ((double *) mem_586512)[i_581026];
                
                if (mem_586531_cached_sizze_588840 < bytes_586530) {
                    err = lexical_realloc(ctx, &mem_586531, &mem_586531_cached_sizze_588840, bytes_586530);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586177 = 0; i_586177 < j_m_i_581032; i_586177++) {
                    int64_t slice_586398 = map_arg1_581031 + i_586177;
                    double eta_p_581047 = ((double *) mem_586512)[slice_586398];
                    double defunc_0_ftimes_res_581048 = eta_p_581047 * eta_p_581047;
                    
                    ((double *) mem_586531)[i_586177] = defunc_0_ftimes_res_581048;
                }
                
                double defunc_0_foldl_res_581049;
                double acc_581051 = 0.0;
                
                for (int64_t i_581050 = 0; i_581050 < j_m_i_581032; i_581050++) {
                    double b_581052 = ((double *) mem_586531)[i_581050];
                    double defunc_0_f_res_581053 = acc_581051 + b_581052;
                    double acc_tmp_588112 = defunc_0_f_res_581053;
                    
                    acc_581051 = acc_tmp_588112;
                }
                defunc_0_foldl_res_581049 = acc_581051;
                
                double sqrt_res_581054 = futrts_sqrt64(defunc_0_foldl_res_581049);
                double atan2_res_581055 = futrts_atan2_64(sqrt_res_581054, this_x_581030);
                
                ((double *) mem_586526)[i_581026] = atan2_res_581055;
            }
            for (int64_t i_586181 = 0; i_586181 < arg_580153; i_586181++) {
                double eta_p_581073 = ((double *) mem_586526)[i_586181];
                double eta_p_581074 = ((double *) mem_586484)[i_586181];
                int64_t eta_p_581075 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586181];
                int64_t eta_p_581076 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586181];
                double i64_res_581077 = sitofp_i64_f64(eta_p_581075);
                double defunc_0_fover_res_581078 = eta_p_581073 / eta_p_581074;
                double defunc_0_ftimes_res_581079 = i64_res_581077 * defunc_0_fover_res_581078;
                int64_t f64_res_581080 = fptosi_f64_i64(defunc_0_ftimes_res_581079);
                bool cond_581081 = slt64(f64_res_581080, (int64_t) 0);
                int64_t defunc_0_f_res_581082;
                
                if (cond_581081) {
                    defunc_0_f_res_581082 = (int64_t) 0;
                } else {
                    bool cond_581083 = sle64(eta_p_581076, f64_res_581080);
                    int64_t defunc_0_f_res_f_res_581084;
                    
                    if (cond_581083) {
                        int64_t defunc_0_f_res_f_res_t_res_585554 = sub64(eta_p_581076, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_581084 = defunc_0_f_res_f_res_t_res_585554;
                    } else {
                        defunc_0_f_res_f_res_581084 = f64_res_581080;
                    }
                    defunc_0_f_res_581082 = defunc_0_f_res_f_res_581084;
                }
                ((int64_t *) mem_586542)[i_586181] = defunc_0_f_res_581082;
            }
            
            int64_t defunc_0_foldl_res_581086;
            int64_t acc_581088 = (int64_t) 0;
            
            for (int64_t i_581087 = 0; i_581087 < arg_580153; i_581087++) {
                int64_t b_581089 = ((int64_t *) mem_586542)[i_581087];
                int64_t defunc_0_f_res_581090 = add64(acc_581088, b_581089);
                int64_t acc_tmp_588114 = defunc_0_f_res_581090;
                
                acc_581088 = acc_tmp_588114;
            }
            defunc_0_foldl_res_581086 = acc_581088;
            
            int64_t zp_lhs_581091 = mul64(total_angle_no_293592, defunc_0_foldl_res_581000);
            int64_t get_id_from_grid_angle_res_581092 = add64(defunc_0_foldl_res_581086, zp_lhs_581091);
            
            ((int64_t *) mem_586492)[i_586187] = get_id_from_grid_angle_res_581092;
            ((double *) mem_586494)[i_586187] = sqrt_res_581023;
        }
        
        int64_t reduce_arg1_581120;
        
        if (x_581100) {
            int64_t x_585560 = ((int64_t *) mem_586492)[(int64_t) 0];
            
            reduce_arg1_581120 = x_585560;
        } else {
            reduce_arg1_581120 = (int64_t) 0;
        }
        
        double reduce_arg1_581122;
        
        if (x_581100) {
            double x_585561 = ((double *) mem_586494)[(int64_t) 0];
            
            reduce_arg1_581122 = x_585561;
        } else {
            reduce_arg1_581122 = 0.0;
        }
        if (cond_581099) {
            if (memblock_set(ctx, &ext_mem_587021, &mem_586466, "mem_586466") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587017, &mem_586468, "mem_586468") != 0)
                return 1;
        } else {
            int64_t ext_586564;
            int64_t defunc_0_reduce_res_585786;
            double defunc_0_reduce_res_585787;
            int64_t defunc_0_reduce_res_585789;
            int64_t redout_586190;
            double redout_586191;
            int64_t redout_586193;
            int64_t ctx_param_ext_586555;
            
            if (memblock_set(ctx, &mem_param_586557, &mem_586466, "mem_586466") != 0)
                return 1;
            ctx_param_ext_586555 = (int64_t) 0;
            redout_586190 = reduce_arg1_581120;
            redout_586191 = reduce_arg1_581122;
            redout_586193 = reduce_arg1_581124;
            for (int64_t i_586194 = 0; i_586194 < m_580247; i_586194++) {
                int64_t x_581138 = ((int64_t *) mem_586492)[i_586194];
                double x_581139 = ((double *) mem_586494)[i_586194];
                int64_t x_581141 = ((int64_t *) mem_586468.mem)[i_586194];
                bool cond_581150 = slt64(redout_586190, x_581138);
                bool cond_581151 = redout_586190 == x_581138;
                bool zlze_res_581152 = redout_586191 <= x_581139;
                bool x_581153 = cond_581151 && zlze_res_581152;
                bool x_581154 = !cond_581150;
                bool y_581155 = x_581153 && x_581154;
                bool defunc_0_leq_res_581156 = cond_581150 || y_581155;
                int64_t defunc_0_op_res_581157;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581157 = x_581138;
                } else {
                    defunc_0_op_res_581157 = redout_586190;
                }
                
                double defunc_0_op_res_581158;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581158 = x_581139;
                } else {
                    defunc_0_op_res_581158 = redout_586191;
                }
                
                int64_t defunc_0_op_res_581159;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581159 = x_581141;
                } else {
                    defunc_0_op_res_581159 = redout_586193;
                }
                
                int64_t binop_y_586558 = dim_293582 * i_586194;
                int64_t ext_586561;
                
                if (defunc_0_leq_res_581156) {
                    ext_586561 = binop_y_586558;
                } else {
                    ext_586561 = ctx_param_ext_586555;
                }
                if (defunc_0_leq_res_581156) {
                    if (memblock_set(ctx, &ext_mem_586562, &mem_586466, "mem_586466") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586562, &mem_param_586557, "mem_param_586557") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588115, &ext_mem_586562, "ext_mem_586562") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588116 = ext_586561;
                int64_t redout_tmp_588117 = defunc_0_op_res_581157;
                double redout_tmp_588118 = defunc_0_op_res_581158;
                int64_t redout_tmp_588120 = defunc_0_op_res_581159;
                
                if (memblock_set(ctx, &mem_param_586557, &mem_param_tmp_588115, "mem_param_tmp_588115") != 0)
                    return 1;
                ctx_param_ext_586555 = ctx_param_ext_tmp_588116;
                redout_586190 = redout_tmp_588117;
                redout_586191 = redout_tmp_588118;
                redout_586193 = redout_tmp_588120;
            }
            if (memblock_set(ctx, &ext_mem_586565, &mem_param_586557, "mem_param_586557") != 0)
                return 1;
            ext_586564 = ctx_param_ext_586555;
            defunc_0_reduce_res_585786 = redout_586190;
            defunc_0_reduce_res_585787 = redout_586191;
            defunc_0_reduce_res_585789 = redout_586193;
            if (mem_586568_cached_sizze_588842 < bytes_586567) {
                err = lexical_realloc(ctx, &mem_586568, &mem_586568_cached_sizze_588842, bytes_586567);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586571_cached_sizze_588843 < bytes_586567) {
                err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588843, bytes_586567);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586575_cached_sizze_588844 < bytes_586574) {
                err = lexical_realloc(ctx, &mem_586575, &mem_586575_cached_sizze_588844, bytes_586574);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586578_cached_sizze_588845 < bytes_586567) {
                err = lexical_realloc(ctx, &mem_586578, &mem_586578_cached_sizze_588845, bytes_586567);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586598_cached_sizze_588846 < bytes_586597) {
                err = lexical_realloc(ctx, &mem_586598, &mem_586598_cached_sizze_588846, bytes_586597);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586600_cached_sizze_588847 < bytes_586597) {
                err = lexical_realloc(ctx, &mem_586600, &mem_586600_cached_sizze_588847, bytes_586597);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586603_cached_sizze_588848 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588848, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586605_cached_sizze_588849 < bytes_586597) {
                err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_588849, bytes_586597);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586216 = 0; i_586216 < x_582200; i_586216++) {
                int64_t zp_lhs_581181 = mul64(block_sizze_581116, i_586216);
                
                for (int64_t i_586203 = 0; i_586203 < block_sizze_581116; i_586203++) {
                    int64_t k_581187 = add64(zp_lhs_581181, i_586203);
                    bool cond_581188 = slt64(k_581187, m_580247);
                    int64_t binop_y_586619 = dim_293582 * k_581187;
                    int64_t ext_586622;
                    
                    if (cond_581188) {
                        ext_586622 = binop_y_586619;
                    } else {
                        ext_586622 = ext_586564;
                    }
                    
                    int64_t lifted_lambda_res_581189;
                    double lifted_lambda_res_581190;
                    int64_t lifted_lambda_res_581192;
                    
                    if (cond_581188) {
                        bool x_585562 = sle64((int64_t) 0, k_581187);
                        bool bounds_check_585563 = cond_581188 && x_585562;
                        bool index_certs_585564;
                        
                        if (!bounds_check_585563) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_581187, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585565 = ((int64_t *) mem_586492)[k_581187];
                        double lifted_lambda_res_t_res_585566 = ((double *) mem_586494)[k_581187];
                        int64_t lifted_lambda_res_t_res_585568 = ((int64_t *) mem_586468.mem)[k_581187];
                        
                        if (memblock_set(ctx, &ext_mem_586623, &mem_586466, "mem_586466") != 0)
                            return 1;
                        lifted_lambda_res_581189 = lifted_lambda_res_t_res_585565;
                        lifted_lambda_res_581190 = lifted_lambda_res_t_res_585566;
                        lifted_lambda_res_581192 = lifted_lambda_res_t_res_585568;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586623, &ext_mem_586565, "ext_mem_586565") != 0)
                            return 1;
                        lifted_lambda_res_581189 = defunc_0_reduce_res_585786;
                        lifted_lambda_res_581190 = defunc_0_reduce_res_585787;
                        lifted_lambda_res_581192 = defunc_0_reduce_res_585789;
                    }
                    ((int64_t *) mem_586598)[i_586203] = lifted_lambda_res_581189;
                    ((double *) mem_586600)[i_586203] = lifted_lambda_res_581190;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586603, i_586203 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586623.mem, ext_586622, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                    if (memblock_unref(ctx, &ext_mem_586623, "ext_mem_586623") != 0)
                        return 1;
                    ((int64_t *) mem_586605)[i_586203] = lifted_lambda_res_581192;
                }
                if (!cond_581169) {
                    if (mem_586664_cached_sizze_588850 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_586664, &mem_586664_cached_sizze_588850, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586666_cached_sizze_588851 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_586666, &mem_586666_cached_sizze_588851, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_581208 = 0; i_581208 < distance_581172; i_581208++) {
                        int64_t gt_arg1_581213 = add64((int64_t) 1, i_581208);
                        bool x_581214 = sle64((int64_t) 0, gt_arg1_581213);
                        bool y_581215 = slt64(gt_arg1_581213, block_sizze_581116);
                        bool bounds_check_581216 = x_581214 && y_581215;
                        bool index_certs_581217;
                        
                        if (!bounds_check_581216) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_581213, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_581220 = slt64(i_581208, block_sizze_581116);
                        bool index_certs_581221;
                        
                        if (!y_581220) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581208, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_581218 = ((int64_t *) mem_586598)[gt_arg1_581213];
                        double gt_arg1_581219 = ((double *) mem_586600)[gt_arg1_581213];
                        int64_t gt_arg0_581222 = ((int64_t *) mem_586598)[i_581208];
                        double gt_arg0_581223 = ((double *) mem_586600)[i_581208];
                        bool cond_581224 = slt64(gt_arg0_581222, gt_arg1_581218);
                        bool cond_581225 = gt_arg0_581222 == gt_arg1_581218;
                        bool zlze_res_581226 = gt_arg0_581223 <= gt_arg1_581219;
                        bool x_581227 = cond_581225 && zlze_res_581226;
                        bool x_581228 = !cond_581224;
                        bool y_581229 = x_581227 && x_581228;
                        bool defunc_0_leq_res_581230 = cond_581224 || y_581229;
                        bool defunc_0_lifted_gt_res_581231 = !defunc_0_leq_res_581230;
                        bool s_581232;
                        int64_t s_581237;
                        bool loop_while_581238;
                        int64_t j_581243;
                        
                        loop_while_581238 = defunc_0_lifted_gt_res_581231;
                        j_581243 = i_581208;
                        while (loop_while_581238) {
                            bool x_581244 = sle64((int64_t) 0, j_581243);
                            bool y_581245 = slt64(j_581243, block_sizze_581116);
                            bool bounds_check_581246 = x_581244 && y_581245;
                            bool index_certs_581247;
                            
                            if (!bounds_check_581246) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581243, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581253 = add64((int64_t) 1, j_581243);
                            bool x_581254 = sle64((int64_t) 0, copy_arg0_581253);
                            bool y_581255 = slt64(copy_arg0_581253, block_sizze_581116);
                            bool bounds_check_581256 = x_581254 && y_581255;
                            bool index_certs_581257;
                            
                            if (!bounds_check_581256) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_581253, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581248 = ((int64_t *) mem_586598)[j_581243];
                            double copy_arg0_581249 = ((double *) mem_586600)[j_581243];
                            int64_t copy_arg0_581251 = ((int64_t *) mem_586605)[j_581243];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586664, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586603, (int64_t) 0 + j_581243 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            
                            int64_t copy_arg0_581258 = ((int64_t *) mem_586598)[copy_arg0_581253];
                            double copy_arg0_581259 = ((double *) mem_586600)[copy_arg0_581253];
                            int64_t copy_arg0_581261 = ((int64_t *) mem_586605)[copy_arg0_581253];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586603, (int64_t) 0 + copy_arg0_581253 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_586598)[j_581243] = copy_arg0_581258;
                            ((double *) mem_586600)[j_581243] = copy_arg0_581259;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586603, j_581243 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_586605)[j_581243] = copy_arg0_581261;
                            ((int64_t *) mem_586598)[copy_arg0_581253] = copy_arg0_581248;
                            ((double *) mem_586600)[copy_arg0_581253] = copy_arg0_581249;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586603, copy_arg0_581253 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586664, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_586605)[copy_arg0_581253] = copy_arg0_581251;
                            
                            int64_t tmp_581271 = sub64(j_581243, (int64_t) 1);
                            bool cond_581272 = sle64((int64_t) 0, tmp_581271);
                            bool loop_cond_581273;
                            
                            if (cond_581272) {
                                bool y_585571 = slt64(tmp_581271, block_sizze_581116);
                                bool bounds_check_585572 = cond_581272 && y_585571;
                                bool index_certs_585573;
                                
                                if (!bounds_check_585572) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581271, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585569 = ((int64_t *) mem_586598)[j_581243];
                                double gt_arg1_585570 = ((double *) mem_586600)[j_581243];
                                int64_t gt_arg0_585574 = ((int64_t *) mem_586598)[tmp_581271];
                                double gt_arg0_585575 = ((double *) mem_586600)[tmp_581271];
                                bool cond_585576 = slt64(gt_arg0_585574, gt_arg1_585569);
                                bool cond_585577 = gt_arg0_585574 == gt_arg1_585569;
                                bool zlze_res_585578 = gt_arg0_585575 <= gt_arg1_585570;
                                bool x_585579 = cond_585577 && zlze_res_585578;
                                bool x_585580 = !cond_585576;
                                bool y_585581 = x_585579 && x_585580;
                                bool defunc_0_leq_res_585582 = cond_585576 || y_585581;
                                bool defunc_0_lifted_gt_res_585583 = !defunc_0_leq_res_585582;
                                
                                loop_cond_581273 = defunc_0_lifted_gt_res_585583;
                            } else {
                                loop_cond_581273 = 0;
                            }
                            
                            bool loop_while_tmp_588133 = loop_cond_581273;
                            int64_t j_tmp_588138 = tmp_581271;
                            
                            loop_while_581238 = loop_while_tmp_588133;
                            j_581243 = j_tmp_588138;
                        }
                        s_581232 = loop_while_581238;
                        s_581237 = j_581243;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586568, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586598, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586571, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586600, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586575, i_586216 * lmad_arg_586596, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) mem_586603, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {block_sizze_581116, dim_293582});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586578, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
            }
            if (memblock_unref(ctx, &ext_mem_586565, "ext_mem_586565") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586725, bytes_586567, "mem_586725")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586725.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint64_t *) mem_586568, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            if (memblock_alloc(ctx, &mem_586729, bytes_586567, "mem_586729")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586729.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint64_t *) mem_586571, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            if (memblock_alloc(ctx, &mem_586734, bytes_586574, "mem_586734")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_586734.mem, (int64_t) 0, (int64_t []) {dim_293582 * block_sizze_581116, dim_293582, (int64_t) 1}, (uint64_t *) mem_586575, (int64_t) 0, (int64_t []) {lmad_arg_586596, dim_293582, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116, dim_293582});
            if (memblock_alloc(ctx, &mem_586738, bytes_586567, "mem_586738")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586738.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint64_t *) mem_586578, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            
            int64_t data_581298;
            bool data_581299;
            int64_t data_581304;
            int64_t loop_dz2084Uz2082U_581305;
            bool loop_while_581306;
            int64_t stride_581311;
            
            if (memblock_set(ctx, &mem_param_586742, &mem_586725, "mem_586725") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586745, &mem_586729, "mem_586729") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586749, &mem_586734, "mem_586734") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586752, &mem_586738, "mem_586738") != 0)
                return 1;
            loop_dz2084Uz2082U_581305 = flat_dim_581126;
            loop_while_581306 = loop_cond_581295;
            stride_581311 = block_sizze_581116;
            while (loop_while_581306) {
                int64_t next_stride_581312 = mul64((int64_t) 2, stride_581311);
                bool zzero_581313 = next_stride_581312 == (int64_t) 0;
                bool nonzzero_581314 = !zzero_581313;
                bool nonzzero_cert_581315;
                
                if (!nonzzero_581314) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_581316 = sdiv64(flat_dim_581126, next_stride_581312);
                bool bounds_invalid_upwards_581317 = slt64(num_merges_581316, (int64_t) 0);
                bool valid_581318 = !bounds_invalid_upwards_581317;
                bool range_valid_c_581319;
                
                if (!valid_581318) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_581316, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:818:33-56\n   #6  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_581321 = sub64(next_stride_581312, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_581322 = sle64((int64_t) 0, m_581321);
                bool cond_581324 = slt64(next_stride_581312, (int64_t) 10);
                bool protect_assert_disj_581325 = nonzzero_581297 || cond_581324;
                bool nonzzero_cert_581326;
                
                if (!protect_assert_disj_581325) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_581327 = smod_safe64(next_stride_581312, merge_block_sizze_581132);
                bool num_blocks_581328 = zeze_lhs_581327 == (int64_t) 0;
                bool protect_assert_disj_581329 = cond_581324 || num_blocks_581328;
                bool assert_c_581330;
                
                if (!protect_assert_disj_581329) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_581333 = sdiv_safe64(next_stride_581312, merge_block_sizze_581132);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334 = add64((int64_t) 1, num_blocks_581333);
                int64_t j_m_i_581335 = sub64(next_stride_581312, stride_581311);
                int64_t flat_dim_581336 = merge_block_sizze_581132 * num_blocks_581333;
                bool bounds_invalid_upwards_581337 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, (int64_t) 0);
                bool zzero_lte_i_581338 = sle64((int64_t) 0, stride_581311);
                bool i_lte_j_581339 = sle64(stride_581311, next_stride_581312);
                bool empty_slice_581340 = stride_581311 == (int64_t) 0;
                int64_t m_581341 = sub64(stride_581311, (int64_t) 1);
                bool bounds_invalid_upwards_581342 = slt64(num_blocks_581333, (int64_t) 0);
                bool empty_slice_581343 = j_m_i_581335 == (int64_t) 0;
                int64_t m_581344 = sub64(j_m_i_581335, (int64_t) 1);
                bool cond_581345 = slt64((int64_t) 0, stride_581311);
                bool valid_581346 = !bounds_invalid_upwards_581337;
                bool zzero_leq_i_p_m_t_s_581347 = sle64((int64_t) 0, m_581341);
                bool i_p_m_t_s_leq_w_581348 = slt64(m_581341, next_stride_581312);
                bool valid_581349 = !bounds_invalid_upwards_581342;
                bool i_p_m_t_s_leq_w_581350 = slt64(m_581321, flat_dim_581336);
                int64_t i_p_m_t_s_581351 = add64(stride_581311, m_581344);
                bool y_581352 = slt64((int64_t) 0, j_m_i_581335);
                bool protect_assert_disj_581353 = cond_581324 || valid_581346;
                bool range_valid_c_581354;
                
                if (!protect_assert_disj_581353) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581355 = zzero_leq_i_p_m_t_s_581347 && i_p_m_t_s_leq_w_581348;
                bool protect_assert_disj_581356 = cond_581324 || valid_581349;
                bool range_valid_c_581357;
                
                if (!protect_assert_disj_581356) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_581333, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581358 = zzero_leq_i_p_m_t_s_581322 && i_p_m_t_s_leq_w_581350;
                bool zzero_leq_i_p_m_t_s_581359 = sle64((int64_t) 0, i_p_m_t_s_581351);
                bool i_p_m_t_s_leq_w_581360 = slt64(i_p_m_t_s_581351, next_stride_581312);
                bool forwards_ok_581361 = zzero_lte_i_581338 && y_581355;
                bool ok_or_empty_581362 = zzero_581313 || y_581358;
                bool y_581363 = zzero_lte_i_581338 && i_p_m_t_s_leq_w_581360;
                bool protect_assert_disj_581364 = cond_581345 || y_581352;
                bool ok_or_empty_581365 = empty_slice_581340 || forwards_ok_581361;
                bool protect_assert_disj_581366 = cond_581324 || ok_or_empty_581362;
                bool index_certs_581367;
                
                if (!protect_assert_disj_581366) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581312, "] out of bounds for array of shape [", (long long) flat_dim_581336, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581368 = zzero_leq_i_p_m_t_s_581359 && y_581363;
                bool loop_not_taken_581369 = !cond_581324;
                bool protect_assert_disj_581370 = protect_assert_disj_581364 || loop_not_taken_581369;
                bool index_certs_581371;
                
                if (!protect_assert_disj_581370) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581372 = cond_581324 || ok_or_empty_581365;
                bool index_certs_581373;
                
                if (!protect_assert_disj_581372) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581311, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_581374 = i_lte_j_581339 && y_581368;
                bool protect_assert_disj_581375 = ok_or_empty_581365 || loop_not_taken_581369;
                bool index_certs_581376;
                
                if (!protect_assert_disj_581375) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581311, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_581377 = empty_slice_581343 || forwards_ok_581374;
                bool protect_assert_disj_581378 = loop_not_taken_581369 || ok_or_empty_581377;
                bool index_certs_581379;
                
                if (!protect_assert_disj_581378) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581311, ":] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581380 = cond_581324 || ok_or_empty_581377;
                bool index_certs_581381;
                
                if (!protect_assert_disj_581380) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581311, ":] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586753 = (int64_t) 8 * num_merges_581316;
                int64_t bytes_586754 = next_stride_581312 * binop_x_586753;
                int64_t bytes_586761 = dim_293582 * bytes_586754;
                bool i_lte_j_581323 = sle64((int64_t) 0, next_stride_581312);
                
                if (mem_586755_cached_sizze_588852 < bytes_586754) {
                    err = lexical_realloc(ctx, &mem_586755, &mem_586755_cached_sizze_588852, bytes_586754);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586758_cached_sizze_588853 < bytes_586754) {
                    err = lexical_realloc(ctx, &mem_586758, &mem_586758_cached_sizze_588853, bytes_586754);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586762_cached_sizze_588854 < bytes_586761) {
                    err = lexical_realloc(ctx, &mem_586762, &mem_586762_cached_sizze_588854, bytes_586761);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586765_cached_sizze_588855 < bytes_586754) {
                    err = lexical_realloc(ctx, &mem_586765, &mem_586765_cached_sizze_588855, bytes_586754);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586783 = dim_293582 * next_stride_581312;
                int64_t bytes_586784 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334;
                int64_t binop_x_586800 = (int64_t) 8 * num_blocks_581333;
                int64_t bytes_586801 = merge_block_sizze_581132 * binop_x_586800;
                int64_t bytes_586808 = dim_293582 * bytes_586801;
                int64_t bytes_586915 = (int64_t) 16 * stride_581311;
                int64_t bytes_586922 = dim_293582 * bytes_586915;
                
                for (int64_t i_586249 = 0; i_586249 < num_merges_581316; i_586249++) {
                    int64_t start_581387 = mul64(next_stride_581312, i_586249);
                    int64_t j_m_i_581388 = sub64(loop_dz2084Uz2082U_581305, start_581387);
                    bool empty_slice_581389 = j_m_i_581388 == (int64_t) 0;
                    int64_t m_581390 = sub64(j_m_i_581388, (int64_t) 1);
                    int64_t i_p_m_t_s_581391 = add64(start_581387, m_581390);
                    bool zzero_leq_i_p_m_t_s_581392 = sle64((int64_t) 0, i_p_m_t_s_581391);
                    bool i_p_m_t_s_leq_w_581393 = slt64(i_p_m_t_s_581391, loop_dz2084Uz2082U_581305);
                    bool zzero_lte_i_581394 = sle64((int64_t) 0, start_581387);
                    bool i_lte_j_581395 = sle64(start_581387, loop_dz2084Uz2082U_581305);
                    bool y_581396 = i_p_m_t_s_leq_w_581393 && zzero_lte_i_581394;
                    bool y_581397 = zzero_leq_i_p_m_t_s_581392 && y_581396;
                    bool forwards_ok_581398 = i_lte_j_581395 && y_581397;
                    bool ok_or_empty_581399 = empty_slice_581389 || forwards_ok_581398;
                    bool index_certs_581400;
                    
                    if (!ok_or_empty_581399) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_581387, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_581305, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_581401 = slt64(m_581321, j_m_i_581388);
                    bool y_581402 = zzero_leq_i_p_m_t_s_581322 && i_p_m_t_s_leq_w_581401;
                    bool forwards_ok_581403 = i_lte_j_581323 && y_581402;
                    bool ok_or_empty_581404 = zzero_581313 || forwards_ok_581403;
                    bool index_certs_581405;
                    
                    if (!ok_or_empty_581404) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581312, "] out of bounds for array of shape [", (long long) j_m_i_581388, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:818:33-56\n   #8  ftSkyline.fut:807:17-818:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585631 = stride_581311 + start_581387;
                    int64_t binop_y_586910 = dim_293582 * slice_585631;
                    int64_t binop_y_586912 = dim_293582 * start_581387;
                    int64_t ext_586914;
                    
                    if (cond_581345) {
                        ext_586914 = binop_y_586912;
                    } else {
                        ext_586914 = binop_y_586910;
                    }
                    if (cond_581324) {
                        int64_t dummy_585623;
                        double dummy_585624;
                        int64_t dummy_585626;
                        
                        if (cond_581345) {
                            int64_t head_res_585627 = ((int64_t *) mem_param_586742.mem)[start_581387];
                            double head_res_585628 = ((double *) mem_param_586745.mem)[start_581387];
                            int64_t head_res_585630 = ((int64_t *) mem_param_586752.mem)[start_581387];
                            
                            dummy_585623 = head_res_585627;
                            dummy_585624 = head_res_585628;
                            dummy_585626 = head_res_585630;
                        } else {
                            int64_t head_res_585632 = ((int64_t *) mem_param_586742.mem)[slice_585631];
                            double head_res_585633 = ((double *) mem_param_586745.mem)[slice_585631];
                            int64_t head_res_585635 = ((int64_t *) mem_param_586752.mem)[slice_585631];
                            
                            dummy_585623 = head_res_585632;
                            dummy_585624 = head_res_585633;
                            dummy_585626 = head_res_585635;
                        }
                        if (memblock_alloc(ctx, &mem_586916, bytes_586915, "mem_586916")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588154 = 0; nest_i_588154 < next_stride_581312; nest_i_588154++) {
                            ((int64_t *) mem_586916.mem)[nest_i_588154] = dummy_585623;
                        }
                        if (memblock_alloc(ctx, &mem_586918, bytes_586915, "mem_586918")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588155 = 0; nest_i_588155 < next_stride_581312; nest_i_588155++) {
                            ((double *) mem_586918.mem)[nest_i_588155] = dummy_585624;
                        }
                        if (memblock_alloc(ctx, &mem_586920, bytes_586915, "mem_586920")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588156 = 0; nest_i_588156 < next_stride_581312; nest_i_588156++) {
                            ((int64_t *) mem_586920.mem)[nest_i_588156] = dummy_585626;
                        }
                        if (memblock_alloc(ctx, &mem_586923, bytes_586922, "mem_586923")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588157 = 0; nest_i_588157 < next_stride_581312; nest_i_588157++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586923.mem, nest_i_588157 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586749.mem, ext_586914, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                        }
                        
                        int64_t data_585640;
                        int64_t i_585646 = (int64_t) 0;
                        
                        for (int64_t k_585645 = 0; k_585645 < next_stride_581312; k_585645++) {
                            int64_t j_585651 = sub64(k_585645, i_585646);
                            bool cond_585652 = j_585651 == j_m_i_581335;
                            bool x_587826 = !cond_585652;
                            bool cond_585654 = slt64(i_585646, stride_581311);
                            bool x_585656 = sle64((int64_t) 0, j_585651);
                            bool y_585657 = slt64(j_585651, j_m_i_581335);
                            bool bounds_check_585658 = x_585656 && y_585657;
                            bool loop_not_taken_587814 = !cond_585654;
                            bool protect_assert_disj_587815 = bounds_check_585658 || loop_not_taken_587814;
                            bool protect_assert_disj_587829 = cond_585652 || protect_assert_disj_587815;
                            bool index_certs_585659;
                            
                            if (!protect_assert_disj_587829) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585651, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585660 = stride_581311 + j_585651;
                            int64_t slice_585661 = start_581387 + slice_585660;
                            bool protect_cond_conj_587830 = cond_585654 && x_587826;
                            int64_t leq_arg1_585662;
                            
                            if (protect_cond_conj_587830) {
                                int64_t x_587816 = ((int64_t *) mem_param_586742.mem)[slice_585661];
                                
                                leq_arg1_585662 = x_587816;
                            } else {
                                leq_arg1_585662 = (int64_t) 0;
                            }
                            
                            double leq_arg1_585663;
                            
                            if (protect_cond_conj_587830) {
                                double x_587818 = ((double *) mem_param_586745.mem)[slice_585661];
                                
                                leq_arg1_585663 = x_587818;
                            } else {
                                leq_arg1_585663 = 0.0;
                            }
                            
                            bool x_585664 = sle64((int64_t) 0, i_585646);
                            bool bounds_check_585665 = cond_585654 && x_585664;
                            bool protect_assert_disj_587821 = bounds_check_585665 || loop_not_taken_587814;
                            bool protect_assert_disj_587833 = cond_585652 || protect_assert_disj_587821;
                            bool index_certs_585666;
                            
                            if (!protect_assert_disj_587833) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585646, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585667 = start_581387 + i_585646;
                            int64_t leq_arg0_585668;
                            
                            if (protect_cond_conj_587830) {
                                int64_t x_587822 = ((int64_t *) mem_param_586742.mem)[slice_585667];
                                
                                leq_arg0_585668 = x_587822;
                            } else {
                                leq_arg0_585668 = (int64_t) 0;
                            }
                            
                            double leq_arg0_585669;
                            
                            if (protect_cond_conj_587830) {
                                double x_587824 = ((double *) mem_param_586745.mem)[slice_585667];
                                
                                leq_arg0_585669 = x_587824;
                            } else {
                                leq_arg0_585669 = 0.0;
                            }
                            
                            bool cond_585670 = slt64(leq_arg0_585668, leq_arg1_585662);
                            bool cond_585671 = leq_arg0_585668 == leq_arg1_585662;
                            bool zlze_res_585672 = leq_arg0_585669 <= leq_arg1_585663;
                            bool x_585673 = cond_585671 && zlze_res_585672;
                            bool x_585674 = !cond_585670;
                            bool y_585675 = x_585673 && x_585674;
                            bool defunc_0_leq_res_585676 = cond_585670 || y_585675;
                            bool x_587869 = cond_585654 && defunc_0_leq_res_585676;
                            bool cond_585653 = cond_585652 || x_587869;
                            bool protect_assert_disj_587734 = cond_585653 || bounds_check_585658;
                            bool index_certs_585695;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585651, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585685 = cond_585654 && x_585664;
                            bool loop_not_taken_587729 = !cond_585653;
                            bool protect_assert_disj_587730 = bounds_check_585685 || loop_not_taken_587729;
                            bool index_certs_585686;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585646, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:818:33-56\n   #9  ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585697 = start_581387 + slice_585660;
                            int64_t binop_y_586937 = dim_293582 * slice_585697;
                            int64_t binop_y_586939 = dim_293582 * slice_585667;
                            int64_t ext_586941;
                            
                            if (cond_585653) {
                                ext_586941 = binop_y_586939;
                            } else {
                                ext_586941 = binop_y_586937;
                            }
                            
                            int64_t loopres_585677;
                            int64_t loopres_585678;
                            double loopres_585679;
                            int64_t loopres_585681;
                            
                            if (cond_585653) {
                                int64_t tmp_585682 = add64((int64_t) 1, i_585646);
                                int64_t tmp_585688 = ((int64_t *) mem_param_586742.mem)[slice_585667];
                                double tmp_585689 = ((double *) mem_param_586745.mem)[slice_585667];
                                int64_t tmp_585691 = ((int64_t *) mem_param_586752.mem)[slice_585667];
                                
                                loopres_585677 = tmp_585682;
                                loopres_585678 = tmp_585688;
                                loopres_585679 = tmp_585689;
                                loopres_585681 = tmp_585691;
                            } else {
                                int64_t tmp_585698 = ((int64_t *) mem_param_586742.mem)[slice_585697];
                                double tmp_585699 = ((double *) mem_param_586745.mem)[slice_585697];
                                int64_t tmp_585701 = ((int64_t *) mem_param_586752.mem)[slice_585697];
                                
                                loopres_585677 = i_585646;
                                loopres_585678 = tmp_585698;
                                loopres_585679 = tmp_585699;
                                loopres_585681 = tmp_585701;
                            }
                            ((int64_t *) mem_586916.mem)[k_585645] = loopres_585678;
                            ((double *) mem_586918.mem)[k_585645] = loopres_585679;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586923.mem, k_585645 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586749.mem, ext_586941, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            ((int64_t *) mem_586920.mem)[k_585645] = loopres_585681;
                            
                            int64_t i_tmp_588158 = loopres_585677;
                            
                            i_585646 = i_tmp_588158;
                        }
                        data_585640 = i_585646;
                        if (memblock_set(ctx, &ext_mem_586967, &mem_586916, "mem_586916") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586964, &mem_586918, "mem_586918") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586961, &mem_586923, "mem_586923") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586957, &mem_586920, "mem_586920") != 0)
                            return 1;
                    } else {
                        if (mem_586785_cached_sizze_588856 < bytes_586784) {
                            err = lexical_realloc(ctx, &mem_586785, &mem_586785_cached_sizze_588856, bytes_586784);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586787_cached_sizze_588857 < bytes_586784) {
                            err = lexical_realloc(ctx, &mem_586787, &mem_586787_cached_sizze_588857, bytes_586784);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586225 = 0; i_586225 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334; i_586225++) {
                            int64_t split_count_arg3_581497 = mul64(merge_block_sizze_581132, i_586225);
                            int64_t defunc_0_split_count_res_581498;
                            int64_t defunc_0_split_count_res_581499;
                            int64_t defunc_0_split_count_res_581500;
                            int64_t defunc_0_split_count_res_581501;
                            int64_t defunc_0_split_count_res_581502;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_581498, &defunc_0_split_count_res_581499, &defunc_0_split_count_res_581500, &defunc_0_split_count_res_581501, &defunc_0_split_count_res_581502, (int64_t) 0, stride_581311, (int64_t) 0, j_m_i_581335, split_count_arg3_581497) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_581503 = slt64((int64_t) 0, defunc_0_split_count_res_581502);
                            bool defunc_0_split_count_res_581504;
                            int64_t defunc_0_split_count_res_581505;
                            int64_t defunc_0_split_count_res_581506;
                            int64_t defunc_0_split_count_res_581507;
                            int64_t defunc_0_split_count_res_581508;
                            int64_t defunc_0_split_count_res_581509;
                            bool loop_while_581510;
                            int64_t ss_581511;
                            int64_t ss_581512;
                            int64_t tt_581513;
                            int64_t tt_581514;
                            int64_t count_581515;
                            
                            loop_while_581510 = loop_cond_581503;
                            ss_581511 = defunc_0_split_count_res_581498;
                            ss_581512 = defunc_0_split_count_res_581499;
                            tt_581513 = defunc_0_split_count_res_581500;
                            tt_581514 = defunc_0_split_count_res_581501;
                            count_581515 = defunc_0_split_count_res_581502;
                            while (loop_while_581510) {
                                int64_t zlze_lhs_581516 = sub64(ss_581512, ss_581511);
                                bool cond_581517 = sle64(zlze_lhs_581516, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_581518;
                                int64_t defunc_0_lifted_step_res_581519;
                                int64_t defunc_0_lifted_step_res_581520;
                                int64_t defunc_0_lifted_step_res_581521;
                                
                                if (cond_581517) {
                                    int64_t tmp_585706 = add64(tt_581513, count_581515);
                                    
                                    defunc_0_lifted_step_res_581518 = ss_581511;
                                    defunc_0_lifted_step_res_581519 = tmp_585706;
                                    defunc_0_lifted_step_res_581520 = tt_581514;
                                    defunc_0_lifted_step_res_581521 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_581523 = sub64(tt_581514, tt_581513);
                                    bool cond_581524 = sle64(zlze_lhs_581523, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_581525;
                                    int64_t defunc_0_lifted_step_res_f_res_581526;
                                    int64_t defunc_0_lifted_step_res_f_res_581527;
                                    int64_t defunc_0_lifted_step_res_f_res_581528;
                                    
                                    if (cond_581524) {
                                        int64_t tmp_585707 = add64(ss_581511, count_581515);
                                        
                                        defunc_0_lifted_step_res_f_res_581525 = tmp_585707;
                                        defunc_0_lifted_step_res_f_res_581526 = tt_581513;
                                        defunc_0_lifted_step_res_f_res_581527 = tt_581514;
                                        defunc_0_lifted_step_res_f_res_581528 = (int64_t) 0;
                                    } else {
                                        bool cond_581530 = count_581515 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581531;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581532;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581533;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581534;
                                        
                                        if (cond_581530) {
                                            bool x_585709 = sle64((int64_t) 0, ss_581511);
                                            bool y_585710 = slt64(ss_581511, stride_581311);
                                            bool bounds_check_585711 = x_585709 && y_585710;
                                            bool index_certs_585712;
                                            
                                            if (!bounds_check_585711) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_581511, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:818:33-56\n   #13 ftSkyline.fut:807:17-818:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585716 = sle64((int64_t) 0, tt_581513);
                                            bool y_585717 = slt64(tt_581513, j_m_i_581335);
                                            bool bounds_check_585718 = x_585716 && y_585717;
                                            bool index_certs_585719;
                                            
                                            if (!bounds_check_585718) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_581513, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:818:33-56\n   #13 ftSkyline.fut:807:17-818:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585713 = start_581387 + ss_581511;
                                            int64_t leq_arg1_585714 = ((int64_t *) mem_param_586742.mem)[slice_585713];
                                            double leq_arg1_585715 = ((double *) mem_param_586745.mem)[slice_585713];
                                            int64_t slice_585720 = stride_581311 + tt_581513;
                                            int64_t slice_585721 = start_581387 + slice_585720;
                                            int64_t leq_arg0_585722 = ((int64_t *) mem_param_586742.mem)[slice_585721];
                                            double leq_arg0_585723 = ((double *) mem_param_586745.mem)[slice_585721];
                                            bool cond_585724 = slt64(leq_arg0_585722, leq_arg1_585714);
                                            bool cond_585725 = leq_arg0_585722 == leq_arg1_585714;
                                            bool zlze_res_585726 = leq_arg0_585723 <= leq_arg1_585715;
                                            bool x_585727 = cond_585725 && zlze_res_585726;
                                            bool x_585728 = !cond_585724;
                                            bool y_585729 = x_585727 && x_585728;
                                            bool defunc_0_leq_res_585730 = cond_585724 || y_585729;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585731;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585732;
                                            
                                            if (defunc_0_leq_res_585730) {
                                                int64_t tmp_585733 = add64((int64_t) 1, tt_581513);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585731 = ss_581511;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585732 = tmp_585733;
                                            } else {
                                                int64_t tmp_585734 = add64((int64_t) 1, ss_581511);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585731 = tmp_585734;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585732 = tt_581513;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581531 = defunc_0_lifted_step_res_f_res_f_res_t_res_585731;
                                            defunc_0_lifted_step_res_f_res_f_res_581532 = defunc_0_lifted_step_res_f_res_f_res_t_res_585732;
                                            defunc_0_lifted_step_res_f_res_f_res_581533 = tt_581514;
                                            defunc_0_lifted_step_res_f_res_f_res_581534 = (int64_t) 0;
                                        } else {
                                            int64_t m_581561 = sdiv64(count_581515, (int64_t) 2);
                                            int64_t n_581562 = sub64(count_581515, m_581561);
                                            bool cond_581563 = n_581562 == (int64_t) 0;
                                            int64_t zgze_lhs_581564 = add64(ss_581511, m_581561);
                                            bool cond_f_res_581565 = sle64(ss_581512, zgze_lhs_581564);
                                            bool x_581566 = !cond_581563;
                                            bool y_581567 = cond_f_res_581565 && x_581566;
                                            bool cond_581568 = cond_581563 || y_581567;
                                            bool leq_y_x_581569;
                                            
                                            if (cond_581568) {
                                                leq_y_x_581569 = 1;
                                            } else {
                                                bool x_581570 = sle64((int64_t) 0, zgze_lhs_581564);
                                                bool y_581571 = slt64(zgze_lhs_581564, stride_581311);
                                                bool bounds_check_581572 = x_581570 && y_581571;
                                                bool index_certs_581573;
                                                
                                                if (!bounds_check_581572) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_581564, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:818:33-56\n   #13 ftSkyline.fut:807:17-818:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_581577 = add64(tt_581513, n_581562);
                                                int64_t leq_arg0_581578 = sub64(zm_lhs_581577, (int64_t) 1);
                                                bool x_581579 = sle64((int64_t) 0, leq_arg0_581578);
                                                bool y_581580 = slt64(leq_arg0_581578, j_m_i_581335);
                                                bool bounds_check_581581 = x_581579 && y_581580;
                                                bool index_certs_581582;
                                                
                                                if (!bounds_check_581581) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_581578, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:818:33-56\n   #13 ftSkyline.fut:807:17-818:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_581574 = start_581387 + zgze_lhs_581564;
                                                int64_t leq_arg1_581575 = ((int64_t *) mem_param_586742.mem)[slice_581574];
                                                double leq_arg1_581576 = ((double *) mem_param_586745.mem)[slice_581574];
                                                int64_t slice_581583 = stride_581311 + leq_arg0_581578;
                                                int64_t slice_581584 = start_581387 + slice_581583;
                                                int64_t leq_arg0_581585 = ((int64_t *) mem_param_586742.mem)[slice_581584];
                                                double leq_arg0_581586 = ((double *) mem_param_586745.mem)[slice_581584];
                                                bool cond_581587 = slt64(leq_arg0_581585, leq_arg1_581575);
                                                bool cond_581588 = leq_arg0_581585 == leq_arg1_581575;
                                                bool zlze_res_581589 = leq_arg0_581586 <= leq_arg1_581576;
                                                bool x_581590 = cond_581588 && zlze_res_581589;
                                                bool x_581591 = !cond_581587;
                                                bool y_581592 = x_581590 && x_581591;
                                                bool defunc_0_leq_res_581593 = cond_581587 || y_581592;
                                                
                                                leq_y_x_581569 = defunc_0_leq_res_581593;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581594;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581595;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581596;
                                            
                                            if (leq_y_x_581569) {
                                                int64_t tmp_585735 = add64(tt_581513, n_581562);
                                                int64_t tmp_585736 = sub64(count_581515, n_581562);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581594 = tmp_585735;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581595 = tt_581514;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581596 = tmp_585736;
                                            } else {
                                                int64_t tmp_581599 = add64(tt_581513, n_581562);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581594 = tt_581513;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581595 = tmp_581599;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581596 = count_581515;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581531 = ss_581511;
                                            defunc_0_lifted_step_res_f_res_f_res_581532 = defunc_0_lifted_step_res_f_res_f_res_f_res_581594;
                                            defunc_0_lifted_step_res_f_res_f_res_581533 = defunc_0_lifted_step_res_f_res_f_res_f_res_581595;
                                            defunc_0_lifted_step_res_f_res_f_res_581534 = defunc_0_lifted_step_res_f_res_f_res_f_res_581596;
                                        }
                                        defunc_0_lifted_step_res_f_res_581525 = defunc_0_lifted_step_res_f_res_f_res_581531;
                                        defunc_0_lifted_step_res_f_res_581526 = defunc_0_lifted_step_res_f_res_f_res_581532;
                                        defunc_0_lifted_step_res_f_res_581527 = defunc_0_lifted_step_res_f_res_f_res_581533;
                                        defunc_0_lifted_step_res_f_res_581528 = defunc_0_lifted_step_res_f_res_f_res_581534;
                                    }
                                    defunc_0_lifted_step_res_581518 = defunc_0_lifted_step_res_f_res_581525;
                                    defunc_0_lifted_step_res_581519 = defunc_0_lifted_step_res_f_res_581526;
                                    defunc_0_lifted_step_res_581520 = defunc_0_lifted_step_res_f_res_581527;
                                    defunc_0_lifted_step_res_581521 = defunc_0_lifted_step_res_f_res_581528;
                                }
                                
                                int64_t loopres_581600;
                                int64_t loopres_581601;
                                int64_t loopres_581602;
                                int64_t loopres_581603;
                                int64_t loopres_581604;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_581600, &loopres_581601, &loopres_581602, &loopres_581603, &loopres_581604, defunc_0_lifted_step_res_581518, ss_581512, defunc_0_lifted_step_res_581519, defunc_0_lifted_step_res_581520, defunc_0_lifted_step_res_581521) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_581605 = slt64((int64_t) 0, loopres_581604);
                                bool loop_while_tmp_588165 = loop_cond_581605;
                                int64_t ss_tmp_588166 = loopres_581600;
                                int64_t ss_tmp_588167 = loopres_581601;
                                int64_t tt_tmp_588168 = loopres_581602;
                                int64_t tt_tmp_588169 = loopres_581603;
                                int64_t count_tmp_588170 = loopres_581604;
                                
                                loop_while_581510 = loop_while_tmp_588165;
                                ss_581511 = ss_tmp_588166;
                                ss_581512 = ss_tmp_588167;
                                tt_581513 = tt_tmp_588168;
                                tt_581514 = tt_tmp_588169;
                                count_581515 = count_tmp_588170;
                            }
                            defunc_0_split_count_res_581504 = loop_while_581510;
                            defunc_0_split_count_res_581505 = ss_581511;
                            defunc_0_split_count_res_581506 = ss_581512;
                            defunc_0_split_count_res_581507 = tt_581513;
                            defunc_0_split_count_res_581508 = tt_581514;
                            defunc_0_split_count_res_581509 = count_581515;
                            ((int64_t *) mem_586785)[i_586225] = defunc_0_split_count_res_581505;
                            ((int64_t *) mem_586787)[i_586225] = defunc_0_split_count_res_581507;
                        }
                        if (mem_586802_cached_sizze_588858 < bytes_586801) {
                            err = lexical_realloc(ctx, &mem_586802, &mem_586802_cached_sizze_588858, bytes_586801);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586805_cached_sizze_588859 < bytes_586801) {
                            err = lexical_realloc(ctx, &mem_586805, &mem_586805_cached_sizze_588859, bytes_586801);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586809_cached_sizze_588860 < bytes_586808) {
                            err = lexical_realloc(ctx, &mem_586809, &mem_586809_cached_sizze_588860, bytes_586808);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586812_cached_sizze_588861 < bytes_586801) {
                            err = lexical_realloc(ctx, &mem_586812, &mem_586812_cached_sizze_588861, bytes_586801);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586236 = 0; i_586236 < num_blocks_581333; i_586236++) {
                            bool y_581613 = slt64(i_586236, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334);
                            bool index_certs_581615;
                            
                            if (!y_581613) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586236, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581616 = ((int64_t *) mem_586785)[i_586236];
                            int64_t defunc_0_f_res_581617 = ((int64_t *) mem_586787)[i_586236];
                            int64_t tmp_581618 = add64((int64_t) 1, i_586236);
                            bool x_581619 = sle64((int64_t) 0, tmp_581618);
                            bool y_581620 = slt64(tmp_581618, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334);
                            bool bounds_check_581621 = x_581619 && y_581620;
                            bool index_certs_581622;
                            
                            if (!bounds_check_581621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581618, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581623 = ((int64_t *) mem_586785)[tmp_581618];
                            int64_t defunc_0_f_res_581624 = ((int64_t *) mem_586787)[tmp_581618];
                            int64_t merge_sequential_arg2_581625 = add64(stride_581311, defunc_0_f_res_581617);
                            int64_t merge_sequential_arg2_581626 = add64(stride_581311, defunc_0_f_res_581624);
                            int64_t j_m_i_581627 = sub64(merge_sequential_arg2_581626, merge_sequential_arg2_581625);
                            bool empty_slice_581628 = j_m_i_581627 == (int64_t) 0;
                            int64_t m_581629 = sub64(j_m_i_581627, (int64_t) 1);
                            int64_t i_p_m_t_s_581630 = add64(merge_sequential_arg2_581625, m_581629);
                            bool zzero_leq_i_p_m_t_s_581631 = sle64((int64_t) 0, i_p_m_t_s_581630);
                            bool i_p_m_t_s_leq_w_581632 = slt64(i_p_m_t_s_581630, next_stride_581312);
                            bool zzero_lte_i_581633 = sle64((int64_t) 0, merge_sequential_arg2_581625);
                            bool i_lte_j_581634 = sle64(merge_sequential_arg2_581625, merge_sequential_arg2_581626);
                            bool y_581635 = i_p_m_t_s_leq_w_581632 && zzero_lte_i_581633;
                            bool y_581636 = zzero_leq_i_p_m_t_s_581631 && y_581635;
                            bool forwards_ok_581637 = i_lte_j_581634 && y_581636;
                            bool ok_or_empty_581638 = empty_slice_581628 || forwards_ok_581637;
                            bool index_certs_581639;
                            
                            if (!ok_or_empty_581638) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_581625, ":", (long long) merge_sequential_arg2_581626, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_581640 = sub64(defunc_0_f_res_581623, defunc_0_f_res_581616);
                            bool empty_slice_581641 = j_m_i_581640 == (int64_t) 0;
                            int64_t m_581642 = sub64(j_m_i_581640, (int64_t) 1);
                            int64_t i_p_m_t_s_581643 = add64(defunc_0_f_res_581616, m_581642);
                            bool zzero_leq_i_p_m_t_s_581644 = sle64((int64_t) 0, i_p_m_t_s_581643);
                            bool i_p_m_t_s_leq_w_581645 = slt64(i_p_m_t_s_581643, next_stride_581312);
                            bool zzero_lte_i_581646 = sle64((int64_t) 0, defunc_0_f_res_581616);
                            bool i_lte_j_581647 = sle64(defunc_0_f_res_581616, defunc_0_f_res_581623);
                            bool y_581648 = i_p_m_t_s_leq_w_581645 && zzero_lte_i_581646;
                            bool y_581649 = zzero_leq_i_p_m_t_s_581644 && y_581648;
                            bool forwards_ok_581650 = i_lte_j_581647 && y_581649;
                            bool ok_or_empty_581651 = empty_slice_581641 || forwards_ok_581650;
                            bool index_certs_581652;
                            
                            if (!ok_or_empty_581651) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_581616, ":", (long long) defunc_0_f_res_581623, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:818:33-56\n   #10 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_581653 = slt64((int64_t) 0, j_m_i_581640);
                            bool y_581664 = slt64((int64_t) 0, j_m_i_581627);
                            bool protect_assert_disj_587750 = cond_581653 || y_581664;
                            bool index_certs_581665;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:818:33-56\n   #12 ftSkyline.fut:807:17-818:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_581666 = start_581387 + merge_sequential_arg2_581625;
                            int64_t binop_y_586831 = dim_293582 * slice_581666;
                            int64_t slice_585738 = start_581387 + defunc_0_f_res_581616;
                            int64_t binop_y_586833 = dim_293582 * slice_585738;
                            int64_t ext_586835;
                            
                            if (cond_581653) {
                                ext_586835 = binop_y_586833;
                            } else {
                                ext_586835 = binop_y_586831;
                            }
                            
                            int64_t dummy_581654;
                            double dummy_581655;
                            int64_t dummy_581657;
                            
                            if (cond_581653) {
                                int64_t head_res_585739 = ((int64_t *) mem_param_586742.mem)[slice_585738];
                                double head_res_585740 = ((double *) mem_param_586745.mem)[slice_585738];
                                int64_t head_res_585742 = ((int64_t *) mem_param_586752.mem)[slice_585738];
                                
                                dummy_581654 = head_res_585739;
                                dummy_581655 = head_res_585740;
                                dummy_581657 = head_res_585742;
                            } else {
                                int64_t head_res_581667 = ((int64_t *) mem_param_586742.mem)[slice_581666];
                                double head_res_581668 = ((double *) mem_param_586745.mem)[slice_581666];
                                int64_t head_res_581670 = ((int64_t *) mem_param_586752.mem)[slice_581666];
                                
                                dummy_581654 = head_res_581667;
                                dummy_581655 = head_res_581668;
                                dummy_581657 = head_res_581670;
                            }
                            for (int64_t nest_i_588175 = 0; nest_i_588175 < merge_block_sizze_581132; nest_i_588175++) {
                                ((int64_t *) mem_586802)[i_586236 * merge_block_sizze_581132 + nest_i_588175] = dummy_581654;
                            }
                            for (int64_t nest_i_588176 = 0; nest_i_588176 < merge_block_sizze_581132; nest_i_588176++) {
                                ((double *) mem_586805)[i_586236 * merge_block_sizze_581132 + nest_i_588176] = dummy_581655;
                            }
                            for (int64_t nest_i_588177 = 0; nest_i_588177 < merge_block_sizze_581132; nest_i_588177++) {
                                ((int64_t *) mem_586812)[i_586236 * merge_block_sizze_581132 + nest_i_588177] = dummy_581657;
                            }
                            for (int64_t nest_i_588178 = 0; nest_i_588178 < merge_block_sizze_581132; nest_i_588178++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586809, i_586236 * lmad_arg_586830 + nest_i_588178 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586749.mem, ext_586835, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                            }
                            
                            int64_t data_581675;
                            int64_t i_581681 = (int64_t) 0;
                            
                            for (int64_t k_581680 = 0; k_581680 < merge_block_sizze_581132; k_581680++) {
                                int64_t j_581686 = sub64(k_581680, i_581681);
                                bool cond_581687 = j_581686 == j_m_i_581627;
                                bool x_587850 = !cond_581687;
                                bool cond_581689 = slt64(i_581681, j_m_i_581640);
                                bool x_585743 = sle64((int64_t) 0, j_581686);
                                bool y_585744 = slt64(j_581686, j_m_i_581627);
                                bool bounds_check_585745 = x_585743 && y_585744;
                                bool loop_not_taken_587838 = !cond_581689;
                                bool protect_assert_disj_587839 = bounds_check_585745 || loop_not_taken_587838;
                                bool protect_assert_disj_587853 = cond_581687 || protect_assert_disj_587839;
                                bool index_certs_585746;
                                
                                if (!protect_assert_disj_587853) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581686, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585747 = merge_sequential_arg2_581625 + j_581686;
                                int64_t slice_585748 = start_581387 + slice_585747;
                                bool protect_cond_conj_587854 = cond_581689 && x_587850;
                                int64_t leq_arg1_585749;
                                
                                if (protect_cond_conj_587854) {
                                    int64_t x_587840 = ((int64_t *) mem_param_586742.mem)[slice_585748];
                                    
                                    leq_arg1_585749 = x_587840;
                                } else {
                                    leq_arg1_585749 = (int64_t) 0;
                                }
                                
                                double leq_arg1_585750;
                                
                                if (protect_cond_conj_587854) {
                                    double x_587842 = ((double *) mem_param_586745.mem)[slice_585748];
                                    
                                    leq_arg1_585750 = x_587842;
                                } else {
                                    leq_arg1_585750 = 0.0;
                                }
                                
                                bool x_585751 = sle64((int64_t) 0, i_581681);
                                bool bounds_check_585752 = cond_581689 && x_585751;
                                bool protect_assert_disj_587845 = bounds_check_585752 || loop_not_taken_587838;
                                bool protect_assert_disj_587857 = cond_581687 || protect_assert_disj_587845;
                                bool index_certs_585753;
                                
                                if (!protect_assert_disj_587857) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581681, "] out of bounds for array of shape [", (long long) j_m_i_581640, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585754 = defunc_0_f_res_581616 + i_581681;
                                int64_t slice_585755 = start_581387 + slice_585754;
                                int64_t leq_arg0_585756;
                                
                                if (protect_cond_conj_587854) {
                                    int64_t x_587846 = ((int64_t *) mem_param_586742.mem)[slice_585755];
                                    
                                    leq_arg0_585756 = x_587846;
                                } else {
                                    leq_arg0_585756 = (int64_t) 0;
                                }
                                
                                double leq_arg0_585757;
                                
                                if (protect_cond_conj_587854) {
                                    double x_587848 = ((double *) mem_param_586745.mem)[slice_585755];
                                    
                                    leq_arg0_585757 = x_587848;
                                } else {
                                    leq_arg0_585757 = 0.0;
                                }
                                
                                bool cond_585758 = slt64(leq_arg0_585756, leq_arg1_585749);
                                bool cond_585759 = leq_arg0_585756 == leq_arg1_585749;
                                bool zlze_res_585760 = leq_arg0_585757 <= leq_arg1_585750;
                                bool x_585761 = cond_585759 && zlze_res_585760;
                                bool x_585762 = !cond_585758;
                                bool y_585763 = x_585761 && x_585762;
                                bool defunc_0_leq_res_585764 = cond_585758 || y_585763;
                                bool x_587872 = cond_581689 && defunc_0_leq_res_585764;
                                bool cond_581688 = cond_581687 || x_587872;
                                bool protect_assert_disj_587742 = cond_581688 || bounds_check_585745;
                                bool index_certs_581732;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581686, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585768 = cond_581689 && x_585751;
                                bool loop_not_taken_587737 = !cond_581688;
                                bool protect_assert_disj_587738 = bounds_check_585768 || loop_not_taken_587737;
                                bool index_certs_585769;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581681, "] out of bounds for array of shape [", (long long) j_m_i_581640, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:818:33-56\n   #11 ftSkyline.fut:807:17-818:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_581734 = start_581387 + slice_585747;
                                int64_t binop_y_586858 = dim_293582 * slice_581734;
                                int64_t slice_585771 = start_581387 + slice_585754;
                                int64_t binop_y_586860 = dim_293582 * slice_585771;
                                int64_t ext_586862;
                                
                                if (cond_581688) {
                                    ext_586862 = binop_y_586860;
                                } else {
                                    ext_586862 = binop_y_586858;
                                }
                                
                                int64_t loopres_581713;
                                int64_t loopres_581714;
                                double loopres_581715;
                                int64_t loopres_581717;
                                
                                if (cond_581688) {
                                    int64_t tmp_585765 = add64((int64_t) 1, i_581681);
                                    int64_t tmp_585772 = ((int64_t *) mem_param_586742.mem)[slice_585771];
                                    double tmp_585773 = ((double *) mem_param_586745.mem)[slice_585771];
                                    int64_t tmp_585775 = ((int64_t *) mem_param_586752.mem)[slice_585771];
                                    
                                    loopres_581713 = tmp_585765;
                                    loopres_581714 = tmp_585772;
                                    loopres_581715 = tmp_585773;
                                    loopres_581717 = tmp_585775;
                                } else {
                                    int64_t tmp_581735 = ((int64_t *) mem_param_586742.mem)[slice_581734];
                                    double tmp_581736 = ((double *) mem_param_586745.mem)[slice_581734];
                                    int64_t tmp_581738 = ((int64_t *) mem_param_586752.mem)[slice_581734];
                                    
                                    loopres_581713 = i_581681;
                                    loopres_581714 = tmp_581735;
                                    loopres_581715 = tmp_581736;
                                    loopres_581717 = tmp_581738;
                                }
                                ((int64_t *) mem_586802)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581714;
                                ((double *) mem_586805)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581715;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586809, i_586236 * lmad_arg_586830 + k_581680 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586749.mem, ext_586862, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
                                ((int64_t *) mem_586812)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581717;
                                
                                int64_t i_tmp_588179 = loopres_581713;
                                
                                i_581681 = i_tmp_588179;
                            }
                            data_581675 = i_581681;
                        }
                        if (memblock_alloc(ctx, &mem_586895, bytes_586801, "mem_586895")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586895.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint64_t *) mem_586802, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_alloc(ctx, &mem_586899, bytes_586801, "mem_586899")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586899.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint64_t *) mem_586805, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_alloc(ctx, &mem_586904, bytes_586808, "mem_586904")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_586904.mem, (int64_t) 0, (int64_t []) {dim_293582 * merge_block_sizze_581132, dim_293582, (int64_t) 1}, (uint64_t *) mem_586809, (int64_t) 0, (int64_t []) {lmad_arg_586830, dim_293582, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132, dim_293582});
                        if (memblock_alloc(ctx, &mem_586908, bytes_586801, "mem_586908")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586908.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint64_t *) mem_586812, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_set(ctx, &ext_mem_586967, &mem_586895, "mem_586895") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586964, &mem_586899, "mem_586899") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586961, &mem_586904, "mem_586904") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586957, &mem_586908, "mem_586908") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586755, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586967.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586967, "ext_mem_586967") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586758, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586964.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586964, "ext_mem_586964") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_586762, i_586249 * lmad_arg_586783, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) ext_mem_586961.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {next_stride_581312, dim_293582});
                    if (memblock_unref(ctx, &ext_mem_586961, "ext_mem_586961") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586765, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586957.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586957, "ext_mem_586957") != 0)
                        return 1;
                }
                
                int64_t flat_dim_581751 = next_stride_581312 * num_merges_581316;
                
                if (memblock_alloc(ctx, &mem_586987, bytes_586754, "mem_586987")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586987.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint64_t *) mem_586755, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                if (memblock_alloc(ctx, &mem_586991, bytes_586754, "mem_586991")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586991.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint64_t *) mem_586758, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                if (memblock_alloc(ctx, &mem_586996, bytes_586761, "mem_586996")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_586996.mem, (int64_t) 0, (int64_t []) {dim_293582 * next_stride_581312, dim_293582, (int64_t) 1}, (uint64_t *) mem_586762, (int64_t) 0, (int64_t []) {lmad_arg_586783, dim_293582, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312, dim_293582});
                if (memblock_alloc(ctx, &mem_587000, bytes_586754, "mem_587000")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587000.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint64_t *) mem_586765, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                
                bool loop_cond_581758 = slt64(next_stride_581312, flat_dim_581126);
                
                if (memblock_set(ctx, &mem_param_tmp_588139, &mem_586987, "mem_586987") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588140, &mem_586991, "mem_586991") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588141, &mem_586996, "mem_586996") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588142, &mem_587000, "mem_587000") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588143 = flat_dim_581751;
                bool loop_while_tmp_588144 = loop_cond_581758;
                int64_t stride_tmp_588149 = next_stride_581312;
                
                if (memblock_set(ctx, &mem_param_586742, &mem_param_tmp_588139, "mem_param_tmp_588139") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586745, &mem_param_tmp_588140, "mem_param_tmp_588140") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586749, &mem_param_tmp_588141, "mem_param_tmp_588141") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586752, &mem_param_tmp_588142, "mem_param_tmp_588142") != 0)
                    return 1;
                loop_dz2084Uz2082U_581305 = loop_dz2084Uz2082U_tmp_588143;
                loop_while_581306 = loop_while_tmp_588144;
                stride_581311 = stride_tmp_588149;
            }
            if (memblock_set(ctx, &ext_mem_587014, &mem_param_586742, "mem_param_586742") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587013, &mem_param_586745, "mem_param_586745") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587012, &mem_param_586749, "mem_param_586749") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587011, &mem_param_586752, "mem_param_586752") != 0)
                return 1;
            data_581298 = loop_dz2084Uz2082U_581305;
            data_581299 = loop_while_581306;
            data_581304 = stride_581311;
            if (memblock_unref(ctx, &mem_586725, "mem_586725") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586729, "mem_586729") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586734, "mem_586734") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586738, "mem_586738") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_581761 = slt64(m_580257, data_581298);
            bool y_581762 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_581761;
            bool ok_or_empty_581763 = empty_slice_580256 || y_581762;
            bool index_certs_581764;
            
            if (!ok_or_empty_581763) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580247, "] out of bounds for array of shape [", (long long) data_581298, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587021, &ext_mem_587012, "ext_mem_587012") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587017, &ext_mem_587011, "ext_mem_587011") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587023, bytes_586456, "mem_587023")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587017.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580247});
        if (memblock_unref(ctx, &ext_mem_587017, "ext_mem_587017") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587026, bytes_586465, "mem_587026")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587026.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) ext_mem_587021.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {m_580247, dim_293582});
        if (memblock_unref(ctx, &ext_mem_587021, "ext_mem_587021") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587463, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587462, &mem_587023, "mem_587023") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586466, "mem_586466") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586468, "mem_586468") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_585820;
    int64_t redout_586254 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586255 = 0; i_586255 < dim_293582; i_586255++) {
        int64_t x_581779 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586255];
        int64_t min_res_581782 = smin64(x_581779, redout_586254);
        int64_t redout_tmp_588184 = min_res_581782;
        
        redout_586254 = redout_tmp_588184;
    }
    defunc_0_reduce_res_585820 = redout_586254;
    
    bool cond_581783 = defunc_0_reduce_res_585820 == (int64_t) 1;
    bool bounds_invalid_upwards_581784 = slt64(total_grid_no_293593, (int64_t) 0);
    bool valid_581785 = !bounds_invalid_upwards_581784;
    bool protect_assert_disj_581786 = cond_581783 || valid_581785;
    bool range_valid_c_581787;
    
    if (!protect_assert_disj_581786) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_293593, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582140 = y_580163 || cond_581783;
    bool index_certs_581794;
    
    if (!protect_assert_disj_582140) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:818:33-56\n   #4  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587464 = (int64_t) 4 * total_grid_no_293593;
    
    if (cond_581783) {
        if (memblock_alloc(ctx, &mem_587501, total_grid_no_293593, "mem_587501")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588185 = 0; nest_i_588185 < total_grid_no_293593; nest_i_588185++) {
            ((bool *) mem_587501.mem)[nest_i_588185] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587504, &mem_587501, "mem_587501") != 0)
            return 1;
    } else {
        if (mem_587465_cached_sizze_588885 < bytes_587464) {
            err = lexical_realloc(ctx, &mem_587465, &mem_587465_cached_sizze_588885, bytes_587464);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588186 = 0; nest_i_588186 < total_grid_no_293593; nest_i_588186++) {
            ((int32_t *) mem_587465)[nest_i_588186] = 0;
        }
        if (mem_587470_cached_sizze_588886 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_587470, &mem_587470_cached_sizze_588886, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586260 = 0; iter_586260 < m_580247; iter_586260++) {
            for (int64_t i_586258 = 0; i_586258 < dim_293582; i_586258++) {
                double eta_p_584529 = ((double *) ext_mem_587463.mem)[iter_586260 * dim_293582 + i_586258];
                double eta_p_584530 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586258];
                double eta_p_584531 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586258];
                int64_t eta_p_584533 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586258];
                double defunc_0_f_res_584534 = eta_p_584529 - eta_p_584530;
                double defunc_0_f_res_584536 = defunc_0_f_res_584534 / eta_p_584531;
                int64_t f64_res_584538 = fptosi_f64_i64(defunc_0_f_res_584536);
                int64_t max_res_584540 = smax64((int64_t) 0, f64_res_584538);
                int64_t zm_lhs_584546 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586258];
                int64_t min_arg1_584547 = sub64(zm_lhs_584546, (int64_t) 1);
                int64_t min_res_584548 = smin64(max_res_584540, min_arg1_584547);
                int64_t defunc_0_f_res_584550 = mul64(eta_p_584533, min_res_584548);
                
                ((int64_t *) mem_587470)[i_586258] = defunc_0_f_res_584550;
            }
            
            int64_t defunc_0_foldl_res_584457;
            int64_t acc_584459 = (int64_t) 0;
            
            for (int64_t i_584458 = 0; i_584458 < dim_293582; i_584458++) {
                int64_t b_584460 = ((int64_t *) mem_587470)[i_584458];
                int64_t defunc_0_f_res_584461 = add64(acc_584459, b_584460);
                int64_t acc_tmp_588189 = defunc_0_f_res_584461;
                
                acc_584459 = acc_tmp_588189;
            }
            defunc_0_foldl_res_584457 = acc_584459;
            
            bool less_than_zzero_586264 = slt64(defunc_0_foldl_res_584457, (int64_t) 0);
            bool greater_than_sizze_586265 = sle64(total_grid_no_293593, defunc_0_foldl_res_584457);
            bool outside_bounds_dim_586266 = less_than_zzero_586264 || greater_than_sizze_586265;
            
            if (!outside_bounds_dim_586266) {
                int32_t read_hist_586268 = ((int32_t *) mem_587465)[defunc_0_foldl_res_584457];
                int32_t defunc_0_op_res_581834 = add32(1, read_hist_586268);
                
                ((int32_t *) mem_587465)[defunc_0_foldl_res_584457] = defunc_0_op_res_581834;
            }
        }
        if (memblock_alloc(ctx, &mem_587480, total_grid_no_293593, "mem_587480")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < total_grid_no_293593; nest_i_588190++) {
            ((bool *) mem_587480.mem)[nest_i_588190] = 0;
        }
        if (mem_587484_cached_sizze_588887 < dim_293582) {
            err = lexical_realloc(ctx, &mem_587484, &mem_587484_cached_sizze_588887, dim_293582);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_581839 = 0; i_581839 < total_grid_no_293593; i_581839++) {
            for (int64_t i_586273 = 0; i_586273 < dim_293582; i_586273++) {
                int64_t eta_p_581842 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586273];
                int64_t eta_p_581843 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586273];
                bool defunc_0_f_res_581844;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_581844, i_581839, eta_p_581842, eta_p_581843) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587484)[i_586273] = defunc_0_f_res_581844;
            }
            
            bool defunc_0_f_res_581845;
            bool acc_581847 = 0;
            
            for (int64_t i_581846 = 0; i_581846 < dim_293582; i_581846++) {
                bool b_581848 = ((bool *) mem_587484)[i_581846];
                bool defunc_0_f_res_581849 = acc_581847 || b_581848;
                bool acc_tmp_588193 = defunc_0_f_res_581849;
                
                acc_581847 = acc_tmp_588193;
            }
            defunc_0_f_res_581845 = acc_581847;
            if (!defunc_0_f_res_581845) {
                bool y_581851 = slt64(i_581839, dz2080U_293583);
                bool index_certs_581852;
                
                if (!y_581851) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581839, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:818:33-56\n   #2  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_581854 = slt64(i_581839, (int64_t) 0);
                bool valid_581855 = !bounds_invalid_upwards_581854;
                bool range_valid_c_581856;
                
                if (!valid_581855) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_581839, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_585801;
                bool redout_586279 = 0;
                
                for (int64_t i_586280 = 0; i_586280 < i_581839; i_586280++) {
                    bool cond_584554 = i_586280 == i_581839;
                    bool cond_584555;
                    
                    if (cond_584554) {
                        cond_584555 = 1;
                    } else {
                        bool y_584557 = slt64(i_586280, total_grid_no_293593);
                        bool index_certs_584559;
                        
                        if (!y_584557) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586280, "] out of bounds for array of shape [", (long long) total_grid_no_293593, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584560 = ((int32_t *) mem_587465)[i_586280];
                        bool cond_f_res_584561 = zeze_lhs_584560 == 0;
                        
                        cond_584555 = cond_f_res_584561;
                    }
                    
                    bool defunc_0_f_res_584562;
                    
                    if (cond_584555) {
                        defunc_0_f_res_584562 = 0;
                    } else {
                        bool y_584564 = slt64(i_586280, dz2080U_293583);
                        bool index_certs_584566;
                        
                        if (!y_584564) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586280, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587491_cached_sizze_588888 < dim_293582) {
                            err = lexical_realloc(ctx, &mem_587491, &mem_587491_cached_sizze_588888, dim_293582);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586277 = 0; i_586277 < dim_293582; i_586277++) {
                            double eta_p_584569 = ((double *) start_of_grid_partition_mem_586416.mem)[i_581839 * dim_293582 + i_586277];
                            double eta_p_584570 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586280 * dim_293582 + i_586277];
                            bool defunc_0_f_res_584571 = eta_p_584570 < eta_p_584569;
                            
                            ((bool *) mem_587491)[i_586277] = defunc_0_f_res_584571;
                        }
                        
                        bool defunc_0_foldl_res_584572;
                        bool acc_584574 = 1;
                        
                        for (int64_t i_584573 = 0; i_584573 < dim_293582; i_584573++) {
                            bool b_584575 = ((bool *) mem_587491)[i_584573];
                            bool x_584576 = acc_584574 && b_584575;
                            bool acc_tmp_588196 = x_584576;
                            
                            acc_584574 = acc_tmp_588196;
                        }
                        defunc_0_foldl_res_584572 = acc_584574;
                        defunc_0_f_res_584562 = defunc_0_foldl_res_584572;
                    }
                    
                    bool defunc_0_op_res_581890 = defunc_0_f_res_584562 || redout_586279;
                    bool redout_tmp_588194 = defunc_0_op_res_581890;
                    
                    redout_586279 = redout_tmp_588194;
                }
                defunc_0_reduce_res_585801 = redout_586279;
                ((bool *) mem_587480.mem)[i_581839] = defunc_0_reduce_res_585801;
            }
        }
        if (memblock_set(ctx, &ext_mem_587504, &mem_587480, "mem_587480") != 0)
            return 1;
    }
    
    bool index_certs_581903;
    
    if (!y_580163) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587506_cached_sizze_588889 < bytes_586483) {
        err = lexical_realloc(ctx, &mem_587506, &mem_587506_cached_sizze_588889, bytes_586483);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586283 = 0; i_586283 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584; i_586283++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581983 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586283];
        double i64_res_581984 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581983);
        double defunc_0_fover_res_581985 = 1.5707963267948966 / i64_res_581984;
        
        ((double *) mem_587506)[i_586283] = defunc_0_fover_res_581985;
    }
    
    bool empty_or_match_cert_581987;
    
    if (!assert_cond_580154) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_582024 = total_angle_no_293592 == (int64_t) 0;
    bool nonzzero_582025 = !zzero_582024;
    bool nonzzero_cert_582026;
    
    if (!nonzzero_582025) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:818:33-56\n   #6  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587514_cached_sizze_588890 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587514, &mem_587514_cached_sizze_588890, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587516_cached_sizze_588891 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587516, &mem_587516_cached_sizze_588891, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587518_cached_sizze_588892 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587518, &mem_587518_cached_sizze_588892, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587529_cached_sizze_588893 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587529, &mem_587529_cached_sizze_588893, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587537_cached_sizze_588894 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587537, &mem_587537_cached_sizze_588894, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587545_cached_sizze_588895 < bytes_586525) {
        err = lexical_realloc(ctx, &mem_587545, &mem_587545_cached_sizze_588895, bytes_586525);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587561_cached_sizze_588897 < bytes_586525) {
        err = lexical_realloc(ctx, &mem_587561, &mem_587561_cached_sizze_588897, bytes_586525);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586312;
    int64_t scanacc_586304 = (int64_t) 0;
    
    for (int64_t i_586308 = 0; i_586308 < m_580247; i_586308++) {
        for (int64_t i_586287 = 0; i_586287 < dim_293582; i_586287++) {
            double eta_p_584659 = ((double *) ext_mem_587463.mem)[i_586308 * dim_293582 + i_586287];
            double eta_p_584660 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586287];
            double eta_p_584661 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586287];
            int64_t eta_p_584663 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586287];
            double defunc_0_f_res_584664 = eta_p_584659 - eta_p_584660;
            double defunc_0_f_res_584666 = defunc_0_f_res_584664 / eta_p_584661;
            int64_t f64_res_584668 = fptosi_f64_i64(defunc_0_f_res_584666);
            int64_t max_res_584670 = smax64((int64_t) 0, f64_res_584668);
            int64_t zm_lhs_584676 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586287];
            int64_t min_arg1_584677 = sub64(zm_lhs_584676, (int64_t) 1);
            int64_t min_res_584678 = smin64(max_res_584670, min_arg1_584677);
            int64_t defunc_0_f_res_584680 = mul64(eta_p_584663, min_res_584678);
            
            ((int64_t *) mem_587529)[i_586287] = defunc_0_f_res_584680;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_293582; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587529)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588203 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588203;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_293583);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_293583, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586291 = 0; i_586291 < dim_293582; i_586291++) {
            double eta_p_582571 = ((double *) ext_mem_587463.mem)[i_586308 * dim_293582 + i_586291];
            double eta_p_582572 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582560 * dim_293582 + i_586291];
            double defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((double *) mem_587537)[i_586291] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588205 = 0; nest_i_588205 < arg_580153; nest_i_588205++) {
            ((double *) mem_587545)[nest_i_588205] = 0.0;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_580153; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_293582);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_293582, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_293582);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_293582);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_293582, "] out of bounds for array of shape [", (long long) dim_293582, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587549 = (int64_t) 8 * j_m_i_582582;
            double this_x_582580 = ((double *) mem_587537)[i_582576];
            
            if (mem_587550_cached_sizze_588896 < bytes_587549) {
                err = lexical_realloc(ctx, &mem_587550, &mem_587550_cached_sizze_588896, bytes_587549);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586295 = 0; i_586295 < j_m_i_582582; i_586295++) {
                int64_t slice_586364 = map_arg1_582581 + i_586295;
                double eta_p_582597 = ((double *) mem_587537)[slice_586364];
                double defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((double *) mem_587550)[i_586295] = defunc_0_ftimes_res_582598;
            }
            
            double defunc_0_foldl_res_582599;
            double acc_582601 = 0.0;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                double b_582602 = ((double *) mem_587550)[i_582600];
                double defunc_0_f_res_582603 = acc_582601 + b_582602;
                double acc_tmp_588208 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588208;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            double sqrt_res_582604 = futrts_sqrt64(defunc_0_foldl_res_582599);
            double atan2_res_582605 = futrts_atan2_64(sqrt_res_582604, this_x_582580);
            
            ((double *) mem_587545)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586299 = 0; i_586299 < arg_580153; i_586299++) {
            double eta_p_582608 = ((double *) mem_587545)[i_586299];
            double eta_p_582609 = ((double *) mem_587506)[i_586299];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586299];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586299];
            double i64_res_582612 = sitofp_i64_f64(eta_p_582610);
            double defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            double defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f64_res_582615 = fptosi_f64_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f64_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f64_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_585806 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_585806;
                } else {
                    defunc_0_f_res_f_res_582619 = f64_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587561)[i_586299] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_580153; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587561)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588210 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588210;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_293592, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_293592);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_293593);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_293593, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:818:33-56\n   #5  ftSkyline.fut:807:17-818:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587504.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_582041 = add64(defunc_0_f_res_582636, scanacc_586304);
        
        ((int64_t *) mem_587514)[i_586308] = defunc_0_op_res_582041;
        ((int64_t *) mem_587516)[i_586308] = defunc_0_f_res_582636;
        ((int64_t *) mem_587518)[i_586308] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588198 = defunc_0_op_res_582041;
        
        scanacc_586304 = scanacc_tmp_588198;
    }
    discard_586312 = scanacc_586304;
    
    bool x_582043 = !empty_slice_580256;
    bool y_582046 = slt64(m_580257, m_580247);
    bool bounds_check_582047 = zzero_leq_i_p_m_t_s_580258 && y_582046;
    bool protect_assert_disj_582048 = empty_slice_580256 || bounds_check_582047;
    bool index_certs_582049;
    
    if (!protect_assert_disj_582048) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_580257, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_582050;
    
    if (x_582043) {
        int64_t x_585811 = ((int64_t *) mem_587514)[m_580257];
        
        m_f_res_582050 = x_585811;
    } else {
        m_f_res_582050 = (int64_t) 0;
    }
    
    int64_t m_582052;
    
    if (empty_slice_580256) {
        m_582052 = (int64_t) 0;
    } else {
        m_582052 = m_f_res_582050;
    }
    
    int64_t m_582063 = sub64(m_582052, (int64_t) 1);
    bool i_p_m_t_s_leq_w_582065 = slt64(m_582063, m_580247);
    bool zzero_leq_i_p_m_t_s_582064 = sle64((int64_t) 0, m_582063);
    bool y_582067 = zzero_leq_i_p_m_t_s_582064 && i_p_m_t_s_leq_w_582065;
    bool i_lte_j_582066 = sle64((int64_t) 0, m_582052);
    bool forwards_ok_582068 = i_lte_j_582066 && y_582067;
    bool eq_x_zz_582059 = (int64_t) 0 == m_f_res_582050;
    bool p_and_eq_x_y_582061 = x_582043 && eq_x_zz_582059;
    bool empty_slice_582062 = empty_slice_580256 || p_and_eq_x_y_582061;
    bool ok_or_empty_582069 = empty_slice_582062 || forwards_ok_582068;
    bool index_certs_582070;
    
    if (!ok_or_empty_582069) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_582052, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587577 = (int64_t) 8 * m_582052;
    int64_t bytes_587578 = dim_293582 * binop_x_587577;
    bool bounds_invalid_upwards_582102 = slt64(total_part_no_293594, (int64_t) 0);
    bool valid_582103 = !bounds_invalid_upwards_582102;
    bool range_valid_c_582104;
    
    if (!valid_582103) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_293594, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:818:33-56\n   #3  ftSkyline.fut:807:17-818:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587606 = (int64_t) 8 * total_part_no_293594;
    
    if (memblock_alloc(ctx, &mem_587579, bytes_587578, "mem_587579")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587579.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (uint64_t *) ext_mem_587463.mem, (int64_t) 0, (int64_t []) {dim_293582, (int64_t) 1}, (int64_t []) {m_582052, dim_293582});
    if (mem_587581_cached_sizze_588898 < binop_x_587577) {
        err = lexical_realloc(ctx, &mem_587581, &mem_587581_cached_sizze_588898, binop_x_587577);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587581, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587518, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582052});
    if (memblock_alloc(ctx, &mem_587583, binop_x_587577, "mem_587583")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587583.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587462.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582052});
    if (mem_587595_cached_sizze_588899 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587595, &mem_587595_cached_sizze_588899, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586313 = 0; write_iter_586313 < m_580247; write_iter_586313++) {
        int64_t write_iv_586317 = ((int64_t *) mem_587516)[write_iter_586313];
        int64_t write_iv_586318 = ((int64_t *) mem_587514)[write_iter_586313];
        int64_t write_iv_586320 = ((int64_t *) ext_mem_587462.mem)[write_iter_586313];
        int64_t write_iv_586321 = ((int64_t *) mem_587518)[write_iter_586313];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587595, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587463.mem, write_iter_586313 * dim_293582, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
        
        bool cond_582515 = write_iv_586317 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_585812 = sub64(write_iv_586318, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_585812;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_293582 - (int64_t) 1, dim_293582))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587579.mem, lifted_lambda_res_582516 * dim_293582, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587595, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_293582});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) {
            ((int64_t *) mem_587583.mem)[lifted_lambda_res_582516] = write_iv_586320;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) {
            ((int64_t *) mem_587581)[lifted_lambda_res_582516] = write_iv_586321;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587462, "ext_mem_587462") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587463, "ext_mem_587463") != 0)
        return 1;
    if (mem_587607_cached_sizze_588900 < bytes_587606) {
        err = lexical_realloc(ctx, &mem_587607, &mem_587607_cached_sizze_588900, bytes_587606);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588214 = 0; nest_i_588214 < total_part_no_293594; nest_i_588214++) {
        ((int64_t *) mem_587607)[nest_i_588214] = (int64_t) 0;
    }
    for (int64_t iter_586325 = 0; iter_586325 < m_582052; iter_586325++) {
        int64_t pixel_586327 = ((int64_t *) mem_587581)[iter_586325];
        bool less_than_zzero_586329 = slt64(pixel_586327, (int64_t) 0);
        bool greater_than_sizze_586330 = sle64(total_part_no_293594, pixel_586327);
        bool outside_bounds_dim_586331 = less_than_zzero_586329 || greater_than_sizze_586330;
        
        if (!outside_bounds_dim_586331) {
            int64_t read_hist_586333 = ((int64_t *) mem_587607)[pixel_586327];
            int64_t defunc_0_op_res_582109 = add64((int64_t) 1, read_hist_586333);
            
            ((int64_t *) mem_587607)[pixel_586327] = defunc_0_op_res_582109;
        }
    }
    if (mem_587615_cached_sizze_588901 < bytes_587606) {
        err = lexical_realloc(ctx, &mem_587615, &mem_587615_cached_sizze_588901, bytes_587606);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586341;
    int64_t scanacc_586337 = (int64_t) 0;
    
    for (int64_t i_586339 = 0; i_586339 < total_part_no_293594; i_586339++) {
        int64_t x_582113 = ((int64_t *) mem_587607)[i_586339];
        int64_t defunc_0_op_res_582116 = add64(x_582113, scanacc_586337);
        
        ((int64_t *) mem_587615)[i_586339] = defunc_0_op_res_582116;
        
        int64_t scanacc_tmp_588216 = defunc_0_op_res_582116;
        
        scanacc_586337 = scanacc_tmp_588216;
    }
    discard_586341 = scanacc_586337;
    if (memblock_alloc(ctx, &mem_587623, bytes_587606, "mem_587623")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586344 = 0; i_586344 < total_part_no_293594; i_586344++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586344);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_293594);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587615)[tmp_582504];
        bool cond_582507 = i_586344 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587623.mem)[i_586344] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587504, "ext_mem_587504") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587623, "mem_587623") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587579, "mem_587579") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587583, "mem_587583") != 0)
        return 1;
    prim_out_588011 = total_grid_no_293593;
    prim_out_588012 = total_part_no_293594;
    prim_out_588013 = m_582052;
    if (memblock_set(ctx, &*mem_out_p_588820, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588821, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588822, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588823, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588824 = prim_out_588011;
    *out_prim_out_588825 = prim_out_588012;
    *out_prim_out_588826 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586419);
        free(mem_586427);
        free(mem_586429);
        free(mem_586436);
        free(mem_586443);
        free(mem_586457);
        free(mem_586484);
        free(mem_586492);
        free(mem_586494);
        free(mem_586502);
        free(mem_586510);
        free(mem_586512);
        free(mem_586526);
        free(mem_586531);
        free(mem_586542);
        free(mem_586568);
        free(mem_586571);
        free(mem_586575);
        free(mem_586578);
        free(mem_586598);
        free(mem_586600);
        free(mem_586603);
        free(mem_586605);
        free(mem_586664);
        free(mem_586666);
        free(mem_586755);
        free(mem_586758);
        free(mem_586762);
        free(mem_586765);
        free(mem_586785);
        free(mem_586787);
        free(mem_586802);
        free(mem_586805);
        free(mem_586809);
        free(mem_586812);
        free(mem_587028);
        free(mem_587036);
        free(mem_587041);
        free(mem_587049);
        free(mem_587057);
        free(mem_587062);
        free(mem_587073);
        free(mem_587096);
        free(mem_587100);
        free(mem_587103);
        free(mem_587119);
        free(mem_587122);
        free(mem_587124);
        free(mem_587171);
        free(mem_587173);
        free(mem_587242);
        free(mem_587246);
        free(mem_587249);
        free(mem_587265);
        free(mem_587267);
        free(mem_587282);
        free(mem_587286);
        free(mem_587289);
        free(mem_587465);
        free(mem_587470);
        free(mem_587484);
        free(mem_587491);
        free(mem_587506);
        free(mem_587514);
        free(mem_587516);
        free(mem_587518);
        free(mem_587529);
        free(mem_587537);
        free(mem_587545);
        free(mem_587550);
        free(mem_587561);
        free(mem_587581);
        free(mem_587595);
        free(mem_587607);
        free(mem_587615);
        if (memblock_unref(ctx, &mem_587623, "mem_587623") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587583, "mem_587583") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587579, "mem_587579") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587480, "mem_587480") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587501, "mem_587501") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587504, "ext_mem_587504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587023, "mem_587023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588142, "mem_param_tmp_588142") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588141, "mem_param_tmp_588141") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588140, "mem_param_tmp_588140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588139, "mem_param_tmp_588139") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587000, "mem_587000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586996, "mem_586996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586991, "mem_586991") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586987, "mem_586987") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586908, "mem_586908") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586904, "mem_586904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586899, "mem_586899") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586895, "mem_586895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586923, "mem_586923") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586920, "mem_586920") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586918, "mem_586918") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586916, "mem_586916") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586957, "ext_mem_586957") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586961, "ext_mem_586961") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586964, "ext_mem_586964") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586967, "ext_mem_586967") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586752, "mem_param_586752") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586749, "mem_param_586749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586745, "mem_param_586745") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586742, "mem_param_586742") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587011, "ext_mem_587011") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587012, "ext_mem_587012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587013, "ext_mem_587013") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587014, "ext_mem_587014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586738, "mem_586738") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586734, "mem_586734") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586729, "mem_586729") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586725, "mem_586725") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586623, "ext_mem_586623") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588115, "mem_param_tmp_588115") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586562, "ext_mem_586562") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586557, "mem_param_586557") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586565, "ext_mem_586565") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587017, "ext_mem_587017") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587021, "ext_mem_587021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587461, "mem_587461") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587458, "mem_587458") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588066, "mem_param_tmp_588066") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588065, "mem_param_tmp_588065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588064, "mem_param_tmp_588064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587438, "mem_587438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587434, "mem_587434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587429, "mem_587429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587365, "mem_587365") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587361, "mem_587361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587356, "mem_587356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587378, "mem_587378") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587375, "mem_587375") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587373, "mem_587373") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587406, "ext_mem_587406") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587410, "ext_mem_587410") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587413, "ext_mem_587413") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587239, "mem_param_587239") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587236, "mem_param_587236") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587232, "mem_param_587232") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587447, "ext_mem_587447") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587449, "ext_mem_587449") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587228, "mem_587228") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587224, "mem_587224") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587219, "mem_587219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587139, "ext_mem_587139") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588045, "mem_param_tmp_588045") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587090, "ext_mem_587090") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587085, "mem_param_587085") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587093, "ext_mem_587093") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587452, "ext_mem_587452") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587456, "ext_mem_587456") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587462, "ext_mem_587462") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587463, "ext_mem_587463") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586468, "mem_586468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586466, "mem_586466") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_588902, struct memblock *mem_out_p_588903, struct memblock *mem_out_p_588904, struct memblock *mem_out_p_588905, int64_t *out_prim_out_588906, int64_t *out_prim_out_588907, int64_t *out_prim_out_588908, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_457918, int64_t dz2080U_457919, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920, int64_t n_457921, int64_t total_angle_no_457928, int64_t total_grid_no_457929, int64_t total_part_no_457930, int64_t offset_457932, bool use_measure_for_sorting_457933)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586419_cached_sizze_588909 = 0;
    unsigned char *mem_586419 = NULL;
    int64_t mem_586427_cached_sizze_588910 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586429_cached_sizze_588911 = 0;
    unsigned char *mem_586429 = NULL;
    int64_t mem_586436_cached_sizze_588912 = 0;
    unsigned char *mem_586436 = NULL;
    int64_t mem_586443_cached_sizze_588913 = 0;
    unsigned char *mem_586443 = NULL;
    int64_t mem_586457_cached_sizze_588914 = 0;
    unsigned char *mem_586457 = NULL;
    int64_t mem_586484_cached_sizze_588915 = 0;
    unsigned char *mem_586484 = NULL;
    int64_t mem_586492_cached_sizze_588916 = 0;
    unsigned char *mem_586492 = NULL;
    int64_t mem_586494_cached_sizze_588917 = 0;
    unsigned char *mem_586494 = NULL;
    int64_t mem_586502_cached_sizze_588918 = 0;
    unsigned char *mem_586502 = NULL;
    int64_t mem_586510_cached_sizze_588919 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586512_cached_sizze_588920 = 0;
    unsigned char *mem_586512 = NULL;
    int64_t mem_586526_cached_sizze_588921 = 0;
    unsigned char *mem_586526 = NULL;
    int64_t mem_586531_cached_sizze_588922 = 0;
    unsigned char *mem_586531 = NULL;
    int64_t mem_586542_cached_sizze_588923 = 0;
    unsigned char *mem_586542 = NULL;
    int64_t mem_586568_cached_sizze_588924 = 0;
    unsigned char *mem_586568 = NULL;
    int64_t mem_586571_cached_sizze_588925 = 0;
    unsigned char *mem_586571 = NULL;
    int64_t mem_586575_cached_sizze_588926 = 0;
    unsigned char *mem_586575 = NULL;
    int64_t mem_586578_cached_sizze_588927 = 0;
    unsigned char *mem_586578 = NULL;
    int64_t mem_586598_cached_sizze_588928 = 0;
    unsigned char *mem_586598 = NULL;
    int64_t mem_586600_cached_sizze_588929 = 0;
    unsigned char *mem_586600 = NULL;
    int64_t mem_586603_cached_sizze_588930 = 0;
    unsigned char *mem_586603 = NULL;
    int64_t mem_586605_cached_sizze_588931 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586664_cached_sizze_588932 = 0;
    unsigned char *mem_586664 = NULL;
    int64_t mem_586666_cached_sizze_588933 = 0;
    unsigned char *mem_586666 = NULL;
    int64_t mem_586755_cached_sizze_588934 = 0;
    unsigned char *mem_586755 = NULL;
    int64_t mem_586758_cached_sizze_588935 = 0;
    unsigned char *mem_586758 = NULL;
    int64_t mem_586762_cached_sizze_588936 = 0;
    unsigned char *mem_586762 = NULL;
    int64_t mem_586765_cached_sizze_588937 = 0;
    unsigned char *mem_586765 = NULL;
    int64_t mem_586785_cached_sizze_588938 = 0;
    unsigned char *mem_586785 = NULL;
    int64_t mem_586787_cached_sizze_588939 = 0;
    unsigned char *mem_586787 = NULL;
    int64_t mem_586802_cached_sizze_588940 = 0;
    unsigned char *mem_586802 = NULL;
    int64_t mem_586805_cached_sizze_588941 = 0;
    unsigned char *mem_586805 = NULL;
    int64_t mem_586809_cached_sizze_588942 = 0;
    unsigned char *mem_586809 = NULL;
    int64_t mem_586812_cached_sizze_588943 = 0;
    unsigned char *mem_586812 = NULL;
    int64_t mem_587028_cached_sizze_588944 = 0;
    unsigned char *mem_587028 = NULL;
    int64_t mem_587036_cached_sizze_588945 = 0;
    unsigned char *mem_587036 = NULL;
    int64_t mem_587041_cached_sizze_588946 = 0;
    unsigned char *mem_587041 = NULL;
    int64_t mem_587049_cached_sizze_588947 = 0;
    unsigned char *mem_587049 = NULL;
    int64_t mem_587057_cached_sizze_588948 = 0;
    unsigned char *mem_587057 = NULL;
    int64_t mem_587062_cached_sizze_588949 = 0;
    unsigned char *mem_587062 = NULL;
    int64_t mem_587073_cached_sizze_588950 = 0;
    unsigned char *mem_587073 = NULL;
    int64_t mem_587096_cached_sizze_588951 = 0;
    unsigned char *mem_587096 = NULL;
    int64_t mem_587100_cached_sizze_588952 = 0;
    unsigned char *mem_587100 = NULL;
    int64_t mem_587103_cached_sizze_588953 = 0;
    unsigned char *mem_587103 = NULL;
    int64_t mem_587119_cached_sizze_588954 = 0;
    unsigned char *mem_587119 = NULL;
    int64_t mem_587122_cached_sizze_588955 = 0;
    unsigned char *mem_587122 = NULL;
    int64_t mem_587124_cached_sizze_588956 = 0;
    unsigned char *mem_587124 = NULL;
    int64_t mem_587171_cached_sizze_588957 = 0;
    unsigned char *mem_587171 = NULL;
    int64_t mem_587173_cached_sizze_588958 = 0;
    unsigned char *mem_587173 = NULL;
    int64_t mem_587242_cached_sizze_588959 = 0;
    unsigned char *mem_587242 = NULL;
    int64_t mem_587246_cached_sizze_588960 = 0;
    unsigned char *mem_587246 = NULL;
    int64_t mem_587249_cached_sizze_588961 = 0;
    unsigned char *mem_587249 = NULL;
    int64_t mem_587265_cached_sizze_588962 = 0;
    unsigned char *mem_587265 = NULL;
    int64_t mem_587267_cached_sizze_588963 = 0;
    unsigned char *mem_587267 = NULL;
    int64_t mem_587282_cached_sizze_588964 = 0;
    unsigned char *mem_587282 = NULL;
    int64_t mem_587286_cached_sizze_588965 = 0;
    unsigned char *mem_587286 = NULL;
    int64_t mem_587289_cached_sizze_588966 = 0;
    unsigned char *mem_587289 = NULL;
    int64_t mem_587465_cached_sizze_588967 = 0;
    unsigned char *mem_587465 = NULL;
    int64_t mem_587470_cached_sizze_588968 = 0;
    unsigned char *mem_587470 = NULL;
    int64_t mem_587484_cached_sizze_588969 = 0;
    unsigned char *mem_587484 = NULL;
    int64_t mem_587491_cached_sizze_588970 = 0;
    unsigned char *mem_587491 = NULL;
    int64_t mem_587506_cached_sizze_588971 = 0;
    unsigned char *mem_587506 = NULL;
    int64_t mem_587514_cached_sizze_588972 = 0;
    unsigned char *mem_587514 = NULL;
    int64_t mem_587516_cached_sizze_588973 = 0;
    unsigned char *mem_587516 = NULL;
    int64_t mem_587518_cached_sizze_588974 = 0;
    unsigned char *mem_587518 = NULL;
    int64_t mem_587529_cached_sizze_588975 = 0;
    unsigned char *mem_587529 = NULL;
    int64_t mem_587537_cached_sizze_588976 = 0;
    unsigned char *mem_587537 = NULL;
    int64_t mem_587545_cached_sizze_588977 = 0;
    unsigned char *mem_587545 = NULL;
    int64_t mem_587550_cached_sizze_588978 = 0;
    unsigned char *mem_587550 = NULL;
    int64_t mem_587561_cached_sizze_588979 = 0;
    unsigned char *mem_587561 = NULL;
    int64_t mem_587581_cached_sizze_588980 = 0;
    unsigned char *mem_587581 = NULL;
    int64_t mem_587595_cached_sizze_588981 = 0;
    unsigned char *mem_587595 = NULL;
    int64_t mem_587607_cached_sizze_588982 = 0;
    unsigned char *mem_587607 = NULL;
    int64_t mem_587615_cached_sizze_588983 = 0;
    unsigned char *mem_587615 = NULL;
    struct memblock mem_587623;
    
    mem_587623.references = NULL;
    
    struct memblock mem_587583;
    
    mem_587583.references = NULL;
    
    struct memblock mem_587579;
    
    mem_587579.references = NULL;
    
    struct memblock mem_587480;
    
    mem_587480.references = NULL;
    
    struct memblock mem_587501;
    
    mem_587501.references = NULL;
    
    struct memblock ext_mem_587504;
    
    ext_mem_587504.references = NULL;
    
    struct memblock mem_587026;
    
    mem_587026.references = NULL;
    
    struct memblock mem_587023;
    
    mem_587023.references = NULL;
    
    struct memblock mem_param_tmp_588142;
    
    mem_param_tmp_588142.references = NULL;
    
    struct memblock mem_param_tmp_588141;
    
    mem_param_tmp_588141.references = NULL;
    
    struct memblock mem_param_tmp_588140;
    
    mem_param_tmp_588140.references = NULL;
    
    struct memblock mem_param_tmp_588139;
    
    mem_param_tmp_588139.references = NULL;
    
    struct memblock mem_587000;
    
    mem_587000.references = NULL;
    
    struct memblock mem_586996;
    
    mem_586996.references = NULL;
    
    struct memblock mem_586991;
    
    mem_586991.references = NULL;
    
    struct memblock mem_586987;
    
    mem_586987.references = NULL;
    
    struct memblock mem_586908;
    
    mem_586908.references = NULL;
    
    struct memblock mem_586904;
    
    mem_586904.references = NULL;
    
    struct memblock mem_586899;
    
    mem_586899.references = NULL;
    
    struct memblock mem_586895;
    
    mem_586895.references = NULL;
    
    struct memblock mem_586923;
    
    mem_586923.references = NULL;
    
    struct memblock mem_586920;
    
    mem_586920.references = NULL;
    
    struct memblock mem_586918;
    
    mem_586918.references = NULL;
    
    struct memblock mem_586916;
    
    mem_586916.references = NULL;
    
    struct memblock ext_mem_586957;
    
    ext_mem_586957.references = NULL;
    
    struct memblock ext_mem_586961;
    
    ext_mem_586961.references = NULL;
    
    struct memblock ext_mem_586964;
    
    ext_mem_586964.references = NULL;
    
    struct memblock ext_mem_586967;
    
    ext_mem_586967.references = NULL;
    
    struct memblock mem_param_586752;
    
    mem_param_586752.references = NULL;
    
    struct memblock mem_param_586749;
    
    mem_param_586749.references = NULL;
    
    struct memblock mem_param_586745;
    
    mem_param_586745.references = NULL;
    
    struct memblock mem_param_586742;
    
    mem_param_586742.references = NULL;
    
    struct memblock ext_mem_587011;
    
    ext_mem_587011.references = NULL;
    
    struct memblock ext_mem_587012;
    
    ext_mem_587012.references = NULL;
    
    struct memblock ext_mem_587013;
    
    ext_mem_587013.references = NULL;
    
    struct memblock ext_mem_587014;
    
    ext_mem_587014.references = NULL;
    
    struct memblock mem_586738;
    
    mem_586738.references = NULL;
    
    struct memblock mem_586734;
    
    mem_586734.references = NULL;
    
    struct memblock mem_586729;
    
    mem_586729.references = NULL;
    
    struct memblock mem_586725;
    
    mem_586725.references = NULL;
    
    struct memblock ext_mem_586623;
    
    ext_mem_586623.references = NULL;
    
    struct memblock mem_param_tmp_588115;
    
    mem_param_tmp_588115.references = NULL;
    
    struct memblock ext_mem_586562;
    
    ext_mem_586562.references = NULL;
    
    struct memblock mem_param_586557;
    
    mem_param_586557.references = NULL;
    
    struct memblock ext_mem_586565;
    
    ext_mem_586565.references = NULL;
    
    struct memblock ext_mem_587017;
    
    ext_mem_587017.references = NULL;
    
    struct memblock ext_mem_587021;
    
    ext_mem_587021.references = NULL;
    
    struct memblock mem_587461;
    
    mem_587461.references = NULL;
    
    struct memblock mem_587458;
    
    mem_587458.references = NULL;
    
    struct memblock mem_param_tmp_588066;
    
    mem_param_tmp_588066.references = NULL;
    
    struct memblock mem_param_tmp_588065;
    
    mem_param_tmp_588065.references = NULL;
    
    struct memblock mem_param_tmp_588064;
    
    mem_param_tmp_588064.references = NULL;
    
    struct memblock mem_587438;
    
    mem_587438.references = NULL;
    
    struct memblock mem_587434;
    
    mem_587434.references = NULL;
    
    struct memblock mem_587429;
    
    mem_587429.references = NULL;
    
    struct memblock mem_587365;
    
    mem_587365.references = NULL;
    
    struct memblock mem_587361;
    
    mem_587361.references = NULL;
    
    struct memblock mem_587356;
    
    mem_587356.references = NULL;
    
    struct memblock mem_587378;
    
    mem_587378.references = NULL;
    
    struct memblock mem_587375;
    
    mem_587375.references = NULL;
    
    struct memblock mem_587373;
    
    mem_587373.references = NULL;
    
    struct memblock ext_mem_587406;
    
    ext_mem_587406.references = NULL;
    
    struct memblock ext_mem_587410;
    
    ext_mem_587410.references = NULL;
    
    struct memblock ext_mem_587413;
    
    ext_mem_587413.references = NULL;
    
    struct memblock mem_param_587239;
    
    mem_param_587239.references = NULL;
    
    struct memblock mem_param_587236;
    
    mem_param_587236.references = NULL;
    
    struct memblock mem_param_587232;
    
    mem_param_587232.references = NULL;
    
    struct memblock ext_mem_587447;
    
    ext_mem_587447.references = NULL;
    
    struct memblock ext_mem_587448;
    
    ext_mem_587448.references = NULL;
    
    struct memblock ext_mem_587449;
    
    ext_mem_587449.references = NULL;
    
    struct memblock mem_587228;
    
    mem_587228.references = NULL;
    
    struct memblock mem_587224;
    
    mem_587224.references = NULL;
    
    struct memblock mem_587219;
    
    mem_587219.references = NULL;
    
    struct memblock ext_mem_587139;
    
    ext_mem_587139.references = NULL;
    
    struct memblock mem_param_tmp_588045;
    
    mem_param_tmp_588045.references = NULL;
    
    struct memblock ext_mem_587090;
    
    ext_mem_587090.references = NULL;
    
    struct memblock mem_param_587085;
    
    mem_param_587085.references = NULL;
    
    struct memblock ext_mem_587093;
    
    ext_mem_587093.references = NULL;
    
    struct memblock ext_mem_587452;
    
    ext_mem_587452.references = NULL;
    
    struct memblock ext_mem_587456;
    
    ext_mem_587456.references = NULL;
    
    struct memblock ext_mem_587462;
    
    ext_mem_587462.references = NULL;
    
    struct memblock ext_mem_587463;
    
    ext_mem_587463.references = NULL;
    
    struct memblock mem_586468;
    
    mem_586468.references = NULL;
    
    struct memblock mem_586466;
    
    mem_586466.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_580153 = sub64(dim_457918, (int64_t) 1);
    bool assert_cond_580154 = arg_580153 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920;
    bool assert_c_580155;
    
    if (!assert_cond_580154) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool y_580163 = slt64((int64_t) 0, dz2080U_457919);
    bool index_certs_580164;
    
    if (!y_580163) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:319:59-89\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586418 = (int64_t) 4 * dim_457918;
    
    if (mem_586419_cached_sizze_588909 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_586419, &mem_586419_cached_sizze_588909, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t defunc_0_reduce_comm_res_585813;
    float defunc_0_reduce_comm_res_585814;
    int64_t redout_586052;
    float redout_586053;
    
    redout_586052 = n_457921;
    redout_586053 = INFINITY;
    for (int64_t i_586054 = 0; i_586054 < n_457921; i_586054++) {
        for (int64_t i_586050 = 0; i_586050 < dim_457918; i_586050++) {
            float eta_p_582717 = ((float *) xs_mem_586417.mem)[i_586054 * dim_457918 + i_586050];
            float eta_p_582718 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586050];
            float defunc_0_f_res_582719 = eta_p_582717 - eta_p_582718;
            float defunc_0_ftimes_res_582721 = defunc_0_f_res_582719 * defunc_0_f_res_582719;
            
            ((float *) mem_586419)[i_586050] = defunc_0_ftimes_res_582721;
        }
        
        float defunc_0_f_res_582710;
        float acc_582712 = 0.0F;
        
        for (int64_t i_582711 = 0; i_582711 < dim_457918; i_582711++) {
            float b_582713 = ((float *) mem_586419)[i_582711];
            float defunc_0_f_res_582714 = acc_582712 + b_582713;
            float acc_tmp_588017 = defunc_0_f_res_582714;
            
            acc_582712 = acc_tmp_588017;
        }
        defunc_0_f_res_582710 = acc_582712;
        
        bool zl_res_580193 = redout_586053 < defunc_0_f_res_582710;
        bool zeze_res_580194 = redout_586053 == defunc_0_f_res_582710;
        bool cond_f_res_t_res_580195 = slt64(redout_586052, i_586054);
        bool x_580196 = zeze_res_580194 && cond_f_res_t_res_580195;
        bool x_580197 = !zl_res_580193;
        bool y_580198 = x_580196 && x_580197;
        bool cond_580199 = zl_res_580193 || y_580198;
        int64_t defunc_0_op_res_580200;
        
        if (cond_580199) {
            defunc_0_op_res_580200 = redout_586052;
        } else {
            defunc_0_op_res_580200 = i_586054;
        }
        
        float defunc_0_op_res_580201;
        
        if (cond_580199) {
            defunc_0_op_res_580201 = redout_586053;
        } else {
            defunc_0_op_res_580201 = defunc_0_f_res_582710;
        }
        
        int64_t redout_tmp_588014 = defunc_0_op_res_580200;
        float redout_tmp_588015 = defunc_0_op_res_580201;
        
        redout_586052 = redout_tmp_588014;
        redout_586053 = redout_tmp_588015;
    }
    defunc_0_reduce_comm_res_585813 = redout_586052;
    defunc_0_reduce_comm_res_585814 = redout_586053;
    
    bool x_580202 = sle64((int64_t) 0, defunc_0_reduce_comm_res_585813);
    bool y_580203 = slt64(defunc_0_reduce_comm_res_585813, n_457921);
    bool bounds_check_580204 = x_580202 && y_580203;
    bool index_certs_580205;
    
    if (!bounds_check_580204) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_reduce_comm_res_585813, "] out of bounds for array of shape [", (long long) n_457921, "].", "-> #0  ftSkyline.fut:324:20-34\n   #1  ftSkyline.fut:360:65-67\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586426 = (int64_t) 8 * n_457921;
    
    if (mem_586427_cached_sizze_588910 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_588910, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586429_cached_sizze_588911 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_586429, &mem_586429_cached_sizze_588911, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_586436_cached_sizze_588912 < dim_457918) {
        err = lexical_realloc(ctx, &mem_586436, &mem_586436_cached_sizze_588912, dim_457918);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586071;
    int64_t scanacc_586065 = (int64_t) 0;
    
    for (int64_t i_586068 = 0; i_586068 < n_457921; i_586068++) {
        for (int64_t i_586057 = 0; i_586057 < dim_457918; i_586057++) {
            float eta_p_582654 = ((float *) xs_mem_586417.mem)[i_586068 * dim_457918 + i_586057];
            float eta_p_582655 = ((float *) xs_mem_586417.mem)[defunc_0_reduce_comm_res_585813 * dim_457918 + i_586057];
            bool defunc_0_f_res_582656 = eta_p_582655 <= eta_p_582654;
            
            ((bool *) mem_586436)[i_586057] = defunc_0_f_res_582656;
        }
        
        bool defunc_0_foldl_res_582657;
        bool acc_582659 = 1;
        
        for (int64_t i_582658 = 0; i_582658 < dim_457918; i_582658++) {
            bool b_582660 = ((bool *) mem_586436)[i_582658];
            bool x_582661 = acc_582659 && b_582660;
            bool acc_tmp_588022 = x_582661;
            
            acc_582659 = acc_tmp_588022;
        }
        defunc_0_foldl_res_582657 = acc_582659;
        
        bool defunc_0_f_res_582662;
        
        if (defunc_0_foldl_res_582657) {
            if (mem_586443_cached_sizze_588913 < dim_457918) {
                err = lexical_realloc(ctx, &mem_586443, &mem_586443_cached_sizze_588913, dim_457918);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586061 = 0; i_586061 < dim_457918; i_586061++) {
                float eta_p_584696 = ((float *) xs_mem_586417.mem)[i_586068 * dim_457918 + i_586061];
                float eta_p_584697 = ((float *) xs_mem_586417.mem)[defunc_0_reduce_comm_res_585813 * dim_457918 + i_586061];
                bool defunc_0_f_res_584698 = eta_p_584697 < eta_p_584696;
                
                ((bool *) mem_586443)[i_586061] = defunc_0_f_res_584698;
            }
            
            bool defunc_0_foldl_res_584700;
            bool acc_584702 = 0;
            
            for (int64_t i_584701 = 0; i_584701 < dim_457918; i_584701++) {
                bool b_584703 = ((bool *) mem_586443)[i_584701];
                bool defunc_0_f_res_584704 = acc_584702 || b_584703;
                bool acc_tmp_588024 = defunc_0_f_res_584704;
                
                acc_584702 = acc_tmp_588024;
            }
            defunc_0_foldl_res_584700 = acc_584702;
            defunc_0_f_res_582662 = defunc_0_foldl_res_584700;
        } else {
            defunc_0_f_res_582662 = 0;
        }
        
        bool lifted_lambda_res_582673 = !defunc_0_f_res_582662;
        int64_t defunc_0_f_res_582674 = btoi_bool_i64(lifted_lambda_res_582673);
        int64_t defunc_0_op_res_580236 = add64(defunc_0_f_res_582674, scanacc_586065);
        
        ((int64_t *) mem_586427)[i_586068] = defunc_0_op_res_580236;
        ((int64_t *) mem_586429)[i_586068] = defunc_0_f_res_582674;
        
        int64_t scanacc_tmp_588018 = defunc_0_op_res_580236;
        
        scanacc_586065 = scanacc_tmp_588018;
    }
    discard_586071 = scanacc_586065;
    
    bool cond_580237 = n_457921 == (int64_t) 0;
    bool x_580238 = !cond_580237;
    int64_t tmp_580239 = sub64(n_457921, (int64_t) 1);
    bool x_580240 = sle64((int64_t) 0, tmp_580239);
    bool y_580241 = slt64(tmp_580239, n_457921);
    bool bounds_check_580242 = x_580240 && y_580241;
    bool protect_assert_disj_580243 = cond_580237 || bounds_check_580242;
    bool index_certs_580244;
    
    if (!protect_assert_disj_580243) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_580239, "] out of bounds for array of shape [", (long long) n_457921, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_580245;
    
    if (x_580238) {
        int64_t x_584706 = ((int64_t *) mem_586427)[tmp_580239];
        
        m_f_res_580245 = x_584706;
    } else {
        m_f_res_580245 = (int64_t) 0;
    }
    
    int64_t m_580247;
    
    if (cond_580237) {
        m_580247 = (int64_t) 0;
    } else {
        m_580247 = m_f_res_580245;
    }
    
    int64_t m_580257 = sub64(m_580247, (int64_t) 1);
    bool i_p_m_t_s_leq_w_580259 = slt64(m_580257, n_457921);
    bool zzero_leq_i_p_m_t_s_580258 = sle64((int64_t) 0, m_580257);
    bool y_580261 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_580259;
    bool i_lte_j_580260 = sle64((int64_t) 0, m_580247);
    bool forwards_ok_580262 = i_lte_j_580260 && y_580261;
    bool eq_x_zz_580254 = (int64_t) 0 == m_f_res_580245;
    bool p_and_eq_x_y_580255 = x_580238 && eq_x_zz_580254;
    bool empty_slice_580256 = cond_580237 || p_and_eq_x_y_580255;
    bool ok_or_empty_580263 = empty_slice_580256 || forwards_ok_580262;
    bool index_certs_580264;
    
    if (!ok_or_empty_580263) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_580247, "] out of bounds for array of shape [", (long long) n_457921, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:360:65-67\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586456 = (int64_t) 8 * m_580247;
    
    if (mem_586457_cached_sizze_588914 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_586457, &mem_586457_cached_sizze_588914, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_588025 = 0; i_588025 < m_580247; i_588025++) {
        int64_t x_588026 = (int64_t) 0 + i_588025 * (int64_t) 1;
        
        ((int64_t *) mem_586457)[i_588025] = x_588026;
    }
    for (int64_t write_iter_586072 = 0; write_iter_586072 < n_457921; write_iter_586072++) {
        int64_t write_iv_586074 = ((int64_t *) mem_586429)[write_iter_586072];
        int64_t write_iv_586075 = ((int64_t *) mem_586427)[write_iter_586072];
        bool cond_582642 = write_iv_586074 == (int64_t) 1;
        int64_t lifted_lambda_res_582643;
        
        if (cond_582642) {
            int64_t lifted_lambda_res_t_res_584707 = sub64(write_iv_586075, (int64_t) 1);
            
            lifted_lambda_res_582643 = lifted_lambda_res_t_res_584707;
        } else {
            lifted_lambda_res_582643 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582643) && slt64(lifted_lambda_res_582643, m_580247)) {
            ((int64_t *) mem_586457)[lifted_lambda_res_582643] = write_iter_586072;
        }
    }
    
    int64_t binop_x_586464 = (int64_t) 4 * m_580247;
    int64_t bytes_586465 = dim_457918 * binop_x_586464;
    
    if (memblock_alloc(ctx, &mem_586466, bytes_586465, "mem_586466")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_586468, bytes_586456, "mem_586468")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586082 = 0; i_586082 < m_580247; i_586082++) {
        int64_t eta_p_580271 = ((int64_t *) mem_586457)[i_586082];
        bool x_580272 = sle64((int64_t) 0, eta_p_580271);
        bool y_580273 = slt64(eta_p_580271, n_457921);
        bool bounds_check_580274 = x_580272 && y_580273;
        bool index_certs_580275;
        
        if (!bounds_check_580274) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_580271, "] out of bounds for array of shape [", (long long) n_457921, "].", "-> #0  ftSkyline.fut:334:49-54\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:334:37-62\n   #3  ftSkyline.fut:360:65-67\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t index_primexp_582217 = add64(offset_457932, eta_p_580271);
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_586466.mem, i_586082 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) xs_mem_586417.mem, eta_p_580271 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
        ((int64_t *) mem_586468.mem)[i_586082] = index_primexp_582217;
    }
    
    bool cond_580278 = !use_measure_for_sorting_457933;
    bool protect_assert_disj_582196 = y_580163 || cond_580278;
    bool index_certs_580975;
    
    if (!protect_assert_disj_582196) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582198 = assert_cond_580154 || cond_580278;
    bool empty_or_match_cert_581068;
    
    if (!protect_assert_disj_582198) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581099 = sle64(m_580247, (int64_t) 1);
    bool x_581100 = !cond_581099;
    int64_t zp_rhs_581102 = sdiv_safe64(m_580257, (int64_t) 20);
    int64_t min_num_blocks_581103 = add64((int64_t) 1, zp_rhs_581102);
    bool loop_cond_581104 = slt64((int64_t) 1, min_num_blocks_581103);
    bool x_582199;
    int64_t x_582200;
    bool loop_while_581107;
    int64_t x_581108;
    
    loop_while_581107 = loop_cond_581104;
    x_581108 = (int64_t) 1;
    while (loop_while_581107) {
        int64_t loopres_581109 = mul64((int64_t) 2, x_581108);
        bool loop_cond_581110 = slt64(loopres_581109, min_num_blocks_581103);
        bool loop_while_tmp_588030 = loop_cond_581110;
        int64_t x_tmp_588031 = loopres_581109;
        
        loop_while_581107 = loop_while_tmp_588030;
        x_581108 = x_tmp_588031;
    }
    x_582199 = loop_while_581107;
    x_582200 = x_581108;
    
    bool zzero_581111 = x_582200 == (int64_t) 0;
    bool nonzzero_581112 = !zzero_581111;
    bool protect_assert_disj_581113 = cond_581099 || nonzzero_581112;
    bool protect_assert_disj_582204 = cond_580278 || protect_assert_disj_581113;
    bool nonzzero_cert_581114;
    
    if (!protect_assert_disj_582204) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_581115 = sdiv_safe64(m_580257, x_582200);
    int64_t block_sizze_581116 = add64((int64_t) 1, zp_rhs_581115);
    bool y_581117 = slt64((int64_t) 0, m_580247);
    bool protect_assert_disj_581118 = cond_581099 || y_581117;
    bool protect_assert_disj_582206 = cond_580278 || protect_assert_disj_581118;
    bool index_certs_581119;
    
    if (!protect_assert_disj_582206) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582207 = use_measure_for_sorting_457933 && x_581100;
    int64_t reduce_arg1_581124;
    
    if (protect_cond_conj_582207) {
        int64_t x_584708 = ((int64_t *) mem_586468.mem)[(int64_t) 0];
        
        reduce_arg1_581124 = x_584708;
    } else {
        reduce_arg1_581124 = (int64_t) 0;
    }
    
    int64_t flat_dim_581126 = block_sizze_581116 * x_582200;
    int64_t greatest_divisor_leq_than_arg1_581131 = mul64((int64_t) 2, block_sizze_581116);
    int64_t merge_block_sizze_581132;
    
    if (protect_cond_conj_582207) {
        int64_t x_584709;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584709, (int64_t) 8, greatest_divisor_leq_than_arg1_581131) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_581132 = x_584709;
    } else {
        merge_block_sizze_581132 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_581161 = slt64(x_582200, (int64_t) 0);
    bool valid_581162 = !bounds_invalid_upwards_581161;
    bool protect_assert_disj_582188 = cond_581099 || valid_581162;
    bool protect_assert_disj_582210 = cond_580278 || protect_assert_disj_582188;
    bool range_valid_c_581163;
    
    if (!protect_assert_disj_582210) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582200, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:965:33-56\n   #6  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_581165 = slt64(block_sizze_581116, (int64_t) 0);
    bool valid_581166 = !bounds_invalid_upwards_581165;
    bool protect_assert_disj_582190 = cond_581099 || valid_581166;
    bool protect_assert_disj_582212 = cond_580278 || protect_assert_disj_582190;
    bool range_valid_c_581167;
    
    if (!protect_assert_disj_582212) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_581116, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_581169 = sle64(block_sizze_581116, (int64_t) 1);
    int64_t tmp_581170 = sub64(block_sizze_581116, (int64_t) 2);
    bool bounds_invalid_upwards_581171 = slt64(tmp_581170, (int64_t) 0);
    int64_t distance_581172 = add64((int64_t) 1, tmp_581170);
    bool valid_581173 = !bounds_invalid_upwards_581171;
    bool protect_assert_disj_581174 = cond_581169 || valid_581173;
    bool protect_assert_disj_582192 = cond_581099 || protect_assert_disj_581174;
    bool protect_assert_disj_582214 = cond_580278 || protect_assert_disj_582192;
    bool range_valid_c_581175;
    
    if (!protect_assert_disj_582214) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_581170, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_581295 = slt64(block_sizze_581116, flat_dim_581126);
    bool zzero_581296 = merge_block_sizze_581132 == (int64_t) 0;
    bool nonzzero_581297 = !zzero_581296;
    bool protect_assert_disj_582159 = use_measure_for_sorting_457933 || y_580163;
    bool index_certs_580287;
    
    if (!protect_assert_disj_582159) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582161 = use_measure_for_sorting_457933 || assert_cond_580154;
    bool empty_or_match_cert_580371;
    
    if (!protect_assert_disj_582161) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582162;
    int64_t x_582163;
    bool loop_while_580407;
    int64_t x_580408;
    
    loop_while_580407 = loop_cond_581104;
    x_580408 = (int64_t) 1;
    while (loop_while_580407) {
        int64_t loopres_580409 = mul64((int64_t) 2, x_580408);
        bool loop_cond_580410 = slt64(loopres_580409, min_num_blocks_581103);
        bool loop_while_tmp_588032 = loop_cond_580410;
        int64_t x_tmp_588033 = loopres_580409;
        
        loop_while_580407 = loop_while_tmp_588032;
        x_580408 = x_tmp_588033;
    }
    x_582162 = loop_while_580407;
    x_582163 = x_580408;
    
    bool zzero_580411 = x_582163 == (int64_t) 0;
    bool nonzzero_580412 = !zzero_580411;
    bool protect_assert_disj_580413 = nonzzero_580412 || cond_581099;
    bool protect_assert_disj_582167 = use_measure_for_sorting_457933 || protect_assert_disj_580413;
    bool nonzzero_cert_580414;
    
    if (!protect_assert_disj_582167) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_580415 = sdiv_safe64(m_580257, x_582163);
    int64_t block_sizze_580416 = add64((int64_t) 1, zp_rhs_580415);
    bool protect_assert_disj_582169 = use_measure_for_sorting_457933 || protect_assert_disj_581118;
    bool index_certs_580419;
    
    if (!protect_assert_disj_582169) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_cond_conj_582170 = cond_580278 && x_581100;
    int64_t reduce_arg1_580422;
    
    if (protect_cond_conj_582170) {
        int64_t x_584710 = ((int64_t *) mem_586468.mem)[(int64_t) 0];
        
        reduce_arg1_580422 = x_584710;
    } else {
        reduce_arg1_580422 = (int64_t) 0;
    }
    
    int64_t flat_dim_580424 = block_sizze_580416 * x_582163;
    int64_t greatest_divisor_leq_than_arg1_580428 = mul64((int64_t) 2, block_sizze_580416);
    int64_t merge_block_sizze_580429;
    
    if (protect_cond_conj_582170) {
        int64_t x_584711;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584711, (int64_t) 8, greatest_divisor_leq_than_arg1_580428) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_580429 = x_584711;
    } else {
        merge_block_sizze_580429 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_580447 = slt64(x_582163, (int64_t) 0);
    bool valid_580448 = !bounds_invalid_upwards_580447;
    bool protect_assert_disj_582151 = valid_580448 || cond_581099;
    bool protect_assert_disj_582173 = use_measure_for_sorting_457933 || protect_assert_disj_582151;
    bool range_valid_c_580449;
    
    if (!protect_assert_disj_582173) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582163, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_580451 = slt64(block_sizze_580416, (int64_t) 0);
    bool valid_580452 = !bounds_invalid_upwards_580451;
    bool protect_assert_disj_582153 = valid_580452 || cond_581099;
    bool protect_assert_disj_582175 = use_measure_for_sorting_457933 || protect_assert_disj_582153;
    bool range_valid_c_580453;
    
    if (!protect_assert_disj_582175) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_580416, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_580455 = sle64(block_sizze_580416, (int64_t) 1);
    int64_t tmp_580456 = sub64(block_sizze_580416, (int64_t) 2);
    bool bounds_invalid_upwards_580457 = slt64(tmp_580456, (int64_t) 0);
    int64_t distance_580458 = add64((int64_t) 1, tmp_580456);
    bool valid_580459 = !bounds_invalid_upwards_580457;
    bool protect_assert_disj_580460 = cond_580455 || valid_580459;
    bool protect_assert_disj_582155 = protect_assert_disj_580460 || cond_581099;
    bool protect_assert_disj_582177 = use_measure_for_sorting_457933 || protect_assert_disj_582155;
    bool range_valid_c_580461;
    
    if (!protect_assert_disj_582177) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_580456, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_580549 = slt64(block_sizze_580416, flat_dim_580424);
    bool zzero_580550 = merge_block_sizze_580429 == (int64_t) 0;
    bool nonzzero_580551 = !zzero_580550;
    int64_t bytes_586483 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920;
    int64_t bytes_586501 = (int64_t) 8 * dim_457918;
    int64_t bytes_586525 = (int64_t) 4 * arg_580153;
    int64_t bytes_586541 = (int64_t) 8 * arg_580153;
    int64_t binop_x_586566 = (int64_t) 8 * x_582200;
    int64_t bytes_586567 = block_sizze_581116 * binop_x_586566;
    int64_t binop_x_586569 = (int64_t) 4 * x_582200;
    int64_t bytes_586570 = block_sizze_581116 * binop_x_586569;
    int64_t bytes_586574 = dim_457918 * bytes_586570;
    int64_t lmad_arg_586596 = dim_457918 * block_sizze_581116;
    int64_t bytes_586597 = (int64_t) 8 * block_sizze_581116;
    int64_t bytes_586599 = (int64_t) 4 * block_sizze_581116;
    int64_t bytes_586602 = dim_457918 * bytes_586599;
    int64_t lmad_arg_586830 = dim_457918 * merge_block_sizze_581132;
    int64_t binop_x_587094 = (int64_t) 8 * x_582163;
    int64_t bytes_587095 = block_sizze_580416 * binop_x_587094;
    int64_t binop_x_587097 = (int64_t) 4 * x_582163;
    int64_t binop_x_587098 = block_sizze_580416 * binop_x_587097;
    int64_t bytes_587099 = dim_457918 * binop_x_587098;
    int64_t lmad_arg_587117 = dim_457918 * block_sizze_580416;
    int64_t bytes_587118 = (int64_t) 8 * block_sizze_580416;
    int64_t binop_x_587120 = (int64_t) 4 * block_sizze_580416;
    int64_t bytes_587121 = dim_457918 * binop_x_587120;
    int64_t lmad_arg_587303 = dim_457918 * merge_block_sizze_580429;
    
    if (cond_580278) {
        if (mem_587028_cached_sizze_588944 < bytes_586483) {
            err = lexical_realloc(ctx, &mem_587028, &mem_587028_cached_sizze_588944, bytes_586483);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586087 = 0; i_586087 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920; i_586087++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584902 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586087];
            float i64_res_584903 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584902);
            float defunc_0_fover_res_584904 = 1.5707964F / i64_res_584903;
            
            ((float *) mem_587028)[i_586087] = defunc_0_fover_res_584904;
        }
        if (mem_587036_cached_sizze_588945 < bytes_586456) {
            err = lexical_realloc(ctx, &mem_587036, &mem_587036_cached_sizze_588945, bytes_586456);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587041_cached_sizze_588946 < bytes_586501) {
            err = lexical_realloc(ctx, &mem_587041, &mem_587041_cached_sizze_588946, bytes_586501);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587049_cached_sizze_588947 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_587049, &mem_587049_cached_sizze_588947, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587057_cached_sizze_588948 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_587057, &mem_587057_cached_sizze_588948, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587073_cached_sizze_588950 < bytes_586541) {
            err = lexical_realloc(ctx, &mem_587073, &mem_587073_cached_sizze_588950, bytes_586541);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586107 = 0; i_586107 < m_580247; i_586107++) {
            for (int64_t i_586091 = 0; i_586091 < dim_457918; i_586091++) {
                float eta_p_584911 = ((float *) mem_586466.mem)[i_586107 * dim_457918 + i_586091];
                float eta_p_584912 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586091];
                float eta_p_584913 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586091];
                int64_t eta_p_584915 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586091];
                float defunc_0_f_res_584916 = eta_p_584911 - eta_p_584912;
                float defunc_0_f_res_584917 = defunc_0_f_res_584916 / eta_p_584913;
                int64_t f32_res_584918 = fptosi_f32_i64(defunc_0_f_res_584917);
                int64_t max_res_584919 = smax64((int64_t) 0, f32_res_584918);
                int64_t zm_lhs_584924 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586091];
                int64_t min_arg1_584925 = sub64(zm_lhs_584924, (int64_t) 1);
                int64_t min_res_584926 = smin64(max_res_584919, min_arg1_584925);
                int64_t defunc_0_f_res_584927 = mul64(eta_p_584915, min_res_584926);
                
                ((int64_t *) mem_587041)[i_586091] = defunc_0_f_res_584927;
            }
            
            int64_t defunc_0_foldl_res_584929;
            int64_t acc_584931 = (int64_t) 0;
            
            for (int64_t i_584930 = 0; i_584930 < dim_457918; i_584930++) {
                int64_t b_584932 = ((int64_t *) mem_587041)[i_584930];
                int64_t defunc_0_f_res_584933 = add64(acc_584931, b_584932);
                int64_t acc_tmp_588037 = defunc_0_f_res_584933;
                
                acc_584931 = acc_tmp_588037;
            }
            defunc_0_foldl_res_584929 = acc_584931;
            
            bool x_584934 = sle64((int64_t) 0, defunc_0_foldl_res_584929);
            bool y_584935 = slt64(defunc_0_foldl_res_584929, dz2080U_457919);
            bool bounds_check_584936 = x_584934 && y_584935;
            bool index_certs_584937;
            
            if (!bounds_check_584936) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_584929, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586095 = 0; i_586095 < dim_457918; i_586095++) {
                float eta_p_584940 = ((float *) mem_586466.mem)[i_586107 * dim_457918 + i_586095];
                float eta_p_584941 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_584929 * dim_457918 + i_586095];
                float defunc_0_f_res_584942 = eta_p_584940 - eta_p_584941;
                
                ((float *) mem_587049)[i_586095] = defunc_0_f_res_584942;
            }
            for (int64_t nest_i_588039 = 0; nest_i_588039 < arg_580153; nest_i_588039++) {
                ((float *) mem_587057)[nest_i_588039] = 0.0F;
            }
            for (int64_t i_584946 = 0; i_584946 < arg_580153; i_584946++) {
                bool y_584948 = slt64(i_584946, dim_457918);
                bool index_certs_584949;
                
                if (!y_584948) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584946, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_584951 = add64((int64_t) 1, i_584946);
                int64_t j_m_i_584952 = sub64(dim_457918, map_arg1_584951);
                bool empty_slice_584953 = j_m_i_584952 == (int64_t) 0;
                int64_t m_584954 = sub64(j_m_i_584952, (int64_t) 1);
                int64_t i_p_m_t_s_584955 = add64(map_arg1_584951, m_584954);
                bool zzero_leq_i_p_m_t_s_584956 = sle64((int64_t) 0, i_p_m_t_s_584955);
                bool i_p_m_t_s_leq_w_584957 = slt64(i_p_m_t_s_584955, dim_457918);
                bool zzero_lte_i_584958 = sle64((int64_t) 0, map_arg1_584951);
                bool i_lte_j_584959 = sle64(map_arg1_584951, dim_457918);
                bool y_584960 = i_p_m_t_s_leq_w_584957 && zzero_lte_i_584958;
                bool y_584961 = zzero_leq_i_p_m_t_s_584956 && y_584960;
                bool forwards_ok_584962 = i_lte_j_584959 && y_584961;
                bool ok_or_empty_584963 = empty_slice_584953 || forwards_ok_584962;
                bool index_certs_584964;
                
                if (!ok_or_empty_584963) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_584951, ":", (long long) dim_457918, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587061 = (int64_t) 4 * j_m_i_584952;
                float this_x_584950 = ((float *) mem_587049)[i_584946];
                
                if (mem_587062_cached_sizze_588949 < bytes_587061) {
                    err = lexical_realloc(ctx, &mem_587062, &mem_587062_cached_sizze_588949, bytes_587061);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586099 = 0; i_586099 < j_m_i_584952; i_586099++) {
                    int64_t slice_586383 = map_arg1_584951 + i_586099;
                    float eta_p_584967 = ((float *) mem_587049)[slice_586383];
                    float defunc_0_ftimes_res_584968 = eta_p_584967 * eta_p_584967;
                    
                    ((float *) mem_587062)[i_586099] = defunc_0_ftimes_res_584968;
                }
                
                float defunc_0_foldl_res_584970;
                float acc_584972 = 0.0F;
                
                for (int64_t i_584971 = 0; i_584971 < j_m_i_584952; i_584971++) {
                    float b_584973 = ((float *) mem_587062)[i_584971];
                    float defunc_0_f_res_584974 = acc_584972 + b_584973;
                    float acc_tmp_588042 = defunc_0_f_res_584974;
                    
                    acc_584972 = acc_tmp_588042;
                }
                defunc_0_foldl_res_584970 = acc_584972;
                
                float sqrt_res_584975 = futrts_sqrt32(defunc_0_foldl_res_584970);
                float atan2_res_584976 = futrts_atan2_32(sqrt_res_584975, this_x_584950);
                
                ((float *) mem_587057)[i_584946] = atan2_res_584976;
            }
            for (int64_t i_586103 = 0; i_586103 < arg_580153; i_586103++) {
                float eta_p_584979 = ((float *) mem_587057)[i_586103];
                float eta_p_584980 = ((float *) mem_587028)[i_586103];
                int64_t eta_p_584981 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586103];
                int64_t eta_p_584982 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586103];
                float i64_res_584983 = sitofp_i64_f32(eta_p_584981);
                float defunc_0_fover_res_584984 = eta_p_584979 / eta_p_584980;
                float defunc_0_ftimes_res_584985 = i64_res_584983 * defunc_0_fover_res_584984;
                int64_t f32_res_584986 = fptosi_f32_i64(defunc_0_ftimes_res_584985);
                bool cond_584987 = slt64(f32_res_584986, (int64_t) 0);
                int64_t defunc_0_f_res_584988;
                
                if (cond_584987) {
                    defunc_0_f_res_584988 = (int64_t) 0;
                } else {
                    bool cond_584989 = sle64(eta_p_584982, f32_res_584986);
                    int64_t defunc_0_f_res_f_res_584990;
                    
                    if (cond_584989) {
                        int64_t defunc_0_f_res_f_res_t_res_584991 = sub64(eta_p_584982, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_584990 = defunc_0_f_res_f_res_t_res_584991;
                    } else {
                        defunc_0_f_res_f_res_584990 = f32_res_584986;
                    }
                    defunc_0_f_res_584988 = defunc_0_f_res_f_res_584990;
                }
                ((int64_t *) mem_587073)[i_586103] = defunc_0_f_res_584988;
            }
            
            int64_t defunc_0_foldl_res_584993;
            int64_t acc_584995 = (int64_t) 0;
            
            for (int64_t i_584994 = 0; i_584994 < arg_580153; i_584994++) {
                int64_t b_584996 = ((int64_t *) mem_587073)[i_584994];
                int64_t defunc_0_f_res_584997 = add64(acc_584995, b_584996);
                int64_t acc_tmp_588044 = defunc_0_f_res_584997;
                
                acc_584995 = acc_tmp_588044;
            }
            defunc_0_foldl_res_584993 = acc_584995;
            
            int64_t zp_lhs_584998 = mul64(total_angle_no_457928, defunc_0_foldl_res_584929);
            int64_t get_id_from_grid_angle_res_584999 = add64(defunc_0_foldl_res_584993, zp_lhs_584998);
            
            ((int64_t *) mem_587036)[i_586107] = get_id_from_grid_angle_res_584999;
        }
        
        int64_t reduce_arg1_585002;
        
        if (x_581100) {
            int64_t x_585003 = ((int64_t *) mem_587036)[(int64_t) 0];
            
            reduce_arg1_585002 = x_585003;
        } else {
            reduce_arg1_585002 = (int64_t) 0;
        }
        if (cond_581099) {
            if (memblock_set(ctx, &ext_mem_587456, &mem_586466, "mem_586466") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587452, &mem_586468, "mem_586468") != 0)
                return 1;
        } else {
            int64_t ext_587092;
            int64_t defunc_0_reduce_res_585007;
            int64_t defunc_0_reduce_res_585009;
            int64_t redout_586109;
            int64_t redout_586111;
            int64_t ctx_param_ext_587083;
            
            if (memblock_set(ctx, &mem_param_587085, &mem_586466, "mem_586466") != 0)
                return 1;
            ctx_param_ext_587083 = (int64_t) 0;
            redout_586109 = reduce_arg1_585002;
            redout_586111 = reduce_arg1_580422;
            for (int64_t i_586112 = 0; i_586112 < m_580247; i_586112++) {
                int64_t x_585010 = ((int64_t *) mem_587036)[i_586112];
                int64_t x_585012 = ((int64_t *) mem_586468.mem)[i_586112];
                bool lifted_lambda_res_585019 = sle64(redout_586109, x_585010);
                int64_t defunc_0_op_res_585020;
                
                if (lifted_lambda_res_585019) {
                    defunc_0_op_res_585020 = x_585010;
                } else {
                    defunc_0_op_res_585020 = redout_586109;
                }
                
                int64_t defunc_0_op_res_585021;
                
                if (lifted_lambda_res_585019) {
                    defunc_0_op_res_585021 = x_585012;
                } else {
                    defunc_0_op_res_585021 = redout_586111;
                }
                
                int64_t binop_y_587086 = dim_457918 * i_586112;
                int64_t ext_587089;
                
                if (lifted_lambda_res_585019) {
                    ext_587089 = binop_y_587086;
                } else {
                    ext_587089 = ctx_param_ext_587083;
                }
                if (lifted_lambda_res_585019) {
                    if (memblock_set(ctx, &ext_mem_587090, &mem_586466, "mem_586466") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587090, &mem_param_587085, "mem_param_587085") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588045, &ext_mem_587090, "ext_mem_587090") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588046 = ext_587089;
                int64_t redout_tmp_588047 = defunc_0_op_res_585020;
                int64_t redout_tmp_588049 = defunc_0_op_res_585021;
                
                if (memblock_set(ctx, &mem_param_587085, &mem_param_tmp_588045, "mem_param_tmp_588045") != 0)
                    return 1;
                ctx_param_ext_587083 = ctx_param_ext_tmp_588046;
                redout_586109 = redout_tmp_588047;
                redout_586111 = redout_tmp_588049;
            }
            if (memblock_set(ctx, &ext_mem_587093, &mem_param_587085, "mem_param_587085") != 0)
                return 1;
            ext_587092 = ctx_param_ext_587083;
            defunc_0_reduce_res_585007 = redout_586109;
            defunc_0_reduce_res_585009 = redout_586111;
            if (mem_587096_cached_sizze_588951 < bytes_587095) {
                err = lexical_realloc(ctx, &mem_587096, &mem_587096_cached_sizze_588951, bytes_587095);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587100_cached_sizze_588952 < bytes_587099) {
                err = lexical_realloc(ctx, &mem_587100, &mem_587100_cached_sizze_588952, bytes_587099);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587103_cached_sizze_588953 < bytes_587095) {
                err = lexical_realloc(ctx, &mem_587103, &mem_587103_cached_sizze_588953, bytes_587095);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587119_cached_sizze_588954 < bytes_587118) {
                err = lexical_realloc(ctx, &mem_587119, &mem_587119_cached_sizze_588954, bytes_587118);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587122_cached_sizze_588955 < bytes_587121) {
                err = lexical_realloc(ctx, &mem_587122, &mem_587122_cached_sizze_588955, bytes_587121);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587124_cached_sizze_588956 < bytes_587118) {
                err = lexical_realloc(ctx, &mem_587124, &mem_587124_cached_sizze_588956, bytes_587118);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586129 = 0; i_586129 < x_582163; i_586129++) {
                int64_t zp_lhs_585038 = mul64(block_sizze_580416, i_586129);
                
                for (int64_t i_586119 = 0; i_586119 < block_sizze_580416; i_586119++) {
                    int64_t k_585043 = add64(zp_lhs_585038, i_586119);
                    bool cond_585044 = slt64(k_585043, m_580247);
                    int64_t binop_y_587135 = dim_457918 * k_585043;
                    int64_t ext_587138;
                    
                    if (cond_585044) {
                        ext_587138 = binop_y_587135;
                    } else {
                        ext_587138 = ext_587092;
                    }
                    
                    int64_t lifted_lambda_res_585045;
                    int64_t lifted_lambda_res_585047;
                    
                    if (cond_585044) {
                        bool x_585048 = sle64((int64_t) 0, k_585043);
                        bool bounds_check_585049 = cond_585044 && x_585048;
                        bool index_certs_585050;
                        
                        if (!bounds_check_585049) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_585043, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585051 = ((int64_t *) mem_587036)[k_585043];
                        int64_t lifted_lambda_res_t_res_585053 = ((int64_t *) mem_586468.mem)[k_585043];
                        
                        if (memblock_set(ctx, &ext_mem_587139, &mem_586466, "mem_586466") != 0)
                            return 1;
                        lifted_lambda_res_585045 = lifted_lambda_res_t_res_585051;
                        lifted_lambda_res_585047 = lifted_lambda_res_t_res_585053;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587139, &ext_mem_587093, "ext_mem_587093") != 0)
                            return 1;
                        lifted_lambda_res_585045 = defunc_0_reduce_res_585007;
                        lifted_lambda_res_585047 = defunc_0_reduce_res_585009;
                    }
                    ((int64_t *) mem_587119)[i_586119] = lifted_lambda_res_585045;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_587122, i_586119 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587139.mem, ext_587138, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                    if (memblock_unref(ctx, &ext_mem_587139, "ext_mem_587139") != 0)
                        return 1;
                    ((int64_t *) mem_587124)[i_586119] = lifted_lambda_res_585047;
                }
                if (!cond_580455) {
                    if (mem_587171_cached_sizze_588957 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_587171, &mem_587171_cached_sizze_588957, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587173_cached_sizze_588958 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_587173, &mem_587173_cached_sizze_588958, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_585063 = 0; i_585063 < distance_580458; i_585063++) {
                        int64_t gt_arg1_585067 = add64((int64_t) 1, i_585063);
                        bool x_585068 = sle64((int64_t) 0, gt_arg1_585067);
                        bool y_585069 = slt64(gt_arg1_585067, block_sizze_580416);
                        bool bounds_check_585070 = x_585068 && y_585069;
                        bool index_certs_585071;
                        
                        if (!bounds_check_585070) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_585067, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_585073 = slt64(i_585063, block_sizze_580416);
                        bool index_certs_585074;
                        
                        if (!y_585073) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585063, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_585072 = ((int64_t *) mem_587119)[gt_arg1_585067];
                        int64_t gt_arg0_585075 = ((int64_t *) mem_587119)[i_585063];
                        bool lifted_lambda_res_585076 = sle64(gt_arg0_585075, gt_arg1_585072);
                        bool defunc_0_lifted_gt_res_585077 = !lifted_lambda_res_585076;
                        bool s_585078;
                        int64_t s_585082;
                        bool loop_while_585083;
                        int64_t j_585087;
                        
                        loop_while_585083 = defunc_0_lifted_gt_res_585077;
                        j_585087 = i_585063;
                        while (loop_while_585083) {
                            bool x_585088 = sle64((int64_t) 0, j_585087);
                            bool y_585089 = slt64(j_585087, block_sizze_580416);
                            bool bounds_check_585090 = x_585088 && y_585089;
                            bool index_certs_585091;
                            
                            if (!bounds_check_585090) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585087, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585096 = add64((int64_t) 1, j_585087);
                            bool x_585097 = sle64((int64_t) 0, copy_arg0_585096);
                            bool y_585098 = slt64(copy_arg0_585096, block_sizze_580416);
                            bool bounds_check_585099 = x_585097 && y_585098;
                            bool index_certs_585100;
                            
                            if (!bounds_check_585099) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_585096, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_585092 = ((int64_t *) mem_587119)[j_585087];
                            int64_t copy_arg0_585094 = ((int64_t *) mem_587124)[j_585087];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587171, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587122, (int64_t) 0 + j_585087 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            
                            int64_t copy_arg0_585101 = ((int64_t *) mem_587119)[copy_arg0_585096];
                            int64_t copy_arg0_585103 = ((int64_t *) mem_587124)[copy_arg0_585096];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587173, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587122, (int64_t) 0 + copy_arg0_585096 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_587119)[j_585087] = copy_arg0_585101;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587122, j_585087 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587173, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_587124)[j_585087] = copy_arg0_585103;
                            ((int64_t *) mem_587119)[copy_arg0_585096] = copy_arg0_585092;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587122, copy_arg0_585096 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587171, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_587124)[copy_arg0_585096] = copy_arg0_585094;
                            
                            int64_t tmp_585111 = sub64(j_585087, (int64_t) 1);
                            bool cond_585112 = sle64((int64_t) 0, tmp_585111);
                            bool loop_cond_585113;
                            
                            if (cond_585112) {
                                bool y_585115 = slt64(tmp_585111, block_sizze_580416);
                                bool bounds_check_585116 = cond_585112 && y_585115;
                                bool index_certs_585117;
                                
                                if (!bounds_check_585116) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585111, "] out of bounds for array of shape [", (long long) block_sizze_580416, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585114 = ((int64_t *) mem_587119)[j_585087];
                                int64_t gt_arg0_585118 = ((int64_t *) mem_587119)[tmp_585111];
                                bool lifted_lambda_res_585119 = sle64(gt_arg0_585118, gt_arg1_585114);
                                bool defunc_0_lifted_gt_res_585120 = !lifted_lambda_res_585119;
                                
                                loop_cond_585113 = defunc_0_lifted_gt_res_585120;
                            } else {
                                loop_cond_585113 = 0;
                            }
                            
                            bool loop_while_tmp_588059 = loop_cond_585113;
                            int64_t j_tmp_588063 = tmp_585111;
                            
                            loop_while_585083 = loop_while_tmp_588059;
                            j_585087 = j_tmp_588063;
                        }
                        s_585078 = loop_while_585083;
                        s_585082 = j_585087;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587096, i_586129 * block_sizze_580416, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587119, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580416});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_587100, i_586129 * lmad_arg_587117, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) mem_587122, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {block_sizze_580416, dim_457918});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587103, i_586129 * block_sizze_580416, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587124, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_580416});
            }
            if (memblock_unref(ctx, &ext_mem_587093, "ext_mem_587093") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587219, bytes_587095, "mem_587219")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587219.mem, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (uint64_t *) mem_587096, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416});
            if (memblock_alloc(ctx, &mem_587224, bytes_587099, "mem_587224")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_587224.mem, (int64_t) 0, (int64_t []) {dim_457918 * block_sizze_580416, dim_457918, (int64_t) 1}, (uint32_t *) mem_587100, (int64_t) 0, (int64_t []) {lmad_arg_587117, dim_457918, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416, dim_457918});
            if (memblock_alloc(ctx, &mem_587228, bytes_587095, "mem_587228")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587228.mem, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (uint64_t *) mem_587103, (int64_t) 0, (int64_t []) {block_sizze_580416, (int64_t) 1}, (int64_t []) {x_582163, block_sizze_580416});
            
            int64_t data_585133;
            bool data_585134;
            int64_t data_585138;
            int64_t loop_dz2084Uz2082U_585139;
            bool loop_while_585140;
            int64_t stride_585144;
            
            if (memblock_set(ctx, &mem_param_587232, &mem_587219, "mem_587219") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587236, &mem_587224, "mem_587224") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587239, &mem_587228, "mem_587228") != 0)
                return 1;
            loop_dz2084Uz2082U_585139 = flat_dim_580424;
            loop_while_585140 = loop_cond_580549;
            stride_585144 = block_sizze_580416;
            while (loop_while_585140) {
                int64_t next_stride_585145 = mul64((int64_t) 2, stride_585144);
                bool zzero_585146 = next_stride_585145 == (int64_t) 0;
                bool nonzzero_585147 = !zzero_585146;
                bool nonzzero_cert_585148;
                
                if (!nonzzero_585147) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585149 = sdiv64(flat_dim_580424, next_stride_585145);
                bool bounds_invalid_upwards_585150 = slt64(num_merges_585149, (int64_t) 0);
                bool valid_585151 = !bounds_invalid_upwards_585150;
                bool range_valid_c_585152;
                
                if (!valid_585151) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585149, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585154 = sub64(next_stride_585145, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585155 = sle64((int64_t) 0, m_585154);
                bool cond_585157 = slt64(next_stride_585145, (int64_t) 10);
                bool protect_assert_disj_585158 = nonzzero_580551 || cond_585157;
                bool nonzzero_cert_585159;
                
                if (!protect_assert_disj_585158) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585160 = smod_safe64(next_stride_585145, merge_block_sizze_580429);
                bool num_blocks_585161 = zeze_lhs_585160 == (int64_t) 0;
                bool protect_assert_disj_585162 = cond_585157 || num_blocks_585161;
                bool assert_c_585163;
                
                if (!protect_assert_disj_585162) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585164 = sdiv_safe64(next_stride_585145, merge_block_sizze_580429);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165 = add64((int64_t) 1, num_blocks_585164);
                int64_t j_m_i_585166 = sub64(next_stride_585145, stride_585144);
                int64_t flat_dim_585167 = merge_block_sizze_580429 * num_blocks_585164;
                bool bounds_invalid_upwards_585168 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, (int64_t) 0);
                bool empty_slice_585169 = j_m_i_585166 == (int64_t) 0;
                int64_t m_585170 = sub64(j_m_i_585166, (int64_t) 1);
                bool zzero_lte_i_585171 = sle64((int64_t) 0, stride_585144);
                bool i_lte_j_585172 = sle64(stride_585144, next_stride_585145);
                bool empty_slice_585173 = stride_585144 == (int64_t) 0;
                int64_t m_585174 = sub64(stride_585144, (int64_t) 1);
                bool bounds_invalid_upwards_585175 = slt64(num_blocks_585164, (int64_t) 0);
                bool cond_585176 = slt64((int64_t) 0, stride_585144);
                bool valid_585177 = !bounds_invalid_upwards_585168;
                int64_t i_p_m_t_s_585178 = add64(stride_585144, m_585170);
                bool zzero_leq_i_p_m_t_s_585179 = sle64((int64_t) 0, m_585174);
                bool i_p_m_t_s_leq_w_585180 = slt64(m_585174, next_stride_585145);
                bool valid_585181 = !bounds_invalid_upwards_585175;
                bool i_p_m_t_s_leq_w_585182 = slt64(m_585154, flat_dim_585167);
                bool y_585183 = slt64((int64_t) 0, j_m_i_585166);
                bool protect_assert_disj_585184 = cond_585157 || valid_585177;
                bool range_valid_c_585185;
                
                if (!protect_assert_disj_585184) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585186 = sle64((int64_t) 0, i_p_m_t_s_585178);
                bool i_p_m_t_s_leq_w_585187 = slt64(i_p_m_t_s_585178, next_stride_585145);
                bool y_585188 = zzero_leq_i_p_m_t_s_585179 && i_p_m_t_s_leq_w_585180;
                bool protect_assert_disj_585189 = cond_585157 || valid_585181;
                bool range_valid_c_585190;
                
                if (!protect_assert_disj_585189) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585164, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585191 = zzero_leq_i_p_m_t_s_585155 && i_p_m_t_s_leq_w_585182;
                bool y_585192 = zzero_lte_i_585171 && i_p_m_t_s_leq_w_585187;
                bool forwards_ok_585193 = zzero_lte_i_585171 && y_585188;
                bool ok_or_empty_585194 = zzero_585146 || y_585191;
                bool protect_assert_disj_585195 = cond_585176 || y_585183;
                bool y_585196 = zzero_leq_i_p_m_t_s_585186 && y_585192;
                bool ok_or_empty_585197 = empty_slice_585173 || forwards_ok_585193;
                bool protect_assert_disj_585198 = cond_585157 || ok_or_empty_585194;
                bool index_certs_585199;
                
                if (!protect_assert_disj_585198) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585145, "] out of bounds for array of shape [", (long long) flat_dim_585167, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585200 = !cond_585157;
                bool protect_assert_disj_585201 = protect_assert_disj_585195 || loop_not_taken_585200;
                bool index_certs_585202;
                
                if (!protect_assert_disj_585201) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585203 = i_lte_j_585172 && y_585196;
                bool protect_assert_disj_585204 = cond_585157 || ok_or_empty_585197;
                bool index_certs_585205;
                
                if (!protect_assert_disj_585204) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585144, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585206 = ok_or_empty_585197 || loop_not_taken_585200;
                bool index_certs_585207;
                
                if (!protect_assert_disj_585206) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585144, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585208 = empty_slice_585169 || forwards_ok_585203;
                bool protect_assert_disj_585209 = cond_585157 || ok_or_empty_585208;
                bool index_certs_585210;
                
                if (!protect_assert_disj_585209) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585144, ":] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585211 = loop_not_taken_585200 || ok_or_empty_585208;
                bool index_certs_585212;
                
                if (!protect_assert_disj_585211) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585144, ":] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587240 = (int64_t) 8 * num_merges_585149;
                int64_t bytes_587241 = next_stride_585145 * binop_x_587240;
                int64_t binop_x_587243 = (int64_t) 4 * num_merges_585149;
                int64_t binop_x_587244 = next_stride_585145 * binop_x_587243;
                int64_t bytes_587245 = dim_457918 * binop_x_587244;
                bool i_lte_j_585156 = sle64((int64_t) 0, next_stride_585145);
                
                if (mem_587242_cached_sizze_588959 < bytes_587241) {
                    err = lexical_realloc(ctx, &mem_587242, &mem_587242_cached_sizze_588959, bytes_587241);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587246_cached_sizze_588960 < bytes_587245) {
                    err = lexical_realloc(ctx, &mem_587246, &mem_587246_cached_sizze_588960, bytes_587245);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587249_cached_sizze_588961 < bytes_587241) {
                    err = lexical_realloc(ctx, &mem_587249, &mem_587249_cached_sizze_588961, bytes_587241);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587263 = dim_457918 * next_stride_585145;
                int64_t bytes_587264 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165;
                int64_t binop_x_587280 = (int64_t) 8 * num_blocks_585164;
                int64_t bytes_587281 = merge_block_sizze_580429 * binop_x_587280;
                int64_t binop_x_587283 = (int64_t) 4 * num_blocks_585164;
                int64_t binop_x_587284 = merge_block_sizze_580429 * binop_x_587283;
                int64_t bytes_587285 = dim_457918 * binop_x_587284;
                int64_t bytes_587372 = (int64_t) 16 * stride_585144;
                int64_t binop_x_587376 = (int64_t) 8 * stride_585144;
                int64_t bytes_587377 = dim_457918 * binop_x_587376;
                
                for (int64_t i_586156 = 0; i_586156 < num_merges_585149; i_586156++) {
                    int64_t start_585217 = mul64(next_stride_585145, i_586156);
                    int64_t j_m_i_585218 = sub64(loop_dz2084Uz2082U_585139, start_585217);
                    bool empty_slice_585219 = j_m_i_585218 == (int64_t) 0;
                    int64_t m_585220 = sub64(j_m_i_585218, (int64_t) 1);
                    int64_t i_p_m_t_s_585221 = add64(start_585217, m_585220);
                    bool zzero_leq_i_p_m_t_s_585222 = sle64((int64_t) 0, i_p_m_t_s_585221);
                    bool i_p_m_t_s_leq_w_585223 = slt64(i_p_m_t_s_585221, loop_dz2084Uz2082U_585139);
                    bool zzero_lte_i_585224 = sle64((int64_t) 0, start_585217);
                    bool i_lte_j_585225 = sle64(start_585217, loop_dz2084Uz2082U_585139);
                    bool y_585226 = i_p_m_t_s_leq_w_585223 && zzero_lte_i_585224;
                    bool y_585227 = zzero_leq_i_p_m_t_s_585222 && y_585226;
                    bool forwards_ok_585228 = i_lte_j_585225 && y_585227;
                    bool ok_or_empty_585229 = empty_slice_585219 || forwards_ok_585228;
                    bool index_certs_585230;
                    
                    if (!ok_or_empty_585229) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585217, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585139, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585231 = slt64(m_585154, j_m_i_585218);
                    bool y_585232 = zzero_leq_i_p_m_t_s_585155 && i_p_m_t_s_leq_w_585231;
                    bool forwards_ok_585233 = i_lte_j_585156 && y_585232;
                    bool ok_or_empty_585234 = zzero_585146 || forwards_ok_585233;
                    bool index_certs_585235;
                    
                    if (!ok_or_empty_585234) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585145, "] out of bounds for array of shape [", (long long) j_m_i_585218, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:965:33-56\n   #7  ftSkyline.fut:954:17-965:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585245 = stride_585144 + start_585217;
                    int64_t binop_y_587367 = dim_457918 * slice_585245;
                    int64_t binop_y_587369 = dim_457918 * start_585217;
                    int64_t ext_587371;
                    
                    if (cond_585176) {
                        ext_587371 = binop_y_587369;
                    } else {
                        ext_587371 = binop_y_587367;
                    }
                    if (cond_585157) {
                        int64_t dummy_585239;
                        int64_t dummy_585241;
                        
                        if (cond_585176) {
                            int64_t head_res_585242 = ((int64_t *) mem_param_587232.mem)[start_585217];
                            int64_t head_res_585244 = ((int64_t *) mem_param_587239.mem)[start_585217];
                            
                            dummy_585239 = head_res_585242;
                            dummy_585241 = head_res_585244;
                        } else {
                            int64_t head_res_585246 = ((int64_t *) mem_param_587232.mem)[slice_585245];
                            int64_t head_res_585248 = ((int64_t *) mem_param_587239.mem)[slice_585245];
                            
                            dummy_585239 = head_res_585246;
                            dummy_585241 = head_res_585248;
                        }
                        if (memblock_alloc(ctx, &mem_587373, bytes_587372, "mem_587373")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588076 = 0; nest_i_588076 < next_stride_585145; nest_i_588076++) {
                            ((int64_t *) mem_587373.mem)[nest_i_588076] = dummy_585239;
                        }
                        if (memblock_alloc(ctx, &mem_587375, bytes_587372, "mem_587375")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588077 = 0; nest_i_588077 < next_stride_585145; nest_i_588077++) {
                            ((int64_t *) mem_587375.mem)[nest_i_588077] = dummy_585241;
                        }
                        if (memblock_alloc(ctx, &mem_587378, bytes_587377, "mem_587378")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588078 = 0; nest_i_588078 < next_stride_585145; nest_i_588078++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587378.mem, nest_i_588078 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587236.mem, ext_587371, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                        }
                        
                        int64_t data_585252;
                        int64_t i_585257 = (int64_t) 0;
                        
                        for (int64_t k_585256 = 0; k_585256 < next_stride_585145; k_585256++) {
                            int64_t j_585261 = sub64(k_585256, i_585257);
                            bool cond_585262 = j_585261 == j_m_i_585166;
                            bool x_587783 = !cond_585262;
                            bool cond_585264 = slt64(i_585257, stride_585144);
                            bool x_585266 = sle64((int64_t) 0, j_585261);
                            bool y_585267 = slt64(j_585261, j_m_i_585166);
                            bool bounds_check_585268 = x_585266 && y_585267;
                            bool loop_not_taken_587775 = !cond_585264;
                            bool protect_assert_disj_587776 = bounds_check_585268 || loop_not_taken_587775;
                            bool protect_assert_disj_587786 = cond_585262 || protect_assert_disj_587776;
                            bool index_certs_585269;
                            
                            if (!protect_assert_disj_587786) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585261, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585270 = stride_585144 + j_585261;
                            int64_t slice_585271 = start_585217 + slice_585270;
                            bool protect_cond_conj_587787 = cond_585264 && x_587783;
                            int64_t leq_arg1_585272;
                            
                            if (protect_cond_conj_587787) {
                                int64_t x_587777 = ((int64_t *) mem_param_587232.mem)[slice_585271];
                                
                                leq_arg1_585272 = x_587777;
                            } else {
                                leq_arg1_585272 = (int64_t) 0;
                            }
                            
                            bool x_585273 = sle64((int64_t) 0, i_585257);
                            bool bounds_check_585274 = cond_585264 && x_585273;
                            bool protect_assert_disj_587780 = bounds_check_585274 || loop_not_taken_587775;
                            bool protect_assert_disj_587789 = cond_585262 || protect_assert_disj_587780;
                            bool index_certs_585275;
                            
                            if (!protect_assert_disj_587789) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585257, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585276 = start_585217 + i_585257;
                            int64_t leq_arg0_585277;
                            
                            if (protect_cond_conj_587787) {
                                int64_t x_587781 = ((int64_t *) mem_param_587232.mem)[slice_585276];
                                
                                leq_arg0_585277 = x_587781;
                            } else {
                                leq_arg0_585277 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585278 = sle64(leq_arg0_585277, leq_arg1_585272);
                            bool x_587863 = cond_585264 && lifted_lambda_res_585278;
                            bool cond_585263 = cond_585262 || x_587863;
                            bool protect_assert_disj_587695 = cond_585263 || bounds_check_585268;
                            bool index_certs_585295;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585261, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585286 = cond_585264 && x_585273;
                            bool loop_not_taken_587690 = !cond_585263;
                            bool protect_assert_disj_587691 = bounds_check_585286 || loop_not_taken_587690;
                            bool index_certs_585287;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585257, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585297 = start_585217 + slice_585270;
                            int64_t binop_y_587389 = dim_457918 * slice_585297;
                            int64_t binop_y_587391 = dim_457918 * slice_585276;
                            int64_t ext_587393;
                            
                            if (cond_585263) {
                                ext_587393 = binop_y_587391;
                            } else {
                                ext_587393 = binop_y_587389;
                            }
                            
                            int64_t loopres_585279;
                            int64_t loopres_585280;
                            int64_t loopres_585282;
                            
                            if (cond_585263) {
                                int64_t tmp_585283 = add64((int64_t) 1, i_585257);
                                int64_t tmp_585289 = ((int64_t *) mem_param_587232.mem)[slice_585276];
                                int64_t tmp_585291 = ((int64_t *) mem_param_587239.mem)[slice_585276];
                                
                                loopres_585279 = tmp_585283;
                                loopres_585280 = tmp_585289;
                                loopres_585282 = tmp_585291;
                            } else {
                                int64_t tmp_585298 = ((int64_t *) mem_param_587232.mem)[slice_585297];
                                int64_t tmp_585300 = ((int64_t *) mem_param_587239.mem)[slice_585297];
                                
                                loopres_585279 = i_585257;
                                loopres_585280 = tmp_585298;
                                loopres_585282 = tmp_585300;
                            }
                            ((int64_t *) mem_587373.mem)[k_585256] = loopres_585280;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587378.mem, k_585256 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587236.mem, ext_587393, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_587375.mem)[k_585256] = loopres_585282;
                            
                            int64_t i_tmp_588079 = loopres_585279;
                            
                            i_585257 = i_tmp_588079;
                        }
                        data_585252 = i_585257;
                        if (memblock_set(ctx, &ext_mem_587413, &mem_587373, "mem_587373") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587410, &mem_587378, "mem_587378") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587406, &mem_587375, "mem_587375") != 0)
                            return 1;
                    } else {
                        if (mem_587265_cached_sizze_588962 < bytes_587264) {
                            err = lexical_realloc(ctx, &mem_587265, &mem_587265_cached_sizze_588962, bytes_587264);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587267_cached_sizze_588963 < bytes_587264) {
                            err = lexical_realloc(ctx, &mem_587267, &mem_587267_cached_sizze_588963, bytes_587264);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586137 = 0; i_586137 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165; i_586137++) {
                            int64_t split_count_arg3_585308 = mul64(merge_block_sizze_580429, i_586137);
                            int64_t defunc_0_split_count_res_585309;
                            int64_t defunc_0_split_count_res_585310;
                            int64_t defunc_0_split_count_res_585311;
                            int64_t defunc_0_split_count_res_585312;
                            int64_t defunc_0_split_count_res_585313;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585309, &defunc_0_split_count_res_585310, &defunc_0_split_count_res_585311, &defunc_0_split_count_res_585312, &defunc_0_split_count_res_585313, (int64_t) 0, stride_585144, (int64_t) 0, j_m_i_585166, split_count_arg3_585308) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585314 = slt64((int64_t) 0, defunc_0_split_count_res_585313);
                            bool defunc_0_split_count_res_585315;
                            int64_t defunc_0_split_count_res_585316;
                            int64_t defunc_0_split_count_res_585317;
                            int64_t defunc_0_split_count_res_585318;
                            int64_t defunc_0_split_count_res_585319;
                            int64_t defunc_0_split_count_res_585320;
                            bool loop_while_585321;
                            int64_t ss_585322;
                            int64_t ss_585323;
                            int64_t tt_585324;
                            int64_t tt_585325;
                            int64_t count_585326;
                            
                            loop_while_585321 = loop_cond_585314;
                            ss_585322 = defunc_0_split_count_res_585309;
                            ss_585323 = defunc_0_split_count_res_585310;
                            tt_585324 = defunc_0_split_count_res_585311;
                            tt_585325 = defunc_0_split_count_res_585312;
                            count_585326 = defunc_0_split_count_res_585313;
                            while (loop_while_585321) {
                                int64_t zlze_lhs_585327 = sub64(ss_585323, ss_585322);
                                bool cond_585328 = sle64(zlze_lhs_585327, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585329;
                                int64_t defunc_0_lifted_step_res_585330;
                                int64_t defunc_0_lifted_step_res_585331;
                                int64_t defunc_0_lifted_step_res_585332;
                                
                                if (cond_585328) {
                                    int64_t tmp_585333 = add64(tt_585324, count_585326);
                                    
                                    defunc_0_lifted_step_res_585329 = ss_585322;
                                    defunc_0_lifted_step_res_585330 = tmp_585333;
                                    defunc_0_lifted_step_res_585331 = tt_585325;
                                    defunc_0_lifted_step_res_585332 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585334 = sub64(tt_585325, tt_585324);
                                    bool cond_585335 = sle64(zlze_lhs_585334, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585336;
                                    int64_t defunc_0_lifted_step_res_f_res_585337;
                                    int64_t defunc_0_lifted_step_res_f_res_585338;
                                    int64_t defunc_0_lifted_step_res_f_res_585339;
                                    
                                    if (cond_585335) {
                                        int64_t tmp_585340 = add64(ss_585322, count_585326);
                                        
                                        defunc_0_lifted_step_res_f_res_585336 = tmp_585340;
                                        defunc_0_lifted_step_res_f_res_585337 = tt_585324;
                                        defunc_0_lifted_step_res_f_res_585338 = tt_585325;
                                        defunc_0_lifted_step_res_f_res_585339 = (int64_t) 0;
                                    } else {
                                        bool cond_585341 = count_585326 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585342;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585343;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585344;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585345;
                                        
                                        if (cond_585341) {
                                            bool x_585346 = sle64((int64_t) 0, ss_585322);
                                            bool y_585347 = slt64(ss_585322, stride_585144);
                                            bool bounds_check_585348 = x_585346 && y_585347;
                                            bool index_certs_585349;
                                            
                                            if (!bounds_check_585348) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585322, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:965:33-56\n   #12 ftSkyline.fut:954:17-965:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585352 = sle64((int64_t) 0, tt_585324);
                                            bool y_585353 = slt64(tt_585324, j_m_i_585166);
                                            bool bounds_check_585354 = x_585352 && y_585353;
                                            bool index_certs_585355;
                                            
                                            if (!bounds_check_585354) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585324, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:965:33-56\n   #12 ftSkyline.fut:954:17-965:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585350 = start_585217 + ss_585322;
                                            int64_t leq_arg1_585351 = ((int64_t *) mem_param_587232.mem)[slice_585350];
                                            int64_t slice_585356 = stride_585144 + tt_585324;
                                            int64_t slice_585357 = start_585217 + slice_585356;
                                            int64_t leq_arg0_585358 = ((int64_t *) mem_param_587232.mem)[slice_585357];
                                            bool lifted_lambda_res_585359 = sle64(leq_arg0_585358, leq_arg1_585351);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585360;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585361;
                                            
                                            if (lifted_lambda_res_585359) {
                                                int64_t tmp_585362 = add64((int64_t) 1, tt_585324);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585360 = ss_585322;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585361 = tmp_585362;
                                            } else {
                                                int64_t tmp_585363 = add64((int64_t) 1, ss_585322);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585360 = tmp_585363;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585361 = tt_585324;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585342 = defunc_0_lifted_step_res_f_res_f_res_t_res_585360;
                                            defunc_0_lifted_step_res_f_res_f_res_585343 = defunc_0_lifted_step_res_f_res_f_res_t_res_585361;
                                            defunc_0_lifted_step_res_f_res_f_res_585344 = tt_585325;
                                            defunc_0_lifted_step_res_f_res_f_res_585345 = (int64_t) 0;
                                        } else {
                                            int64_t m_585364 = sdiv64(count_585326, (int64_t) 2);
                                            int64_t n_585365 = sub64(count_585326, m_585364);
                                            bool cond_585366 = n_585365 == (int64_t) 0;
                                            int64_t zgze_lhs_585367 = add64(ss_585322, m_585364);
                                            bool cond_f_res_585368 = sle64(ss_585323, zgze_lhs_585367);
                                            bool x_585369 = !cond_585366;
                                            bool y_585370 = cond_f_res_585368 && x_585369;
                                            bool cond_585371 = cond_585366 || y_585370;
                                            bool leq_y_x_585372;
                                            
                                            if (cond_585371) {
                                                leq_y_x_585372 = 1;
                                            } else {
                                                bool x_585373 = sle64((int64_t) 0, zgze_lhs_585367);
                                                bool y_585374 = slt64(zgze_lhs_585367, stride_585144);
                                                bool bounds_check_585375 = x_585373 && y_585374;
                                                bool index_certs_585376;
                                                
                                                if (!bounds_check_585375) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585367, "] out of bounds for array of shape [", (long long) stride_585144, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:965:33-56\n   #12 ftSkyline.fut:954:17-965:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585379 = add64(tt_585324, n_585365);
                                                int64_t leq_arg0_585380 = sub64(zm_lhs_585379, (int64_t) 1);
                                                bool x_585381 = sle64((int64_t) 0, leq_arg0_585380);
                                                bool y_585382 = slt64(leq_arg0_585380, j_m_i_585166);
                                                bool bounds_check_585383 = x_585381 && y_585382;
                                                bool index_certs_585384;
                                                
                                                if (!bounds_check_585383) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585380, "] out of bounds for array of shape [", (long long) j_m_i_585166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:965:33-56\n   #12 ftSkyline.fut:954:17-965:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585377 = start_585217 + zgze_lhs_585367;
                                                int64_t leq_arg1_585378 = ((int64_t *) mem_param_587232.mem)[slice_585377];
                                                int64_t slice_585385 = stride_585144 + leq_arg0_585380;
                                                int64_t slice_585386 = start_585217 + slice_585385;
                                                int64_t leq_arg0_585387 = ((int64_t *) mem_param_587232.mem)[slice_585386];
                                                bool lifted_lambda_res_585388 = sle64(leq_arg0_585387, leq_arg1_585378);
                                                
                                                leq_y_x_585372 = lifted_lambda_res_585388;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585389;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585390;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585391;
                                            
                                            if (leq_y_x_585372) {
                                                int64_t tmp_585392 = add64(tt_585324, n_585365);
                                                int64_t tmp_585393 = sub64(count_585326, n_585365);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585389 = tmp_585392;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585390 = tt_585325;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585391 = tmp_585393;
                                            } else {
                                                int64_t tmp_585394 = add64(tt_585324, n_585365);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585389 = tt_585324;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585390 = tmp_585394;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585391 = count_585326;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585342 = ss_585322;
                                            defunc_0_lifted_step_res_f_res_f_res_585343 = defunc_0_lifted_step_res_f_res_f_res_f_res_585389;
                                            defunc_0_lifted_step_res_f_res_f_res_585344 = defunc_0_lifted_step_res_f_res_f_res_f_res_585390;
                                            defunc_0_lifted_step_res_f_res_f_res_585345 = defunc_0_lifted_step_res_f_res_f_res_f_res_585391;
                                        }
                                        defunc_0_lifted_step_res_f_res_585336 = defunc_0_lifted_step_res_f_res_f_res_585342;
                                        defunc_0_lifted_step_res_f_res_585337 = defunc_0_lifted_step_res_f_res_f_res_585343;
                                        defunc_0_lifted_step_res_f_res_585338 = defunc_0_lifted_step_res_f_res_f_res_585344;
                                        defunc_0_lifted_step_res_f_res_585339 = defunc_0_lifted_step_res_f_res_f_res_585345;
                                    }
                                    defunc_0_lifted_step_res_585329 = defunc_0_lifted_step_res_f_res_585336;
                                    defunc_0_lifted_step_res_585330 = defunc_0_lifted_step_res_f_res_585337;
                                    defunc_0_lifted_step_res_585331 = defunc_0_lifted_step_res_f_res_585338;
                                    defunc_0_lifted_step_res_585332 = defunc_0_lifted_step_res_f_res_585339;
                                }
                                
                                int64_t loopres_585395;
                                int64_t loopres_585396;
                                int64_t loopres_585397;
                                int64_t loopres_585398;
                                int64_t loopres_585399;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585395, &loopres_585396, &loopres_585397, &loopres_585398, &loopres_585399, defunc_0_lifted_step_res_585329, ss_585323, defunc_0_lifted_step_res_585330, defunc_0_lifted_step_res_585331, defunc_0_lifted_step_res_585332) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585400 = slt64((int64_t) 0, loopres_585399);
                                bool loop_while_tmp_588085 = loop_cond_585400;
                                int64_t ss_tmp_588086 = loopres_585395;
                                int64_t ss_tmp_588087 = loopres_585396;
                                int64_t tt_tmp_588088 = loopres_585397;
                                int64_t tt_tmp_588089 = loopres_585398;
                                int64_t count_tmp_588090 = loopres_585399;
                                
                                loop_while_585321 = loop_while_tmp_588085;
                                ss_585322 = ss_tmp_588086;
                                ss_585323 = ss_tmp_588087;
                                tt_585324 = tt_tmp_588088;
                                tt_585325 = tt_tmp_588089;
                                count_585326 = count_tmp_588090;
                            }
                            defunc_0_split_count_res_585315 = loop_while_585321;
                            defunc_0_split_count_res_585316 = ss_585322;
                            defunc_0_split_count_res_585317 = ss_585323;
                            defunc_0_split_count_res_585318 = tt_585324;
                            defunc_0_split_count_res_585319 = tt_585325;
                            defunc_0_split_count_res_585320 = count_585326;
                            ((int64_t *) mem_587265)[i_586137] = defunc_0_split_count_res_585316;
                            ((int64_t *) mem_587267)[i_586137] = defunc_0_split_count_res_585318;
                        }
                        if (mem_587282_cached_sizze_588964 < bytes_587281) {
                            err = lexical_realloc(ctx, &mem_587282, &mem_587282_cached_sizze_588964, bytes_587281);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587286_cached_sizze_588965 < bytes_587285) {
                            err = lexical_realloc(ctx, &mem_587286, &mem_587286_cached_sizze_588965, bytes_587285);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587289_cached_sizze_588966 < bytes_587281) {
                            err = lexical_realloc(ctx, &mem_587289, &mem_587289_cached_sizze_588966, bytes_587281);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586146 = 0; i_586146 < num_blocks_585164; i_586146++) {
                            bool y_585409 = slt64(i_586146, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165);
                            bool index_certs_585411;
                            
                            if (!y_585409) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586146, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585412 = ((int64_t *) mem_587265)[i_586146];
                            int64_t defunc_0_f_res_585413 = ((int64_t *) mem_587267)[i_586146];
                            int64_t tmp_585414 = add64((int64_t) 1, i_586146);
                            bool x_585415 = sle64((int64_t) 0, tmp_585414);
                            bool y_585416 = slt64(tmp_585414, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165);
                            bool bounds_check_585417 = x_585415 && y_585416;
                            bool index_certs_585418;
                            
                            if (!bounds_check_585417) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585414, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585165, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585419 = ((int64_t *) mem_587265)[tmp_585414];
                            int64_t defunc_0_f_res_585420 = ((int64_t *) mem_587267)[tmp_585414];
                            int64_t merge_sequential_arg2_585421 = add64(stride_585144, defunc_0_f_res_585413);
                            int64_t merge_sequential_arg2_585422 = add64(stride_585144, defunc_0_f_res_585420);
                            int64_t j_m_i_585423 = sub64(merge_sequential_arg2_585422, merge_sequential_arg2_585421);
                            bool empty_slice_585424 = j_m_i_585423 == (int64_t) 0;
                            int64_t m_585425 = sub64(j_m_i_585423, (int64_t) 1);
                            int64_t i_p_m_t_s_585426 = add64(merge_sequential_arg2_585421, m_585425);
                            bool zzero_leq_i_p_m_t_s_585427 = sle64((int64_t) 0, i_p_m_t_s_585426);
                            bool i_p_m_t_s_leq_w_585428 = slt64(i_p_m_t_s_585426, next_stride_585145);
                            bool zzero_lte_i_585429 = sle64((int64_t) 0, merge_sequential_arg2_585421);
                            bool i_lte_j_585430 = sle64(merge_sequential_arg2_585421, merge_sequential_arg2_585422);
                            bool y_585431 = i_p_m_t_s_leq_w_585428 && zzero_lte_i_585429;
                            bool y_585432 = zzero_leq_i_p_m_t_s_585427 && y_585431;
                            bool forwards_ok_585433 = i_lte_j_585430 && y_585432;
                            bool ok_or_empty_585434 = empty_slice_585424 || forwards_ok_585433;
                            bool index_certs_585435;
                            
                            if (!ok_or_empty_585434) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585421, ":", (long long) merge_sequential_arg2_585422, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585436 = sub64(defunc_0_f_res_585419, defunc_0_f_res_585412);
                            bool empty_slice_585437 = j_m_i_585436 == (int64_t) 0;
                            int64_t m_585438 = sub64(j_m_i_585436, (int64_t) 1);
                            int64_t i_p_m_t_s_585439 = add64(defunc_0_f_res_585412, m_585438);
                            bool zzero_leq_i_p_m_t_s_585440 = sle64((int64_t) 0, i_p_m_t_s_585439);
                            bool i_p_m_t_s_leq_w_585441 = slt64(i_p_m_t_s_585439, next_stride_585145);
                            bool zzero_lte_i_585442 = sle64((int64_t) 0, defunc_0_f_res_585412);
                            bool i_lte_j_585443 = sle64(defunc_0_f_res_585412, defunc_0_f_res_585419);
                            bool y_585444 = i_p_m_t_s_leq_w_585441 && zzero_lte_i_585442;
                            bool y_585445 = zzero_leq_i_p_m_t_s_585440 && y_585444;
                            bool forwards_ok_585446 = i_lte_j_585443 && y_585445;
                            bool ok_or_empty_585447 = empty_slice_585437 || forwards_ok_585446;
                            bool index_certs_585448;
                            
                            if (!ok_or_empty_585447) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585412, ":", (long long) defunc_0_f_res_585419, "] out of bounds for array of shape [", (long long) next_stride_585145, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585449 = slt64((int64_t) 0, j_m_i_585436);
                            bool y_585458 = slt64((int64_t) 0, j_m_i_585423);
                            bool protect_assert_disj_587711 = cond_585449 || y_585458;
                            bool index_certs_585459;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585460 = start_585217 + merge_sequential_arg2_585421;
                            int64_t binop_y_587304 = dim_457918 * slice_585460;
                            int64_t slice_585454 = start_585217 + defunc_0_f_res_585412;
                            int64_t binop_y_587306 = dim_457918 * slice_585454;
                            int64_t ext_587308;
                            
                            if (cond_585449) {
                                ext_587308 = binop_y_587306;
                            } else {
                                ext_587308 = binop_y_587304;
                            }
                            
                            int64_t dummy_585450;
                            int64_t dummy_585452;
                            
                            if (cond_585449) {
                                int64_t head_res_585455 = ((int64_t *) mem_param_587232.mem)[slice_585454];
                                int64_t head_res_585457 = ((int64_t *) mem_param_587239.mem)[slice_585454];
                                
                                dummy_585450 = head_res_585455;
                                dummy_585452 = head_res_585457;
                            } else {
                                int64_t head_res_585461 = ((int64_t *) mem_param_587232.mem)[slice_585460];
                                int64_t head_res_585463 = ((int64_t *) mem_param_587239.mem)[slice_585460];
                                
                                dummy_585450 = head_res_585461;
                                dummy_585452 = head_res_585463;
                            }
                            for (int64_t nest_i_588094 = 0; nest_i_588094 < merge_block_sizze_580429; nest_i_588094++) {
                                ((int64_t *) mem_587282)[i_586146 * merge_block_sizze_580429 + nest_i_588094] = dummy_585450;
                            }
                            for (int64_t nest_i_588095 = 0; nest_i_588095 < merge_block_sizze_580429; nest_i_588095++) {
                                ((int64_t *) mem_587289)[i_586146 * merge_block_sizze_580429 + nest_i_588095] = dummy_585452;
                            }
                            for (int64_t nest_i_588096 = 0; nest_i_588096 < merge_block_sizze_580429; nest_i_588096++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587286, i_586146 * lmad_arg_587303 + nest_i_588096 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587236.mem, ext_587308, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            }
                            
                            int64_t data_585467;
                            int64_t i_585472 = (int64_t) 0;
                            
                            for (int64_t k_585471 = 0; k_585471 < merge_block_sizze_580429; k_585471++) {
                                int64_t j_585476 = sub64(k_585471, i_585472);
                                bool cond_585477 = j_585476 == j_m_i_585423;
                                bool x_587801 = !cond_585477;
                                bool cond_585479 = slt64(i_585472, j_m_i_585436);
                                bool x_585481 = sle64((int64_t) 0, j_585476);
                                bool y_585482 = slt64(j_585476, j_m_i_585423);
                                bool bounds_check_585483 = x_585481 && y_585482;
                                bool loop_not_taken_587793 = !cond_585479;
                                bool protect_assert_disj_587794 = bounds_check_585483 || loop_not_taken_587793;
                                bool protect_assert_disj_587804 = cond_585477 || protect_assert_disj_587794;
                                bool index_certs_585484;
                                
                                if (!protect_assert_disj_587804) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585476, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585485 = merge_sequential_arg2_585421 + j_585476;
                                int64_t slice_585486 = start_585217 + slice_585485;
                                bool protect_cond_conj_587805 = cond_585479 && x_587801;
                                int64_t leq_arg1_585487;
                                
                                if (protect_cond_conj_587805) {
                                    int64_t x_587795 = ((int64_t *) mem_param_587232.mem)[slice_585486];
                                    
                                    leq_arg1_585487 = x_587795;
                                } else {
                                    leq_arg1_585487 = (int64_t) 0;
                                }
                                
                                bool x_585488 = sle64((int64_t) 0, i_585472);
                                bool bounds_check_585489 = cond_585479 && x_585488;
                                bool protect_assert_disj_587798 = bounds_check_585489 || loop_not_taken_587793;
                                bool protect_assert_disj_587807 = cond_585477 || protect_assert_disj_587798;
                                bool index_certs_585490;
                                
                                if (!protect_assert_disj_587807) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585472, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585491 = defunc_0_f_res_585412 + i_585472;
                                int64_t slice_585492 = start_585217 + slice_585491;
                                int64_t leq_arg0_585493;
                                
                                if (protect_cond_conj_587805) {
                                    int64_t x_587799 = ((int64_t *) mem_param_587232.mem)[slice_585492];
                                    
                                    leq_arg0_585493 = x_587799;
                                } else {
                                    leq_arg0_585493 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585494 = sle64(leq_arg0_585493, leq_arg1_585487);
                                bool x_587866 = cond_585479 && lifted_lambda_res_585494;
                                bool cond_585478 = cond_585477 || x_587866;
                                bool protect_assert_disj_587703 = cond_585478 || bounds_check_585483;
                                bool index_certs_585512;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585476, "] out of bounds for array of shape [", (long long) j_m_i_585423, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585502 = cond_585479 && x_585488;
                                bool loop_not_taken_587698 = !cond_585478;
                                bool protect_assert_disj_587699 = bounds_check_585502 || loop_not_taken_587698;
                                bool index_certs_585503;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585472, "] out of bounds for array of shape [", (long long) j_m_i_585436, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585514 = start_585217 + slice_585485;
                                int64_t binop_y_587326 = dim_457918 * slice_585514;
                                int64_t slice_585505 = start_585217 + slice_585491;
                                int64_t binop_y_587328 = dim_457918 * slice_585505;
                                int64_t ext_587330;
                                
                                if (cond_585478) {
                                    ext_587330 = binop_y_587328;
                                } else {
                                    ext_587330 = binop_y_587326;
                                }
                                
                                int64_t loopres_585495;
                                int64_t loopres_585496;
                                int64_t loopres_585498;
                                
                                if (cond_585478) {
                                    int64_t tmp_585499 = add64((int64_t) 1, i_585472);
                                    int64_t tmp_585506 = ((int64_t *) mem_param_587232.mem)[slice_585505];
                                    int64_t tmp_585508 = ((int64_t *) mem_param_587239.mem)[slice_585505];
                                    
                                    loopres_585495 = tmp_585499;
                                    loopres_585496 = tmp_585506;
                                    loopres_585498 = tmp_585508;
                                } else {
                                    int64_t tmp_585515 = ((int64_t *) mem_param_587232.mem)[slice_585514];
                                    int64_t tmp_585517 = ((int64_t *) mem_param_587239.mem)[slice_585514];
                                    
                                    loopres_585495 = i_585472;
                                    loopres_585496 = tmp_585515;
                                    loopres_585498 = tmp_585517;
                                }
                                ((int64_t *) mem_587282)[i_586146 * merge_block_sizze_580429 + k_585471] = loopres_585496;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587286, i_586146 * lmad_arg_587303 + k_585471 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587236.mem, ext_587330, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                                ((int64_t *) mem_587289)[i_586146 * merge_block_sizze_580429 + k_585471] = loopres_585498;
                                
                                int64_t i_tmp_588097 = loopres_585495;
                                
                                i_585472 = i_tmp_588097;
                            }
                            data_585467 = i_585472;
                        }
                        if (memblock_alloc(ctx, &mem_587356, bytes_587281, "mem_587356")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587356.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (uint64_t *) mem_587282, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429});
                        if (memblock_alloc(ctx, &mem_587361, bytes_587285, "mem_587361")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_587361.mem, (int64_t) 0, (int64_t []) {dim_457918 * merge_block_sizze_580429, dim_457918, (int64_t) 1}, (uint32_t *) mem_587286, (int64_t) 0, (int64_t []) {lmad_arg_587303, dim_457918, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429, dim_457918});
                        if (memblock_alloc(ctx, &mem_587365, bytes_587281, "mem_587365")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587365.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (uint64_t *) mem_587289, (int64_t) 0, (int64_t []) {merge_block_sizze_580429, (int64_t) 1}, (int64_t []) {num_blocks_585164, merge_block_sizze_580429});
                        if (memblock_set(ctx, &ext_mem_587413, &mem_587356, "mem_587356") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587410, &mem_587361, "mem_587361") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587406, &mem_587365, "mem_587365") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587242, i_586156 * next_stride_585145, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587413.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585145});
                    if (memblock_unref(ctx, &ext_mem_587413, "ext_mem_587413") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587246, i_586156 * lmad_arg_587263, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) ext_mem_587410.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {next_stride_585145, dim_457918});
                    if (memblock_unref(ctx, &ext_mem_587410, "ext_mem_587410") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587249, i_586156 * next_stride_585145, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587406.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585145});
                    if (memblock_unref(ctx, &ext_mem_587406, "ext_mem_587406") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585539 = next_stride_585145 * num_merges_585149;
                
                if (memblock_alloc(ctx, &mem_587429, bytes_587241, "mem_587429")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587429.mem, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (uint64_t *) mem_587242, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145});
                if (memblock_alloc(ctx, &mem_587434, bytes_587245, "mem_587434")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_587434.mem, (int64_t) 0, (int64_t []) {dim_457918 * next_stride_585145, dim_457918, (int64_t) 1}, (uint32_t *) mem_587246, (int64_t) 0, (int64_t []) {lmad_arg_587263, dim_457918, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145, dim_457918});
                if (memblock_alloc(ctx, &mem_587438, bytes_587241, "mem_587438")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587438.mem, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (uint64_t *) mem_587249, (int64_t) 0, (int64_t []) {next_stride_585145, (int64_t) 1}, (int64_t []) {num_merges_585149, next_stride_585145});
                
                bool loop_cond_585543 = slt64(next_stride_585145, flat_dim_580424);
                
                if (memblock_set(ctx, &mem_param_tmp_588064, &mem_587429, "mem_587429") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588065, &mem_587434, "mem_587434") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588066, &mem_587438, "mem_587438") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588067 = flat_dim_585539;
                bool loop_while_tmp_588068 = loop_cond_585543;
                int64_t stride_tmp_588072 = next_stride_585145;
                
                if (memblock_set(ctx, &mem_param_587232, &mem_param_tmp_588064, "mem_param_tmp_588064") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587236, &mem_param_tmp_588065, "mem_param_tmp_588065") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587239, &mem_param_tmp_588066, "mem_param_tmp_588066") != 0)
                    return 1;
                loop_dz2084Uz2082U_585139 = loop_dz2084Uz2082U_tmp_588067;
                loop_while_585140 = loop_while_tmp_588068;
                stride_585144 = stride_tmp_588072;
            }
            if (memblock_set(ctx, &ext_mem_587449, &mem_param_587232, "mem_param_587232") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587448, &mem_param_587236, "mem_param_587236") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587447, &mem_param_587239, "mem_param_587239") != 0)
                return 1;
            data_585133 = loop_dz2084Uz2082U_585139;
            data_585134 = loop_while_585140;
            data_585138 = stride_585144;
            if (memblock_unref(ctx, &mem_587219, "mem_587219") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587224, "mem_587224") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587228, "mem_587228") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585544 = slt64(m_580257, data_585133);
            bool y_585545 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_585544;
            bool ok_or_empty_585546 = empty_slice_580256 || y_585545;
            bool index_certs_585547;
            
            if (!ok_or_empty_585546) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580247, "] out of bounds for array of shape [", (long long) data_585133, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587456, &ext_mem_587448, "ext_mem_587448") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587452, &ext_mem_587447, "ext_mem_587447") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587458, bytes_586456, "mem_587458")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587458.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587452.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580247});
        if (memblock_unref(ctx, &ext_mem_587452, "ext_mem_587452") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587461, bytes_586465, "mem_587461")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_587461.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) ext_mem_587456.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {m_580247, dim_457918});
        if (memblock_unref(ctx, &ext_mem_587456, "ext_mem_587456") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587463, &mem_587461, "mem_587461") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587462, &mem_587458, "mem_587458") != 0)
            return 1;
    } else {
        if (mem_586484_cached_sizze_588915 < bytes_586483) {
            err = lexical_realloc(ctx, &mem_586484, &mem_586484_cached_sizze_588915, bytes_586483);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586162 = 0; i_586162 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920; i_586162++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581064 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586162];
            float i64_res_581065 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581064);
            float defunc_0_fover_res_581066 = 1.5707964F / i64_res_581065;
            
            ((float *) mem_586484)[i_586162] = defunc_0_fover_res_581066;
        }
        if (mem_586492_cached_sizze_588916 < bytes_586456) {
            err = lexical_realloc(ctx, &mem_586492, &mem_586492_cached_sizze_588916, bytes_586456);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586494_cached_sizze_588917 < binop_x_586464) {
            err = lexical_realloc(ctx, &mem_586494, &mem_586494_cached_sizze_588917, binop_x_586464);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586502_cached_sizze_588918 < bytes_586501) {
            err = lexical_realloc(ctx, &mem_586502, &mem_586502_cached_sizze_588918, bytes_586501);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586510_cached_sizze_588919 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_588919, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586512_cached_sizze_588920 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586512, &mem_586512_cached_sizze_588920, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586526_cached_sizze_588921 < bytes_586525) {
            err = lexical_realloc(ctx, &mem_586526, &mem_586526_cached_sizze_588921, bytes_586525);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586542_cached_sizze_588923 < bytes_586541) {
            err = lexical_realloc(ctx, &mem_586542, &mem_586542_cached_sizze_588923, bytes_586541);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586187 = 0; i_586187 < m_580247; i_586187++) {
            for (int64_t i_586166 = 0; i_586166 < dim_457918; i_586166++) {
                float eta_p_583913 = ((float *) mem_586466.mem)[i_586187 * dim_457918 + i_586166];
                float eta_p_583914 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586166];
                float eta_p_583915 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586166];
                int64_t eta_p_583917 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586166];
                float defunc_0_f_res_583918 = eta_p_583913 - eta_p_583914;
                float defunc_0_f_res_583920 = defunc_0_f_res_583918 / eta_p_583915;
                int64_t f32_res_583922 = fptosi_f32_i64(defunc_0_f_res_583920);
                int64_t max_res_583924 = smax64((int64_t) 0, f32_res_583922);
                int64_t zm_lhs_583930 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586166];
                int64_t min_arg1_583931 = sub64(zm_lhs_583930, (int64_t) 1);
                int64_t min_res_583932 = smin64(max_res_583924, min_arg1_583931);
                int64_t defunc_0_f_res_583934 = mul64(eta_p_583917, min_res_583932);
                
                ((int64_t *) mem_586502)[i_586166] = defunc_0_f_res_583934;
            }
            
            int64_t defunc_0_foldl_res_581000;
            int64_t acc_581002 = (int64_t) 0;
            
            for (int64_t i_581001 = 0; i_581001 < dim_457918; i_581001++) {
                int64_t b_581003 = ((int64_t *) mem_586502)[i_581001];
                int64_t defunc_0_f_res_581004 = add64(acc_581002, b_581003);
                int64_t acc_tmp_588105 = defunc_0_f_res_581004;
                
                acc_581002 = acc_tmp_588105;
            }
            defunc_0_foldl_res_581000 = acc_581002;
            
            bool x_581005 = sle64((int64_t) 0, defunc_0_foldl_res_581000);
            bool y_581006 = slt64(defunc_0_foldl_res_581000, dz2080U_457919);
            bool bounds_check_581007 = x_581005 && y_581006;
            bool index_certs_581008;
            
            if (!bounds_check_581007) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_581000, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586172 = 0; i_586172 < dim_457918; i_586172++) {
                float eta_p_583842 = ((float *) mem_586466.mem)[i_586187 * dim_457918 + i_586172];
                float eta_p_583843 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_581000 * dim_457918 + i_586172];
                float defunc_0_f_res_583844 = eta_p_583842 - eta_p_583843;
                float defunc_0_ftimes_res_583846 = defunc_0_f_res_583844 * defunc_0_f_res_583844;
                
                ((float *) mem_586510)[i_586172] = defunc_0_ftimes_res_583846;
                ((float *) mem_586512)[i_586172] = defunc_0_f_res_583844;
            }
            
            float defunc_0_foldl_res_581018;
            float acc_581020 = 0.0F;
            
            for (int64_t i_581019 = 0; i_581019 < dim_457918; i_581019++) {
                float b_581021 = ((float *) mem_586510)[i_581019];
                float defunc_0_f_res_581022 = acc_581020 + b_581021;
                float acc_tmp_588108 = defunc_0_f_res_581022;
                
                acc_581020 = acc_tmp_588108;
            }
            defunc_0_foldl_res_581018 = acc_581020;
            
            float sqrt_res_581023 = futrts_sqrt32(defunc_0_foldl_res_581018);
            
            for (int64_t nest_i_588109 = 0; nest_i_588109 < arg_580153; nest_i_588109++) {
                ((float *) mem_586526)[nest_i_588109] = 0.0F;
            }
            for (int64_t i_581026 = 0; i_581026 < arg_580153; i_581026++) {
                bool y_581028 = slt64(i_581026, dim_457918);
                bool index_certs_581029;
                
                if (!y_581028) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581026, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_581031 = add64((int64_t) 1, i_581026);
                int64_t j_m_i_581032 = sub64(dim_457918, map_arg1_581031);
                bool empty_slice_581033 = j_m_i_581032 == (int64_t) 0;
                int64_t m_581034 = sub64(j_m_i_581032, (int64_t) 1);
                int64_t i_p_m_t_s_581035 = add64(map_arg1_581031, m_581034);
                bool zzero_leq_i_p_m_t_s_581036 = sle64((int64_t) 0, i_p_m_t_s_581035);
                bool i_p_m_t_s_leq_w_581037 = slt64(i_p_m_t_s_581035, dim_457918);
                bool zzero_lte_i_581038 = sle64((int64_t) 0, map_arg1_581031);
                bool i_lte_j_581039 = sle64(map_arg1_581031, dim_457918);
                bool y_581040 = i_p_m_t_s_leq_w_581037 && zzero_lte_i_581038;
                bool y_581041 = zzero_leq_i_p_m_t_s_581036 && y_581040;
                bool forwards_ok_581042 = i_lte_j_581039 && y_581041;
                bool ok_or_empty_581043 = empty_slice_581033 || forwards_ok_581042;
                bool index_certs_581044;
                
                if (!ok_or_empty_581043) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_581031, ":", (long long) dim_457918, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586530 = (int64_t) 4 * j_m_i_581032;
                float this_x_581030 = ((float *) mem_586512)[i_581026];
                
                if (mem_586531_cached_sizze_588922 < bytes_586530) {
                    err = lexical_realloc(ctx, &mem_586531, &mem_586531_cached_sizze_588922, bytes_586530);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586177 = 0; i_586177 < j_m_i_581032; i_586177++) {
                    int64_t slice_586398 = map_arg1_581031 + i_586177;
                    float eta_p_581047 = ((float *) mem_586512)[slice_586398];
                    float defunc_0_ftimes_res_581048 = eta_p_581047 * eta_p_581047;
                    
                    ((float *) mem_586531)[i_586177] = defunc_0_ftimes_res_581048;
                }
                
                float defunc_0_foldl_res_581049;
                float acc_581051 = 0.0F;
                
                for (int64_t i_581050 = 0; i_581050 < j_m_i_581032; i_581050++) {
                    float b_581052 = ((float *) mem_586531)[i_581050];
                    float defunc_0_f_res_581053 = acc_581051 + b_581052;
                    float acc_tmp_588112 = defunc_0_f_res_581053;
                    
                    acc_581051 = acc_tmp_588112;
                }
                defunc_0_foldl_res_581049 = acc_581051;
                
                float sqrt_res_581054 = futrts_sqrt32(defunc_0_foldl_res_581049);
                float atan2_res_581055 = futrts_atan2_32(sqrt_res_581054, this_x_581030);
                
                ((float *) mem_586526)[i_581026] = atan2_res_581055;
            }
            for (int64_t i_586181 = 0; i_586181 < arg_580153; i_586181++) {
                float eta_p_581073 = ((float *) mem_586526)[i_586181];
                float eta_p_581074 = ((float *) mem_586484)[i_586181];
                int64_t eta_p_581075 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586181];
                int64_t eta_p_581076 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586181];
                float i64_res_581077 = sitofp_i64_f32(eta_p_581075);
                float defunc_0_fover_res_581078 = eta_p_581073 / eta_p_581074;
                float defunc_0_ftimes_res_581079 = i64_res_581077 * defunc_0_fover_res_581078;
                int64_t f32_res_581080 = fptosi_f32_i64(defunc_0_ftimes_res_581079);
                bool cond_581081 = slt64(f32_res_581080, (int64_t) 0);
                int64_t defunc_0_f_res_581082;
                
                if (cond_581081) {
                    defunc_0_f_res_581082 = (int64_t) 0;
                } else {
                    bool cond_581083 = sle64(eta_p_581076, f32_res_581080);
                    int64_t defunc_0_f_res_f_res_581084;
                    
                    if (cond_581083) {
                        int64_t defunc_0_f_res_f_res_t_res_585554 = sub64(eta_p_581076, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_581084 = defunc_0_f_res_f_res_t_res_585554;
                    } else {
                        defunc_0_f_res_f_res_581084 = f32_res_581080;
                    }
                    defunc_0_f_res_581082 = defunc_0_f_res_f_res_581084;
                }
                ((int64_t *) mem_586542)[i_586181] = defunc_0_f_res_581082;
            }
            
            int64_t defunc_0_foldl_res_581086;
            int64_t acc_581088 = (int64_t) 0;
            
            for (int64_t i_581087 = 0; i_581087 < arg_580153; i_581087++) {
                int64_t b_581089 = ((int64_t *) mem_586542)[i_581087];
                int64_t defunc_0_f_res_581090 = add64(acc_581088, b_581089);
                int64_t acc_tmp_588114 = defunc_0_f_res_581090;
                
                acc_581088 = acc_tmp_588114;
            }
            defunc_0_foldl_res_581086 = acc_581088;
            
            int64_t zp_lhs_581091 = mul64(total_angle_no_457928, defunc_0_foldl_res_581000);
            int64_t get_id_from_grid_angle_res_581092 = add64(defunc_0_foldl_res_581086, zp_lhs_581091);
            
            ((int64_t *) mem_586492)[i_586187] = get_id_from_grid_angle_res_581092;
            ((float *) mem_586494)[i_586187] = sqrt_res_581023;
        }
        
        int64_t reduce_arg1_581120;
        
        if (x_581100) {
            int64_t x_585560 = ((int64_t *) mem_586492)[(int64_t) 0];
            
            reduce_arg1_581120 = x_585560;
        } else {
            reduce_arg1_581120 = (int64_t) 0;
        }
        
        float reduce_arg1_581122;
        
        if (x_581100) {
            float x_585561 = ((float *) mem_586494)[(int64_t) 0];
            
            reduce_arg1_581122 = x_585561;
        } else {
            reduce_arg1_581122 = 0.0F;
        }
        if (cond_581099) {
            if (memblock_set(ctx, &ext_mem_587021, &mem_586466, "mem_586466") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587017, &mem_586468, "mem_586468") != 0)
                return 1;
        } else {
            int64_t ext_586564;
            int64_t defunc_0_reduce_res_585786;
            float defunc_0_reduce_res_585787;
            int64_t defunc_0_reduce_res_585789;
            int64_t redout_586190;
            float redout_586191;
            int64_t redout_586193;
            int64_t ctx_param_ext_586555;
            
            if (memblock_set(ctx, &mem_param_586557, &mem_586466, "mem_586466") != 0)
                return 1;
            ctx_param_ext_586555 = (int64_t) 0;
            redout_586190 = reduce_arg1_581120;
            redout_586191 = reduce_arg1_581122;
            redout_586193 = reduce_arg1_581124;
            for (int64_t i_586194 = 0; i_586194 < m_580247; i_586194++) {
                int64_t x_581138 = ((int64_t *) mem_586492)[i_586194];
                float x_581139 = ((float *) mem_586494)[i_586194];
                int64_t x_581141 = ((int64_t *) mem_586468.mem)[i_586194];
                bool cond_581150 = slt64(redout_586190, x_581138);
                bool cond_581151 = redout_586190 == x_581138;
                bool zlze_res_581152 = redout_586191 <= x_581139;
                bool x_581153 = cond_581151 && zlze_res_581152;
                bool x_581154 = !cond_581150;
                bool y_581155 = x_581153 && x_581154;
                bool defunc_0_leq_res_581156 = cond_581150 || y_581155;
                int64_t defunc_0_op_res_581157;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581157 = x_581138;
                } else {
                    defunc_0_op_res_581157 = redout_586190;
                }
                
                float defunc_0_op_res_581158;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581158 = x_581139;
                } else {
                    defunc_0_op_res_581158 = redout_586191;
                }
                
                int64_t defunc_0_op_res_581159;
                
                if (defunc_0_leq_res_581156) {
                    defunc_0_op_res_581159 = x_581141;
                } else {
                    defunc_0_op_res_581159 = redout_586193;
                }
                
                int64_t binop_y_586558 = dim_457918 * i_586194;
                int64_t ext_586561;
                
                if (defunc_0_leq_res_581156) {
                    ext_586561 = binop_y_586558;
                } else {
                    ext_586561 = ctx_param_ext_586555;
                }
                if (defunc_0_leq_res_581156) {
                    if (memblock_set(ctx, &ext_mem_586562, &mem_586466, "mem_586466") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586562, &mem_param_586557, "mem_param_586557") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588115, &ext_mem_586562, "ext_mem_586562") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588116 = ext_586561;
                int64_t redout_tmp_588117 = defunc_0_op_res_581157;
                float redout_tmp_588118 = defunc_0_op_res_581158;
                int64_t redout_tmp_588120 = defunc_0_op_res_581159;
                
                if (memblock_set(ctx, &mem_param_586557, &mem_param_tmp_588115, "mem_param_tmp_588115") != 0)
                    return 1;
                ctx_param_ext_586555 = ctx_param_ext_tmp_588116;
                redout_586190 = redout_tmp_588117;
                redout_586191 = redout_tmp_588118;
                redout_586193 = redout_tmp_588120;
            }
            if (memblock_set(ctx, &ext_mem_586565, &mem_param_586557, "mem_param_586557") != 0)
                return 1;
            ext_586564 = ctx_param_ext_586555;
            defunc_0_reduce_res_585786 = redout_586190;
            defunc_0_reduce_res_585787 = redout_586191;
            defunc_0_reduce_res_585789 = redout_586193;
            if (mem_586568_cached_sizze_588924 < bytes_586567) {
                err = lexical_realloc(ctx, &mem_586568, &mem_586568_cached_sizze_588924, bytes_586567);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586571_cached_sizze_588925 < bytes_586570) {
                err = lexical_realloc(ctx, &mem_586571, &mem_586571_cached_sizze_588925, bytes_586570);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586575_cached_sizze_588926 < bytes_586574) {
                err = lexical_realloc(ctx, &mem_586575, &mem_586575_cached_sizze_588926, bytes_586574);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586578_cached_sizze_588927 < bytes_586567) {
                err = lexical_realloc(ctx, &mem_586578, &mem_586578_cached_sizze_588927, bytes_586567);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586598_cached_sizze_588928 < bytes_586597) {
                err = lexical_realloc(ctx, &mem_586598, &mem_586598_cached_sizze_588928, bytes_586597);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586600_cached_sizze_588929 < bytes_586599) {
                err = lexical_realloc(ctx, &mem_586600, &mem_586600_cached_sizze_588929, bytes_586599);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586603_cached_sizze_588930 < bytes_586602) {
                err = lexical_realloc(ctx, &mem_586603, &mem_586603_cached_sizze_588930, bytes_586602);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586605_cached_sizze_588931 < bytes_586597) {
                err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_588931, bytes_586597);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586216 = 0; i_586216 < x_582200; i_586216++) {
                int64_t zp_lhs_581181 = mul64(block_sizze_581116, i_586216);
                
                for (int64_t i_586203 = 0; i_586203 < block_sizze_581116; i_586203++) {
                    int64_t k_581187 = add64(zp_lhs_581181, i_586203);
                    bool cond_581188 = slt64(k_581187, m_580247);
                    int64_t binop_y_586619 = dim_457918 * k_581187;
                    int64_t ext_586622;
                    
                    if (cond_581188) {
                        ext_586622 = binop_y_586619;
                    } else {
                        ext_586622 = ext_586564;
                    }
                    
                    int64_t lifted_lambda_res_581189;
                    float lifted_lambda_res_581190;
                    int64_t lifted_lambda_res_581192;
                    
                    if (cond_581188) {
                        bool x_585562 = sle64((int64_t) 0, k_581187);
                        bool bounds_check_585563 = cond_581188 && x_585562;
                        bool index_certs_585564;
                        
                        if (!bounds_check_585563) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_581187, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585565 = ((int64_t *) mem_586492)[k_581187];
                        float lifted_lambda_res_t_res_585566 = ((float *) mem_586494)[k_581187];
                        int64_t lifted_lambda_res_t_res_585568 = ((int64_t *) mem_586468.mem)[k_581187];
                        
                        if (memblock_set(ctx, &ext_mem_586623, &mem_586466, "mem_586466") != 0)
                            return 1;
                        lifted_lambda_res_581189 = lifted_lambda_res_t_res_585565;
                        lifted_lambda_res_581190 = lifted_lambda_res_t_res_585566;
                        lifted_lambda_res_581192 = lifted_lambda_res_t_res_585568;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586623, &ext_mem_586565, "ext_mem_586565") != 0)
                            return 1;
                        lifted_lambda_res_581189 = defunc_0_reduce_res_585786;
                        lifted_lambda_res_581190 = defunc_0_reduce_res_585787;
                        lifted_lambda_res_581192 = defunc_0_reduce_res_585789;
                    }
                    ((int64_t *) mem_586598)[i_586203] = lifted_lambda_res_581189;
                    ((float *) mem_586600)[i_586203] = lifted_lambda_res_581190;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586603, i_586203 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586623.mem, ext_586622, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                    if (memblock_unref(ctx, &ext_mem_586623, "ext_mem_586623") != 0)
                        return 1;
                    ((int64_t *) mem_586605)[i_586203] = lifted_lambda_res_581192;
                }
                if (!cond_581169) {
                    if (mem_586664_cached_sizze_588932 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_586664, &mem_586664_cached_sizze_588932, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586666_cached_sizze_588933 < bytes_586418) {
                        err = lexical_realloc(ctx, &mem_586666, &mem_586666_cached_sizze_588933, bytes_586418);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_581208 = 0; i_581208 < distance_581172; i_581208++) {
                        int64_t gt_arg1_581213 = add64((int64_t) 1, i_581208);
                        bool x_581214 = sle64((int64_t) 0, gt_arg1_581213);
                        bool y_581215 = slt64(gt_arg1_581213, block_sizze_581116);
                        bool bounds_check_581216 = x_581214 && y_581215;
                        bool index_certs_581217;
                        
                        if (!bounds_check_581216) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_581213, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_581220 = slt64(i_581208, block_sizze_581116);
                        bool index_certs_581221;
                        
                        if (!y_581220) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581208, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_581218 = ((int64_t *) mem_586598)[gt_arg1_581213];
                        float gt_arg1_581219 = ((float *) mem_586600)[gt_arg1_581213];
                        int64_t gt_arg0_581222 = ((int64_t *) mem_586598)[i_581208];
                        float gt_arg0_581223 = ((float *) mem_586600)[i_581208];
                        bool cond_581224 = slt64(gt_arg0_581222, gt_arg1_581218);
                        bool cond_581225 = gt_arg0_581222 == gt_arg1_581218;
                        bool zlze_res_581226 = gt_arg0_581223 <= gt_arg1_581219;
                        bool x_581227 = cond_581225 && zlze_res_581226;
                        bool x_581228 = !cond_581224;
                        bool y_581229 = x_581227 && x_581228;
                        bool defunc_0_leq_res_581230 = cond_581224 || y_581229;
                        bool defunc_0_lifted_gt_res_581231 = !defunc_0_leq_res_581230;
                        bool s_581232;
                        int64_t s_581237;
                        bool loop_while_581238;
                        int64_t j_581243;
                        
                        loop_while_581238 = defunc_0_lifted_gt_res_581231;
                        j_581243 = i_581208;
                        while (loop_while_581238) {
                            bool x_581244 = sle64((int64_t) 0, j_581243);
                            bool y_581245 = slt64(j_581243, block_sizze_581116);
                            bool bounds_check_581246 = x_581244 && y_581245;
                            bool index_certs_581247;
                            
                            if (!bounds_check_581246) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581243, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581253 = add64((int64_t) 1, j_581243);
                            bool x_581254 = sle64((int64_t) 0, copy_arg0_581253);
                            bool y_581255 = slt64(copy_arg0_581253, block_sizze_581116);
                            bool bounds_check_581256 = x_581254 && y_581255;
                            bool index_certs_581257;
                            
                            if (!bounds_check_581256) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_581253, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_581248 = ((int64_t *) mem_586598)[j_581243];
                            float copy_arg0_581249 = ((float *) mem_586600)[j_581243];
                            int64_t copy_arg0_581251 = ((int64_t *) mem_586605)[j_581243];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586664, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586603, (int64_t) 0 + j_581243 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            
                            int64_t copy_arg0_581258 = ((int64_t *) mem_586598)[copy_arg0_581253];
                            float copy_arg0_581259 = ((float *) mem_586600)[copy_arg0_581253];
                            int64_t copy_arg0_581261 = ((int64_t *) mem_586605)[copy_arg0_581253];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586603, (int64_t) 0 + copy_arg0_581253 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_586598)[j_581243] = copy_arg0_581258;
                            ((float *) mem_586600)[j_581243] = copy_arg0_581259;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586603, j_581243 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586666, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_586605)[j_581243] = copy_arg0_581261;
                            ((int64_t *) mem_586598)[copy_arg0_581253] = copy_arg0_581248;
                            ((float *) mem_586600)[copy_arg0_581253] = copy_arg0_581249;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586603, copy_arg0_581253 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586664, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_586605)[copy_arg0_581253] = copy_arg0_581251;
                            
                            int64_t tmp_581271 = sub64(j_581243, (int64_t) 1);
                            bool cond_581272 = sle64((int64_t) 0, tmp_581271);
                            bool loop_cond_581273;
                            
                            if (cond_581272) {
                                bool y_585571 = slt64(tmp_581271, block_sizze_581116);
                                bool bounds_check_585572 = cond_581272 && y_585571;
                                bool index_certs_585573;
                                
                                if (!bounds_check_585572) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581271, "] out of bounds for array of shape [", (long long) block_sizze_581116, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585569 = ((int64_t *) mem_586598)[j_581243];
                                float gt_arg1_585570 = ((float *) mem_586600)[j_581243];
                                int64_t gt_arg0_585574 = ((int64_t *) mem_586598)[tmp_581271];
                                float gt_arg0_585575 = ((float *) mem_586600)[tmp_581271];
                                bool cond_585576 = slt64(gt_arg0_585574, gt_arg1_585569);
                                bool cond_585577 = gt_arg0_585574 == gt_arg1_585569;
                                bool zlze_res_585578 = gt_arg0_585575 <= gt_arg1_585570;
                                bool x_585579 = cond_585577 && zlze_res_585578;
                                bool x_585580 = !cond_585576;
                                bool y_585581 = x_585579 && x_585580;
                                bool defunc_0_leq_res_585582 = cond_585576 || y_585581;
                                bool defunc_0_lifted_gt_res_585583 = !defunc_0_leq_res_585582;
                                
                                loop_cond_581273 = defunc_0_lifted_gt_res_585583;
                            } else {
                                loop_cond_581273 = 0;
                            }
                            
                            bool loop_while_tmp_588133 = loop_cond_581273;
                            int64_t j_tmp_588138 = tmp_581271;
                            
                            loop_while_581238 = loop_while_tmp_588133;
                            j_581243 = j_tmp_588138;
                        }
                        s_581232 = loop_while_581238;
                        s_581237 = j_581243;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586568, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586598, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586571, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586600, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_586575, i_586216 * lmad_arg_586596, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) mem_586603, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {block_sizze_581116, dim_457918});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586578, i_586216 * block_sizze_581116, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_581116});
            }
            if (memblock_unref(ctx, &ext_mem_586565, "ext_mem_586565") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586725, bytes_586567, "mem_586725")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586725.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint64_t *) mem_586568, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            if (memblock_alloc(ctx, &mem_586729, bytes_586570, "mem_586729")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_586729.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint32_t *) mem_586571, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            if (memblock_alloc(ctx, &mem_586734, bytes_586574, "mem_586734")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_586734.mem, (int64_t) 0, (int64_t []) {dim_457918 * block_sizze_581116, dim_457918, (int64_t) 1}, (uint32_t *) mem_586575, (int64_t) 0, (int64_t []) {lmad_arg_586596, dim_457918, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116, dim_457918});
            if (memblock_alloc(ctx, &mem_586738, bytes_586567, "mem_586738")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586738.mem, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (uint64_t *) mem_586578, (int64_t) 0, (int64_t []) {block_sizze_581116, (int64_t) 1}, (int64_t []) {x_582200, block_sizze_581116});
            
            int64_t data_581298;
            bool data_581299;
            int64_t data_581304;
            int64_t loop_dz2084Uz2082U_581305;
            bool loop_while_581306;
            int64_t stride_581311;
            
            if (memblock_set(ctx, &mem_param_586742, &mem_586725, "mem_586725") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586745, &mem_586729, "mem_586729") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586749, &mem_586734, "mem_586734") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586752, &mem_586738, "mem_586738") != 0)
                return 1;
            loop_dz2084Uz2082U_581305 = flat_dim_581126;
            loop_while_581306 = loop_cond_581295;
            stride_581311 = block_sizze_581116;
            while (loop_while_581306) {
                int64_t next_stride_581312 = mul64((int64_t) 2, stride_581311);
                bool zzero_581313 = next_stride_581312 == (int64_t) 0;
                bool nonzzero_581314 = !zzero_581313;
                bool nonzzero_cert_581315;
                
                if (!nonzzero_581314) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_581316 = sdiv64(flat_dim_581126, next_stride_581312);
                bool bounds_invalid_upwards_581317 = slt64(num_merges_581316, (int64_t) 0);
                bool valid_581318 = !bounds_invalid_upwards_581317;
                bool range_valid_c_581319;
                
                if (!valid_581318) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_581316, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:965:33-56\n   #6  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_581321 = sub64(next_stride_581312, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_581322 = sle64((int64_t) 0, m_581321);
                bool cond_581324 = slt64(next_stride_581312, (int64_t) 10);
                bool protect_assert_disj_581325 = nonzzero_581297 || cond_581324;
                bool nonzzero_cert_581326;
                
                if (!protect_assert_disj_581325) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_581327 = smod_safe64(next_stride_581312, merge_block_sizze_581132);
                bool num_blocks_581328 = zeze_lhs_581327 == (int64_t) 0;
                bool protect_assert_disj_581329 = cond_581324 || num_blocks_581328;
                bool assert_c_581330;
                
                if (!protect_assert_disj_581329) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_581333 = sdiv_safe64(next_stride_581312, merge_block_sizze_581132);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334 = add64((int64_t) 1, num_blocks_581333);
                int64_t j_m_i_581335 = sub64(next_stride_581312, stride_581311);
                int64_t flat_dim_581336 = merge_block_sizze_581132 * num_blocks_581333;
                bool bounds_invalid_upwards_581337 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, (int64_t) 0);
                bool zzero_lte_i_581338 = sle64((int64_t) 0, stride_581311);
                bool i_lte_j_581339 = sle64(stride_581311, next_stride_581312);
                bool empty_slice_581340 = stride_581311 == (int64_t) 0;
                int64_t m_581341 = sub64(stride_581311, (int64_t) 1);
                bool bounds_invalid_upwards_581342 = slt64(num_blocks_581333, (int64_t) 0);
                bool empty_slice_581343 = j_m_i_581335 == (int64_t) 0;
                int64_t m_581344 = sub64(j_m_i_581335, (int64_t) 1);
                bool cond_581345 = slt64((int64_t) 0, stride_581311);
                bool valid_581346 = !bounds_invalid_upwards_581337;
                bool zzero_leq_i_p_m_t_s_581347 = sle64((int64_t) 0, m_581341);
                bool i_p_m_t_s_leq_w_581348 = slt64(m_581341, next_stride_581312);
                bool valid_581349 = !bounds_invalid_upwards_581342;
                bool i_p_m_t_s_leq_w_581350 = slt64(m_581321, flat_dim_581336);
                int64_t i_p_m_t_s_581351 = add64(stride_581311, m_581344);
                bool y_581352 = slt64((int64_t) 0, j_m_i_581335);
                bool protect_assert_disj_581353 = cond_581324 || valid_581346;
                bool range_valid_c_581354;
                
                if (!protect_assert_disj_581353) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581355 = zzero_leq_i_p_m_t_s_581347 && i_p_m_t_s_leq_w_581348;
                bool protect_assert_disj_581356 = cond_581324 || valid_581349;
                bool range_valid_c_581357;
                
                if (!protect_assert_disj_581356) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_581333, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581358 = zzero_leq_i_p_m_t_s_581322 && i_p_m_t_s_leq_w_581350;
                bool zzero_leq_i_p_m_t_s_581359 = sle64((int64_t) 0, i_p_m_t_s_581351);
                bool i_p_m_t_s_leq_w_581360 = slt64(i_p_m_t_s_581351, next_stride_581312);
                bool forwards_ok_581361 = zzero_lte_i_581338 && y_581355;
                bool ok_or_empty_581362 = zzero_581313 || y_581358;
                bool y_581363 = zzero_lte_i_581338 && i_p_m_t_s_leq_w_581360;
                bool protect_assert_disj_581364 = cond_581345 || y_581352;
                bool ok_or_empty_581365 = empty_slice_581340 || forwards_ok_581361;
                bool protect_assert_disj_581366 = cond_581324 || ok_or_empty_581362;
                bool index_certs_581367;
                
                if (!protect_assert_disj_581366) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581312, "] out of bounds for array of shape [", (long long) flat_dim_581336, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_581368 = zzero_leq_i_p_m_t_s_581359 && y_581363;
                bool loop_not_taken_581369 = !cond_581324;
                bool protect_assert_disj_581370 = protect_assert_disj_581364 || loop_not_taken_581369;
                bool index_certs_581371;
                
                if (!protect_assert_disj_581370) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581372 = cond_581324 || ok_or_empty_581365;
                bool index_certs_581373;
                
                if (!protect_assert_disj_581372) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581311, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_581374 = i_lte_j_581339 && y_581368;
                bool protect_assert_disj_581375 = ok_or_empty_581365 || loop_not_taken_581369;
                bool index_certs_581376;
                
                if (!protect_assert_disj_581375) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_581311, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_581377 = empty_slice_581343 || forwards_ok_581374;
                bool protect_assert_disj_581378 = loop_not_taken_581369 || ok_or_empty_581377;
                bool index_certs_581379;
                
                if (!protect_assert_disj_581378) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581311, ":] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_581380 = cond_581324 || ok_or_empty_581377;
                bool index_certs_581381;
                
                if (!protect_assert_disj_581380) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_581311, ":] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586753 = (int64_t) 8 * num_merges_581316;
                int64_t bytes_586754 = next_stride_581312 * binop_x_586753;
                int64_t binop_x_586756 = (int64_t) 4 * num_merges_581316;
                int64_t bytes_586757 = next_stride_581312 * binop_x_586756;
                int64_t bytes_586761 = dim_457918 * bytes_586757;
                bool i_lte_j_581323 = sle64((int64_t) 0, next_stride_581312);
                
                if (mem_586755_cached_sizze_588934 < bytes_586754) {
                    err = lexical_realloc(ctx, &mem_586755, &mem_586755_cached_sizze_588934, bytes_586754);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586758_cached_sizze_588935 < bytes_586757) {
                    err = lexical_realloc(ctx, &mem_586758, &mem_586758_cached_sizze_588935, bytes_586757);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586762_cached_sizze_588936 < bytes_586761) {
                    err = lexical_realloc(ctx, &mem_586762, &mem_586762_cached_sizze_588936, bytes_586761);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586765_cached_sizze_588937 < bytes_586754) {
                    err = lexical_realloc(ctx, &mem_586765, &mem_586765_cached_sizze_588937, bytes_586754);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586783 = dim_457918 * next_stride_581312;
                int64_t bytes_586784 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334;
                int64_t binop_x_586800 = (int64_t) 8 * num_blocks_581333;
                int64_t bytes_586801 = merge_block_sizze_581132 * binop_x_586800;
                int64_t binop_x_586803 = (int64_t) 4 * num_blocks_581333;
                int64_t bytes_586804 = merge_block_sizze_581132 * binop_x_586803;
                int64_t bytes_586808 = dim_457918 * bytes_586804;
                int64_t bytes_586915 = (int64_t) 16 * stride_581311;
                int64_t bytes_586917 = (int64_t) 8 * stride_581311;
                int64_t bytes_586922 = dim_457918 * bytes_586917;
                
                for (int64_t i_586249 = 0; i_586249 < num_merges_581316; i_586249++) {
                    int64_t start_581387 = mul64(next_stride_581312, i_586249);
                    int64_t j_m_i_581388 = sub64(loop_dz2084Uz2082U_581305, start_581387);
                    bool empty_slice_581389 = j_m_i_581388 == (int64_t) 0;
                    int64_t m_581390 = sub64(j_m_i_581388, (int64_t) 1);
                    int64_t i_p_m_t_s_581391 = add64(start_581387, m_581390);
                    bool zzero_leq_i_p_m_t_s_581392 = sle64((int64_t) 0, i_p_m_t_s_581391);
                    bool i_p_m_t_s_leq_w_581393 = slt64(i_p_m_t_s_581391, loop_dz2084Uz2082U_581305);
                    bool zzero_lte_i_581394 = sle64((int64_t) 0, start_581387);
                    bool i_lte_j_581395 = sle64(start_581387, loop_dz2084Uz2082U_581305);
                    bool y_581396 = i_p_m_t_s_leq_w_581393 && zzero_lte_i_581394;
                    bool y_581397 = zzero_leq_i_p_m_t_s_581392 && y_581396;
                    bool forwards_ok_581398 = i_lte_j_581395 && y_581397;
                    bool ok_or_empty_581399 = empty_slice_581389 || forwards_ok_581398;
                    bool index_certs_581400;
                    
                    if (!ok_or_empty_581399) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_581387, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_581305, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_581401 = slt64(m_581321, j_m_i_581388);
                    bool y_581402 = zzero_leq_i_p_m_t_s_581322 && i_p_m_t_s_leq_w_581401;
                    bool forwards_ok_581403 = i_lte_j_581323 && y_581402;
                    bool ok_or_empty_581404 = zzero_581313 || forwards_ok_581403;
                    bool index_certs_581405;
                    
                    if (!ok_or_empty_581404) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_581312, "] out of bounds for array of shape [", (long long) j_m_i_581388, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:965:33-56\n   #8  ftSkyline.fut:954:17-965:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585631 = stride_581311 + start_581387;
                    int64_t binop_y_586910 = dim_457918 * slice_585631;
                    int64_t binop_y_586912 = dim_457918 * start_581387;
                    int64_t ext_586914;
                    
                    if (cond_581345) {
                        ext_586914 = binop_y_586912;
                    } else {
                        ext_586914 = binop_y_586910;
                    }
                    if (cond_581324) {
                        int64_t dummy_585623;
                        float dummy_585624;
                        int64_t dummy_585626;
                        
                        if (cond_581345) {
                            int64_t head_res_585627 = ((int64_t *) mem_param_586742.mem)[start_581387];
                            float head_res_585628 = ((float *) mem_param_586745.mem)[start_581387];
                            int64_t head_res_585630 = ((int64_t *) mem_param_586752.mem)[start_581387];
                            
                            dummy_585623 = head_res_585627;
                            dummy_585624 = head_res_585628;
                            dummy_585626 = head_res_585630;
                        } else {
                            int64_t head_res_585632 = ((int64_t *) mem_param_586742.mem)[slice_585631];
                            float head_res_585633 = ((float *) mem_param_586745.mem)[slice_585631];
                            int64_t head_res_585635 = ((int64_t *) mem_param_586752.mem)[slice_585631];
                            
                            dummy_585623 = head_res_585632;
                            dummy_585624 = head_res_585633;
                            dummy_585626 = head_res_585635;
                        }
                        if (memblock_alloc(ctx, &mem_586916, bytes_586915, "mem_586916")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588154 = 0; nest_i_588154 < next_stride_581312; nest_i_588154++) {
                            ((int64_t *) mem_586916.mem)[nest_i_588154] = dummy_585623;
                        }
                        if (memblock_alloc(ctx, &mem_586918, bytes_586917, "mem_586918")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588155 = 0; nest_i_588155 < next_stride_581312; nest_i_588155++) {
                            ((float *) mem_586918.mem)[nest_i_588155] = dummy_585624;
                        }
                        if (memblock_alloc(ctx, &mem_586920, bytes_586915, "mem_586920")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588156 = 0; nest_i_588156 < next_stride_581312; nest_i_588156++) {
                            ((int64_t *) mem_586920.mem)[nest_i_588156] = dummy_585626;
                        }
                        if (memblock_alloc(ctx, &mem_586923, bytes_586922, "mem_586923")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588157 = 0; nest_i_588157 < next_stride_581312; nest_i_588157++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586923.mem, nest_i_588157 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586749.mem, ext_586914, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                        }
                        
                        int64_t data_585640;
                        int64_t i_585646 = (int64_t) 0;
                        
                        for (int64_t k_585645 = 0; k_585645 < next_stride_581312; k_585645++) {
                            int64_t j_585651 = sub64(k_585645, i_585646);
                            bool cond_585652 = j_585651 == j_m_i_581335;
                            bool x_587826 = !cond_585652;
                            bool cond_585654 = slt64(i_585646, stride_581311);
                            bool x_585656 = sle64((int64_t) 0, j_585651);
                            bool y_585657 = slt64(j_585651, j_m_i_581335);
                            bool bounds_check_585658 = x_585656 && y_585657;
                            bool loop_not_taken_587814 = !cond_585654;
                            bool protect_assert_disj_587815 = bounds_check_585658 || loop_not_taken_587814;
                            bool protect_assert_disj_587829 = cond_585652 || protect_assert_disj_587815;
                            bool index_certs_585659;
                            
                            if (!protect_assert_disj_587829) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585651, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585660 = stride_581311 + j_585651;
                            int64_t slice_585661 = start_581387 + slice_585660;
                            bool protect_cond_conj_587830 = cond_585654 && x_587826;
                            int64_t leq_arg1_585662;
                            
                            if (protect_cond_conj_587830) {
                                int64_t x_587816 = ((int64_t *) mem_param_586742.mem)[slice_585661];
                                
                                leq_arg1_585662 = x_587816;
                            } else {
                                leq_arg1_585662 = (int64_t) 0;
                            }
                            
                            float leq_arg1_585663;
                            
                            if (protect_cond_conj_587830) {
                                float x_587818 = ((float *) mem_param_586745.mem)[slice_585661];
                                
                                leq_arg1_585663 = x_587818;
                            } else {
                                leq_arg1_585663 = 0.0F;
                            }
                            
                            bool x_585664 = sle64((int64_t) 0, i_585646);
                            bool bounds_check_585665 = cond_585654 && x_585664;
                            bool protect_assert_disj_587821 = bounds_check_585665 || loop_not_taken_587814;
                            bool protect_assert_disj_587833 = cond_585652 || protect_assert_disj_587821;
                            bool index_certs_585666;
                            
                            if (!protect_assert_disj_587833) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585646, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585667 = start_581387 + i_585646;
                            int64_t leq_arg0_585668;
                            
                            if (protect_cond_conj_587830) {
                                int64_t x_587822 = ((int64_t *) mem_param_586742.mem)[slice_585667];
                                
                                leq_arg0_585668 = x_587822;
                            } else {
                                leq_arg0_585668 = (int64_t) 0;
                            }
                            
                            float leq_arg0_585669;
                            
                            if (protect_cond_conj_587830) {
                                float x_587824 = ((float *) mem_param_586745.mem)[slice_585667];
                                
                                leq_arg0_585669 = x_587824;
                            } else {
                                leq_arg0_585669 = 0.0F;
                            }
                            
                            bool cond_585670 = slt64(leq_arg0_585668, leq_arg1_585662);
                            bool cond_585671 = leq_arg0_585668 == leq_arg1_585662;
                            bool zlze_res_585672 = leq_arg0_585669 <= leq_arg1_585663;
                            bool x_585673 = cond_585671 && zlze_res_585672;
                            bool x_585674 = !cond_585670;
                            bool y_585675 = x_585673 && x_585674;
                            bool defunc_0_leq_res_585676 = cond_585670 || y_585675;
                            bool x_587869 = cond_585654 && defunc_0_leq_res_585676;
                            bool cond_585653 = cond_585652 || x_587869;
                            bool protect_assert_disj_587734 = cond_585653 || bounds_check_585658;
                            bool index_certs_585695;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585651, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585685 = cond_585654 && x_585664;
                            bool loop_not_taken_587729 = !cond_585653;
                            bool protect_assert_disj_587730 = bounds_check_585685 || loop_not_taken_587729;
                            bool index_certs_585686;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585646, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:965:33-56\n   #9  ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585697 = start_581387 + slice_585660;
                            int64_t binop_y_586937 = dim_457918 * slice_585697;
                            int64_t binop_y_586939 = dim_457918 * slice_585667;
                            int64_t ext_586941;
                            
                            if (cond_585653) {
                                ext_586941 = binop_y_586939;
                            } else {
                                ext_586941 = binop_y_586937;
                            }
                            
                            int64_t loopres_585677;
                            int64_t loopres_585678;
                            float loopres_585679;
                            int64_t loopres_585681;
                            
                            if (cond_585653) {
                                int64_t tmp_585682 = add64((int64_t) 1, i_585646);
                                int64_t tmp_585688 = ((int64_t *) mem_param_586742.mem)[slice_585667];
                                float tmp_585689 = ((float *) mem_param_586745.mem)[slice_585667];
                                int64_t tmp_585691 = ((int64_t *) mem_param_586752.mem)[slice_585667];
                                
                                loopres_585677 = tmp_585682;
                                loopres_585678 = tmp_585688;
                                loopres_585679 = tmp_585689;
                                loopres_585681 = tmp_585691;
                            } else {
                                int64_t tmp_585698 = ((int64_t *) mem_param_586742.mem)[slice_585697];
                                float tmp_585699 = ((float *) mem_param_586745.mem)[slice_585697];
                                int64_t tmp_585701 = ((int64_t *) mem_param_586752.mem)[slice_585697];
                                
                                loopres_585677 = i_585646;
                                loopres_585678 = tmp_585698;
                                loopres_585679 = tmp_585699;
                                loopres_585681 = tmp_585701;
                            }
                            ((int64_t *) mem_586916.mem)[k_585645] = loopres_585678;
                            ((float *) mem_586918.mem)[k_585645] = loopres_585679;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586923.mem, k_585645 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586749.mem, ext_586941, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            ((int64_t *) mem_586920.mem)[k_585645] = loopres_585681;
                            
                            int64_t i_tmp_588158 = loopres_585677;
                            
                            i_585646 = i_tmp_588158;
                        }
                        data_585640 = i_585646;
                        if (memblock_set(ctx, &ext_mem_586967, &mem_586916, "mem_586916") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586964, &mem_586918, "mem_586918") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586961, &mem_586923, "mem_586923") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586957, &mem_586920, "mem_586920") != 0)
                            return 1;
                    } else {
                        if (mem_586785_cached_sizze_588938 < bytes_586784) {
                            err = lexical_realloc(ctx, &mem_586785, &mem_586785_cached_sizze_588938, bytes_586784);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586787_cached_sizze_588939 < bytes_586784) {
                            err = lexical_realloc(ctx, &mem_586787, &mem_586787_cached_sizze_588939, bytes_586784);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586225 = 0; i_586225 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334; i_586225++) {
                            int64_t split_count_arg3_581497 = mul64(merge_block_sizze_581132, i_586225);
                            int64_t defunc_0_split_count_res_581498;
                            int64_t defunc_0_split_count_res_581499;
                            int64_t defunc_0_split_count_res_581500;
                            int64_t defunc_0_split_count_res_581501;
                            int64_t defunc_0_split_count_res_581502;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_581498, &defunc_0_split_count_res_581499, &defunc_0_split_count_res_581500, &defunc_0_split_count_res_581501, &defunc_0_split_count_res_581502, (int64_t) 0, stride_581311, (int64_t) 0, j_m_i_581335, split_count_arg3_581497) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_581503 = slt64((int64_t) 0, defunc_0_split_count_res_581502);
                            bool defunc_0_split_count_res_581504;
                            int64_t defunc_0_split_count_res_581505;
                            int64_t defunc_0_split_count_res_581506;
                            int64_t defunc_0_split_count_res_581507;
                            int64_t defunc_0_split_count_res_581508;
                            int64_t defunc_0_split_count_res_581509;
                            bool loop_while_581510;
                            int64_t ss_581511;
                            int64_t ss_581512;
                            int64_t tt_581513;
                            int64_t tt_581514;
                            int64_t count_581515;
                            
                            loop_while_581510 = loop_cond_581503;
                            ss_581511 = defunc_0_split_count_res_581498;
                            ss_581512 = defunc_0_split_count_res_581499;
                            tt_581513 = defunc_0_split_count_res_581500;
                            tt_581514 = defunc_0_split_count_res_581501;
                            count_581515 = defunc_0_split_count_res_581502;
                            while (loop_while_581510) {
                                int64_t zlze_lhs_581516 = sub64(ss_581512, ss_581511);
                                bool cond_581517 = sle64(zlze_lhs_581516, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_581518;
                                int64_t defunc_0_lifted_step_res_581519;
                                int64_t defunc_0_lifted_step_res_581520;
                                int64_t defunc_0_lifted_step_res_581521;
                                
                                if (cond_581517) {
                                    int64_t tmp_585706 = add64(tt_581513, count_581515);
                                    
                                    defunc_0_lifted_step_res_581518 = ss_581511;
                                    defunc_0_lifted_step_res_581519 = tmp_585706;
                                    defunc_0_lifted_step_res_581520 = tt_581514;
                                    defunc_0_lifted_step_res_581521 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_581523 = sub64(tt_581514, tt_581513);
                                    bool cond_581524 = sle64(zlze_lhs_581523, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_581525;
                                    int64_t defunc_0_lifted_step_res_f_res_581526;
                                    int64_t defunc_0_lifted_step_res_f_res_581527;
                                    int64_t defunc_0_lifted_step_res_f_res_581528;
                                    
                                    if (cond_581524) {
                                        int64_t tmp_585707 = add64(ss_581511, count_581515);
                                        
                                        defunc_0_lifted_step_res_f_res_581525 = tmp_585707;
                                        defunc_0_lifted_step_res_f_res_581526 = tt_581513;
                                        defunc_0_lifted_step_res_f_res_581527 = tt_581514;
                                        defunc_0_lifted_step_res_f_res_581528 = (int64_t) 0;
                                    } else {
                                        bool cond_581530 = count_581515 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581531;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581532;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581533;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_581534;
                                        
                                        if (cond_581530) {
                                            bool x_585709 = sle64((int64_t) 0, ss_581511);
                                            bool y_585710 = slt64(ss_581511, stride_581311);
                                            bool bounds_check_585711 = x_585709 && y_585710;
                                            bool index_certs_585712;
                                            
                                            if (!bounds_check_585711) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_581511, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:965:33-56\n   #13 ftSkyline.fut:954:17-965:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585716 = sle64((int64_t) 0, tt_581513);
                                            bool y_585717 = slt64(tt_581513, j_m_i_581335);
                                            bool bounds_check_585718 = x_585716 && y_585717;
                                            bool index_certs_585719;
                                            
                                            if (!bounds_check_585718) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_581513, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:965:33-56\n   #13 ftSkyline.fut:954:17-965:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585713 = start_581387 + ss_581511;
                                            int64_t leq_arg1_585714 = ((int64_t *) mem_param_586742.mem)[slice_585713];
                                            float leq_arg1_585715 = ((float *) mem_param_586745.mem)[slice_585713];
                                            int64_t slice_585720 = stride_581311 + tt_581513;
                                            int64_t slice_585721 = start_581387 + slice_585720;
                                            int64_t leq_arg0_585722 = ((int64_t *) mem_param_586742.mem)[slice_585721];
                                            float leq_arg0_585723 = ((float *) mem_param_586745.mem)[slice_585721];
                                            bool cond_585724 = slt64(leq_arg0_585722, leq_arg1_585714);
                                            bool cond_585725 = leq_arg0_585722 == leq_arg1_585714;
                                            bool zlze_res_585726 = leq_arg0_585723 <= leq_arg1_585715;
                                            bool x_585727 = cond_585725 && zlze_res_585726;
                                            bool x_585728 = !cond_585724;
                                            bool y_585729 = x_585727 && x_585728;
                                            bool defunc_0_leq_res_585730 = cond_585724 || y_585729;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585731;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585732;
                                            
                                            if (defunc_0_leq_res_585730) {
                                                int64_t tmp_585733 = add64((int64_t) 1, tt_581513);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585731 = ss_581511;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585732 = tmp_585733;
                                            } else {
                                                int64_t tmp_585734 = add64((int64_t) 1, ss_581511);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585731 = tmp_585734;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585732 = tt_581513;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581531 = defunc_0_lifted_step_res_f_res_f_res_t_res_585731;
                                            defunc_0_lifted_step_res_f_res_f_res_581532 = defunc_0_lifted_step_res_f_res_f_res_t_res_585732;
                                            defunc_0_lifted_step_res_f_res_f_res_581533 = tt_581514;
                                            defunc_0_lifted_step_res_f_res_f_res_581534 = (int64_t) 0;
                                        } else {
                                            int64_t m_581561 = sdiv64(count_581515, (int64_t) 2);
                                            int64_t n_581562 = sub64(count_581515, m_581561);
                                            bool cond_581563 = n_581562 == (int64_t) 0;
                                            int64_t zgze_lhs_581564 = add64(ss_581511, m_581561);
                                            bool cond_f_res_581565 = sle64(ss_581512, zgze_lhs_581564);
                                            bool x_581566 = !cond_581563;
                                            bool y_581567 = cond_f_res_581565 && x_581566;
                                            bool cond_581568 = cond_581563 || y_581567;
                                            bool leq_y_x_581569;
                                            
                                            if (cond_581568) {
                                                leq_y_x_581569 = 1;
                                            } else {
                                                bool x_581570 = sle64((int64_t) 0, zgze_lhs_581564);
                                                bool y_581571 = slt64(zgze_lhs_581564, stride_581311);
                                                bool bounds_check_581572 = x_581570 && y_581571;
                                                bool index_certs_581573;
                                                
                                                if (!bounds_check_581572) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_581564, "] out of bounds for array of shape [", (long long) stride_581311, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:965:33-56\n   #13 ftSkyline.fut:954:17-965:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_581577 = add64(tt_581513, n_581562);
                                                int64_t leq_arg0_581578 = sub64(zm_lhs_581577, (int64_t) 1);
                                                bool x_581579 = sle64((int64_t) 0, leq_arg0_581578);
                                                bool y_581580 = slt64(leq_arg0_581578, j_m_i_581335);
                                                bool bounds_check_581581 = x_581579 && y_581580;
                                                bool index_certs_581582;
                                                
                                                if (!bounds_check_581581) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_581578, "] out of bounds for array of shape [", (long long) j_m_i_581335, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:965:33-56\n   #13 ftSkyline.fut:954:17-965:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_581574 = start_581387 + zgze_lhs_581564;
                                                int64_t leq_arg1_581575 = ((int64_t *) mem_param_586742.mem)[slice_581574];
                                                float leq_arg1_581576 = ((float *) mem_param_586745.mem)[slice_581574];
                                                int64_t slice_581583 = stride_581311 + leq_arg0_581578;
                                                int64_t slice_581584 = start_581387 + slice_581583;
                                                int64_t leq_arg0_581585 = ((int64_t *) mem_param_586742.mem)[slice_581584];
                                                float leq_arg0_581586 = ((float *) mem_param_586745.mem)[slice_581584];
                                                bool cond_581587 = slt64(leq_arg0_581585, leq_arg1_581575);
                                                bool cond_581588 = leq_arg0_581585 == leq_arg1_581575;
                                                bool zlze_res_581589 = leq_arg0_581586 <= leq_arg1_581576;
                                                bool x_581590 = cond_581588 && zlze_res_581589;
                                                bool x_581591 = !cond_581587;
                                                bool y_581592 = x_581590 && x_581591;
                                                bool defunc_0_leq_res_581593 = cond_581587 || y_581592;
                                                
                                                leq_y_x_581569 = defunc_0_leq_res_581593;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581594;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581595;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_581596;
                                            
                                            if (leq_y_x_581569) {
                                                int64_t tmp_585735 = add64(tt_581513, n_581562);
                                                int64_t tmp_585736 = sub64(count_581515, n_581562);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581594 = tmp_585735;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581595 = tt_581514;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581596 = tmp_585736;
                                            } else {
                                                int64_t tmp_581599 = add64(tt_581513, n_581562);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581594 = tt_581513;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581595 = tmp_581599;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_581596 = count_581515;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_581531 = ss_581511;
                                            defunc_0_lifted_step_res_f_res_f_res_581532 = defunc_0_lifted_step_res_f_res_f_res_f_res_581594;
                                            defunc_0_lifted_step_res_f_res_f_res_581533 = defunc_0_lifted_step_res_f_res_f_res_f_res_581595;
                                            defunc_0_lifted_step_res_f_res_f_res_581534 = defunc_0_lifted_step_res_f_res_f_res_f_res_581596;
                                        }
                                        defunc_0_lifted_step_res_f_res_581525 = defunc_0_lifted_step_res_f_res_f_res_581531;
                                        defunc_0_lifted_step_res_f_res_581526 = defunc_0_lifted_step_res_f_res_f_res_581532;
                                        defunc_0_lifted_step_res_f_res_581527 = defunc_0_lifted_step_res_f_res_f_res_581533;
                                        defunc_0_lifted_step_res_f_res_581528 = defunc_0_lifted_step_res_f_res_f_res_581534;
                                    }
                                    defunc_0_lifted_step_res_581518 = defunc_0_lifted_step_res_f_res_581525;
                                    defunc_0_lifted_step_res_581519 = defunc_0_lifted_step_res_f_res_581526;
                                    defunc_0_lifted_step_res_581520 = defunc_0_lifted_step_res_f_res_581527;
                                    defunc_0_lifted_step_res_581521 = defunc_0_lifted_step_res_f_res_581528;
                                }
                                
                                int64_t loopres_581600;
                                int64_t loopres_581601;
                                int64_t loopres_581602;
                                int64_t loopres_581603;
                                int64_t loopres_581604;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_581600, &loopres_581601, &loopres_581602, &loopres_581603, &loopres_581604, defunc_0_lifted_step_res_581518, ss_581512, defunc_0_lifted_step_res_581519, defunc_0_lifted_step_res_581520, defunc_0_lifted_step_res_581521) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_581605 = slt64((int64_t) 0, loopres_581604);
                                bool loop_while_tmp_588165 = loop_cond_581605;
                                int64_t ss_tmp_588166 = loopres_581600;
                                int64_t ss_tmp_588167 = loopres_581601;
                                int64_t tt_tmp_588168 = loopres_581602;
                                int64_t tt_tmp_588169 = loopres_581603;
                                int64_t count_tmp_588170 = loopres_581604;
                                
                                loop_while_581510 = loop_while_tmp_588165;
                                ss_581511 = ss_tmp_588166;
                                ss_581512 = ss_tmp_588167;
                                tt_581513 = tt_tmp_588168;
                                tt_581514 = tt_tmp_588169;
                                count_581515 = count_tmp_588170;
                            }
                            defunc_0_split_count_res_581504 = loop_while_581510;
                            defunc_0_split_count_res_581505 = ss_581511;
                            defunc_0_split_count_res_581506 = ss_581512;
                            defunc_0_split_count_res_581507 = tt_581513;
                            defunc_0_split_count_res_581508 = tt_581514;
                            defunc_0_split_count_res_581509 = count_581515;
                            ((int64_t *) mem_586785)[i_586225] = defunc_0_split_count_res_581505;
                            ((int64_t *) mem_586787)[i_586225] = defunc_0_split_count_res_581507;
                        }
                        if (mem_586802_cached_sizze_588940 < bytes_586801) {
                            err = lexical_realloc(ctx, &mem_586802, &mem_586802_cached_sizze_588940, bytes_586801);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586805_cached_sizze_588941 < bytes_586804) {
                            err = lexical_realloc(ctx, &mem_586805, &mem_586805_cached_sizze_588941, bytes_586804);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586809_cached_sizze_588942 < bytes_586808) {
                            err = lexical_realloc(ctx, &mem_586809, &mem_586809_cached_sizze_588942, bytes_586808);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586812_cached_sizze_588943 < bytes_586801) {
                            err = lexical_realloc(ctx, &mem_586812, &mem_586812_cached_sizze_588943, bytes_586801);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586236 = 0; i_586236 < num_blocks_581333; i_586236++) {
                            bool y_581613 = slt64(i_586236, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334);
                            bool index_certs_581615;
                            
                            if (!y_581613) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586236, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581616 = ((int64_t *) mem_586785)[i_586236];
                            int64_t defunc_0_f_res_581617 = ((int64_t *) mem_586787)[i_586236];
                            int64_t tmp_581618 = add64((int64_t) 1, i_586236);
                            bool x_581619 = sle64((int64_t) 0, tmp_581618);
                            bool y_581620 = slt64(tmp_581618, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334);
                            bool bounds_check_581621 = x_581619 && y_581620;
                            bool index_certs_581622;
                            
                            if (!bounds_check_581621) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_581618, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_581334, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_581623 = ((int64_t *) mem_586785)[tmp_581618];
                            int64_t defunc_0_f_res_581624 = ((int64_t *) mem_586787)[tmp_581618];
                            int64_t merge_sequential_arg2_581625 = add64(stride_581311, defunc_0_f_res_581617);
                            int64_t merge_sequential_arg2_581626 = add64(stride_581311, defunc_0_f_res_581624);
                            int64_t j_m_i_581627 = sub64(merge_sequential_arg2_581626, merge_sequential_arg2_581625);
                            bool empty_slice_581628 = j_m_i_581627 == (int64_t) 0;
                            int64_t m_581629 = sub64(j_m_i_581627, (int64_t) 1);
                            int64_t i_p_m_t_s_581630 = add64(merge_sequential_arg2_581625, m_581629);
                            bool zzero_leq_i_p_m_t_s_581631 = sle64((int64_t) 0, i_p_m_t_s_581630);
                            bool i_p_m_t_s_leq_w_581632 = slt64(i_p_m_t_s_581630, next_stride_581312);
                            bool zzero_lte_i_581633 = sle64((int64_t) 0, merge_sequential_arg2_581625);
                            bool i_lte_j_581634 = sle64(merge_sequential_arg2_581625, merge_sequential_arg2_581626);
                            bool y_581635 = i_p_m_t_s_leq_w_581632 && zzero_lte_i_581633;
                            bool y_581636 = zzero_leq_i_p_m_t_s_581631 && y_581635;
                            bool forwards_ok_581637 = i_lte_j_581634 && y_581636;
                            bool ok_or_empty_581638 = empty_slice_581628 || forwards_ok_581637;
                            bool index_certs_581639;
                            
                            if (!ok_or_empty_581638) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_581625, ":", (long long) merge_sequential_arg2_581626, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_581640 = sub64(defunc_0_f_res_581623, defunc_0_f_res_581616);
                            bool empty_slice_581641 = j_m_i_581640 == (int64_t) 0;
                            int64_t m_581642 = sub64(j_m_i_581640, (int64_t) 1);
                            int64_t i_p_m_t_s_581643 = add64(defunc_0_f_res_581616, m_581642);
                            bool zzero_leq_i_p_m_t_s_581644 = sle64((int64_t) 0, i_p_m_t_s_581643);
                            bool i_p_m_t_s_leq_w_581645 = slt64(i_p_m_t_s_581643, next_stride_581312);
                            bool zzero_lte_i_581646 = sle64((int64_t) 0, defunc_0_f_res_581616);
                            bool i_lte_j_581647 = sle64(defunc_0_f_res_581616, defunc_0_f_res_581623);
                            bool y_581648 = i_p_m_t_s_leq_w_581645 && zzero_lte_i_581646;
                            bool y_581649 = zzero_leq_i_p_m_t_s_581644 && y_581648;
                            bool forwards_ok_581650 = i_lte_j_581647 && y_581649;
                            bool ok_or_empty_581651 = empty_slice_581641 || forwards_ok_581650;
                            bool index_certs_581652;
                            
                            if (!ok_or_empty_581651) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_581616, ":", (long long) defunc_0_f_res_581623, "] out of bounds for array of shape [", (long long) next_stride_581312, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:965:33-56\n   #10 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_581653 = slt64((int64_t) 0, j_m_i_581640);
                            bool y_581664 = slt64((int64_t) 0, j_m_i_581627);
                            bool protect_assert_disj_587750 = cond_581653 || y_581664;
                            bool index_certs_581665;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:965:33-56\n   #12 ftSkyline.fut:954:17-965:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_581666 = start_581387 + merge_sequential_arg2_581625;
                            int64_t binop_y_586831 = dim_457918 * slice_581666;
                            int64_t slice_585738 = start_581387 + defunc_0_f_res_581616;
                            int64_t binop_y_586833 = dim_457918 * slice_585738;
                            int64_t ext_586835;
                            
                            if (cond_581653) {
                                ext_586835 = binop_y_586833;
                            } else {
                                ext_586835 = binop_y_586831;
                            }
                            
                            int64_t dummy_581654;
                            float dummy_581655;
                            int64_t dummy_581657;
                            
                            if (cond_581653) {
                                int64_t head_res_585739 = ((int64_t *) mem_param_586742.mem)[slice_585738];
                                float head_res_585740 = ((float *) mem_param_586745.mem)[slice_585738];
                                int64_t head_res_585742 = ((int64_t *) mem_param_586752.mem)[slice_585738];
                                
                                dummy_581654 = head_res_585739;
                                dummy_581655 = head_res_585740;
                                dummy_581657 = head_res_585742;
                            } else {
                                int64_t head_res_581667 = ((int64_t *) mem_param_586742.mem)[slice_581666];
                                float head_res_581668 = ((float *) mem_param_586745.mem)[slice_581666];
                                int64_t head_res_581670 = ((int64_t *) mem_param_586752.mem)[slice_581666];
                                
                                dummy_581654 = head_res_581667;
                                dummy_581655 = head_res_581668;
                                dummy_581657 = head_res_581670;
                            }
                            for (int64_t nest_i_588175 = 0; nest_i_588175 < merge_block_sizze_581132; nest_i_588175++) {
                                ((int64_t *) mem_586802)[i_586236 * merge_block_sizze_581132 + nest_i_588175] = dummy_581654;
                            }
                            for (int64_t nest_i_588176 = 0; nest_i_588176 < merge_block_sizze_581132; nest_i_588176++) {
                                ((float *) mem_586805)[i_586236 * merge_block_sizze_581132 + nest_i_588176] = dummy_581655;
                            }
                            for (int64_t nest_i_588177 = 0; nest_i_588177 < merge_block_sizze_581132; nest_i_588177++) {
                                ((int64_t *) mem_586812)[i_586236 * merge_block_sizze_581132 + nest_i_588177] = dummy_581657;
                            }
                            for (int64_t nest_i_588178 = 0; nest_i_588178 < merge_block_sizze_581132; nest_i_588178++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586809, i_586236 * lmad_arg_586830 + nest_i_588178 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586749.mem, ext_586835, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                            }
                            
                            int64_t data_581675;
                            int64_t i_581681 = (int64_t) 0;
                            
                            for (int64_t k_581680 = 0; k_581680 < merge_block_sizze_581132; k_581680++) {
                                int64_t j_581686 = sub64(k_581680, i_581681);
                                bool cond_581687 = j_581686 == j_m_i_581627;
                                bool x_587850 = !cond_581687;
                                bool cond_581689 = slt64(i_581681, j_m_i_581640);
                                bool x_585743 = sle64((int64_t) 0, j_581686);
                                bool y_585744 = slt64(j_581686, j_m_i_581627);
                                bool bounds_check_585745 = x_585743 && y_585744;
                                bool loop_not_taken_587838 = !cond_581689;
                                bool protect_assert_disj_587839 = bounds_check_585745 || loop_not_taken_587838;
                                bool protect_assert_disj_587853 = cond_581687 || protect_assert_disj_587839;
                                bool index_certs_585746;
                                
                                if (!protect_assert_disj_587853) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581686, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585747 = merge_sequential_arg2_581625 + j_581686;
                                int64_t slice_585748 = start_581387 + slice_585747;
                                bool protect_cond_conj_587854 = cond_581689 && x_587850;
                                int64_t leq_arg1_585749;
                                
                                if (protect_cond_conj_587854) {
                                    int64_t x_587840 = ((int64_t *) mem_param_586742.mem)[slice_585748];
                                    
                                    leq_arg1_585749 = x_587840;
                                } else {
                                    leq_arg1_585749 = (int64_t) 0;
                                }
                                
                                float leq_arg1_585750;
                                
                                if (protect_cond_conj_587854) {
                                    float x_587842 = ((float *) mem_param_586745.mem)[slice_585748];
                                    
                                    leq_arg1_585750 = x_587842;
                                } else {
                                    leq_arg1_585750 = 0.0F;
                                }
                                
                                bool x_585751 = sle64((int64_t) 0, i_581681);
                                bool bounds_check_585752 = cond_581689 && x_585751;
                                bool protect_assert_disj_587845 = bounds_check_585752 || loop_not_taken_587838;
                                bool protect_assert_disj_587857 = cond_581687 || protect_assert_disj_587845;
                                bool index_certs_585753;
                                
                                if (!protect_assert_disj_587857) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581681, "] out of bounds for array of shape [", (long long) j_m_i_581640, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585754 = defunc_0_f_res_581616 + i_581681;
                                int64_t slice_585755 = start_581387 + slice_585754;
                                int64_t leq_arg0_585756;
                                
                                if (protect_cond_conj_587854) {
                                    int64_t x_587846 = ((int64_t *) mem_param_586742.mem)[slice_585755];
                                    
                                    leq_arg0_585756 = x_587846;
                                } else {
                                    leq_arg0_585756 = (int64_t) 0;
                                }
                                
                                float leq_arg0_585757;
                                
                                if (protect_cond_conj_587854) {
                                    float x_587848 = ((float *) mem_param_586745.mem)[slice_585755];
                                    
                                    leq_arg0_585757 = x_587848;
                                } else {
                                    leq_arg0_585757 = 0.0F;
                                }
                                
                                bool cond_585758 = slt64(leq_arg0_585756, leq_arg1_585749);
                                bool cond_585759 = leq_arg0_585756 == leq_arg1_585749;
                                bool zlze_res_585760 = leq_arg0_585757 <= leq_arg1_585750;
                                bool x_585761 = cond_585759 && zlze_res_585760;
                                bool x_585762 = !cond_585758;
                                bool y_585763 = x_585761 && x_585762;
                                bool defunc_0_leq_res_585764 = cond_585758 || y_585763;
                                bool x_587872 = cond_581689 && defunc_0_leq_res_585764;
                                bool cond_581688 = cond_581687 || x_587872;
                                bool protect_assert_disj_587742 = cond_581688 || bounds_check_585745;
                                bool index_certs_581732;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_581686, "] out of bounds for array of shape [", (long long) j_m_i_581627, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585768 = cond_581689 && x_585751;
                                bool loop_not_taken_587737 = !cond_581688;
                                bool protect_assert_disj_587738 = bounds_check_585768 || loop_not_taken_587737;
                                bool index_certs_585769;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581681, "] out of bounds for array of shape [", (long long) j_m_i_581640, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:965:33-56\n   #11 ftSkyline.fut:954:17-965:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_581734 = start_581387 + slice_585747;
                                int64_t binop_y_586858 = dim_457918 * slice_581734;
                                int64_t slice_585771 = start_581387 + slice_585754;
                                int64_t binop_y_586860 = dim_457918 * slice_585771;
                                int64_t ext_586862;
                                
                                if (cond_581688) {
                                    ext_586862 = binop_y_586860;
                                } else {
                                    ext_586862 = binop_y_586858;
                                }
                                
                                int64_t loopres_581713;
                                int64_t loopres_581714;
                                float loopres_581715;
                                int64_t loopres_581717;
                                
                                if (cond_581688) {
                                    int64_t tmp_585765 = add64((int64_t) 1, i_581681);
                                    int64_t tmp_585772 = ((int64_t *) mem_param_586742.mem)[slice_585771];
                                    float tmp_585773 = ((float *) mem_param_586745.mem)[slice_585771];
                                    int64_t tmp_585775 = ((int64_t *) mem_param_586752.mem)[slice_585771];
                                    
                                    loopres_581713 = tmp_585765;
                                    loopres_581714 = tmp_585772;
                                    loopres_581715 = tmp_585773;
                                    loopres_581717 = tmp_585775;
                                } else {
                                    int64_t tmp_581735 = ((int64_t *) mem_param_586742.mem)[slice_581734];
                                    float tmp_581736 = ((float *) mem_param_586745.mem)[slice_581734];
                                    int64_t tmp_581738 = ((int64_t *) mem_param_586752.mem)[slice_581734];
                                    
                                    loopres_581713 = i_581681;
                                    loopres_581714 = tmp_581735;
                                    loopres_581715 = tmp_581736;
                                    loopres_581717 = tmp_581738;
                                }
                                ((int64_t *) mem_586802)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581714;
                                ((float *) mem_586805)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581715;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586809, i_586236 * lmad_arg_586830 + k_581680 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586749.mem, ext_586862, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
                                ((int64_t *) mem_586812)[i_586236 * merge_block_sizze_581132 + k_581680] = loopres_581717;
                                
                                int64_t i_tmp_588179 = loopres_581713;
                                
                                i_581681 = i_tmp_588179;
                            }
                            data_581675 = i_581681;
                        }
                        if (memblock_alloc(ctx, &mem_586895, bytes_586801, "mem_586895")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586895.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint64_t *) mem_586802, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_alloc(ctx, &mem_586899, bytes_586804, "mem_586899")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 2, (uint32_t *) mem_586899.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint32_t *) mem_586805, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_alloc(ctx, &mem_586904, bytes_586808, "mem_586904")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_586904.mem, (int64_t) 0, (int64_t []) {dim_457918 * merge_block_sizze_581132, dim_457918, (int64_t) 1}, (uint32_t *) mem_586809, (int64_t) 0, (int64_t []) {lmad_arg_586830, dim_457918, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132, dim_457918});
                        if (memblock_alloc(ctx, &mem_586908, bytes_586801, "mem_586908")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586908.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (uint64_t *) mem_586812, (int64_t) 0, (int64_t []) {merge_block_sizze_581132, (int64_t) 1}, (int64_t []) {num_blocks_581333, merge_block_sizze_581132});
                        if (memblock_set(ctx, &ext_mem_586967, &mem_586895, "mem_586895") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586964, &mem_586899, "mem_586899") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586961, &mem_586904, "mem_586904") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586957, &mem_586908, "mem_586908") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586755, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586967.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586967, "ext_mem_586967") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586758, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586964.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586964, "ext_mem_586964") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_586762, i_586249 * lmad_arg_586783, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) ext_mem_586961.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {next_stride_581312, dim_457918});
                    if (memblock_unref(ctx, &ext_mem_586961, "ext_mem_586961") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586765, i_586249 * next_stride_581312, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586957.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_581312});
                    if (memblock_unref(ctx, &ext_mem_586957, "ext_mem_586957") != 0)
                        return 1;
                }
                
                int64_t flat_dim_581751 = next_stride_581312 * num_merges_581316;
                
                if (memblock_alloc(ctx, &mem_586987, bytes_586754, "mem_586987")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586987.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint64_t *) mem_586755, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                if (memblock_alloc(ctx, &mem_586991, bytes_586757, "mem_586991")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_586991.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint32_t *) mem_586758, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                if (memblock_alloc(ctx, &mem_586996, bytes_586761, "mem_586996")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_586996.mem, (int64_t) 0, (int64_t []) {dim_457918 * next_stride_581312, dim_457918, (int64_t) 1}, (uint32_t *) mem_586762, (int64_t) 0, (int64_t []) {lmad_arg_586783, dim_457918, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312, dim_457918});
                if (memblock_alloc(ctx, &mem_587000, bytes_586754, "mem_587000")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587000.mem, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (uint64_t *) mem_586765, (int64_t) 0, (int64_t []) {next_stride_581312, (int64_t) 1}, (int64_t []) {num_merges_581316, next_stride_581312});
                
                bool loop_cond_581758 = slt64(next_stride_581312, flat_dim_581126);
                
                if (memblock_set(ctx, &mem_param_tmp_588139, &mem_586987, "mem_586987") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588140, &mem_586991, "mem_586991") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588141, &mem_586996, "mem_586996") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588142, &mem_587000, "mem_587000") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588143 = flat_dim_581751;
                bool loop_while_tmp_588144 = loop_cond_581758;
                int64_t stride_tmp_588149 = next_stride_581312;
                
                if (memblock_set(ctx, &mem_param_586742, &mem_param_tmp_588139, "mem_param_tmp_588139") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586745, &mem_param_tmp_588140, "mem_param_tmp_588140") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586749, &mem_param_tmp_588141, "mem_param_tmp_588141") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586752, &mem_param_tmp_588142, "mem_param_tmp_588142") != 0)
                    return 1;
                loop_dz2084Uz2082U_581305 = loop_dz2084Uz2082U_tmp_588143;
                loop_while_581306 = loop_while_tmp_588144;
                stride_581311 = stride_tmp_588149;
            }
            if (memblock_set(ctx, &ext_mem_587014, &mem_param_586742, "mem_param_586742") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587013, &mem_param_586745, "mem_param_586745") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587012, &mem_param_586749, "mem_param_586749") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587011, &mem_param_586752, "mem_param_586752") != 0)
                return 1;
            data_581298 = loop_dz2084Uz2082U_581305;
            data_581299 = loop_while_581306;
            data_581304 = stride_581311;
            if (memblock_unref(ctx, &mem_586725, "mem_586725") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586729, "mem_586729") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586734, "mem_586734") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586738, "mem_586738") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_581761 = slt64(m_580257, data_581298);
            bool y_581762 = zzero_leq_i_p_m_t_s_580258 && i_p_m_t_s_leq_w_581761;
            bool ok_or_empty_581763 = empty_slice_580256 || y_581762;
            bool index_certs_581764;
            
            if (!ok_or_empty_581763) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) m_580247, "] out of bounds for array of shape [", (long long) data_581298, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587021, &ext_mem_587012, "ext_mem_587012") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587017, &ext_mem_587011, "ext_mem_587011") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587023, bytes_586456, "mem_587023")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587023.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587017.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_580247});
        if (memblock_unref(ctx, &ext_mem_587017, "ext_mem_587017") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587026, bytes_586465, "mem_587026")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_587026.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) ext_mem_587021.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {m_580247, dim_457918});
        if (memblock_unref(ctx, &ext_mem_587021, "ext_mem_587021") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587463, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587462, &mem_587023, "mem_587023") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586466, "mem_586466") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_586468, "mem_586468") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_585820;
    int64_t redout_586254 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586255 = 0; i_586255 < dim_457918; i_586255++) {
        int64_t x_581779 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586255];
        int64_t min_res_581782 = smin64(x_581779, redout_586254);
        int64_t redout_tmp_588184 = min_res_581782;
        
        redout_586254 = redout_tmp_588184;
    }
    defunc_0_reduce_res_585820 = redout_586254;
    
    bool cond_581783 = defunc_0_reduce_res_585820 == (int64_t) 1;
    bool bounds_invalid_upwards_581784 = slt64(total_grid_no_457929, (int64_t) 0);
    bool valid_581785 = !bounds_invalid_upwards_581784;
    bool protect_assert_disj_581786 = cond_581783 || valid_581785;
    bool range_valid_c_581787;
    
    if (!protect_assert_disj_581786) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_457929, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582140 = y_580163 || cond_581783;
    bool index_certs_581794;
    
    if (!protect_assert_disj_582140) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:965:33-56\n   #4  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587464 = (int64_t) 4 * total_grid_no_457929;
    
    if (cond_581783) {
        if (memblock_alloc(ctx, &mem_587501, total_grid_no_457929, "mem_587501")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588185 = 0; nest_i_588185 < total_grid_no_457929; nest_i_588185++) {
            ((bool *) mem_587501.mem)[nest_i_588185] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587504, &mem_587501, "mem_587501") != 0)
            return 1;
    } else {
        if (mem_587465_cached_sizze_588967 < bytes_587464) {
            err = lexical_realloc(ctx, &mem_587465, &mem_587465_cached_sizze_588967, bytes_587464);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588186 = 0; nest_i_588186 < total_grid_no_457929; nest_i_588186++) {
            ((int32_t *) mem_587465)[nest_i_588186] = 0;
        }
        if (mem_587470_cached_sizze_588968 < bytes_586501) {
            err = lexical_realloc(ctx, &mem_587470, &mem_587470_cached_sizze_588968, bytes_586501);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586260 = 0; iter_586260 < m_580247; iter_586260++) {
            for (int64_t i_586258 = 0; i_586258 < dim_457918; i_586258++) {
                float eta_p_584529 = ((float *) ext_mem_587463.mem)[iter_586260 * dim_457918 + i_586258];
                float eta_p_584530 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586258];
                float eta_p_584531 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586258];
                int64_t eta_p_584533 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586258];
                float defunc_0_f_res_584534 = eta_p_584529 - eta_p_584530;
                float defunc_0_f_res_584536 = defunc_0_f_res_584534 / eta_p_584531;
                int64_t f32_res_584538 = fptosi_f32_i64(defunc_0_f_res_584536);
                int64_t max_res_584540 = smax64((int64_t) 0, f32_res_584538);
                int64_t zm_lhs_584546 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586258];
                int64_t min_arg1_584547 = sub64(zm_lhs_584546, (int64_t) 1);
                int64_t min_res_584548 = smin64(max_res_584540, min_arg1_584547);
                int64_t defunc_0_f_res_584550 = mul64(eta_p_584533, min_res_584548);
                
                ((int64_t *) mem_587470)[i_586258] = defunc_0_f_res_584550;
            }
            
            int64_t defunc_0_foldl_res_584457;
            int64_t acc_584459 = (int64_t) 0;
            
            for (int64_t i_584458 = 0; i_584458 < dim_457918; i_584458++) {
                int64_t b_584460 = ((int64_t *) mem_587470)[i_584458];
                int64_t defunc_0_f_res_584461 = add64(acc_584459, b_584460);
                int64_t acc_tmp_588189 = defunc_0_f_res_584461;
                
                acc_584459 = acc_tmp_588189;
            }
            defunc_0_foldl_res_584457 = acc_584459;
            
            bool less_than_zzero_586264 = slt64(defunc_0_foldl_res_584457, (int64_t) 0);
            bool greater_than_sizze_586265 = sle64(total_grid_no_457929, defunc_0_foldl_res_584457);
            bool outside_bounds_dim_586266 = less_than_zzero_586264 || greater_than_sizze_586265;
            
            if (!outside_bounds_dim_586266) {
                int32_t read_hist_586268 = ((int32_t *) mem_587465)[defunc_0_foldl_res_584457];
                int32_t defunc_0_op_res_581834 = add32(1, read_hist_586268);
                
                ((int32_t *) mem_587465)[defunc_0_foldl_res_584457] = defunc_0_op_res_581834;
            }
        }
        if (memblock_alloc(ctx, &mem_587480, total_grid_no_457929, "mem_587480")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < total_grid_no_457929; nest_i_588190++) {
            ((bool *) mem_587480.mem)[nest_i_588190] = 0;
        }
        if (mem_587484_cached_sizze_588969 < dim_457918) {
            err = lexical_realloc(ctx, &mem_587484, &mem_587484_cached_sizze_588969, dim_457918);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_581839 = 0; i_581839 < total_grid_no_457929; i_581839++) {
            for (int64_t i_586273 = 0; i_586273 < dim_457918; i_586273++) {
                int64_t eta_p_581842 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586273];
                int64_t eta_p_581843 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586273];
                bool defunc_0_f_res_581844;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_581844, i_581839, eta_p_581842, eta_p_581843) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587484)[i_586273] = defunc_0_f_res_581844;
            }
            
            bool defunc_0_f_res_581845;
            bool acc_581847 = 0;
            
            for (int64_t i_581846 = 0; i_581846 < dim_457918; i_581846++) {
                bool b_581848 = ((bool *) mem_587484)[i_581846];
                bool defunc_0_f_res_581849 = acc_581847 || b_581848;
                bool acc_tmp_588193 = defunc_0_f_res_581849;
                
                acc_581847 = acc_tmp_588193;
            }
            defunc_0_f_res_581845 = acc_581847;
            if (!defunc_0_f_res_581845) {
                bool y_581851 = slt64(i_581839, dz2080U_457919);
                bool index_certs_581852;
                
                if (!y_581851) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_581839, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:965:33-56\n   #2  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_581854 = slt64(i_581839, (int64_t) 0);
                bool valid_581855 = !bounds_invalid_upwards_581854;
                bool range_valid_c_581856;
                
                if (!valid_581855) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_581839, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_585801;
                bool redout_586279 = 0;
                
                for (int64_t i_586280 = 0; i_586280 < i_581839; i_586280++) {
                    bool cond_584554 = i_586280 == i_581839;
                    bool cond_584555;
                    
                    if (cond_584554) {
                        cond_584555 = 1;
                    } else {
                        bool y_584557 = slt64(i_586280, total_grid_no_457929);
                        bool index_certs_584559;
                        
                        if (!y_584557) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586280, "] out of bounds for array of shape [", (long long) total_grid_no_457929, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584560 = ((int32_t *) mem_587465)[i_586280];
                        bool cond_f_res_584561 = zeze_lhs_584560 == 0;
                        
                        cond_584555 = cond_f_res_584561;
                    }
                    
                    bool defunc_0_f_res_584562;
                    
                    if (cond_584555) {
                        defunc_0_f_res_584562 = 0;
                    } else {
                        bool y_584564 = slt64(i_586280, dz2080U_457919);
                        bool index_certs_584566;
                        
                        if (!y_584564) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586280, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587491_cached_sizze_588970 < dim_457918) {
                            err = lexical_realloc(ctx, &mem_587491, &mem_587491_cached_sizze_588970, dim_457918);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586277 = 0; i_586277 < dim_457918; i_586277++) {
                            float eta_p_584569 = ((float *) start_of_grid_partition_mem_586416.mem)[i_581839 * dim_457918 + i_586277];
                            float eta_p_584570 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586280 * dim_457918 + i_586277];
                            bool defunc_0_f_res_584571 = eta_p_584570 < eta_p_584569;
                            
                            ((bool *) mem_587491)[i_586277] = defunc_0_f_res_584571;
                        }
                        
                        bool defunc_0_foldl_res_584572;
                        bool acc_584574 = 1;
                        
                        for (int64_t i_584573 = 0; i_584573 < dim_457918; i_584573++) {
                            bool b_584575 = ((bool *) mem_587491)[i_584573];
                            bool x_584576 = acc_584574 && b_584575;
                            bool acc_tmp_588196 = x_584576;
                            
                            acc_584574 = acc_tmp_588196;
                        }
                        defunc_0_foldl_res_584572 = acc_584574;
                        defunc_0_f_res_584562 = defunc_0_foldl_res_584572;
                    }
                    
                    bool defunc_0_op_res_581890 = defunc_0_f_res_584562 || redout_586279;
                    bool redout_tmp_588194 = defunc_0_op_res_581890;
                    
                    redout_586279 = redout_tmp_588194;
                }
                defunc_0_reduce_res_585801 = redout_586279;
                ((bool *) mem_587480.mem)[i_581839] = defunc_0_reduce_res_585801;
            }
        }
        if (memblock_set(ctx, &ext_mem_587504, &mem_587480, "mem_587480") != 0)
            return 1;
    }
    
    bool index_certs_581903;
    
    if (!y_580163) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587506_cached_sizze_588971 < bytes_586483) {
        err = lexical_realloc(ctx, &mem_587506, &mem_587506_cached_sizze_588971, bytes_586483);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586283 = 0; i_586283 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920; i_586283++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581983 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586283];
        float i64_res_581984 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_581983);
        float defunc_0_fover_res_581985 = 1.5707964F / i64_res_581984;
        
        ((float *) mem_587506)[i_586283] = defunc_0_fover_res_581985;
    }
    
    bool empty_or_match_cert_581987;
    
    if (!assert_cond_580154) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_582024 = total_angle_no_457928 == (int64_t) 0;
    bool nonzzero_582025 = !zzero_582024;
    bool nonzzero_cert_582026;
    
    if (!nonzzero_582025) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:965:33-56\n   #6  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587514_cached_sizze_588972 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587514, &mem_587514_cached_sizze_588972, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587516_cached_sizze_588973 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587516, &mem_587516_cached_sizze_588973, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587518_cached_sizze_588974 < bytes_586456) {
        err = lexical_realloc(ctx, &mem_587518, &mem_587518_cached_sizze_588974, bytes_586456);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587529_cached_sizze_588975 < bytes_586501) {
        err = lexical_realloc(ctx, &mem_587529, &mem_587529_cached_sizze_588975, bytes_586501);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587537_cached_sizze_588976 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587537, &mem_587537_cached_sizze_588976, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587545_cached_sizze_588977 < bytes_586525) {
        err = lexical_realloc(ctx, &mem_587545, &mem_587545_cached_sizze_588977, bytes_586525);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587561_cached_sizze_588979 < bytes_586541) {
        err = lexical_realloc(ctx, &mem_587561, &mem_587561_cached_sizze_588979, bytes_586541);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586312;
    int64_t scanacc_586304 = (int64_t) 0;
    
    for (int64_t i_586308 = 0; i_586308 < m_580247; i_586308++) {
        for (int64_t i_586287 = 0; i_586287 < dim_457918; i_586287++) {
            float eta_p_584659 = ((float *) ext_mem_587463.mem)[i_586308 * dim_457918 + i_586287];
            float eta_p_584660 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586287];
            float eta_p_584661 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586287];
            int64_t eta_p_584663 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586287];
            float defunc_0_f_res_584664 = eta_p_584659 - eta_p_584660;
            float defunc_0_f_res_584666 = defunc_0_f_res_584664 / eta_p_584661;
            int64_t f32_res_584668 = fptosi_f32_i64(defunc_0_f_res_584666);
            int64_t max_res_584670 = smax64((int64_t) 0, f32_res_584668);
            int64_t zm_lhs_584676 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586287];
            int64_t min_arg1_584677 = sub64(zm_lhs_584676, (int64_t) 1);
            int64_t min_res_584678 = smin64(max_res_584670, min_arg1_584677);
            int64_t defunc_0_f_res_584680 = mul64(eta_p_584663, min_res_584678);
            
            ((int64_t *) mem_587529)[i_586287] = defunc_0_f_res_584680;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_457918; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587529)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588203 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588203;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_457919);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_457919, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586291 = 0; i_586291 < dim_457918; i_586291++) {
            float eta_p_582571 = ((float *) ext_mem_587463.mem)[i_586308 * dim_457918 + i_586291];
            float eta_p_582572 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582560 * dim_457918 + i_586291];
            float defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((float *) mem_587537)[i_586291] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588205 = 0; nest_i_588205 < arg_580153; nest_i_588205++) {
            ((float *) mem_587545)[nest_i_588205] = 0.0F;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_580153; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_457918);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_457918, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_457918);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_457918);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_457918, "] out of bounds for array of shape [", (long long) dim_457918, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587549 = (int64_t) 4 * j_m_i_582582;
            float this_x_582580 = ((float *) mem_587537)[i_582576];
            
            if (mem_587550_cached_sizze_588978 < bytes_587549) {
                err = lexical_realloc(ctx, &mem_587550, &mem_587550_cached_sizze_588978, bytes_587549);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586295 = 0; i_586295 < j_m_i_582582; i_586295++) {
                int64_t slice_586364 = map_arg1_582581 + i_586295;
                float eta_p_582597 = ((float *) mem_587537)[slice_586364];
                float defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((float *) mem_587550)[i_586295] = defunc_0_ftimes_res_582598;
            }
            
            float defunc_0_foldl_res_582599;
            float acc_582601 = 0.0F;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                float b_582602 = ((float *) mem_587550)[i_582600];
                float defunc_0_f_res_582603 = acc_582601 + b_582602;
                float acc_tmp_588208 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588208;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            float sqrt_res_582604 = futrts_sqrt32(defunc_0_foldl_res_582599);
            float atan2_res_582605 = futrts_atan2_32(sqrt_res_582604, this_x_582580);
            
            ((float *) mem_587545)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586299 = 0; i_586299 < arg_580153; i_586299++) {
            float eta_p_582608 = ((float *) mem_587545)[i_586299];
            float eta_p_582609 = ((float *) mem_587506)[i_586299];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586299];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586299];
            float i64_res_582612 = sitofp_i64_f32(eta_p_582610);
            float defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            float defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f32_res_582615 = fptosi_f32_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f32_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f32_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_585806 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_585806;
                } else {
                    defunc_0_f_res_f_res_582619 = f32_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587561)[i_586299] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_580153; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587561)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588210 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588210;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_457928, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_457928);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_457929);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_457929, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:965:33-56\n   #5  ftSkyline.fut:954:17-965:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587504.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_582041 = add64(defunc_0_f_res_582636, scanacc_586304);
        
        ((int64_t *) mem_587514)[i_586308] = defunc_0_op_res_582041;
        ((int64_t *) mem_587516)[i_586308] = defunc_0_f_res_582636;
        ((int64_t *) mem_587518)[i_586308] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588198 = defunc_0_op_res_582041;
        
        scanacc_586304 = scanacc_tmp_588198;
    }
    discard_586312 = scanacc_586304;
    
    bool x_582043 = !empty_slice_580256;
    bool y_582046 = slt64(m_580257, m_580247);
    bool bounds_check_582047 = zzero_leq_i_p_m_t_s_580258 && y_582046;
    bool protect_assert_disj_582048 = empty_slice_580256 || bounds_check_582047;
    bool index_certs_582049;
    
    if (!protect_assert_disj_582048) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_580257, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_582050;
    
    if (x_582043) {
        int64_t x_585811 = ((int64_t *) mem_587514)[m_580257];
        
        m_f_res_582050 = x_585811;
    } else {
        m_f_res_582050 = (int64_t) 0;
    }
    
    int64_t m_582052;
    
    if (empty_slice_580256) {
        m_582052 = (int64_t) 0;
    } else {
        m_582052 = m_f_res_582050;
    }
    
    int64_t m_582063 = sub64(m_582052, (int64_t) 1);
    bool i_p_m_t_s_leq_w_582065 = slt64(m_582063, m_580247);
    bool zzero_leq_i_p_m_t_s_582064 = sle64((int64_t) 0, m_582063);
    bool y_582067 = zzero_leq_i_p_m_t_s_582064 && i_p_m_t_s_leq_w_582065;
    bool i_lte_j_582066 = sle64((int64_t) 0, m_582052);
    bool forwards_ok_582068 = i_lte_j_582066 && y_582067;
    bool eq_x_zz_582059 = (int64_t) 0 == m_f_res_582050;
    bool p_and_eq_x_y_582061 = x_582043 && eq_x_zz_582059;
    bool empty_slice_582062 = empty_slice_580256 || p_and_eq_x_y_582061;
    bool ok_or_empty_582069 = empty_slice_582062 || forwards_ok_582068;
    bool index_certs_582070;
    
    if (!ok_or_empty_582069) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_582052, "] out of bounds for array of shape [", (long long) m_580247, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587577 = (int64_t) 4 * m_582052;
    int64_t bytes_587578 = dim_457918 * binop_x_587577;
    int64_t bytes_587580 = (int64_t) 8 * m_582052;
    bool bounds_invalid_upwards_582102 = slt64(total_part_no_457930, (int64_t) 0);
    bool valid_582103 = !bounds_invalid_upwards_582102;
    bool range_valid_c_582104;
    
    if (!valid_582103) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_457930, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:965:33-56\n   #3  ftSkyline.fut:954:17-965:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587606 = (int64_t) 8 * total_part_no_457930;
    
    if (memblock_alloc(ctx, &mem_587579, bytes_587578, "mem_587579")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587579.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (uint32_t *) ext_mem_587463.mem, (int64_t) 0, (int64_t []) {dim_457918, (int64_t) 1}, (int64_t []) {m_582052, dim_457918});
    if (mem_587581_cached_sizze_588980 < bytes_587580) {
        err = lexical_realloc(ctx, &mem_587581, &mem_587581_cached_sizze_588980, bytes_587580);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587581, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587518, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582052});
    if (memblock_alloc(ctx, &mem_587583, bytes_587580, "mem_587583")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587583.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587462.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_582052});
    if (mem_587595_cached_sizze_588981 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587595, &mem_587595_cached_sizze_588981, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586313 = 0; write_iter_586313 < m_580247; write_iter_586313++) {
        int64_t write_iv_586317 = ((int64_t *) mem_587516)[write_iter_586313];
        int64_t write_iv_586318 = ((int64_t *) mem_587514)[write_iter_586313];
        int64_t write_iv_586320 = ((int64_t *) ext_mem_587462.mem)[write_iter_586313];
        int64_t write_iv_586321 = ((int64_t *) mem_587518)[write_iter_586313];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_587595, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587463.mem, write_iter_586313 * dim_457918, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
        
        bool cond_582515 = write_iv_586317 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_585812 = sub64(write_iv_586318, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_585812;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_457918 - (int64_t) 1, dim_457918))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587579.mem, lifted_lambda_res_582516 * dim_457918, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587595, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_457918});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) {
            ((int64_t *) mem_587583.mem)[lifted_lambda_res_582516] = write_iv_586320;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_582052)) {
            ((int64_t *) mem_587581)[lifted_lambda_res_582516] = write_iv_586321;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587462, "ext_mem_587462") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587463, "ext_mem_587463") != 0)
        return 1;
    if (mem_587607_cached_sizze_588982 < bytes_587606) {
        err = lexical_realloc(ctx, &mem_587607, &mem_587607_cached_sizze_588982, bytes_587606);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588214 = 0; nest_i_588214 < total_part_no_457930; nest_i_588214++) {
        ((int64_t *) mem_587607)[nest_i_588214] = (int64_t) 0;
    }
    for (int64_t iter_586325 = 0; iter_586325 < m_582052; iter_586325++) {
        int64_t pixel_586327 = ((int64_t *) mem_587581)[iter_586325];
        bool less_than_zzero_586329 = slt64(pixel_586327, (int64_t) 0);
        bool greater_than_sizze_586330 = sle64(total_part_no_457930, pixel_586327);
        bool outside_bounds_dim_586331 = less_than_zzero_586329 || greater_than_sizze_586330;
        
        if (!outside_bounds_dim_586331) {
            int64_t read_hist_586333 = ((int64_t *) mem_587607)[pixel_586327];
            int64_t defunc_0_op_res_582109 = add64((int64_t) 1, read_hist_586333);
            
            ((int64_t *) mem_587607)[pixel_586327] = defunc_0_op_res_582109;
        }
    }
    if (mem_587615_cached_sizze_588983 < bytes_587606) {
        err = lexical_realloc(ctx, &mem_587615, &mem_587615_cached_sizze_588983, bytes_587606);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586341;
    int64_t scanacc_586337 = (int64_t) 0;
    
    for (int64_t i_586339 = 0; i_586339 < total_part_no_457930; i_586339++) {
        int64_t x_582113 = ((int64_t *) mem_587607)[i_586339];
        int64_t defunc_0_op_res_582116 = add64(x_582113, scanacc_586337);
        
        ((int64_t *) mem_587615)[i_586339] = defunc_0_op_res_582116;
        
        int64_t scanacc_tmp_588216 = defunc_0_op_res_582116;
        
        scanacc_586337 = scanacc_tmp_588216;
    }
    discard_586341 = scanacc_586337;
    if (memblock_alloc(ctx, &mem_587623, bytes_587606, "mem_587623")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586344 = 0; i_586344 < total_part_no_457930; i_586344++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586344);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_457930);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587615)[tmp_582504];
        bool cond_582507 = i_586344 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587623.mem)[i_586344] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587504, "ext_mem_587504") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587623, "mem_587623") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587579, "mem_587579") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587583, "mem_587583") != 0)
        return 1;
    prim_out_588011 = total_grid_no_457929;
    prim_out_588012 = total_part_no_457930;
    prim_out_588013 = m_582052;
    if (memblock_set(ctx, &*mem_out_p_588902, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588903, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588904, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588905, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588906 = prim_out_588011;
    *out_prim_out_588907 = prim_out_588012;
    *out_prim_out_588908 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586419);
        free(mem_586427);
        free(mem_586429);
        free(mem_586436);
        free(mem_586443);
        free(mem_586457);
        free(mem_586484);
        free(mem_586492);
        free(mem_586494);
        free(mem_586502);
        free(mem_586510);
        free(mem_586512);
        free(mem_586526);
        free(mem_586531);
        free(mem_586542);
        free(mem_586568);
        free(mem_586571);
        free(mem_586575);
        free(mem_586578);
        free(mem_586598);
        free(mem_586600);
        free(mem_586603);
        free(mem_586605);
        free(mem_586664);
        free(mem_586666);
        free(mem_586755);
        free(mem_586758);
        free(mem_586762);
        free(mem_586765);
        free(mem_586785);
        free(mem_586787);
        free(mem_586802);
        free(mem_586805);
        free(mem_586809);
        free(mem_586812);
        free(mem_587028);
        free(mem_587036);
        free(mem_587041);
        free(mem_587049);
        free(mem_587057);
        free(mem_587062);
        free(mem_587073);
        free(mem_587096);
        free(mem_587100);
        free(mem_587103);
        free(mem_587119);
        free(mem_587122);
        free(mem_587124);
        free(mem_587171);
        free(mem_587173);
        free(mem_587242);
        free(mem_587246);
        free(mem_587249);
        free(mem_587265);
        free(mem_587267);
        free(mem_587282);
        free(mem_587286);
        free(mem_587289);
        free(mem_587465);
        free(mem_587470);
        free(mem_587484);
        free(mem_587491);
        free(mem_587506);
        free(mem_587514);
        free(mem_587516);
        free(mem_587518);
        free(mem_587529);
        free(mem_587537);
        free(mem_587545);
        free(mem_587550);
        free(mem_587561);
        free(mem_587581);
        free(mem_587595);
        free(mem_587607);
        free(mem_587615);
        if (memblock_unref(ctx, &mem_587623, "mem_587623") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587583, "mem_587583") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587579, "mem_587579") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587480, "mem_587480") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587501, "mem_587501") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587504, "ext_mem_587504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587026, "mem_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587023, "mem_587023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588142, "mem_param_tmp_588142") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588141, "mem_param_tmp_588141") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588140, "mem_param_tmp_588140") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588139, "mem_param_tmp_588139") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587000, "mem_587000") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586996, "mem_586996") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586991, "mem_586991") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586987, "mem_586987") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586908, "mem_586908") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586904, "mem_586904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586899, "mem_586899") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586895, "mem_586895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586923, "mem_586923") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586920, "mem_586920") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586918, "mem_586918") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586916, "mem_586916") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586957, "ext_mem_586957") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586961, "ext_mem_586961") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586964, "ext_mem_586964") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586967, "ext_mem_586967") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586752, "mem_param_586752") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586749, "mem_param_586749") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586745, "mem_param_586745") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586742, "mem_param_586742") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587011, "ext_mem_587011") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587012, "ext_mem_587012") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587013, "ext_mem_587013") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587014, "ext_mem_587014") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586738, "mem_586738") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586734, "mem_586734") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586729, "mem_586729") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586725, "mem_586725") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586623, "ext_mem_586623") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588115, "mem_param_tmp_588115") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586562, "ext_mem_586562") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586557, "mem_param_586557") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586565, "ext_mem_586565") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587017, "ext_mem_587017") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587021, "ext_mem_587021") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587461, "mem_587461") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587458, "mem_587458") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588066, "mem_param_tmp_588066") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588065, "mem_param_tmp_588065") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588064, "mem_param_tmp_588064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587438, "mem_587438") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587434, "mem_587434") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587429, "mem_587429") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587365, "mem_587365") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587361, "mem_587361") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587356, "mem_587356") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587378, "mem_587378") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587375, "mem_587375") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587373, "mem_587373") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587406, "ext_mem_587406") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587410, "ext_mem_587410") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587413, "ext_mem_587413") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587239, "mem_param_587239") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587236, "mem_param_587236") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587232, "mem_param_587232") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587447, "ext_mem_587447") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587448, "ext_mem_587448") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587449, "ext_mem_587449") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587228, "mem_587228") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587224, "mem_587224") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587219, "mem_587219") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587139, "ext_mem_587139") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588045, "mem_param_tmp_588045") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587090, "ext_mem_587090") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587085, "mem_param_587085") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587093, "ext_mem_587093") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587452, "ext_mem_587452") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587456, "ext_mem_587456") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587462, "ext_mem_587462") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587463, "ext_mem_587463") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586468, "mem_586468") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586466, "mem_586466") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sort_for_Skyline_GFUR_double(struct futhark_context *ctx, struct memblock *mem_out_p_588984, struct memblock *mem_out_p_588985, struct memblock *mem_out_p_588986, struct memblock *mem_out_p_588987, int64_t *out_prim_out_588988, int64_t *out_prim_out_588989, int64_t *out_prim_out_588990, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_251930, int64_t dz2080U_251931, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932, int64_t n_251933, int64_t total_angle_no_251940, int64_t total_grid_no_251941, int64_t total_part_no_251942, int64_t offset_251944, bool use_measure_for_sorting_251945)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586427_cached_sizze_588991 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586435_cached_sizze_588992 = 0;
    unsigned char *mem_586435 = NULL;
    int64_t mem_586437_cached_sizze_588993 = 0;
    unsigned char *mem_586437 = NULL;
    int64_t mem_586445_cached_sizze_588994 = 0;
    unsigned char *mem_586445 = NULL;
    int64_t mem_586453_cached_sizze_588995 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_588996 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586469_cached_sizze_588997 = 0;
    unsigned char *mem_586469 = NULL;
    int64_t mem_586474_cached_sizze_588998 = 0;
    unsigned char *mem_586474 = NULL;
    int64_t mem_586485_cached_sizze_588999 = 0;
    unsigned char *mem_586485 = NULL;
    int64_t mem_586510_cached_sizze_589000 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586513_cached_sizze_589001 = 0;
    unsigned char *mem_586513 = NULL;
    int64_t mem_586517_cached_sizze_589002 = 0;
    unsigned char *mem_586517 = NULL;
    int64_t mem_586520_cached_sizze_589003 = 0;
    unsigned char *mem_586520 = NULL;
    int64_t mem_586540_cached_sizze_589004 = 0;
    unsigned char *mem_586540 = NULL;
    int64_t mem_586542_cached_sizze_589005 = 0;
    unsigned char *mem_586542 = NULL;
    int64_t mem_586545_cached_sizze_589006 = 0;
    unsigned char *mem_586545 = NULL;
    int64_t mem_586547_cached_sizze_589007 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586605_cached_sizze_589008 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586607_cached_sizze_589009 = 0;
    unsigned char *mem_586607 = NULL;
    int64_t mem_586696_cached_sizze_589010 = 0;
    unsigned char *mem_586696 = NULL;
    int64_t mem_586699_cached_sizze_589011 = 0;
    unsigned char *mem_586699 = NULL;
    int64_t mem_586703_cached_sizze_589012 = 0;
    unsigned char *mem_586703 = NULL;
    int64_t mem_586706_cached_sizze_589013 = 0;
    unsigned char *mem_586706 = NULL;
    int64_t mem_586726_cached_sizze_589014 = 0;
    unsigned char *mem_586726 = NULL;
    int64_t mem_586728_cached_sizze_589015 = 0;
    unsigned char *mem_586728 = NULL;
    int64_t mem_586743_cached_sizze_589016 = 0;
    unsigned char *mem_586743 = NULL;
    int64_t mem_586746_cached_sizze_589017 = 0;
    unsigned char *mem_586746 = NULL;
    int64_t mem_586750_cached_sizze_589018 = 0;
    unsigned char *mem_586750 = NULL;
    int64_t mem_586753_cached_sizze_589019 = 0;
    unsigned char *mem_586753 = NULL;
    int64_t mem_586969_cached_sizze_589020 = 0;
    unsigned char *mem_586969 = NULL;
    int64_t mem_586977_cached_sizze_589021 = 0;
    unsigned char *mem_586977 = NULL;
    int64_t mem_586982_cached_sizze_589022 = 0;
    unsigned char *mem_586982 = NULL;
    int64_t mem_586990_cached_sizze_589023 = 0;
    unsigned char *mem_586990 = NULL;
    int64_t mem_586998_cached_sizze_589024 = 0;
    unsigned char *mem_586998 = NULL;
    int64_t mem_587003_cached_sizze_589025 = 0;
    unsigned char *mem_587003 = NULL;
    int64_t mem_587014_cached_sizze_589026 = 0;
    unsigned char *mem_587014 = NULL;
    int64_t mem_587036_cached_sizze_589027 = 0;
    unsigned char *mem_587036 = NULL;
    int64_t mem_587040_cached_sizze_589028 = 0;
    unsigned char *mem_587040 = NULL;
    int64_t mem_587043_cached_sizze_589029 = 0;
    unsigned char *mem_587043 = NULL;
    int64_t mem_587059_cached_sizze_589030 = 0;
    unsigned char *mem_587059 = NULL;
    int64_t mem_587062_cached_sizze_589031 = 0;
    unsigned char *mem_587062 = NULL;
    int64_t mem_587064_cached_sizze_589032 = 0;
    unsigned char *mem_587064 = NULL;
    int64_t mem_587110_cached_sizze_589033 = 0;
    unsigned char *mem_587110 = NULL;
    int64_t mem_587112_cached_sizze_589034 = 0;
    unsigned char *mem_587112 = NULL;
    int64_t mem_587181_cached_sizze_589035 = 0;
    unsigned char *mem_587181 = NULL;
    int64_t mem_587185_cached_sizze_589036 = 0;
    unsigned char *mem_587185 = NULL;
    int64_t mem_587188_cached_sizze_589037 = 0;
    unsigned char *mem_587188 = NULL;
    int64_t mem_587204_cached_sizze_589038 = 0;
    unsigned char *mem_587204 = NULL;
    int64_t mem_587206_cached_sizze_589039 = 0;
    unsigned char *mem_587206 = NULL;
    int64_t mem_587221_cached_sizze_589040 = 0;
    unsigned char *mem_587221 = NULL;
    int64_t mem_587225_cached_sizze_589041 = 0;
    unsigned char *mem_587225 = NULL;
    int64_t mem_587228_cached_sizze_589042 = 0;
    unsigned char *mem_587228 = NULL;
    int64_t mem_587404_cached_sizze_589043 = 0;
    unsigned char *mem_587404 = NULL;
    int64_t mem_587409_cached_sizze_589044 = 0;
    unsigned char *mem_587409 = NULL;
    int64_t mem_587423_cached_sizze_589045 = 0;
    unsigned char *mem_587423 = NULL;
    int64_t mem_587430_cached_sizze_589046 = 0;
    unsigned char *mem_587430 = NULL;
    int64_t mem_587445_cached_sizze_589047 = 0;
    unsigned char *mem_587445 = NULL;
    int64_t mem_587453_cached_sizze_589048 = 0;
    unsigned char *mem_587453 = NULL;
    int64_t mem_587455_cached_sizze_589049 = 0;
    unsigned char *mem_587455 = NULL;
    int64_t mem_587457_cached_sizze_589050 = 0;
    unsigned char *mem_587457 = NULL;
    int64_t mem_587468_cached_sizze_589051 = 0;
    unsigned char *mem_587468 = NULL;
    int64_t mem_587476_cached_sizze_589052 = 0;
    unsigned char *mem_587476 = NULL;
    int64_t mem_587484_cached_sizze_589053 = 0;
    unsigned char *mem_587484 = NULL;
    int64_t mem_587489_cached_sizze_589054 = 0;
    unsigned char *mem_587489 = NULL;
    int64_t mem_587500_cached_sizze_589055 = 0;
    unsigned char *mem_587500 = NULL;
    int64_t mem_587520_cached_sizze_589056 = 0;
    unsigned char *mem_587520 = NULL;
    int64_t mem_587534_cached_sizze_589057 = 0;
    unsigned char *mem_587534 = NULL;
    int64_t mem_587546_cached_sizze_589058 = 0;
    unsigned char *mem_587546 = NULL;
    int64_t mem_587554_cached_sizze_589059 = 0;
    unsigned char *mem_587554 = NULL;
    struct memblock mem_587562;
    
    mem_587562.references = NULL;
    
    struct memblock mem_587522;
    
    mem_587522.references = NULL;
    
    struct memblock mem_587518;
    
    mem_587518.references = NULL;
    
    struct memblock mem_587419;
    
    mem_587419.references = NULL;
    
    struct memblock mem_587440;
    
    mem_587440.references = NULL;
    
    struct memblock ext_mem_587443;
    
    ext_mem_587443.references = NULL;
    
    struct memblock mem_586967;
    
    mem_586967.references = NULL;
    
    struct memblock mem_586964;
    
    mem_586964.references = NULL;
    
    struct memblock mem_param_tmp_588127;
    
    mem_param_tmp_588127.references = NULL;
    
    struct memblock mem_param_tmp_588126;
    
    mem_param_tmp_588126.references = NULL;
    
    struct memblock mem_param_tmp_588125;
    
    mem_param_tmp_588125.references = NULL;
    
    struct memblock mem_param_tmp_588124;
    
    mem_param_tmp_588124.references = NULL;
    
    struct memblock mem_586941;
    
    mem_586941.references = NULL;
    
    struct memblock mem_586937;
    
    mem_586937.references = NULL;
    
    struct memblock mem_586932;
    
    mem_586932.references = NULL;
    
    struct memblock mem_586928;
    
    mem_586928.references = NULL;
    
    struct memblock mem_586849;
    
    mem_586849.references = NULL;
    
    struct memblock mem_586845;
    
    mem_586845.references = NULL;
    
    struct memblock mem_586840;
    
    mem_586840.references = NULL;
    
    struct memblock mem_586836;
    
    mem_586836.references = NULL;
    
    struct memblock mem_586864;
    
    mem_586864.references = NULL;
    
    struct memblock mem_586861;
    
    mem_586861.references = NULL;
    
    struct memblock mem_586859;
    
    mem_586859.references = NULL;
    
    struct memblock mem_586857;
    
    mem_586857.references = NULL;
    
    struct memblock ext_mem_586898;
    
    ext_mem_586898.references = NULL;
    
    struct memblock ext_mem_586902;
    
    ext_mem_586902.references = NULL;
    
    struct memblock ext_mem_586905;
    
    ext_mem_586905.references = NULL;
    
    struct memblock ext_mem_586908;
    
    ext_mem_586908.references = NULL;
    
    struct memblock mem_param_586693;
    
    mem_param_586693.references = NULL;
    
    struct memblock mem_param_586690;
    
    mem_param_586690.references = NULL;
    
    struct memblock mem_param_586686;
    
    mem_param_586686.references = NULL;
    
    struct memblock mem_param_586683;
    
    mem_param_586683.references = NULL;
    
    struct memblock ext_mem_586952;
    
    ext_mem_586952.references = NULL;
    
    struct memblock ext_mem_586953;
    
    ext_mem_586953.references = NULL;
    
    struct memblock ext_mem_586954;
    
    ext_mem_586954.references = NULL;
    
    struct memblock ext_mem_586955;
    
    ext_mem_586955.references = NULL;
    
    struct memblock mem_586679;
    
    mem_586679.references = NULL;
    
    struct memblock mem_586675;
    
    mem_586675.references = NULL;
    
    struct memblock mem_586670;
    
    mem_586670.references = NULL;
    
    struct memblock mem_586666;
    
    mem_586666.references = NULL;
    
    struct memblock ext_mem_586564;
    
    ext_mem_586564.references = NULL;
    
    struct memblock mem_param_tmp_588100;
    
    mem_param_tmp_588100.references = NULL;
    
    struct memblock ext_mem_586504;
    
    ext_mem_586504.references = NULL;
    
    struct memblock mem_param_586500;
    
    mem_param_586500.references = NULL;
    
    struct memblock ext_mem_586507;
    
    ext_mem_586507.references = NULL;
    
    struct memblock ext_mem_586958;
    
    ext_mem_586958.references = NULL;
    
    struct memblock ext_mem_586962;
    
    ext_mem_586962.references = NULL;
    
    struct memblock mem_587400;
    
    mem_587400.references = NULL;
    
    struct memblock mem_587397;
    
    mem_587397.references = NULL;
    
    struct memblock mem_param_tmp_588051;
    
    mem_param_tmp_588051.references = NULL;
    
    struct memblock mem_param_tmp_588050;
    
    mem_param_tmp_588050.references = NULL;
    
    struct memblock mem_param_tmp_588049;
    
    mem_param_tmp_588049.references = NULL;
    
    struct memblock mem_587377;
    
    mem_587377.references = NULL;
    
    struct memblock mem_587373;
    
    mem_587373.references = NULL;
    
    struct memblock mem_587368;
    
    mem_587368.references = NULL;
    
    struct memblock mem_587304;
    
    mem_587304.references = NULL;
    
    struct memblock mem_587300;
    
    mem_587300.references = NULL;
    
    struct memblock mem_587295;
    
    mem_587295.references = NULL;
    
    struct memblock mem_587317;
    
    mem_587317.references = NULL;
    
    struct memblock mem_587314;
    
    mem_587314.references = NULL;
    
    struct memblock mem_587312;
    
    mem_587312.references = NULL;
    
    struct memblock ext_mem_587345;
    
    ext_mem_587345.references = NULL;
    
    struct memblock ext_mem_587349;
    
    ext_mem_587349.references = NULL;
    
    struct memblock ext_mem_587352;
    
    ext_mem_587352.references = NULL;
    
    struct memblock mem_param_587178;
    
    mem_param_587178.references = NULL;
    
    struct memblock mem_param_587175;
    
    mem_param_587175.references = NULL;
    
    struct memblock mem_param_587171;
    
    mem_param_587171.references = NULL;
    
    struct memblock ext_mem_587386;
    
    ext_mem_587386.references = NULL;
    
    struct memblock ext_mem_587387;
    
    ext_mem_587387.references = NULL;
    
    struct memblock ext_mem_587388;
    
    ext_mem_587388.references = NULL;
    
    struct memblock mem_587167;
    
    mem_587167.references = NULL;
    
    struct memblock mem_587163;
    
    mem_587163.references = NULL;
    
    struct memblock mem_587158;
    
    mem_587158.references = NULL;
    
    struct memblock ext_mem_587078;
    
    ext_mem_587078.references = NULL;
    
    struct memblock mem_param_tmp_588030;
    
    mem_param_tmp_588030.references = NULL;
    
    struct memblock ext_mem_587030;
    
    ext_mem_587030.references = NULL;
    
    struct memblock mem_param_587026;
    
    mem_param_587026.references = NULL;
    
    struct memblock ext_mem_587033;
    
    ext_mem_587033.references = NULL;
    
    struct memblock ext_mem_587391;
    
    ext_mem_587391.references = NULL;
    
    struct memblock ext_mem_587395;
    
    ext_mem_587395.references = NULL;
    
    struct memblock ext_mem_587401;
    
    ext_mem_587401.references = NULL;
    
    struct memblock ext_mem_587402;
    
    ext_mem_587402.references = NULL;
    
    struct memblock mem_586419;
    
    mem_586419.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_578018 = sub64(dim_251930, (int64_t) 1);
    bool assert_cond_578019 = arg_578018 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932;
    bool assert_c_578020;
    
    if (!assert_cond_578019) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586418 = (int64_t) 8 * n_251933;
    
    if (memblock_alloc(ctx, &mem_586419, bytes_586418, "mem_586419")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < n_251933; i_586050++) {
        int64_t lifted_lambda_res_578027 = add64(offset_251944, i_586050);
        
        ((int64_t *) mem_586419.mem)[i_586050] = lifted_lambda_res_578027;
    }
    
    bool cond_578028 = !use_measure_for_sorting_251945;
    bool y_578724 = slt64((int64_t) 0, dz2080U_251931);
    bool protect_assert_disj_582415 = cond_578028 || y_578724;
    bool index_certs_578725;
    
    if (!protect_assert_disj_582415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582417 = assert_cond_578019 || cond_578028;
    bool empty_or_match_cert_578818;
    
    if (!protect_assert_disj_582417) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578849 = sle64(n_251933, (int64_t) 1);
    bool x_578850 = !cond_578849;
    int64_t zs_lhs_578851 = sub64(n_251933, (int64_t) 1);
    int64_t zp_rhs_578852 = sdiv_safe64(zs_lhs_578851, (int64_t) 20);
    int64_t min_num_blocks_578853 = add64((int64_t) 1, zp_rhs_578852);
    bool loop_cond_578854 = slt64((int64_t) 1, min_num_blocks_578853);
    bool x_582418;
    int64_t x_582419;
    bool loop_while_578857;
    int64_t x_578858;
    
    loop_while_578857 = loop_cond_578854;
    x_578858 = (int64_t) 1;
    while (loop_while_578857) {
        int64_t loopres_578859 = mul64((int64_t) 2, x_578858);
        bool loop_cond_578860 = slt64(loopres_578859, min_num_blocks_578853);
        bool loop_while_tmp_588015 = loop_cond_578860;
        int64_t x_tmp_588016 = loopres_578859;
        
        loop_while_578857 = loop_while_tmp_588015;
        x_578858 = x_tmp_588016;
    }
    x_582418 = loop_while_578857;
    x_582419 = x_578858;
    
    bool zzero_578861 = x_582419 == (int64_t) 0;
    bool nonzzero_578862 = !zzero_578861;
    bool protect_assert_disj_578863 = cond_578849 || nonzzero_578862;
    bool protect_assert_disj_582423 = cond_578028 || protect_assert_disj_578863;
    bool nonzzero_cert_578864;
    
    if (!protect_assert_disj_582423) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_578865 = sdiv_safe64(zs_lhs_578851, x_582419);
    int64_t block_sizze_578866 = add64((int64_t) 1, zp_rhs_578865);
    bool y_578867 = slt64((int64_t) 0, n_251933);
    bool protect_assert_disj_578868 = cond_578849 || y_578867;
    bool protect_assert_disj_582425 = cond_578028 || protect_assert_disj_578868;
    bool index_certs_578869;
    
    if (!protect_assert_disj_582425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flat_dim_578876 = block_sizze_578866 * x_582419;
    int64_t greatest_divisor_leq_than_arg1_578881 = mul64((int64_t) 2, block_sizze_578866);
    bool protect_cond_conj_582427 = use_measure_for_sorting_251945 && x_578850;
    int64_t merge_block_sizze_578882;
    
    if (protect_cond_conj_582427) {
        int64_t x_584593;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584593, (int64_t) 8, greatest_divisor_leq_than_arg1_578881) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_578882 = x_584593;
    } else {
        merge_block_sizze_578882 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_578911 = slt64(x_582419, (int64_t) 0);
    bool valid_578912 = !bounds_invalid_upwards_578911;
    bool protect_assert_disj_582404 = cond_578849 || valid_578912;
    bool protect_assert_disj_582429 = cond_578028 || protect_assert_disj_582404;
    bool range_valid_c_578913;
    
    if (!protect_assert_disj_582429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582419, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:790:33-56\n   #6  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_578915 = slt64(block_sizze_578866, (int64_t) 0);
    bool valid_578916 = !bounds_invalid_upwards_578915;
    bool protect_assert_disj_582406 = cond_578849 || valid_578916;
    bool protect_assert_disj_582431 = cond_578028 || protect_assert_disj_582406;
    bool range_valid_c_578917;
    
    if (!protect_assert_disj_582431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_578866, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578919 = sle64(block_sizze_578866, (int64_t) 1);
    int64_t tmp_578920 = sub64(block_sizze_578866, (int64_t) 2);
    bool bounds_invalid_upwards_578921 = slt64(tmp_578920, (int64_t) 0);
    int64_t distance_578922 = add64((int64_t) 1, tmp_578920);
    bool valid_578923 = !bounds_invalid_upwards_578921;
    bool protect_assert_disj_578924 = cond_578919 || valid_578923;
    bool protect_assert_disj_582408 = cond_578849 || protect_assert_disj_578924;
    bool protect_assert_disj_582433 = cond_578028 || protect_assert_disj_582408;
    bool range_valid_c_578925;
    
    if (!protect_assert_disj_582433) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_578920, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_579045 = slt64(block_sizze_578866, flat_dim_578876);
    bool zzero_579046 = merge_block_sizze_578882 == (int64_t) 0;
    bool nonzzero_579047 = !zzero_579046;
    bool empty_slice_579509 = n_251933 == (int64_t) 0;
    bool zzero_leq_i_p_m_t_s_579510 = sle64((int64_t) 0, zs_lhs_578851);
    bool protect_assert_disj_582377 = use_measure_for_sorting_251945 || y_578724;
    bool index_certs_578037;
    
    if (!protect_assert_disj_582377) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582379 = use_measure_for_sorting_251945 || assert_cond_578019;
    bool empty_or_match_cert_578121;
    
    if (!protect_assert_disj_582379) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582380;
    int64_t x_582381;
    bool loop_while_578157;
    int64_t x_578158;
    
    loop_while_578157 = loop_cond_578854;
    x_578158 = (int64_t) 1;
    while (loop_while_578157) {
        int64_t loopres_578159 = mul64((int64_t) 2, x_578158);
        bool loop_cond_578160 = slt64(loopres_578159, min_num_blocks_578853);
        bool loop_while_tmp_588017 = loop_cond_578160;
        int64_t x_tmp_588018 = loopres_578159;
        
        loop_while_578157 = loop_while_tmp_588017;
        x_578158 = x_tmp_588018;
    }
    x_582380 = loop_while_578157;
    x_582381 = x_578158;
    
    bool zzero_578161 = x_582381 == (int64_t) 0;
    bool nonzzero_578162 = !zzero_578161;
    bool protect_assert_disj_578163 = nonzzero_578162 || cond_578849;
    bool protect_assert_disj_582385 = use_measure_for_sorting_251945 || protect_assert_disj_578163;
    bool nonzzero_cert_578164;
    
    if (!protect_assert_disj_582385) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_578165 = sdiv_safe64(zs_lhs_578851, x_582381);
    int64_t block_sizze_578166 = add64((int64_t) 1, zp_rhs_578165);
    bool protect_assert_disj_582387 = use_measure_for_sorting_251945 || protect_assert_disj_578868;
    bool index_certs_578169;
    
    if (!protect_assert_disj_582387) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flat_dim_578174 = block_sizze_578166 * x_582381;
    int64_t greatest_divisor_leq_than_arg1_578178 = mul64((int64_t) 2, block_sizze_578166);
    bool protect_cond_conj_582389 = cond_578028 && x_578850;
    int64_t merge_block_sizze_578179;
    
    if (protect_cond_conj_582389) {
        int64_t x_584594;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584594, (int64_t) 8, greatest_divisor_leq_than_arg1_578178) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_578179 = x_584594;
    } else {
        merge_block_sizze_578179 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_578197 = slt64(x_582381, (int64_t) 0);
    bool valid_578198 = !bounds_invalid_upwards_578197;
    bool protect_assert_disj_582366 = valid_578198 || cond_578849;
    bool protect_assert_disj_582391 = use_measure_for_sorting_251945 || protect_assert_disj_582366;
    bool range_valid_c_578199;
    
    if (!protect_assert_disj_582391) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582381, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_578201 = slt64(block_sizze_578166, (int64_t) 0);
    bool valid_578202 = !bounds_invalid_upwards_578201;
    bool protect_assert_disj_582368 = valid_578202 || cond_578849;
    bool protect_assert_disj_582393 = use_measure_for_sorting_251945 || protect_assert_disj_582368;
    bool range_valid_c_578203;
    
    if (!protect_assert_disj_582393) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_578166, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578205 = sle64(block_sizze_578166, (int64_t) 1);
    int64_t tmp_578206 = sub64(block_sizze_578166, (int64_t) 2);
    bool bounds_invalid_upwards_578207 = slt64(tmp_578206, (int64_t) 0);
    int64_t distance_578208 = add64((int64_t) 1, tmp_578206);
    bool valid_578209 = !bounds_invalid_upwards_578207;
    bool protect_assert_disj_578210 = cond_578205 || valid_578209;
    bool protect_assert_disj_582370 = protect_assert_disj_578210 || cond_578849;
    bool protect_assert_disj_582395 = use_measure_for_sorting_251945 || protect_assert_disj_582370;
    bool range_valid_c_578211;
    
    if (!protect_assert_disj_582395) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_578206, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_578299 = slt64(block_sizze_578166, flat_dim_578174);
    bool zzero_578300 = merge_block_sizze_578179 == (int64_t) 0;
    bool nonzzero_578301 = !zzero_578300;
    int64_t bytes_586426 = (int64_t) 8 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932;
    int64_t bytes_586444 = (int64_t) 8 * dim_251930;
    int64_t bytes_586468 = (int64_t) 8 * arg_578018;
    int64_t binop_x_586508 = (int64_t) 8 * x_582419;
    int64_t bytes_586509 = block_sizze_578866 * binop_x_586508;
    int64_t bytes_586516 = dim_251930 * bytes_586509;
    int64_t lmad_arg_586538 = dim_251930 * block_sizze_578866;
    int64_t bytes_586539 = (int64_t) 8 * block_sizze_578866;
    int64_t bytes_586544 = dim_251930 * bytes_586539;
    int64_t lmad_arg_586771 = dim_251930 * merge_block_sizze_578882;
    int64_t bytes_586966 = dim_251930 * bytes_586418;
    int64_t binop_x_587034 = (int64_t) 8 * x_582381;
    int64_t bytes_587035 = block_sizze_578166 * binop_x_587034;
    int64_t bytes_587039 = dim_251930 * bytes_587035;
    int64_t lmad_arg_587057 = dim_251930 * block_sizze_578166;
    int64_t bytes_587058 = (int64_t) 8 * block_sizze_578166;
    int64_t bytes_587061 = dim_251930 * bytes_587058;
    int64_t lmad_arg_587242 = dim_251930 * merge_block_sizze_578179;
    
    if (cond_578028) {
        if (mem_586969_cached_sizze_589020 < bytes_586426) {
            err = lexical_realloc(ctx, &mem_586969, &mem_586969_cached_sizze_589020, bytes_586426);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586054 = 0; i_586054 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932; i_586054++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584786 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586054];
            double i64_res_584787 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584786);
            double defunc_0_fover_res_584788 = 1.5707963267948966 / i64_res_584787;
            
            ((double *) mem_586969)[i_586054] = defunc_0_fover_res_584788;
        }
        if (mem_586977_cached_sizze_589021 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586977, &mem_586977_cached_sizze_589021, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586982_cached_sizze_589022 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586982, &mem_586982_cached_sizze_589022, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586990_cached_sizze_589023 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586990, &mem_586990_cached_sizze_589023, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586998_cached_sizze_589024 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_586998, &mem_586998_cached_sizze_589024, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587014_cached_sizze_589026 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_587014, &mem_587014_cached_sizze_589026, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586074 = 0; i_586074 < n_251933; i_586074++) {
            for (int64_t i_586058 = 0; i_586058 < dim_251930; i_586058++) {
                double eta_p_584795 = ((double *) xs_mem_586417.mem)[i_586074 * dim_251930 + i_586058];
                double eta_p_584796 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586058];
                double eta_p_584797 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586058];
                int64_t eta_p_584799 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586058];
                double defunc_0_f_res_584800 = eta_p_584795 - eta_p_584796;
                double defunc_0_f_res_584801 = defunc_0_f_res_584800 / eta_p_584797;
                int64_t f64_res_584802 = fptosi_f64_i64(defunc_0_f_res_584801);
                int64_t max_res_584803 = smax64((int64_t) 0, f64_res_584802);
                int64_t zm_lhs_584808 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586058];
                int64_t min_arg1_584809 = sub64(zm_lhs_584808, (int64_t) 1);
                int64_t min_res_584810 = smin64(max_res_584803, min_arg1_584809);
                int64_t defunc_0_f_res_584811 = mul64(eta_p_584799, min_res_584810);
                
                ((int64_t *) mem_586982)[i_586058] = defunc_0_f_res_584811;
            }
            
            int64_t defunc_0_foldl_res_584813;
            int64_t acc_584815 = (int64_t) 0;
            
            for (int64_t i_584814 = 0; i_584814 < dim_251930; i_584814++) {
                int64_t b_584816 = ((int64_t *) mem_586982)[i_584814];
                int64_t defunc_0_f_res_584817 = add64(acc_584815, b_584816);
                int64_t acc_tmp_588022 = defunc_0_f_res_584817;
                
                acc_584815 = acc_tmp_588022;
            }
            defunc_0_foldl_res_584813 = acc_584815;
            
            bool x_584818 = sle64((int64_t) 0, defunc_0_foldl_res_584813);
            bool y_584819 = slt64(defunc_0_foldl_res_584813, dz2080U_251931);
            bool bounds_check_584820 = x_584818 && y_584819;
            bool index_certs_584821;
            
            if (!bounds_check_584820) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_584813, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586062 = 0; i_586062 < dim_251930; i_586062++) {
                double eta_p_584824 = ((double *) xs_mem_586417.mem)[i_586074 * dim_251930 + i_586062];
                double eta_p_584825 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_584813 * dim_251930 + i_586062];
                double defunc_0_f_res_584826 = eta_p_584824 - eta_p_584825;
                
                ((double *) mem_586990)[i_586062] = defunc_0_f_res_584826;
            }
            for (int64_t nest_i_588024 = 0; nest_i_588024 < arg_578018; nest_i_588024++) {
                ((double *) mem_586998)[nest_i_588024] = 0.0;
            }
            for (int64_t i_584830 = 0; i_584830 < arg_578018; i_584830++) {
                bool y_584832 = slt64(i_584830, dim_251930);
                bool index_certs_584833;
                
                if (!y_584832) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584830, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_584835 = add64((int64_t) 1, i_584830);
                int64_t j_m_i_584836 = sub64(dim_251930, map_arg1_584835);
                bool empty_slice_584837 = j_m_i_584836 == (int64_t) 0;
                int64_t m_584838 = sub64(j_m_i_584836, (int64_t) 1);
                int64_t i_p_m_t_s_584839 = add64(map_arg1_584835, m_584838);
                bool zzero_leq_i_p_m_t_s_584840 = sle64((int64_t) 0, i_p_m_t_s_584839);
                bool i_p_m_t_s_leq_w_584841 = slt64(i_p_m_t_s_584839, dim_251930);
                bool zzero_lte_i_584842 = sle64((int64_t) 0, map_arg1_584835);
                bool i_lte_j_584843 = sle64(map_arg1_584835, dim_251930);
                bool y_584844 = i_p_m_t_s_leq_w_584841 && zzero_lte_i_584842;
                bool y_584845 = zzero_leq_i_p_m_t_s_584840 && y_584844;
                bool forwards_ok_584846 = i_lte_j_584843 && y_584845;
                bool ok_or_empty_584847 = empty_slice_584837 || forwards_ok_584846;
                bool index_certs_584848;
                
                if (!ok_or_empty_584847) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_584835, ":", (long long) dim_251930, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587002 = (int64_t) 8 * j_m_i_584836;
                double this_x_584834 = ((double *) mem_586990)[i_584830];
                
                if (mem_587003_cached_sizze_589025 < bytes_587002) {
                    err = lexical_realloc(ctx, &mem_587003, &mem_587003_cached_sizze_589025, bytes_587002);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586066 = 0; i_586066 < j_m_i_584836; i_586066++) {
                    int64_t slice_586383 = map_arg1_584835 + i_586066;
                    double eta_p_584851 = ((double *) mem_586990)[slice_586383];
                    double defunc_0_ftimes_res_584852 = eta_p_584851 * eta_p_584851;
                    
                    ((double *) mem_587003)[i_586066] = defunc_0_ftimes_res_584852;
                }
                
                double defunc_0_foldl_res_584854;
                double acc_584856 = 0.0;
                
                for (int64_t i_584855 = 0; i_584855 < j_m_i_584836; i_584855++) {
                    double b_584857 = ((double *) mem_587003)[i_584855];
                    double defunc_0_f_res_584858 = acc_584856 + b_584857;
                    double acc_tmp_588027 = defunc_0_f_res_584858;
                    
                    acc_584856 = acc_tmp_588027;
                }
                defunc_0_foldl_res_584854 = acc_584856;
                
                double sqrt_res_584859 = futrts_sqrt64(defunc_0_foldl_res_584854);
                double atan2_res_584860 = futrts_atan2_64(sqrt_res_584859, this_x_584834);
                
                ((double *) mem_586998)[i_584830] = atan2_res_584860;
            }
            for (int64_t i_586070 = 0; i_586070 < arg_578018; i_586070++) {
                double eta_p_584863 = ((double *) mem_586998)[i_586070];
                double eta_p_584864 = ((double *) mem_586969)[i_586070];
                int64_t eta_p_584865 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586070];
                int64_t eta_p_584866 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586070];
                double i64_res_584867 = sitofp_i64_f64(eta_p_584865);
                double defunc_0_fover_res_584868 = eta_p_584863 / eta_p_584864;
                double defunc_0_ftimes_res_584869 = i64_res_584867 * defunc_0_fover_res_584868;
                int64_t f64_res_584870 = fptosi_f64_i64(defunc_0_ftimes_res_584869);
                bool cond_584871 = slt64(f64_res_584870, (int64_t) 0);
                int64_t defunc_0_f_res_584872;
                
                if (cond_584871) {
                    defunc_0_f_res_584872 = (int64_t) 0;
                } else {
                    bool cond_584873 = sle64(eta_p_584866, f64_res_584870);
                    int64_t defunc_0_f_res_f_res_584874;
                    
                    if (cond_584873) {
                        int64_t defunc_0_f_res_f_res_t_res_584875 = sub64(eta_p_584866, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_584874 = defunc_0_f_res_f_res_t_res_584875;
                    } else {
                        defunc_0_f_res_f_res_584874 = f64_res_584870;
                    }
                    defunc_0_f_res_584872 = defunc_0_f_res_f_res_584874;
                }
                ((int64_t *) mem_587014)[i_586070] = defunc_0_f_res_584872;
            }
            
            int64_t defunc_0_foldl_res_584877;
            int64_t acc_584879 = (int64_t) 0;
            
            for (int64_t i_584878 = 0; i_584878 < arg_578018; i_584878++) {
                int64_t b_584880 = ((int64_t *) mem_587014)[i_584878];
                int64_t defunc_0_f_res_584881 = add64(acc_584879, b_584880);
                int64_t acc_tmp_588029 = defunc_0_f_res_584881;
                
                acc_584879 = acc_tmp_588029;
            }
            defunc_0_foldl_res_584877 = acc_584879;
            
            int64_t zp_lhs_584882 = mul64(total_angle_no_251940, defunc_0_foldl_res_584813);
            int64_t get_id_from_grid_angle_res_584883 = add64(defunc_0_foldl_res_584877, zp_lhs_584882);
            
            ((int64_t *) mem_586977)[i_586074] = get_id_from_grid_angle_res_584883;
        }
        
        int64_t reduce_arg1_584886;
        
        if (x_578850) {
            int64_t x_584887 = ((int64_t *) mem_586977)[(int64_t) 0];
            
            reduce_arg1_584886 = x_584887;
        } else {
            reduce_arg1_584886 = (int64_t) 0;
        }
        if (cond_578849) {
            if (memblock_set(ctx, &ext_mem_587395, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587391, &mem_586419, "mem_586419") != 0)
                return 1;
        } else {
            int64_t ext_587032;
            int64_t defunc_0_reduce_res_584891;
            int64_t defunc_0_reduce_res_584893;
            int64_t redout_586076;
            int64_t redout_586078;
            int64_t ctx_param_ext_587024;
            
            if (memblock_set(ctx, &mem_param_587026, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            ctx_param_ext_587024 = (int64_t) 0;
            redout_586076 = reduce_arg1_584886;
            redout_586078 = offset_251944;
            for (int64_t i_586079 = 0; i_586079 < n_251933; i_586079++) {
                int64_t x_584894 = ((int64_t *) mem_586977)[i_586079];
                int64_t x_584896 = ((int64_t *) mem_586419.mem)[i_586079];
                bool lifted_lambda_res_584903 = sle64(redout_586076, x_584894);
                int64_t defunc_0_op_res_584904;
                
                if (lifted_lambda_res_584903) {
                    defunc_0_op_res_584904 = x_584894;
                } else {
                    defunc_0_op_res_584904 = redout_586076;
                }
                
                int64_t defunc_0_op_res_584905;
                
                if (lifted_lambda_res_584903) {
                    defunc_0_op_res_584905 = x_584896;
                } else {
                    defunc_0_op_res_584905 = redout_586078;
                }
                
                int64_t lmad_ext_587027 = dim_251930 * i_586079;
                int64_t ext_587029;
                
                if (lifted_lambda_res_584903) {
                    ext_587029 = lmad_ext_587027;
                } else {
                    ext_587029 = ctx_param_ext_587024;
                }
                if (lifted_lambda_res_584903) {
                    if (memblock_set(ctx, &ext_mem_587030, &xs_mem_586417, "xs_mem_586417") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587030, &mem_param_587026, "mem_param_587026") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588030, &ext_mem_587030, "ext_mem_587030") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588031 = ext_587029;
                int64_t redout_tmp_588032 = defunc_0_op_res_584904;
                int64_t redout_tmp_588034 = defunc_0_op_res_584905;
                
                if (memblock_set(ctx, &mem_param_587026, &mem_param_tmp_588030, "mem_param_tmp_588030") != 0)
                    return 1;
                ctx_param_ext_587024 = ctx_param_ext_tmp_588031;
                redout_586076 = redout_tmp_588032;
                redout_586078 = redout_tmp_588034;
            }
            if (memblock_set(ctx, &ext_mem_587033, &mem_param_587026, "mem_param_587026") != 0)
                return 1;
            ext_587032 = ctx_param_ext_587024;
            defunc_0_reduce_res_584891 = redout_586076;
            defunc_0_reduce_res_584893 = redout_586078;
            if (mem_587036_cached_sizze_589027 < bytes_587035) {
                err = lexical_realloc(ctx, &mem_587036, &mem_587036_cached_sizze_589027, bytes_587035);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587040_cached_sizze_589028 < bytes_587039) {
                err = lexical_realloc(ctx, &mem_587040, &mem_587040_cached_sizze_589028, bytes_587039);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587043_cached_sizze_589029 < bytes_587035) {
                err = lexical_realloc(ctx, &mem_587043, &mem_587043_cached_sizze_589029, bytes_587035);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587059_cached_sizze_589030 < bytes_587058) {
                err = lexical_realloc(ctx, &mem_587059, &mem_587059_cached_sizze_589030, bytes_587058);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587062_cached_sizze_589031 < bytes_587061) {
                err = lexical_realloc(ctx, &mem_587062, &mem_587062_cached_sizze_589031, bytes_587061);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587064_cached_sizze_589032 < bytes_587058) {
                err = lexical_realloc(ctx, &mem_587064, &mem_587064_cached_sizze_589032, bytes_587058);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586096 = 0; i_586096 < x_582381; i_586096++) {
                int64_t zp_lhs_584922 = mul64(block_sizze_578166, i_586096);
                
                for (int64_t i_586086 = 0; i_586086 < block_sizze_578166; i_586086++) {
                    int64_t k_584927 = add64(zp_lhs_584922, i_586086);
                    bool cond_584928 = slt64(k_584927, n_251933);
                    int64_t lmad_ext_587075 = dim_251930 * k_584927;
                    int64_t ext_587077;
                    
                    if (cond_584928) {
                        ext_587077 = lmad_ext_587075;
                    } else {
                        ext_587077 = ext_587032;
                    }
                    
                    int64_t lifted_lambda_res_584929;
                    int64_t lifted_lambda_res_584931;
                    
                    if (cond_584928) {
                        bool x_584932 = sle64((int64_t) 0, k_584927);
                        bool bounds_check_584933 = cond_584928 && x_584932;
                        bool index_certs_584934;
                        
                        if (!bounds_check_584933) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_584927, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_584935 = ((int64_t *) mem_586977)[k_584927];
                        int64_t index_primexp_584937 = add64(offset_251944, k_584927);
                        
                        if (memblock_set(ctx, &ext_mem_587078, &xs_mem_586417, "xs_mem_586417") != 0)
                            return 1;
                        lifted_lambda_res_584929 = lifted_lambda_res_t_res_584935;
                        lifted_lambda_res_584931 = index_primexp_584937;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587078, &ext_mem_587033, "ext_mem_587033") != 0)
                            return 1;
                        lifted_lambda_res_584929 = defunc_0_reduce_res_584891;
                        lifted_lambda_res_584931 = defunc_0_reduce_res_584893;
                    }
                    ((int64_t *) mem_587059)[i_586086] = lifted_lambda_res_584929;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587062, i_586086 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587078.mem, ext_587077, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                    if (memblock_unref(ctx, &ext_mem_587078, "ext_mem_587078") != 0)
                        return 1;
                    ((int64_t *) mem_587064)[i_586086] = lifted_lambda_res_584931;
                }
                if (!cond_578205) {
                    if (mem_587110_cached_sizze_589033 < bytes_586444) {
                        err = lexical_realloc(ctx, &mem_587110, &mem_587110_cached_sizze_589033, bytes_586444);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587112_cached_sizze_589034 < bytes_586444) {
                        err = lexical_realloc(ctx, &mem_587112, &mem_587112_cached_sizze_589034, bytes_586444);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_584947 = 0; i_584947 < distance_578208; i_584947++) {
                        int64_t gt_arg1_584951 = add64((int64_t) 1, i_584947);
                        bool x_584952 = sle64((int64_t) 0, gt_arg1_584951);
                        bool y_584953 = slt64(gt_arg1_584951, block_sizze_578166);
                        bool bounds_check_584954 = x_584952 && y_584953;
                        bool index_certs_584955;
                        
                        if (!bounds_check_584954) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_584951, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_584957 = slt64(i_584947, block_sizze_578166);
                        bool index_certs_584958;
                        
                        if (!y_584957) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584947, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_584956 = ((int64_t *) mem_587059)[gt_arg1_584951];
                        int64_t gt_arg0_584959 = ((int64_t *) mem_587059)[i_584947];
                        bool lifted_lambda_res_584960 = sle64(gt_arg0_584959, gt_arg1_584956);
                        bool defunc_0_lifted_gt_res_584961 = !lifted_lambda_res_584960;
                        bool s_584962;
                        int64_t s_584966;
                        bool loop_while_584967;
                        int64_t j_584971;
                        
                        loop_while_584967 = defunc_0_lifted_gt_res_584961;
                        j_584971 = i_584947;
                        while (loop_while_584967) {
                            bool x_584972 = sle64((int64_t) 0, j_584971);
                            bool y_584973 = slt64(j_584971, block_sizze_578166);
                            bool bounds_check_584974 = x_584972 && y_584973;
                            bool index_certs_584975;
                            
                            if (!bounds_check_584974) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_584971, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_584980 = add64((int64_t) 1, j_584971);
                            bool x_584981 = sle64((int64_t) 0, copy_arg0_584980);
                            bool y_584982 = slt64(copy_arg0_584980, block_sizze_578166);
                            bool bounds_check_584983 = x_584981 && y_584982;
                            bool index_certs_584984;
                            
                            if (!bounds_check_584983) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_584980, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_584976 = ((int64_t *) mem_587059)[j_584971];
                            int64_t copy_arg0_584978 = ((int64_t *) mem_587064)[j_584971];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587110, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587062, (int64_t) 0 + j_584971 * dim_251930, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            
                            int64_t copy_arg0_584985 = ((int64_t *) mem_587059)[copy_arg0_584980];
                            int64_t copy_arg0_584987 = ((int64_t *) mem_587064)[copy_arg0_584980];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587112, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587062, (int64_t) 0 + copy_arg0_584980 * dim_251930, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_587059)[j_584971] = copy_arg0_584985;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587062, j_584971 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587112, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_587064)[j_584971] = copy_arg0_584987;
                            ((int64_t *) mem_587059)[copy_arg0_584980] = copy_arg0_584976;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587062, copy_arg0_584980 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587110, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_587064)[copy_arg0_584980] = copy_arg0_584978;
                            
                            int64_t tmp_584995 = sub64(j_584971, (int64_t) 1);
                            bool cond_584996 = sle64((int64_t) 0, tmp_584995);
                            bool loop_cond_584997;
                            
                            if (cond_584996) {
                                bool y_584999 = slt64(tmp_584995, block_sizze_578166);
                                bool bounds_check_585000 = cond_584996 && y_584999;
                                bool index_certs_585001;
                                
                                if (!bounds_check_585000) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_584995, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_584998 = ((int64_t *) mem_587059)[j_584971];
                                int64_t gt_arg0_585002 = ((int64_t *) mem_587059)[tmp_584995];
                                bool lifted_lambda_res_585003 = sle64(gt_arg0_585002, gt_arg1_584998);
                                bool defunc_0_lifted_gt_res_585004 = !lifted_lambda_res_585003;
                                
                                loop_cond_584997 = defunc_0_lifted_gt_res_585004;
                            } else {
                                loop_cond_584997 = 0;
                            }
                            
                            bool loop_while_tmp_588044 = loop_cond_584997;
                            int64_t j_tmp_588048 = tmp_584995;
                            
                            loop_while_584967 = loop_while_tmp_588044;
                            j_584971 = j_tmp_588048;
                        }
                        s_584962 = loop_while_584967;
                        s_584966 = j_584971;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587036, i_586096 * block_sizze_578166, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587059, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578166});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587040, i_586096 * lmad_arg_587057, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) mem_587062, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {block_sizze_578166, dim_251930});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587043, i_586096 * block_sizze_578166, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587064, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578166});
            }
            if (memblock_unref(ctx, &ext_mem_587033, "ext_mem_587033") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587158, bytes_587035, "mem_587158")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587158.mem, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (uint64_t *) mem_587036, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166});
            if (memblock_alloc(ctx, &mem_587163, bytes_587039, "mem_587163")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_587163.mem, (int64_t) 0, (int64_t []) {dim_251930 * block_sizze_578166, dim_251930, (int64_t) 1}, (uint64_t *) mem_587040, (int64_t) 0, (int64_t []) {lmad_arg_587057, dim_251930, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166, dim_251930});
            if (memblock_alloc(ctx, &mem_587167, bytes_587035, "mem_587167")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587167.mem, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (uint64_t *) mem_587043, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166});
            
            int64_t data_585017;
            bool data_585018;
            int64_t data_585022;
            int64_t loop_dz2084Uz2082U_585023;
            bool loop_while_585024;
            int64_t stride_585028;
            
            if (memblock_set(ctx, &mem_param_587171, &mem_587158, "mem_587158") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587175, &mem_587163, "mem_587163") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587178, &mem_587167, "mem_587167") != 0)
                return 1;
            loop_dz2084Uz2082U_585023 = flat_dim_578174;
            loop_while_585024 = loop_cond_578299;
            stride_585028 = block_sizze_578166;
            while (loop_while_585024) {
                int64_t next_stride_585029 = mul64((int64_t) 2, stride_585028);
                bool zzero_585030 = next_stride_585029 == (int64_t) 0;
                bool nonzzero_585031 = !zzero_585030;
                bool nonzzero_cert_585032;
                
                if (!nonzzero_585031) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585033 = sdiv64(flat_dim_578174, next_stride_585029);
                bool bounds_invalid_upwards_585034 = slt64(num_merges_585033, (int64_t) 0);
                bool valid_585035 = !bounds_invalid_upwards_585034;
                bool range_valid_c_585036;
                
                if (!valid_585035) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585033, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585038 = sub64(next_stride_585029, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585039 = sle64((int64_t) 0, m_585038);
                bool cond_585041 = slt64(next_stride_585029, (int64_t) 10);
                bool protect_assert_disj_585042 = nonzzero_578301 || cond_585041;
                bool nonzzero_cert_585043;
                
                if (!protect_assert_disj_585042) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585044 = smod_safe64(next_stride_585029, merge_block_sizze_578179);
                bool num_blocks_585045 = zeze_lhs_585044 == (int64_t) 0;
                bool protect_assert_disj_585046 = cond_585041 || num_blocks_585045;
                bool assert_c_585047;
                
                if (!protect_assert_disj_585046) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585048 = sdiv_safe64(next_stride_585029, merge_block_sizze_578179);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049 = add64((int64_t) 1, num_blocks_585048);
                int64_t j_m_i_585050 = sub64(next_stride_585029, stride_585028);
                int64_t flat_dim_585051 = merge_block_sizze_578179 * num_blocks_585048;
                bool bounds_invalid_upwards_585052 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, (int64_t) 0);
                bool empty_slice_585053 = j_m_i_585050 == (int64_t) 0;
                int64_t m_585054 = sub64(j_m_i_585050, (int64_t) 1);
                bool zzero_lte_i_585055 = sle64((int64_t) 0, stride_585028);
                bool i_lte_j_585056 = sle64(stride_585028, next_stride_585029);
                bool empty_slice_585057 = stride_585028 == (int64_t) 0;
                int64_t m_585058 = sub64(stride_585028, (int64_t) 1);
                bool bounds_invalid_upwards_585059 = slt64(num_blocks_585048, (int64_t) 0);
                bool cond_585060 = slt64((int64_t) 0, stride_585028);
                bool valid_585061 = !bounds_invalid_upwards_585052;
                int64_t i_p_m_t_s_585062 = add64(stride_585028, m_585054);
                bool zzero_leq_i_p_m_t_s_585063 = sle64((int64_t) 0, m_585058);
                bool i_p_m_t_s_leq_w_585064 = slt64(m_585058, next_stride_585029);
                bool valid_585065 = !bounds_invalid_upwards_585059;
                bool i_p_m_t_s_leq_w_585066 = slt64(m_585038, flat_dim_585051);
                bool y_585067 = slt64((int64_t) 0, j_m_i_585050);
                bool protect_assert_disj_585068 = cond_585041 || valid_585061;
                bool range_valid_c_585069;
                
                if (!protect_assert_disj_585068) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585070 = sle64((int64_t) 0, i_p_m_t_s_585062);
                bool i_p_m_t_s_leq_w_585071 = slt64(i_p_m_t_s_585062, next_stride_585029);
                bool y_585072 = zzero_leq_i_p_m_t_s_585063 && i_p_m_t_s_leq_w_585064;
                bool protect_assert_disj_585073 = cond_585041 || valid_585065;
                bool range_valid_c_585074;
                
                if (!protect_assert_disj_585073) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585048, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585075 = zzero_leq_i_p_m_t_s_585039 && i_p_m_t_s_leq_w_585066;
                bool y_585076 = zzero_lte_i_585055 && i_p_m_t_s_leq_w_585071;
                bool forwards_ok_585077 = zzero_lte_i_585055 && y_585072;
                bool ok_or_empty_585078 = zzero_585030 || y_585075;
                bool protect_assert_disj_585079 = cond_585060 || y_585067;
                bool y_585080 = zzero_leq_i_p_m_t_s_585070 && y_585076;
                bool ok_or_empty_585081 = empty_slice_585057 || forwards_ok_585077;
                bool protect_assert_disj_585082 = cond_585041 || ok_or_empty_585078;
                bool index_certs_585083;
                
                if (!protect_assert_disj_585082) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585029, "] out of bounds for array of shape [", (long long) flat_dim_585051, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585084 = !cond_585041;
                bool protect_assert_disj_585085 = protect_assert_disj_585079 || loop_not_taken_585084;
                bool index_certs_585086;
                
                if (!protect_assert_disj_585085) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585087 = i_lte_j_585056 && y_585080;
                bool protect_assert_disj_585088 = cond_585041 || ok_or_empty_585081;
                bool index_certs_585089;
                
                if (!protect_assert_disj_585088) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585028, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585090 = ok_or_empty_585081 || loop_not_taken_585084;
                bool index_certs_585091;
                
                if (!protect_assert_disj_585090) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585028, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585092 = empty_slice_585053 || forwards_ok_585087;
                bool protect_assert_disj_585093 = cond_585041 || ok_or_empty_585092;
                bool index_certs_585094;
                
                if (!protect_assert_disj_585093) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585028, ":] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585095 = loop_not_taken_585084 || ok_or_empty_585092;
                bool index_certs_585096;
                
                if (!protect_assert_disj_585095) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585028, ":] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587179 = (int64_t) 8 * num_merges_585033;
                int64_t bytes_587180 = next_stride_585029 * binop_x_587179;
                int64_t bytes_587184 = dim_251930 * bytes_587180;
                bool i_lte_j_585040 = sle64((int64_t) 0, next_stride_585029);
                
                if (mem_587181_cached_sizze_589035 < bytes_587180) {
                    err = lexical_realloc(ctx, &mem_587181, &mem_587181_cached_sizze_589035, bytes_587180);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587185_cached_sizze_589036 < bytes_587184) {
                    err = lexical_realloc(ctx, &mem_587185, &mem_587185_cached_sizze_589036, bytes_587184);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587188_cached_sizze_589037 < bytes_587180) {
                    err = lexical_realloc(ctx, &mem_587188, &mem_587188_cached_sizze_589037, bytes_587180);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587202 = dim_251930 * next_stride_585029;
                int64_t bytes_587203 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049;
                int64_t binop_x_587219 = (int64_t) 8 * num_blocks_585048;
                int64_t bytes_587220 = merge_block_sizze_578179 * binop_x_587219;
                int64_t bytes_587224 = dim_251930 * bytes_587220;
                int64_t bytes_587311 = (int64_t) 16 * stride_585028;
                int64_t bytes_587316 = dim_251930 * bytes_587311;
                
                for (int64_t i_586123 = 0; i_586123 < num_merges_585033; i_586123++) {
                    int64_t start_585101 = mul64(next_stride_585029, i_586123);
                    int64_t j_m_i_585102 = sub64(loop_dz2084Uz2082U_585023, start_585101);
                    bool empty_slice_585103 = j_m_i_585102 == (int64_t) 0;
                    int64_t m_585104 = sub64(j_m_i_585102, (int64_t) 1);
                    int64_t i_p_m_t_s_585105 = add64(start_585101, m_585104);
                    bool zzero_leq_i_p_m_t_s_585106 = sle64((int64_t) 0, i_p_m_t_s_585105);
                    bool i_p_m_t_s_leq_w_585107 = slt64(i_p_m_t_s_585105, loop_dz2084Uz2082U_585023);
                    bool zzero_lte_i_585108 = sle64((int64_t) 0, start_585101);
                    bool i_lte_j_585109 = sle64(start_585101, loop_dz2084Uz2082U_585023);
                    bool y_585110 = i_p_m_t_s_leq_w_585107 && zzero_lte_i_585108;
                    bool y_585111 = zzero_leq_i_p_m_t_s_585106 && y_585110;
                    bool forwards_ok_585112 = i_lte_j_585109 && y_585111;
                    bool ok_or_empty_585113 = empty_slice_585103 || forwards_ok_585112;
                    bool index_certs_585114;
                    
                    if (!ok_or_empty_585113) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585101, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585023, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585115 = slt64(m_585038, j_m_i_585102);
                    bool y_585116 = zzero_leq_i_p_m_t_s_585039 && i_p_m_t_s_leq_w_585115;
                    bool forwards_ok_585117 = i_lte_j_585040 && y_585116;
                    bool ok_or_empty_585118 = zzero_585030 || forwards_ok_585117;
                    bool index_certs_585119;
                    
                    if (!ok_or_empty_585118) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585029, "] out of bounds for array of shape [", (long long) j_m_i_585102, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:790:33-56\n   #7  ftSkyline.fut:779:17-790:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585129 = stride_585028 + start_585101;
                    int64_t binop_y_587306 = dim_251930 * slice_585129;
                    int64_t binop_y_587308 = dim_251930 * start_585101;
                    int64_t ext_587310;
                    
                    if (cond_585060) {
                        ext_587310 = binop_y_587308;
                    } else {
                        ext_587310 = binop_y_587306;
                    }
                    if (cond_585041) {
                        int64_t dummy_585123;
                        int64_t dummy_585125;
                        
                        if (cond_585060) {
                            int64_t head_res_585126 = ((int64_t *) mem_param_587171.mem)[start_585101];
                            int64_t head_res_585128 = ((int64_t *) mem_param_587178.mem)[start_585101];
                            
                            dummy_585123 = head_res_585126;
                            dummy_585125 = head_res_585128;
                        } else {
                            int64_t head_res_585130 = ((int64_t *) mem_param_587171.mem)[slice_585129];
                            int64_t head_res_585132 = ((int64_t *) mem_param_587178.mem)[slice_585129];
                            
                            dummy_585123 = head_res_585130;
                            dummy_585125 = head_res_585132;
                        }
                        if (memblock_alloc(ctx, &mem_587312, bytes_587311, "mem_587312")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588061 = 0; nest_i_588061 < next_stride_585029; nest_i_588061++) {
                            ((int64_t *) mem_587312.mem)[nest_i_588061] = dummy_585123;
                        }
                        if (memblock_alloc(ctx, &mem_587314, bytes_587311, "mem_587314")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588062 = 0; nest_i_588062 < next_stride_585029; nest_i_588062++) {
                            ((int64_t *) mem_587314.mem)[nest_i_588062] = dummy_585125;
                        }
                        if (memblock_alloc(ctx, &mem_587317, bytes_587316, "mem_587317")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588063 = 0; nest_i_588063 < next_stride_585029; nest_i_588063++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587317.mem, nest_i_588063 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587175.mem, ext_587310, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                        }
                        
                        int64_t data_585136;
                        int64_t i_585141 = (int64_t) 0;
                        
                        for (int64_t k_585140 = 0; k_585140 < next_stride_585029; k_585140++) {
                            int64_t j_585145 = sub64(k_585140, i_585141);
                            bool cond_585146 = j_585145 == j_m_i_585050;
                            bool x_587779 = !cond_585146;
                            bool cond_585148 = slt64(i_585141, stride_585028);
                            bool x_585150 = sle64((int64_t) 0, j_585145);
                            bool y_585151 = slt64(j_585145, j_m_i_585050);
                            bool bounds_check_585152 = x_585150 && y_585151;
                            bool loop_not_taken_587771 = !cond_585148;
                            bool protect_assert_disj_587772 = bounds_check_585152 || loop_not_taken_587771;
                            bool protect_assert_disj_587782 = cond_585146 || protect_assert_disj_587772;
                            bool index_certs_585153;
                            
                            if (!protect_assert_disj_587782) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585145, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585154 = stride_585028 + j_585145;
                            int64_t slice_585155 = start_585101 + slice_585154;
                            bool protect_cond_conj_587783 = cond_585148 && x_587779;
                            int64_t leq_arg1_585156;
                            
                            if (protect_cond_conj_587783) {
                                int64_t x_587773 = ((int64_t *) mem_param_587171.mem)[slice_585155];
                                
                                leq_arg1_585156 = x_587773;
                            } else {
                                leq_arg1_585156 = (int64_t) 0;
                            }
                            
                            bool x_585157 = sle64((int64_t) 0, i_585141);
                            bool bounds_check_585158 = cond_585148 && x_585157;
                            bool protect_assert_disj_587776 = bounds_check_585158 || loop_not_taken_587771;
                            bool protect_assert_disj_587785 = cond_585146 || protect_assert_disj_587776;
                            bool index_certs_585159;
                            
                            if (!protect_assert_disj_587785) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585141, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585160 = start_585101 + i_585141;
                            int64_t leq_arg0_585161;
                            
                            if (protect_cond_conj_587783) {
                                int64_t x_587777 = ((int64_t *) mem_param_587171.mem)[slice_585160];
                                
                                leq_arg0_585161 = x_587777;
                            } else {
                                leq_arg0_585161 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585162 = sle64(leq_arg0_585161, leq_arg1_585156);
                            bool x_587859 = cond_585148 && lifted_lambda_res_585162;
                            bool cond_585147 = cond_585146 || x_587859;
                            bool protect_assert_disj_587695 = cond_585147 || bounds_check_585152;
                            bool index_certs_585179;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585145, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585170 = cond_585148 && x_585157;
                            bool loop_not_taken_587690 = !cond_585147;
                            bool protect_assert_disj_587691 = bounds_check_585170 || loop_not_taken_587690;
                            bool index_certs_585171;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585141, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585181 = start_585101 + slice_585154;
                            int64_t binop_y_587328 = dim_251930 * slice_585181;
                            int64_t binop_y_587330 = dim_251930 * slice_585160;
                            int64_t ext_587332;
                            
                            if (cond_585147) {
                                ext_587332 = binop_y_587330;
                            } else {
                                ext_587332 = binop_y_587328;
                            }
                            
                            int64_t loopres_585163;
                            int64_t loopres_585164;
                            int64_t loopres_585166;
                            
                            if (cond_585147) {
                                int64_t tmp_585167 = add64((int64_t) 1, i_585141);
                                int64_t tmp_585173 = ((int64_t *) mem_param_587171.mem)[slice_585160];
                                int64_t tmp_585175 = ((int64_t *) mem_param_587178.mem)[slice_585160];
                                
                                loopres_585163 = tmp_585167;
                                loopres_585164 = tmp_585173;
                                loopres_585166 = tmp_585175;
                            } else {
                                int64_t tmp_585182 = ((int64_t *) mem_param_587171.mem)[slice_585181];
                                int64_t tmp_585184 = ((int64_t *) mem_param_587178.mem)[slice_585181];
                                
                                loopres_585163 = i_585141;
                                loopres_585164 = tmp_585182;
                                loopres_585166 = tmp_585184;
                            }
                            ((int64_t *) mem_587312.mem)[k_585140] = loopres_585164;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587317.mem, k_585140 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587175.mem, ext_587332, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_587314.mem)[k_585140] = loopres_585166;
                            
                            int64_t i_tmp_588064 = loopres_585163;
                            
                            i_585141 = i_tmp_588064;
                        }
                        data_585136 = i_585141;
                        if (memblock_set(ctx, &ext_mem_587352, &mem_587312, "mem_587312") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587349, &mem_587317, "mem_587317") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587345, &mem_587314, "mem_587314") != 0)
                            return 1;
                    } else {
                        if (mem_587204_cached_sizze_589038 < bytes_587203) {
                            err = lexical_realloc(ctx, &mem_587204, &mem_587204_cached_sizze_589038, bytes_587203);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587206_cached_sizze_589039 < bytes_587203) {
                            err = lexical_realloc(ctx, &mem_587206, &mem_587206_cached_sizze_589039, bytes_587203);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586104 = 0; i_586104 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049; i_586104++) {
                            int64_t split_count_arg3_585192 = mul64(merge_block_sizze_578179, i_586104);
                            int64_t defunc_0_split_count_res_585193;
                            int64_t defunc_0_split_count_res_585194;
                            int64_t defunc_0_split_count_res_585195;
                            int64_t defunc_0_split_count_res_585196;
                            int64_t defunc_0_split_count_res_585197;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585193, &defunc_0_split_count_res_585194, &defunc_0_split_count_res_585195, &defunc_0_split_count_res_585196, &defunc_0_split_count_res_585197, (int64_t) 0, stride_585028, (int64_t) 0, j_m_i_585050, split_count_arg3_585192) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585198 = slt64((int64_t) 0, defunc_0_split_count_res_585197);
                            bool defunc_0_split_count_res_585199;
                            int64_t defunc_0_split_count_res_585200;
                            int64_t defunc_0_split_count_res_585201;
                            int64_t defunc_0_split_count_res_585202;
                            int64_t defunc_0_split_count_res_585203;
                            int64_t defunc_0_split_count_res_585204;
                            bool loop_while_585205;
                            int64_t ss_585206;
                            int64_t ss_585207;
                            int64_t tt_585208;
                            int64_t tt_585209;
                            int64_t count_585210;
                            
                            loop_while_585205 = loop_cond_585198;
                            ss_585206 = defunc_0_split_count_res_585193;
                            ss_585207 = defunc_0_split_count_res_585194;
                            tt_585208 = defunc_0_split_count_res_585195;
                            tt_585209 = defunc_0_split_count_res_585196;
                            count_585210 = defunc_0_split_count_res_585197;
                            while (loop_while_585205) {
                                int64_t zlze_lhs_585211 = sub64(ss_585207, ss_585206);
                                bool cond_585212 = sle64(zlze_lhs_585211, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585213;
                                int64_t defunc_0_lifted_step_res_585214;
                                int64_t defunc_0_lifted_step_res_585215;
                                int64_t defunc_0_lifted_step_res_585216;
                                
                                if (cond_585212) {
                                    int64_t tmp_585217 = add64(tt_585208, count_585210);
                                    
                                    defunc_0_lifted_step_res_585213 = ss_585206;
                                    defunc_0_lifted_step_res_585214 = tmp_585217;
                                    defunc_0_lifted_step_res_585215 = tt_585209;
                                    defunc_0_lifted_step_res_585216 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585218 = sub64(tt_585209, tt_585208);
                                    bool cond_585219 = sle64(zlze_lhs_585218, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585220;
                                    int64_t defunc_0_lifted_step_res_f_res_585221;
                                    int64_t defunc_0_lifted_step_res_f_res_585222;
                                    int64_t defunc_0_lifted_step_res_f_res_585223;
                                    
                                    if (cond_585219) {
                                        int64_t tmp_585224 = add64(ss_585206, count_585210);
                                        
                                        defunc_0_lifted_step_res_f_res_585220 = tmp_585224;
                                        defunc_0_lifted_step_res_f_res_585221 = tt_585208;
                                        defunc_0_lifted_step_res_f_res_585222 = tt_585209;
                                        defunc_0_lifted_step_res_f_res_585223 = (int64_t) 0;
                                    } else {
                                        bool cond_585225 = count_585210 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585226;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585227;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585228;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585229;
                                        
                                        if (cond_585225) {
                                            bool x_585230 = sle64((int64_t) 0, ss_585206);
                                            bool y_585231 = slt64(ss_585206, stride_585028);
                                            bool bounds_check_585232 = x_585230 && y_585231;
                                            bool index_certs_585233;
                                            
                                            if (!bounds_check_585232) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585206, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:790:33-56\n   #12 ftSkyline.fut:779:17-790:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585236 = sle64((int64_t) 0, tt_585208);
                                            bool y_585237 = slt64(tt_585208, j_m_i_585050);
                                            bool bounds_check_585238 = x_585236 && y_585237;
                                            bool index_certs_585239;
                                            
                                            if (!bounds_check_585238) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585208, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:790:33-56\n   #12 ftSkyline.fut:779:17-790:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585234 = start_585101 + ss_585206;
                                            int64_t leq_arg1_585235 = ((int64_t *) mem_param_587171.mem)[slice_585234];
                                            int64_t slice_585240 = stride_585028 + tt_585208;
                                            int64_t slice_585241 = start_585101 + slice_585240;
                                            int64_t leq_arg0_585242 = ((int64_t *) mem_param_587171.mem)[slice_585241];
                                            bool lifted_lambda_res_585243 = sle64(leq_arg0_585242, leq_arg1_585235);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585244;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585245;
                                            
                                            if (lifted_lambda_res_585243) {
                                                int64_t tmp_585246 = add64((int64_t) 1, tt_585208);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585244 = ss_585206;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585245 = tmp_585246;
                                            } else {
                                                int64_t tmp_585247 = add64((int64_t) 1, ss_585206);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585244 = tmp_585247;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585245 = tt_585208;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585226 = defunc_0_lifted_step_res_f_res_f_res_t_res_585244;
                                            defunc_0_lifted_step_res_f_res_f_res_585227 = defunc_0_lifted_step_res_f_res_f_res_t_res_585245;
                                            defunc_0_lifted_step_res_f_res_f_res_585228 = tt_585209;
                                            defunc_0_lifted_step_res_f_res_f_res_585229 = (int64_t) 0;
                                        } else {
                                            int64_t m_585248 = sdiv64(count_585210, (int64_t) 2);
                                            int64_t n_585249 = sub64(count_585210, m_585248);
                                            bool cond_585250 = n_585249 == (int64_t) 0;
                                            int64_t zgze_lhs_585251 = add64(ss_585206, m_585248);
                                            bool cond_f_res_585252 = sle64(ss_585207, zgze_lhs_585251);
                                            bool x_585253 = !cond_585250;
                                            bool y_585254 = cond_f_res_585252 && x_585253;
                                            bool cond_585255 = cond_585250 || y_585254;
                                            bool leq_y_x_585256;
                                            
                                            if (cond_585255) {
                                                leq_y_x_585256 = 1;
                                            } else {
                                                bool x_585257 = sle64((int64_t) 0, zgze_lhs_585251);
                                                bool y_585258 = slt64(zgze_lhs_585251, stride_585028);
                                                bool bounds_check_585259 = x_585257 && y_585258;
                                                bool index_certs_585260;
                                                
                                                if (!bounds_check_585259) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585251, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:790:33-56\n   #12 ftSkyline.fut:779:17-790:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585263 = add64(tt_585208, n_585249);
                                                int64_t leq_arg0_585264 = sub64(zm_lhs_585263, (int64_t) 1);
                                                bool x_585265 = sle64((int64_t) 0, leq_arg0_585264);
                                                bool y_585266 = slt64(leq_arg0_585264, j_m_i_585050);
                                                bool bounds_check_585267 = x_585265 && y_585266;
                                                bool index_certs_585268;
                                                
                                                if (!bounds_check_585267) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585264, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:790:33-56\n   #12 ftSkyline.fut:779:17-790:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585261 = start_585101 + zgze_lhs_585251;
                                                int64_t leq_arg1_585262 = ((int64_t *) mem_param_587171.mem)[slice_585261];
                                                int64_t slice_585269 = stride_585028 + leq_arg0_585264;
                                                int64_t slice_585270 = start_585101 + slice_585269;
                                                int64_t leq_arg0_585271 = ((int64_t *) mem_param_587171.mem)[slice_585270];
                                                bool lifted_lambda_res_585272 = sle64(leq_arg0_585271, leq_arg1_585262);
                                                
                                                leq_y_x_585256 = lifted_lambda_res_585272;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585273;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585274;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585275;
                                            
                                            if (leq_y_x_585256) {
                                                int64_t tmp_585276 = add64(tt_585208, n_585249);
                                                int64_t tmp_585277 = sub64(count_585210, n_585249);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585273 = tmp_585276;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585274 = tt_585209;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585275 = tmp_585277;
                                            } else {
                                                int64_t tmp_585278 = add64(tt_585208, n_585249);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585273 = tt_585208;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585274 = tmp_585278;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585275 = count_585210;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585226 = ss_585206;
                                            defunc_0_lifted_step_res_f_res_f_res_585227 = defunc_0_lifted_step_res_f_res_f_res_f_res_585273;
                                            defunc_0_lifted_step_res_f_res_f_res_585228 = defunc_0_lifted_step_res_f_res_f_res_f_res_585274;
                                            defunc_0_lifted_step_res_f_res_f_res_585229 = defunc_0_lifted_step_res_f_res_f_res_f_res_585275;
                                        }
                                        defunc_0_lifted_step_res_f_res_585220 = defunc_0_lifted_step_res_f_res_f_res_585226;
                                        defunc_0_lifted_step_res_f_res_585221 = defunc_0_lifted_step_res_f_res_f_res_585227;
                                        defunc_0_lifted_step_res_f_res_585222 = defunc_0_lifted_step_res_f_res_f_res_585228;
                                        defunc_0_lifted_step_res_f_res_585223 = defunc_0_lifted_step_res_f_res_f_res_585229;
                                    }
                                    defunc_0_lifted_step_res_585213 = defunc_0_lifted_step_res_f_res_585220;
                                    defunc_0_lifted_step_res_585214 = defunc_0_lifted_step_res_f_res_585221;
                                    defunc_0_lifted_step_res_585215 = defunc_0_lifted_step_res_f_res_585222;
                                    defunc_0_lifted_step_res_585216 = defunc_0_lifted_step_res_f_res_585223;
                                }
                                
                                int64_t loopres_585279;
                                int64_t loopres_585280;
                                int64_t loopres_585281;
                                int64_t loopres_585282;
                                int64_t loopres_585283;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585279, &loopres_585280, &loopres_585281, &loopres_585282, &loopres_585283, defunc_0_lifted_step_res_585213, ss_585207, defunc_0_lifted_step_res_585214, defunc_0_lifted_step_res_585215, defunc_0_lifted_step_res_585216) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585284 = slt64((int64_t) 0, loopres_585283);
                                bool loop_while_tmp_588070 = loop_cond_585284;
                                int64_t ss_tmp_588071 = loopres_585279;
                                int64_t ss_tmp_588072 = loopres_585280;
                                int64_t tt_tmp_588073 = loopres_585281;
                                int64_t tt_tmp_588074 = loopres_585282;
                                int64_t count_tmp_588075 = loopres_585283;
                                
                                loop_while_585205 = loop_while_tmp_588070;
                                ss_585206 = ss_tmp_588071;
                                ss_585207 = ss_tmp_588072;
                                tt_585208 = tt_tmp_588073;
                                tt_585209 = tt_tmp_588074;
                                count_585210 = count_tmp_588075;
                            }
                            defunc_0_split_count_res_585199 = loop_while_585205;
                            defunc_0_split_count_res_585200 = ss_585206;
                            defunc_0_split_count_res_585201 = ss_585207;
                            defunc_0_split_count_res_585202 = tt_585208;
                            defunc_0_split_count_res_585203 = tt_585209;
                            defunc_0_split_count_res_585204 = count_585210;
                            ((int64_t *) mem_587204)[i_586104] = defunc_0_split_count_res_585200;
                            ((int64_t *) mem_587206)[i_586104] = defunc_0_split_count_res_585202;
                        }
                        if (mem_587221_cached_sizze_589040 < bytes_587220) {
                            err = lexical_realloc(ctx, &mem_587221, &mem_587221_cached_sizze_589040, bytes_587220);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587225_cached_sizze_589041 < bytes_587224) {
                            err = lexical_realloc(ctx, &mem_587225, &mem_587225_cached_sizze_589041, bytes_587224);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587228_cached_sizze_589042 < bytes_587220) {
                            err = lexical_realloc(ctx, &mem_587228, &mem_587228_cached_sizze_589042, bytes_587220);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586113 = 0; i_586113 < num_blocks_585048; i_586113++) {
                            bool y_585293 = slt64(i_586113, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049);
                            bool index_certs_585295;
                            
                            if (!y_585293) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586113, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585296 = ((int64_t *) mem_587204)[i_586113];
                            int64_t defunc_0_f_res_585297 = ((int64_t *) mem_587206)[i_586113];
                            int64_t tmp_585298 = add64((int64_t) 1, i_586113);
                            bool x_585299 = sle64((int64_t) 0, tmp_585298);
                            bool y_585300 = slt64(tmp_585298, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049);
                            bool bounds_check_585301 = x_585299 && y_585300;
                            bool index_certs_585302;
                            
                            if (!bounds_check_585301) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585298, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585303 = ((int64_t *) mem_587204)[tmp_585298];
                            int64_t defunc_0_f_res_585304 = ((int64_t *) mem_587206)[tmp_585298];
                            int64_t merge_sequential_arg2_585305 = add64(stride_585028, defunc_0_f_res_585297);
                            int64_t merge_sequential_arg2_585306 = add64(stride_585028, defunc_0_f_res_585304);
                            int64_t j_m_i_585307 = sub64(merge_sequential_arg2_585306, merge_sequential_arg2_585305);
                            bool empty_slice_585308 = j_m_i_585307 == (int64_t) 0;
                            int64_t m_585309 = sub64(j_m_i_585307, (int64_t) 1);
                            int64_t i_p_m_t_s_585310 = add64(merge_sequential_arg2_585305, m_585309);
                            bool zzero_leq_i_p_m_t_s_585311 = sle64((int64_t) 0, i_p_m_t_s_585310);
                            bool i_p_m_t_s_leq_w_585312 = slt64(i_p_m_t_s_585310, next_stride_585029);
                            bool zzero_lte_i_585313 = sle64((int64_t) 0, merge_sequential_arg2_585305);
                            bool i_lte_j_585314 = sle64(merge_sequential_arg2_585305, merge_sequential_arg2_585306);
                            bool y_585315 = i_p_m_t_s_leq_w_585312 && zzero_lte_i_585313;
                            bool y_585316 = zzero_leq_i_p_m_t_s_585311 && y_585315;
                            bool forwards_ok_585317 = i_lte_j_585314 && y_585316;
                            bool ok_or_empty_585318 = empty_slice_585308 || forwards_ok_585317;
                            bool index_certs_585319;
                            
                            if (!ok_or_empty_585318) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585305, ":", (long long) merge_sequential_arg2_585306, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585320 = sub64(defunc_0_f_res_585303, defunc_0_f_res_585296);
                            bool empty_slice_585321 = j_m_i_585320 == (int64_t) 0;
                            int64_t m_585322 = sub64(j_m_i_585320, (int64_t) 1);
                            int64_t i_p_m_t_s_585323 = add64(defunc_0_f_res_585296, m_585322);
                            bool zzero_leq_i_p_m_t_s_585324 = sle64((int64_t) 0, i_p_m_t_s_585323);
                            bool i_p_m_t_s_leq_w_585325 = slt64(i_p_m_t_s_585323, next_stride_585029);
                            bool zzero_lte_i_585326 = sle64((int64_t) 0, defunc_0_f_res_585296);
                            bool i_lte_j_585327 = sle64(defunc_0_f_res_585296, defunc_0_f_res_585303);
                            bool y_585328 = i_p_m_t_s_leq_w_585325 && zzero_lte_i_585326;
                            bool y_585329 = zzero_leq_i_p_m_t_s_585324 && y_585328;
                            bool forwards_ok_585330 = i_lte_j_585327 && y_585329;
                            bool ok_or_empty_585331 = empty_slice_585321 || forwards_ok_585330;
                            bool index_certs_585332;
                            
                            if (!ok_or_empty_585331) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585296, ":", (long long) defunc_0_f_res_585303, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585333 = slt64((int64_t) 0, j_m_i_585320);
                            bool y_585342 = slt64((int64_t) 0, j_m_i_585307);
                            bool protect_assert_disj_587711 = cond_585333 || y_585342;
                            bool index_certs_585343;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585344 = start_585101 + merge_sequential_arg2_585305;
                            int64_t binop_y_587243 = dim_251930 * slice_585344;
                            int64_t slice_585338 = start_585101 + defunc_0_f_res_585296;
                            int64_t binop_y_587245 = dim_251930 * slice_585338;
                            int64_t ext_587247;
                            
                            if (cond_585333) {
                                ext_587247 = binop_y_587245;
                            } else {
                                ext_587247 = binop_y_587243;
                            }
                            
                            int64_t dummy_585334;
                            int64_t dummy_585336;
                            
                            if (cond_585333) {
                                int64_t head_res_585339 = ((int64_t *) mem_param_587171.mem)[slice_585338];
                                int64_t head_res_585341 = ((int64_t *) mem_param_587178.mem)[slice_585338];
                                
                                dummy_585334 = head_res_585339;
                                dummy_585336 = head_res_585341;
                            } else {
                                int64_t head_res_585345 = ((int64_t *) mem_param_587171.mem)[slice_585344];
                                int64_t head_res_585347 = ((int64_t *) mem_param_587178.mem)[slice_585344];
                                
                                dummy_585334 = head_res_585345;
                                dummy_585336 = head_res_585347;
                            }
                            for (int64_t nest_i_588079 = 0; nest_i_588079 < merge_block_sizze_578179; nest_i_588079++) {
                                ((int64_t *) mem_587221)[i_586113 * merge_block_sizze_578179 + nest_i_588079] = dummy_585334;
                            }
                            for (int64_t nest_i_588080 = 0; nest_i_588080 < merge_block_sizze_578179; nest_i_588080++) {
                                ((int64_t *) mem_587228)[i_586113 * merge_block_sizze_578179 + nest_i_588080] = dummy_585336;
                            }
                            for (int64_t nest_i_588081 = 0; nest_i_588081 < merge_block_sizze_578179; nest_i_588081++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587225, i_586113 * lmad_arg_587242 + nest_i_588081 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587175.mem, ext_587247, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            }
                            
                            int64_t data_585351;
                            int64_t i_585356 = (int64_t) 0;
                            
                            for (int64_t k_585355 = 0; k_585355 < merge_block_sizze_578179; k_585355++) {
                                int64_t j_585360 = sub64(k_585355, i_585356);
                                bool cond_585361 = j_585360 == j_m_i_585307;
                                bool x_587797 = !cond_585361;
                                bool cond_585363 = slt64(i_585356, j_m_i_585320);
                                bool x_585365 = sle64((int64_t) 0, j_585360);
                                bool y_585366 = slt64(j_585360, j_m_i_585307);
                                bool bounds_check_585367 = x_585365 && y_585366;
                                bool loop_not_taken_587789 = !cond_585363;
                                bool protect_assert_disj_587790 = bounds_check_585367 || loop_not_taken_587789;
                                bool protect_assert_disj_587800 = cond_585361 || protect_assert_disj_587790;
                                bool index_certs_585368;
                                
                                if (!protect_assert_disj_587800) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585360, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585369 = merge_sequential_arg2_585305 + j_585360;
                                int64_t slice_585370 = start_585101 + slice_585369;
                                bool protect_cond_conj_587801 = cond_585363 && x_587797;
                                int64_t leq_arg1_585371;
                                
                                if (protect_cond_conj_587801) {
                                    int64_t x_587791 = ((int64_t *) mem_param_587171.mem)[slice_585370];
                                    
                                    leq_arg1_585371 = x_587791;
                                } else {
                                    leq_arg1_585371 = (int64_t) 0;
                                }
                                
                                bool x_585372 = sle64((int64_t) 0, i_585356);
                                bool bounds_check_585373 = cond_585363 && x_585372;
                                bool protect_assert_disj_587794 = bounds_check_585373 || loop_not_taken_587789;
                                bool protect_assert_disj_587803 = cond_585361 || protect_assert_disj_587794;
                                bool index_certs_585374;
                                
                                if (!protect_assert_disj_587803) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585356, "] out of bounds for array of shape [", (long long) j_m_i_585320, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585375 = defunc_0_f_res_585296 + i_585356;
                                int64_t slice_585376 = start_585101 + slice_585375;
                                int64_t leq_arg0_585377;
                                
                                if (protect_cond_conj_587801) {
                                    int64_t x_587795 = ((int64_t *) mem_param_587171.mem)[slice_585376];
                                    
                                    leq_arg0_585377 = x_587795;
                                } else {
                                    leq_arg0_585377 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585378 = sle64(leq_arg0_585377, leq_arg1_585371);
                                bool x_587862 = cond_585363 && lifted_lambda_res_585378;
                                bool cond_585362 = cond_585361 || x_587862;
                                bool protect_assert_disj_587703 = cond_585362 || bounds_check_585367;
                                bool index_certs_585396;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585360, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585386 = cond_585363 && x_585372;
                                bool loop_not_taken_587698 = !cond_585362;
                                bool protect_assert_disj_587699 = bounds_check_585386 || loop_not_taken_587698;
                                bool index_certs_585387;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585356, "] out of bounds for array of shape [", (long long) j_m_i_585320, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585398 = start_585101 + slice_585369;
                                int64_t binop_y_587265 = dim_251930 * slice_585398;
                                int64_t slice_585389 = start_585101 + slice_585375;
                                int64_t binop_y_587267 = dim_251930 * slice_585389;
                                int64_t ext_587269;
                                
                                if (cond_585362) {
                                    ext_587269 = binop_y_587267;
                                } else {
                                    ext_587269 = binop_y_587265;
                                }
                                
                                int64_t loopres_585379;
                                int64_t loopres_585380;
                                int64_t loopres_585382;
                                
                                if (cond_585362) {
                                    int64_t tmp_585383 = add64((int64_t) 1, i_585356);
                                    int64_t tmp_585390 = ((int64_t *) mem_param_587171.mem)[slice_585389];
                                    int64_t tmp_585392 = ((int64_t *) mem_param_587178.mem)[slice_585389];
                                    
                                    loopres_585379 = tmp_585383;
                                    loopres_585380 = tmp_585390;
                                    loopres_585382 = tmp_585392;
                                } else {
                                    int64_t tmp_585399 = ((int64_t *) mem_param_587171.mem)[slice_585398];
                                    int64_t tmp_585401 = ((int64_t *) mem_param_587178.mem)[slice_585398];
                                    
                                    loopres_585379 = i_585356;
                                    loopres_585380 = tmp_585399;
                                    loopres_585382 = tmp_585401;
                                }
                                ((int64_t *) mem_587221)[i_586113 * merge_block_sizze_578179 + k_585355] = loopres_585380;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587225, i_586113 * lmad_arg_587242 + k_585355 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_587175.mem, ext_587269, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                                ((int64_t *) mem_587228)[i_586113 * merge_block_sizze_578179 + k_585355] = loopres_585382;
                                
                                int64_t i_tmp_588082 = loopres_585379;
                                
                                i_585356 = i_tmp_588082;
                            }
                            data_585351 = i_585356;
                        }
                        if (memblock_alloc(ctx, &mem_587295, bytes_587220, "mem_587295")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587295.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (uint64_t *) mem_587221, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179});
                        if (memblock_alloc(ctx, &mem_587300, bytes_587224, "mem_587300")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_587300.mem, (int64_t) 0, (int64_t []) {dim_251930 * merge_block_sizze_578179, dim_251930, (int64_t) 1}, (uint64_t *) mem_587225, (int64_t) 0, (int64_t []) {lmad_arg_587242, dim_251930, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179, dim_251930});
                        if (memblock_alloc(ctx, &mem_587304, bytes_587220, "mem_587304")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587304.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (uint64_t *) mem_587228, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179});
                        if (memblock_set(ctx, &ext_mem_587352, &mem_587295, "mem_587295") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587349, &mem_587300, "mem_587300") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587345, &mem_587304, "mem_587304") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587181, i_586123 * next_stride_585029, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585029});
                    if (memblock_unref(ctx, &ext_mem_587352, "ext_mem_587352") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587185, i_586123 * lmad_arg_587202, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) ext_mem_587349.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {next_stride_585029, dim_251930});
                    if (memblock_unref(ctx, &ext_mem_587349, "ext_mem_587349") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587188, i_586123 * next_stride_585029, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587345.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585029});
                    if (memblock_unref(ctx, &ext_mem_587345, "ext_mem_587345") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585423 = next_stride_585029 * num_merges_585033;
                
                if (memblock_alloc(ctx, &mem_587368, bytes_587180, "mem_587368")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587368.mem, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (uint64_t *) mem_587181, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029});
                if (memblock_alloc(ctx, &mem_587373, bytes_587184, "mem_587373")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_587373.mem, (int64_t) 0, (int64_t []) {dim_251930 * next_stride_585029, dim_251930, (int64_t) 1}, (uint64_t *) mem_587185, (int64_t) 0, (int64_t []) {lmad_arg_587202, dim_251930, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029, dim_251930});
                if (memblock_alloc(ctx, &mem_587377, bytes_587180, "mem_587377")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587377.mem, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (uint64_t *) mem_587188, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029});
                
                bool loop_cond_585427 = slt64(next_stride_585029, flat_dim_578174);
                
                if (memblock_set(ctx, &mem_param_tmp_588049, &mem_587368, "mem_587368") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588050, &mem_587373, "mem_587373") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588051, &mem_587377, "mem_587377") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588052 = flat_dim_585423;
                bool loop_while_tmp_588053 = loop_cond_585427;
                int64_t stride_tmp_588057 = next_stride_585029;
                
                if (memblock_set(ctx, &mem_param_587171, &mem_param_tmp_588049, "mem_param_tmp_588049") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587175, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587178, &mem_param_tmp_588051, "mem_param_tmp_588051") != 0)
                    return 1;
                loop_dz2084Uz2082U_585023 = loop_dz2084Uz2082U_tmp_588052;
                loop_while_585024 = loop_while_tmp_588053;
                stride_585028 = stride_tmp_588057;
            }
            if (memblock_set(ctx, &ext_mem_587388, &mem_param_587171, "mem_param_587171") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587387, &mem_param_587175, "mem_param_587175") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587386, &mem_param_587178, "mem_param_587178") != 0)
                return 1;
            data_585017 = loop_dz2084Uz2082U_585023;
            data_585018 = loop_while_585024;
            data_585022 = stride_585028;
            if (memblock_unref(ctx, &mem_587158, "mem_587158") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587163, "mem_587163") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587167, "mem_587167") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585428 = slt64(zs_lhs_578851, data_585017);
            bool y_585429 = zzero_leq_i_p_m_t_s_579510 && i_p_m_t_s_leq_w_585428;
            bool ok_or_empty_585430 = empty_slice_579509 || y_585429;
            bool index_certs_585431;
            
            if (!ok_or_empty_585430) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_251933, "] out of bounds for array of shape [", (long long) data_585017, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587395, &ext_mem_587387, "ext_mem_587387") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587391, &ext_mem_587386, "ext_mem_587386") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587397, bytes_586418, "mem_587397")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587397.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_251933});
        if (memblock_unref(ctx, &ext_mem_587391, "ext_mem_587391") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587400, bytes_586966, "mem_587400")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587400.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) ext_mem_587395.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {n_251933, dim_251930});
        if (memblock_unref(ctx, &ext_mem_587395, "ext_mem_587395") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587402, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587401, &mem_587397, "mem_587397") != 0)
            return 1;
    } else {
        if (mem_586427_cached_sizze_588991 < bytes_586426) {
            err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_588991, bytes_586426);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586129 = 0; i_586129 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932; i_586129++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_578814 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586129];
            double i64_res_578815 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_578814);
            double defunc_0_fover_res_578816 = 1.5707963267948966 / i64_res_578815;
            
            ((double *) mem_586427)[i_586129] = defunc_0_fover_res_578816;
        }
        if (mem_586435_cached_sizze_588992 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586435, &mem_586435_cached_sizze_588992, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586437_cached_sizze_588993 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586437, &mem_586437_cached_sizze_588993, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586445_cached_sizze_588994 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586445, &mem_586445_cached_sizze_588994, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586453_cached_sizze_588995 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_588995, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586455_cached_sizze_588996 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_588996, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586469_cached_sizze_588997 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_586469, &mem_586469_cached_sizze_588997, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586485_cached_sizze_588999 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_586485, &mem_586485_cached_sizze_588999, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586154 = 0; i_586154 < n_251933; i_586154++) {
            for (int64_t i_586133 = 0; i_586133 < dim_251930; i_586133++) {
                double eta_p_583813 = ((double *) xs_mem_586417.mem)[i_586154 * dim_251930 + i_586133];
                double eta_p_583814 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586133];
                double eta_p_583815 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586133];
                int64_t eta_p_583817 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586133];
                double defunc_0_f_res_583818 = eta_p_583813 - eta_p_583814;
                double defunc_0_f_res_583820 = defunc_0_f_res_583818 / eta_p_583815;
                int64_t f64_res_583822 = fptosi_f64_i64(defunc_0_f_res_583820);
                int64_t max_res_583824 = smax64((int64_t) 0, f64_res_583822);
                int64_t zm_lhs_583830 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586133];
                int64_t min_arg1_583831 = sub64(zm_lhs_583830, (int64_t) 1);
                int64_t min_res_583832 = smin64(max_res_583824, min_arg1_583831);
                int64_t defunc_0_f_res_583834 = mul64(eta_p_583817, min_res_583832);
                
                ((int64_t *) mem_586445)[i_586133] = defunc_0_f_res_583834;
            }
            
            int64_t defunc_0_foldl_res_578750;
            int64_t acc_578752 = (int64_t) 0;
            
            for (int64_t i_578751 = 0; i_578751 < dim_251930; i_578751++) {
                int64_t b_578753 = ((int64_t *) mem_586445)[i_578751];
                int64_t defunc_0_f_res_578754 = add64(acc_578752, b_578753);
                int64_t acc_tmp_588090 = defunc_0_f_res_578754;
                
                acc_578752 = acc_tmp_588090;
            }
            defunc_0_foldl_res_578750 = acc_578752;
            
            bool x_578755 = sle64((int64_t) 0, defunc_0_foldl_res_578750);
            bool y_578756 = slt64(defunc_0_foldl_res_578750, dz2080U_251931);
            bool bounds_check_578757 = x_578755 && y_578756;
            bool index_certs_578758;
            
            if (!bounds_check_578757) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_578750, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586139 = 0; i_586139 < dim_251930; i_586139++) {
                double eta_p_583742 = ((double *) xs_mem_586417.mem)[i_586154 * dim_251930 + i_586139];
                double eta_p_583743 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_578750 * dim_251930 + i_586139];
                double defunc_0_f_res_583744 = eta_p_583742 - eta_p_583743;
                double defunc_0_ftimes_res_583746 = defunc_0_f_res_583744 * defunc_0_f_res_583744;
                
                ((double *) mem_586453)[i_586139] = defunc_0_ftimes_res_583746;
                ((double *) mem_586455)[i_586139] = defunc_0_f_res_583744;
            }
            
            double defunc_0_foldl_res_578768;
            double acc_578770 = 0.0;
            
            for (int64_t i_578769 = 0; i_578769 < dim_251930; i_578769++) {
                double b_578771 = ((double *) mem_586453)[i_578769];
                double defunc_0_f_res_578772 = acc_578770 + b_578771;
                double acc_tmp_588093 = defunc_0_f_res_578772;
                
                acc_578770 = acc_tmp_588093;
            }
            defunc_0_foldl_res_578768 = acc_578770;
            
            double sqrt_res_578773 = futrts_sqrt64(defunc_0_foldl_res_578768);
            
            for (int64_t nest_i_588094 = 0; nest_i_588094 < arg_578018; nest_i_588094++) {
                ((double *) mem_586469)[nest_i_588094] = 0.0;
            }
            for (int64_t i_578776 = 0; i_578776 < arg_578018; i_578776++) {
                bool y_578778 = slt64(i_578776, dim_251930);
                bool index_certs_578779;
                
                if (!y_578778) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_578776, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_578781 = add64((int64_t) 1, i_578776);
                int64_t j_m_i_578782 = sub64(dim_251930, map_arg1_578781);
                bool empty_slice_578783 = j_m_i_578782 == (int64_t) 0;
                int64_t m_578784 = sub64(j_m_i_578782, (int64_t) 1);
                int64_t i_p_m_t_s_578785 = add64(map_arg1_578781, m_578784);
                bool zzero_leq_i_p_m_t_s_578786 = sle64((int64_t) 0, i_p_m_t_s_578785);
                bool i_p_m_t_s_leq_w_578787 = slt64(i_p_m_t_s_578785, dim_251930);
                bool zzero_lte_i_578788 = sle64((int64_t) 0, map_arg1_578781);
                bool i_lte_j_578789 = sle64(map_arg1_578781, dim_251930);
                bool y_578790 = i_p_m_t_s_leq_w_578787 && zzero_lte_i_578788;
                bool y_578791 = zzero_leq_i_p_m_t_s_578786 && y_578790;
                bool forwards_ok_578792 = i_lte_j_578789 && y_578791;
                bool ok_or_empty_578793 = empty_slice_578783 || forwards_ok_578792;
                bool index_certs_578794;
                
                if (!ok_or_empty_578793) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_578781, ":", (long long) dim_251930, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586473 = (int64_t) 8 * j_m_i_578782;
                double this_x_578780 = ((double *) mem_586455)[i_578776];
                
                if (mem_586474_cached_sizze_588998 < bytes_586473) {
                    err = lexical_realloc(ctx, &mem_586474, &mem_586474_cached_sizze_588998, bytes_586473);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586144 = 0; i_586144 < j_m_i_578782; i_586144++) {
                    int64_t slice_586398 = map_arg1_578781 + i_586144;
                    double eta_p_578797 = ((double *) mem_586455)[slice_586398];
                    double defunc_0_ftimes_res_578798 = eta_p_578797 * eta_p_578797;
                    
                    ((double *) mem_586474)[i_586144] = defunc_0_ftimes_res_578798;
                }
                
                double defunc_0_foldl_res_578799;
                double acc_578801 = 0.0;
                
                for (int64_t i_578800 = 0; i_578800 < j_m_i_578782; i_578800++) {
                    double b_578802 = ((double *) mem_586474)[i_578800];
                    double defunc_0_f_res_578803 = acc_578801 + b_578802;
                    double acc_tmp_588097 = defunc_0_f_res_578803;
                    
                    acc_578801 = acc_tmp_588097;
                }
                defunc_0_foldl_res_578799 = acc_578801;
                
                double sqrt_res_578804 = futrts_sqrt64(defunc_0_foldl_res_578799);
                double atan2_res_578805 = futrts_atan2_64(sqrt_res_578804, this_x_578780);
                
                ((double *) mem_586469)[i_578776] = atan2_res_578805;
            }
            for (int64_t i_586148 = 0; i_586148 < arg_578018; i_586148++) {
                double eta_p_578823 = ((double *) mem_586469)[i_586148];
                double eta_p_578824 = ((double *) mem_586427)[i_586148];
                int64_t eta_p_578825 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586148];
                int64_t eta_p_578826 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586148];
                double i64_res_578827 = sitofp_i64_f64(eta_p_578825);
                double defunc_0_fover_res_578828 = eta_p_578823 / eta_p_578824;
                double defunc_0_ftimes_res_578829 = i64_res_578827 * defunc_0_fover_res_578828;
                int64_t f64_res_578830 = fptosi_f64_i64(defunc_0_ftimes_res_578829);
                bool cond_578831 = slt64(f64_res_578830, (int64_t) 0);
                int64_t defunc_0_f_res_578832;
                
                if (cond_578831) {
                    defunc_0_f_res_578832 = (int64_t) 0;
                } else {
                    bool cond_578833 = sle64(eta_p_578826, f64_res_578830);
                    int64_t defunc_0_f_res_f_res_578834;
                    
                    if (cond_578833) {
                        int64_t defunc_0_f_res_f_res_t_res_585438 = sub64(eta_p_578826, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_578834 = defunc_0_f_res_f_res_t_res_585438;
                    } else {
                        defunc_0_f_res_f_res_578834 = f64_res_578830;
                    }
                    defunc_0_f_res_578832 = defunc_0_f_res_f_res_578834;
                }
                ((int64_t *) mem_586485)[i_586148] = defunc_0_f_res_578832;
            }
            
            int64_t defunc_0_foldl_res_578836;
            int64_t acc_578838 = (int64_t) 0;
            
            for (int64_t i_578837 = 0; i_578837 < arg_578018; i_578837++) {
                int64_t b_578839 = ((int64_t *) mem_586485)[i_578837];
                int64_t defunc_0_f_res_578840 = add64(acc_578838, b_578839);
                int64_t acc_tmp_588099 = defunc_0_f_res_578840;
                
                acc_578838 = acc_tmp_588099;
            }
            defunc_0_foldl_res_578836 = acc_578838;
            
            int64_t zp_lhs_578841 = mul64(total_angle_no_251940, defunc_0_foldl_res_578750);
            int64_t get_id_from_grid_angle_res_578842 = add64(defunc_0_foldl_res_578836, zp_lhs_578841);
            
            ((int64_t *) mem_586435)[i_586154] = get_id_from_grid_angle_res_578842;
            ((double *) mem_586437)[i_586154] = sqrt_res_578773;
        }
        
        int64_t reduce_arg1_578870;
        
        if (x_578850) {
            int64_t x_585444 = ((int64_t *) mem_586435)[(int64_t) 0];
            
            reduce_arg1_578870 = x_585444;
        } else {
            reduce_arg1_578870 = (int64_t) 0;
        }
        
        double reduce_arg1_578872;
        
        if (x_578850) {
            double x_585445 = ((double *) mem_586437)[(int64_t) 0];
            
            reduce_arg1_578872 = x_585445;
        } else {
            reduce_arg1_578872 = 0.0;
        }
        if (cond_578849) {
            if (memblock_set(ctx, &ext_mem_586962, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586958, &mem_586419, "mem_586419") != 0)
                return 1;
        } else {
            int64_t ext_586506;
            int64_t defunc_0_reduce_res_585670;
            double defunc_0_reduce_res_585671;
            int64_t defunc_0_reduce_res_585673;
            int64_t redout_586157;
            double redout_586158;
            int64_t redout_586160;
            int64_t ctx_param_ext_586498;
            
            if (memblock_set(ctx, &mem_param_586500, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            ctx_param_ext_586498 = (int64_t) 0;
            redout_586157 = reduce_arg1_578870;
            redout_586158 = reduce_arg1_578872;
            redout_586160 = offset_251944;
            for (int64_t i_586161 = 0; i_586161 < n_251933; i_586161++) {
                int64_t x_578888 = ((int64_t *) mem_586435)[i_586161];
                double x_578889 = ((double *) mem_586437)[i_586161];
                int64_t x_578891 = ((int64_t *) mem_586419.mem)[i_586161];
                bool cond_578900 = slt64(redout_586157, x_578888);
                bool cond_578901 = redout_586157 == x_578888;
                bool zlze_res_578902 = redout_586158 <= x_578889;
                bool x_578903 = cond_578901 && zlze_res_578902;
                bool x_578904 = !cond_578900;
                bool y_578905 = x_578903 && x_578904;
                bool defunc_0_leq_res_578906 = cond_578900 || y_578905;
                int64_t defunc_0_op_res_578907;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578907 = x_578888;
                } else {
                    defunc_0_op_res_578907 = redout_586157;
                }
                
                double defunc_0_op_res_578908;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578908 = x_578889;
                } else {
                    defunc_0_op_res_578908 = redout_586158;
                }
                
                int64_t defunc_0_op_res_578909;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578909 = x_578891;
                } else {
                    defunc_0_op_res_578909 = redout_586160;
                }
                
                int64_t lmad_ext_586501 = dim_251930 * i_586161;
                int64_t ext_586503;
                
                if (defunc_0_leq_res_578906) {
                    ext_586503 = lmad_ext_586501;
                } else {
                    ext_586503 = ctx_param_ext_586498;
                }
                if (defunc_0_leq_res_578906) {
                    if (memblock_set(ctx, &ext_mem_586504, &xs_mem_586417, "xs_mem_586417") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586504, &mem_param_586500, "mem_param_586500") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588100, &ext_mem_586504, "ext_mem_586504") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588101 = ext_586503;
                int64_t redout_tmp_588102 = defunc_0_op_res_578907;
                double redout_tmp_588103 = defunc_0_op_res_578908;
                int64_t redout_tmp_588105 = defunc_0_op_res_578909;
                
                if (memblock_set(ctx, &mem_param_586500, &mem_param_tmp_588100, "mem_param_tmp_588100") != 0)
                    return 1;
                ctx_param_ext_586498 = ctx_param_ext_tmp_588101;
                redout_586157 = redout_tmp_588102;
                redout_586158 = redout_tmp_588103;
                redout_586160 = redout_tmp_588105;
            }
            if (memblock_set(ctx, &ext_mem_586507, &mem_param_586500, "mem_param_586500") != 0)
                return 1;
            ext_586506 = ctx_param_ext_586498;
            defunc_0_reduce_res_585670 = redout_586157;
            defunc_0_reduce_res_585671 = redout_586158;
            defunc_0_reduce_res_585673 = redout_586160;
            if (mem_586510_cached_sizze_589000 < bytes_586509) {
                err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_589000, bytes_586509);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586513_cached_sizze_589001 < bytes_586509) {
                err = lexical_realloc(ctx, &mem_586513, &mem_586513_cached_sizze_589001, bytes_586509);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586517_cached_sizze_589002 < bytes_586516) {
                err = lexical_realloc(ctx, &mem_586517, &mem_586517_cached_sizze_589002, bytes_586516);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586520_cached_sizze_589003 < bytes_586509) {
                err = lexical_realloc(ctx, &mem_586520, &mem_586520_cached_sizze_589003, bytes_586509);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586540_cached_sizze_589004 < bytes_586539) {
                err = lexical_realloc(ctx, &mem_586540, &mem_586540_cached_sizze_589004, bytes_586539);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586542_cached_sizze_589005 < bytes_586539) {
                err = lexical_realloc(ctx, &mem_586542, &mem_586542_cached_sizze_589005, bytes_586539);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586545_cached_sizze_589006 < bytes_586544) {
                err = lexical_realloc(ctx, &mem_586545, &mem_586545_cached_sizze_589006, bytes_586544);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586547_cached_sizze_589007 < bytes_586539) {
                err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_589007, bytes_586539);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586183 = 0; i_586183 < x_582419; i_586183++) {
                int64_t zp_lhs_578931 = mul64(block_sizze_578866, i_586183);
                
                for (int64_t i_586170 = 0; i_586170 < block_sizze_578866; i_586170++) {
                    int64_t k_578937 = add64(zp_lhs_578931, i_586170);
                    bool cond_578938 = slt64(k_578937, n_251933);
                    int64_t lmad_ext_586561 = dim_251930 * k_578937;
                    int64_t ext_586563;
                    
                    if (cond_578938) {
                        ext_586563 = lmad_ext_586561;
                    } else {
                        ext_586563 = ext_586506;
                    }
                    
                    int64_t lifted_lambda_res_578939;
                    double lifted_lambda_res_578940;
                    int64_t lifted_lambda_res_578942;
                    
                    if (cond_578938) {
                        bool x_585446 = sle64((int64_t) 0, k_578937);
                        bool bounds_check_585447 = cond_578938 && x_585446;
                        bool index_certs_585448;
                        
                        if (!bounds_check_585447) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_578937, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585449 = ((int64_t *) mem_586435)[k_578937];
                        double lifted_lambda_res_t_res_585450 = ((double *) mem_586437)[k_578937];
                        int64_t index_primexp_585452 = add64(offset_251944, k_578937);
                        
                        if (memblock_set(ctx, &ext_mem_586564, &xs_mem_586417, "xs_mem_586417") != 0)
                            return 1;
                        lifted_lambda_res_578939 = lifted_lambda_res_t_res_585449;
                        lifted_lambda_res_578940 = lifted_lambda_res_t_res_585450;
                        lifted_lambda_res_578942 = index_primexp_585452;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586564, &ext_mem_586507, "ext_mem_586507") != 0)
                            return 1;
                        lifted_lambda_res_578939 = defunc_0_reduce_res_585670;
                        lifted_lambda_res_578940 = defunc_0_reduce_res_585671;
                        lifted_lambda_res_578942 = defunc_0_reduce_res_585673;
                    }
                    ((int64_t *) mem_586540)[i_586170] = lifted_lambda_res_578939;
                    ((double *) mem_586542)[i_586170] = lifted_lambda_res_578940;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586545, i_586170 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586564.mem, ext_586563, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                    if (memblock_unref(ctx, &ext_mem_586564, "ext_mem_586564") != 0)
                        return 1;
                    ((int64_t *) mem_586547)[i_586170] = lifted_lambda_res_578942;
                }
                if (!cond_578919) {
                    if (mem_586605_cached_sizze_589008 < bytes_586444) {
                        err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_589008, bytes_586444);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586607_cached_sizze_589009 < bytes_586444) {
                        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_589009, bytes_586444);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_578958 = 0; i_578958 < distance_578922; i_578958++) {
                        int64_t gt_arg1_578963 = add64((int64_t) 1, i_578958);
                        bool x_578964 = sle64((int64_t) 0, gt_arg1_578963);
                        bool y_578965 = slt64(gt_arg1_578963, block_sizze_578866);
                        bool bounds_check_578966 = x_578964 && y_578965;
                        bool index_certs_578967;
                        
                        if (!bounds_check_578966) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_578963, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_578970 = slt64(i_578958, block_sizze_578866);
                        bool index_certs_578971;
                        
                        if (!y_578970) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_578958, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_578968 = ((int64_t *) mem_586540)[gt_arg1_578963];
                        double gt_arg1_578969 = ((double *) mem_586542)[gt_arg1_578963];
                        int64_t gt_arg0_578972 = ((int64_t *) mem_586540)[i_578958];
                        double gt_arg0_578973 = ((double *) mem_586542)[i_578958];
                        bool cond_578974 = slt64(gt_arg0_578972, gt_arg1_578968);
                        bool cond_578975 = gt_arg0_578972 == gt_arg1_578968;
                        bool zlze_res_578976 = gt_arg0_578973 <= gt_arg1_578969;
                        bool x_578977 = cond_578975 && zlze_res_578976;
                        bool x_578978 = !cond_578974;
                        bool y_578979 = x_578977 && x_578978;
                        bool defunc_0_leq_res_578980 = cond_578974 || y_578979;
                        bool defunc_0_lifted_gt_res_578981 = !defunc_0_leq_res_578980;
                        bool s_578982;
                        int64_t s_578987;
                        bool loop_while_578988;
                        int64_t j_578993;
                        
                        loop_while_578988 = defunc_0_lifted_gt_res_578981;
                        j_578993 = i_578958;
                        while (loop_while_578988) {
                            bool x_578994 = sle64((int64_t) 0, j_578993);
                            bool y_578995 = slt64(j_578993, block_sizze_578866);
                            bool bounds_check_578996 = x_578994 && y_578995;
                            bool index_certs_578997;
                            
                            if (!bounds_check_578996) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_578993, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_579003 = add64((int64_t) 1, j_578993);
                            bool x_579004 = sle64((int64_t) 0, copy_arg0_579003);
                            bool y_579005 = slt64(copy_arg0_579003, block_sizze_578866);
                            bool bounds_check_579006 = x_579004 && y_579005;
                            bool index_certs_579007;
                            
                            if (!bounds_check_579006) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_579003, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_578998 = ((int64_t *) mem_586540)[j_578993];
                            double copy_arg0_578999 = ((double *) mem_586542)[j_578993];
                            int64_t copy_arg0_579001 = ((int64_t *) mem_586547)[j_578993];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586545, (int64_t) 0 + j_578993 * dim_251930, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            
                            int64_t copy_arg0_579008 = ((int64_t *) mem_586540)[copy_arg0_579003];
                            double copy_arg0_579009 = ((double *) mem_586542)[copy_arg0_579003];
                            int64_t copy_arg0_579011 = ((int64_t *) mem_586547)[copy_arg0_579003];
                            
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586607, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586545, (int64_t) 0 + copy_arg0_579003 * dim_251930, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_586540)[j_578993] = copy_arg0_579008;
                            ((double *) mem_586542)[j_578993] = copy_arg0_579009;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586545, j_578993 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586607, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_586547)[j_578993] = copy_arg0_579011;
                            ((int64_t *) mem_586540)[copy_arg0_579003] = copy_arg0_578998;
                            ((double *) mem_586542)[copy_arg0_579003] = copy_arg0_578999;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586545, copy_arg0_579003 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_586547)[copy_arg0_579003] = copy_arg0_579001;
                            
                            int64_t tmp_579021 = sub64(j_578993, (int64_t) 1);
                            bool cond_579022 = sle64((int64_t) 0, tmp_579021);
                            bool loop_cond_579023;
                            
                            if (cond_579022) {
                                bool y_585455 = slt64(tmp_579021, block_sizze_578866);
                                bool bounds_check_585456 = cond_579022 && y_585455;
                                bool index_certs_585457;
                                
                                if (!bounds_check_585456) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_579021, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585453 = ((int64_t *) mem_586540)[j_578993];
                                double gt_arg1_585454 = ((double *) mem_586542)[j_578993];
                                int64_t gt_arg0_585458 = ((int64_t *) mem_586540)[tmp_579021];
                                double gt_arg0_585459 = ((double *) mem_586542)[tmp_579021];
                                bool cond_585460 = slt64(gt_arg0_585458, gt_arg1_585453);
                                bool cond_585461 = gt_arg0_585458 == gt_arg1_585453;
                                bool zlze_res_585462 = gt_arg0_585459 <= gt_arg1_585454;
                                bool x_585463 = cond_585461 && zlze_res_585462;
                                bool x_585464 = !cond_585460;
                                bool y_585465 = x_585463 && x_585464;
                                bool defunc_0_leq_res_585466 = cond_585460 || y_585465;
                                bool defunc_0_lifted_gt_res_585467 = !defunc_0_leq_res_585466;
                                
                                loop_cond_579023 = defunc_0_lifted_gt_res_585467;
                            } else {
                                loop_cond_579023 = 0;
                            }
                            
                            bool loop_while_tmp_588118 = loop_cond_579023;
                            int64_t j_tmp_588123 = tmp_579021;
                            
                            loop_while_578988 = loop_while_tmp_588118;
                            j_578993 = j_tmp_588123;
                        }
                        s_578982 = loop_while_578988;
                        s_578987 = j_578993;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586510, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586540, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586513, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586542, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586517, i_586183 * lmad_arg_586538, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) mem_586545, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {block_sizze_578866, dim_251930});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586520, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586547, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
            }
            if (memblock_unref(ctx, &ext_mem_586507, "ext_mem_586507") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586666, bytes_586509, "mem_586666")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586666.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint64_t *) mem_586510, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            if (memblock_alloc(ctx, &mem_586670, bytes_586509, "mem_586670")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586670.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint64_t *) mem_586513, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            if (memblock_alloc(ctx, &mem_586675, bytes_586516, "mem_586675")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 3, (uint64_t *) mem_586675.mem, (int64_t) 0, (int64_t []) {dim_251930 * block_sizze_578866, dim_251930, (int64_t) 1}, (uint64_t *) mem_586517, (int64_t) 0, (int64_t []) {lmad_arg_586538, dim_251930, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866, dim_251930});
            if (memblock_alloc(ctx, &mem_586679, bytes_586509, "mem_586679")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586679.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint64_t *) mem_586520, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            
            int64_t data_579048;
            bool data_579049;
            int64_t data_579054;
            int64_t loop_dz2084Uz2082U_579055;
            bool loop_while_579056;
            int64_t stride_579061;
            
            if (memblock_set(ctx, &mem_param_586683, &mem_586666, "mem_586666") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586686, &mem_586670, "mem_586670") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586690, &mem_586675, "mem_586675") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586693, &mem_586679, "mem_586679") != 0)
                return 1;
            loop_dz2084Uz2082U_579055 = flat_dim_578876;
            loop_while_579056 = loop_cond_579045;
            stride_579061 = block_sizze_578866;
            while (loop_while_579056) {
                int64_t next_stride_579062 = mul64((int64_t) 2, stride_579061);
                bool zzero_579063 = next_stride_579062 == (int64_t) 0;
                bool nonzzero_579064 = !zzero_579063;
                bool nonzzero_cert_579065;
                
                if (!nonzzero_579064) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_579066 = sdiv64(flat_dim_578876, next_stride_579062);
                bool bounds_invalid_upwards_579067 = slt64(num_merges_579066, (int64_t) 0);
                bool valid_579068 = !bounds_invalid_upwards_579067;
                bool range_valid_c_579069;
                
                if (!valid_579068) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_579066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:790:33-56\n   #6  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_579071 = sub64(next_stride_579062, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_579072 = sle64((int64_t) 0, m_579071);
                bool cond_579074 = slt64(next_stride_579062, (int64_t) 10);
                bool protect_assert_disj_579075 = nonzzero_579047 || cond_579074;
                bool nonzzero_cert_579076;
                
                if (!protect_assert_disj_579075) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_579077 = smod_safe64(next_stride_579062, merge_block_sizze_578882);
                bool num_blocks_579078 = zeze_lhs_579077 == (int64_t) 0;
                bool protect_assert_disj_579079 = cond_579074 || num_blocks_579078;
                bool assert_c_579080;
                
                if (!protect_assert_disj_579079) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_579083 = sdiv_safe64(next_stride_579062, merge_block_sizze_578882);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084 = add64((int64_t) 1, num_blocks_579083);
                int64_t j_m_i_579085 = sub64(next_stride_579062, stride_579061);
                int64_t flat_dim_579086 = merge_block_sizze_578882 * num_blocks_579083;
                bool bounds_invalid_upwards_579087 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, (int64_t) 0);
                bool zzero_lte_i_579088 = sle64((int64_t) 0, stride_579061);
                bool i_lte_j_579089 = sle64(stride_579061, next_stride_579062);
                bool empty_slice_579090 = stride_579061 == (int64_t) 0;
                int64_t m_579091 = sub64(stride_579061, (int64_t) 1);
                bool bounds_invalid_upwards_579092 = slt64(num_blocks_579083, (int64_t) 0);
                bool empty_slice_579093 = j_m_i_579085 == (int64_t) 0;
                int64_t m_579094 = sub64(j_m_i_579085, (int64_t) 1);
                bool cond_579095 = slt64((int64_t) 0, stride_579061);
                bool valid_579096 = !bounds_invalid_upwards_579087;
                bool zzero_leq_i_p_m_t_s_579097 = sle64((int64_t) 0, m_579091);
                bool i_p_m_t_s_leq_w_579098 = slt64(m_579091, next_stride_579062);
                bool valid_579099 = !bounds_invalid_upwards_579092;
                bool i_p_m_t_s_leq_w_579100 = slt64(m_579071, flat_dim_579086);
                int64_t i_p_m_t_s_579101 = add64(stride_579061, m_579094);
                bool y_579102 = slt64((int64_t) 0, j_m_i_579085);
                bool protect_assert_disj_579103 = cond_579074 || valid_579096;
                bool range_valid_c_579104;
                
                if (!protect_assert_disj_579103) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579105 = zzero_leq_i_p_m_t_s_579097 && i_p_m_t_s_leq_w_579098;
                bool protect_assert_disj_579106 = cond_579074 || valid_579099;
                bool range_valid_c_579107;
                
                if (!protect_assert_disj_579106) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_579083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579108 = zzero_leq_i_p_m_t_s_579072 && i_p_m_t_s_leq_w_579100;
                bool zzero_leq_i_p_m_t_s_579109 = sle64((int64_t) 0, i_p_m_t_s_579101);
                bool i_p_m_t_s_leq_w_579110 = slt64(i_p_m_t_s_579101, next_stride_579062);
                bool forwards_ok_579111 = zzero_lte_i_579088 && y_579105;
                bool ok_or_empty_579112 = zzero_579063 || y_579108;
                bool y_579113 = zzero_lte_i_579088 && i_p_m_t_s_leq_w_579110;
                bool protect_assert_disj_579114 = cond_579095 || y_579102;
                bool ok_or_empty_579115 = empty_slice_579090 || forwards_ok_579111;
                bool protect_assert_disj_579116 = cond_579074 || ok_or_empty_579112;
                bool index_certs_579117;
                
                if (!protect_assert_disj_579116) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_579062, "] out of bounds for array of shape [", (long long) flat_dim_579086, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579118 = zzero_leq_i_p_m_t_s_579109 && y_579113;
                bool loop_not_taken_579119 = !cond_579074;
                bool protect_assert_disj_579120 = protect_assert_disj_579114 || loop_not_taken_579119;
                bool index_certs_579121;
                
                if (!protect_assert_disj_579120) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_579122 = cond_579074 || ok_or_empty_579115;
                bool index_certs_579123;
                
                if (!protect_assert_disj_579122) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_579061, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_579124 = i_lte_j_579089 && y_579118;
                bool protect_assert_disj_579125 = ok_or_empty_579115 || loop_not_taken_579119;
                bool index_certs_579126;
                
                if (!protect_assert_disj_579125) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_579061, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_579127 = empty_slice_579093 || forwards_ok_579124;
                bool protect_assert_disj_579128 = loop_not_taken_579119 || ok_or_empty_579127;
                bool index_certs_579129;
                
                if (!protect_assert_disj_579128) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_579061, ":] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_579130 = cond_579074 || ok_or_empty_579127;
                bool index_certs_579131;
                
                if (!protect_assert_disj_579130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_579061, ":] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586694 = (int64_t) 8 * num_merges_579066;
                int64_t bytes_586695 = next_stride_579062 * binop_x_586694;
                int64_t bytes_586702 = dim_251930 * bytes_586695;
                bool i_lte_j_579073 = sle64((int64_t) 0, next_stride_579062);
                
                if (mem_586696_cached_sizze_589010 < bytes_586695) {
                    err = lexical_realloc(ctx, &mem_586696, &mem_586696_cached_sizze_589010, bytes_586695);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586699_cached_sizze_589011 < bytes_586695) {
                    err = lexical_realloc(ctx, &mem_586699, &mem_586699_cached_sizze_589011, bytes_586695);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586703_cached_sizze_589012 < bytes_586702) {
                    err = lexical_realloc(ctx, &mem_586703, &mem_586703_cached_sizze_589012, bytes_586702);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586706_cached_sizze_589013 < bytes_586695) {
                    err = lexical_realloc(ctx, &mem_586706, &mem_586706_cached_sizze_589013, bytes_586695);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586724 = dim_251930 * next_stride_579062;
                int64_t bytes_586725 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084;
                int64_t binop_x_586741 = (int64_t) 8 * num_blocks_579083;
                int64_t bytes_586742 = merge_block_sizze_578882 * binop_x_586741;
                int64_t bytes_586749 = dim_251930 * bytes_586742;
                int64_t bytes_586856 = (int64_t) 16 * stride_579061;
                int64_t bytes_586863 = dim_251930 * bytes_586856;
                
                for (int64_t i_586216 = 0; i_586216 < num_merges_579066; i_586216++) {
                    int64_t start_579137 = mul64(next_stride_579062, i_586216);
                    int64_t j_m_i_579138 = sub64(loop_dz2084Uz2082U_579055, start_579137);
                    bool empty_slice_579139 = j_m_i_579138 == (int64_t) 0;
                    int64_t m_579140 = sub64(j_m_i_579138, (int64_t) 1);
                    int64_t i_p_m_t_s_579141 = add64(start_579137, m_579140);
                    bool zzero_leq_i_p_m_t_s_579142 = sle64((int64_t) 0, i_p_m_t_s_579141);
                    bool i_p_m_t_s_leq_w_579143 = slt64(i_p_m_t_s_579141, loop_dz2084Uz2082U_579055);
                    bool zzero_lte_i_579144 = sle64((int64_t) 0, start_579137);
                    bool i_lte_j_579145 = sle64(start_579137, loop_dz2084Uz2082U_579055);
                    bool y_579146 = i_p_m_t_s_leq_w_579143 && zzero_lte_i_579144;
                    bool y_579147 = zzero_leq_i_p_m_t_s_579142 && y_579146;
                    bool forwards_ok_579148 = i_lte_j_579145 && y_579147;
                    bool ok_or_empty_579149 = empty_slice_579139 || forwards_ok_579148;
                    bool index_certs_579150;
                    
                    if (!ok_or_empty_579149) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_579137, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_579055, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_579151 = slt64(m_579071, j_m_i_579138);
                    bool y_579152 = zzero_leq_i_p_m_t_s_579072 && i_p_m_t_s_leq_w_579151;
                    bool forwards_ok_579153 = i_lte_j_579073 && y_579152;
                    bool ok_or_empty_579154 = zzero_579063 || forwards_ok_579153;
                    bool index_certs_579155;
                    
                    if (!ok_or_empty_579154) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_579062, "] out of bounds for array of shape [", (long long) j_m_i_579138, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:790:33-56\n   #8  ftSkyline.fut:779:17-790:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585515 = stride_579061 + start_579137;
                    int64_t binop_y_586851 = dim_251930 * slice_585515;
                    int64_t binop_y_586853 = dim_251930 * start_579137;
                    int64_t ext_586855;
                    
                    if (cond_579095) {
                        ext_586855 = binop_y_586853;
                    } else {
                        ext_586855 = binop_y_586851;
                    }
                    if (cond_579074) {
                        int64_t dummy_585507;
                        double dummy_585508;
                        int64_t dummy_585510;
                        
                        if (cond_579095) {
                            int64_t head_res_585511 = ((int64_t *) mem_param_586683.mem)[start_579137];
                            double head_res_585512 = ((double *) mem_param_586686.mem)[start_579137];
                            int64_t head_res_585514 = ((int64_t *) mem_param_586693.mem)[start_579137];
                            
                            dummy_585507 = head_res_585511;
                            dummy_585508 = head_res_585512;
                            dummy_585510 = head_res_585514;
                        } else {
                            int64_t head_res_585516 = ((int64_t *) mem_param_586683.mem)[slice_585515];
                            double head_res_585517 = ((double *) mem_param_586686.mem)[slice_585515];
                            int64_t head_res_585519 = ((int64_t *) mem_param_586693.mem)[slice_585515];
                            
                            dummy_585507 = head_res_585516;
                            dummy_585508 = head_res_585517;
                            dummy_585510 = head_res_585519;
                        }
                        if (memblock_alloc(ctx, &mem_586857, bytes_586856, "mem_586857")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588139 = 0; nest_i_588139 < next_stride_579062; nest_i_588139++) {
                            ((int64_t *) mem_586857.mem)[nest_i_588139] = dummy_585507;
                        }
                        if (memblock_alloc(ctx, &mem_586859, bytes_586856, "mem_586859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588140 = 0; nest_i_588140 < next_stride_579062; nest_i_588140++) {
                            ((double *) mem_586859.mem)[nest_i_588140] = dummy_585508;
                        }
                        if (memblock_alloc(ctx, &mem_586861, bytes_586856, "mem_586861")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588141 = 0; nest_i_588141 < next_stride_579062; nest_i_588141++) {
                            ((int64_t *) mem_586861.mem)[nest_i_588141] = dummy_585510;
                        }
                        if (memblock_alloc(ctx, &mem_586864, bytes_586863, "mem_586864")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588142 = 0; nest_i_588142 < next_stride_579062; nest_i_588142++) {
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586864.mem, nest_i_588142 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586690.mem, ext_586855, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                        }
                        
                        int64_t data_585524;
                        int64_t i_585530 = (int64_t) 0;
                        
                        for (int64_t k_585529 = 0; k_585529 < next_stride_579062; k_585529++) {
                            int64_t j_585535 = sub64(k_585529, i_585530);
                            bool cond_585536 = j_585535 == j_m_i_579085;
                            bool x_587822 = !cond_585536;
                            bool cond_585538 = slt64(i_585530, stride_579061);
                            bool x_585540 = sle64((int64_t) 0, j_585535);
                            bool y_585541 = slt64(j_585535, j_m_i_579085);
                            bool bounds_check_585542 = x_585540 && y_585541;
                            bool loop_not_taken_587810 = !cond_585538;
                            bool protect_assert_disj_587811 = bounds_check_585542 || loop_not_taken_587810;
                            bool protect_assert_disj_587825 = cond_585536 || protect_assert_disj_587811;
                            bool index_certs_585543;
                            
                            if (!protect_assert_disj_587825) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585535, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585544 = stride_579061 + j_585535;
                            int64_t slice_585545 = start_579137 + slice_585544;
                            bool protect_cond_conj_587826 = cond_585538 && x_587822;
                            int64_t leq_arg1_585546;
                            
                            if (protect_cond_conj_587826) {
                                int64_t x_587812 = ((int64_t *) mem_param_586683.mem)[slice_585545];
                                
                                leq_arg1_585546 = x_587812;
                            } else {
                                leq_arg1_585546 = (int64_t) 0;
                            }
                            
                            double leq_arg1_585547;
                            
                            if (protect_cond_conj_587826) {
                                double x_587814 = ((double *) mem_param_586686.mem)[slice_585545];
                                
                                leq_arg1_585547 = x_587814;
                            } else {
                                leq_arg1_585547 = 0.0;
                            }
                            
                            bool x_585548 = sle64((int64_t) 0, i_585530);
                            bool bounds_check_585549 = cond_585538 && x_585548;
                            bool protect_assert_disj_587817 = bounds_check_585549 || loop_not_taken_587810;
                            bool protect_assert_disj_587829 = cond_585536 || protect_assert_disj_587817;
                            bool index_certs_585550;
                            
                            if (!protect_assert_disj_587829) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585530, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585551 = start_579137 + i_585530;
                            int64_t leq_arg0_585552;
                            
                            if (protect_cond_conj_587826) {
                                int64_t x_587818 = ((int64_t *) mem_param_586683.mem)[slice_585551];
                                
                                leq_arg0_585552 = x_587818;
                            } else {
                                leq_arg0_585552 = (int64_t) 0;
                            }
                            
                            double leq_arg0_585553;
                            
                            if (protect_cond_conj_587826) {
                                double x_587820 = ((double *) mem_param_586686.mem)[slice_585551];
                                
                                leq_arg0_585553 = x_587820;
                            } else {
                                leq_arg0_585553 = 0.0;
                            }
                            
                            bool cond_585554 = slt64(leq_arg0_585552, leq_arg1_585546);
                            bool cond_585555 = leq_arg0_585552 == leq_arg1_585546;
                            bool zlze_res_585556 = leq_arg0_585553 <= leq_arg1_585547;
                            bool x_585557 = cond_585555 && zlze_res_585556;
                            bool x_585558 = !cond_585554;
                            bool y_585559 = x_585557 && x_585558;
                            bool defunc_0_leq_res_585560 = cond_585554 || y_585559;
                            bool x_587865 = cond_585538 && defunc_0_leq_res_585560;
                            bool cond_585537 = cond_585536 || x_587865;
                            bool protect_assert_disj_587734 = cond_585537 || bounds_check_585542;
                            bool index_certs_585579;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585535, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585569 = cond_585538 && x_585548;
                            bool loop_not_taken_587729 = !cond_585537;
                            bool protect_assert_disj_587730 = bounds_check_585569 || loop_not_taken_587729;
                            bool index_certs_585570;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585530, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:790:33-56\n   #9  ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585581 = start_579137 + slice_585544;
                            int64_t binop_y_586878 = dim_251930 * slice_585581;
                            int64_t binop_y_586880 = dim_251930 * slice_585551;
                            int64_t ext_586882;
                            
                            if (cond_585537) {
                                ext_586882 = binop_y_586880;
                            } else {
                                ext_586882 = binop_y_586878;
                            }
                            
                            int64_t loopres_585561;
                            int64_t loopres_585562;
                            double loopres_585563;
                            int64_t loopres_585565;
                            
                            if (cond_585537) {
                                int64_t tmp_585566 = add64((int64_t) 1, i_585530);
                                int64_t tmp_585572 = ((int64_t *) mem_param_586683.mem)[slice_585551];
                                double tmp_585573 = ((double *) mem_param_586686.mem)[slice_585551];
                                int64_t tmp_585575 = ((int64_t *) mem_param_586693.mem)[slice_585551];
                                
                                loopres_585561 = tmp_585566;
                                loopres_585562 = tmp_585572;
                                loopres_585563 = tmp_585573;
                                loopres_585565 = tmp_585575;
                            } else {
                                int64_t tmp_585582 = ((int64_t *) mem_param_586683.mem)[slice_585581];
                                double tmp_585583 = ((double *) mem_param_586686.mem)[slice_585581];
                                int64_t tmp_585585 = ((int64_t *) mem_param_586693.mem)[slice_585581];
                                
                                loopres_585561 = i_585530;
                                loopres_585562 = tmp_585582;
                                loopres_585563 = tmp_585583;
                                loopres_585565 = tmp_585585;
                            }
                            ((int64_t *) mem_586857.mem)[k_585529] = loopres_585562;
                            ((double *) mem_586859.mem)[k_585529] = loopres_585563;
                            lmad_copy_8b(ctx, 1, (uint64_t *) mem_586864.mem, k_585529 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586690.mem, ext_586882, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            ((int64_t *) mem_586861.mem)[k_585529] = loopres_585565;
                            
                            int64_t i_tmp_588143 = loopres_585561;
                            
                            i_585530 = i_tmp_588143;
                        }
                        data_585524 = i_585530;
                        if (memblock_set(ctx, &ext_mem_586908, &mem_586857, "mem_586857") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586905, &mem_586859, "mem_586859") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586902, &mem_586864, "mem_586864") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586898, &mem_586861, "mem_586861") != 0)
                            return 1;
                    } else {
                        if (mem_586726_cached_sizze_589014 < bytes_586725) {
                            err = lexical_realloc(ctx, &mem_586726, &mem_586726_cached_sizze_589014, bytes_586725);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586728_cached_sizze_589015 < bytes_586725) {
                            err = lexical_realloc(ctx, &mem_586728, &mem_586728_cached_sizze_589015, bytes_586725);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586192 = 0; i_586192 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084; i_586192++) {
                            int64_t split_count_arg3_579247 = mul64(merge_block_sizze_578882, i_586192);
                            int64_t defunc_0_split_count_res_579248;
                            int64_t defunc_0_split_count_res_579249;
                            int64_t defunc_0_split_count_res_579250;
                            int64_t defunc_0_split_count_res_579251;
                            int64_t defunc_0_split_count_res_579252;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_579248, &defunc_0_split_count_res_579249, &defunc_0_split_count_res_579250, &defunc_0_split_count_res_579251, &defunc_0_split_count_res_579252, (int64_t) 0, stride_579061, (int64_t) 0, j_m_i_579085, split_count_arg3_579247) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_579253 = slt64((int64_t) 0, defunc_0_split_count_res_579252);
                            bool defunc_0_split_count_res_579254;
                            int64_t defunc_0_split_count_res_579255;
                            int64_t defunc_0_split_count_res_579256;
                            int64_t defunc_0_split_count_res_579257;
                            int64_t defunc_0_split_count_res_579258;
                            int64_t defunc_0_split_count_res_579259;
                            bool loop_while_579260;
                            int64_t ss_579261;
                            int64_t ss_579262;
                            int64_t tt_579263;
                            int64_t tt_579264;
                            int64_t count_579265;
                            
                            loop_while_579260 = loop_cond_579253;
                            ss_579261 = defunc_0_split_count_res_579248;
                            ss_579262 = defunc_0_split_count_res_579249;
                            tt_579263 = defunc_0_split_count_res_579250;
                            tt_579264 = defunc_0_split_count_res_579251;
                            count_579265 = defunc_0_split_count_res_579252;
                            while (loop_while_579260) {
                                int64_t zlze_lhs_579266 = sub64(ss_579262, ss_579261);
                                bool cond_579267 = sle64(zlze_lhs_579266, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_579268;
                                int64_t defunc_0_lifted_step_res_579269;
                                int64_t defunc_0_lifted_step_res_579270;
                                int64_t defunc_0_lifted_step_res_579271;
                                
                                if (cond_579267) {
                                    int64_t tmp_585590 = add64(tt_579263, count_579265);
                                    
                                    defunc_0_lifted_step_res_579268 = ss_579261;
                                    defunc_0_lifted_step_res_579269 = tmp_585590;
                                    defunc_0_lifted_step_res_579270 = tt_579264;
                                    defunc_0_lifted_step_res_579271 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_579273 = sub64(tt_579264, tt_579263);
                                    bool cond_579274 = sle64(zlze_lhs_579273, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_579275;
                                    int64_t defunc_0_lifted_step_res_f_res_579276;
                                    int64_t defunc_0_lifted_step_res_f_res_579277;
                                    int64_t defunc_0_lifted_step_res_f_res_579278;
                                    
                                    if (cond_579274) {
                                        int64_t tmp_585591 = add64(ss_579261, count_579265);
                                        
                                        defunc_0_lifted_step_res_f_res_579275 = tmp_585591;
                                        defunc_0_lifted_step_res_f_res_579276 = tt_579263;
                                        defunc_0_lifted_step_res_f_res_579277 = tt_579264;
                                        defunc_0_lifted_step_res_f_res_579278 = (int64_t) 0;
                                    } else {
                                        bool cond_579280 = count_579265 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579281;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579282;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579283;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579284;
                                        
                                        if (cond_579280) {
                                            bool x_585593 = sle64((int64_t) 0, ss_579261);
                                            bool y_585594 = slt64(ss_579261, stride_579061);
                                            bool bounds_check_585595 = x_585593 && y_585594;
                                            bool index_certs_585596;
                                            
                                            if (!bounds_check_585595) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_579261, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:790:33-56\n   #13 ftSkyline.fut:779:17-790:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585600 = sle64((int64_t) 0, tt_579263);
                                            bool y_585601 = slt64(tt_579263, j_m_i_579085);
                                            bool bounds_check_585602 = x_585600 && y_585601;
                                            bool index_certs_585603;
                                            
                                            if (!bounds_check_585602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_579263, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:790:33-56\n   #13 ftSkyline.fut:779:17-790:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585597 = start_579137 + ss_579261;
                                            int64_t leq_arg1_585598 = ((int64_t *) mem_param_586683.mem)[slice_585597];
                                            double leq_arg1_585599 = ((double *) mem_param_586686.mem)[slice_585597];
                                            int64_t slice_585604 = stride_579061 + tt_579263;
                                            int64_t slice_585605 = start_579137 + slice_585604;
                                            int64_t leq_arg0_585606 = ((int64_t *) mem_param_586683.mem)[slice_585605];
                                            double leq_arg0_585607 = ((double *) mem_param_586686.mem)[slice_585605];
                                            bool cond_585608 = slt64(leq_arg0_585606, leq_arg1_585598);
                                            bool cond_585609 = leq_arg0_585606 == leq_arg1_585598;
                                            bool zlze_res_585610 = leq_arg0_585607 <= leq_arg1_585599;
                                            bool x_585611 = cond_585609 && zlze_res_585610;
                                            bool x_585612 = !cond_585608;
                                            bool y_585613 = x_585611 && x_585612;
                                            bool defunc_0_leq_res_585614 = cond_585608 || y_585613;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585615;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585616;
                                            
                                            if (defunc_0_leq_res_585614) {
                                                int64_t tmp_585617 = add64((int64_t) 1, tt_579263);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585615 = ss_579261;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585616 = tmp_585617;
                                            } else {
                                                int64_t tmp_585618 = add64((int64_t) 1, ss_579261);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585615 = tmp_585618;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585616 = tt_579263;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_579281 = defunc_0_lifted_step_res_f_res_f_res_t_res_585615;
                                            defunc_0_lifted_step_res_f_res_f_res_579282 = defunc_0_lifted_step_res_f_res_f_res_t_res_585616;
                                            defunc_0_lifted_step_res_f_res_f_res_579283 = tt_579264;
                                            defunc_0_lifted_step_res_f_res_f_res_579284 = (int64_t) 0;
                                        } else {
                                            int64_t m_579311 = sdiv64(count_579265, (int64_t) 2);
                                            int64_t n_579312 = sub64(count_579265, m_579311);
                                            bool cond_579313 = n_579312 == (int64_t) 0;
                                            int64_t zgze_lhs_579314 = add64(ss_579261, m_579311);
                                            bool cond_f_res_579315 = sle64(ss_579262, zgze_lhs_579314);
                                            bool x_579316 = !cond_579313;
                                            bool y_579317 = cond_f_res_579315 && x_579316;
                                            bool cond_579318 = cond_579313 || y_579317;
                                            bool leq_y_x_579319;
                                            
                                            if (cond_579318) {
                                                leq_y_x_579319 = 1;
                                            } else {
                                                bool x_579320 = sle64((int64_t) 0, zgze_lhs_579314);
                                                bool y_579321 = slt64(zgze_lhs_579314, stride_579061);
                                                bool bounds_check_579322 = x_579320 && y_579321;
                                                bool index_certs_579323;
                                                
                                                if (!bounds_check_579322) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_579314, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:790:33-56\n   #13 ftSkyline.fut:779:17-790:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_579327 = add64(tt_579263, n_579312);
                                                int64_t leq_arg0_579328 = sub64(zm_lhs_579327, (int64_t) 1);
                                                bool x_579329 = sle64((int64_t) 0, leq_arg0_579328);
                                                bool y_579330 = slt64(leq_arg0_579328, j_m_i_579085);
                                                bool bounds_check_579331 = x_579329 && y_579330;
                                                bool index_certs_579332;
                                                
                                                if (!bounds_check_579331) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_579328, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:790:33-56\n   #13 ftSkyline.fut:779:17-790:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_579324 = start_579137 + zgze_lhs_579314;
                                                int64_t leq_arg1_579325 = ((int64_t *) mem_param_586683.mem)[slice_579324];
                                                double leq_arg1_579326 = ((double *) mem_param_586686.mem)[slice_579324];
                                                int64_t slice_579333 = stride_579061 + leq_arg0_579328;
                                                int64_t slice_579334 = start_579137 + slice_579333;
                                                int64_t leq_arg0_579335 = ((int64_t *) mem_param_586683.mem)[slice_579334];
                                                double leq_arg0_579336 = ((double *) mem_param_586686.mem)[slice_579334];
                                                bool cond_579337 = slt64(leq_arg0_579335, leq_arg1_579325);
                                                bool cond_579338 = leq_arg0_579335 == leq_arg1_579325;
                                                bool zlze_res_579339 = leq_arg0_579336 <= leq_arg1_579326;
                                                bool x_579340 = cond_579338 && zlze_res_579339;
                                                bool x_579341 = !cond_579337;
                                                bool y_579342 = x_579340 && x_579341;
                                                bool defunc_0_leq_res_579343 = cond_579337 || y_579342;
                                                
                                                leq_y_x_579319 = defunc_0_leq_res_579343;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579344;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579345;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579346;
                                            
                                            if (leq_y_x_579319) {
                                                int64_t tmp_585619 = add64(tt_579263, n_579312);
                                                int64_t tmp_585620 = sub64(count_579265, n_579312);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579344 = tmp_585619;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579345 = tt_579264;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579346 = tmp_585620;
                                            } else {
                                                int64_t tmp_579349 = add64(tt_579263, n_579312);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579344 = tt_579263;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579345 = tmp_579349;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579346 = count_579265;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_579281 = ss_579261;
                                            defunc_0_lifted_step_res_f_res_f_res_579282 = defunc_0_lifted_step_res_f_res_f_res_f_res_579344;
                                            defunc_0_lifted_step_res_f_res_f_res_579283 = defunc_0_lifted_step_res_f_res_f_res_f_res_579345;
                                            defunc_0_lifted_step_res_f_res_f_res_579284 = defunc_0_lifted_step_res_f_res_f_res_f_res_579346;
                                        }
                                        defunc_0_lifted_step_res_f_res_579275 = defunc_0_lifted_step_res_f_res_f_res_579281;
                                        defunc_0_lifted_step_res_f_res_579276 = defunc_0_lifted_step_res_f_res_f_res_579282;
                                        defunc_0_lifted_step_res_f_res_579277 = defunc_0_lifted_step_res_f_res_f_res_579283;
                                        defunc_0_lifted_step_res_f_res_579278 = defunc_0_lifted_step_res_f_res_f_res_579284;
                                    }
                                    defunc_0_lifted_step_res_579268 = defunc_0_lifted_step_res_f_res_579275;
                                    defunc_0_lifted_step_res_579269 = defunc_0_lifted_step_res_f_res_579276;
                                    defunc_0_lifted_step_res_579270 = defunc_0_lifted_step_res_f_res_579277;
                                    defunc_0_lifted_step_res_579271 = defunc_0_lifted_step_res_f_res_579278;
                                }
                                
                                int64_t loopres_579350;
                                int64_t loopres_579351;
                                int64_t loopres_579352;
                                int64_t loopres_579353;
                                int64_t loopres_579354;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_579350, &loopres_579351, &loopres_579352, &loopres_579353, &loopres_579354, defunc_0_lifted_step_res_579268, ss_579262, defunc_0_lifted_step_res_579269, defunc_0_lifted_step_res_579270, defunc_0_lifted_step_res_579271) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_579355 = slt64((int64_t) 0, loopres_579354);
                                bool loop_while_tmp_588150 = loop_cond_579355;
                                int64_t ss_tmp_588151 = loopres_579350;
                                int64_t ss_tmp_588152 = loopres_579351;
                                int64_t tt_tmp_588153 = loopres_579352;
                                int64_t tt_tmp_588154 = loopres_579353;
                                int64_t count_tmp_588155 = loopres_579354;
                                
                                loop_while_579260 = loop_while_tmp_588150;
                                ss_579261 = ss_tmp_588151;
                                ss_579262 = ss_tmp_588152;
                                tt_579263 = tt_tmp_588153;
                                tt_579264 = tt_tmp_588154;
                                count_579265 = count_tmp_588155;
                            }
                            defunc_0_split_count_res_579254 = loop_while_579260;
                            defunc_0_split_count_res_579255 = ss_579261;
                            defunc_0_split_count_res_579256 = ss_579262;
                            defunc_0_split_count_res_579257 = tt_579263;
                            defunc_0_split_count_res_579258 = tt_579264;
                            defunc_0_split_count_res_579259 = count_579265;
                            ((int64_t *) mem_586726)[i_586192] = defunc_0_split_count_res_579255;
                            ((int64_t *) mem_586728)[i_586192] = defunc_0_split_count_res_579257;
                        }
                        if (mem_586743_cached_sizze_589016 < bytes_586742) {
                            err = lexical_realloc(ctx, &mem_586743, &mem_586743_cached_sizze_589016, bytes_586742);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586746_cached_sizze_589017 < bytes_586742) {
                            err = lexical_realloc(ctx, &mem_586746, &mem_586746_cached_sizze_589017, bytes_586742);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586750_cached_sizze_589018 < bytes_586749) {
                            err = lexical_realloc(ctx, &mem_586750, &mem_586750_cached_sizze_589018, bytes_586749);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586753_cached_sizze_589019 < bytes_586742) {
                            err = lexical_realloc(ctx, &mem_586753, &mem_586753_cached_sizze_589019, bytes_586742);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586203 = 0; i_586203 < num_blocks_579083; i_586203++) {
                            bool y_579363 = slt64(i_586203, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084);
                            bool index_certs_579365;
                            
                            if (!y_579363) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586203, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_579366 = ((int64_t *) mem_586726)[i_586203];
                            int64_t defunc_0_f_res_579367 = ((int64_t *) mem_586728)[i_586203];
                            int64_t tmp_579368 = add64((int64_t) 1, i_586203);
                            bool x_579369 = sle64((int64_t) 0, tmp_579368);
                            bool y_579370 = slt64(tmp_579368, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084);
                            bool bounds_check_579371 = x_579369 && y_579370;
                            bool index_certs_579372;
                            
                            if (!bounds_check_579371) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_579368, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_579373 = ((int64_t *) mem_586726)[tmp_579368];
                            int64_t defunc_0_f_res_579374 = ((int64_t *) mem_586728)[tmp_579368];
                            int64_t merge_sequential_arg2_579375 = add64(stride_579061, defunc_0_f_res_579367);
                            int64_t merge_sequential_arg2_579376 = add64(stride_579061, defunc_0_f_res_579374);
                            int64_t j_m_i_579377 = sub64(merge_sequential_arg2_579376, merge_sequential_arg2_579375);
                            bool empty_slice_579378 = j_m_i_579377 == (int64_t) 0;
                            int64_t m_579379 = sub64(j_m_i_579377, (int64_t) 1);
                            int64_t i_p_m_t_s_579380 = add64(merge_sequential_arg2_579375, m_579379);
                            bool zzero_leq_i_p_m_t_s_579381 = sle64((int64_t) 0, i_p_m_t_s_579380);
                            bool i_p_m_t_s_leq_w_579382 = slt64(i_p_m_t_s_579380, next_stride_579062);
                            bool zzero_lte_i_579383 = sle64((int64_t) 0, merge_sequential_arg2_579375);
                            bool i_lte_j_579384 = sle64(merge_sequential_arg2_579375, merge_sequential_arg2_579376);
                            bool y_579385 = i_p_m_t_s_leq_w_579382 && zzero_lte_i_579383;
                            bool y_579386 = zzero_leq_i_p_m_t_s_579381 && y_579385;
                            bool forwards_ok_579387 = i_lte_j_579384 && y_579386;
                            bool ok_or_empty_579388 = empty_slice_579378 || forwards_ok_579387;
                            bool index_certs_579389;
                            
                            if (!ok_or_empty_579388) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_579375, ":", (long long) merge_sequential_arg2_579376, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_579390 = sub64(defunc_0_f_res_579373, defunc_0_f_res_579366);
                            bool empty_slice_579391 = j_m_i_579390 == (int64_t) 0;
                            int64_t m_579392 = sub64(j_m_i_579390, (int64_t) 1);
                            int64_t i_p_m_t_s_579393 = add64(defunc_0_f_res_579366, m_579392);
                            bool zzero_leq_i_p_m_t_s_579394 = sle64((int64_t) 0, i_p_m_t_s_579393);
                            bool i_p_m_t_s_leq_w_579395 = slt64(i_p_m_t_s_579393, next_stride_579062);
                            bool zzero_lte_i_579396 = sle64((int64_t) 0, defunc_0_f_res_579366);
                            bool i_lte_j_579397 = sle64(defunc_0_f_res_579366, defunc_0_f_res_579373);
                            bool y_579398 = i_p_m_t_s_leq_w_579395 && zzero_lte_i_579396;
                            bool y_579399 = zzero_leq_i_p_m_t_s_579394 && y_579398;
                            bool forwards_ok_579400 = i_lte_j_579397 && y_579399;
                            bool ok_or_empty_579401 = empty_slice_579391 || forwards_ok_579400;
                            bool index_certs_579402;
                            
                            if (!ok_or_empty_579401) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_579366, ":", (long long) defunc_0_f_res_579373, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:790:33-56\n   #10 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_579403 = slt64((int64_t) 0, j_m_i_579390);
                            bool y_579414 = slt64((int64_t) 0, j_m_i_579377);
                            bool protect_assert_disj_587750 = cond_579403 || y_579414;
                            bool index_certs_579415;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:790:33-56\n   #12 ftSkyline.fut:779:17-790:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_579416 = start_579137 + merge_sequential_arg2_579375;
                            int64_t binop_y_586772 = dim_251930 * slice_579416;
                            int64_t slice_585622 = start_579137 + defunc_0_f_res_579366;
                            int64_t binop_y_586774 = dim_251930 * slice_585622;
                            int64_t ext_586776;
                            
                            if (cond_579403) {
                                ext_586776 = binop_y_586774;
                            } else {
                                ext_586776 = binop_y_586772;
                            }
                            
                            int64_t dummy_579404;
                            double dummy_579405;
                            int64_t dummy_579407;
                            
                            if (cond_579403) {
                                int64_t head_res_585623 = ((int64_t *) mem_param_586683.mem)[slice_585622];
                                double head_res_585624 = ((double *) mem_param_586686.mem)[slice_585622];
                                int64_t head_res_585626 = ((int64_t *) mem_param_586693.mem)[slice_585622];
                                
                                dummy_579404 = head_res_585623;
                                dummy_579405 = head_res_585624;
                                dummy_579407 = head_res_585626;
                            } else {
                                int64_t head_res_579417 = ((int64_t *) mem_param_586683.mem)[slice_579416];
                                double head_res_579418 = ((double *) mem_param_586686.mem)[slice_579416];
                                int64_t head_res_579420 = ((int64_t *) mem_param_586693.mem)[slice_579416];
                                
                                dummy_579404 = head_res_579417;
                                dummy_579405 = head_res_579418;
                                dummy_579407 = head_res_579420;
                            }
                            for (int64_t nest_i_588160 = 0; nest_i_588160 < merge_block_sizze_578882; nest_i_588160++) {
                                ((int64_t *) mem_586743)[i_586203 * merge_block_sizze_578882 + nest_i_588160] = dummy_579404;
                            }
                            for (int64_t nest_i_588161 = 0; nest_i_588161 < merge_block_sizze_578882; nest_i_588161++) {
                                ((double *) mem_586746)[i_586203 * merge_block_sizze_578882 + nest_i_588161] = dummy_579405;
                            }
                            for (int64_t nest_i_588162 = 0; nest_i_588162 < merge_block_sizze_578882; nest_i_588162++) {
                                ((int64_t *) mem_586753)[i_586203 * merge_block_sizze_578882 + nest_i_588162] = dummy_579407;
                            }
                            for (int64_t nest_i_588163 = 0; nest_i_588163 < merge_block_sizze_578882; nest_i_588163++) {
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586750, i_586203 * lmad_arg_586771 + nest_i_588163 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586690.mem, ext_586776, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                            }
                            
                            int64_t data_579425;
                            int64_t i_579431 = (int64_t) 0;
                            
                            for (int64_t k_579430 = 0; k_579430 < merge_block_sizze_578882; k_579430++) {
                                int64_t j_579436 = sub64(k_579430, i_579431);
                                bool cond_579437 = j_579436 == j_m_i_579377;
                                bool x_587846 = !cond_579437;
                                bool cond_579439 = slt64(i_579431, j_m_i_579390);
                                bool x_585627 = sle64((int64_t) 0, j_579436);
                                bool y_585628 = slt64(j_579436, j_m_i_579377);
                                bool bounds_check_585629 = x_585627 && y_585628;
                                bool loop_not_taken_587834 = !cond_579439;
                                bool protect_assert_disj_587835 = bounds_check_585629 || loop_not_taken_587834;
                                bool protect_assert_disj_587849 = cond_579437 || protect_assert_disj_587835;
                                bool index_certs_585630;
                                
                                if (!protect_assert_disj_587849) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_579436, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585631 = merge_sequential_arg2_579375 + j_579436;
                                int64_t slice_585632 = start_579137 + slice_585631;
                                bool protect_cond_conj_587850 = cond_579439 && x_587846;
                                int64_t leq_arg1_585633;
                                
                                if (protect_cond_conj_587850) {
                                    int64_t x_587836 = ((int64_t *) mem_param_586683.mem)[slice_585632];
                                    
                                    leq_arg1_585633 = x_587836;
                                } else {
                                    leq_arg1_585633 = (int64_t) 0;
                                }
                                
                                double leq_arg1_585634;
                                
                                if (protect_cond_conj_587850) {
                                    double x_587838 = ((double *) mem_param_586686.mem)[slice_585632];
                                    
                                    leq_arg1_585634 = x_587838;
                                } else {
                                    leq_arg1_585634 = 0.0;
                                }
                                
                                bool x_585635 = sle64((int64_t) 0, i_579431);
                                bool bounds_check_585636 = cond_579439 && x_585635;
                                bool protect_assert_disj_587841 = bounds_check_585636 || loop_not_taken_587834;
                                bool protect_assert_disj_587853 = cond_579437 || protect_assert_disj_587841;
                                bool index_certs_585637;
                                
                                if (!protect_assert_disj_587853) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579431, "] out of bounds for array of shape [", (long long) j_m_i_579390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585638 = defunc_0_f_res_579366 + i_579431;
                                int64_t slice_585639 = start_579137 + slice_585638;
                                int64_t leq_arg0_585640;
                                
                                if (protect_cond_conj_587850) {
                                    int64_t x_587842 = ((int64_t *) mem_param_586683.mem)[slice_585639];
                                    
                                    leq_arg0_585640 = x_587842;
                                } else {
                                    leq_arg0_585640 = (int64_t) 0;
                                }
                                
                                double leq_arg0_585641;
                                
                                if (protect_cond_conj_587850) {
                                    double x_587844 = ((double *) mem_param_586686.mem)[slice_585639];
                                    
                                    leq_arg0_585641 = x_587844;
                                } else {
                                    leq_arg0_585641 = 0.0;
                                }
                                
                                bool cond_585642 = slt64(leq_arg0_585640, leq_arg1_585633);
                                bool cond_585643 = leq_arg0_585640 == leq_arg1_585633;
                                bool zlze_res_585644 = leq_arg0_585641 <= leq_arg1_585634;
                                bool x_585645 = cond_585643 && zlze_res_585644;
                                bool x_585646 = !cond_585642;
                                bool y_585647 = x_585645 && x_585646;
                                bool defunc_0_leq_res_585648 = cond_585642 || y_585647;
                                bool x_587868 = cond_579439 && defunc_0_leq_res_585648;
                                bool cond_579438 = cond_579437 || x_587868;
                                bool protect_assert_disj_587742 = cond_579438 || bounds_check_585629;
                                bool index_certs_579482;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_579436, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585652 = cond_579439 && x_585635;
                                bool loop_not_taken_587737 = !cond_579438;
                                bool protect_assert_disj_587738 = bounds_check_585652 || loop_not_taken_587737;
                                bool index_certs_585653;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579431, "] out of bounds for array of shape [", (long long) j_m_i_579390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:790:33-56\n   #11 ftSkyline.fut:779:17-790:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_579484 = start_579137 + slice_585631;
                                int64_t binop_y_586799 = dim_251930 * slice_579484;
                                int64_t slice_585655 = start_579137 + slice_585638;
                                int64_t binop_y_586801 = dim_251930 * slice_585655;
                                int64_t ext_586803;
                                
                                if (cond_579438) {
                                    ext_586803 = binop_y_586801;
                                } else {
                                    ext_586803 = binop_y_586799;
                                }
                                
                                int64_t loopres_579463;
                                int64_t loopres_579464;
                                double loopres_579465;
                                int64_t loopres_579467;
                                
                                if (cond_579438) {
                                    int64_t tmp_585649 = add64((int64_t) 1, i_579431);
                                    int64_t tmp_585656 = ((int64_t *) mem_param_586683.mem)[slice_585655];
                                    double tmp_585657 = ((double *) mem_param_586686.mem)[slice_585655];
                                    int64_t tmp_585659 = ((int64_t *) mem_param_586693.mem)[slice_585655];
                                    
                                    loopres_579463 = tmp_585649;
                                    loopres_579464 = tmp_585656;
                                    loopres_579465 = tmp_585657;
                                    loopres_579467 = tmp_585659;
                                } else {
                                    int64_t tmp_579485 = ((int64_t *) mem_param_586683.mem)[slice_579484];
                                    double tmp_579486 = ((double *) mem_param_586686.mem)[slice_579484];
                                    int64_t tmp_579488 = ((int64_t *) mem_param_586693.mem)[slice_579484];
                                    
                                    loopres_579463 = i_579431;
                                    loopres_579464 = tmp_579485;
                                    loopres_579465 = tmp_579486;
                                    loopres_579467 = tmp_579488;
                                }
                                ((int64_t *) mem_586743)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579464;
                                ((double *) mem_586746)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579465;
                                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586750, i_586203 * lmad_arg_586771 + k_579430 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_586690.mem, ext_586803, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
                                ((int64_t *) mem_586753)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579467;
                                
                                int64_t i_tmp_588164 = loopres_579463;
                                
                                i_579431 = i_tmp_588164;
                            }
                            data_579425 = i_579431;
                        }
                        if (memblock_alloc(ctx, &mem_586836, bytes_586742, "mem_586836")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586836.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint64_t *) mem_586743, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_alloc(ctx, &mem_586840, bytes_586742, "mem_586840")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586840.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint64_t *) mem_586746, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_alloc(ctx, &mem_586845, bytes_586749, "mem_586845")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 3, (uint64_t *) mem_586845.mem, (int64_t) 0, (int64_t []) {dim_251930 * merge_block_sizze_578882, dim_251930, (int64_t) 1}, (uint64_t *) mem_586750, (int64_t) 0, (int64_t []) {lmad_arg_586771, dim_251930, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882, dim_251930});
                        if (memblock_alloc(ctx, &mem_586849, bytes_586742, "mem_586849")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586849.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint64_t *) mem_586753, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_set(ctx, &ext_mem_586908, &mem_586836, "mem_586836") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586905, &mem_586840, "mem_586840") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586902, &mem_586845, "mem_586845") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586898, &mem_586849, "mem_586849") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586696, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586908.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586908, "ext_mem_586908") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586699, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586905.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586905, "ext_mem_586905") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_586703, i_586216 * lmad_arg_586724, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) ext_mem_586902.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {next_stride_579062, dim_251930});
                    if (memblock_unref(ctx, &ext_mem_586902, "ext_mem_586902") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586706, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586898.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586898, "ext_mem_586898") != 0)
                        return 1;
                }
                
                int64_t flat_dim_579501 = next_stride_579062 * num_merges_579066;
                
                if (memblock_alloc(ctx, &mem_586928, bytes_586695, "mem_586928")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586928.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint64_t *) mem_586696, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                if (memblock_alloc(ctx, &mem_586932, bytes_586695, "mem_586932")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586932.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint64_t *) mem_586699, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                if (memblock_alloc(ctx, &mem_586937, bytes_586702, "mem_586937")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 3, (uint64_t *) mem_586937.mem, (int64_t) 0, (int64_t []) {dim_251930 * next_stride_579062, dim_251930, (int64_t) 1}, (uint64_t *) mem_586703, (int64_t) 0, (int64_t []) {lmad_arg_586724, dim_251930, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062, dim_251930});
                if (memblock_alloc(ctx, &mem_586941, bytes_586695, "mem_586941")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586941.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint64_t *) mem_586706, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                
                bool loop_cond_579508 = slt64(next_stride_579062, flat_dim_578876);
                
                if (memblock_set(ctx, &mem_param_tmp_588124, &mem_586928, "mem_586928") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588125, &mem_586932, "mem_586932") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588126, &mem_586937, "mem_586937") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588127, &mem_586941, "mem_586941") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588128 = flat_dim_579501;
                bool loop_while_tmp_588129 = loop_cond_579508;
                int64_t stride_tmp_588134 = next_stride_579062;
                
                if (memblock_set(ctx, &mem_param_586683, &mem_param_tmp_588124, "mem_param_tmp_588124") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586686, &mem_param_tmp_588125, "mem_param_tmp_588125") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586690, &mem_param_tmp_588126, "mem_param_tmp_588126") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586693, &mem_param_tmp_588127, "mem_param_tmp_588127") != 0)
                    return 1;
                loop_dz2084Uz2082U_579055 = loop_dz2084Uz2082U_tmp_588128;
                loop_while_579056 = loop_while_tmp_588129;
                stride_579061 = stride_tmp_588134;
            }
            if (memblock_set(ctx, &ext_mem_586955, &mem_param_586683, "mem_param_586683") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586954, &mem_param_586686, "mem_param_586686") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586953, &mem_param_586690, "mem_param_586690") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586952, &mem_param_586693, "mem_param_586693") != 0)
                return 1;
            data_579048 = loop_dz2084Uz2082U_579055;
            data_579049 = loop_while_579056;
            data_579054 = stride_579061;
            if (memblock_unref(ctx, &mem_586666, "mem_586666") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586670, "mem_586670") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586679, "mem_586679") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_579511 = slt64(zs_lhs_578851, data_579048);
            bool y_579512 = zzero_leq_i_p_m_t_s_579510 && i_p_m_t_s_leq_w_579511;
            bool ok_or_empty_579513 = empty_slice_579509 || y_579512;
            bool index_certs_579514;
            
            if (!ok_or_empty_579513) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_251933, "] out of bounds for array of shape [", (long long) data_579048, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_586962, &ext_mem_586953, "ext_mem_586953") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586958, &ext_mem_586952, "ext_mem_586952") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_586964, bytes_586418, "mem_586964")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586964.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_251933});
        if (memblock_unref(ctx, &ext_mem_586958, "ext_mem_586958") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_586967, bytes_586966, "mem_586967")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586967.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) ext_mem_586962.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {n_251933, dim_251930});
        if (memblock_unref(ctx, &ext_mem_586962, "ext_mem_586962") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587402, &mem_586967, "mem_586967") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587401, &mem_586964, "mem_586964") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_585698;
    int64_t redout_586221 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586222 = 0; i_586222 < dim_251930; i_586222++) {
        int64_t x_579529 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586222];
        int64_t min_res_579532 = smin64(x_579529, redout_586221);
        int64_t redout_tmp_588169 = min_res_579532;
        
        redout_586221 = redout_tmp_588169;
    }
    defunc_0_reduce_res_585698 = redout_586221;
    
    bool cond_579533 = defunc_0_reduce_res_585698 == (int64_t) 1;
    bool bounds_invalid_upwards_579534 = slt64(total_grid_no_251941, (int64_t) 0);
    bool valid_579535 = !bounds_invalid_upwards_579534;
    bool protect_assert_disj_579536 = cond_579533 || valid_579535;
    bool range_valid_c_579537;
    
    if (!protect_assert_disj_579536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_251941, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582357 = y_578724 || cond_579533;
    bool index_certs_579544;
    
    if (!protect_assert_disj_582357) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:790:33-56\n   #4  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587403 = (int64_t) 4 * total_grid_no_251941;
    
    if (cond_579533) {
        if (memblock_alloc(ctx, &mem_587440, total_grid_no_251941, "mem_587440")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588170 = 0; nest_i_588170 < total_grid_no_251941; nest_i_588170++) {
            ((bool *) mem_587440.mem)[nest_i_588170] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587443, &mem_587440, "mem_587440") != 0)
            return 1;
    } else {
        if (mem_587404_cached_sizze_589043 < bytes_587403) {
            err = lexical_realloc(ctx, &mem_587404, &mem_587404_cached_sizze_589043, bytes_587403);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588171 = 0; nest_i_588171 < total_grid_no_251941; nest_i_588171++) {
            ((int32_t *) mem_587404)[nest_i_588171] = 0;
        }
        if (mem_587409_cached_sizze_589044 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_587409, &mem_587409_cached_sizze_589044, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586227 = 0; iter_586227 < n_251933; iter_586227++) {
            for (int64_t i_586225 = 0; i_586225 < dim_251930; i_586225++) {
                double eta_p_584429 = ((double *) ext_mem_587402.mem)[iter_586227 * dim_251930 + i_586225];
                double eta_p_584430 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586225];
                double eta_p_584431 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586225];
                int64_t eta_p_584433 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586225];
                double defunc_0_f_res_584434 = eta_p_584429 - eta_p_584430;
                double defunc_0_f_res_584436 = defunc_0_f_res_584434 / eta_p_584431;
                int64_t f64_res_584438 = fptosi_f64_i64(defunc_0_f_res_584436);
                int64_t max_res_584440 = smax64((int64_t) 0, f64_res_584438);
                int64_t zm_lhs_584446 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586225];
                int64_t min_arg1_584447 = sub64(zm_lhs_584446, (int64_t) 1);
                int64_t min_res_584448 = smin64(max_res_584440, min_arg1_584447);
                int64_t defunc_0_f_res_584450 = mul64(eta_p_584433, min_res_584448);
                
                ((int64_t *) mem_587409)[i_586225] = defunc_0_f_res_584450;
            }
            
            int64_t defunc_0_foldl_res_584357;
            int64_t acc_584359 = (int64_t) 0;
            
            for (int64_t i_584358 = 0; i_584358 < dim_251930; i_584358++) {
                int64_t b_584360 = ((int64_t *) mem_587409)[i_584358];
                int64_t defunc_0_f_res_584361 = add64(acc_584359, b_584360);
                int64_t acc_tmp_588174 = defunc_0_f_res_584361;
                
                acc_584359 = acc_tmp_588174;
            }
            defunc_0_foldl_res_584357 = acc_584359;
            
            bool less_than_zzero_586231 = slt64(defunc_0_foldl_res_584357, (int64_t) 0);
            bool greater_than_sizze_586232 = sle64(total_grid_no_251941, defunc_0_foldl_res_584357);
            bool outside_bounds_dim_586233 = less_than_zzero_586231 || greater_than_sizze_586232;
            
            if (!outside_bounds_dim_586233) {
                int32_t read_hist_586235 = ((int32_t *) mem_587404)[defunc_0_foldl_res_584357];
                int32_t defunc_0_op_res_579584 = add32(1, read_hist_586235);
                
                ((int32_t *) mem_587404)[defunc_0_foldl_res_584357] = defunc_0_op_res_579584;
            }
        }
        if (memblock_alloc(ctx, &mem_587419, total_grid_no_251941, "mem_587419")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588175 = 0; nest_i_588175 < total_grid_no_251941; nest_i_588175++) {
            ((bool *) mem_587419.mem)[nest_i_588175] = 0;
        }
        if (mem_587423_cached_sizze_589045 < dim_251930) {
            err = lexical_realloc(ctx, &mem_587423, &mem_587423_cached_sizze_589045, dim_251930);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_579589 = 0; i_579589 < total_grid_no_251941; i_579589++) {
            for (int64_t i_586240 = 0; i_586240 < dim_251930; i_586240++) {
                int64_t eta_p_579592 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586240];
                int64_t eta_p_579593 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586240];
                bool defunc_0_f_res_579594;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_579594, i_579589, eta_p_579592, eta_p_579593) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587423)[i_586240] = defunc_0_f_res_579594;
            }
            
            bool defunc_0_f_res_579595;
            bool acc_579597 = 0;
            
            for (int64_t i_579596 = 0; i_579596 < dim_251930; i_579596++) {
                bool b_579598 = ((bool *) mem_587423)[i_579596];
                bool defunc_0_f_res_579599 = acc_579597 || b_579598;
                bool acc_tmp_588178 = defunc_0_f_res_579599;
                
                acc_579597 = acc_tmp_588178;
            }
            defunc_0_f_res_579595 = acc_579597;
            if (!defunc_0_f_res_579595) {
                bool y_579601 = slt64(i_579589, dz2080U_251931);
                bool index_certs_579602;
                
                if (!y_579601) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579589, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:790:33-56\n   #2  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_579604 = slt64(i_579589, (int64_t) 0);
                bool valid_579605 = !bounds_invalid_upwards_579604;
                bool range_valid_c_579606;
                
                if (!valid_579605) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_579589, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_585685;
                bool redout_586246 = 0;
                
                for (int64_t i_586247 = 0; i_586247 < i_579589; i_586247++) {
                    bool cond_584454 = i_586247 == i_579589;
                    bool cond_584455;
                    
                    if (cond_584454) {
                        cond_584455 = 1;
                    } else {
                        bool y_584457 = slt64(i_586247, total_grid_no_251941);
                        bool index_certs_584459;
                        
                        if (!y_584457) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586247, "] out of bounds for array of shape [", (long long) total_grid_no_251941, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584460 = ((int32_t *) mem_587404)[i_586247];
                        bool cond_f_res_584461 = zeze_lhs_584460 == 0;
                        
                        cond_584455 = cond_f_res_584461;
                    }
                    
                    bool defunc_0_f_res_584462;
                    
                    if (cond_584455) {
                        defunc_0_f_res_584462 = 0;
                    } else {
                        bool y_584464 = slt64(i_586247, dz2080U_251931);
                        bool index_certs_584466;
                        
                        if (!y_584464) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586247, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587430_cached_sizze_589046 < dim_251930) {
                            err = lexical_realloc(ctx, &mem_587430, &mem_587430_cached_sizze_589046, dim_251930);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586244 = 0; i_586244 < dim_251930; i_586244++) {
                            double eta_p_584469 = ((double *) start_of_grid_partition_mem_586416.mem)[i_579589 * dim_251930 + i_586244];
                            double eta_p_584470 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586247 * dim_251930 + i_586244];
                            bool defunc_0_f_res_584471 = eta_p_584470 < eta_p_584469;
                            
                            ((bool *) mem_587430)[i_586244] = defunc_0_f_res_584471;
                        }
                        
                        bool defunc_0_foldl_res_584472;
                        bool acc_584474 = 1;
                        
                        for (int64_t i_584473 = 0; i_584473 < dim_251930; i_584473++) {
                            bool b_584475 = ((bool *) mem_587430)[i_584473];
                            bool x_584476 = acc_584474 && b_584475;
                            bool acc_tmp_588181 = x_584476;
                            
                            acc_584474 = acc_tmp_588181;
                        }
                        defunc_0_foldl_res_584472 = acc_584474;
                        defunc_0_f_res_584462 = defunc_0_foldl_res_584472;
                    }
                    
                    bool defunc_0_op_res_579640 = defunc_0_f_res_584462 || redout_586246;
                    bool redout_tmp_588179 = defunc_0_op_res_579640;
                    
                    redout_586246 = redout_tmp_588179;
                }
                defunc_0_reduce_res_585685 = redout_586246;
                ((bool *) mem_587419.mem)[i_579589] = defunc_0_reduce_res_585685;
            }
        }
        if (memblock_set(ctx, &ext_mem_587443, &mem_587419, "mem_587419") != 0)
            return 1;
    }
    
    bool index_certs_579653;
    
    if (!y_578724) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587445_cached_sizze_589047 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_587445, &mem_587445_cached_sizze_589047, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586250 = 0; i_586250 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932; i_586250++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_579733 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586250];
        double i64_res_579734 = sitofp_i64_f64(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_579733);
        double defunc_0_fover_res_579735 = 1.5707963267948966 / i64_res_579734;
        
        ((double *) mem_587445)[i_586250] = defunc_0_fover_res_579735;
    }
    
    bool empty_or_match_cert_579737;
    
    if (!assert_cond_578019) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_579774 = total_angle_no_251940 == (int64_t) 0;
    bool nonzzero_579775 = !zzero_579774;
    bool nonzzero_cert_579776;
    
    if (!nonzzero_579775) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:790:33-56\n   #6  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587453_cached_sizze_589048 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587453, &mem_587453_cached_sizze_589048, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587455_cached_sizze_589049 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587455, &mem_587455_cached_sizze_589049, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587457_cached_sizze_589050 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587457, &mem_587457_cached_sizze_589050, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587468_cached_sizze_589051 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_587468, &mem_587468_cached_sizze_589051, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587476_cached_sizze_589052 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_587476, &mem_587476_cached_sizze_589052, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587484_cached_sizze_589053 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_587484, &mem_587484_cached_sizze_589053, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587500_cached_sizze_589055 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_587500, &mem_587500_cached_sizze_589055, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586279;
    int64_t scanacc_586271 = (int64_t) 0;
    
    for (int64_t i_586275 = 0; i_586275 < n_251933; i_586275++) {
        for (int64_t i_586254 = 0; i_586254 < dim_251930; i_586254++) {
            double eta_p_584559 = ((double *) ext_mem_587402.mem)[i_586275 * dim_251930 + i_586254];
            double eta_p_584560 = ((double *) start_of_grid_partition_mem_586416.mem)[i_586254];
            double eta_p_584561 = ((double *) grid_part_sizze_per_dim_mem_586414.mem)[i_586254];
            int64_t eta_p_584563 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586254];
            double defunc_0_f_res_584564 = eta_p_584559 - eta_p_584560;
            double defunc_0_f_res_584566 = defunc_0_f_res_584564 / eta_p_584561;
            int64_t f64_res_584568 = fptosi_f64_i64(defunc_0_f_res_584566);
            int64_t max_res_584570 = smax64((int64_t) 0, f64_res_584568);
            int64_t zm_lhs_584576 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586254];
            int64_t min_arg1_584577 = sub64(zm_lhs_584576, (int64_t) 1);
            int64_t min_res_584578 = smin64(max_res_584570, min_arg1_584577);
            int64_t defunc_0_f_res_584580 = mul64(eta_p_584563, min_res_584578);
            
            ((int64_t *) mem_587468)[i_586254] = defunc_0_f_res_584580;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_251930; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587468)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588188 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588188;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_251931);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_251931, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586258 = 0; i_586258 < dim_251930; i_586258++) {
            double eta_p_582571 = ((double *) ext_mem_587402.mem)[i_586275 * dim_251930 + i_586258];
            double eta_p_582572 = ((double *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582560 * dim_251930 + i_586258];
            double defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((double *) mem_587476)[i_586258] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < arg_578018; nest_i_588190++) {
            ((double *) mem_587484)[nest_i_588190] = 0.0;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_578018; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_251930);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_251930, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_251930);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_251930);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_251930, "] out of bounds for array of shape [", (long long) dim_251930, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587488 = (int64_t) 8 * j_m_i_582582;
            double this_x_582580 = ((double *) mem_587476)[i_582576];
            
            if (mem_587489_cached_sizze_589054 < bytes_587488) {
                err = lexical_realloc(ctx, &mem_587489, &mem_587489_cached_sizze_589054, bytes_587488);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586262 = 0; i_586262 < j_m_i_582582; i_586262++) {
                int64_t slice_586364 = map_arg1_582581 + i_586262;
                double eta_p_582597 = ((double *) mem_587476)[slice_586364];
                double defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((double *) mem_587489)[i_586262] = defunc_0_ftimes_res_582598;
            }
            
            double defunc_0_foldl_res_582599;
            double acc_582601 = 0.0;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                double b_582602 = ((double *) mem_587489)[i_582600];
                double defunc_0_f_res_582603 = acc_582601 + b_582602;
                double acc_tmp_588193 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588193;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            double sqrt_res_582604 = futrts_sqrt64(defunc_0_foldl_res_582599);
            double atan2_res_582605 = futrts_atan2_64(sqrt_res_582604, this_x_582580);
            
            ((double *) mem_587484)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586266 = 0; i_586266 < arg_578018; i_586266++) {
            double eta_p_582608 = ((double *) mem_587484)[i_586266];
            double eta_p_582609 = ((double *) mem_587445)[i_586266];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586266];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586266];
            double i64_res_582612 = sitofp_i64_f64(eta_p_582610);
            double defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            double defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f64_res_582615 = fptosi_f64_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f64_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f64_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_585690 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_585690;
                } else {
                    defunc_0_f_res_f_res_582619 = f64_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587500)[i_586266] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_578018; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587500)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588195 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588195;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_251940, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_251940);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_251941);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_251941, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:790:33-56\n   #5  ftSkyline.fut:779:17-790:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587443.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_579791 = add64(defunc_0_f_res_582636, scanacc_586271);
        
        ((int64_t *) mem_587453)[i_586275] = defunc_0_op_res_579791;
        ((int64_t *) mem_587455)[i_586275] = defunc_0_f_res_582636;
        ((int64_t *) mem_587457)[i_586275] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588183 = defunc_0_op_res_579791;
        
        scanacc_586271 = scanacc_tmp_588183;
    }
    discard_586279 = scanacc_586271;
    
    bool x_579793 = !empty_slice_579509;
    bool y_579796 = slt64(zs_lhs_578851, n_251933);
    bool bounds_check_579797 = zzero_leq_i_p_m_t_s_579510 && y_579796;
    bool protect_assert_disj_579798 = empty_slice_579509 || bounds_check_579797;
    bool index_certs_579799;
    
    if (!protect_assert_disj_579798) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zs_lhs_578851, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_579800;
    
    if (x_579793) {
        int64_t x_585695 = ((int64_t *) mem_587453)[zs_lhs_578851];
        
        m_f_res_579800 = x_585695;
    } else {
        m_f_res_579800 = (int64_t) 0;
    }
    
    int64_t m_579802;
    
    if (empty_slice_579509) {
        m_579802 = (int64_t) 0;
    } else {
        m_579802 = m_f_res_579800;
    }
    
    int64_t m_579813 = sub64(m_579802, (int64_t) 1);
    bool i_p_m_t_s_leq_w_579815 = slt64(m_579813, n_251933);
    bool zzero_leq_i_p_m_t_s_579814 = sle64((int64_t) 0, m_579813);
    bool y_579817 = zzero_leq_i_p_m_t_s_579814 && i_p_m_t_s_leq_w_579815;
    bool i_lte_j_579816 = sle64((int64_t) 0, m_579802);
    bool forwards_ok_579818 = i_lte_j_579816 && y_579817;
    bool eq_x_zz_579809 = (int64_t) 0 == m_f_res_579800;
    bool p_and_eq_x_y_579811 = x_579793 && eq_x_zz_579809;
    bool empty_slice_579812 = empty_slice_579509 || p_and_eq_x_y_579811;
    bool ok_or_empty_579819 = empty_slice_579812 || forwards_ok_579818;
    bool index_certs_579820;
    
    if (!ok_or_empty_579819) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_579802, "] out of bounds for array of shape [", (long long) n_251933, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587516 = (int64_t) 8 * m_579802;
    int64_t bytes_587517 = dim_251930 * binop_x_587516;
    bool bounds_invalid_upwards_579852 = slt64(total_part_no_251942, (int64_t) 0);
    bool valid_579853 = !bounds_invalid_upwards_579852;
    bool range_valid_c_579854;
    
    if (!valid_579853) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_251942, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:790:33-56\n   #3  ftSkyline.fut:779:17-790:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587545 = (int64_t) 8 * total_part_no_251942;
    
    if (memblock_alloc(ctx, &mem_587518, bytes_587517, "mem_587518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 2, (uint64_t *) mem_587518.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (uint64_t *) ext_mem_587402.mem, (int64_t) 0, (int64_t []) {dim_251930, (int64_t) 1}, (int64_t []) {m_579802, dim_251930});
    if (mem_587520_cached_sizze_589056 < binop_x_587516) {
        err = lexical_realloc(ctx, &mem_587520, &mem_587520_cached_sizze_589056, binop_x_587516);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587520, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587457, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_579802});
    if (memblock_alloc(ctx, &mem_587522, binop_x_587516, "mem_587522")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587522.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587401.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_579802});
    if (mem_587534_cached_sizze_589057 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_587534, &mem_587534_cached_sizze_589057, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586280 = 0; write_iter_586280 < n_251933; write_iter_586280++) {
        int64_t write_iv_586284 = ((int64_t *) mem_587455)[write_iter_586280];
        int64_t write_iv_586285 = ((int64_t *) mem_587453)[write_iter_586280];
        int64_t write_iv_586287 = ((int64_t *) ext_mem_587401.mem)[write_iter_586280];
        int64_t write_iv_586288 = ((int64_t *) mem_587457)[write_iter_586280];
        
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587534, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587402.mem, write_iter_586280 * dim_251930, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
        
        bool cond_582515 = write_iv_586284 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_585696 = sub64(write_iv_586285, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_585696;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_251930 - (int64_t) 1, dim_251930))) {
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_587518.mem, lifted_lambda_res_582516 * dim_251930, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587534, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_251930});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) {
            ((int64_t *) mem_587522.mem)[lifted_lambda_res_582516] = write_iv_586287;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) {
            ((int64_t *) mem_587520)[lifted_lambda_res_582516] = write_iv_586288;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587401, "ext_mem_587401") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587402, "ext_mem_587402") != 0)
        return 1;
    if (mem_587546_cached_sizze_589058 < bytes_587545) {
        err = lexical_realloc(ctx, &mem_587546, &mem_587546_cached_sizze_589058, bytes_587545);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588199 = 0; nest_i_588199 < total_part_no_251942; nest_i_588199++) {
        ((int64_t *) mem_587546)[nest_i_588199] = (int64_t) 0;
    }
    for (int64_t iter_586292 = 0; iter_586292 < m_579802; iter_586292++) {
        int64_t pixel_586294 = ((int64_t *) mem_587520)[iter_586292];
        bool less_than_zzero_586296 = slt64(pixel_586294, (int64_t) 0);
        bool greater_than_sizze_586297 = sle64(total_part_no_251942, pixel_586294);
        bool outside_bounds_dim_586298 = less_than_zzero_586296 || greater_than_sizze_586297;
        
        if (!outside_bounds_dim_586298) {
            int64_t read_hist_586300 = ((int64_t *) mem_587546)[pixel_586294];
            int64_t defunc_0_op_res_579859 = add64((int64_t) 1, read_hist_586300);
            
            ((int64_t *) mem_587546)[pixel_586294] = defunc_0_op_res_579859;
        }
    }
    if (mem_587554_cached_sizze_589059 < bytes_587545) {
        err = lexical_realloc(ctx, &mem_587554, &mem_587554_cached_sizze_589059, bytes_587545);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586308;
    int64_t scanacc_586304 = (int64_t) 0;
    
    for (int64_t i_586306 = 0; i_586306 < total_part_no_251942; i_586306++) {
        int64_t x_579863 = ((int64_t *) mem_587546)[i_586306];
        int64_t defunc_0_op_res_579866 = add64(x_579863, scanacc_586304);
        
        ((int64_t *) mem_587554)[i_586306] = defunc_0_op_res_579866;
        
        int64_t scanacc_tmp_588201 = defunc_0_op_res_579866;
        
        scanacc_586304 = scanacc_tmp_588201;
    }
    discard_586308 = scanacc_586304;
    if (memblock_alloc(ctx, &mem_587562, bytes_587545, "mem_587562")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586311 = 0; i_586311 < total_part_no_251942; i_586311++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586311);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_251942);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587554)[tmp_582504];
        bool cond_582507 = i_586311 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587562.mem)[i_586311] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587443, "ext_mem_587443") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587562, "mem_587562") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587518, "mem_587518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587522, "mem_587522") != 0)
        return 1;
    prim_out_588011 = total_grid_no_251941;
    prim_out_588012 = total_part_no_251942;
    prim_out_588013 = m_579802;
    if (memblock_set(ctx, &*mem_out_p_588984, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588985, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588986, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_588987, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_588988 = prim_out_588011;
    *out_prim_out_588989 = prim_out_588012;
    *out_prim_out_588990 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586427);
        free(mem_586435);
        free(mem_586437);
        free(mem_586445);
        free(mem_586453);
        free(mem_586455);
        free(mem_586469);
        free(mem_586474);
        free(mem_586485);
        free(mem_586510);
        free(mem_586513);
        free(mem_586517);
        free(mem_586520);
        free(mem_586540);
        free(mem_586542);
        free(mem_586545);
        free(mem_586547);
        free(mem_586605);
        free(mem_586607);
        free(mem_586696);
        free(mem_586699);
        free(mem_586703);
        free(mem_586706);
        free(mem_586726);
        free(mem_586728);
        free(mem_586743);
        free(mem_586746);
        free(mem_586750);
        free(mem_586753);
        free(mem_586969);
        free(mem_586977);
        free(mem_586982);
        free(mem_586990);
        free(mem_586998);
        free(mem_587003);
        free(mem_587014);
        free(mem_587036);
        free(mem_587040);
        free(mem_587043);
        free(mem_587059);
        free(mem_587062);
        free(mem_587064);
        free(mem_587110);
        free(mem_587112);
        free(mem_587181);
        free(mem_587185);
        free(mem_587188);
        free(mem_587204);
        free(mem_587206);
        free(mem_587221);
        free(mem_587225);
        free(mem_587228);
        free(mem_587404);
        free(mem_587409);
        free(mem_587423);
        free(mem_587430);
        free(mem_587445);
        free(mem_587453);
        free(mem_587455);
        free(mem_587457);
        free(mem_587468);
        free(mem_587476);
        free(mem_587484);
        free(mem_587489);
        free(mem_587500);
        free(mem_587520);
        free(mem_587534);
        free(mem_587546);
        free(mem_587554);
        if (memblock_unref(ctx, &mem_587562, "mem_587562") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587522, "mem_587522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587518, "mem_587518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587419, "mem_587419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587440, "mem_587440") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587443, "ext_mem_587443") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586967, "mem_586967") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586964, "mem_586964") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588127, "mem_param_tmp_588127") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588126, "mem_param_tmp_588126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588125, "mem_param_tmp_588125") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588124, "mem_param_tmp_588124") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586941, "mem_586941") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586937, "mem_586937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586932, "mem_586932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586928, "mem_586928") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586849, "mem_586849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586845, "mem_586845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586840, "mem_586840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586836, "mem_586836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586864, "mem_586864") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586861, "mem_586861") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586859, "mem_586859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586857, "mem_586857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586898, "ext_mem_586898") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586902, "ext_mem_586902") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586905, "ext_mem_586905") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586908, "ext_mem_586908") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586693, "mem_param_586693") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586690, "mem_param_586690") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586686, "mem_param_586686") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586683, "mem_param_586683") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586952, "ext_mem_586952") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586953, "ext_mem_586953") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586954, "ext_mem_586954") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586955, "ext_mem_586955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586679, "mem_586679") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586670, "mem_586670") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586666, "mem_586666") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586564, "ext_mem_586564") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588100, "mem_param_tmp_588100") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586504, "ext_mem_586504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586500, "mem_param_586500") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586507, "ext_mem_586507") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586958, "ext_mem_586958") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586962, "ext_mem_586962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587397, "mem_587397") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588051, "mem_param_tmp_588051") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588049, "mem_param_tmp_588049") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587377, "mem_587377") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587373, "mem_587373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587368, "mem_587368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587304, "mem_587304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587300, "mem_587300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587295, "mem_587295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587317, "mem_587317") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587314, "mem_587314") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587312, "mem_587312") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587345, "ext_mem_587345") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587349, "ext_mem_587349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587352, "ext_mem_587352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587178, "mem_param_587178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587175, "mem_param_587175") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587171, "mem_param_587171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587386, "ext_mem_587386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587387, "ext_mem_587387") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587388, "ext_mem_587388") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587167, "mem_587167") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587163, "mem_587163") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587158, "mem_587158") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587078, "ext_mem_587078") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588030, "mem_param_tmp_588030") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587030, "ext_mem_587030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587026, "mem_param_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587033, "ext_mem_587033") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587391, "ext_mem_587391") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587395, "ext_mem_587395") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587401, "ext_mem_587401") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587402, "ext_mem_587402") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sort_for_Skyline_GFUR_float(struct futhark_context *ctx, struct memblock *mem_out_p_589060, struct memblock *mem_out_p_589061, struct memblock *mem_out_p_589062, struct memblock *mem_out_p_589063, int64_t *out_prim_out_589064, int64_t *out_prim_out_589065, int64_t *out_prim_out_589066, struct memblock angle_part_prefix_sum_mem_586411, struct memblock angle_partitions_per_dim_mem_586412, struct memblock grid_part_prefix_sum_mem_586413, struct memblock grid_part_sizze_per_dim_mem_586414, struct memblock grid_partitions_per_dim_mem_586415, struct memblock start_of_grid_partition_mem_586416, struct memblock xs_mem_586417, int64_t dim_416322, int64_t dz2080U_416323, int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324, int64_t n_416325, int64_t total_angle_no_416332, int64_t total_grid_no_416333, int64_t total_part_no_416334, int64_t offset_416336, bool use_measure_for_sorting_416337)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_586427_cached_sizze_589067 = 0;
    unsigned char *mem_586427 = NULL;
    int64_t mem_586435_cached_sizze_589068 = 0;
    unsigned char *mem_586435 = NULL;
    int64_t mem_586437_cached_sizze_589069 = 0;
    unsigned char *mem_586437 = NULL;
    int64_t mem_586445_cached_sizze_589070 = 0;
    unsigned char *mem_586445 = NULL;
    int64_t mem_586453_cached_sizze_589071 = 0;
    unsigned char *mem_586453 = NULL;
    int64_t mem_586455_cached_sizze_589072 = 0;
    unsigned char *mem_586455 = NULL;
    int64_t mem_586469_cached_sizze_589073 = 0;
    unsigned char *mem_586469 = NULL;
    int64_t mem_586474_cached_sizze_589074 = 0;
    unsigned char *mem_586474 = NULL;
    int64_t mem_586485_cached_sizze_589075 = 0;
    unsigned char *mem_586485 = NULL;
    int64_t mem_586510_cached_sizze_589076 = 0;
    unsigned char *mem_586510 = NULL;
    int64_t mem_586513_cached_sizze_589077 = 0;
    unsigned char *mem_586513 = NULL;
    int64_t mem_586517_cached_sizze_589078 = 0;
    unsigned char *mem_586517 = NULL;
    int64_t mem_586520_cached_sizze_589079 = 0;
    unsigned char *mem_586520 = NULL;
    int64_t mem_586540_cached_sizze_589080 = 0;
    unsigned char *mem_586540 = NULL;
    int64_t mem_586542_cached_sizze_589081 = 0;
    unsigned char *mem_586542 = NULL;
    int64_t mem_586545_cached_sizze_589082 = 0;
    unsigned char *mem_586545 = NULL;
    int64_t mem_586547_cached_sizze_589083 = 0;
    unsigned char *mem_586547 = NULL;
    int64_t mem_586605_cached_sizze_589084 = 0;
    unsigned char *mem_586605 = NULL;
    int64_t mem_586607_cached_sizze_589085 = 0;
    unsigned char *mem_586607 = NULL;
    int64_t mem_586696_cached_sizze_589086 = 0;
    unsigned char *mem_586696 = NULL;
    int64_t mem_586699_cached_sizze_589087 = 0;
    unsigned char *mem_586699 = NULL;
    int64_t mem_586703_cached_sizze_589088 = 0;
    unsigned char *mem_586703 = NULL;
    int64_t mem_586706_cached_sizze_589089 = 0;
    unsigned char *mem_586706 = NULL;
    int64_t mem_586726_cached_sizze_589090 = 0;
    unsigned char *mem_586726 = NULL;
    int64_t mem_586728_cached_sizze_589091 = 0;
    unsigned char *mem_586728 = NULL;
    int64_t mem_586743_cached_sizze_589092 = 0;
    unsigned char *mem_586743 = NULL;
    int64_t mem_586746_cached_sizze_589093 = 0;
    unsigned char *mem_586746 = NULL;
    int64_t mem_586750_cached_sizze_589094 = 0;
    unsigned char *mem_586750 = NULL;
    int64_t mem_586753_cached_sizze_589095 = 0;
    unsigned char *mem_586753 = NULL;
    int64_t mem_586969_cached_sizze_589096 = 0;
    unsigned char *mem_586969 = NULL;
    int64_t mem_586977_cached_sizze_589097 = 0;
    unsigned char *mem_586977 = NULL;
    int64_t mem_586982_cached_sizze_589098 = 0;
    unsigned char *mem_586982 = NULL;
    int64_t mem_586990_cached_sizze_589099 = 0;
    unsigned char *mem_586990 = NULL;
    int64_t mem_586998_cached_sizze_589100 = 0;
    unsigned char *mem_586998 = NULL;
    int64_t mem_587003_cached_sizze_589101 = 0;
    unsigned char *mem_587003 = NULL;
    int64_t mem_587014_cached_sizze_589102 = 0;
    unsigned char *mem_587014 = NULL;
    int64_t mem_587036_cached_sizze_589103 = 0;
    unsigned char *mem_587036 = NULL;
    int64_t mem_587040_cached_sizze_589104 = 0;
    unsigned char *mem_587040 = NULL;
    int64_t mem_587043_cached_sizze_589105 = 0;
    unsigned char *mem_587043 = NULL;
    int64_t mem_587059_cached_sizze_589106 = 0;
    unsigned char *mem_587059 = NULL;
    int64_t mem_587062_cached_sizze_589107 = 0;
    unsigned char *mem_587062 = NULL;
    int64_t mem_587064_cached_sizze_589108 = 0;
    unsigned char *mem_587064 = NULL;
    int64_t mem_587110_cached_sizze_589109 = 0;
    unsigned char *mem_587110 = NULL;
    int64_t mem_587112_cached_sizze_589110 = 0;
    unsigned char *mem_587112 = NULL;
    int64_t mem_587181_cached_sizze_589111 = 0;
    unsigned char *mem_587181 = NULL;
    int64_t mem_587185_cached_sizze_589112 = 0;
    unsigned char *mem_587185 = NULL;
    int64_t mem_587188_cached_sizze_589113 = 0;
    unsigned char *mem_587188 = NULL;
    int64_t mem_587204_cached_sizze_589114 = 0;
    unsigned char *mem_587204 = NULL;
    int64_t mem_587206_cached_sizze_589115 = 0;
    unsigned char *mem_587206 = NULL;
    int64_t mem_587221_cached_sizze_589116 = 0;
    unsigned char *mem_587221 = NULL;
    int64_t mem_587225_cached_sizze_589117 = 0;
    unsigned char *mem_587225 = NULL;
    int64_t mem_587228_cached_sizze_589118 = 0;
    unsigned char *mem_587228 = NULL;
    int64_t mem_587404_cached_sizze_589119 = 0;
    unsigned char *mem_587404 = NULL;
    int64_t mem_587409_cached_sizze_589120 = 0;
    unsigned char *mem_587409 = NULL;
    int64_t mem_587423_cached_sizze_589121 = 0;
    unsigned char *mem_587423 = NULL;
    int64_t mem_587430_cached_sizze_589122 = 0;
    unsigned char *mem_587430 = NULL;
    int64_t mem_587445_cached_sizze_589123 = 0;
    unsigned char *mem_587445 = NULL;
    int64_t mem_587453_cached_sizze_589124 = 0;
    unsigned char *mem_587453 = NULL;
    int64_t mem_587455_cached_sizze_589125 = 0;
    unsigned char *mem_587455 = NULL;
    int64_t mem_587457_cached_sizze_589126 = 0;
    unsigned char *mem_587457 = NULL;
    int64_t mem_587468_cached_sizze_589127 = 0;
    unsigned char *mem_587468 = NULL;
    int64_t mem_587476_cached_sizze_589128 = 0;
    unsigned char *mem_587476 = NULL;
    int64_t mem_587484_cached_sizze_589129 = 0;
    unsigned char *mem_587484 = NULL;
    int64_t mem_587489_cached_sizze_589130 = 0;
    unsigned char *mem_587489 = NULL;
    int64_t mem_587500_cached_sizze_589131 = 0;
    unsigned char *mem_587500 = NULL;
    int64_t mem_587520_cached_sizze_589132 = 0;
    unsigned char *mem_587520 = NULL;
    int64_t mem_587534_cached_sizze_589133 = 0;
    unsigned char *mem_587534 = NULL;
    int64_t mem_587546_cached_sizze_589134 = 0;
    unsigned char *mem_587546 = NULL;
    int64_t mem_587554_cached_sizze_589135 = 0;
    unsigned char *mem_587554 = NULL;
    struct memblock mem_587562;
    
    mem_587562.references = NULL;
    
    struct memblock mem_587522;
    
    mem_587522.references = NULL;
    
    struct memblock mem_587518;
    
    mem_587518.references = NULL;
    
    struct memblock mem_587419;
    
    mem_587419.references = NULL;
    
    struct memblock mem_587440;
    
    mem_587440.references = NULL;
    
    struct memblock ext_mem_587443;
    
    ext_mem_587443.references = NULL;
    
    struct memblock mem_586967;
    
    mem_586967.references = NULL;
    
    struct memblock mem_586964;
    
    mem_586964.references = NULL;
    
    struct memblock mem_param_tmp_588127;
    
    mem_param_tmp_588127.references = NULL;
    
    struct memblock mem_param_tmp_588126;
    
    mem_param_tmp_588126.references = NULL;
    
    struct memblock mem_param_tmp_588125;
    
    mem_param_tmp_588125.references = NULL;
    
    struct memblock mem_param_tmp_588124;
    
    mem_param_tmp_588124.references = NULL;
    
    struct memblock mem_586941;
    
    mem_586941.references = NULL;
    
    struct memblock mem_586937;
    
    mem_586937.references = NULL;
    
    struct memblock mem_586932;
    
    mem_586932.references = NULL;
    
    struct memblock mem_586928;
    
    mem_586928.references = NULL;
    
    struct memblock mem_586849;
    
    mem_586849.references = NULL;
    
    struct memblock mem_586845;
    
    mem_586845.references = NULL;
    
    struct memblock mem_586840;
    
    mem_586840.references = NULL;
    
    struct memblock mem_586836;
    
    mem_586836.references = NULL;
    
    struct memblock mem_586864;
    
    mem_586864.references = NULL;
    
    struct memblock mem_586861;
    
    mem_586861.references = NULL;
    
    struct memblock mem_586859;
    
    mem_586859.references = NULL;
    
    struct memblock mem_586857;
    
    mem_586857.references = NULL;
    
    struct memblock ext_mem_586898;
    
    ext_mem_586898.references = NULL;
    
    struct memblock ext_mem_586902;
    
    ext_mem_586902.references = NULL;
    
    struct memblock ext_mem_586905;
    
    ext_mem_586905.references = NULL;
    
    struct memblock ext_mem_586908;
    
    ext_mem_586908.references = NULL;
    
    struct memblock mem_param_586693;
    
    mem_param_586693.references = NULL;
    
    struct memblock mem_param_586690;
    
    mem_param_586690.references = NULL;
    
    struct memblock mem_param_586686;
    
    mem_param_586686.references = NULL;
    
    struct memblock mem_param_586683;
    
    mem_param_586683.references = NULL;
    
    struct memblock ext_mem_586952;
    
    ext_mem_586952.references = NULL;
    
    struct memblock ext_mem_586953;
    
    ext_mem_586953.references = NULL;
    
    struct memblock ext_mem_586954;
    
    ext_mem_586954.references = NULL;
    
    struct memblock ext_mem_586955;
    
    ext_mem_586955.references = NULL;
    
    struct memblock mem_586679;
    
    mem_586679.references = NULL;
    
    struct memblock mem_586675;
    
    mem_586675.references = NULL;
    
    struct memblock mem_586670;
    
    mem_586670.references = NULL;
    
    struct memblock mem_586666;
    
    mem_586666.references = NULL;
    
    struct memblock ext_mem_586564;
    
    ext_mem_586564.references = NULL;
    
    struct memblock mem_param_tmp_588100;
    
    mem_param_tmp_588100.references = NULL;
    
    struct memblock ext_mem_586504;
    
    ext_mem_586504.references = NULL;
    
    struct memblock mem_param_586500;
    
    mem_param_586500.references = NULL;
    
    struct memblock ext_mem_586507;
    
    ext_mem_586507.references = NULL;
    
    struct memblock ext_mem_586958;
    
    ext_mem_586958.references = NULL;
    
    struct memblock ext_mem_586962;
    
    ext_mem_586962.references = NULL;
    
    struct memblock mem_587400;
    
    mem_587400.references = NULL;
    
    struct memblock mem_587397;
    
    mem_587397.references = NULL;
    
    struct memblock mem_param_tmp_588051;
    
    mem_param_tmp_588051.references = NULL;
    
    struct memblock mem_param_tmp_588050;
    
    mem_param_tmp_588050.references = NULL;
    
    struct memblock mem_param_tmp_588049;
    
    mem_param_tmp_588049.references = NULL;
    
    struct memblock mem_587377;
    
    mem_587377.references = NULL;
    
    struct memblock mem_587373;
    
    mem_587373.references = NULL;
    
    struct memblock mem_587368;
    
    mem_587368.references = NULL;
    
    struct memblock mem_587304;
    
    mem_587304.references = NULL;
    
    struct memblock mem_587300;
    
    mem_587300.references = NULL;
    
    struct memblock mem_587295;
    
    mem_587295.references = NULL;
    
    struct memblock mem_587317;
    
    mem_587317.references = NULL;
    
    struct memblock mem_587314;
    
    mem_587314.references = NULL;
    
    struct memblock mem_587312;
    
    mem_587312.references = NULL;
    
    struct memblock ext_mem_587345;
    
    ext_mem_587345.references = NULL;
    
    struct memblock ext_mem_587349;
    
    ext_mem_587349.references = NULL;
    
    struct memblock ext_mem_587352;
    
    ext_mem_587352.references = NULL;
    
    struct memblock mem_param_587178;
    
    mem_param_587178.references = NULL;
    
    struct memblock mem_param_587175;
    
    mem_param_587175.references = NULL;
    
    struct memblock mem_param_587171;
    
    mem_param_587171.references = NULL;
    
    struct memblock ext_mem_587386;
    
    ext_mem_587386.references = NULL;
    
    struct memblock ext_mem_587387;
    
    ext_mem_587387.references = NULL;
    
    struct memblock ext_mem_587388;
    
    ext_mem_587388.references = NULL;
    
    struct memblock mem_587167;
    
    mem_587167.references = NULL;
    
    struct memblock mem_587163;
    
    mem_587163.references = NULL;
    
    struct memblock mem_587158;
    
    mem_587158.references = NULL;
    
    struct memblock ext_mem_587078;
    
    ext_mem_587078.references = NULL;
    
    struct memblock mem_param_tmp_588030;
    
    mem_param_tmp_588030.references = NULL;
    
    struct memblock ext_mem_587030;
    
    ext_mem_587030.references = NULL;
    
    struct memblock mem_param_587026;
    
    mem_param_587026.references = NULL;
    
    struct memblock ext_mem_587033;
    
    ext_mem_587033.references = NULL;
    
    struct memblock ext_mem_587391;
    
    ext_mem_587391.references = NULL;
    
    struct memblock ext_mem_587395;
    
    ext_mem_587395.references = NULL;
    
    struct memblock ext_mem_587401;
    
    ext_mem_587401.references = NULL;
    
    struct memblock ext_mem_587402;
    
    ext_mem_587402.references = NULL;
    
    struct memblock mem_586419;
    
    mem_586419.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    int64_t prim_out_588011;
    int64_t prim_out_588012;
    int64_t prim_out_588013;
    int64_t arg_578018 = sub64(dim_416322, (int64_t) 1);
    bool assert_cond_578019 = arg_578018 == dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324;
    bool assert_c_578020;
    
    if (!assert_cond_578019) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  unknown location\n   #1  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_586418 = (int64_t) 8 * n_416325;
    
    if (memblock_alloc(ctx, &mem_586419, bytes_586418, "mem_586419")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586050 = 0; i_586050 < n_416325; i_586050++) {
        int64_t lifted_lambda_res_578027 = add64(offset_416336, i_586050);
        
        ((int64_t *) mem_586419.mem)[i_586050] = lifted_lambda_res_578027;
    }
    
    bool cond_578028 = !use_measure_for_sorting_416337;
    bool y_578724 = slt64((int64_t) 0, dz2080U_416323);
    bool protect_assert_disj_582415 = cond_578028 || y_578724;
    bool index_certs_578725;
    
    if (!protect_assert_disj_582415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582417 = assert_cond_578019 || cond_578028;
    bool empty_or_match_cert_578818;
    
    if (!protect_assert_disj_582417) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578849 = sle64(n_416325, (int64_t) 1);
    bool x_578850 = !cond_578849;
    int64_t zs_lhs_578851 = sub64(n_416325, (int64_t) 1);
    int64_t zp_rhs_578852 = sdiv_safe64(zs_lhs_578851, (int64_t) 20);
    int64_t min_num_blocks_578853 = add64((int64_t) 1, zp_rhs_578852);
    bool loop_cond_578854 = slt64((int64_t) 1, min_num_blocks_578853);
    bool x_582418;
    int64_t x_582419;
    bool loop_while_578857;
    int64_t x_578858;
    
    loop_while_578857 = loop_cond_578854;
    x_578858 = (int64_t) 1;
    while (loop_while_578857) {
        int64_t loopres_578859 = mul64((int64_t) 2, x_578858);
        bool loop_cond_578860 = slt64(loopres_578859, min_num_blocks_578853);
        bool loop_while_tmp_588015 = loop_cond_578860;
        int64_t x_tmp_588016 = loopres_578859;
        
        loop_while_578857 = loop_while_tmp_588015;
        x_578858 = x_tmp_588016;
    }
    x_582418 = loop_while_578857;
    x_582419 = x_578858;
    
    bool zzero_578861 = x_582419 == (int64_t) 0;
    bool nonzzero_578862 = !zzero_578861;
    bool protect_assert_disj_578863 = cond_578849 || nonzzero_578862;
    bool protect_assert_disj_582423 = cond_578028 || protect_assert_disj_578863;
    bool nonzzero_cert_578864;
    
    if (!protect_assert_disj_582423) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_578865 = sdiv_safe64(zs_lhs_578851, x_582419);
    int64_t block_sizze_578866 = add64((int64_t) 1, zp_rhs_578865);
    bool y_578867 = slt64((int64_t) 0, n_416325);
    bool protect_assert_disj_578868 = cond_578849 || y_578867;
    bool protect_assert_disj_582425 = cond_578028 || protect_assert_disj_578868;
    bool index_certs_578869;
    
    if (!protect_assert_disj_582425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flat_dim_578876 = block_sizze_578866 * x_582419;
    int64_t greatest_divisor_leq_than_arg1_578881 = mul64((int64_t) 2, block_sizze_578866);
    bool protect_cond_conj_582427 = use_measure_for_sorting_416337 && x_578850;
    int64_t merge_block_sizze_578882;
    
    if (protect_cond_conj_582427) {
        int64_t x_584593;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584593, (int64_t) 8, greatest_divisor_leq_than_arg1_578881) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_578882 = x_584593;
    } else {
        merge_block_sizze_578882 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_578911 = slt64(x_582419, (int64_t) 0);
    bool valid_578912 = !bounds_invalid_upwards_578911;
    bool protect_assert_disj_582404 = cond_578849 || valid_578912;
    bool protect_assert_disj_582429 = cond_578028 || protect_assert_disj_582404;
    bool range_valid_c_578913;
    
    if (!protect_assert_disj_582429) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582419, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:937:33-56\n   #6  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_578915 = slt64(block_sizze_578866, (int64_t) 0);
    bool valid_578916 = !bounds_invalid_upwards_578915;
    bool protect_assert_disj_582406 = cond_578849 || valid_578916;
    bool protect_assert_disj_582431 = cond_578028 || protect_assert_disj_582406;
    bool range_valid_c_578917;
    
    if (!protect_assert_disj_582431) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_578866, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578919 = sle64(block_sizze_578866, (int64_t) 1);
    int64_t tmp_578920 = sub64(block_sizze_578866, (int64_t) 2);
    bool bounds_invalid_upwards_578921 = slt64(tmp_578920, (int64_t) 0);
    int64_t distance_578922 = add64((int64_t) 1, tmp_578920);
    bool valid_578923 = !bounds_invalid_upwards_578921;
    bool protect_assert_disj_578924 = cond_578919 || valid_578923;
    bool protect_assert_disj_582408 = cond_578849 || protect_assert_disj_578924;
    bool protect_assert_disj_582433 = cond_578028 || protect_assert_disj_582408;
    bool range_valid_c_578925;
    
    if (!protect_assert_disj_582433) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_578920, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_579045 = slt64(block_sizze_578866, flat_dim_578876);
    bool zzero_579046 = merge_block_sizze_578882 == (int64_t) 0;
    bool nonzzero_579047 = !zzero_579046;
    bool empty_slice_579509 = n_416325 == (int64_t) 0;
    bool zzero_leq_i_p_m_t_s_579510 = sle64((int64_t) 0, zs_lhs_578851);
    bool protect_assert_disj_582377 = use_measure_for_sorting_416337 || y_578724;
    bool index_certs_578037;
    
    if (!protect_assert_disj_582377) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582379 = use_measure_for_sorting_416337 || assert_cond_578019;
    bool empty_or_match_cert_578121;
    
    if (!protect_assert_disj_582379) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_582380;
    int64_t x_582381;
    bool loop_while_578157;
    int64_t x_578158;
    
    loop_while_578157 = loop_cond_578854;
    x_578158 = (int64_t) 1;
    while (loop_while_578157) {
        int64_t loopres_578159 = mul64((int64_t) 2, x_578158);
        bool loop_cond_578160 = slt64(loopres_578159, min_num_blocks_578853);
        bool loop_while_tmp_588017 = loop_cond_578160;
        int64_t x_tmp_588018 = loopres_578159;
        
        loop_while_578157 = loop_while_tmp_588017;
        x_578158 = x_tmp_588018;
    }
    x_582380 = loop_while_578157;
    x_582381 = x_578158;
    
    bool zzero_578161 = x_582381 == (int64_t) 0;
    bool nonzzero_578162 = !zzero_578161;
    bool protect_assert_disj_578163 = nonzzero_578162 || cond_578849;
    bool protect_assert_disj_582385 = use_measure_for_sorting_416337 || protect_assert_disj_578163;
    bool nonzzero_cert_578164;
    
    if (!protect_assert_disj_582385) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_578165 = sdiv_safe64(zs_lhs_578851, x_582381);
    int64_t block_sizze_578166 = add64((int64_t) 1, zp_rhs_578165);
    bool protect_assert_disj_582387 = use_measure_for_sorting_416337 || protect_assert_disj_578868;
    bool index_certs_578169;
    
    if (!protect_assert_disj_582387) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t flat_dim_578174 = block_sizze_578166 * x_582381;
    int64_t greatest_divisor_leq_than_arg1_578178 = mul64((int64_t) 2, block_sizze_578166);
    bool protect_cond_conj_582389 = cond_578028 && x_578850;
    int64_t merge_block_sizze_578179;
    
    if (protect_cond_conj_582389) {
        int64_t x_584594;
        
        if (futrts_greatest_divisor_leq_than_4833(ctx, &x_584594, (int64_t) 8, greatest_divisor_leq_than_arg1_578178) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_578179 = x_584594;
    } else {
        merge_block_sizze_578179 = (int64_t) 0;
    }
    
    bool bounds_invalid_upwards_578197 = slt64(x_582381, (int64_t) 0);
    bool valid_578198 = !bounds_invalid_upwards_578197;
    bool protect_assert_disj_582366 = valid_578198 || cond_578849;
    bool protect_assert_disj_582391 = use_measure_for_sorting_416337 || protect_assert_disj_582366;
    bool range_valid_c_578199;
    
    if (!protect_assert_disj_582391) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) x_582381, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_578201 = slt64(block_sizze_578166, (int64_t) 0);
    bool valid_578202 = !bounds_invalid_upwards_578201;
    bool protect_assert_disj_582368 = valid_578202 || cond_578849;
    bool protect_assert_disj_582393 = use_measure_for_sorting_416337 || protect_assert_disj_582368;
    bool range_valid_c_578203;
    
    if (!protect_assert_disj_582393) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_578166, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_578205 = sle64(block_sizze_578166, (int64_t) 1);
    int64_t tmp_578206 = sub64(block_sizze_578166, (int64_t) 2);
    bool bounds_invalid_upwards_578207 = slt64(tmp_578206, (int64_t) 0);
    int64_t distance_578208 = add64((int64_t) 1, tmp_578206);
    bool valid_578209 = !bounds_invalid_upwards_578207;
    bool protect_assert_disj_578210 = cond_578205 || valid_578209;
    bool protect_assert_disj_582370 = protect_assert_disj_578210 || cond_578849;
    bool protect_assert_disj_582395 = use_measure_for_sorting_416337 || protect_assert_disj_582370;
    bool range_valid_c_578211;
    
    if (!protect_assert_disj_582395) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_578206, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool loop_cond_578299 = slt64(block_sizze_578166, flat_dim_578174);
    bool zzero_578300 = merge_block_sizze_578179 == (int64_t) 0;
    bool nonzzero_578301 = !zzero_578300;
    int64_t bytes_586426 = (int64_t) 4 * dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324;
    int64_t bytes_586436 = (int64_t) 4 * n_416325;
    int64_t bytes_586444 = (int64_t) 8 * dim_416322;
    int64_t bytes_586452 = (int64_t) 4 * dim_416322;
    int64_t bytes_586468 = (int64_t) 4 * arg_578018;
    int64_t bytes_586484 = (int64_t) 8 * arg_578018;
    int64_t binop_x_586508 = (int64_t) 8 * x_582419;
    int64_t bytes_586509 = block_sizze_578866 * binop_x_586508;
    int64_t binop_x_586511 = (int64_t) 4 * x_582419;
    int64_t bytes_586512 = block_sizze_578866 * binop_x_586511;
    int64_t bytes_586516 = dim_416322 * bytes_586512;
    int64_t lmad_arg_586538 = dim_416322 * block_sizze_578866;
    int64_t bytes_586539 = (int64_t) 8 * block_sizze_578866;
    int64_t bytes_586541 = (int64_t) 4 * block_sizze_578866;
    int64_t bytes_586544 = dim_416322 * bytes_586541;
    int64_t lmad_arg_586771 = dim_416322 * merge_block_sizze_578882;
    int64_t bytes_586966 = dim_416322 * bytes_586436;
    int64_t binop_x_587034 = (int64_t) 8 * x_582381;
    int64_t bytes_587035 = block_sizze_578166 * binop_x_587034;
    int64_t binop_x_587037 = (int64_t) 4 * x_582381;
    int64_t binop_x_587038 = block_sizze_578166 * binop_x_587037;
    int64_t bytes_587039 = dim_416322 * binop_x_587038;
    int64_t lmad_arg_587057 = dim_416322 * block_sizze_578166;
    int64_t bytes_587058 = (int64_t) 8 * block_sizze_578166;
    int64_t binop_x_587060 = (int64_t) 4 * block_sizze_578166;
    int64_t bytes_587061 = dim_416322 * binop_x_587060;
    int64_t lmad_arg_587242 = dim_416322 * merge_block_sizze_578179;
    
    if (cond_578028) {
        if (mem_586969_cached_sizze_589096 < bytes_586426) {
            err = lexical_realloc(ctx, &mem_586969, &mem_586969_cached_sizze_589096, bytes_586426);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586054 = 0; i_586054 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324; i_586054++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584786 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586054];
            float i64_res_584787 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_584786);
            float defunc_0_fover_res_584788 = 1.5707964F / i64_res_584787;
            
            ((float *) mem_586969)[i_586054] = defunc_0_fover_res_584788;
        }
        if (mem_586977_cached_sizze_589097 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586977, &mem_586977_cached_sizze_589097, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586982_cached_sizze_589098 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586982, &mem_586982_cached_sizze_589098, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586990_cached_sizze_589099 < bytes_586452) {
            err = lexical_realloc(ctx, &mem_586990, &mem_586990_cached_sizze_589099, bytes_586452);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586998_cached_sizze_589100 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_586998, &mem_586998_cached_sizze_589100, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_587014_cached_sizze_589102 < bytes_586484) {
            err = lexical_realloc(ctx, &mem_587014, &mem_587014_cached_sizze_589102, bytes_586484);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586074 = 0; i_586074 < n_416325; i_586074++) {
            for (int64_t i_586058 = 0; i_586058 < dim_416322; i_586058++) {
                float eta_p_584795 = ((float *) xs_mem_586417.mem)[i_586074 * dim_416322 + i_586058];
                float eta_p_584796 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586058];
                float eta_p_584797 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586058];
                int64_t eta_p_584799 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586058];
                float defunc_0_f_res_584800 = eta_p_584795 - eta_p_584796;
                float defunc_0_f_res_584801 = defunc_0_f_res_584800 / eta_p_584797;
                int64_t f32_res_584802 = fptosi_f32_i64(defunc_0_f_res_584801);
                int64_t max_res_584803 = smax64((int64_t) 0, f32_res_584802);
                int64_t zm_lhs_584808 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586058];
                int64_t min_arg1_584809 = sub64(zm_lhs_584808, (int64_t) 1);
                int64_t min_res_584810 = smin64(max_res_584803, min_arg1_584809);
                int64_t defunc_0_f_res_584811 = mul64(eta_p_584799, min_res_584810);
                
                ((int64_t *) mem_586982)[i_586058] = defunc_0_f_res_584811;
            }
            
            int64_t defunc_0_foldl_res_584813;
            int64_t acc_584815 = (int64_t) 0;
            
            for (int64_t i_584814 = 0; i_584814 < dim_416322; i_584814++) {
                int64_t b_584816 = ((int64_t *) mem_586982)[i_584814];
                int64_t defunc_0_f_res_584817 = add64(acc_584815, b_584816);
                int64_t acc_tmp_588022 = defunc_0_f_res_584817;
                
                acc_584815 = acc_tmp_588022;
            }
            defunc_0_foldl_res_584813 = acc_584815;
            
            bool x_584818 = sle64((int64_t) 0, defunc_0_foldl_res_584813);
            bool y_584819 = slt64(defunc_0_foldl_res_584813, dz2080U_416323);
            bool bounds_check_584820 = x_584818 && y_584819;
            bool index_certs_584821;
            
            if (!bounds_check_584820) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_584813, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586062 = 0; i_586062 < dim_416322; i_586062++) {
                float eta_p_584824 = ((float *) xs_mem_586417.mem)[i_586074 * dim_416322 + i_586062];
                float eta_p_584825 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_584813 * dim_416322 + i_586062];
                float defunc_0_f_res_584826 = eta_p_584824 - eta_p_584825;
                
                ((float *) mem_586990)[i_586062] = defunc_0_f_res_584826;
            }
            for (int64_t nest_i_588024 = 0; nest_i_588024 < arg_578018; nest_i_588024++) {
                ((float *) mem_586998)[nest_i_588024] = 0.0F;
            }
            for (int64_t i_584830 = 0; i_584830 < arg_578018; i_584830++) {
                bool y_584832 = slt64(i_584830, dim_416322);
                bool index_certs_584833;
                
                if (!y_584832) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584830, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_584835 = add64((int64_t) 1, i_584830);
                int64_t j_m_i_584836 = sub64(dim_416322, map_arg1_584835);
                bool empty_slice_584837 = j_m_i_584836 == (int64_t) 0;
                int64_t m_584838 = sub64(j_m_i_584836, (int64_t) 1);
                int64_t i_p_m_t_s_584839 = add64(map_arg1_584835, m_584838);
                bool zzero_leq_i_p_m_t_s_584840 = sle64((int64_t) 0, i_p_m_t_s_584839);
                bool i_p_m_t_s_leq_w_584841 = slt64(i_p_m_t_s_584839, dim_416322);
                bool zzero_lte_i_584842 = sle64((int64_t) 0, map_arg1_584835);
                bool i_lte_j_584843 = sle64(map_arg1_584835, dim_416322);
                bool y_584844 = i_p_m_t_s_leq_w_584841 && zzero_lte_i_584842;
                bool y_584845 = zzero_leq_i_p_m_t_s_584840 && y_584844;
                bool forwards_ok_584846 = i_lte_j_584843 && y_584845;
                bool ok_or_empty_584847 = empty_slice_584837 || forwards_ok_584846;
                bool index_certs_584848;
                
                if (!ok_or_empty_584847) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_584835, ":", (long long) dim_416322, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:218:90-91\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_587002 = (int64_t) 4 * j_m_i_584836;
                float this_x_584834 = ((float *) mem_586990)[i_584830];
                
                if (mem_587003_cached_sizze_589101 < bytes_587002) {
                    err = lexical_realloc(ctx, &mem_587003, &mem_587003_cached_sizze_589101, bytes_587002);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586066 = 0; i_586066 < j_m_i_584836; i_586066++) {
                    int64_t slice_586383 = map_arg1_584835 + i_586066;
                    float eta_p_584851 = ((float *) mem_586990)[slice_586383];
                    float defunc_0_ftimes_res_584852 = eta_p_584851 * eta_p_584851;
                    
                    ((float *) mem_587003)[i_586066] = defunc_0_ftimes_res_584852;
                }
                
                float defunc_0_foldl_res_584854;
                float acc_584856 = 0.0F;
                
                for (int64_t i_584855 = 0; i_584855 < j_m_i_584836; i_584855++) {
                    float b_584857 = ((float *) mem_587003)[i_584855];
                    float defunc_0_f_res_584858 = acc_584856 + b_584857;
                    float acc_tmp_588027 = defunc_0_f_res_584858;
                    
                    acc_584856 = acc_tmp_588027;
                }
                defunc_0_foldl_res_584854 = acc_584856;
                
                float sqrt_res_584859 = futrts_sqrt32(defunc_0_foldl_res_584854);
                float atan2_res_584860 = futrts_atan2_32(sqrt_res_584859, this_x_584834);
                
                ((float *) mem_586998)[i_584830] = atan2_res_584860;
            }
            for (int64_t i_586070 = 0; i_586070 < arg_578018; i_586070++) {
                float eta_p_584863 = ((float *) mem_586998)[i_586070];
                float eta_p_584864 = ((float *) mem_586969)[i_586070];
                int64_t eta_p_584865 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586070];
                int64_t eta_p_584866 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586070];
                float i64_res_584867 = sitofp_i64_f32(eta_p_584865);
                float defunc_0_fover_res_584868 = eta_p_584863 / eta_p_584864;
                float defunc_0_ftimes_res_584869 = i64_res_584867 * defunc_0_fover_res_584868;
                int64_t f32_res_584870 = fptosi_f32_i64(defunc_0_ftimes_res_584869);
                bool cond_584871 = slt64(f32_res_584870, (int64_t) 0);
                int64_t defunc_0_f_res_584872;
                
                if (cond_584871) {
                    defunc_0_f_res_584872 = (int64_t) 0;
                } else {
                    bool cond_584873 = sle64(eta_p_584866, f32_res_584870);
                    int64_t defunc_0_f_res_f_res_584874;
                    
                    if (cond_584873) {
                        int64_t defunc_0_f_res_f_res_t_res_584875 = sub64(eta_p_584866, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_584874 = defunc_0_f_res_f_res_t_res_584875;
                    } else {
                        defunc_0_f_res_f_res_584874 = f32_res_584870;
                    }
                    defunc_0_f_res_584872 = defunc_0_f_res_f_res_584874;
                }
                ((int64_t *) mem_587014)[i_586070] = defunc_0_f_res_584872;
            }
            
            int64_t defunc_0_foldl_res_584877;
            int64_t acc_584879 = (int64_t) 0;
            
            for (int64_t i_584878 = 0; i_584878 < arg_578018; i_584878++) {
                int64_t b_584880 = ((int64_t *) mem_587014)[i_584878];
                int64_t defunc_0_f_res_584881 = add64(acc_584879, b_584880);
                int64_t acc_tmp_588029 = defunc_0_f_res_584881;
                
                acc_584879 = acc_tmp_588029;
            }
            defunc_0_foldl_res_584877 = acc_584879;
            
            int64_t zp_lhs_584882 = mul64(total_angle_no_416332, defunc_0_foldl_res_584813);
            int64_t get_id_from_grid_angle_res_584883 = add64(defunc_0_foldl_res_584877, zp_lhs_584882);
            
            ((int64_t *) mem_586977)[i_586074] = get_id_from_grid_angle_res_584883;
        }
        
        int64_t reduce_arg1_584886;
        
        if (x_578850) {
            int64_t x_584887 = ((int64_t *) mem_586977)[(int64_t) 0];
            
            reduce_arg1_584886 = x_584887;
        } else {
            reduce_arg1_584886 = (int64_t) 0;
        }
        if (cond_578849) {
            if (memblock_set(ctx, &ext_mem_587395, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587391, &mem_586419, "mem_586419") != 0)
                return 1;
        } else {
            int64_t ext_587032;
            int64_t defunc_0_reduce_res_584891;
            int64_t defunc_0_reduce_res_584893;
            int64_t redout_586076;
            int64_t redout_586078;
            int64_t ctx_param_ext_587024;
            
            if (memblock_set(ctx, &mem_param_587026, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            ctx_param_ext_587024 = (int64_t) 0;
            redout_586076 = reduce_arg1_584886;
            redout_586078 = offset_416336;
            for (int64_t i_586079 = 0; i_586079 < n_416325; i_586079++) {
                int64_t x_584894 = ((int64_t *) mem_586977)[i_586079];
                int64_t x_584896 = ((int64_t *) mem_586419.mem)[i_586079];
                bool lifted_lambda_res_584903 = sle64(redout_586076, x_584894);
                int64_t defunc_0_op_res_584904;
                
                if (lifted_lambda_res_584903) {
                    defunc_0_op_res_584904 = x_584894;
                } else {
                    defunc_0_op_res_584904 = redout_586076;
                }
                
                int64_t defunc_0_op_res_584905;
                
                if (lifted_lambda_res_584903) {
                    defunc_0_op_res_584905 = x_584896;
                } else {
                    defunc_0_op_res_584905 = redout_586078;
                }
                
                int64_t lmad_ext_587027 = dim_416322 * i_586079;
                int64_t ext_587029;
                
                if (lifted_lambda_res_584903) {
                    ext_587029 = lmad_ext_587027;
                } else {
                    ext_587029 = ctx_param_ext_587024;
                }
                if (lifted_lambda_res_584903) {
                    if (memblock_set(ctx, &ext_mem_587030, &xs_mem_586417, "xs_mem_586417") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_587030, &mem_param_587026, "mem_param_587026") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588030, &ext_mem_587030, "ext_mem_587030") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588031 = ext_587029;
                int64_t redout_tmp_588032 = defunc_0_op_res_584904;
                int64_t redout_tmp_588034 = defunc_0_op_res_584905;
                
                if (memblock_set(ctx, &mem_param_587026, &mem_param_tmp_588030, "mem_param_tmp_588030") != 0)
                    return 1;
                ctx_param_ext_587024 = ctx_param_ext_tmp_588031;
                redout_586076 = redout_tmp_588032;
                redout_586078 = redout_tmp_588034;
            }
            if (memblock_set(ctx, &ext_mem_587033, &mem_param_587026, "mem_param_587026") != 0)
                return 1;
            ext_587032 = ctx_param_ext_587024;
            defunc_0_reduce_res_584891 = redout_586076;
            defunc_0_reduce_res_584893 = redout_586078;
            if (mem_587036_cached_sizze_589103 < bytes_587035) {
                err = lexical_realloc(ctx, &mem_587036, &mem_587036_cached_sizze_589103, bytes_587035);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587040_cached_sizze_589104 < bytes_587039) {
                err = lexical_realloc(ctx, &mem_587040, &mem_587040_cached_sizze_589104, bytes_587039);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587043_cached_sizze_589105 < bytes_587035) {
                err = lexical_realloc(ctx, &mem_587043, &mem_587043_cached_sizze_589105, bytes_587035);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587059_cached_sizze_589106 < bytes_587058) {
                err = lexical_realloc(ctx, &mem_587059, &mem_587059_cached_sizze_589106, bytes_587058);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587062_cached_sizze_589107 < bytes_587061) {
                err = lexical_realloc(ctx, &mem_587062, &mem_587062_cached_sizze_589107, bytes_587061);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_587064_cached_sizze_589108 < bytes_587058) {
                err = lexical_realloc(ctx, &mem_587064, &mem_587064_cached_sizze_589108, bytes_587058);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586096 = 0; i_586096 < x_582381; i_586096++) {
                int64_t zp_lhs_584922 = mul64(block_sizze_578166, i_586096);
                
                for (int64_t i_586086 = 0; i_586086 < block_sizze_578166; i_586086++) {
                    int64_t k_584927 = add64(zp_lhs_584922, i_586086);
                    bool cond_584928 = slt64(k_584927, n_416325);
                    int64_t lmad_ext_587075 = dim_416322 * k_584927;
                    int64_t ext_587077;
                    
                    if (cond_584928) {
                        ext_587077 = lmad_ext_587075;
                    } else {
                        ext_587077 = ext_587032;
                    }
                    
                    int64_t lifted_lambda_res_584929;
                    int64_t lifted_lambda_res_584931;
                    
                    if (cond_584928) {
                        bool x_584932 = sle64((int64_t) 0, k_584927);
                        bool bounds_check_584933 = cond_584928 && x_584932;
                        bool index_certs_584934;
                        
                        if (!bounds_check_584933) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_584927, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_584935 = ((int64_t *) mem_586977)[k_584927];
                        int64_t index_primexp_584937 = add64(offset_416336, k_584927);
                        
                        if (memblock_set(ctx, &ext_mem_587078, &xs_mem_586417, "xs_mem_586417") != 0)
                            return 1;
                        lifted_lambda_res_584929 = lifted_lambda_res_t_res_584935;
                        lifted_lambda_res_584931 = index_primexp_584937;
                    } else {
                        if (memblock_set(ctx, &ext_mem_587078, &ext_mem_587033, "ext_mem_587033") != 0)
                            return 1;
                        lifted_lambda_res_584929 = defunc_0_reduce_res_584891;
                        lifted_lambda_res_584931 = defunc_0_reduce_res_584893;
                    }
                    ((int64_t *) mem_587059)[i_586086] = lifted_lambda_res_584929;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_587062, i_586086 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587078.mem, ext_587077, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                    if (memblock_unref(ctx, &ext_mem_587078, "ext_mem_587078") != 0)
                        return 1;
                    ((int64_t *) mem_587064)[i_586086] = lifted_lambda_res_584931;
                }
                if (!cond_578205) {
                    if (mem_587110_cached_sizze_589109 < bytes_586452) {
                        err = lexical_realloc(ctx, &mem_587110, &mem_587110_cached_sizze_589109, bytes_586452);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_587112_cached_sizze_589110 < bytes_586452) {
                        err = lexical_realloc(ctx, &mem_587112, &mem_587112_cached_sizze_589110, bytes_586452);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_584947 = 0; i_584947 < distance_578208; i_584947++) {
                        int64_t gt_arg1_584951 = add64((int64_t) 1, i_584947);
                        bool x_584952 = sle64((int64_t) 0, gt_arg1_584951);
                        bool y_584953 = slt64(gt_arg1_584951, block_sizze_578166);
                        bool bounds_check_584954 = x_584952 && y_584953;
                        bool index_certs_584955;
                        
                        if (!bounds_check_584954) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_584951, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_584957 = slt64(i_584947, block_sizze_578166);
                        bool index_certs_584958;
                        
                        if (!y_584957) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_584947, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_584956 = ((int64_t *) mem_587059)[gt_arg1_584951];
                        int64_t gt_arg0_584959 = ((int64_t *) mem_587059)[i_584947];
                        bool lifted_lambda_res_584960 = sle64(gt_arg0_584959, gt_arg1_584956);
                        bool defunc_0_lifted_gt_res_584961 = !lifted_lambda_res_584960;
                        bool s_584962;
                        int64_t s_584966;
                        bool loop_while_584967;
                        int64_t j_584971;
                        
                        loop_while_584967 = defunc_0_lifted_gt_res_584961;
                        j_584971 = i_584947;
                        while (loop_while_584967) {
                            bool x_584972 = sle64((int64_t) 0, j_584971);
                            bool y_584973 = slt64(j_584971, block_sizze_578166);
                            bool bounds_check_584974 = x_584972 && y_584973;
                            bool index_certs_584975;
                            
                            if (!bounds_check_584974) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_584971, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_584980 = add64((int64_t) 1, j_584971);
                            bool x_584981 = sle64((int64_t) 0, copy_arg0_584980);
                            bool y_584982 = slt64(copy_arg0_584980, block_sizze_578166);
                            bool bounds_check_584983 = x_584981 && y_584982;
                            bool index_certs_584984;
                            
                            if (!bounds_check_584983) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_584980, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_584976 = ((int64_t *) mem_587059)[j_584971];
                            int64_t copy_arg0_584978 = ((int64_t *) mem_587064)[j_584971];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587110, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587062, (int64_t) 0 + j_584971 * dim_416322, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            
                            int64_t copy_arg0_584985 = ((int64_t *) mem_587059)[copy_arg0_584980];
                            int64_t copy_arg0_584987 = ((int64_t *) mem_587064)[copy_arg0_584980];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587112, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587062, (int64_t) 0 + copy_arg0_584980 * dim_416322, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_587059)[j_584971] = copy_arg0_584985;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587062, j_584971 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587112, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_587064)[j_584971] = copy_arg0_584987;
                            ((int64_t *) mem_587059)[copy_arg0_584980] = copy_arg0_584976;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587062, copy_arg0_584980 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587110, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_587064)[copy_arg0_584980] = copy_arg0_584978;
                            
                            int64_t tmp_584995 = sub64(j_584971, (int64_t) 1);
                            bool cond_584996 = sle64((int64_t) 0, tmp_584995);
                            bool loop_cond_584997;
                            
                            if (cond_584996) {
                                bool y_584999 = slt64(tmp_584995, block_sizze_578166);
                                bool bounds_check_585000 = cond_584996 && y_584999;
                                bool index_certs_585001;
                                
                                if (!bounds_check_585000) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_584995, "] out of bounds for array of shape [", (long long) block_sizze_578166, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_584998 = ((int64_t *) mem_587059)[j_584971];
                                int64_t gt_arg0_585002 = ((int64_t *) mem_587059)[tmp_584995];
                                bool lifted_lambda_res_585003 = sle64(gt_arg0_585002, gt_arg1_584998);
                                bool defunc_0_lifted_gt_res_585004 = !lifted_lambda_res_585003;
                                
                                loop_cond_584997 = defunc_0_lifted_gt_res_585004;
                            } else {
                                loop_cond_584997 = 0;
                            }
                            
                            bool loop_while_tmp_588044 = loop_cond_584997;
                            int64_t j_tmp_588048 = tmp_584995;
                            
                            loop_while_584967 = loop_while_tmp_588044;
                            j_584971 = j_tmp_588048;
                        }
                        s_584962 = loop_while_584967;
                        s_584966 = j_584971;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587036, i_586096 * block_sizze_578166, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587059, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578166});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_587040, i_586096 * lmad_arg_587057, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) mem_587062, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {block_sizze_578166, dim_416322});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_587043, i_586096 * block_sizze_578166, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587064, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578166});
            }
            if (memblock_unref(ctx, &ext_mem_587033, "ext_mem_587033") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_587158, bytes_587035, "mem_587158")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587158.mem, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (uint64_t *) mem_587036, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166});
            if (memblock_alloc(ctx, &mem_587163, bytes_587039, "mem_587163")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_587163.mem, (int64_t) 0, (int64_t []) {dim_416322 * block_sizze_578166, dim_416322, (int64_t) 1}, (uint32_t *) mem_587040, (int64_t) 0, (int64_t []) {lmad_arg_587057, dim_416322, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166, dim_416322});
            if (memblock_alloc(ctx, &mem_587167, bytes_587035, "mem_587167")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_587167.mem, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (uint64_t *) mem_587043, (int64_t) 0, (int64_t []) {block_sizze_578166, (int64_t) 1}, (int64_t []) {x_582381, block_sizze_578166});
            
            int64_t data_585017;
            bool data_585018;
            int64_t data_585022;
            int64_t loop_dz2084Uz2082U_585023;
            bool loop_while_585024;
            int64_t stride_585028;
            
            if (memblock_set(ctx, &mem_param_587171, &mem_587158, "mem_587158") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587175, &mem_587163, "mem_587163") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_587178, &mem_587167, "mem_587167") != 0)
                return 1;
            loop_dz2084Uz2082U_585023 = flat_dim_578174;
            loop_while_585024 = loop_cond_578299;
            stride_585028 = block_sizze_578166;
            while (loop_while_585024) {
                int64_t next_stride_585029 = mul64((int64_t) 2, stride_585028);
                bool zzero_585030 = next_stride_585029 == (int64_t) 0;
                bool nonzzero_585031 = !zzero_585030;
                bool nonzzero_cert_585032;
                
                if (!nonzzero_585031) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_585033 = sdiv64(flat_dim_578174, next_stride_585029);
                bool bounds_invalid_upwards_585034 = slt64(num_merges_585033, (int64_t) 0);
                bool valid_585035 = !bounds_invalid_upwards_585034;
                bool range_valid_c_585036;
                
                if (!valid_585035) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_585033, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_585038 = sub64(next_stride_585029, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_585039 = sle64((int64_t) 0, m_585038);
                bool cond_585041 = slt64(next_stride_585029, (int64_t) 10);
                bool protect_assert_disj_585042 = nonzzero_578301 || cond_585041;
                bool nonzzero_cert_585043;
                
                if (!protect_assert_disj_585042) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_585044 = smod_safe64(next_stride_585029, merge_block_sizze_578179);
                bool num_blocks_585045 = zeze_lhs_585044 == (int64_t) 0;
                bool protect_assert_disj_585046 = cond_585041 || num_blocks_585045;
                bool assert_c_585047;
                
                if (!protect_assert_disj_585046) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_585048 = sdiv_safe64(next_stride_585029, merge_block_sizze_578179);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049 = add64((int64_t) 1, num_blocks_585048);
                int64_t j_m_i_585050 = sub64(next_stride_585029, stride_585028);
                int64_t flat_dim_585051 = merge_block_sizze_578179 * num_blocks_585048;
                bool bounds_invalid_upwards_585052 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, (int64_t) 0);
                bool empty_slice_585053 = j_m_i_585050 == (int64_t) 0;
                int64_t m_585054 = sub64(j_m_i_585050, (int64_t) 1);
                bool zzero_lte_i_585055 = sle64((int64_t) 0, stride_585028);
                bool i_lte_j_585056 = sle64(stride_585028, next_stride_585029);
                bool empty_slice_585057 = stride_585028 == (int64_t) 0;
                int64_t m_585058 = sub64(stride_585028, (int64_t) 1);
                bool bounds_invalid_upwards_585059 = slt64(num_blocks_585048, (int64_t) 0);
                bool cond_585060 = slt64((int64_t) 0, stride_585028);
                bool valid_585061 = !bounds_invalid_upwards_585052;
                int64_t i_p_m_t_s_585062 = add64(stride_585028, m_585054);
                bool zzero_leq_i_p_m_t_s_585063 = sle64((int64_t) 0, m_585058);
                bool i_p_m_t_s_leq_w_585064 = slt64(m_585058, next_stride_585029);
                bool valid_585065 = !bounds_invalid_upwards_585059;
                bool i_p_m_t_s_leq_w_585066 = slt64(m_585038, flat_dim_585051);
                bool y_585067 = slt64((int64_t) 0, j_m_i_585050);
                bool protect_assert_disj_585068 = cond_585041 || valid_585061;
                bool range_valid_c_585069;
                
                if (!protect_assert_disj_585068) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool zzero_leq_i_p_m_t_s_585070 = sle64((int64_t) 0, i_p_m_t_s_585062);
                bool i_p_m_t_s_leq_w_585071 = slt64(i_p_m_t_s_585062, next_stride_585029);
                bool y_585072 = zzero_leq_i_p_m_t_s_585063 && i_p_m_t_s_leq_w_585064;
                bool protect_assert_disj_585073 = cond_585041 || valid_585065;
                bool range_valid_c_585074;
                
                if (!protect_assert_disj_585073) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_585048, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_585075 = zzero_leq_i_p_m_t_s_585039 && i_p_m_t_s_leq_w_585066;
                bool y_585076 = zzero_lte_i_585055 && i_p_m_t_s_leq_w_585071;
                bool forwards_ok_585077 = zzero_lte_i_585055 && y_585072;
                bool ok_or_empty_585078 = zzero_585030 || y_585075;
                bool protect_assert_disj_585079 = cond_585060 || y_585067;
                bool y_585080 = zzero_leq_i_p_m_t_s_585070 && y_585076;
                bool ok_or_empty_585081 = empty_slice_585057 || forwards_ok_585077;
                bool protect_assert_disj_585082 = cond_585041 || ok_or_empty_585078;
                bool index_certs_585083;
                
                if (!protect_assert_disj_585082) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585029, "] out of bounds for array of shape [", (long long) flat_dim_585051, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool loop_not_taken_585084 = !cond_585041;
                bool protect_assert_disj_585085 = protect_assert_disj_585079 || loop_not_taken_585084;
                bool index_certs_585086;
                
                if (!protect_assert_disj_585085) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_585087 = i_lte_j_585056 && y_585080;
                bool protect_assert_disj_585088 = cond_585041 || ok_or_empty_585081;
                bool index_certs_585089;
                
                if (!protect_assert_disj_585088) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585028, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585090 = ok_or_empty_585081 || loop_not_taken_585084;
                bool index_certs_585091;
                
                if (!protect_assert_disj_585090) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_585028, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_585092 = empty_slice_585053 || forwards_ok_585087;
                bool protect_assert_disj_585093 = cond_585041 || ok_or_empty_585092;
                bool index_certs_585094;
                
                if (!protect_assert_disj_585093) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585028, ":] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_585095 = loop_not_taken_585084 || ok_or_empty_585092;
                bool index_certs_585096;
                
                if (!protect_assert_disj_585095) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_585028, ":] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_587179 = (int64_t) 8 * num_merges_585033;
                int64_t bytes_587180 = next_stride_585029 * binop_x_587179;
                int64_t binop_x_587182 = (int64_t) 4 * num_merges_585033;
                int64_t binop_x_587183 = next_stride_585029 * binop_x_587182;
                int64_t bytes_587184 = dim_416322 * binop_x_587183;
                bool i_lte_j_585040 = sle64((int64_t) 0, next_stride_585029);
                
                if (mem_587181_cached_sizze_589111 < bytes_587180) {
                    err = lexical_realloc(ctx, &mem_587181, &mem_587181_cached_sizze_589111, bytes_587180);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587185_cached_sizze_589112 < bytes_587184) {
                    err = lexical_realloc(ctx, &mem_587185, &mem_587185_cached_sizze_589112, bytes_587184);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_587188_cached_sizze_589113 < bytes_587180) {
                    err = lexical_realloc(ctx, &mem_587188, &mem_587188_cached_sizze_589113, bytes_587180);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_587202 = dim_416322 * next_stride_585029;
                int64_t bytes_587203 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049;
                int64_t binop_x_587219 = (int64_t) 8 * num_blocks_585048;
                int64_t bytes_587220 = merge_block_sizze_578179 * binop_x_587219;
                int64_t binop_x_587222 = (int64_t) 4 * num_blocks_585048;
                int64_t binop_x_587223 = merge_block_sizze_578179 * binop_x_587222;
                int64_t bytes_587224 = dim_416322 * binop_x_587223;
                int64_t bytes_587311 = (int64_t) 16 * stride_585028;
                int64_t binop_x_587315 = (int64_t) 8 * stride_585028;
                int64_t bytes_587316 = dim_416322 * binop_x_587315;
                
                for (int64_t i_586123 = 0; i_586123 < num_merges_585033; i_586123++) {
                    int64_t start_585101 = mul64(next_stride_585029, i_586123);
                    int64_t j_m_i_585102 = sub64(loop_dz2084Uz2082U_585023, start_585101);
                    bool empty_slice_585103 = j_m_i_585102 == (int64_t) 0;
                    int64_t m_585104 = sub64(j_m_i_585102, (int64_t) 1);
                    int64_t i_p_m_t_s_585105 = add64(start_585101, m_585104);
                    bool zzero_leq_i_p_m_t_s_585106 = sle64((int64_t) 0, i_p_m_t_s_585105);
                    bool i_p_m_t_s_leq_w_585107 = slt64(i_p_m_t_s_585105, loop_dz2084Uz2082U_585023);
                    bool zzero_lte_i_585108 = sle64((int64_t) 0, start_585101);
                    bool i_lte_j_585109 = sle64(start_585101, loop_dz2084Uz2082U_585023);
                    bool y_585110 = i_p_m_t_s_leq_w_585107 && zzero_lte_i_585108;
                    bool y_585111 = zzero_leq_i_p_m_t_s_585106 && y_585110;
                    bool forwards_ok_585112 = i_lte_j_585109 && y_585111;
                    bool ok_or_empty_585113 = empty_slice_585103 || forwards_ok_585112;
                    bool index_certs_585114;
                    
                    if (!ok_or_empty_585113) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_585101, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_585023, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_585115 = slt64(m_585038, j_m_i_585102);
                    bool y_585116 = zzero_leq_i_p_m_t_s_585039 && i_p_m_t_s_leq_w_585115;
                    bool forwards_ok_585117 = i_lte_j_585040 && y_585116;
                    bool ok_or_empty_585118 = zzero_585030 || forwards_ok_585117;
                    bool index_certs_585119;
                    
                    if (!ok_or_empty_585118) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_585029, "] out of bounds for array of shape [", (long long) j_m_i_585102, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSkyline.fut:937:33-56\n   #7  ftSkyline.fut:926:17-937:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585129 = stride_585028 + start_585101;
                    int64_t binop_y_587306 = dim_416322 * slice_585129;
                    int64_t binop_y_587308 = dim_416322 * start_585101;
                    int64_t ext_587310;
                    
                    if (cond_585060) {
                        ext_587310 = binop_y_587308;
                    } else {
                        ext_587310 = binop_y_587306;
                    }
                    if (cond_585041) {
                        int64_t dummy_585123;
                        int64_t dummy_585125;
                        
                        if (cond_585060) {
                            int64_t head_res_585126 = ((int64_t *) mem_param_587171.mem)[start_585101];
                            int64_t head_res_585128 = ((int64_t *) mem_param_587178.mem)[start_585101];
                            
                            dummy_585123 = head_res_585126;
                            dummy_585125 = head_res_585128;
                        } else {
                            int64_t head_res_585130 = ((int64_t *) mem_param_587171.mem)[slice_585129];
                            int64_t head_res_585132 = ((int64_t *) mem_param_587178.mem)[slice_585129];
                            
                            dummy_585123 = head_res_585130;
                            dummy_585125 = head_res_585132;
                        }
                        if (memblock_alloc(ctx, &mem_587312, bytes_587311, "mem_587312")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588061 = 0; nest_i_588061 < next_stride_585029; nest_i_588061++) {
                            ((int64_t *) mem_587312.mem)[nest_i_588061] = dummy_585123;
                        }
                        if (memblock_alloc(ctx, &mem_587314, bytes_587311, "mem_587314")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588062 = 0; nest_i_588062 < next_stride_585029; nest_i_588062++) {
                            ((int64_t *) mem_587314.mem)[nest_i_588062] = dummy_585125;
                        }
                        if (memblock_alloc(ctx, &mem_587317, bytes_587316, "mem_587317")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588063 = 0; nest_i_588063 < next_stride_585029; nest_i_588063++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587317.mem, nest_i_588063 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587175.mem, ext_587310, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                        }
                        
                        int64_t data_585136;
                        int64_t i_585141 = (int64_t) 0;
                        
                        for (int64_t k_585140 = 0; k_585140 < next_stride_585029; k_585140++) {
                            int64_t j_585145 = sub64(k_585140, i_585141);
                            bool cond_585146 = j_585145 == j_m_i_585050;
                            bool x_587779 = !cond_585146;
                            bool cond_585148 = slt64(i_585141, stride_585028);
                            bool x_585150 = sle64((int64_t) 0, j_585145);
                            bool y_585151 = slt64(j_585145, j_m_i_585050);
                            bool bounds_check_585152 = x_585150 && y_585151;
                            bool loop_not_taken_587771 = !cond_585148;
                            bool protect_assert_disj_587772 = bounds_check_585152 || loop_not_taken_587771;
                            bool protect_assert_disj_587782 = cond_585146 || protect_assert_disj_587772;
                            bool index_certs_585153;
                            
                            if (!protect_assert_disj_587782) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585145, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585154 = stride_585028 + j_585145;
                            int64_t slice_585155 = start_585101 + slice_585154;
                            bool protect_cond_conj_587783 = cond_585148 && x_587779;
                            int64_t leq_arg1_585156;
                            
                            if (protect_cond_conj_587783) {
                                int64_t x_587773 = ((int64_t *) mem_param_587171.mem)[slice_585155];
                                
                                leq_arg1_585156 = x_587773;
                            } else {
                                leq_arg1_585156 = (int64_t) 0;
                            }
                            
                            bool x_585157 = sle64((int64_t) 0, i_585141);
                            bool bounds_check_585158 = cond_585148 && x_585157;
                            bool protect_assert_disj_587776 = bounds_check_585158 || loop_not_taken_587771;
                            bool protect_assert_disj_587785 = cond_585146 || protect_assert_disj_587776;
                            bool index_certs_585159;
                            
                            if (!protect_assert_disj_587785) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585141, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585160 = start_585101 + i_585141;
                            int64_t leq_arg0_585161;
                            
                            if (protect_cond_conj_587783) {
                                int64_t x_587777 = ((int64_t *) mem_param_587171.mem)[slice_585160];
                                
                                leq_arg0_585161 = x_587777;
                            } else {
                                leq_arg0_585161 = (int64_t) 0;
                            }
                            
                            bool lifted_lambda_res_585162 = sle64(leq_arg0_585161, leq_arg1_585156);
                            bool x_587859 = cond_585148 && lifted_lambda_res_585162;
                            bool cond_585147 = cond_585146 || x_587859;
                            bool protect_assert_disj_587695 = cond_585147 || bounds_check_585152;
                            bool index_certs_585179;
                            
                            if (!protect_assert_disj_587695) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585145, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585170 = cond_585148 && x_585157;
                            bool loop_not_taken_587690 = !cond_585147;
                            bool protect_assert_disj_587691 = bounds_check_585170 || loop_not_taken_587690;
                            bool index_certs_585171;
                            
                            if (!protect_assert_disj_587691) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585141, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585181 = start_585101 + slice_585154;
                            int64_t binop_y_587328 = dim_416322 * slice_585181;
                            int64_t binop_y_587330 = dim_416322 * slice_585160;
                            int64_t ext_587332;
                            
                            if (cond_585147) {
                                ext_587332 = binop_y_587330;
                            } else {
                                ext_587332 = binop_y_587328;
                            }
                            
                            int64_t loopres_585163;
                            int64_t loopres_585164;
                            int64_t loopres_585166;
                            
                            if (cond_585147) {
                                int64_t tmp_585167 = add64((int64_t) 1, i_585141);
                                int64_t tmp_585173 = ((int64_t *) mem_param_587171.mem)[slice_585160];
                                int64_t tmp_585175 = ((int64_t *) mem_param_587178.mem)[slice_585160];
                                
                                loopres_585163 = tmp_585167;
                                loopres_585164 = tmp_585173;
                                loopres_585166 = tmp_585175;
                            } else {
                                int64_t tmp_585182 = ((int64_t *) mem_param_587171.mem)[slice_585181];
                                int64_t tmp_585184 = ((int64_t *) mem_param_587178.mem)[slice_585181];
                                
                                loopres_585163 = i_585141;
                                loopres_585164 = tmp_585182;
                                loopres_585166 = tmp_585184;
                            }
                            ((int64_t *) mem_587312.mem)[k_585140] = loopres_585164;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587317.mem, k_585140 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587175.mem, ext_587332, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_587314.mem)[k_585140] = loopres_585166;
                            
                            int64_t i_tmp_588064 = loopres_585163;
                            
                            i_585141 = i_tmp_588064;
                        }
                        data_585136 = i_585141;
                        if (memblock_set(ctx, &ext_mem_587352, &mem_587312, "mem_587312") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587349, &mem_587317, "mem_587317") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587345, &mem_587314, "mem_587314") != 0)
                            return 1;
                    } else {
                        if (mem_587204_cached_sizze_589114 < bytes_587203) {
                            err = lexical_realloc(ctx, &mem_587204, &mem_587204_cached_sizze_589114, bytes_587203);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587206_cached_sizze_589115 < bytes_587203) {
                            err = lexical_realloc(ctx, &mem_587206, &mem_587206_cached_sizze_589115, bytes_587203);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586104 = 0; i_586104 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049; i_586104++) {
                            int64_t split_count_arg3_585192 = mul64(merge_block_sizze_578179, i_586104);
                            int64_t defunc_0_split_count_res_585193;
                            int64_t defunc_0_split_count_res_585194;
                            int64_t defunc_0_split_count_res_585195;
                            int64_t defunc_0_split_count_res_585196;
                            int64_t defunc_0_split_count_res_585197;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_585193, &defunc_0_split_count_res_585194, &defunc_0_split_count_res_585195, &defunc_0_split_count_res_585196, &defunc_0_split_count_res_585197, (int64_t) 0, stride_585028, (int64_t) 0, j_m_i_585050, split_count_arg3_585192) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_585198 = slt64((int64_t) 0, defunc_0_split_count_res_585197);
                            bool defunc_0_split_count_res_585199;
                            int64_t defunc_0_split_count_res_585200;
                            int64_t defunc_0_split_count_res_585201;
                            int64_t defunc_0_split_count_res_585202;
                            int64_t defunc_0_split_count_res_585203;
                            int64_t defunc_0_split_count_res_585204;
                            bool loop_while_585205;
                            int64_t ss_585206;
                            int64_t ss_585207;
                            int64_t tt_585208;
                            int64_t tt_585209;
                            int64_t count_585210;
                            
                            loop_while_585205 = loop_cond_585198;
                            ss_585206 = defunc_0_split_count_res_585193;
                            ss_585207 = defunc_0_split_count_res_585194;
                            tt_585208 = defunc_0_split_count_res_585195;
                            tt_585209 = defunc_0_split_count_res_585196;
                            count_585210 = defunc_0_split_count_res_585197;
                            while (loop_while_585205) {
                                int64_t zlze_lhs_585211 = sub64(ss_585207, ss_585206);
                                bool cond_585212 = sle64(zlze_lhs_585211, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_585213;
                                int64_t defunc_0_lifted_step_res_585214;
                                int64_t defunc_0_lifted_step_res_585215;
                                int64_t defunc_0_lifted_step_res_585216;
                                
                                if (cond_585212) {
                                    int64_t tmp_585217 = add64(tt_585208, count_585210);
                                    
                                    defunc_0_lifted_step_res_585213 = ss_585206;
                                    defunc_0_lifted_step_res_585214 = tmp_585217;
                                    defunc_0_lifted_step_res_585215 = tt_585209;
                                    defunc_0_lifted_step_res_585216 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_585218 = sub64(tt_585209, tt_585208);
                                    bool cond_585219 = sle64(zlze_lhs_585218, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_585220;
                                    int64_t defunc_0_lifted_step_res_f_res_585221;
                                    int64_t defunc_0_lifted_step_res_f_res_585222;
                                    int64_t defunc_0_lifted_step_res_f_res_585223;
                                    
                                    if (cond_585219) {
                                        int64_t tmp_585224 = add64(ss_585206, count_585210);
                                        
                                        defunc_0_lifted_step_res_f_res_585220 = tmp_585224;
                                        defunc_0_lifted_step_res_f_res_585221 = tt_585208;
                                        defunc_0_lifted_step_res_f_res_585222 = tt_585209;
                                        defunc_0_lifted_step_res_f_res_585223 = (int64_t) 0;
                                    } else {
                                        bool cond_585225 = count_585210 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585226;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585227;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585228;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_585229;
                                        
                                        if (cond_585225) {
                                            bool x_585230 = sle64((int64_t) 0, ss_585206);
                                            bool y_585231 = slt64(ss_585206, stride_585028);
                                            bool bounds_check_585232 = x_585230 && y_585231;
                                            bool index_certs_585233;
                                            
                                            if (!bounds_check_585232) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_585206, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:937:33-56\n   #12 ftSkyline.fut:926:17-937:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585236 = sle64((int64_t) 0, tt_585208);
                                            bool y_585237 = slt64(tt_585208, j_m_i_585050);
                                            bool bounds_check_585238 = x_585236 && y_585237;
                                            bool index_certs_585239;
                                            
                                            if (!bounds_check_585238) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_585208, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:937:33-56\n   #12 ftSkyline.fut:926:17-937:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585234 = start_585101 + ss_585206;
                                            int64_t leq_arg1_585235 = ((int64_t *) mem_param_587171.mem)[slice_585234];
                                            int64_t slice_585240 = stride_585028 + tt_585208;
                                            int64_t slice_585241 = start_585101 + slice_585240;
                                            int64_t leq_arg0_585242 = ((int64_t *) mem_param_587171.mem)[slice_585241];
                                            bool lifted_lambda_res_585243 = sle64(leq_arg0_585242, leq_arg1_585235);
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585244;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585245;
                                            
                                            if (lifted_lambda_res_585243) {
                                                int64_t tmp_585246 = add64((int64_t) 1, tt_585208);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585244 = ss_585206;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585245 = tmp_585246;
                                            } else {
                                                int64_t tmp_585247 = add64((int64_t) 1, ss_585206);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585244 = tmp_585247;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585245 = tt_585208;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585226 = defunc_0_lifted_step_res_f_res_f_res_t_res_585244;
                                            defunc_0_lifted_step_res_f_res_f_res_585227 = defunc_0_lifted_step_res_f_res_f_res_t_res_585245;
                                            defunc_0_lifted_step_res_f_res_f_res_585228 = tt_585209;
                                            defunc_0_lifted_step_res_f_res_f_res_585229 = (int64_t) 0;
                                        } else {
                                            int64_t m_585248 = sdiv64(count_585210, (int64_t) 2);
                                            int64_t n_585249 = sub64(count_585210, m_585248);
                                            bool cond_585250 = n_585249 == (int64_t) 0;
                                            int64_t zgze_lhs_585251 = add64(ss_585206, m_585248);
                                            bool cond_f_res_585252 = sle64(ss_585207, zgze_lhs_585251);
                                            bool x_585253 = !cond_585250;
                                            bool y_585254 = cond_f_res_585252 && x_585253;
                                            bool cond_585255 = cond_585250 || y_585254;
                                            bool leq_y_x_585256;
                                            
                                            if (cond_585255) {
                                                leq_y_x_585256 = 1;
                                            } else {
                                                bool x_585257 = sle64((int64_t) 0, zgze_lhs_585251);
                                                bool y_585258 = slt64(zgze_lhs_585251, stride_585028);
                                                bool bounds_check_585259 = x_585257 && y_585258;
                                                bool index_certs_585260;
                                                
                                                if (!bounds_check_585259) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_585251, "] out of bounds for array of shape [", (long long) stride_585028, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:937:33-56\n   #12 ftSkyline.fut:926:17-937:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_585263 = add64(tt_585208, n_585249);
                                                int64_t leq_arg0_585264 = sub64(zm_lhs_585263, (int64_t) 1);
                                                bool x_585265 = sle64((int64_t) 0, leq_arg0_585264);
                                                bool y_585266 = slt64(leq_arg0_585264, j_m_i_585050);
                                                bool bounds_check_585267 = x_585265 && y_585266;
                                                bool index_certs_585268;
                                                
                                                if (!bounds_check_585267) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_585264, "] out of bounds for array of shape [", (long long) j_m_i_585050, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:937:33-56\n   #12 ftSkyline.fut:926:17-937:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_585261 = start_585101 + zgze_lhs_585251;
                                                int64_t leq_arg1_585262 = ((int64_t *) mem_param_587171.mem)[slice_585261];
                                                int64_t slice_585269 = stride_585028 + leq_arg0_585264;
                                                int64_t slice_585270 = start_585101 + slice_585269;
                                                int64_t leq_arg0_585271 = ((int64_t *) mem_param_587171.mem)[slice_585270];
                                                bool lifted_lambda_res_585272 = sle64(leq_arg0_585271, leq_arg1_585262);
                                                
                                                leq_y_x_585256 = lifted_lambda_res_585272;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585273;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585274;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_585275;
                                            
                                            if (leq_y_x_585256) {
                                                int64_t tmp_585276 = add64(tt_585208, n_585249);
                                                int64_t tmp_585277 = sub64(count_585210, n_585249);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585273 = tmp_585276;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585274 = tt_585209;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585275 = tmp_585277;
                                            } else {
                                                int64_t tmp_585278 = add64(tt_585208, n_585249);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585273 = tt_585208;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585274 = tmp_585278;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_585275 = count_585210;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_585226 = ss_585206;
                                            defunc_0_lifted_step_res_f_res_f_res_585227 = defunc_0_lifted_step_res_f_res_f_res_f_res_585273;
                                            defunc_0_lifted_step_res_f_res_f_res_585228 = defunc_0_lifted_step_res_f_res_f_res_f_res_585274;
                                            defunc_0_lifted_step_res_f_res_f_res_585229 = defunc_0_lifted_step_res_f_res_f_res_f_res_585275;
                                        }
                                        defunc_0_lifted_step_res_f_res_585220 = defunc_0_lifted_step_res_f_res_f_res_585226;
                                        defunc_0_lifted_step_res_f_res_585221 = defunc_0_lifted_step_res_f_res_f_res_585227;
                                        defunc_0_lifted_step_res_f_res_585222 = defunc_0_lifted_step_res_f_res_f_res_585228;
                                        defunc_0_lifted_step_res_f_res_585223 = defunc_0_lifted_step_res_f_res_f_res_585229;
                                    }
                                    defunc_0_lifted_step_res_585213 = defunc_0_lifted_step_res_f_res_585220;
                                    defunc_0_lifted_step_res_585214 = defunc_0_lifted_step_res_f_res_585221;
                                    defunc_0_lifted_step_res_585215 = defunc_0_lifted_step_res_f_res_585222;
                                    defunc_0_lifted_step_res_585216 = defunc_0_lifted_step_res_f_res_585223;
                                }
                                
                                int64_t loopres_585279;
                                int64_t loopres_585280;
                                int64_t loopres_585281;
                                int64_t loopres_585282;
                                int64_t loopres_585283;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_585279, &loopres_585280, &loopres_585281, &loopres_585282, &loopres_585283, defunc_0_lifted_step_res_585213, ss_585207, defunc_0_lifted_step_res_585214, defunc_0_lifted_step_res_585215, defunc_0_lifted_step_res_585216) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_585284 = slt64((int64_t) 0, loopres_585283);
                                bool loop_while_tmp_588070 = loop_cond_585284;
                                int64_t ss_tmp_588071 = loopres_585279;
                                int64_t ss_tmp_588072 = loopres_585280;
                                int64_t tt_tmp_588073 = loopres_585281;
                                int64_t tt_tmp_588074 = loopres_585282;
                                int64_t count_tmp_588075 = loopres_585283;
                                
                                loop_while_585205 = loop_while_tmp_588070;
                                ss_585206 = ss_tmp_588071;
                                ss_585207 = ss_tmp_588072;
                                tt_585208 = tt_tmp_588073;
                                tt_585209 = tt_tmp_588074;
                                count_585210 = count_tmp_588075;
                            }
                            defunc_0_split_count_res_585199 = loop_while_585205;
                            defunc_0_split_count_res_585200 = ss_585206;
                            defunc_0_split_count_res_585201 = ss_585207;
                            defunc_0_split_count_res_585202 = tt_585208;
                            defunc_0_split_count_res_585203 = tt_585209;
                            defunc_0_split_count_res_585204 = count_585210;
                            ((int64_t *) mem_587204)[i_586104] = defunc_0_split_count_res_585200;
                            ((int64_t *) mem_587206)[i_586104] = defunc_0_split_count_res_585202;
                        }
                        if (mem_587221_cached_sizze_589116 < bytes_587220) {
                            err = lexical_realloc(ctx, &mem_587221, &mem_587221_cached_sizze_589116, bytes_587220);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587225_cached_sizze_589117 < bytes_587224) {
                            err = lexical_realloc(ctx, &mem_587225, &mem_587225_cached_sizze_589117, bytes_587224);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_587228_cached_sizze_589118 < bytes_587220) {
                            err = lexical_realloc(ctx, &mem_587228, &mem_587228_cached_sizze_589118, bytes_587220);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586113 = 0; i_586113 < num_blocks_585048; i_586113++) {
                            bool y_585293 = slt64(i_586113, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049);
                            bool index_certs_585295;
                            
                            if (!y_585293) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586113, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585296 = ((int64_t *) mem_587204)[i_586113];
                            int64_t defunc_0_f_res_585297 = ((int64_t *) mem_587206)[i_586113];
                            int64_t tmp_585298 = add64((int64_t) 1, i_586113);
                            bool x_585299 = sle64((int64_t) 0, tmp_585298);
                            bool y_585300 = slt64(tmp_585298, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049);
                            bool bounds_check_585301 = x_585299 && y_585300;
                            bool index_certs_585302;
                            
                            if (!bounds_check_585301) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_585298, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_585049, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_585303 = ((int64_t *) mem_587204)[tmp_585298];
                            int64_t defunc_0_f_res_585304 = ((int64_t *) mem_587206)[tmp_585298];
                            int64_t merge_sequential_arg2_585305 = add64(stride_585028, defunc_0_f_res_585297);
                            int64_t merge_sequential_arg2_585306 = add64(stride_585028, defunc_0_f_res_585304);
                            int64_t j_m_i_585307 = sub64(merge_sequential_arg2_585306, merge_sequential_arg2_585305);
                            bool empty_slice_585308 = j_m_i_585307 == (int64_t) 0;
                            int64_t m_585309 = sub64(j_m_i_585307, (int64_t) 1);
                            int64_t i_p_m_t_s_585310 = add64(merge_sequential_arg2_585305, m_585309);
                            bool zzero_leq_i_p_m_t_s_585311 = sle64((int64_t) 0, i_p_m_t_s_585310);
                            bool i_p_m_t_s_leq_w_585312 = slt64(i_p_m_t_s_585310, next_stride_585029);
                            bool zzero_lte_i_585313 = sle64((int64_t) 0, merge_sequential_arg2_585305);
                            bool i_lte_j_585314 = sle64(merge_sequential_arg2_585305, merge_sequential_arg2_585306);
                            bool y_585315 = i_p_m_t_s_leq_w_585312 && zzero_lte_i_585313;
                            bool y_585316 = zzero_leq_i_p_m_t_s_585311 && y_585315;
                            bool forwards_ok_585317 = i_lte_j_585314 && y_585316;
                            bool ok_or_empty_585318 = empty_slice_585308 || forwards_ok_585317;
                            bool index_certs_585319;
                            
                            if (!ok_or_empty_585318) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_585305, ":", (long long) merge_sequential_arg2_585306, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_585320 = sub64(defunc_0_f_res_585303, defunc_0_f_res_585296);
                            bool empty_slice_585321 = j_m_i_585320 == (int64_t) 0;
                            int64_t m_585322 = sub64(j_m_i_585320, (int64_t) 1);
                            int64_t i_p_m_t_s_585323 = add64(defunc_0_f_res_585296, m_585322);
                            bool zzero_leq_i_p_m_t_s_585324 = sle64((int64_t) 0, i_p_m_t_s_585323);
                            bool i_p_m_t_s_leq_w_585325 = slt64(i_p_m_t_s_585323, next_stride_585029);
                            bool zzero_lte_i_585326 = sle64((int64_t) 0, defunc_0_f_res_585296);
                            bool i_lte_j_585327 = sle64(defunc_0_f_res_585296, defunc_0_f_res_585303);
                            bool y_585328 = i_p_m_t_s_leq_w_585325 && zzero_lte_i_585326;
                            bool y_585329 = zzero_leq_i_p_m_t_s_585324 && y_585328;
                            bool forwards_ok_585330 = i_lte_j_585327 && y_585329;
                            bool ok_or_empty_585331 = empty_slice_585321 || forwards_ok_585330;
                            bool index_certs_585332;
                            
                            if (!ok_or_empty_585331) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_585296, ":", (long long) defunc_0_f_res_585303, "] out of bounds for array of shape [", (long long) next_stride_585029, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_585333 = slt64((int64_t) 0, j_m_i_585320);
                            bool y_585342 = slt64((int64_t) 0, j_m_i_585307);
                            bool protect_assert_disj_587711 = cond_585333 || y_585342;
                            bool index_certs_585343;
                            
                            if (!protect_assert_disj_587711) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585344 = start_585101 + merge_sequential_arg2_585305;
                            int64_t binop_y_587243 = dim_416322 * slice_585344;
                            int64_t slice_585338 = start_585101 + defunc_0_f_res_585296;
                            int64_t binop_y_587245 = dim_416322 * slice_585338;
                            int64_t ext_587247;
                            
                            if (cond_585333) {
                                ext_587247 = binop_y_587245;
                            } else {
                                ext_587247 = binop_y_587243;
                            }
                            
                            int64_t dummy_585334;
                            int64_t dummy_585336;
                            
                            if (cond_585333) {
                                int64_t head_res_585339 = ((int64_t *) mem_param_587171.mem)[slice_585338];
                                int64_t head_res_585341 = ((int64_t *) mem_param_587178.mem)[slice_585338];
                                
                                dummy_585334 = head_res_585339;
                                dummy_585336 = head_res_585341;
                            } else {
                                int64_t head_res_585345 = ((int64_t *) mem_param_587171.mem)[slice_585344];
                                int64_t head_res_585347 = ((int64_t *) mem_param_587178.mem)[slice_585344];
                                
                                dummy_585334 = head_res_585345;
                                dummy_585336 = head_res_585347;
                            }
                            for (int64_t nest_i_588079 = 0; nest_i_588079 < merge_block_sizze_578179; nest_i_588079++) {
                                ((int64_t *) mem_587221)[i_586113 * merge_block_sizze_578179 + nest_i_588079] = dummy_585334;
                            }
                            for (int64_t nest_i_588080 = 0; nest_i_588080 < merge_block_sizze_578179; nest_i_588080++) {
                                ((int64_t *) mem_587228)[i_586113 * merge_block_sizze_578179 + nest_i_588080] = dummy_585336;
                            }
                            for (int64_t nest_i_588081 = 0; nest_i_588081 < merge_block_sizze_578179; nest_i_588081++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587225, i_586113 * lmad_arg_587242 + nest_i_588081 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587175.mem, ext_587247, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            }
                            
                            int64_t data_585351;
                            int64_t i_585356 = (int64_t) 0;
                            
                            for (int64_t k_585355 = 0; k_585355 < merge_block_sizze_578179; k_585355++) {
                                int64_t j_585360 = sub64(k_585355, i_585356);
                                bool cond_585361 = j_585360 == j_m_i_585307;
                                bool x_587797 = !cond_585361;
                                bool cond_585363 = slt64(i_585356, j_m_i_585320);
                                bool x_585365 = sle64((int64_t) 0, j_585360);
                                bool y_585366 = slt64(j_585360, j_m_i_585307);
                                bool bounds_check_585367 = x_585365 && y_585366;
                                bool loop_not_taken_587789 = !cond_585363;
                                bool protect_assert_disj_587790 = bounds_check_585367 || loop_not_taken_587789;
                                bool protect_assert_disj_587800 = cond_585361 || protect_assert_disj_587790;
                                bool index_certs_585368;
                                
                                if (!protect_assert_disj_587800) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585360, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585369 = merge_sequential_arg2_585305 + j_585360;
                                int64_t slice_585370 = start_585101 + slice_585369;
                                bool protect_cond_conj_587801 = cond_585363 && x_587797;
                                int64_t leq_arg1_585371;
                                
                                if (protect_cond_conj_587801) {
                                    int64_t x_587791 = ((int64_t *) mem_param_587171.mem)[slice_585370];
                                    
                                    leq_arg1_585371 = x_587791;
                                } else {
                                    leq_arg1_585371 = (int64_t) 0;
                                }
                                
                                bool x_585372 = sle64((int64_t) 0, i_585356);
                                bool bounds_check_585373 = cond_585363 && x_585372;
                                bool protect_assert_disj_587794 = bounds_check_585373 || loop_not_taken_587789;
                                bool protect_assert_disj_587803 = cond_585361 || protect_assert_disj_587794;
                                bool index_certs_585374;
                                
                                if (!protect_assert_disj_587803) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585356, "] out of bounds for array of shape [", (long long) j_m_i_585320, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585375 = defunc_0_f_res_585296 + i_585356;
                                int64_t slice_585376 = start_585101 + slice_585375;
                                int64_t leq_arg0_585377;
                                
                                if (protect_cond_conj_587801) {
                                    int64_t x_587795 = ((int64_t *) mem_param_587171.mem)[slice_585376];
                                    
                                    leq_arg0_585377 = x_587795;
                                } else {
                                    leq_arg0_585377 = (int64_t) 0;
                                }
                                
                                bool lifted_lambda_res_585378 = sle64(leq_arg0_585377, leq_arg1_585371);
                                bool x_587862 = cond_585363 && lifted_lambda_res_585378;
                                bool cond_585362 = cond_585361 || x_587862;
                                bool protect_assert_disj_587703 = cond_585362 || bounds_check_585367;
                                bool index_certs_585396;
                                
                                if (!protect_assert_disj_587703) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585360, "] out of bounds for array of shape [", (long long) j_m_i_585307, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585386 = cond_585363 && x_585372;
                                bool loop_not_taken_587698 = !cond_585362;
                                bool protect_assert_disj_587699 = bounds_check_585386 || loop_not_taken_587698;
                                bool index_certs_585387;
                                
                                if (!protect_assert_disj_587699) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585356, "] out of bounds for array of shape [", (long long) j_m_i_585320, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585398 = start_585101 + slice_585369;
                                int64_t binop_y_587265 = dim_416322 * slice_585398;
                                int64_t slice_585389 = start_585101 + slice_585375;
                                int64_t binop_y_587267 = dim_416322 * slice_585389;
                                int64_t ext_587269;
                                
                                if (cond_585362) {
                                    ext_587269 = binop_y_587267;
                                } else {
                                    ext_587269 = binop_y_587265;
                                }
                                
                                int64_t loopres_585379;
                                int64_t loopres_585380;
                                int64_t loopres_585382;
                                
                                if (cond_585362) {
                                    int64_t tmp_585383 = add64((int64_t) 1, i_585356);
                                    int64_t tmp_585390 = ((int64_t *) mem_param_587171.mem)[slice_585389];
                                    int64_t tmp_585392 = ((int64_t *) mem_param_587178.mem)[slice_585389];
                                    
                                    loopres_585379 = tmp_585383;
                                    loopres_585380 = tmp_585390;
                                    loopres_585382 = tmp_585392;
                                } else {
                                    int64_t tmp_585399 = ((int64_t *) mem_param_587171.mem)[slice_585398];
                                    int64_t tmp_585401 = ((int64_t *) mem_param_587178.mem)[slice_585398];
                                    
                                    loopres_585379 = i_585356;
                                    loopres_585380 = tmp_585399;
                                    loopres_585382 = tmp_585401;
                                }
                                ((int64_t *) mem_587221)[i_586113 * merge_block_sizze_578179 + k_585355] = loopres_585380;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_587225, i_586113 * lmad_arg_587242 + k_585355 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_587175.mem, ext_587269, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                                ((int64_t *) mem_587228)[i_586113 * merge_block_sizze_578179 + k_585355] = loopres_585382;
                                
                                int64_t i_tmp_588082 = loopres_585379;
                                
                                i_585356 = i_tmp_588082;
                            }
                            data_585351 = i_585356;
                        }
                        if (memblock_alloc(ctx, &mem_587295, bytes_587220, "mem_587295")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587295.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (uint64_t *) mem_587221, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179});
                        if (memblock_alloc(ctx, &mem_587300, bytes_587224, "mem_587300")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_587300.mem, (int64_t) 0, (int64_t []) {dim_416322 * merge_block_sizze_578179, dim_416322, (int64_t) 1}, (uint32_t *) mem_587225, (int64_t) 0, (int64_t []) {lmad_arg_587242, dim_416322, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179, dim_416322});
                        if (memblock_alloc(ctx, &mem_587304, bytes_587220, "mem_587304")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_587304.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (uint64_t *) mem_587228, (int64_t) 0, (int64_t []) {merge_block_sizze_578179, (int64_t) 1}, (int64_t []) {num_blocks_585048, merge_block_sizze_578179});
                        if (memblock_set(ctx, &ext_mem_587352, &mem_587295, "mem_587295") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587349, &mem_587300, "mem_587300") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_587345, &mem_587304, "mem_587304") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587181, i_586123 * next_stride_585029, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587352.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585029});
                    if (memblock_unref(ctx, &ext_mem_587352, "ext_mem_587352") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587185, i_586123 * lmad_arg_587202, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) ext_mem_587349.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {next_stride_585029, dim_416322});
                    if (memblock_unref(ctx, &ext_mem_587349, "ext_mem_587349") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587188, i_586123 * next_stride_585029, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587345.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_585029});
                    if (memblock_unref(ctx, &ext_mem_587345, "ext_mem_587345") != 0)
                        return 1;
                }
                
                int64_t flat_dim_585423 = next_stride_585029 * num_merges_585033;
                
                if (memblock_alloc(ctx, &mem_587368, bytes_587180, "mem_587368")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587368.mem, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (uint64_t *) mem_587181, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029});
                if (memblock_alloc(ctx, &mem_587373, bytes_587184, "mem_587373")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_587373.mem, (int64_t) 0, (int64_t []) {dim_416322 * next_stride_585029, dim_416322, (int64_t) 1}, (uint32_t *) mem_587185, (int64_t) 0, (int64_t []) {lmad_arg_587202, dim_416322, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029, dim_416322});
                if (memblock_alloc(ctx, &mem_587377, bytes_587180, "mem_587377")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_587377.mem, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (uint64_t *) mem_587188, (int64_t) 0, (int64_t []) {next_stride_585029, (int64_t) 1}, (int64_t []) {num_merges_585033, next_stride_585029});
                
                bool loop_cond_585427 = slt64(next_stride_585029, flat_dim_578174);
                
                if (memblock_set(ctx, &mem_param_tmp_588049, &mem_587368, "mem_587368") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588050, &mem_587373, "mem_587373") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588051, &mem_587377, "mem_587377") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588052 = flat_dim_585423;
                bool loop_while_tmp_588053 = loop_cond_585427;
                int64_t stride_tmp_588057 = next_stride_585029;
                
                if (memblock_set(ctx, &mem_param_587171, &mem_param_tmp_588049, "mem_param_tmp_588049") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587175, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_587178, &mem_param_tmp_588051, "mem_param_tmp_588051") != 0)
                    return 1;
                loop_dz2084Uz2082U_585023 = loop_dz2084Uz2082U_tmp_588052;
                loop_while_585024 = loop_while_tmp_588053;
                stride_585028 = stride_tmp_588057;
            }
            if (memblock_set(ctx, &ext_mem_587388, &mem_param_587171, "mem_param_587171") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587387, &mem_param_587175, "mem_param_587175") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587386, &mem_param_587178, "mem_param_587178") != 0)
                return 1;
            data_585017 = loop_dz2084Uz2082U_585023;
            data_585018 = loop_while_585024;
            data_585022 = stride_585028;
            if (memblock_unref(ctx, &mem_587158, "mem_587158") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587163, "mem_587163") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_587167, "mem_587167") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_585428 = slt64(zs_lhs_578851, data_585017);
            bool y_585429 = zzero_leq_i_p_m_t_s_579510 && i_p_m_t_s_leq_w_585428;
            bool ok_or_empty_585430 = empty_slice_579509 || y_585429;
            bool index_certs_585431;
            
            if (!ok_or_empty_585430) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_416325, "] out of bounds for array of shape [", (long long) data_585017, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_587395, &ext_mem_587387, "ext_mem_587387") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_587391, &ext_mem_587386, "ext_mem_587386") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_587397, bytes_586418, "mem_587397")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_587397.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587391.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_416325});
        if (memblock_unref(ctx, &ext_mem_587391, "ext_mem_587391") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_587400, bytes_586966, "mem_587400")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_587400.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) ext_mem_587395.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {n_416325, dim_416322});
        if (memblock_unref(ctx, &ext_mem_587395, "ext_mem_587395") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587402, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587401, &mem_587397, "mem_587397") != 0)
            return 1;
    } else {
        if (mem_586427_cached_sizze_589067 < bytes_586426) {
            err = lexical_realloc(ctx, &mem_586427, &mem_586427_cached_sizze_589067, bytes_586426);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586129 = 0; i_586129 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324; i_586129++) {
            int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_578814 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586129];
            float i64_res_578815 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_578814);
            float defunc_0_fover_res_578816 = 1.5707964F / i64_res_578815;
            
            ((float *) mem_586427)[i_586129] = defunc_0_fover_res_578816;
        }
        if (mem_586435_cached_sizze_589068 < bytes_586418) {
            err = lexical_realloc(ctx, &mem_586435, &mem_586435_cached_sizze_589068, bytes_586418);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586437_cached_sizze_589069 < bytes_586436) {
            err = lexical_realloc(ctx, &mem_586437, &mem_586437_cached_sizze_589069, bytes_586436);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586445_cached_sizze_589070 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_586445, &mem_586445_cached_sizze_589070, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586453_cached_sizze_589071 < bytes_586452) {
            err = lexical_realloc(ctx, &mem_586453, &mem_586453_cached_sizze_589071, bytes_586452);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586455_cached_sizze_589072 < bytes_586452) {
            err = lexical_realloc(ctx, &mem_586455, &mem_586455_cached_sizze_589072, bytes_586452);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586469_cached_sizze_589073 < bytes_586468) {
            err = lexical_realloc(ctx, &mem_586469, &mem_586469_cached_sizze_589073, bytes_586468);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_586485_cached_sizze_589075 < bytes_586484) {
            err = lexical_realloc(ctx, &mem_586485, &mem_586485_cached_sizze_589075, bytes_586484);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_586154 = 0; i_586154 < n_416325; i_586154++) {
            for (int64_t i_586133 = 0; i_586133 < dim_416322; i_586133++) {
                float eta_p_583813 = ((float *) xs_mem_586417.mem)[i_586154 * dim_416322 + i_586133];
                float eta_p_583814 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586133];
                float eta_p_583815 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586133];
                int64_t eta_p_583817 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586133];
                float defunc_0_f_res_583818 = eta_p_583813 - eta_p_583814;
                float defunc_0_f_res_583820 = defunc_0_f_res_583818 / eta_p_583815;
                int64_t f32_res_583822 = fptosi_f32_i64(defunc_0_f_res_583820);
                int64_t max_res_583824 = smax64((int64_t) 0, f32_res_583822);
                int64_t zm_lhs_583830 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586133];
                int64_t min_arg1_583831 = sub64(zm_lhs_583830, (int64_t) 1);
                int64_t min_res_583832 = smin64(max_res_583824, min_arg1_583831);
                int64_t defunc_0_f_res_583834 = mul64(eta_p_583817, min_res_583832);
                
                ((int64_t *) mem_586445)[i_586133] = defunc_0_f_res_583834;
            }
            
            int64_t defunc_0_foldl_res_578750;
            int64_t acc_578752 = (int64_t) 0;
            
            for (int64_t i_578751 = 0; i_578751 < dim_416322; i_578751++) {
                int64_t b_578753 = ((int64_t *) mem_586445)[i_578751];
                int64_t defunc_0_f_res_578754 = add64(acc_578752, b_578753);
                int64_t acc_tmp_588090 = defunc_0_f_res_578754;
                
                acc_578752 = acc_tmp_588090;
            }
            defunc_0_foldl_res_578750 = acc_578752;
            
            bool x_578755 = sle64((int64_t) 0, defunc_0_foldl_res_578750);
            bool y_578756 = slt64(defunc_0_foldl_res_578750, dz2080U_416323);
            bool bounds_check_578757 = x_578755 && y_578756;
            bool index_certs_578758;
            
            if (!bounds_check_578757) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_578750, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            for (int64_t i_586139 = 0; i_586139 < dim_416322; i_586139++) {
                float eta_p_583742 = ((float *) xs_mem_586417.mem)[i_586154 * dim_416322 + i_586139];
                float eta_p_583743 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_578750 * dim_416322 + i_586139];
                float defunc_0_f_res_583744 = eta_p_583742 - eta_p_583743;
                float defunc_0_ftimes_res_583746 = defunc_0_f_res_583744 * defunc_0_f_res_583744;
                
                ((float *) mem_586453)[i_586139] = defunc_0_ftimes_res_583746;
                ((float *) mem_586455)[i_586139] = defunc_0_f_res_583744;
            }
            
            float defunc_0_foldl_res_578768;
            float acc_578770 = 0.0F;
            
            for (int64_t i_578769 = 0; i_578769 < dim_416322; i_578769++) {
                float b_578771 = ((float *) mem_586453)[i_578769];
                float defunc_0_f_res_578772 = acc_578770 + b_578771;
                float acc_tmp_588093 = defunc_0_f_res_578772;
                
                acc_578770 = acc_tmp_588093;
            }
            defunc_0_foldl_res_578768 = acc_578770;
            
            float sqrt_res_578773 = futrts_sqrt32(defunc_0_foldl_res_578768);
            
            for (int64_t nest_i_588094 = 0; nest_i_588094 < arg_578018; nest_i_588094++) {
                ((float *) mem_586469)[nest_i_588094] = 0.0F;
            }
            for (int64_t i_578776 = 0; i_578776 < arg_578018; i_578776++) {
                bool y_578778 = slt64(i_578776, dim_416322);
                bool index_certs_578779;
                
                if (!y_578778) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_578776, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t map_arg1_578781 = add64((int64_t) 1, i_578776);
                int64_t j_m_i_578782 = sub64(dim_416322, map_arg1_578781);
                bool empty_slice_578783 = j_m_i_578782 == (int64_t) 0;
                int64_t m_578784 = sub64(j_m_i_578782, (int64_t) 1);
                int64_t i_p_m_t_s_578785 = add64(map_arg1_578781, m_578784);
                bool zzero_leq_i_p_m_t_s_578786 = sle64((int64_t) 0, i_p_m_t_s_578785);
                bool i_p_m_t_s_leq_w_578787 = slt64(i_p_m_t_s_578785, dim_416322);
                bool zzero_lte_i_578788 = sle64((int64_t) 0, map_arg1_578781);
                bool i_lte_j_578789 = sle64(map_arg1_578781, dim_416322);
                bool y_578790 = i_p_m_t_s_leq_w_578787 && zzero_lte_i_578788;
                bool y_578791 = zzero_leq_i_p_m_t_s_578786 && y_578790;
                bool forwards_ok_578792 = i_lte_j_578789 && y_578791;
                bool ok_or_empty_578793 = empty_slice_578783 || forwards_ok_578792;
                bool index_certs_578794;
                
                if (!ok_or_empty_578793) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_578781, ":", (long long) dim_416322, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:223:89-90\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_586473 = (int64_t) 4 * j_m_i_578782;
                float this_x_578780 = ((float *) mem_586455)[i_578776];
                
                if (mem_586474_cached_sizze_589074 < bytes_586473) {
                    err = lexical_realloc(ctx, &mem_586474, &mem_586474_cached_sizze_589074, bytes_586473);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_586144 = 0; i_586144 < j_m_i_578782; i_586144++) {
                    int64_t slice_586398 = map_arg1_578781 + i_586144;
                    float eta_p_578797 = ((float *) mem_586455)[slice_586398];
                    float defunc_0_ftimes_res_578798 = eta_p_578797 * eta_p_578797;
                    
                    ((float *) mem_586474)[i_586144] = defunc_0_ftimes_res_578798;
                }
                
                float defunc_0_foldl_res_578799;
                float acc_578801 = 0.0F;
                
                for (int64_t i_578800 = 0; i_578800 < j_m_i_578782; i_578800++) {
                    float b_578802 = ((float *) mem_586474)[i_578800];
                    float defunc_0_f_res_578803 = acc_578801 + b_578802;
                    float acc_tmp_588097 = defunc_0_f_res_578803;
                    
                    acc_578801 = acc_tmp_588097;
                }
                defunc_0_foldl_res_578799 = acc_578801;
                
                float sqrt_res_578804 = futrts_sqrt32(defunc_0_foldl_res_578799);
                float atan2_res_578805 = futrts_atan2_32(sqrt_res_578804, this_x_578780);
                
                ((float *) mem_586469)[i_578776] = atan2_res_578805;
            }
            for (int64_t i_586148 = 0; i_586148 < arg_578018; i_586148++) {
                float eta_p_578823 = ((float *) mem_586469)[i_586148];
                float eta_p_578824 = ((float *) mem_586427)[i_586148];
                int64_t eta_p_578825 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586148];
                int64_t eta_p_578826 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586148];
                float i64_res_578827 = sitofp_i64_f32(eta_p_578825);
                float defunc_0_fover_res_578828 = eta_p_578823 / eta_p_578824;
                float defunc_0_ftimes_res_578829 = i64_res_578827 * defunc_0_fover_res_578828;
                int64_t f32_res_578830 = fptosi_f32_i64(defunc_0_ftimes_res_578829);
                bool cond_578831 = slt64(f32_res_578830, (int64_t) 0);
                int64_t defunc_0_f_res_578832;
                
                if (cond_578831) {
                    defunc_0_f_res_578832 = (int64_t) 0;
                } else {
                    bool cond_578833 = sle64(eta_p_578826, f32_res_578830);
                    int64_t defunc_0_f_res_f_res_578834;
                    
                    if (cond_578833) {
                        int64_t defunc_0_f_res_f_res_t_res_585438 = sub64(eta_p_578826, (int64_t) 1);
                        
                        defunc_0_f_res_f_res_578834 = defunc_0_f_res_f_res_t_res_585438;
                    } else {
                        defunc_0_f_res_f_res_578834 = f32_res_578830;
                    }
                    defunc_0_f_res_578832 = defunc_0_f_res_f_res_578834;
                }
                ((int64_t *) mem_586485)[i_586148] = defunc_0_f_res_578832;
            }
            
            int64_t defunc_0_foldl_res_578836;
            int64_t acc_578838 = (int64_t) 0;
            
            for (int64_t i_578837 = 0; i_578837 < arg_578018; i_578837++) {
                int64_t b_578839 = ((int64_t *) mem_586485)[i_578837];
                int64_t defunc_0_f_res_578840 = add64(acc_578838, b_578839);
                int64_t acc_tmp_588099 = defunc_0_f_res_578840;
                
                acc_578838 = acc_tmp_588099;
            }
            defunc_0_foldl_res_578836 = acc_578838;
            
            int64_t zp_lhs_578841 = mul64(total_angle_no_416332, defunc_0_foldl_res_578750);
            int64_t get_id_from_grid_angle_res_578842 = add64(defunc_0_foldl_res_578836, zp_lhs_578841);
            
            ((int64_t *) mem_586435)[i_586154] = get_id_from_grid_angle_res_578842;
            ((float *) mem_586437)[i_586154] = sqrt_res_578773;
        }
        
        int64_t reduce_arg1_578870;
        
        if (x_578850) {
            int64_t x_585444 = ((int64_t *) mem_586435)[(int64_t) 0];
            
            reduce_arg1_578870 = x_585444;
        } else {
            reduce_arg1_578870 = (int64_t) 0;
        }
        
        float reduce_arg1_578872;
        
        if (x_578850) {
            float x_585445 = ((float *) mem_586437)[(int64_t) 0];
            
            reduce_arg1_578872 = x_585445;
        } else {
            reduce_arg1_578872 = 0.0F;
        }
        if (cond_578849) {
            if (memblock_set(ctx, &ext_mem_586962, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586958, &mem_586419, "mem_586419") != 0)
                return 1;
        } else {
            int64_t ext_586506;
            int64_t defunc_0_reduce_res_585670;
            float defunc_0_reduce_res_585671;
            int64_t defunc_0_reduce_res_585673;
            int64_t redout_586157;
            float redout_586158;
            int64_t redout_586160;
            int64_t ctx_param_ext_586498;
            
            if (memblock_set(ctx, &mem_param_586500, &xs_mem_586417, "xs_mem_586417") != 0)
                return 1;
            ctx_param_ext_586498 = (int64_t) 0;
            redout_586157 = reduce_arg1_578870;
            redout_586158 = reduce_arg1_578872;
            redout_586160 = offset_416336;
            for (int64_t i_586161 = 0; i_586161 < n_416325; i_586161++) {
                int64_t x_578888 = ((int64_t *) mem_586435)[i_586161];
                float x_578889 = ((float *) mem_586437)[i_586161];
                int64_t x_578891 = ((int64_t *) mem_586419.mem)[i_586161];
                bool cond_578900 = slt64(redout_586157, x_578888);
                bool cond_578901 = redout_586157 == x_578888;
                bool zlze_res_578902 = redout_586158 <= x_578889;
                bool x_578903 = cond_578901 && zlze_res_578902;
                bool x_578904 = !cond_578900;
                bool y_578905 = x_578903 && x_578904;
                bool defunc_0_leq_res_578906 = cond_578900 || y_578905;
                int64_t defunc_0_op_res_578907;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578907 = x_578888;
                } else {
                    defunc_0_op_res_578907 = redout_586157;
                }
                
                float defunc_0_op_res_578908;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578908 = x_578889;
                } else {
                    defunc_0_op_res_578908 = redout_586158;
                }
                
                int64_t defunc_0_op_res_578909;
                
                if (defunc_0_leq_res_578906) {
                    defunc_0_op_res_578909 = x_578891;
                } else {
                    defunc_0_op_res_578909 = redout_586160;
                }
                
                int64_t lmad_ext_586501 = dim_416322 * i_586161;
                int64_t ext_586503;
                
                if (defunc_0_leq_res_578906) {
                    ext_586503 = lmad_ext_586501;
                } else {
                    ext_586503 = ctx_param_ext_586498;
                }
                if (defunc_0_leq_res_578906) {
                    if (memblock_set(ctx, &ext_mem_586504, &xs_mem_586417, "xs_mem_586417") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_586504, &mem_param_586500, "mem_param_586500") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588100, &ext_mem_586504, "ext_mem_586504") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_588101 = ext_586503;
                int64_t redout_tmp_588102 = defunc_0_op_res_578907;
                float redout_tmp_588103 = defunc_0_op_res_578908;
                int64_t redout_tmp_588105 = defunc_0_op_res_578909;
                
                if (memblock_set(ctx, &mem_param_586500, &mem_param_tmp_588100, "mem_param_tmp_588100") != 0)
                    return 1;
                ctx_param_ext_586498 = ctx_param_ext_tmp_588101;
                redout_586157 = redout_tmp_588102;
                redout_586158 = redout_tmp_588103;
                redout_586160 = redout_tmp_588105;
            }
            if (memblock_set(ctx, &ext_mem_586507, &mem_param_586500, "mem_param_586500") != 0)
                return 1;
            ext_586506 = ctx_param_ext_586498;
            defunc_0_reduce_res_585670 = redout_586157;
            defunc_0_reduce_res_585671 = redout_586158;
            defunc_0_reduce_res_585673 = redout_586160;
            if (mem_586510_cached_sizze_589076 < bytes_586509) {
                err = lexical_realloc(ctx, &mem_586510, &mem_586510_cached_sizze_589076, bytes_586509);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586513_cached_sizze_589077 < bytes_586512) {
                err = lexical_realloc(ctx, &mem_586513, &mem_586513_cached_sizze_589077, bytes_586512);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586517_cached_sizze_589078 < bytes_586516) {
                err = lexical_realloc(ctx, &mem_586517, &mem_586517_cached_sizze_589078, bytes_586516);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586520_cached_sizze_589079 < bytes_586509) {
                err = lexical_realloc(ctx, &mem_586520, &mem_586520_cached_sizze_589079, bytes_586509);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586540_cached_sizze_589080 < bytes_586539) {
                err = lexical_realloc(ctx, &mem_586540, &mem_586540_cached_sizze_589080, bytes_586539);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586542_cached_sizze_589081 < bytes_586541) {
                err = lexical_realloc(ctx, &mem_586542, &mem_586542_cached_sizze_589081, bytes_586541);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586545_cached_sizze_589082 < bytes_586544) {
                err = lexical_realloc(ctx, &mem_586545, &mem_586545_cached_sizze_589082, bytes_586544);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_586547_cached_sizze_589083 < bytes_586539) {
                err = lexical_realloc(ctx, &mem_586547, &mem_586547_cached_sizze_589083, bytes_586539);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586183 = 0; i_586183 < x_582419; i_586183++) {
                int64_t zp_lhs_578931 = mul64(block_sizze_578866, i_586183);
                
                for (int64_t i_586170 = 0; i_586170 < block_sizze_578866; i_586170++) {
                    int64_t k_578937 = add64(zp_lhs_578931, i_586170);
                    bool cond_578938 = slt64(k_578937, n_416325);
                    int64_t lmad_ext_586561 = dim_416322 * k_578937;
                    int64_t ext_586563;
                    
                    if (cond_578938) {
                        ext_586563 = lmad_ext_586561;
                    } else {
                        ext_586563 = ext_586506;
                    }
                    
                    int64_t lifted_lambda_res_578939;
                    float lifted_lambda_res_578940;
                    int64_t lifted_lambda_res_578942;
                    
                    if (cond_578938) {
                        bool x_585446 = sle64((int64_t) 0, k_578937);
                        bool bounds_check_585447 = cond_578938 && x_585446;
                        bool index_certs_585448;
                        
                        if (!bounds_check_585447) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_578937, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:244:40-246:44\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t lifted_lambda_res_t_res_585449 = ((int64_t *) mem_586435)[k_578937];
                        float lifted_lambda_res_t_res_585450 = ((float *) mem_586437)[k_578937];
                        int64_t index_primexp_585452 = add64(offset_416336, k_578937);
                        
                        if (memblock_set(ctx, &ext_mem_586564, &xs_mem_586417, "xs_mem_586417") != 0)
                            return 1;
                        lifted_lambda_res_578939 = lifted_lambda_res_t_res_585449;
                        lifted_lambda_res_578940 = lifted_lambda_res_t_res_585450;
                        lifted_lambda_res_578942 = index_primexp_585452;
                    } else {
                        if (memblock_set(ctx, &ext_mem_586564, &ext_mem_586507, "ext_mem_586507") != 0)
                            return 1;
                        lifted_lambda_res_578939 = defunc_0_reduce_res_585670;
                        lifted_lambda_res_578940 = defunc_0_reduce_res_585671;
                        lifted_lambda_res_578942 = defunc_0_reduce_res_585673;
                    }
                    ((int64_t *) mem_586540)[i_586170] = lifted_lambda_res_578939;
                    ((float *) mem_586542)[i_586170] = lifted_lambda_res_578940;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586545, i_586170 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586564.mem, ext_586563, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                    if (memblock_unref(ctx, &ext_mem_586564, "ext_mem_586564") != 0)
                        return 1;
                    ((int64_t *) mem_586547)[i_586170] = lifted_lambda_res_578942;
                }
                if (!cond_578919) {
                    if (mem_586605_cached_sizze_589084 < bytes_586452) {
                        err = lexical_realloc(ctx, &mem_586605, &mem_586605_cached_sizze_589084, bytes_586452);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_586607_cached_sizze_589085 < bytes_586452) {
                        err = lexical_realloc(ctx, &mem_586607, &mem_586607_cached_sizze_589085, bytes_586452);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_578958 = 0; i_578958 < distance_578922; i_578958++) {
                        int64_t gt_arg1_578963 = add64((int64_t) 1, i_578958);
                        bool x_578964 = sle64((int64_t) 0, gt_arg1_578963);
                        bool y_578965 = slt64(gt_arg1_578963, block_sizze_578866);
                        bool bounds_check_578966 = x_578964 && y_578965;
                        bool index_certs_578967;
                        
                        if (!bounds_check_578966) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_578963, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool y_578970 = slt64(i_578958, block_sizze_578866);
                        bool index_certs_578971;
                        
                        if (!y_578970) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_578958, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t gt_arg1_578968 = ((int64_t *) mem_586540)[gt_arg1_578963];
                        float gt_arg1_578969 = ((float *) mem_586542)[gt_arg1_578963];
                        int64_t gt_arg0_578972 = ((int64_t *) mem_586540)[i_578958];
                        float gt_arg0_578973 = ((float *) mem_586542)[i_578958];
                        bool cond_578974 = slt64(gt_arg0_578972, gt_arg1_578968);
                        bool cond_578975 = gt_arg0_578972 == gt_arg1_578968;
                        bool zlze_res_578976 = gt_arg0_578973 <= gt_arg1_578969;
                        bool x_578977 = cond_578975 && zlze_res_578976;
                        bool x_578978 = !cond_578974;
                        bool y_578979 = x_578977 && x_578978;
                        bool defunc_0_leq_res_578980 = cond_578974 || y_578979;
                        bool defunc_0_lifted_gt_res_578981 = !defunc_0_leq_res_578980;
                        bool s_578982;
                        int64_t s_578987;
                        bool loop_while_578988;
                        int64_t j_578993;
                        
                        loop_while_578988 = defunc_0_lifted_gt_res_578981;
                        j_578993 = i_578958;
                        while (loop_while_578988) {
                            bool x_578994 = sle64((int64_t) 0, j_578993);
                            bool y_578995 = slt64(j_578993, block_sizze_578866);
                            bool bounds_check_578996 = x_578994 && y_578995;
                            bool index_certs_578997;
                            
                            if (!bounds_check_578996) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_578993, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_579003 = add64((int64_t) 1, j_578993);
                            bool x_579004 = sle64((int64_t) 0, copy_arg0_579003);
                            bool y_579005 = slt64(copy_arg0_579003, block_sizze_578866);
                            bool bounds_check_579006 = x_579004 && y_579005;
                            bool index_certs_579007;
                            
                            if (!bounds_check_579006) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_579003, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t copy_arg0_578998 = ((int64_t *) mem_586540)[j_578993];
                            float copy_arg0_578999 = ((float *) mem_586542)[j_578993];
                            int64_t copy_arg0_579001 = ((int64_t *) mem_586547)[j_578993];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586545, (int64_t) 0 + j_578993 * dim_416322, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            
                            int64_t copy_arg0_579008 = ((int64_t *) mem_586540)[copy_arg0_579003];
                            float copy_arg0_579009 = ((float *) mem_586542)[copy_arg0_579003];
                            int64_t copy_arg0_579011 = ((int64_t *) mem_586547)[copy_arg0_579003];
                            
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586607, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586545, (int64_t) 0 + copy_arg0_579003 * dim_416322, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_586540)[j_578993] = copy_arg0_579008;
                            ((float *) mem_586542)[j_578993] = copy_arg0_579009;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586545, j_578993 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586607, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_586547)[j_578993] = copy_arg0_579011;
                            ((int64_t *) mem_586540)[copy_arg0_579003] = copy_arg0_578998;
                            ((float *) mem_586542)[copy_arg0_579003] = copy_arg0_578999;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586545, copy_arg0_579003 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586605, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_586547)[copy_arg0_579003] = copy_arg0_579001;
                            
                            int64_t tmp_579021 = sub64(j_578993, (int64_t) 1);
                            bool cond_579022 = sle64((int64_t) 0, tmp_579021);
                            bool loop_cond_579023;
                            
                            if (cond_579022) {
                                bool y_585455 = slt64(tmp_579021, block_sizze_578866);
                                bool bounds_check_585456 = cond_579022 && y_585455;
                                bool index_certs_585457;
                                
                                if (!bounds_check_585456) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_579021, "] out of bounds for array of shape [", (long long) block_sizze_578866, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:243:35-248:37\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t gt_arg1_585453 = ((int64_t *) mem_586540)[j_578993];
                                float gt_arg1_585454 = ((float *) mem_586542)[j_578993];
                                int64_t gt_arg0_585458 = ((int64_t *) mem_586540)[tmp_579021];
                                float gt_arg0_585459 = ((float *) mem_586542)[tmp_579021];
                                bool cond_585460 = slt64(gt_arg0_585458, gt_arg1_585453);
                                bool cond_585461 = gt_arg0_585458 == gt_arg1_585453;
                                bool zlze_res_585462 = gt_arg0_585459 <= gt_arg1_585454;
                                bool x_585463 = cond_585461 && zlze_res_585462;
                                bool x_585464 = !cond_585460;
                                bool y_585465 = x_585463 && x_585464;
                                bool defunc_0_leq_res_585466 = cond_585460 || y_585465;
                                bool defunc_0_lifted_gt_res_585467 = !defunc_0_leq_res_585466;
                                
                                loop_cond_579023 = defunc_0_lifted_gt_res_585467;
                            } else {
                                loop_cond_579023 = 0;
                            }
                            
                            bool loop_while_tmp_588118 = loop_cond_579023;
                            int64_t j_tmp_588123 = tmp_579021;
                            
                            loop_while_578988 = loop_while_tmp_588118;
                            j_578993 = j_tmp_588123;
                        }
                        s_578982 = loop_while_578988;
                        s_578987 = j_578993;
                    }
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586510, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586540, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586513, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_586542, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_586517, i_586183 * lmad_arg_586538, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) mem_586545, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {block_sizze_578866, dim_416322});
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_586520, i_586183 * block_sizze_578866, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_586547, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_578866});
            }
            if (memblock_unref(ctx, &ext_mem_586507, "ext_mem_586507") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_586666, bytes_586509, "mem_586666")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586666.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint64_t *) mem_586510, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            if (memblock_alloc(ctx, &mem_586670, bytes_586512, "mem_586670")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_586670.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint32_t *) mem_586513, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            if (memblock_alloc(ctx, &mem_586675, bytes_586516, "mem_586675")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 3, (uint32_t *) mem_586675.mem, (int64_t) 0, (int64_t []) {dim_416322 * block_sizze_578866, dim_416322, (int64_t) 1}, (uint32_t *) mem_586517, (int64_t) 0, (int64_t []) {lmad_arg_586538, dim_416322, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866, dim_416322});
            if (memblock_alloc(ctx, &mem_586679, bytes_586509, "mem_586679")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_586679.mem, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (uint64_t *) mem_586520, (int64_t) 0, (int64_t []) {block_sizze_578866, (int64_t) 1}, (int64_t []) {x_582419, block_sizze_578866});
            
            int64_t data_579048;
            bool data_579049;
            int64_t data_579054;
            int64_t loop_dz2084Uz2082U_579055;
            bool loop_while_579056;
            int64_t stride_579061;
            
            if (memblock_set(ctx, &mem_param_586683, &mem_586666, "mem_586666") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586686, &mem_586670, "mem_586670") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586690, &mem_586675, "mem_586675") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_586693, &mem_586679, "mem_586679") != 0)
                return 1;
            loop_dz2084Uz2082U_579055 = flat_dim_578876;
            loop_while_579056 = loop_cond_579045;
            stride_579061 = block_sizze_578866;
            while (loop_while_579056) {
                int64_t next_stride_579062 = mul64((int64_t) 2, stride_579061);
                bool zzero_579063 = next_stride_579062 == (int64_t) 0;
                bool nonzzero_579064 = !zzero_579063;
                bool nonzzero_cert_579065;
                
                if (!nonzzero_579064) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_merges_579066 = sdiv64(flat_dim_578876, next_stride_579062);
                bool bounds_invalid_upwards_579067 = slt64(num_merges_579066, (int64_t) 0);
                bool valid_579068 = !bounds_invalid_upwards_579067;
                bool range_valid_c_579069;
                
                if (!valid_579068) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_579066, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:937:33-56\n   #6  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t m_579071 = sub64(next_stride_579062, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_579072 = sle64((int64_t) 0, m_579071);
                bool cond_579074 = slt64(next_stride_579062, (int64_t) 10);
                bool protect_assert_disj_579075 = nonzzero_579047 || cond_579074;
                bool nonzzero_cert_579076;
                
                if (!protect_assert_disj_579075) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t zeze_lhs_579077 = smod_safe64(next_stride_579062, merge_block_sizze_578882);
                bool num_blocks_579078 = zeze_lhs_579077 == (int64_t) 0;
                bool protect_assert_disj_579079 = cond_579074 || num_blocks_579078;
                bool assert_c_579080;
                
                if (!protect_assert_disj_579079) {
                    set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t num_blocks_579083 = sdiv_safe64(next_stride_579062, merge_block_sizze_578882);
                int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084 = add64((int64_t) 1, num_blocks_579083);
                int64_t j_m_i_579085 = sub64(next_stride_579062, stride_579061);
                int64_t flat_dim_579086 = merge_block_sizze_578882 * num_blocks_579083;
                bool bounds_invalid_upwards_579087 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, (int64_t) 0);
                bool zzero_lte_i_579088 = sle64((int64_t) 0, stride_579061);
                bool i_lte_j_579089 = sle64(stride_579061, next_stride_579062);
                bool empty_slice_579090 = stride_579061 == (int64_t) 0;
                int64_t m_579091 = sub64(stride_579061, (int64_t) 1);
                bool bounds_invalid_upwards_579092 = slt64(num_blocks_579083, (int64_t) 0);
                bool empty_slice_579093 = j_m_i_579085 == (int64_t) 0;
                int64_t m_579094 = sub64(j_m_i_579085, (int64_t) 1);
                bool cond_579095 = slt64((int64_t) 0, stride_579061);
                bool valid_579096 = !bounds_invalid_upwards_579087;
                bool zzero_leq_i_p_m_t_s_579097 = sle64((int64_t) 0, m_579091);
                bool i_p_m_t_s_leq_w_579098 = slt64(m_579091, next_stride_579062);
                bool valid_579099 = !bounds_invalid_upwards_579092;
                bool i_p_m_t_s_leq_w_579100 = slt64(m_579071, flat_dim_579086);
                int64_t i_p_m_t_s_579101 = add64(stride_579061, m_579094);
                bool y_579102 = slt64((int64_t) 0, j_m_i_579085);
                bool protect_assert_disj_579103 = cond_579074 || valid_579096;
                bool range_valid_c_579104;
                
                if (!protect_assert_disj_579103) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579105 = zzero_leq_i_p_m_t_s_579097 && i_p_m_t_s_leq_w_579098;
                bool protect_assert_disj_579106 = cond_579074 || valid_579099;
                bool range_valid_c_579107;
                
                if (!protect_assert_disj_579106) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_579083, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579108 = zzero_leq_i_p_m_t_s_579072 && i_p_m_t_s_leq_w_579100;
                bool zzero_leq_i_p_m_t_s_579109 = sle64((int64_t) 0, i_p_m_t_s_579101);
                bool i_p_m_t_s_leq_w_579110 = slt64(i_p_m_t_s_579101, next_stride_579062);
                bool forwards_ok_579111 = zzero_lte_i_579088 && y_579105;
                bool ok_or_empty_579112 = zzero_579063 || y_579108;
                bool y_579113 = zzero_lte_i_579088 && i_p_m_t_s_leq_w_579110;
                bool protect_assert_disj_579114 = cond_579095 || y_579102;
                bool ok_or_empty_579115 = empty_slice_579090 || forwards_ok_579111;
                bool protect_assert_disj_579116 = cond_579074 || ok_or_empty_579112;
                bool index_certs_579117;
                
                if (!protect_assert_disj_579116) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_579062, "] out of bounds for array of shape [", (long long) flat_dim_579086, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool y_579118 = zzero_leq_i_p_m_t_s_579109 && y_579113;
                bool loop_not_taken_579119 = !cond_579074;
                bool protect_assert_disj_579120 = protect_assert_disj_579114 || loop_not_taken_579119;
                bool index_certs_579121;
                
                if (!protect_assert_disj_579120) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_579122 = cond_579074 || ok_or_empty_579115;
                bool index_certs_579123;
                
                if (!protect_assert_disj_579122) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_579061, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool forwards_ok_579124 = i_lte_j_579089 && y_579118;
                bool protect_assert_disj_579125 = ok_or_empty_579115 || loop_not_taken_579119;
                bool index_certs_579126;
                
                if (!protect_assert_disj_579125) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_579061, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool ok_or_empty_579127 = empty_slice_579093 || forwards_ok_579124;
                bool protect_assert_disj_579128 = loop_not_taken_579119 || ok_or_empty_579127;
                bool index_certs_579129;
                
                if (!protect_assert_disj_579128) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_579061, ":] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool protect_assert_disj_579130 = cond_579074 || ok_or_empty_579127;
                bool index_certs_579131;
                
                if (!protect_assert_disj_579130) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_579061, ":] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t binop_x_586694 = (int64_t) 8 * num_merges_579066;
                int64_t bytes_586695 = next_stride_579062 * binop_x_586694;
                int64_t binop_x_586697 = (int64_t) 4 * num_merges_579066;
                int64_t bytes_586698 = next_stride_579062 * binop_x_586697;
                int64_t bytes_586702 = dim_416322 * bytes_586698;
                bool i_lte_j_579073 = sle64((int64_t) 0, next_stride_579062);
                
                if (mem_586696_cached_sizze_589086 < bytes_586695) {
                    err = lexical_realloc(ctx, &mem_586696, &mem_586696_cached_sizze_589086, bytes_586695);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586699_cached_sizze_589087 < bytes_586698) {
                    err = lexical_realloc(ctx, &mem_586699, &mem_586699_cached_sizze_589087, bytes_586698);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586703_cached_sizze_589088 < bytes_586702) {
                    err = lexical_realloc(ctx, &mem_586703, &mem_586703_cached_sizze_589088, bytes_586702);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_586706_cached_sizze_589089 < bytes_586695) {
                    err = lexical_realloc(ctx, &mem_586706, &mem_586706_cached_sizze_589089, bytes_586695);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t lmad_arg_586724 = dim_416322 * next_stride_579062;
                int64_t bytes_586725 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084;
                int64_t binop_x_586741 = (int64_t) 8 * num_blocks_579083;
                int64_t bytes_586742 = merge_block_sizze_578882 * binop_x_586741;
                int64_t binop_x_586744 = (int64_t) 4 * num_blocks_579083;
                int64_t bytes_586745 = merge_block_sizze_578882 * binop_x_586744;
                int64_t bytes_586749 = dim_416322 * bytes_586745;
                int64_t bytes_586856 = (int64_t) 16 * stride_579061;
                int64_t bytes_586858 = (int64_t) 8 * stride_579061;
                int64_t bytes_586863 = dim_416322 * bytes_586858;
                
                for (int64_t i_586216 = 0; i_586216 < num_merges_579066; i_586216++) {
                    int64_t start_579137 = mul64(next_stride_579062, i_586216);
                    int64_t j_m_i_579138 = sub64(loop_dz2084Uz2082U_579055, start_579137);
                    bool empty_slice_579139 = j_m_i_579138 == (int64_t) 0;
                    int64_t m_579140 = sub64(j_m_i_579138, (int64_t) 1);
                    int64_t i_p_m_t_s_579141 = add64(start_579137, m_579140);
                    bool zzero_leq_i_p_m_t_s_579142 = sle64((int64_t) 0, i_p_m_t_s_579141);
                    bool i_p_m_t_s_leq_w_579143 = slt64(i_p_m_t_s_579141, loop_dz2084Uz2082U_579055);
                    bool zzero_lte_i_579144 = sle64((int64_t) 0, start_579137);
                    bool i_lte_j_579145 = sle64(start_579137, loop_dz2084Uz2082U_579055);
                    bool y_579146 = i_p_m_t_s_leq_w_579143 && zzero_lte_i_579144;
                    bool y_579147 = zzero_leq_i_p_m_t_s_579142 && y_579146;
                    bool forwards_ok_579148 = i_lte_j_579145 && y_579147;
                    bool ok_or_empty_579149 = empty_slice_579139 || forwards_ok_579148;
                    bool index_certs_579150;
                    
                    if (!ok_or_empty_579149) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_579137, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_579055, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool i_p_m_t_s_leq_w_579151 = slt64(m_579071, j_m_i_579138);
                    bool y_579152 = zzero_leq_i_p_m_t_s_579072 && i_p_m_t_s_leq_w_579151;
                    bool forwards_ok_579153 = i_lte_j_579073 && y_579152;
                    bool ok_or_empty_579154 = zzero_579063 || forwards_ok_579153;
                    bool index_certs_579155;
                    
                    if (!ok_or_empty_579154) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_579062, "] out of bounds for array of shape [", (long long) j_m_i_579138, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSkyline.fut:937:33-56\n   #8  ftSkyline.fut:926:17-937:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t slice_585515 = stride_579061 + start_579137;
                    int64_t binop_y_586851 = dim_416322 * slice_585515;
                    int64_t binop_y_586853 = dim_416322 * start_579137;
                    int64_t ext_586855;
                    
                    if (cond_579095) {
                        ext_586855 = binop_y_586853;
                    } else {
                        ext_586855 = binop_y_586851;
                    }
                    if (cond_579074) {
                        int64_t dummy_585507;
                        float dummy_585508;
                        int64_t dummy_585510;
                        
                        if (cond_579095) {
                            int64_t head_res_585511 = ((int64_t *) mem_param_586683.mem)[start_579137];
                            float head_res_585512 = ((float *) mem_param_586686.mem)[start_579137];
                            int64_t head_res_585514 = ((int64_t *) mem_param_586693.mem)[start_579137];
                            
                            dummy_585507 = head_res_585511;
                            dummy_585508 = head_res_585512;
                            dummy_585510 = head_res_585514;
                        } else {
                            int64_t head_res_585516 = ((int64_t *) mem_param_586683.mem)[slice_585515];
                            float head_res_585517 = ((float *) mem_param_586686.mem)[slice_585515];
                            int64_t head_res_585519 = ((int64_t *) mem_param_586693.mem)[slice_585515];
                            
                            dummy_585507 = head_res_585516;
                            dummy_585508 = head_res_585517;
                            dummy_585510 = head_res_585519;
                        }
                        if (memblock_alloc(ctx, &mem_586857, bytes_586856, "mem_586857")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588139 = 0; nest_i_588139 < next_stride_579062; nest_i_588139++) {
                            ((int64_t *) mem_586857.mem)[nest_i_588139] = dummy_585507;
                        }
                        if (memblock_alloc(ctx, &mem_586859, bytes_586858, "mem_586859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588140 = 0; nest_i_588140 < next_stride_579062; nest_i_588140++) {
                            ((float *) mem_586859.mem)[nest_i_588140] = dummy_585508;
                        }
                        if (memblock_alloc(ctx, &mem_586861, bytes_586856, "mem_586861")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588141 = 0; nest_i_588141 < next_stride_579062; nest_i_588141++) {
                            ((int64_t *) mem_586861.mem)[nest_i_588141] = dummy_585510;
                        }
                        if (memblock_alloc(ctx, &mem_586864, bytes_586863, "mem_586864")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t nest_i_588142 = 0; nest_i_588142 < next_stride_579062; nest_i_588142++) {
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586864.mem, nest_i_588142 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586690.mem, ext_586855, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                        }
                        
                        int64_t data_585524;
                        int64_t i_585530 = (int64_t) 0;
                        
                        for (int64_t k_585529 = 0; k_585529 < next_stride_579062; k_585529++) {
                            int64_t j_585535 = sub64(k_585529, i_585530);
                            bool cond_585536 = j_585535 == j_m_i_579085;
                            bool x_587822 = !cond_585536;
                            bool cond_585538 = slt64(i_585530, stride_579061);
                            bool x_585540 = sle64((int64_t) 0, j_585535);
                            bool y_585541 = slt64(j_585535, j_m_i_579085);
                            bool bounds_check_585542 = x_585540 && y_585541;
                            bool loop_not_taken_587810 = !cond_585538;
                            bool protect_assert_disj_587811 = bounds_check_585542 || loop_not_taken_587810;
                            bool protect_assert_disj_587825 = cond_585536 || protect_assert_disj_587811;
                            bool index_certs_585543;
                            
                            if (!protect_assert_disj_587825) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585535, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585544 = stride_579061 + j_585535;
                            int64_t slice_585545 = start_579137 + slice_585544;
                            bool protect_cond_conj_587826 = cond_585538 && x_587822;
                            int64_t leq_arg1_585546;
                            
                            if (protect_cond_conj_587826) {
                                int64_t x_587812 = ((int64_t *) mem_param_586683.mem)[slice_585545];
                                
                                leq_arg1_585546 = x_587812;
                            } else {
                                leq_arg1_585546 = (int64_t) 0;
                            }
                            
                            float leq_arg1_585547;
                            
                            if (protect_cond_conj_587826) {
                                float x_587814 = ((float *) mem_param_586686.mem)[slice_585545];
                                
                                leq_arg1_585547 = x_587814;
                            } else {
                                leq_arg1_585547 = 0.0F;
                            }
                            
                            bool x_585548 = sle64((int64_t) 0, i_585530);
                            bool bounds_check_585549 = cond_585538 && x_585548;
                            bool protect_assert_disj_587817 = bounds_check_585549 || loop_not_taken_587810;
                            bool protect_assert_disj_587829 = cond_585536 || protect_assert_disj_587817;
                            bool index_certs_585550;
                            
                            if (!protect_assert_disj_587829) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585530, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585551 = start_579137 + i_585530;
                            int64_t leq_arg0_585552;
                            
                            if (protect_cond_conj_587826) {
                                int64_t x_587818 = ((int64_t *) mem_param_586683.mem)[slice_585551];
                                
                                leq_arg0_585552 = x_587818;
                            } else {
                                leq_arg0_585552 = (int64_t) 0;
                            }
                            
                            float leq_arg0_585553;
                            
                            if (protect_cond_conj_587826) {
                                float x_587820 = ((float *) mem_param_586686.mem)[slice_585551];
                                
                                leq_arg0_585553 = x_587820;
                            } else {
                                leq_arg0_585553 = 0.0F;
                            }
                            
                            bool cond_585554 = slt64(leq_arg0_585552, leq_arg1_585546);
                            bool cond_585555 = leq_arg0_585552 == leq_arg1_585546;
                            bool zlze_res_585556 = leq_arg0_585553 <= leq_arg1_585547;
                            bool x_585557 = cond_585555 && zlze_res_585556;
                            bool x_585558 = !cond_585554;
                            bool y_585559 = x_585557 && x_585558;
                            bool defunc_0_leq_res_585560 = cond_585554 || y_585559;
                            bool x_587865 = cond_585538 && defunc_0_leq_res_585560;
                            bool cond_585537 = cond_585536 || x_587865;
                            bool protect_assert_disj_587734 = cond_585537 || bounds_check_585542;
                            bool index_certs_585579;
                            
                            if (!protect_assert_disj_587734) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_585535, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool bounds_check_585569 = cond_585538 && x_585548;
                            bool loop_not_taken_587729 = !cond_585537;
                            bool protect_assert_disj_587730 = bounds_check_585569 || loop_not_taken_587729;
                            bool index_certs_585570;
                            
                            if (!protect_assert_disj_587730) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_585530, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSkyline.fut:937:33-56\n   #9  ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_585581 = start_579137 + slice_585544;
                            int64_t binop_y_586878 = dim_416322 * slice_585581;
                            int64_t binop_y_586880 = dim_416322 * slice_585551;
                            int64_t ext_586882;
                            
                            if (cond_585537) {
                                ext_586882 = binop_y_586880;
                            } else {
                                ext_586882 = binop_y_586878;
                            }
                            
                            int64_t loopres_585561;
                            int64_t loopres_585562;
                            float loopres_585563;
                            int64_t loopres_585565;
                            
                            if (cond_585537) {
                                int64_t tmp_585566 = add64((int64_t) 1, i_585530);
                                int64_t tmp_585572 = ((int64_t *) mem_param_586683.mem)[slice_585551];
                                float tmp_585573 = ((float *) mem_param_586686.mem)[slice_585551];
                                int64_t tmp_585575 = ((int64_t *) mem_param_586693.mem)[slice_585551];
                                
                                loopres_585561 = tmp_585566;
                                loopres_585562 = tmp_585572;
                                loopres_585563 = tmp_585573;
                                loopres_585565 = tmp_585575;
                            } else {
                                int64_t tmp_585582 = ((int64_t *) mem_param_586683.mem)[slice_585581];
                                float tmp_585583 = ((float *) mem_param_586686.mem)[slice_585581];
                                int64_t tmp_585585 = ((int64_t *) mem_param_586693.mem)[slice_585581];
                                
                                loopres_585561 = i_585530;
                                loopres_585562 = tmp_585582;
                                loopres_585563 = tmp_585583;
                                loopres_585565 = tmp_585585;
                            }
                            ((int64_t *) mem_586857.mem)[k_585529] = loopres_585562;
                            ((float *) mem_586859.mem)[k_585529] = loopres_585563;
                            lmad_copy_4b(ctx, 1, (uint32_t *) mem_586864.mem, k_585529 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586690.mem, ext_586882, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            ((int64_t *) mem_586861.mem)[k_585529] = loopres_585565;
                            
                            int64_t i_tmp_588143 = loopres_585561;
                            
                            i_585530 = i_tmp_588143;
                        }
                        data_585524 = i_585530;
                        if (memblock_set(ctx, &ext_mem_586908, &mem_586857, "mem_586857") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586905, &mem_586859, "mem_586859") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586902, &mem_586864, "mem_586864") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586898, &mem_586861, "mem_586861") != 0)
                            return 1;
                    } else {
                        if (mem_586726_cached_sizze_589090 < bytes_586725) {
                            err = lexical_realloc(ctx, &mem_586726, &mem_586726_cached_sizze_589090, bytes_586725);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586728_cached_sizze_589091 < bytes_586725) {
                            err = lexical_realloc(ctx, &mem_586728, &mem_586728_cached_sizze_589091, bytes_586725);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586192 = 0; i_586192 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084; i_586192++) {
                            int64_t split_count_arg3_579247 = mul64(merge_block_sizze_578882, i_586192);
                            int64_t defunc_0_split_count_res_579248;
                            int64_t defunc_0_split_count_res_579249;
                            int64_t defunc_0_split_count_res_579250;
                            int64_t defunc_0_split_count_res_579251;
                            int64_t defunc_0_split_count_res_579252;
                            
                            if (futrts_lifted_normalizze_13231(ctx, &defunc_0_split_count_res_579248, &defunc_0_split_count_res_579249, &defunc_0_split_count_res_579250, &defunc_0_split_count_res_579251, &defunc_0_split_count_res_579252, (int64_t) 0, stride_579061, (int64_t) 0, j_m_i_579085, split_count_arg3_579247) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_579253 = slt64((int64_t) 0, defunc_0_split_count_res_579252);
                            bool defunc_0_split_count_res_579254;
                            int64_t defunc_0_split_count_res_579255;
                            int64_t defunc_0_split_count_res_579256;
                            int64_t defunc_0_split_count_res_579257;
                            int64_t defunc_0_split_count_res_579258;
                            int64_t defunc_0_split_count_res_579259;
                            bool loop_while_579260;
                            int64_t ss_579261;
                            int64_t ss_579262;
                            int64_t tt_579263;
                            int64_t tt_579264;
                            int64_t count_579265;
                            
                            loop_while_579260 = loop_cond_579253;
                            ss_579261 = defunc_0_split_count_res_579248;
                            ss_579262 = defunc_0_split_count_res_579249;
                            tt_579263 = defunc_0_split_count_res_579250;
                            tt_579264 = defunc_0_split_count_res_579251;
                            count_579265 = defunc_0_split_count_res_579252;
                            while (loop_while_579260) {
                                int64_t zlze_lhs_579266 = sub64(ss_579262, ss_579261);
                                bool cond_579267 = sle64(zlze_lhs_579266, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_579268;
                                int64_t defunc_0_lifted_step_res_579269;
                                int64_t defunc_0_lifted_step_res_579270;
                                int64_t defunc_0_lifted_step_res_579271;
                                
                                if (cond_579267) {
                                    int64_t tmp_585590 = add64(tt_579263, count_579265);
                                    
                                    defunc_0_lifted_step_res_579268 = ss_579261;
                                    defunc_0_lifted_step_res_579269 = tmp_585590;
                                    defunc_0_lifted_step_res_579270 = tt_579264;
                                    defunc_0_lifted_step_res_579271 = (int64_t) 0;
                                } else {
                                    int64_t zlze_lhs_579273 = sub64(tt_579264, tt_579263);
                                    bool cond_579274 = sle64(zlze_lhs_579273, (int64_t) 0);
                                    int64_t defunc_0_lifted_step_res_f_res_579275;
                                    int64_t defunc_0_lifted_step_res_f_res_579276;
                                    int64_t defunc_0_lifted_step_res_f_res_579277;
                                    int64_t defunc_0_lifted_step_res_f_res_579278;
                                    
                                    if (cond_579274) {
                                        int64_t tmp_585591 = add64(ss_579261, count_579265);
                                        
                                        defunc_0_lifted_step_res_f_res_579275 = tmp_585591;
                                        defunc_0_lifted_step_res_f_res_579276 = tt_579263;
                                        defunc_0_lifted_step_res_f_res_579277 = tt_579264;
                                        defunc_0_lifted_step_res_f_res_579278 = (int64_t) 0;
                                    } else {
                                        bool cond_579280 = count_579265 == (int64_t) 1;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579281;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579282;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579283;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_579284;
                                        
                                        if (cond_579280) {
                                            bool x_585593 = sle64((int64_t) 0, ss_579261);
                                            bool y_585594 = slt64(ss_579261, stride_579061);
                                            bool bounds_check_585595 = x_585593 && y_585594;
                                            bool index_certs_585596;
                                            
                                            if (!bounds_check_585595) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_579261, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:937:33-56\n   #13 ftSkyline.fut:926:17-937:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            bool x_585600 = sle64((int64_t) 0, tt_579263);
                                            bool y_585601 = slt64(tt_579263, j_m_i_579085);
                                            bool bounds_check_585602 = x_585600 && y_585601;
                                            bool index_certs_585603;
                                            
                                            if (!bounds_check_585602) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_579263, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:937:33-56\n   #13 ftSkyline.fut:926:17-937:56\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_585597 = start_579137 + ss_579261;
                                            int64_t leq_arg1_585598 = ((int64_t *) mem_param_586683.mem)[slice_585597];
                                            float leq_arg1_585599 = ((float *) mem_param_586686.mem)[slice_585597];
                                            int64_t slice_585604 = stride_579061 + tt_579263;
                                            int64_t slice_585605 = start_579137 + slice_585604;
                                            int64_t leq_arg0_585606 = ((int64_t *) mem_param_586683.mem)[slice_585605];
                                            float leq_arg0_585607 = ((float *) mem_param_586686.mem)[slice_585605];
                                            bool cond_585608 = slt64(leq_arg0_585606, leq_arg1_585598);
                                            bool cond_585609 = leq_arg0_585606 == leq_arg1_585598;
                                            bool zlze_res_585610 = leq_arg0_585607 <= leq_arg1_585599;
                                            bool x_585611 = cond_585609 && zlze_res_585610;
                                            bool x_585612 = !cond_585608;
                                            bool y_585613 = x_585611 && x_585612;
                                            bool defunc_0_leq_res_585614 = cond_585608 || y_585613;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585615;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_585616;
                                            
                                            if (defunc_0_leq_res_585614) {
                                                int64_t tmp_585617 = add64((int64_t) 1, tt_579263);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585615 = ss_579261;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585616 = tmp_585617;
                                            } else {
                                                int64_t tmp_585618 = add64((int64_t) 1, ss_579261);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585615 = tmp_585618;
                                                defunc_0_lifted_step_res_f_res_f_res_t_res_585616 = tt_579263;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_579281 = defunc_0_lifted_step_res_f_res_f_res_t_res_585615;
                                            defunc_0_lifted_step_res_f_res_f_res_579282 = defunc_0_lifted_step_res_f_res_f_res_t_res_585616;
                                            defunc_0_lifted_step_res_f_res_f_res_579283 = tt_579264;
                                            defunc_0_lifted_step_res_f_res_f_res_579284 = (int64_t) 0;
                                        } else {
                                            int64_t m_579311 = sdiv64(count_579265, (int64_t) 2);
                                            int64_t n_579312 = sub64(count_579265, m_579311);
                                            bool cond_579313 = n_579312 == (int64_t) 0;
                                            int64_t zgze_lhs_579314 = add64(ss_579261, m_579311);
                                            bool cond_f_res_579315 = sle64(ss_579262, zgze_lhs_579314);
                                            bool x_579316 = !cond_579313;
                                            bool y_579317 = cond_f_res_579315 && x_579316;
                                            bool cond_579318 = cond_579313 || y_579317;
                                            bool leq_y_x_579319;
                                            
                                            if (cond_579318) {
                                                leq_y_x_579319 = 1;
                                            } else {
                                                bool x_579320 = sle64((int64_t) 0, zgze_lhs_579314);
                                                bool y_579321 = slt64(zgze_lhs_579314, stride_579061);
                                                bool bounds_check_579322 = x_579320 && y_579321;
                                                bool index_certs_579323;
                                                
                                                if (!bounds_check_579322) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_579314, "] out of bounds for array of shape [", (long long) stride_579061, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:937:33-56\n   #13 ftSkyline.fut:926:17-937:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t zm_lhs_579327 = add64(tt_579263, n_579312);
                                                int64_t leq_arg0_579328 = sub64(zm_lhs_579327, (int64_t) 1);
                                                bool x_579329 = sle64((int64_t) 0, leq_arg0_579328);
                                                bool y_579330 = slt64(leq_arg0_579328, j_m_i_579085);
                                                bool bounds_check_579331 = x_579329 && y_579330;
                                                bool index_certs_579332;
                                                
                                                if (!bounds_check_579331) {
                                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_579328, "] out of bounds for array of shape [", (long long) j_m_i_579085, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #10 lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #11 /prelude/functional.fut:9:44-45\n   #12 ftSkyline.fut:937:33-56\n   #13 ftSkyline.fut:926:17-937:56\n"));
                                                    err = FUTHARK_PROGRAM_ERROR;
                                                    goto cleanup;
                                                }
                                                
                                                int64_t slice_579324 = start_579137 + zgze_lhs_579314;
                                                int64_t leq_arg1_579325 = ((int64_t *) mem_param_586683.mem)[slice_579324];
                                                float leq_arg1_579326 = ((float *) mem_param_586686.mem)[slice_579324];
                                                int64_t slice_579333 = stride_579061 + leq_arg0_579328;
                                                int64_t slice_579334 = start_579137 + slice_579333;
                                                int64_t leq_arg0_579335 = ((int64_t *) mem_param_586683.mem)[slice_579334];
                                                float leq_arg0_579336 = ((float *) mem_param_586686.mem)[slice_579334];
                                                bool cond_579337 = slt64(leq_arg0_579335, leq_arg1_579325);
                                                bool cond_579338 = leq_arg0_579335 == leq_arg1_579325;
                                                bool zlze_res_579339 = leq_arg0_579336 <= leq_arg1_579326;
                                                bool x_579340 = cond_579338 && zlze_res_579339;
                                                bool x_579341 = !cond_579337;
                                                bool y_579342 = x_579340 && x_579341;
                                                bool defunc_0_leq_res_579343 = cond_579337 || y_579342;
                                                
                                                leq_y_x_579319 = defunc_0_leq_res_579343;
                                            }
                                            
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579344;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579345;
                                            int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_579346;
                                            
                                            if (leq_y_x_579319) {
                                                int64_t tmp_585619 = add64(tt_579263, n_579312);
                                                int64_t tmp_585620 = sub64(count_579265, n_579312);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579344 = tmp_585619;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579345 = tt_579264;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579346 = tmp_585620;
                                            } else {
                                                int64_t tmp_579349 = add64(tt_579263, n_579312);
                                                
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579344 = tt_579263;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579345 = tmp_579349;
                                                defunc_0_lifted_step_res_f_res_f_res_f_res_579346 = count_579265;
                                            }
                                            defunc_0_lifted_step_res_f_res_f_res_579281 = ss_579261;
                                            defunc_0_lifted_step_res_f_res_f_res_579282 = defunc_0_lifted_step_res_f_res_f_res_f_res_579344;
                                            defunc_0_lifted_step_res_f_res_f_res_579283 = defunc_0_lifted_step_res_f_res_f_res_f_res_579345;
                                            defunc_0_lifted_step_res_f_res_f_res_579284 = defunc_0_lifted_step_res_f_res_f_res_f_res_579346;
                                        }
                                        defunc_0_lifted_step_res_f_res_579275 = defunc_0_lifted_step_res_f_res_f_res_579281;
                                        defunc_0_lifted_step_res_f_res_579276 = defunc_0_lifted_step_res_f_res_f_res_579282;
                                        defunc_0_lifted_step_res_f_res_579277 = defunc_0_lifted_step_res_f_res_f_res_579283;
                                        defunc_0_lifted_step_res_f_res_579278 = defunc_0_lifted_step_res_f_res_f_res_579284;
                                    }
                                    defunc_0_lifted_step_res_579268 = defunc_0_lifted_step_res_f_res_579275;
                                    defunc_0_lifted_step_res_579269 = defunc_0_lifted_step_res_f_res_579276;
                                    defunc_0_lifted_step_res_579270 = defunc_0_lifted_step_res_f_res_579277;
                                    defunc_0_lifted_step_res_579271 = defunc_0_lifted_step_res_f_res_579278;
                                }
                                
                                int64_t loopres_579350;
                                int64_t loopres_579351;
                                int64_t loopres_579352;
                                int64_t loopres_579353;
                                int64_t loopres_579354;
                                
                                if (futrts_lifted_normalizze_13231(ctx, &loopres_579350, &loopres_579351, &loopres_579352, &loopres_579353, &loopres_579354, defunc_0_lifted_step_res_579268, ss_579262, defunc_0_lifted_step_res_579269, defunc_0_lifted_step_res_579270, defunc_0_lifted_step_res_579271) != 0) {
                                    err = 1;
                                    goto cleanup;
                                }
                                
                                bool loop_cond_579355 = slt64((int64_t) 0, loopres_579354);
                                bool loop_while_tmp_588150 = loop_cond_579355;
                                int64_t ss_tmp_588151 = loopres_579350;
                                int64_t ss_tmp_588152 = loopres_579351;
                                int64_t tt_tmp_588153 = loopres_579352;
                                int64_t tt_tmp_588154 = loopres_579353;
                                int64_t count_tmp_588155 = loopres_579354;
                                
                                loop_while_579260 = loop_while_tmp_588150;
                                ss_579261 = ss_tmp_588151;
                                ss_579262 = ss_tmp_588152;
                                tt_579263 = tt_tmp_588153;
                                tt_579264 = tt_tmp_588154;
                                count_579265 = count_tmp_588155;
                            }
                            defunc_0_split_count_res_579254 = loop_while_579260;
                            defunc_0_split_count_res_579255 = ss_579261;
                            defunc_0_split_count_res_579256 = ss_579262;
                            defunc_0_split_count_res_579257 = tt_579263;
                            defunc_0_split_count_res_579258 = tt_579264;
                            defunc_0_split_count_res_579259 = count_579265;
                            ((int64_t *) mem_586726)[i_586192] = defunc_0_split_count_res_579255;
                            ((int64_t *) mem_586728)[i_586192] = defunc_0_split_count_res_579257;
                        }
                        if (mem_586743_cached_sizze_589092 < bytes_586742) {
                            err = lexical_realloc(ctx, &mem_586743, &mem_586743_cached_sizze_589092, bytes_586742);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586746_cached_sizze_589093 < bytes_586745) {
                            err = lexical_realloc(ctx, &mem_586746, &mem_586746_cached_sizze_589093, bytes_586745);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586750_cached_sizze_589094 < bytes_586749) {
                            err = lexical_realloc(ctx, &mem_586750, &mem_586750_cached_sizze_589094, bytes_586749);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        if (mem_586753_cached_sizze_589095 < bytes_586742) {
                            err = lexical_realloc(ctx, &mem_586753, &mem_586753_cached_sizze_589095, bytes_586742);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586203 = 0; i_586203 < num_blocks_579083; i_586203++) {
                            bool y_579363 = slt64(i_586203, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084);
                            bool index_certs_579365;
                            
                            if (!y_579363) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586203, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_579366 = ((int64_t *) mem_586726)[i_586203];
                            int64_t defunc_0_f_res_579367 = ((int64_t *) mem_586728)[i_586203];
                            int64_t tmp_579368 = add64((int64_t) 1, i_586203);
                            bool x_579369 = sle64((int64_t) 0, tmp_579368);
                            bool y_579370 = slt64(tmp_579368, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084);
                            bool bounds_check_579371 = x_579369 && y_579370;
                            bool index_certs_579372;
                            
                            if (!bounds_check_579371) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_579368, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_579084, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t defunc_0_f_res_579373 = ((int64_t *) mem_586726)[tmp_579368];
                            int64_t defunc_0_f_res_579374 = ((int64_t *) mem_586728)[tmp_579368];
                            int64_t merge_sequential_arg2_579375 = add64(stride_579061, defunc_0_f_res_579367);
                            int64_t merge_sequential_arg2_579376 = add64(stride_579061, defunc_0_f_res_579374);
                            int64_t j_m_i_579377 = sub64(merge_sequential_arg2_579376, merge_sequential_arg2_579375);
                            bool empty_slice_579378 = j_m_i_579377 == (int64_t) 0;
                            int64_t m_579379 = sub64(j_m_i_579377, (int64_t) 1);
                            int64_t i_p_m_t_s_579380 = add64(merge_sequential_arg2_579375, m_579379);
                            bool zzero_leq_i_p_m_t_s_579381 = sle64((int64_t) 0, i_p_m_t_s_579380);
                            bool i_p_m_t_s_leq_w_579382 = slt64(i_p_m_t_s_579380, next_stride_579062);
                            bool zzero_lte_i_579383 = sle64((int64_t) 0, merge_sequential_arg2_579375);
                            bool i_lte_j_579384 = sle64(merge_sequential_arg2_579375, merge_sequential_arg2_579376);
                            bool y_579385 = i_p_m_t_s_leq_w_579382 && zzero_lte_i_579383;
                            bool y_579386 = zzero_leq_i_p_m_t_s_579381 && y_579385;
                            bool forwards_ok_579387 = i_lte_j_579384 && y_579386;
                            bool ok_or_empty_579388 = empty_slice_579378 || forwards_ok_579387;
                            bool index_certs_579389;
                            
                            if (!ok_or_empty_579388) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_579375, ":", (long long) merge_sequential_arg2_579376, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t j_m_i_579390 = sub64(defunc_0_f_res_579373, defunc_0_f_res_579366);
                            bool empty_slice_579391 = j_m_i_579390 == (int64_t) 0;
                            int64_t m_579392 = sub64(j_m_i_579390, (int64_t) 1);
                            int64_t i_p_m_t_s_579393 = add64(defunc_0_f_res_579366, m_579392);
                            bool zzero_leq_i_p_m_t_s_579394 = sle64((int64_t) 0, i_p_m_t_s_579393);
                            bool i_p_m_t_s_leq_w_579395 = slt64(i_p_m_t_s_579393, next_stride_579062);
                            bool zzero_lte_i_579396 = sle64((int64_t) 0, defunc_0_f_res_579366);
                            bool i_lte_j_579397 = sle64(defunc_0_f_res_579366, defunc_0_f_res_579373);
                            bool y_579398 = i_p_m_t_s_leq_w_579395 && zzero_lte_i_579396;
                            bool y_579399 = zzero_leq_i_p_m_t_s_579394 && y_579398;
                            bool forwards_ok_579400 = i_lte_j_579397 && y_579399;
                            bool ok_or_empty_579401 = empty_slice_579391 || forwards_ok_579400;
                            bool index_certs_579402;
                            
                            if (!ok_or_empty_579401) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_579366, ":", (long long) defunc_0_f_res_579373, "] out of bounds for array of shape [", (long long) next_stride_579062, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSkyline.fut:937:33-56\n   #10 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            bool cond_579403 = slt64((int64_t) 0, j_m_i_579390);
                            bool y_579414 = slt64((int64_t) 0, j_m_i_579377);
                            bool protect_assert_disj_587750 = cond_579403 || y_579414;
                            bool index_certs_579415;
                            
                            if (!protect_assert_disj_587750) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSkyline.fut:937:33-56\n   #12 ftSkyline.fut:926:17-937:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_579416 = start_579137 + merge_sequential_arg2_579375;
                            int64_t binop_y_586772 = dim_416322 * slice_579416;
                            int64_t slice_585622 = start_579137 + defunc_0_f_res_579366;
                            int64_t binop_y_586774 = dim_416322 * slice_585622;
                            int64_t ext_586776;
                            
                            if (cond_579403) {
                                ext_586776 = binop_y_586774;
                            } else {
                                ext_586776 = binop_y_586772;
                            }
                            
                            int64_t dummy_579404;
                            float dummy_579405;
                            int64_t dummy_579407;
                            
                            if (cond_579403) {
                                int64_t head_res_585623 = ((int64_t *) mem_param_586683.mem)[slice_585622];
                                float head_res_585624 = ((float *) mem_param_586686.mem)[slice_585622];
                                int64_t head_res_585626 = ((int64_t *) mem_param_586693.mem)[slice_585622];
                                
                                dummy_579404 = head_res_585623;
                                dummy_579405 = head_res_585624;
                                dummy_579407 = head_res_585626;
                            } else {
                                int64_t head_res_579417 = ((int64_t *) mem_param_586683.mem)[slice_579416];
                                float head_res_579418 = ((float *) mem_param_586686.mem)[slice_579416];
                                int64_t head_res_579420 = ((int64_t *) mem_param_586693.mem)[slice_579416];
                                
                                dummy_579404 = head_res_579417;
                                dummy_579405 = head_res_579418;
                                dummy_579407 = head_res_579420;
                            }
                            for (int64_t nest_i_588160 = 0; nest_i_588160 < merge_block_sizze_578882; nest_i_588160++) {
                                ((int64_t *) mem_586743)[i_586203 * merge_block_sizze_578882 + nest_i_588160] = dummy_579404;
                            }
                            for (int64_t nest_i_588161 = 0; nest_i_588161 < merge_block_sizze_578882; nest_i_588161++) {
                                ((float *) mem_586746)[i_586203 * merge_block_sizze_578882 + nest_i_588161] = dummy_579405;
                            }
                            for (int64_t nest_i_588162 = 0; nest_i_588162 < merge_block_sizze_578882; nest_i_588162++) {
                                ((int64_t *) mem_586753)[i_586203 * merge_block_sizze_578882 + nest_i_588162] = dummy_579407;
                            }
                            for (int64_t nest_i_588163 = 0; nest_i_588163 < merge_block_sizze_578882; nest_i_588163++) {
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586750, i_586203 * lmad_arg_586771 + nest_i_588163 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586690.mem, ext_586776, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                            }
                            
                            int64_t data_579425;
                            int64_t i_579431 = (int64_t) 0;
                            
                            for (int64_t k_579430 = 0; k_579430 < merge_block_sizze_578882; k_579430++) {
                                int64_t j_579436 = sub64(k_579430, i_579431);
                                bool cond_579437 = j_579436 == j_m_i_579377;
                                bool x_587846 = !cond_579437;
                                bool cond_579439 = slt64(i_579431, j_m_i_579390);
                                bool x_585627 = sle64((int64_t) 0, j_579436);
                                bool y_585628 = slt64(j_579436, j_m_i_579377);
                                bool bounds_check_585629 = x_585627 && y_585628;
                                bool loop_not_taken_587834 = !cond_579439;
                                bool protect_assert_disj_587835 = bounds_check_585629 || loop_not_taken_587834;
                                bool protect_assert_disj_587849 = cond_579437 || protect_assert_disj_587835;
                                bool index_certs_585630;
                                
                                if (!protect_assert_disj_587849) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_579436, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585631 = merge_sequential_arg2_579375 + j_579436;
                                int64_t slice_585632 = start_579137 + slice_585631;
                                bool protect_cond_conj_587850 = cond_579439 && x_587846;
                                int64_t leq_arg1_585633;
                                
                                if (protect_cond_conj_587850) {
                                    int64_t x_587836 = ((int64_t *) mem_param_586683.mem)[slice_585632];
                                    
                                    leq_arg1_585633 = x_587836;
                                } else {
                                    leq_arg1_585633 = (int64_t) 0;
                                }
                                
                                float leq_arg1_585634;
                                
                                if (protect_cond_conj_587850) {
                                    float x_587838 = ((float *) mem_param_586686.mem)[slice_585632];
                                    
                                    leq_arg1_585634 = x_587838;
                                } else {
                                    leq_arg1_585634 = 0.0F;
                                }
                                
                                bool x_585635 = sle64((int64_t) 0, i_579431);
                                bool bounds_check_585636 = cond_579439 && x_585635;
                                bool protect_assert_disj_587841 = bounds_check_585636 || loop_not_taken_587834;
                                bool protect_assert_disj_587853 = cond_579437 || protect_assert_disj_587841;
                                bool index_certs_585637;
                                
                                if (!protect_assert_disj_587853) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579431, "] out of bounds for array of shape [", (long long) j_m_i_579390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_585638 = defunc_0_f_res_579366 + i_579431;
                                int64_t slice_585639 = start_579137 + slice_585638;
                                int64_t leq_arg0_585640;
                                
                                if (protect_cond_conj_587850) {
                                    int64_t x_587842 = ((int64_t *) mem_param_586683.mem)[slice_585639];
                                    
                                    leq_arg0_585640 = x_587842;
                                } else {
                                    leq_arg0_585640 = (int64_t) 0;
                                }
                                
                                float leq_arg0_585641;
                                
                                if (protect_cond_conj_587850) {
                                    float x_587844 = ((float *) mem_param_586686.mem)[slice_585639];
                                    
                                    leq_arg0_585641 = x_587844;
                                } else {
                                    leq_arg0_585641 = 0.0F;
                                }
                                
                                bool cond_585642 = slt64(leq_arg0_585640, leq_arg1_585633);
                                bool cond_585643 = leq_arg0_585640 == leq_arg1_585633;
                                bool zlze_res_585644 = leq_arg0_585641 <= leq_arg1_585634;
                                bool x_585645 = cond_585643 && zlze_res_585644;
                                bool x_585646 = !cond_585642;
                                bool y_585647 = x_585645 && x_585646;
                                bool defunc_0_leq_res_585648 = cond_585642 || y_585647;
                                bool x_587868 = cond_579439 && defunc_0_leq_res_585648;
                                bool cond_579438 = cond_579437 || x_587868;
                                bool protect_assert_disj_587742 = cond_579438 || bounds_check_585629;
                                bool index_certs_579482;
                                
                                if (!protect_assert_disj_587742) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_579436, "] out of bounds for array of shape [", (long long) j_m_i_579377, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool bounds_check_585652 = cond_579439 && x_585635;
                                bool loop_not_taken_587737 = !cond_579438;
                                bool protect_assert_disj_587738 = bounds_check_585652 || loop_not_taken_587737;
                                bool index_certs_585653;
                                
                                if (!protect_assert_disj_587738) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579431, "] out of bounds for array of shape [", (long long) j_m_i_579390, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:256:39-260:59\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSkyline.fut:937:33-56\n   #11 ftSkyline.fut:926:17-937:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_579484 = start_579137 + slice_585631;
                                int64_t binop_y_586799 = dim_416322 * slice_579484;
                                int64_t slice_585655 = start_579137 + slice_585638;
                                int64_t binop_y_586801 = dim_416322 * slice_585655;
                                int64_t ext_586803;
                                
                                if (cond_579438) {
                                    ext_586803 = binop_y_586801;
                                } else {
                                    ext_586803 = binop_y_586799;
                                }
                                
                                int64_t loopres_579463;
                                int64_t loopres_579464;
                                float loopres_579465;
                                int64_t loopres_579467;
                                
                                if (cond_579438) {
                                    int64_t tmp_585649 = add64((int64_t) 1, i_579431);
                                    int64_t tmp_585656 = ((int64_t *) mem_param_586683.mem)[slice_585655];
                                    float tmp_585657 = ((float *) mem_param_586686.mem)[slice_585655];
                                    int64_t tmp_585659 = ((int64_t *) mem_param_586693.mem)[slice_585655];
                                    
                                    loopres_579463 = tmp_585649;
                                    loopres_579464 = tmp_585656;
                                    loopres_579465 = tmp_585657;
                                    loopres_579467 = tmp_585659;
                                } else {
                                    int64_t tmp_579485 = ((int64_t *) mem_param_586683.mem)[slice_579484];
                                    float tmp_579486 = ((float *) mem_param_586686.mem)[slice_579484];
                                    int64_t tmp_579488 = ((int64_t *) mem_param_586693.mem)[slice_579484];
                                    
                                    loopres_579463 = i_579431;
                                    loopres_579464 = tmp_579485;
                                    loopres_579465 = tmp_579486;
                                    loopres_579467 = tmp_579488;
                                }
                                ((int64_t *) mem_586743)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579464;
                                ((float *) mem_586746)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579465;
                                lmad_copy_4b(ctx, 1, (uint32_t *) mem_586750, i_586203 * lmad_arg_586771 + k_579430 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_586690.mem, ext_586803, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
                                ((int64_t *) mem_586753)[i_586203 * merge_block_sizze_578882 + k_579430] = loopres_579467;
                                
                                int64_t i_tmp_588164 = loopres_579463;
                                
                                i_579431 = i_tmp_588164;
                            }
                            data_579425 = i_579431;
                        }
                        if (memblock_alloc(ctx, &mem_586836, bytes_586742, "mem_586836")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586836.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint64_t *) mem_586743, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_alloc(ctx, &mem_586840, bytes_586745, "mem_586840")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 2, (uint32_t *) mem_586840.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint32_t *) mem_586746, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_alloc(ctx, &mem_586845, bytes_586749, "mem_586845")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_4b(ctx, 3, (uint32_t *) mem_586845.mem, (int64_t) 0, (int64_t []) {dim_416322 * merge_block_sizze_578882, dim_416322, (int64_t) 1}, (uint32_t *) mem_586750, (int64_t) 0, (int64_t []) {lmad_arg_586771, dim_416322, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882, dim_416322});
                        if (memblock_alloc(ctx, &mem_586849, bytes_586742, "mem_586849")) {
                            err = 1;
                            goto cleanup;
                        }
                        lmad_copy_8b(ctx, 2, (uint64_t *) mem_586849.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (uint64_t *) mem_586753, (int64_t) 0, (int64_t []) {merge_block_sizze_578882, (int64_t) 1}, (int64_t []) {num_blocks_579083, merge_block_sizze_578882});
                        if (memblock_set(ctx, &ext_mem_586908, &mem_586836, "mem_586836") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586905, &mem_586840, "mem_586840") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586902, &mem_586845, "mem_586845") != 0)
                            return 1;
                        if (memblock_set(ctx, &ext_mem_586898, &mem_586849, "mem_586849") != 0)
                            return 1;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586696, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586908.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586908, "ext_mem_586908") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 1, (uint32_t *) mem_586699, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_586905.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586905, "ext_mem_586905") != 0)
                        return 1;
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_586703, i_586216 * lmad_arg_586724, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) ext_mem_586902.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {next_stride_579062, dim_416322});
                    if (memblock_unref(ctx, &ext_mem_586902, "ext_mem_586902") != 0)
                        return 1;
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_586706, i_586216 * next_stride_579062, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586898.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_579062});
                    if (memblock_unref(ctx, &ext_mem_586898, "ext_mem_586898") != 0)
                        return 1;
                }
                
                int64_t flat_dim_579501 = next_stride_579062 * num_merges_579066;
                
                if (memblock_alloc(ctx, &mem_586928, bytes_586695, "mem_586928")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586928.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint64_t *) mem_586696, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                if (memblock_alloc(ctx, &mem_586932, bytes_586698, "mem_586932")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 2, (uint32_t *) mem_586932.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint32_t *) mem_586699, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                if (memblock_alloc(ctx, &mem_586937, bytes_586702, "mem_586937")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_4b(ctx, 3, (uint32_t *) mem_586937.mem, (int64_t) 0, (int64_t []) {dim_416322 * next_stride_579062, dim_416322, (int64_t) 1}, (uint32_t *) mem_586703, (int64_t) 0, (int64_t []) {lmad_arg_586724, dim_416322, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062, dim_416322});
                if (memblock_alloc(ctx, &mem_586941, bytes_586695, "mem_586941")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 2, (uint64_t *) mem_586941.mem, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (uint64_t *) mem_586706, (int64_t) 0, (int64_t []) {next_stride_579062, (int64_t) 1}, (int64_t []) {num_merges_579066, next_stride_579062});
                
                bool loop_cond_579508 = slt64(next_stride_579062, flat_dim_578876);
                
                if (memblock_set(ctx, &mem_param_tmp_588124, &mem_586928, "mem_586928") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588125, &mem_586932, "mem_586932") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588126, &mem_586937, "mem_586937") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_588127, &mem_586941, "mem_586941") != 0)
                    return 1;
                
                int64_t loop_dz2084Uz2082U_tmp_588128 = flat_dim_579501;
                bool loop_while_tmp_588129 = loop_cond_579508;
                int64_t stride_tmp_588134 = next_stride_579062;
                
                if (memblock_set(ctx, &mem_param_586683, &mem_param_tmp_588124, "mem_param_tmp_588124") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586686, &mem_param_tmp_588125, "mem_param_tmp_588125") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586690, &mem_param_tmp_588126, "mem_param_tmp_588126") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_586693, &mem_param_tmp_588127, "mem_param_tmp_588127") != 0)
                    return 1;
                loop_dz2084Uz2082U_579055 = loop_dz2084Uz2082U_tmp_588128;
                loop_while_579056 = loop_while_tmp_588129;
                stride_579061 = stride_tmp_588134;
            }
            if (memblock_set(ctx, &ext_mem_586955, &mem_param_586683, "mem_param_586683") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586954, &mem_param_586686, "mem_param_586686") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586953, &mem_param_586690, "mem_param_586690") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586952, &mem_param_586693, "mem_param_586693") != 0)
                return 1;
            data_579048 = loop_dz2084Uz2082U_579055;
            data_579049 = loop_while_579056;
            data_579054 = stride_579061;
            if (memblock_unref(ctx, &mem_586666, "mem_586666") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586670, "mem_586670") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_586679, "mem_586679") != 0)
                return 1;
            
            bool i_p_m_t_s_leq_w_579511 = slt64(zs_lhs_578851, data_579048);
            bool y_579512 = zzero_leq_i_p_m_t_s_579510 && i_p_m_t_s_leq_w_579511;
            bool ok_or_empty_579513 = empty_slice_579509 || y_579512;
            bool index_certs_579514;
            
            if (!ok_or_empty_579513) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_416325, "] out of bounds for array of shape [", (long long) data_579048, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            if (memblock_set(ctx, &ext_mem_586962, &ext_mem_586953, "ext_mem_586953") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_586958, &ext_mem_586952, "ext_mem_586952") != 0)
                return 1;
        }
        if (memblock_alloc(ctx, &mem_586964, bytes_586418, "mem_586964")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_586964.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_586958.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_416325});
        if (memblock_unref(ctx, &ext_mem_586958, "ext_mem_586958") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_586967, bytes_586966, "mem_586967")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_586967.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) ext_mem_586962.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {n_416325, dim_416322});
        if (memblock_unref(ctx, &ext_mem_586962, "ext_mem_586962") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587402, &mem_586967, "mem_586967") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_587401, &mem_586964, "mem_586964") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
        return 1;
    
    int64_t defunc_0_reduce_res_585698;
    int64_t redout_586221 = (int64_t) 9223372036854775807;
    
    for (int64_t i_586222 = 0; i_586222 < dim_416322; i_586222++) {
        int64_t x_579529 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586222];
        int64_t min_res_579532 = smin64(x_579529, redout_586221);
        int64_t redout_tmp_588169 = min_res_579532;
        
        redout_586221 = redout_tmp_588169;
    }
    defunc_0_reduce_res_585698 = redout_586221;
    
    bool cond_579533 = defunc_0_reduce_res_585698 == (int64_t) 1;
    bool bounds_invalid_upwards_579534 = slt64(total_grid_no_416333, (int64_t) 0);
    bool valid_579535 = !bounds_invalid_upwards_579534;
    bool protect_assert_disj_579536 = cond_579533 || valid_579535;
    bool range_valid_c_579537;
    
    if (!protect_assert_disj_579536) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_grid_no_416333, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:234:65-78\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool protect_assert_disj_582357 = y_578724 || cond_579533;
    bool index_certs_579544;
    
    if (!protect_assert_disj_582357) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:232:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSkyline.fut:937:33-56\n   #4  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587403 = (int64_t) 4 * total_grid_no_416333;
    
    if (cond_579533) {
        if (memblock_alloc(ctx, &mem_587440, total_grid_no_416333, "mem_587440")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588170 = 0; nest_i_588170 < total_grid_no_416333; nest_i_588170++) {
            ((bool *) mem_587440.mem)[nest_i_588170] = 0;
        }
        if (memblock_set(ctx, &ext_mem_587443, &mem_587440, "mem_587440") != 0)
            return 1;
    } else {
        if (mem_587404_cached_sizze_589119 < bytes_587403) {
            err = lexical_realloc(ctx, &mem_587404, &mem_587404_cached_sizze_589119, bytes_587403);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t nest_i_588171 = 0; nest_i_588171 < total_grid_no_416333; nest_i_588171++) {
            ((int32_t *) mem_587404)[nest_i_588171] = 0;
        }
        if (mem_587409_cached_sizze_589120 < bytes_586444) {
            err = lexical_realloc(ctx, &mem_587409, &mem_587409_cached_sizze_589120, bytes_586444);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t iter_586227 = 0; iter_586227 < n_416325; iter_586227++) {
            for (int64_t i_586225 = 0; i_586225 < dim_416322; i_586225++) {
                float eta_p_584429 = ((float *) ext_mem_587402.mem)[iter_586227 * dim_416322 + i_586225];
                float eta_p_584430 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586225];
                float eta_p_584431 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586225];
                int64_t eta_p_584433 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586225];
                float defunc_0_f_res_584434 = eta_p_584429 - eta_p_584430;
                float defunc_0_f_res_584436 = defunc_0_f_res_584434 / eta_p_584431;
                int64_t f32_res_584438 = fptosi_f32_i64(defunc_0_f_res_584436);
                int64_t max_res_584440 = smax64((int64_t) 0, f32_res_584438);
                int64_t zm_lhs_584446 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586225];
                int64_t min_arg1_584447 = sub64(zm_lhs_584446, (int64_t) 1);
                int64_t min_res_584448 = smin64(max_res_584440, min_arg1_584447);
                int64_t defunc_0_f_res_584450 = mul64(eta_p_584433, min_res_584448);
                
                ((int64_t *) mem_587409)[i_586225] = defunc_0_f_res_584450;
            }
            
            int64_t defunc_0_foldl_res_584357;
            int64_t acc_584359 = (int64_t) 0;
            
            for (int64_t i_584358 = 0; i_584358 < dim_416322; i_584358++) {
                int64_t b_584360 = ((int64_t *) mem_587409)[i_584358];
                int64_t defunc_0_f_res_584361 = add64(acc_584359, b_584360);
                int64_t acc_tmp_588174 = defunc_0_f_res_584361;
                
                acc_584359 = acc_tmp_588174;
            }
            defunc_0_foldl_res_584357 = acc_584359;
            
            bool less_than_zzero_586231 = slt64(defunc_0_foldl_res_584357, (int64_t) 0);
            bool greater_than_sizze_586232 = sle64(total_grid_no_416333, defunc_0_foldl_res_584357);
            bool outside_bounds_dim_586233 = less_than_zzero_586231 || greater_than_sizze_586232;
            
            if (!outside_bounds_dim_586233) {
                int32_t read_hist_586235 = ((int32_t *) mem_587404)[defunc_0_foldl_res_584357];
                int32_t defunc_0_op_res_579584 = add32(1, read_hist_586235);
                
                ((int32_t *) mem_587404)[defunc_0_foldl_res_584357] = defunc_0_op_res_579584;
            }
        }
        if (memblock_alloc(ctx, &mem_587419, total_grid_no_416333, "mem_587419")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_588175 = 0; nest_i_588175 < total_grid_no_416333; nest_i_588175++) {
            ((bool *) mem_587419.mem)[nest_i_588175] = 0;
        }
        if (mem_587423_cached_sizze_589121 < dim_416322) {
            err = lexical_realloc(ctx, &mem_587423, &mem_587423_cached_sizze_589121, dim_416322);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_579589 = 0; i_579589 < total_grid_no_416333; i_579589++) {
            for (int64_t i_586240 = 0; i_586240 < dim_416322; i_586240++) {
                int64_t eta_p_579592 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586240];
                int64_t eta_p_579593 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586240];
                bool defunc_0_f_res_579594;
                
                if (futrts_lifted_lambda_13270(ctx, &defunc_0_f_res_579594, i_579589, eta_p_579592, eta_p_579593) != 0) {
                    err = 1;
                    goto cleanup;
                }
                ((bool *) mem_587423)[i_586240] = defunc_0_f_res_579594;
            }
            
            bool defunc_0_f_res_579595;
            bool acc_579597 = 0;
            
            for (int64_t i_579596 = 0; i_579596 < dim_416322; i_579596++) {
                bool b_579598 = ((bool *) mem_587423)[i_579596];
                bool defunc_0_f_res_579599 = acc_579597 || b_579598;
                bool acc_tmp_588178 = defunc_0_f_res_579599;
                
                acc_579597 = acc_tmp_588178;
            }
            defunc_0_f_res_579595 = acc_579597;
            if (!defunc_0_f_res_579595) {
                bool y_579601 = slt64(i_579589, dz2080U_416323);
                bool index_certs_579602;
                
                if (!y_579601) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_579589, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:242:46-76\n   #1  ftSkyline.fut:937:33-56\n   #2  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool bounds_invalid_upwards_579604 = slt64(i_579589, (int64_t) 0);
                bool valid_579605 = !bounds_invalid_upwards_579604;
                bool range_valid_c_579606;
                
                if (!valid_579605) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) i_579589, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftSkyline.fut:243:44-50\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool defunc_0_reduce_res_585685;
                bool redout_586246 = 0;
                
                for (int64_t i_586247 = 0; i_586247 < i_579589; i_586247++) {
                    bool cond_584454 = i_586247 == i_579589;
                    bool cond_584455;
                    
                    if (cond_584454) {
                        cond_584455 = 1;
                    } else {
                        bool y_584457 = slt64(i_586247, total_grid_no_416333);
                        bool index_certs_584459;
                        
                        if (!y_584457) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586247, "] out of bounds for array of shape [", (long long) total_grid_no_416333, "].", "-> #0  ftSkyline.fut:245:61-83\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_lhs_584460 = ((int32_t *) mem_587404)[i_586247];
                        bool cond_f_res_584461 = zeze_lhs_584460 == 0;
                        
                        cond_584455 = cond_f_res_584461;
                    }
                    
                    bool defunc_0_f_res_584462;
                    
                    if (cond_584455) {
                        defunc_0_f_res_584462 = 0;
                    } else {
                        bool y_584464 = slt64(i_586247, dz2080U_416323);
                        bool index_certs_584466;
                        
                        if (!y_584464) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_586247, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:247:103-133\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (mem_587430_cached_sizze_589122 < dim_416322) {
                            err = lexical_realloc(ctx, &mem_587430, &mem_587430_cached_sizze_589122, dim_416322);
                            if (err != FUTHARK_SUCCESS)
                                goto cleanup;
                        }
                        for (int64_t i_586244 = 0; i_586244 < dim_416322; i_586244++) {
                            float eta_p_584469 = ((float *) start_of_grid_partition_mem_586416.mem)[i_579589 * dim_416322 + i_586244];
                            float eta_p_584470 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586247 * dim_416322 + i_586244];
                            bool defunc_0_f_res_584471 = eta_p_584470 < eta_p_584469;
                            
                            ((bool *) mem_587430)[i_586244] = defunc_0_f_res_584471;
                        }
                        
                        bool defunc_0_foldl_res_584472;
                        bool acc_584474 = 1;
                        
                        for (int64_t i_584473 = 0; i_584473 < dim_416322; i_584473++) {
                            bool b_584475 = ((bool *) mem_587430)[i_584473];
                            bool x_584476 = acc_584474 && b_584475;
                            bool acc_tmp_588181 = x_584476;
                            
                            acc_584474 = acc_tmp_588181;
                        }
                        defunc_0_foldl_res_584472 = acc_584474;
                        defunc_0_f_res_584462 = defunc_0_foldl_res_584472;
                    }
                    
                    bool defunc_0_op_res_579640 = defunc_0_f_res_584462 || redout_586246;
                    bool redout_tmp_588179 = defunc_0_op_res_579640;
                    
                    redout_586246 = redout_tmp_588179;
                }
                defunc_0_reduce_res_585685 = redout_586246;
                ((bool *) mem_587419.mem)[i_579589] = defunc_0_reduce_res_585685;
            }
        }
        if (memblock_set(ctx, &ext_mem_587443, &mem_587419, "mem_587419") != 0)
            return 1;
    }
    
    bool index_certs_579653;
    
    if (!y_578724) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:163:23-53\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587445_cached_sizze_589123 < bytes_586426) {
        err = lexical_realloc(ctx, &mem_587445, &mem_587445_cached_sizze_589123, bytes_586426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_586250 = 0; i_586250 < dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324; i_586250++) {
        int64_t dzlz7bUskOpzii64_to_ftz7dUzg_arg0_579733 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586250];
        float i64_res_579734 = sitofp_i64_f32(dzlz7bUskOpzii64_to_ftz7dUzg_arg0_579733);
        float defunc_0_fover_res_579735 = 1.5707964F / i64_res_579734;
        
        ((float *) mem_587445)[i_586250] = defunc_0_fover_res_579735;
    }
    
    bool empty_or_match_cert_579737;
    
    if (!assert_cond_578019) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "function arguments of wrong shape", "-> #0  ftSkyline.fut:193:17-28\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_579774 = total_angle_no_416332 == (int64_t) 0;
    bool nonzzero_579775 = !zzero_579774;
    bool nonzzero_cert_579776;
    
    if (!nonzzero_579775) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:139:31-51\n   #1  ftSkyline.fut:210:10-255:75\n   #2  /prelude/soacs.fut:255:31-32\n   #3  /prelude/soacs.fut:255:48-50\n   #4  /prelude/functional.fut:9:44-45\n   #5  ftSkyline.fut:937:33-56\n   #6  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_587453_cached_sizze_589124 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587453, &mem_587453_cached_sizze_589124, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587455_cached_sizze_589125 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587455, &mem_587455_cached_sizze_589125, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587457_cached_sizze_589126 < bytes_586418) {
        err = lexical_realloc(ctx, &mem_587457, &mem_587457_cached_sizze_589126, bytes_586418);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587468_cached_sizze_589127 < bytes_586444) {
        err = lexical_realloc(ctx, &mem_587468, &mem_587468_cached_sizze_589127, bytes_586444);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587476_cached_sizze_589128 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_587476, &mem_587476_cached_sizze_589128, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587484_cached_sizze_589129 < bytes_586468) {
        err = lexical_realloc(ctx, &mem_587484, &mem_587484_cached_sizze_589129, bytes_586468);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_587500_cached_sizze_589131 < bytes_586484) {
        err = lexical_realloc(ctx, &mem_587500, &mem_587500_cached_sizze_589131, bytes_586484);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586279;
    int64_t scanacc_586271 = (int64_t) 0;
    
    for (int64_t i_586275 = 0; i_586275 < n_416325; i_586275++) {
        for (int64_t i_586254 = 0; i_586254 < dim_416322; i_586254++) {
            float eta_p_584559 = ((float *) ext_mem_587402.mem)[i_586275 * dim_416322 + i_586254];
            float eta_p_584560 = ((float *) start_of_grid_partition_mem_586416.mem)[i_586254];
            float eta_p_584561 = ((float *) grid_part_sizze_per_dim_mem_586414.mem)[i_586254];
            int64_t eta_p_584563 = ((int64_t *) grid_part_prefix_sum_mem_586413.mem)[i_586254];
            float defunc_0_f_res_584564 = eta_p_584559 - eta_p_584560;
            float defunc_0_f_res_584566 = defunc_0_f_res_584564 / eta_p_584561;
            int64_t f32_res_584568 = fptosi_f32_i64(defunc_0_f_res_584566);
            int64_t max_res_584570 = smax64((int64_t) 0, f32_res_584568);
            int64_t zm_lhs_584576 = ((int64_t *) grid_partitions_per_dim_mem_586415.mem)[i_586254];
            int64_t min_arg1_584577 = sub64(zm_lhs_584576, (int64_t) 1);
            int64_t min_res_584578 = smin64(max_res_584570, min_arg1_584577);
            int64_t defunc_0_f_res_584580 = mul64(eta_p_584563, min_res_584578);
            
            ((int64_t *) mem_587468)[i_586254] = defunc_0_f_res_584580;
        }
        
        int64_t defunc_0_foldl_res_582560;
        int64_t acc_582562 = (int64_t) 0;
        
        for (int64_t i_582561 = 0; i_582561 < dim_416322; i_582561++) {
            int64_t b_582563 = ((int64_t *) mem_587468)[i_582561];
            int64_t defunc_0_f_res_582564 = add64(acc_582562, b_582563);
            int64_t acc_tmp_588188 = defunc_0_f_res_582564;
            
            acc_582562 = acc_tmp_588188;
        }
        defunc_0_foldl_res_582560 = acc_582562;
        
        bool x_582565 = sle64((int64_t) 0, defunc_0_foldl_res_582560);
        bool y_582566 = slt64(defunc_0_foldl_res_582560, dz2080U_416323);
        bool bounds_check_582567 = x_582565 && y_582566;
        bool index_certs_582568;
        
        if (!bounds_check_582567) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_foldl_res_582560, "] out of bounds for array of shape [", (long long) dz2080U_416323, "].", "-> #0  ftSkyline.fut:180:48-78\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_586258 = 0; i_586258 < dim_416322; i_586258++) {
            float eta_p_582571 = ((float *) ext_mem_587402.mem)[i_586275 * dim_416322 + i_586258];
            float eta_p_582572 = ((float *) start_of_grid_partition_mem_586416.mem)[defunc_0_foldl_res_582560 * dim_416322 + i_586258];
            float defunc_0_f_res_582573 = eta_p_582571 - eta_p_582572;
            
            ((float *) mem_587476)[i_586258] = defunc_0_f_res_582573;
        }
        for (int64_t nest_i_588190 = 0; nest_i_588190 < arg_578018; nest_i_588190++) {
            ((float *) mem_587484)[nest_i_588190] = 0.0F;
        }
        for (int64_t i_582576 = 0; i_582576 < arg_578018; i_582576++) {
            bool y_582578 = slt64(i_582576, dim_416322);
            bool index_certs_582579;
            
            if (!y_582578) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_582576, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:152:38-43\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t map_arg1_582581 = add64((int64_t) 1, i_582576);
            int64_t j_m_i_582582 = sub64(dim_416322, map_arg1_582581);
            bool empty_slice_582583 = j_m_i_582582 == (int64_t) 0;
            int64_t m_582584 = sub64(j_m_i_582582, (int64_t) 1);
            int64_t i_p_m_t_s_582585 = add64(map_arg1_582581, m_582584);
            bool zzero_leq_i_p_m_t_s_582586 = sle64((int64_t) 0, i_p_m_t_s_582585);
            bool i_p_m_t_s_leq_w_582587 = slt64(i_p_m_t_s_582585, dim_416322);
            bool zzero_lte_i_582588 = sle64((int64_t) 0, map_arg1_582581);
            bool i_lte_j_582589 = sle64(map_arg1_582581, dim_416322);
            bool y_582590 = i_p_m_t_s_leq_w_582587 && zzero_lte_i_582588;
            bool y_582591 = zzero_leq_i_p_m_t_s_582586 && y_582590;
            bool forwards_ok_582592 = i_lte_j_582589 && y_582591;
            bool ok_or_empty_582593 = empty_slice_582583 || forwards_ok_582592;
            bool index_certs_582594;
            
            if (!ok_or_empty_582593) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) map_arg1_582581, ":", (long long) dim_416322, "] out of bounds for array of shape [", (long long) dim_416322, "].", "-> #0  ftSkyline.fut:153:110-123\n   #1  ftSkyline.fut:205:67-73\n   #2  ftSkyline.fut:253:84-88\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_587488 = (int64_t) 4 * j_m_i_582582;
            float this_x_582580 = ((float *) mem_587476)[i_582576];
            
            if (mem_587489_cached_sizze_589130 < bytes_587488) {
                err = lexical_realloc(ctx, &mem_587489, &mem_587489_cached_sizze_589130, bytes_587488);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_586262 = 0; i_586262 < j_m_i_582582; i_586262++) {
                int64_t slice_586364 = map_arg1_582581 + i_586262;
                float eta_p_582597 = ((float *) mem_587476)[slice_586364];
                float defunc_0_ftimes_res_582598 = eta_p_582597 * eta_p_582597;
                
                ((float *) mem_587489)[i_586262] = defunc_0_ftimes_res_582598;
            }
            
            float defunc_0_foldl_res_582599;
            float acc_582601 = 0.0F;
            
            for (int64_t i_582600 = 0; i_582600 < j_m_i_582582; i_582600++) {
                float b_582602 = ((float *) mem_587489)[i_582600];
                float defunc_0_f_res_582603 = acc_582601 + b_582602;
                float acc_tmp_588193 = defunc_0_f_res_582603;
                
                acc_582601 = acc_tmp_588193;
            }
            defunc_0_foldl_res_582599 = acc_582601;
            
            float sqrt_res_582604 = futrts_sqrt32(defunc_0_foldl_res_582599);
            float atan2_res_582605 = futrts_atan2_32(sqrt_res_582604, this_x_582580);
            
            ((float *) mem_587484)[i_582576] = atan2_res_582605;
        }
        for (int64_t i_586266 = 0; i_586266 < arg_578018; i_586266++) {
            float eta_p_582608 = ((float *) mem_587484)[i_586266];
            float eta_p_582609 = ((float *) mem_587445)[i_586266];
            int64_t eta_p_582610 = ((int64_t *) angle_part_prefix_sum_mem_586411.mem)[i_586266];
            int64_t eta_p_582611 = ((int64_t *) angle_partitions_per_dim_mem_586412.mem)[i_586266];
            float i64_res_582612 = sitofp_i64_f32(eta_p_582610);
            float defunc_0_fover_res_582613 = eta_p_582608 / eta_p_582609;
            float defunc_0_ftimes_res_582614 = i64_res_582612 * defunc_0_fover_res_582613;
            int64_t f32_res_582615 = fptosi_f32_i64(defunc_0_ftimes_res_582614);
            bool cond_582616 = slt64(f32_res_582615, (int64_t) 0);
            int64_t defunc_0_f_res_582617;
            
            if (cond_582616) {
                defunc_0_f_res_582617 = (int64_t) 0;
            } else {
                bool cond_582618 = sle64(eta_p_582611, f32_res_582615);
                int64_t defunc_0_f_res_f_res_582619;
                
                if (cond_582618) {
                    int64_t defunc_0_f_res_f_res_t_res_585690 = sub64(eta_p_582611, (int64_t) 1);
                    
                    defunc_0_f_res_f_res_582619 = defunc_0_f_res_f_res_t_res_585690;
                } else {
                    defunc_0_f_res_f_res_582619 = f32_res_582615;
                }
                defunc_0_f_res_582617 = defunc_0_f_res_f_res_582619;
            }
            ((int64_t *) mem_587500)[i_586266] = defunc_0_f_res_582617;
        }
        
        int64_t defunc_0_foldl_res_582621;
        int64_t acc_582623 = (int64_t) 0;
        
        for (int64_t i_582622 = 0; i_582622 < arg_578018; i_582622++) {
            int64_t b_582624 = ((int64_t *) mem_587500)[i_582622];
            int64_t defunc_0_f_res_582625 = add64(acc_582623, b_582624);
            int64_t acc_tmp_588195 = defunc_0_f_res_582625;
            
            acc_582623 = acc_tmp_588195;
        }
        defunc_0_foldl_res_582621 = acc_582623;
        
        int64_t zp_lhs_582626 = mul64(total_angle_no_416332, defunc_0_foldl_res_582560);
        int64_t get_id_from_grid_angle_res_582627 = add64(defunc_0_foldl_res_582621, zp_lhs_582626);
        int64_t grid_id_582629 = sdiv64(get_id_from_grid_angle_res_582627, total_angle_no_416332);
        bool x_582630 = sle64((int64_t) 0, grid_id_582629);
        bool y_582631 = slt64(grid_id_582629, total_grid_no_416333);
        bool bounds_check_582632 = x_582630 && y_582631;
        bool index_certs_582633;
        
        if (!bounds_check_582632) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) grid_id_582629, "] out of bounds for array of shape [", (long long) total_grid_no_416333, "].", "-> #0  ftSkyline.fut:256:38-61\n   #1  /prelude/soacs.fut:255:31-32\n   #2  /prelude/soacs.fut:255:48-50\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSkyline.fut:937:33-56\n   #5  ftSkyline.fut:926:17-937:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool tmp_582634 = ((bool *) ext_mem_587443.mem)[grid_id_582629];
        bool lifted_lambda_res_582635 = !tmp_582634;
        int64_t defunc_0_f_res_582636 = btoi_bool_i64(lifted_lambda_res_582635);
        int64_t defunc_0_op_res_579791 = add64(defunc_0_f_res_582636, scanacc_586271);
        
        ((int64_t *) mem_587453)[i_586275] = defunc_0_op_res_579791;
        ((int64_t *) mem_587455)[i_586275] = defunc_0_f_res_582636;
        ((int64_t *) mem_587457)[i_586275] = get_id_from_grid_angle_res_582627;
        
        int64_t scanacc_tmp_588183 = defunc_0_op_res_579791;
        
        scanacc_586271 = scanacc_tmp_588183;
    }
    discard_586279 = scanacc_586271;
    
    bool x_579793 = !empty_slice_579509;
    bool y_579796 = slt64(zs_lhs_578851, n_416325);
    bool bounds_check_579797 = zzero_leq_i_p_m_t_s_579510 && y_579796;
    bool protect_assert_disj_579798 = empty_slice_579509 || bounds_check_579797;
    bool index_certs_579799;
    
    if (!protect_assert_disj_579798) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zs_lhs_578851, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_579800;
    
    if (x_579793) {
        int64_t x_585695 = ((int64_t *) mem_587453)[zs_lhs_578851];
        
        m_f_res_579800 = x_585695;
    } else {
        m_f_res_579800 = (int64_t) 0;
    }
    
    int64_t m_579802;
    
    if (empty_slice_579509) {
        m_579802 = (int64_t) 0;
    } else {
        m_579802 = m_f_res_579800;
    }
    
    int64_t m_579813 = sub64(m_579802, (int64_t) 1);
    bool i_p_m_t_s_leq_w_579815 = slt64(m_579813, n_416325);
    bool zzero_leq_i_p_m_t_s_579814 = sle64((int64_t) 0, m_579813);
    bool y_579817 = zzero_leq_i_p_m_t_s_579814 && i_p_m_t_s_leq_w_579815;
    bool i_lte_j_579816 = sle64((int64_t) 0, m_579802);
    bool forwards_ok_579818 = i_lte_j_579816 && y_579817;
    bool eq_x_zz_579809 = (int64_t) 0 == m_f_res_579800;
    bool p_and_eq_x_y_579811 = x_579793 && eq_x_zz_579809;
    bool empty_slice_579812 = empty_slice_579509 || p_and_eq_x_y_579811;
    bool ok_or_empty_579819 = empty_slice_579812 || forwards_ok_579818;
    bool index_certs_579820;
    
    if (!ok_or_empty_579819) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_579802, "] out of bounds for array of shape [", (long long) n_416325, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t binop_x_587516 = (int64_t) 4 * m_579802;
    int64_t bytes_587517 = dim_416322 * binop_x_587516;
    int64_t bytes_587519 = (int64_t) 8 * m_579802;
    bool bounds_invalid_upwards_579852 = slt64(total_part_no_416334, (int64_t) 0);
    bool valid_579853 = !bounds_invalid_upwards_579852;
    bool range_valid_c_579854;
    
    if (!valid_579853) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) total_part_no_416334, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ftSkyline.fut:260:91-109\n   #2  ftSkyline.fut:937:33-56\n   #3  ftSkyline.fut:926:17-937:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_587545 = (int64_t) 8 * total_part_no_416334;
    
    if (memblock_alloc(ctx, &mem_587518, bytes_587517, "mem_587518")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 2, (uint32_t *) mem_587518.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (uint32_t *) ext_mem_587402.mem, (int64_t) 0, (int64_t []) {dim_416322, (int64_t) 1}, (int64_t []) {m_579802, dim_416322});
    if (mem_587520_cached_sizze_589132 < bytes_587519) {
        err = lexical_realloc(ctx, &mem_587520, &mem_587520_cached_sizze_589132, bytes_587519);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587520, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_587457, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_579802});
    if (memblock_alloc(ctx, &mem_587522, bytes_587519, "mem_587522")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_587522.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_587401.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_579802});
    if (mem_587534_cached_sizze_589133 < bytes_586452) {
        err = lexical_realloc(ctx, &mem_587534, &mem_587534_cached_sizze_589133, bytes_586452);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t write_iter_586280 = 0; write_iter_586280 < n_416325; write_iter_586280++) {
        int64_t write_iv_586284 = ((int64_t *) mem_587455)[write_iter_586280];
        int64_t write_iv_586285 = ((int64_t *) mem_587453)[write_iter_586280];
        int64_t write_iv_586287 = ((int64_t *) ext_mem_587401.mem)[write_iter_586280];
        int64_t write_iv_586288 = ((int64_t *) mem_587457)[write_iter_586280];
        
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_587534, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_587402.mem, write_iter_586280 * dim_416322, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
        
        bool cond_582515 = write_iv_586284 == (int64_t) 1;
        int64_t lifted_lambda_res_582516;
        
        if (cond_582515) {
            int64_t lifted_lambda_res_t_res_585696 = sub64(write_iv_586285, (int64_t) 1);
            
            lifted_lambda_res_582516 = lifted_lambda_res_t_res_585696;
        } else {
            lifted_lambda_res_582516 = (int64_t) -1;
        }
        if ((sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(dim_416322 - (int64_t) 1, dim_416322))) {
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_587518.mem, lifted_lambda_res_582516 * dim_416322, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_587534, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {dim_416322});
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) {
            ((int64_t *) mem_587522.mem)[lifted_lambda_res_582516] = write_iv_586287;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_582516) && slt64(lifted_lambda_res_582516, m_579802)) {
            ((int64_t *) mem_587520)[lifted_lambda_res_582516] = write_iv_586288;
        }
    }
    if (memblock_unref(ctx, &ext_mem_587401, "ext_mem_587401") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_587402, "ext_mem_587402") != 0)
        return 1;
    if (mem_587546_cached_sizze_589134 < bytes_587545) {
        err = lexical_realloc(ctx, &mem_587546, &mem_587546_cached_sizze_589134, bytes_587545);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t nest_i_588199 = 0; nest_i_588199 < total_part_no_416334; nest_i_588199++) {
        ((int64_t *) mem_587546)[nest_i_588199] = (int64_t) 0;
    }
    for (int64_t iter_586292 = 0; iter_586292 < m_579802; iter_586292++) {
        int64_t pixel_586294 = ((int64_t *) mem_587520)[iter_586292];
        bool less_than_zzero_586296 = slt64(pixel_586294, (int64_t) 0);
        bool greater_than_sizze_586297 = sle64(total_part_no_416334, pixel_586294);
        bool outside_bounds_dim_586298 = less_than_zzero_586296 || greater_than_sizze_586297;
        
        if (!outside_bounds_dim_586298) {
            int64_t read_hist_586300 = ((int64_t *) mem_587546)[pixel_586294];
            int64_t defunc_0_op_res_579859 = add64((int64_t) 1, read_hist_586300);
            
            ((int64_t *) mem_587546)[pixel_586294] = defunc_0_op_res_579859;
        }
    }
    if (mem_587554_cached_sizze_589135 < bytes_587545) {
        err = lexical_realloc(ctx, &mem_587554, &mem_587554_cached_sizze_589135, bytes_587545);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_586308;
    int64_t scanacc_586304 = (int64_t) 0;
    
    for (int64_t i_586306 = 0; i_586306 < total_part_no_416334; i_586306++) {
        int64_t x_579863 = ((int64_t *) mem_587546)[i_586306];
        int64_t defunc_0_op_res_579866 = add64(x_579863, scanacc_586304);
        
        ((int64_t *) mem_587554)[i_586306] = defunc_0_op_res_579866;
        
        int64_t scanacc_tmp_588201 = defunc_0_op_res_579866;
        
        scanacc_586304 = scanacc_tmp_588201;
    }
    discard_586308 = scanacc_586304;
    if (memblock_alloc(ctx, &mem_587562, bytes_587545, "mem_587562")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_586311 = 0; i_586311 < total_part_no_416334; i_586311++) {
        int64_t zv_lhs_582503 = add64((int64_t) -1, i_586311);
        int64_t tmp_582504 = smod64(zv_lhs_582503, total_part_no_416334);
        int64_t lifted_lambda_res_582505 = ((int64_t *) mem_587554)[tmp_582504];
        bool cond_582507 = i_586311 == (int64_t) 0;
        int64_t lifted_lambda_res_582508;
        
        if (cond_582507) {
            lifted_lambda_res_582508 = (int64_t) 0;
        } else {
            lifted_lambda_res_582508 = lifted_lambda_res_582505;
        }
        ((int64_t *) mem_587562.mem)[i_586311] = lifted_lambda_res_582508;
    }
    if (memblock_set(ctx, &mem_out_588007, &ext_mem_587443, "ext_mem_587443") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588008, &mem_587562, "mem_587562") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588009, &mem_587518, "mem_587518") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_588010, &mem_587522, "mem_587522") != 0)
        return 1;
    prim_out_588011 = total_grid_no_416333;
    prim_out_588012 = total_part_no_416334;
    prim_out_588013 = m_579802;
    if (memblock_set(ctx, &*mem_out_p_589060, &mem_out_588007, "mem_out_588007") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_589061, &mem_out_588008, "mem_out_588008") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_589062, &mem_out_588009, "mem_out_588009") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_589063, &mem_out_588010, "mem_out_588010") != 0)
        return 1;
    *out_prim_out_589064 = prim_out_588011;
    *out_prim_out_589065 = prim_out_588012;
    *out_prim_out_589066 = prim_out_588013;
    
  cleanup:
    {
        free(mem_586427);
        free(mem_586435);
        free(mem_586437);
        free(mem_586445);
        free(mem_586453);
        free(mem_586455);
        free(mem_586469);
        free(mem_586474);
        free(mem_586485);
        free(mem_586510);
        free(mem_586513);
        free(mem_586517);
        free(mem_586520);
        free(mem_586540);
        free(mem_586542);
        free(mem_586545);
        free(mem_586547);
        free(mem_586605);
        free(mem_586607);
        free(mem_586696);
        free(mem_586699);
        free(mem_586703);
        free(mem_586706);
        free(mem_586726);
        free(mem_586728);
        free(mem_586743);
        free(mem_586746);
        free(mem_586750);
        free(mem_586753);
        free(mem_586969);
        free(mem_586977);
        free(mem_586982);
        free(mem_586990);
        free(mem_586998);
        free(mem_587003);
        free(mem_587014);
        free(mem_587036);
        free(mem_587040);
        free(mem_587043);
        free(mem_587059);
        free(mem_587062);
        free(mem_587064);
        free(mem_587110);
        free(mem_587112);
        free(mem_587181);
        free(mem_587185);
        free(mem_587188);
        free(mem_587204);
        free(mem_587206);
        free(mem_587221);
        free(mem_587225);
        free(mem_587228);
        free(mem_587404);
        free(mem_587409);
        free(mem_587423);
        free(mem_587430);
        free(mem_587445);
        free(mem_587453);
        free(mem_587455);
        free(mem_587457);
        free(mem_587468);
        free(mem_587476);
        free(mem_587484);
        free(mem_587489);
        free(mem_587500);
        free(mem_587520);
        free(mem_587534);
        free(mem_587546);
        free(mem_587554);
        if (memblock_unref(ctx, &mem_587562, "mem_587562") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587522, "mem_587522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587518, "mem_587518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587419, "mem_587419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587440, "mem_587440") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587443, "ext_mem_587443") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586967, "mem_586967") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586964, "mem_586964") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588127, "mem_param_tmp_588127") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588126, "mem_param_tmp_588126") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588125, "mem_param_tmp_588125") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588124, "mem_param_tmp_588124") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586941, "mem_586941") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586937, "mem_586937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586932, "mem_586932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586928, "mem_586928") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586849, "mem_586849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586845, "mem_586845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586840, "mem_586840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586836, "mem_586836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586864, "mem_586864") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586861, "mem_586861") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586859, "mem_586859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586857, "mem_586857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586898, "ext_mem_586898") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586902, "ext_mem_586902") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586905, "ext_mem_586905") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586908, "ext_mem_586908") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586693, "mem_param_586693") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586690, "mem_param_586690") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586686, "mem_param_586686") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586683, "mem_param_586683") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586952, "ext_mem_586952") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586953, "ext_mem_586953") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586954, "ext_mem_586954") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586955, "ext_mem_586955") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586679, "mem_586679") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586675, "mem_586675") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586670, "mem_586670") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586666, "mem_586666") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586564, "ext_mem_586564") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588100, "mem_param_tmp_588100") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586504, "ext_mem_586504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_586500, "mem_param_586500") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586507, "ext_mem_586507") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586958, "ext_mem_586958") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_586962, "ext_mem_586962") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587400, "mem_587400") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587397, "mem_587397") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588051, "mem_param_tmp_588051") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588050, "mem_param_tmp_588050") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588049, "mem_param_tmp_588049") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587377, "mem_587377") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587373, "mem_587373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587368, "mem_587368") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587304, "mem_587304") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587300, "mem_587300") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587295, "mem_587295") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587317, "mem_587317") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587314, "mem_587314") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587312, "mem_587312") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587345, "ext_mem_587345") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587349, "ext_mem_587349") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587352, "ext_mem_587352") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587178, "mem_param_587178") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587175, "mem_param_587175") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587171, "mem_param_587171") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587386, "ext_mem_587386") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587387, "ext_mem_587387") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587388, "ext_mem_587388") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587167, "mem_587167") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587163, "mem_587163") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_587158, "mem_587158") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587078, "ext_mem_587078") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_588030, "mem_param_tmp_588030") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587030, "ext_mem_587030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_587026, "mem_param_587026") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587033, "ext_mem_587033") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587391, "ext_mem_587391") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587395, "ext_mem_587395") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587401, "ext_mem_587401") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_587402, "ext_mem_587402") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_586419, "mem_586419") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588010, "mem_out_588010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588009, "mem_out_588009") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588008, "mem_out_588008") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_588007, "mem_out_588007") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_4833(struct futhark_context *ctx, int64_t *out_prim_out_589136, int64_t upper_bound_233466, int64_t n_233467)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_588007;
    bool upper_bound_233468 = sle64((int64_t) 1, upper_bound_233466);
    bool assert_c_233470;
    
    if (!upper_bound_233468) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (upper_bound >= 1)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:189:21-58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_233479 = slt64(upper_bound_233466, n_233467);
    bool d_233488;
    int64_t d_233489;
    bool loop_while_233490;
    int64_t d_233491;
    
    loop_while_233490 = cond_233479;
    d_233491 = (int64_t) 1;
    while (loop_while_233490) {
        int64_t loopres_233492 = add64((int64_t) 1, d_233491);
        bool zzero_233494 = loopres_233492 == (int64_t) 0;
        bool nonzzero_233495 = !zzero_233494;
        bool nonzzero_cert_233496;
        
        if (!nonzzero_233495) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t zg_lhs_233497 = sdiv64(n_233467, loopres_233492);
        bool cond_233499 = slt64(upper_bound_233466, zg_lhs_233497);
        bool loop_cond_233500;
        
        if (cond_233499) {
            loop_cond_233500 = 1;
        } else {
            int64_t znze_lhs_233504 = smod64(n_233467, loopres_233492);
            bool loop_cond_f_res_233506 = znze_lhs_233504 == (int64_t) 0;
            bool loop_cond_f_res_233507 = !loop_cond_f_res_233506;
            
            loop_cond_233500 = loop_cond_f_res_233507;
        }
        
        bool loop_while_tmp_588008 = loop_cond_233500;
        int64_t d_tmp_588009 = loopres_233492;
        
        loop_while_233490 = loop_while_tmp_588008;
        d_233491 = d_tmp_588009;
    }
    d_233488 = loop_while_233490;
    d_233489 = d_233491;
    
    bool zzero_233509 = d_233489 == (int64_t) 0;
    bool nonzzero_233510 = !zzero_233509;
    bool nonzzero_cert_233511;
    
    if (!nonzzero_233510) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_233512 = sdiv64(n_233467, d_233489);
    
    prim_out_588007 = greatest_divisor_leq_than_res_233512;
    *out_prim_out_589136 = prim_out_588007;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13270(struct futhark_context *ctx, bool *out_prim_out_589137, int64_t j_234369, int64_t pre_d_234370, int64_t per_d_234371)
{
    (void) ctx;
    
    int err = 0;
    bool prim_out_588007;
    bool zzero_234372 = pre_d_234370 == (int64_t) 0;
    bool nonzzero_234373 = !zzero_234372;
    bool nonzzero_cert_234374;
    
    if (!nonzzero_234373) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:239:69-75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_234377 = per_d_234371 == (int64_t) 0;
    bool nonzzero_234378 = !zzero_234377;
    bool nonzzero_cert_234379;
    
    if (!nonzzero_234378) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:239:76-82\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zv_lhs_234375 = sdiv64(j_234369, pre_d_234370);
    int64_t zeze_lhs_234380 = smod64(zv_lhs_234375, per_d_234371);
    bool lifted_lambda_res_234382 = zeze_lhs_234380 == (int64_t) 0;
    
    prim_out_588007 = lifted_lambda_res_234382;
    *out_prim_out_589137 = prim_out_588007;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13275(struct futhark_context *ctx, bool *out_prim_out_589138, int64_t j_251958, int64_t pre_d_251959, int64_t per_d_251960)
{
    (void) ctx;
    
    int err = 0;
    bool prim_out_588007;
    bool zzero_251961 = pre_d_251959 == (int64_t) 0;
    bool nonzzero_251962 = !zzero_251961;
    bool nonzzero_cert_251963;
    
    if (!nonzzero_251962) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:289:69-75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool zzero_251966 = per_d_251960 == (int64_t) 0;
    bool nonzzero_251967 = !zzero_251966;
    bool nonzzero_cert_251968;
    
    if (!nonzzero_251967) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:289:76-82\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zv_lhs_251964 = sdiv64(j_251958, pre_d_251959);
    int64_t zeze_lhs_251969 = smod64(zv_lhs_251964, per_d_251960);
    bool lifted_lambda_res_251971 = zeze_lhs_251969 == (int64_t) 0;
    
    prim_out_588007 = lifted_lambda_res_251971;
    *out_prim_out_589138 = prim_out_588007;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13310(struct futhark_context *ctx, int64_t *out_prim_out_589139, int64_t accumulated_subdiv_386856, int64_t angle_no_omitted_386857, int64_t grid_no_omitted_386858, int64_t i_386859)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_588007;
    int64_t zt_lhs_386860 = mul64(angle_no_omitted_386857, grid_no_omitted_386858);
    int64_t zv_rhs_386862 = mul64(accumulated_subdiv_386856, zt_lhs_386860);
    bool zzero_386864 = zv_rhs_386862 == (int64_t) 0;
    bool nonzzero_386865 = !zzero_386864;
    bool nonzzero_cert_386866;
    
    if (!nonzzero_386865) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSkyline.fut:626:30-83\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zeze_lhs_386867 = smod64(i_386859, zv_rhs_386862);
    bool cond_386869 = zeze_lhs_386867 == (int64_t) 0;
    int64_t lifted_lambda_res_386870;
    
    if (cond_386869) {
        lifted_lambda_res_386870 = i_386859;
    } else {
        lifted_lambda_res_386870 = (int64_t) -1;
    }
    prim_out_588007 = lifted_lambda_res_386870;
    *out_prim_out_589139 = prim_out_588007;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_lambda_13311(struct futhark_context *ctx, int64_t *out_prim_out_589140, int64_t i_386872)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_588007;
    bool cond_386873 = slt64(i_386872, (int64_t) 0);
    bool cond_neg_560449 = !cond_386873;
    int64_t lifted_lambda_res_386874 = btoi_bool_i64(cond_neg_560449);
    
    prim_out_588007 = lifted_lambda_res_386874;
    *out_prim_out_589140 = prim_out_588007;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_13231(struct futhark_context *ctx, int64_t *out_prim_out_589141, int64_t *out_prim_out_589142, int64_t *out_prim_out_589143, int64_t *out_prim_out_589144, int64_t *out_prim_out_589145, int64_t slo_233770, int64_t shi_233771, int64_t tlo_233772, int64_t thi_233773, int64_t count_233774)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_588007;
    int64_t prim_out_588008;
    int64_t prim_out_588009;
    int64_t prim_out_588010;
    int64_t prim_out_588011;
    int64_t min_arg1_233777 = add64(slo_233770, count_233774);
    int64_t min_res_562483 = smin64(shi_233771, min_arg1_233777);
    int64_t min_arg1_233781 = add64(tlo_233772, count_233774);
    int64_t min_res_562486 = smin64(thi_233773, min_arg1_233781);
    int64_t zp_lhs_233785 = sub64(min_res_562483, slo_233770);
    int64_t zp_rhs_233787 = sub64(min_res_562486, tlo_233772);
    int64_t zm_lhs_233789 = add64(zp_lhs_233785, zp_rhs_233787);
    int64_t slack_233791 = sub64(zm_lhs_233789, count_233774);
    int64_t min_res_562489 = smin64(zp_lhs_233785, slack_233791);
    int64_t min_res_562492 = smin64(zp_rhs_233787, min_res_562489);
    int64_t max_arg1_233801 = sub64(min_res_562483, min_res_562492);
    int64_t max_res_562495 = smax64(slo_233770, max_arg1_233801);
    int64_t max_arg1_233805 = sub64(min_res_562486, min_res_562492);
    int64_t max_res_562498 = smax64(tlo_233772, max_arg1_233805);
    int64_t zm_rhs_233809 = sub64(max_res_562495, slo_233770);
    int64_t zm_lhs_233811 = sub64(count_233774, zm_rhs_233809);
    int64_t zm_rhs_233813 = sub64(max_res_562498, tlo_233772);
    int64_t count_233815 = sub64(zm_lhs_233811, zm_rhs_233813);
    
    prim_out_588007 = max_res_562495;
    prim_out_588008 = min_res_562483;
    prim_out_588009 = max_res_562498;
    prim_out_588010 = min_res_562486;
    prim_out_588011 = count_233815;
    *out_prim_out_589141 = prim_out_588007;
    *out_prim_out_589142 = prim_out_588008;
    *out_prim_out_589143 = prim_out_588009;
    *out_prim_out_589144 = prim_out_588010;
    *out_prim_out_589145 = prim_out_588011;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_calc_global_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1)
{
    int64_t dim_305789 = (int64_t) 0;
    int64_t dz2080U_305790 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791 = (int64_t) 0;
    int64_t dz2081U_305792 = (int64_t) 0;
    int64_t dz2082U_305793 = (int64_t) 0;
    int64_t dz2083U_305794 = (int64_t) 0;
    int64_t total_angle_no_305801 = (int64_t) 0;
    int64_t total_grid_no_305802 = (int64_t) 0;
    int64_t total_part_no_305803 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_305789 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_305789 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_305789 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_305790 = in0->v5->shape[0];
    dim_305789 = in0->v5->shape[1];
    total_angle_no_305801 = in0->v6;
    total_grid_no_305802 = in0->v7;
    total_part_no_305803 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_305792 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_305793 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_305794 = in1->v2->shape[0];
    dim_305789 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_305794 = in1->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791 == in0->v1->shape[0] && (dim_305789 == in0->v2->shape[0] && (dim_305789 == in0->v3->shape[0] && (dim_305789 == in0->v4->shape[0] && (dz2080U_305790 == in0->v5->shape[0] && dim_305789 == in0->v5->shape[1])))))) && (dz2081U_305792 == in1->v0->shape[0] && (dz2082U_305793 == in1->v1->shape[0] && (dz2083U_305794 == in1->v2->shape[0] && (dim_305789 == in1->v2->shape[1] && dz2083U_305794 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_global_Skyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_305789, dz2080U_305790, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_305791, dz2081U_305792, dz2082U_305793, dz2083U_305794, total_angle_no_305801, total_grid_no_305802, total_part_no_305803);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_305792;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_305789;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_global_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1)
{
    int64_t dim_470048 = (int64_t) 0;
    int64_t dz2080U_470049 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050 = (int64_t) 0;
    int64_t dz2081U_470051 = (int64_t) 0;
    int64_t dz2082U_470052 = (int64_t) 0;
    int64_t dz2083U_470053 = (int64_t) 0;
    int64_t total_angle_no_470060 = (int64_t) 0;
    int64_t total_grid_no_470061 = (int64_t) 0;
    int64_t total_part_no_470062 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_470048 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_470048 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_470048 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_470049 = in0->v5->shape[0];
    dim_470048 = in0->v5->shape[1];
    total_angle_no_470060 = in0->v6;
    total_grid_no_470061 = in0->v7;
    total_part_no_470062 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_470051 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_470052 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_470053 = in1->v2->shape[0];
    dim_470048 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_470053 = in1->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050 == in0->v1->shape[0] && (dim_470048 == in0->v2->shape[0] && (dim_470048 == in0->v3->shape[0] && (dim_470048 == in0->v4->shape[0] && (dz2080U_470049 == in0->v5->shape[0] && dim_470048 == in0->v5->shape[1])))))) && (dz2081U_470051 == in1->v0->shape[0] && (dz2082U_470052 == in1->v1->shape[0] && (dz2083U_470053 == in1->v2->shape[0] && (dim_470048 == in1->v2->shape[1] && dz2083U_470053 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_global_Skyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_470048, dz2080U_470049, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_470050, dz2081U_470051, dz2082U_470052, dz2083U_470053, total_angle_no_470060, total_grid_no_470061, total_part_no_470062);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_470051;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_470048;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_intermSkyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const bool in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t dim_396635 = (int64_t) 0;
    int64_t dz2080U_396636 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637 = (int64_t) 0;
    int64_t dz2081U_396638 = (int64_t) 0;
    int64_t dz2082U_396639 = (int64_t) 0;
    int64_t dz2083U_396640 = (int64_t) 0;
    int64_t total_angle_no_396647 = (int64_t) 0;
    int64_t total_grid_no_396648 = (int64_t) 0;
    int64_t total_part_no_396649 = (int64_t) 0;
    bool include_angle_steps_396654 = 0;
    int64_t omit_step_396655 = (int64_t) 0;
    int64_t max_steps_396656 = (int64_t) 0;
    int64_t sizze_thresh_396657 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_396635 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_396635 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_396635 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_396636 = in0->v5->shape[0];
    dim_396635 = in0->v5->shape[1];
    total_angle_no_396647 = in0->v6;
    total_grid_no_396648 = in0->v7;
    total_part_no_396649 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_396638 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_396639 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_396640 = in1->v2->shape[0];
    dim_396635 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_396640 = in1->v3->shape[0];
    include_angle_steps_396654 = in2;
    omit_step_396655 = in3;
    max_steps_396656 = in4;
    sizze_thresh_396657 = in5;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637 == in0->v1->shape[0] && (dim_396635 == in0->v2->shape[0] && (dim_396635 == in0->v3->shape[0] && (dim_396635 == in0->v4->shape[0] && (dz2080U_396636 == in0->v5->shape[0] && dim_396635 == in0->v5->shape[1])))))) && (dz2081U_396638 == in1->v0->shape[0] && (dz2082U_396639 == in1->v1->shape[0] && (dz2083U_396640 == in1->v2->shape[0] && (dim_396635 == in1->v2->shape[1] && dz2083U_396640 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_intermSkyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_396635, dz2080U_396636, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_396637, dz2081U_396638, dz2082U_396639, dz2083U_396640, total_angle_no_396647, total_grid_no_396648, total_part_no_396649, include_angle_steps_396654, omit_step_396655, max_steps_396656, sizze_thresh_396657);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_396638;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_396635;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_intermSkyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const bool in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t dim_560381 = (int64_t) 0;
    int64_t dz2080U_560382 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383 = (int64_t) 0;
    int64_t dz2081U_560384 = (int64_t) 0;
    int64_t dz2082U_560385 = (int64_t) 0;
    int64_t dz2083U_560386 = (int64_t) 0;
    int64_t total_angle_no_560393 = (int64_t) 0;
    int64_t total_grid_no_560394 = (int64_t) 0;
    int64_t total_part_no_560395 = (int64_t) 0;
    bool include_angle_steps_560400 = 0;
    int64_t omit_step_560401 = (int64_t) 0;
    int64_t max_steps_560402 = (int64_t) 0;
    int64_t sizze_thresh_560403 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_560381 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_560381 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_560381 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_560382 = in0->v5->shape[0];
    dim_560381 = in0->v5->shape[1];
    total_angle_no_560393 = in0->v6;
    total_grid_no_560394 = in0->v7;
    total_part_no_560395 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_560384 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_560385 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_560386 = in1->v2->shape[0];
    dim_560381 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_560386 = in1->v3->shape[0];
    include_angle_steps_560400 = in2;
    omit_step_560401 = in3;
    max_steps_560402 = in4;
    sizze_thresh_560403 = in5;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383 == in0->v1->shape[0] && (dim_560381 == in0->v2->shape[0] && (dim_560381 == in0->v3->shape[0] && (dim_560381 == in0->v4->shape[0] && (dz2080U_560382 == in0->v5->shape[0] && dim_560381 == in0->v5->shape[1])))))) && (dz2081U_560384 == in1->v0->shape[0] && (dz2082U_560385 == in1->v1->shape[0] && (dz2083U_560386 == in1->v2->shape[0] && (dim_560381 == in1->v2->shape[1] && dz2083U_560386 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_intermSkyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_560381, dz2080U_560382, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_560383, dz2081U_560384, dz2082U_560385, dz2083U_560386, total_angle_no_560393, total_grid_no_560394, total_part_no_560395, include_angle_steps_560400, omit_step_560401, max_steps_560402, sizze_thresh_560403);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_560384;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_560381;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_local_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1)
{
    int64_t dim_302009 = (int64_t) 0;
    int64_t dz2080U_302010 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011 = (int64_t) 0;
    int64_t dz2081U_302012 = (int64_t) 0;
    int64_t dz2082U_302013 = (int64_t) 0;
    int64_t dz2083U_302014 = (int64_t) 0;
    int64_t total_angle_no_302021 = (int64_t) 0;
    int64_t total_grid_no_302022 = (int64_t) 0;
    int64_t total_part_no_302023 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_302009 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_302009 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_302009 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_302010 = in0->v5->shape[0];
    dim_302009 = in0->v5->shape[1];
    total_angle_no_302021 = in0->v6;
    total_grid_no_302022 = in0->v7;
    total_part_no_302023 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_302012 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_302013 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_302014 = in1->v2->shape[0];
    dim_302009 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_302014 = in1->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011 == in0->v1->shape[0] && (dim_302009 == in0->v2->shape[0] && (dim_302009 == in0->v3->shape[0] && (dim_302009 == in0->v4->shape[0] && (dz2080U_302010 == in0->v5->shape[0] && dim_302009 == in0->v5->shape[1])))))) && (dz2081U_302012 == in1->v0->shape[0] && (dz2082U_302013 == in1->v1->shape[0] && (dz2083U_302014 == in1->v2->shape[0] && (dim_302009 == in1->v2->shape[1] && dz2083U_302014 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_local_Skyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_302009, dz2080U_302010, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_302011, dz2081U_302012, dz2082U_302013, dz2083U_302014, total_angle_no_302021, total_grid_no_302022, total_part_no_302023);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_302012;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_302009;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_local_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1)
{
    int64_t dim_466278 = (int64_t) 0;
    int64_t dz2080U_466279 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280 = (int64_t) 0;
    int64_t dz2081U_466281 = (int64_t) 0;
    int64_t dz2082U_466282 = (int64_t) 0;
    int64_t dz2083U_466283 = (int64_t) 0;
    int64_t total_angle_no_466290 = (int64_t) 0;
    int64_t total_grid_no_466291 = (int64_t) 0;
    int64_t total_part_no_466292 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_466278 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_466278 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_466278 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_466279 = in0->v5->shape[0];
    dim_466278 = in0->v5->shape[1];
    total_angle_no_466290 = in0->v6;
    total_grid_no_466291 = in0->v7;
    total_part_no_466292 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_466281 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dz2082U_466282 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_466283 = in1->v2->shape[0];
    dim_466278 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_466283 = in1->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280 == in0->v1->shape[0] && (dim_466278 == in0->v2->shape[0] && (dim_466278 == in0->v3->shape[0] && (dim_466278 == in0->v4->shape[0] && (dz2080U_466279 == in0->v5->shape[0] && dim_466278 == in0->v5->shape[1])))))) && (dz2081U_466281 == in1->v0->shape[0] && (dz2082U_466282 == in1->v1->shape[0] && (dz2083U_466283 == in1->v2->shape[0] && (dim_466278 == in1->v2->shape[1] && dz2083U_466283 == in1->v3->shape[0])))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_local_Skyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, dim_466278, dz2080U_466279, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_466280, dz2081U_466281, dz2082U_466282, dz2083U_466283, total_angle_no_466290, total_grid_no_466291, total_part_no_466292);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_466281;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588011;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588012;
            (*out0)->v2->shape[1] = dim_466278;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588012;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_crack_Skyline_double_GFUR(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_double **out0, const struct futhark_opaque_skylineInfo_GFUR_double *in0)
{
    int64_t dim_396692 = (int64_t) 0;
    int64_t dz2081U_396693 = (int64_t) 0;
    int64_t dz2082U_396694 = (int64_t) 0;
    int64_t dz2083U_396695 = (int64_t) 0;
    int64_t prim_out_588009 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586414;
    
    xys_mem_586414.references = NULL;
    
    struct memblock xys_mem_586413;
    
    xys_mem_586413.references = NULL;
    
    struct memblock part_idx_mem_586412;
    
    part_idx_mem_586412.references = NULL;
    
    struct memblock isPartitionDominated_mem_586411;
    
    isPartitionDominated_mem_586411.references = NULL;
    isPartitionDominated_mem_586411 = in0->v0->mem;
    dz2081U_396693 = in0->v0->shape[0];
    part_idx_mem_586412 = in0->v1->mem;
    dz2082U_396694 = in0->v1->shape[0];
    xys_mem_586413 = in0->v2->mem;
    dz2083U_396695 = in0->v2->shape[0];
    dim_396692 = in0->v2->shape[1];
    xys_mem_586414 = in0->v3->mem;
    dz2083U_396695 = in0->v3->shape[0];
    if (!(dz2081U_396693 == in0->v0->shape[0] && (dz2082U_396694 == in0->v1->shape[0] && (dz2083U_396695 == in0->v2->shape[0] && (dim_396692 == in0->v2->shape[1] && dz2083U_396695 == in0->v3->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_crack_Skyline_double_GFUR(ctx, &mem_out_588007, &mem_out_588008, &prim_out_588009, isPartitionDominated_mem_586411, part_idx_mem_586412, xys_mem_586413, xys_mem_586414, dim_396692, dz2081U_396693, dz2082U_396694, dz2083U_396695);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineData_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineData_GFUR_double))) != NULL);
            (*out0)->v0 = prim_out_588009;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588007;
            (*out0)->v1->shape[0] = dz2083U_396695;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588008;
            (*out0)->v2->shape[0] = dz2083U_396695;
            (*out0)->v2->shape[1] = dim_396692;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_crack_Skyline_float_GFUR(struct futhark_context *ctx, struct futhark_opaque_skylineData_GFUR_float **out0, const struct futhark_opaque_skylineInfo_GFUR_float *in0)
{
    int64_t dim_560438 = (int64_t) 0;
    int64_t dz2081U_560439 = (int64_t) 0;
    int64_t dz2082U_560440 = (int64_t) 0;
    int64_t dz2083U_560441 = (int64_t) 0;
    int64_t prim_out_588009 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586414;
    
    xys_mem_586414.references = NULL;
    
    struct memblock xys_mem_586413;
    
    xys_mem_586413.references = NULL;
    
    struct memblock part_idx_mem_586412;
    
    part_idx_mem_586412.references = NULL;
    
    struct memblock isPartitionDominated_mem_586411;
    
    isPartitionDominated_mem_586411.references = NULL;
    isPartitionDominated_mem_586411 = in0->v0->mem;
    dz2081U_560439 = in0->v0->shape[0];
    part_idx_mem_586412 = in0->v1->mem;
    dz2082U_560440 = in0->v1->shape[0];
    xys_mem_586413 = in0->v2->mem;
    dz2083U_560441 = in0->v2->shape[0];
    dim_560438 = in0->v2->shape[1];
    xys_mem_586414 = in0->v3->mem;
    dz2083U_560441 = in0->v3->shape[0];
    if (!(dz2081U_560439 == in0->v0->shape[0] && (dz2082U_560440 == in0->v1->shape[0] && (dz2083U_560441 == in0->v2->shape[0] && (dim_560438 == in0->v2->shape[1] && dz2083U_560441 == in0->v3->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_crack_Skyline_float_GFUR(ctx, &mem_out_588007, &mem_out_588008, &prim_out_588009, isPartitionDominated_mem_586411, part_idx_mem_586412, xys_mem_586413, xys_mem_586414, dim_560438, dz2081U_560439, dz2082U_560440, dz2083U_560441);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineData_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineData_GFUR_float))) != NULL);
            (*out0)->v0 = prim_out_588009;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588007;
            (*out0)->v1->shape[0] = dz2083U_560441;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588008;
            (*out0)->v2->shape[0] = dz2083U_560441;
            (*out0)->v2->shape[1] = dim_560438;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_define_skyline_space_double(struct futhark_context *ctx, struct futhark_opaque_skylineBase_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t dim_233135 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int64_t prim_out_588014 = (int64_t) 0;
    int64_t prim_out_588015 = (int64_t) 0;
    int64_t prim_out_588016 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588012;
    
    mem_out_588012.references = NULL;
    
    struct memblock mem_out_588011;
    
    mem_out_588011.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586414;
    
    angle_partitions_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586413;
    
    grid_partitions_per_dim_mem_586413.references = NULL;
    
    struct memblock max_per_dim_mem_586412;
    
    max_per_dim_mem_586412.references = NULL;
    
    struct memblock min_per_dim_mem_586411;
    
    min_per_dim_mem_586411.references = NULL;
    min_per_dim_mem_586411 = in0->mem;
    dim_233135 = in0->shape[0];
    max_per_dim_mem_586412 = in1->mem;
    dim_233135 = in1->shape[0];
    grid_partitions_per_dim_mem_586413 = in2->mem;
    dim_233135 = in2->shape[0];
    angle_partitions_per_dim_mem_586414 = in3->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136 = in3->shape[0];
    if (!(dim_233135 == in0->shape[0] && (dim_233135 == in1->shape[0] && (dim_233135 == in2->shape[0] && dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_define_skyline_space_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &mem_out_588011, &mem_out_588012, &prim_out_588013, &prim_out_588014, &prim_out_588015, &prim_out_588016, min_per_dim_mem_586411, max_per_dim_mem_586412, grid_partitions_per_dim_mem_586413, angle_partitions_per_dim_mem_586414, dim_233135, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineBase_double *) malloc(sizeof(struct futhark_opaque_skylineBase_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_233136;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = dim_233135;
            assert(((*out0)->v3 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = dim_233135;
            assert(((*out0)->v4 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v4->mem = mem_out_588011;
            (*out0)->v4->shape[0] = dim_233135;
            assert(((*out0)->v5 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v5->mem = mem_out_588012;
            (*out0)->v5->shape[0] = prim_out_588013;
            (*out0)->v5->shape[1] = dim_233135;
            (*out0)->v6 = prim_out_588014;
            (*out0)->v7 = prim_out_588015;
            (*out0)->v8 = prim_out_588016;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_define_skyline_space_float(struct futhark_context *ctx, struct futhark_opaque_skylineBase_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t dim_397793 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int64_t prim_out_588014 = (int64_t) 0;
    int64_t prim_out_588015 = (int64_t) 0;
    int64_t prim_out_588016 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588012;
    
    mem_out_588012.references = NULL;
    
    struct memblock mem_out_588011;
    
    mem_out_588011.references = NULL;
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586414;
    
    angle_partitions_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586413;
    
    grid_partitions_per_dim_mem_586413.references = NULL;
    
    struct memblock max_per_dim_mem_586412;
    
    max_per_dim_mem_586412.references = NULL;
    
    struct memblock min_per_dim_mem_586411;
    
    min_per_dim_mem_586411.references = NULL;
    min_per_dim_mem_586411 = in0->mem;
    dim_397793 = in0->shape[0];
    max_per_dim_mem_586412 = in1->mem;
    dim_397793 = in1->shape[0];
    grid_partitions_per_dim_mem_586413 = in2->mem;
    dim_397793 = in2->shape[0];
    angle_partitions_per_dim_mem_586414 = in3->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794 = in3->shape[0];
    if (!(dim_397793 == in0->shape[0] && (dim_397793 == in1->shape[0] && (dim_397793 == in2->shape[0] && dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_define_skyline_space_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &mem_out_588011, &mem_out_588012, &prim_out_588013, &prim_out_588014, &prim_out_588015, &prim_out_588016, min_per_dim_mem_586411, max_per_dim_mem_586412, grid_partitions_per_dim_mem_586413, angle_partitions_per_dim_mem_586414, dim_397793, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineBase_float *) malloc(sizeof(struct futhark_opaque_skylineBase_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUZLzmZRz20Udimz20U1z7dUzg_397794;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = dim_397793;
            assert(((*out0)->v3 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = dim_397793;
            assert(((*out0)->v4 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v4->mem = mem_out_588011;
            (*out0)->v4->shape[0] = dim_397793;
            assert(((*out0)->v5 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v5->mem = mem_out_588012;
            (*out0)->v5->shape[0] = prim_out_588013;
            (*out0)->v5->shape[1] = dim_397793;
            (*out0)->v6 = prim_out_588014;
            (*out0)->v7 = prim_out_588015;
            (*out0)->v8 = prim_out_588016;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_2_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2)
{
    int64_t dim_386746 = (int64_t) 0;
    int64_t dz2080U_386747 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748 = (int64_t) 0;
    int64_t dz2083U_386749 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_386750 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_386751 = (int64_t) 0;
    int64_t dz2083U_386752 = (int64_t) 0;
    int64_t total_angle_no_386759 = (int64_t) 0;
    int64_t total_grid_no_386760 = (int64_t) 0;
    int64_t total_part_no_386761 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_386746 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_386746 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_386746 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_386747 = in0->v5->shape[0];
    dim_386746 = in0->v5->shape[1];
    total_angle_no_386759 = in0->v6;
    total_grid_no_386760 = in0->v7;
    total_part_no_386761 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_386750 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_386751 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_386749 = in1->v2->shape[0];
    dim_386746 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_386749 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_386750 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_386751 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_386752 = in2->v2->shape[0];
    dim_386746 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_386752 = in2->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748 == in0->v1->shape[0] && (dim_386746 == in0->v2->shape[0] && (dim_386746 == in0->v3->shape[0] && (dim_386746 == in0->v4->shape[0] && (dz2080U_386747 == in0->v5->shape[0] && dim_386746 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_386750 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_386751 == in1->v1->shape[0] && (dz2083U_386749 == in1->v2->shape[0] && (dim_386746 == in1->v2->shape[1] && dz2083U_386749 == in1->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_386750 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_386751 == in2->v1->shape[0] && (dz2083U_386752 == in2->v2->shape[0] && (dim_386746 == in2->v2->shape[1] && dz2083U_386752 == in2->v3->shape[0]))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_2_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, dim_386746, dz2080U_386747, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_386748, dz2083U_386749, dzlz7bUskBzitotal_grid_noz7dUzg_386750, dzlz7bUskBzitotal_part_noz7dUzg_386751, dz2083U_386752, total_angle_no_386759, total_grid_no_386760, total_part_no_386761);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_386750;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_386751;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_386746;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_2_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2)
{
    int64_t dim_550531 = (int64_t) 0;
    int64_t dz2080U_550532 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533 = (int64_t) 0;
    int64_t dz2083U_550534 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_550535 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_550536 = (int64_t) 0;
    int64_t dz2083U_550537 = (int64_t) 0;
    int64_t total_angle_no_550544 = (int64_t) 0;
    int64_t total_grid_no_550545 = (int64_t) 0;
    int64_t total_part_no_550546 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_550531 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_550531 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_550531 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_550532 = in0->v5->shape[0];
    dim_550531 = in0->v5->shape[1];
    total_angle_no_550544 = in0->v6;
    total_grid_no_550545 = in0->v7;
    total_part_no_550546 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_550535 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_550536 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_550534 = in1->v2->shape[0];
    dim_550531 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_550534 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_550535 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_550536 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_550537 = in2->v2->shape[0];
    dim_550531 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_550537 = in2->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533 == in0->v1->shape[0] && (dim_550531 == in0->v2->shape[0] && (dim_550531 == in0->v3->shape[0] && (dim_550531 == in0->v4->shape[0] && (dz2080U_550532 == in0->v5->shape[0] && dim_550531 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_550535 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_550536 == in1->v1->shape[0] && (dz2083U_550534 == in1->v2->shape[0] && (dim_550531 == in1->v2->shape[1] && dz2083U_550534 == in1->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_550535 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_550536 == in2->v1->shape[0] && (dz2083U_550537 == in2->v2->shape[0] && (dim_550531 == in2->v2->shape[1] && dz2083U_550537 == in2->v3->shape[0]))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_2_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, dim_550531, dz2080U_550532, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_550533, dz2083U_550534, dzlz7bUskBzitotal_grid_noz7dUzg_550535, dzlz7bUskBzitotal_part_noz7dUzg_550536, dz2083U_550537, total_angle_no_550544, total_grid_no_550545, total_part_no_550546);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_550535;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_550536;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_550531;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_3_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3)
{
    int64_t dim_366050 = (int64_t) 0;
    int64_t dz2080U_366051 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052 = (int64_t) 0;
    int64_t dz2083U_366053 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_366054 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_366055 = (int64_t) 0;
    int64_t dz2083U_366056 = (int64_t) 0;
    int64_t dz2083U_366057 = (int64_t) 0;
    int64_t total_angle_no_366064 = (int64_t) 0;
    int64_t total_grid_no_366065 = (int64_t) 0;
    int64_t total_part_no_366066 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_366050 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_366050 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_366050 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_366051 = in0->v5->shape[0];
    dim_366050 = in0->v5->shape[1];
    total_angle_no_366064 = in0->v6;
    total_grid_no_366065 = in0->v7;
    total_part_no_366066 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_366054 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_366055 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_366053 = in1->v2->shape[0];
    dim_366050 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_366053 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_366054 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_366055 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_366056 = in2->v2->shape[0];
    dim_366050 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_366056 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_366054 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_366055 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_366057 = in3->v2->shape[0];
    dim_366050 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_366057 = in3->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052 == in0->v1->shape[0] && (dim_366050 == in0->v2->shape[0] && (dim_366050 == in0->v3->shape[0] && (dim_366050 == in0->v4->shape[0] && (dz2080U_366051 == in0->v5->shape[0] && dim_366050 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_366054 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_366055 == in1->v1->shape[0] && (dz2083U_366053 == in1->v2->shape[0] && (dim_366050 == in1->v2->shape[1] && dz2083U_366053 == in1->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_366054 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_366055 == in2->v1->shape[0] && (dz2083U_366056 == in2->v2->shape[0] && (dim_366050 == in2->v2->shape[1] && dz2083U_366056 == in2->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_366054 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_366055 == in3->v1->shape[0] && (dz2083U_366057 == in3->v2->shape[0] && (dim_366050 == in3->v2->shape[1] && dz2083U_366057 == in3->v3->shape[0])))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_3_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, dim_366050, dz2080U_366051, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_366052, dz2083U_366053, dzlz7bUskBzitotal_grid_noz7dUzg_366054, dzlz7bUskBzitotal_part_noz7dUzg_366055, dz2083U_366056, dz2083U_366057, total_angle_no_366064, total_grid_no_366065, total_part_no_366066);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_366054;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_366055;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_366050;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_3_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3)
{
    int64_t dim_529835 = (int64_t) 0;
    int64_t dz2080U_529836 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837 = (int64_t) 0;
    int64_t dz2083U_529838 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_529839 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_529840 = (int64_t) 0;
    int64_t dz2083U_529841 = (int64_t) 0;
    int64_t dz2083U_529842 = (int64_t) 0;
    int64_t total_angle_no_529849 = (int64_t) 0;
    int64_t total_grid_no_529850 = (int64_t) 0;
    int64_t total_part_no_529851 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_529835 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_529835 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_529835 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_529836 = in0->v5->shape[0];
    dim_529835 = in0->v5->shape[1];
    total_angle_no_529849 = in0->v6;
    total_grid_no_529850 = in0->v7;
    total_part_no_529851 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_529839 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_529840 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_529838 = in1->v2->shape[0];
    dim_529835 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_529838 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_529839 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_529840 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_529841 = in2->v2->shape[0];
    dim_529835 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_529841 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_529839 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_529840 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_529842 = in3->v2->shape[0];
    dim_529835 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_529842 = in3->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837 == in0->v1->shape[0] && (dim_529835 == in0->v2->shape[0] && (dim_529835 == in0->v3->shape[0] && (dim_529835 == in0->v4->shape[0] && (dz2080U_529836 == in0->v5->shape[0] && dim_529835 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_529839 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_529840 == in1->v1->shape[0] && (dz2083U_529838 == in1->v2->shape[0] && (dim_529835 == in1->v2->shape[1] && dz2083U_529838 == in1->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_529839 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_529840 == in2->v1->shape[0] && (dz2083U_529841 == in2->v2->shape[0] && (dim_529835 == in2->v2->shape[1] && dz2083U_529841 == in2->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_529839 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_529840 == in3->v1->shape[0] && (dz2083U_529842 == in3->v2->shape[0] && (dim_529835 == in3->v2->shape[1] && dz2083U_529842 == in3->v3->shape[0])))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_3_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, dim_529835, dz2080U_529836, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_529837, dz2083U_529838, dzlz7bUskBzitotal_grid_noz7dUzg_529839, dzlz7bUskBzitotal_part_noz7dUzg_529840, dz2083U_529841, dz2083U_529842, total_angle_no_529849, total_grid_no_529850, total_part_no_529851);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_529839;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_529840;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_529835;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_4_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3, const struct futhark_opaque_skylineInfo_GFUR_double *in4)
{
    int64_t dim_345683 = (int64_t) 0;
    int64_t dz2080U_345684 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685 = (int64_t) 0;
    int64_t dz2083U_345686 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_345687 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_345688 = (int64_t) 0;
    int64_t dz2083U_345689 = (int64_t) 0;
    int64_t dz2083U_345690 = (int64_t) 0;
    int64_t dz2083U_345691 = (int64_t) 0;
    int64_t total_angle_no_345698 = (int64_t) 0;
    int64_t total_grid_no_345699 = (int64_t) 0;
    int64_t total_part_no_345700 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586432;
    
    xys_mem_586432.references = NULL;
    
    struct memblock xys_mem_586431;
    
    xys_mem_586431.references = NULL;
    
    struct memblock part_idx_mem_586430;
    
    part_idx_mem_586430.references = NULL;
    
    struct memblock isPartitionDominated_mem_586429;
    
    isPartitionDominated_mem_586429.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_345683 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_345683 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_345683 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_345684 = in0->v5->shape[0];
    dim_345683 = in0->v5->shape[1];
    total_angle_no_345698 = in0->v6;
    total_grid_no_345699 = in0->v7;
    total_part_no_345700 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_345687 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_345688 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_345686 = in1->v2->shape[0];
    dim_345683 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_345686 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_345687 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_345688 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_345689 = in2->v2->shape[0];
    dim_345683 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_345689 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_345687 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_345688 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_345690 = in3->v2->shape[0];
    dim_345683 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_345690 = in3->v3->shape[0];
    isPartitionDominated_mem_586429 = in4->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_345687 = in4->v0->shape[0];
    part_idx_mem_586430 = in4->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_345688 = in4->v1->shape[0];
    xys_mem_586431 = in4->v2->mem;
    dz2083U_345691 = in4->v2->shape[0];
    dim_345683 = in4->v2->shape[1];
    xys_mem_586432 = in4->v3->mem;
    dz2083U_345691 = in4->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685 == in0->v1->shape[0] && (dim_345683 == in0->v2->shape[0] && (dim_345683 == in0->v3->shape[0] && (dim_345683 == in0->v4->shape[0] && (dz2080U_345684 == in0->v5->shape[0] && dim_345683 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_345687 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_345688 == in1->v1->shape[0] && (dz2083U_345686 == in1->v2->shape[0] && (dim_345683 == in1->v2->shape[1] && dz2083U_345686 == in1->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_345687 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_345688 == in2->v1->shape[0] && (dz2083U_345689 == in2->v2->shape[0] && (dim_345683 == in2->v2->shape[1] && dz2083U_345689 == in2->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_345687 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_345688 == in3->v1->shape[0] && (dz2083U_345690 == in3->v2->shape[0] && (dim_345683 == in3->v2->shape[1] && dz2083U_345690 == in3->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_345687 == in4->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_345688 == in4->v1->shape[0] && (dz2083U_345691 == in4->v2->shape[0] && (dim_345683 == in4->v2->shape[1] && dz2083U_345691 == in4->v3->shape[0]))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_4_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, isPartitionDominated_mem_586429, part_idx_mem_586430, xys_mem_586431, xys_mem_586432, dim_345683, dz2080U_345684, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_345685, dz2083U_345686, dzlz7bUskBzitotal_grid_noz7dUzg_345687, dzlz7bUskBzitotal_part_noz7dUzg_345688, dz2083U_345689, dz2083U_345690, dz2083U_345691, total_angle_no_345698, total_grid_no_345699, total_part_no_345700);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_345687;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_345688;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_345683;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_4_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3, const struct futhark_opaque_skylineInfo_GFUR_float *in4)
{
    int64_t dim_509468 = (int64_t) 0;
    int64_t dz2080U_509469 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470 = (int64_t) 0;
    int64_t dz2083U_509471 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_grid_noz7dUzg_509472 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_509473 = (int64_t) 0;
    int64_t dz2083U_509474 = (int64_t) 0;
    int64_t dz2083U_509475 = (int64_t) 0;
    int64_t dz2083U_509476 = (int64_t) 0;
    int64_t total_angle_no_509483 = (int64_t) 0;
    int64_t total_grid_no_509484 = (int64_t) 0;
    int64_t total_part_no_509485 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586432;
    
    xys_mem_586432.references = NULL;
    
    struct memblock xys_mem_586431;
    
    xys_mem_586431.references = NULL;
    
    struct memblock part_idx_mem_586430;
    
    part_idx_mem_586430.references = NULL;
    
    struct memblock isPartitionDominated_mem_586429;
    
    isPartitionDominated_mem_586429.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_509468 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_509468 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_509468 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_509469 = in0->v5->shape[0];
    dim_509468 = in0->v5->shape[1];
    total_angle_no_509483 = in0->v6;
    total_grid_no_509484 = in0->v7;
    total_part_no_509485 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_509472 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_509473 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_509471 = in1->v2->shape[0];
    dim_509468 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_509471 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_509472 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_509473 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_509474 = in2->v2->shape[0];
    dim_509468 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_509474 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_509472 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_509473 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_509475 = in3->v2->shape[0];
    dim_509468 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_509475 = in3->v3->shape[0];
    isPartitionDominated_mem_586429 = in4->v0->mem;
    dzlz7bUskBzitotal_grid_noz7dUzg_509472 = in4->v0->shape[0];
    part_idx_mem_586430 = in4->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_509473 = in4->v1->shape[0];
    xys_mem_586431 = in4->v2->mem;
    dz2083U_509476 = in4->v2->shape[0];
    dim_509468 = in4->v2->shape[1];
    xys_mem_586432 = in4->v3->mem;
    dz2083U_509476 = in4->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470 == in0->v1->shape[0] && (dim_509468 == in0->v2->shape[0] && (dim_509468 == in0->v3->shape[0] && (dim_509468 == in0->v4->shape[0] && (dz2080U_509469 == in0->v5->shape[0] && dim_509468 == in0->v5->shape[1])))))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_509472 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_509473 == in1->v1->shape[0] && (dz2083U_509471 == in1->v2->shape[0] && (dim_509468 == in1->v2->shape[1] && dz2083U_509471 == in1->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_509472 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_509473 == in2->v1->shape[0] && (dz2083U_509474 == in2->v2->shape[0] && (dim_509468 == in2->v2->shape[1] && dz2083U_509474 == in2->v3->shape[0])))) && ((dzlz7bUskBzitotal_grid_noz7dUzg_509472 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_509473 == in3->v1->shape[0] && (dz2083U_509475 == in3->v2->shape[0] && (dim_509468 == in3->v2->shape[1] && dz2083U_509475 == in3->v3->shape[0])))) && (dzlz7bUskBzitotal_grid_noz7dUzg_509472 == in4->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_509473 == in4->v1->shape[0] && (dz2083U_509476 == in4->v2->shape[0] && (dim_509468 == in4->v2->shape[1] && dz2083U_509476 == in4->v3->shape[0]))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_4_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, isPartitionDominated_mem_586429, part_idx_mem_586430, xys_mem_586431, xys_mem_586432, dim_509468, dz2080U_509469, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_509470, dz2083U_509471, dzlz7bUskBzitotal_grid_noz7dUzg_509472, dzlz7bUskBzitotal_part_noz7dUzg_509473, dz2083U_509474, dz2083U_509475, dz2083U_509476, total_angle_no_509483, total_grid_no_509484, total_part_no_509485);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dzlz7bUskBzitotal_grid_noz7dUzg_509472;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_509473;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_509468;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_5_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineInfo_GFUR_double *in1, const struct futhark_opaque_skylineInfo_GFUR_double *in2, const struct futhark_opaque_skylineInfo_GFUR_double *in3, const struct futhark_opaque_skylineInfo_GFUR_double *in4, const struct futhark_opaque_skylineInfo_GFUR_double *in5)
{
    int64_t dim_325730 = (int64_t) 0;
    int64_t dz2080U_325731 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732 = (int64_t) 0;
    int64_t dz2083U_325733 = (int64_t) 0;
    int64_t dz2081U_325734 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_325735 = (int64_t) 0;
    int64_t dz2083U_325736 = (int64_t) 0;
    int64_t dz2083U_325737 = (int64_t) 0;
    int64_t dz2083U_325738 = (int64_t) 0;
    int64_t dz2083U_325739 = (int64_t) 0;
    int64_t total_angle_no_325746 = (int64_t) 0;
    int64_t total_grid_no_325747 = (int64_t) 0;
    int64_t total_part_no_325748 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586436;
    
    xys_mem_586436.references = NULL;
    
    struct memblock xys_mem_586435;
    
    xys_mem_586435.references = NULL;
    
    struct memblock part_idx_mem_586434;
    
    part_idx_mem_586434.references = NULL;
    
    struct memblock isPartitionDominated_mem_586433;
    
    isPartitionDominated_mem_586433.references = NULL;
    
    struct memblock xys_mem_586432;
    
    xys_mem_586432.references = NULL;
    
    struct memblock xys_mem_586431;
    
    xys_mem_586431.references = NULL;
    
    struct memblock part_idx_mem_586430;
    
    part_idx_mem_586430.references = NULL;
    
    struct memblock isPartitionDominated_mem_586429;
    
    isPartitionDominated_mem_586429.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_325730 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_325730 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_325730 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_325731 = in0->v5->shape[0];
    dim_325730 = in0->v5->shape[1];
    total_angle_no_325746 = in0->v6;
    total_grid_no_325747 = in0->v7;
    total_part_no_325748 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_325734 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_325735 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_325733 = in1->v2->shape[0];
    dim_325730 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_325733 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dz2081U_325734 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_325735 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_325736 = in2->v2->shape[0];
    dim_325730 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_325736 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dz2081U_325734 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_325735 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_325737 = in3->v2->shape[0];
    dim_325730 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_325737 = in3->v3->shape[0];
    isPartitionDominated_mem_586429 = in4->v0->mem;
    dz2081U_325734 = in4->v0->shape[0];
    part_idx_mem_586430 = in4->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_325735 = in4->v1->shape[0];
    xys_mem_586431 = in4->v2->mem;
    dz2083U_325738 = in4->v2->shape[0];
    dim_325730 = in4->v2->shape[1];
    xys_mem_586432 = in4->v3->mem;
    dz2083U_325738 = in4->v3->shape[0];
    isPartitionDominated_mem_586433 = in5->v0->mem;
    dz2081U_325734 = in5->v0->shape[0];
    part_idx_mem_586434 = in5->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_325735 = in5->v1->shape[0];
    xys_mem_586435 = in5->v2->mem;
    dz2083U_325739 = in5->v2->shape[0];
    dim_325730 = in5->v2->shape[1];
    xys_mem_586436 = in5->v3->mem;
    dz2083U_325739 = in5->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732 == in0->v1->shape[0] && (dim_325730 == in0->v2->shape[0] && (dim_325730 == in0->v3->shape[0] && (dim_325730 == in0->v4->shape[0] && (dz2080U_325731 == in0->v5->shape[0] && dim_325730 == in0->v5->shape[1])))))) && ((dz2081U_325734 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_325735 == in1->v1->shape[0] && (dz2083U_325733 == in1->v2->shape[0] && (dim_325730 == in1->v2->shape[1] && dz2083U_325733 == in1->v3->shape[0])))) && ((dz2081U_325734 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_325735 == in2->v1->shape[0] && (dz2083U_325736 == in2->v2->shape[0] && (dim_325730 == in2->v2->shape[1] && dz2083U_325736 == in2->v3->shape[0])))) && ((dz2081U_325734 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_325735 == in3->v1->shape[0] && (dz2083U_325737 == in3->v2->shape[0] && (dim_325730 == in3->v2->shape[1] && dz2083U_325737 == in3->v3->shape[0])))) && ((dz2081U_325734 == in4->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_325735 == in4->v1->shape[0] && (dz2083U_325738 == in4->v2->shape[0] && (dim_325730 == in4->v2->shape[1] && dz2083U_325738 == in4->v3->shape[0])))) && (dz2081U_325734 == in5->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_325735 == in5->v1->shape[0] && (dz2083U_325739 == in5->v2->shape[0] && (dim_325730 == in5->v2->shape[1] && dz2083U_325739 == in5->v3->shape[0])))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_5_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, isPartitionDominated_mem_586429, part_idx_mem_586430, xys_mem_586431, xys_mem_586432, isPartitionDominated_mem_586433, part_idx_mem_586434, xys_mem_586435, xys_mem_586436, dim_325730, dz2080U_325731, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_325732, dz2083U_325733, dz2081U_325734, dzlz7bUskBzitotal_part_noz7dUzg_325735, dz2083U_325736, dz2083U_325737, dz2083U_325738, dz2083U_325739, total_angle_no_325746, total_grid_no_325747, total_part_no_325748);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_325734;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_325735;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_325730;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_merge_Skylines_5_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineInfo_GFUR_float *in1, const struct futhark_opaque_skylineInfo_GFUR_float *in2, const struct futhark_opaque_skylineInfo_GFUR_float *in3, const struct futhark_opaque_skylineInfo_GFUR_float *in4, const struct futhark_opaque_skylineInfo_GFUR_float *in5)
{
    int64_t dim_489515 = (int64_t) 0;
    int64_t dz2080U_489516 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517 = (int64_t) 0;
    int64_t dz2083U_489518 = (int64_t) 0;
    int64_t dz2081U_489519 = (int64_t) 0;
    int64_t dzlz7bUskBzitotal_part_noz7dUzg_489520 = (int64_t) 0;
    int64_t dz2083U_489521 = (int64_t) 0;
    int64_t dz2083U_489522 = (int64_t) 0;
    int64_t dz2083U_489523 = (int64_t) 0;
    int64_t dz2083U_489524 = (int64_t) 0;
    int64_t total_angle_no_489531 = (int64_t) 0;
    int64_t total_grid_no_489532 = (int64_t) 0;
    int64_t total_part_no_489533 = (int64_t) 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xys_mem_586436;
    
    xys_mem_586436.references = NULL;
    
    struct memblock xys_mem_586435;
    
    xys_mem_586435.references = NULL;
    
    struct memblock part_idx_mem_586434;
    
    part_idx_mem_586434.references = NULL;
    
    struct memblock isPartitionDominated_mem_586433;
    
    isPartitionDominated_mem_586433.references = NULL;
    
    struct memblock xys_mem_586432;
    
    xys_mem_586432.references = NULL;
    
    struct memblock xys_mem_586431;
    
    xys_mem_586431.references = NULL;
    
    struct memblock part_idx_mem_586430;
    
    part_idx_mem_586430.references = NULL;
    
    struct memblock isPartitionDominated_mem_586429;
    
    isPartitionDominated_mem_586429.references = NULL;
    
    struct memblock xys_mem_586428;
    
    xys_mem_586428.references = NULL;
    
    struct memblock xys_mem_586427;
    
    xys_mem_586427.references = NULL;
    
    struct memblock part_idx_mem_586426;
    
    part_idx_mem_586426.references = NULL;
    
    struct memblock isPartitionDominated_mem_586425;
    
    isPartitionDominated_mem_586425.references = NULL;
    
    struct memblock xys_mem_586424;
    
    xys_mem_586424.references = NULL;
    
    struct memblock xys_mem_586423;
    
    xys_mem_586423.references = NULL;
    
    struct memblock part_idx_mem_586422;
    
    part_idx_mem_586422.references = NULL;
    
    struct memblock isPartitionDominated_mem_586421;
    
    isPartitionDominated_mem_586421.references = NULL;
    
    struct memblock xys_mem_586420;
    
    xys_mem_586420.references = NULL;
    
    struct memblock xys_mem_586419;
    
    xys_mem_586419.references = NULL;
    
    struct memblock part_idx_mem_586418;
    
    part_idx_mem_586418.references = NULL;
    
    struct memblock isPartitionDominated_mem_586417;
    
    isPartitionDominated_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_489515 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_489515 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_489515 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_489516 = in0->v5->shape[0];
    dim_489515 = in0->v5->shape[1];
    total_angle_no_489531 = in0->v6;
    total_grid_no_489532 = in0->v7;
    total_part_no_489533 = in0->v8;
    isPartitionDominated_mem_586417 = in1->v0->mem;
    dz2081U_489519 = in1->v0->shape[0];
    part_idx_mem_586418 = in1->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_489520 = in1->v1->shape[0];
    xys_mem_586419 = in1->v2->mem;
    dz2083U_489518 = in1->v2->shape[0];
    dim_489515 = in1->v2->shape[1];
    xys_mem_586420 = in1->v3->mem;
    dz2083U_489518 = in1->v3->shape[0];
    isPartitionDominated_mem_586421 = in2->v0->mem;
    dz2081U_489519 = in2->v0->shape[0];
    part_idx_mem_586422 = in2->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_489520 = in2->v1->shape[0];
    xys_mem_586423 = in2->v2->mem;
    dz2083U_489521 = in2->v2->shape[0];
    dim_489515 = in2->v2->shape[1];
    xys_mem_586424 = in2->v3->mem;
    dz2083U_489521 = in2->v3->shape[0];
    isPartitionDominated_mem_586425 = in3->v0->mem;
    dz2081U_489519 = in3->v0->shape[0];
    part_idx_mem_586426 = in3->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_489520 = in3->v1->shape[0];
    xys_mem_586427 = in3->v2->mem;
    dz2083U_489522 = in3->v2->shape[0];
    dim_489515 = in3->v2->shape[1];
    xys_mem_586428 = in3->v3->mem;
    dz2083U_489522 = in3->v3->shape[0];
    isPartitionDominated_mem_586429 = in4->v0->mem;
    dz2081U_489519 = in4->v0->shape[0];
    part_idx_mem_586430 = in4->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_489520 = in4->v1->shape[0];
    xys_mem_586431 = in4->v2->mem;
    dz2083U_489523 = in4->v2->shape[0];
    dim_489515 = in4->v2->shape[1];
    xys_mem_586432 = in4->v3->mem;
    dz2083U_489523 = in4->v3->shape[0];
    isPartitionDominated_mem_586433 = in5->v0->mem;
    dz2081U_489519 = in5->v0->shape[0];
    part_idx_mem_586434 = in5->v1->mem;
    dzlz7bUskBzitotal_part_noz7dUzg_489520 = in5->v1->shape[0];
    xys_mem_586435 = in5->v2->mem;
    dz2083U_489524 = in5->v2->shape[0];
    dim_489515 = in5->v2->shape[1];
    xys_mem_586436 = in5->v3->mem;
    dz2083U_489524 = in5->v3->shape[0];
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517 == in0->v1->shape[0] && (dim_489515 == in0->v2->shape[0] && (dim_489515 == in0->v3->shape[0] && (dim_489515 == in0->v4->shape[0] && (dz2080U_489516 == in0->v5->shape[0] && dim_489515 == in0->v5->shape[1])))))) && ((dz2081U_489519 == in1->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_489520 == in1->v1->shape[0] && (dz2083U_489518 == in1->v2->shape[0] && (dim_489515 == in1->v2->shape[1] && dz2083U_489518 == in1->v3->shape[0])))) && ((dz2081U_489519 == in2->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_489520 == in2->v1->shape[0] && (dz2083U_489521 == in2->v2->shape[0] && (dim_489515 == in2->v2->shape[1] && dz2083U_489521 == in2->v3->shape[0])))) && ((dz2081U_489519 == in3->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_489520 == in3->v1->shape[0] && (dz2083U_489522 == in3->v2->shape[0] && (dim_489515 == in3->v2->shape[1] && dz2083U_489522 == in3->v3->shape[0])))) && ((dz2081U_489519 == in4->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_489520 == in4->v1->shape[0] && (dz2083U_489523 == in4->v2->shape[0] && (dim_489515 == in4->v2->shape[1] && dz2083U_489523 == in4->v3->shape[0])))) && (dz2081U_489519 == in5->v0->shape[0] && (dzlz7bUskBzitotal_part_noz7dUzg_489520 == in5->v1->shape[0] && (dz2083U_489524 == in5->v2->shape[0] && (dim_489515 == in5->v2->shape[1] && dz2083U_489524 == in5->v3->shape[0])))))))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_merge_Skylines_5_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, isPartitionDominated_mem_586417, part_idx_mem_586418, xys_mem_586419, xys_mem_586420, isPartitionDominated_mem_586421, part_idx_mem_586422, xys_mem_586423, xys_mem_586424, isPartitionDominated_mem_586425, part_idx_mem_586426, xys_mem_586427, xys_mem_586428, isPartitionDominated_mem_586429, part_idx_mem_586430, xys_mem_586431, xys_mem_586432, isPartitionDominated_mem_586433, part_idx_mem_586434, xys_mem_586435, xys_mem_586436, dim_489515, dz2080U_489516, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_489517, dz2083U_489518, dz2081U_489519, dzlz7bUskBzitotal_part_noz7dUzg_489520, dz2083U_489521, dz2083U_489522, dz2083U_489523, dz2083U_489524, total_angle_no_489531, total_grid_no_489532, total_part_no_489533);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = dz2081U_489519;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = dzlz7bUskBzitotal_part_noz7dUzg_489520;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588011;
            (*out0)->v2->shape[1] = dim_489515;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588011;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_opaque_skylineBase_double *in1, const struct futhark_f64_2d *in2, const int64_t in3, const bool in4)
{
    int64_t dim_274571 = (int64_t) 0;
    int64_t dz2080U_274572 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 = (int64_t) 0;
    int64_t dz2080U_274574 = (int64_t) 0;
    int64_t n_274575 = (int64_t) 0;
    int64_t total_angle_no_274582 = (int64_t) 0;
    int64_t total_grid_no_274583 = (int64_t) 0;
    int64_t total_part_no_274584 = (int64_t) 0;
    int64_t total_angle_no_274591 = (int64_t) 0;
    int64_t total_grid_no_274592 = (int64_t) 0;
    int64_t total_part_no_274593 = (int64_t) 0;
    int64_t offset_274595 = (int64_t) 0;
    bool use_measure_for_sorting_274596 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586423;
    
    xs_mem_586423.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586422;
    
    start_of_grid_partition_mem_586422.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586421;
    
    grid_partitions_per_dim_mem_586421.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586420;
    
    grid_part_sizze_per_dim_mem_586420.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586419;
    
    grid_part_prefix_sum_mem_586419.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586418;
    
    angle_partitions_per_dim_mem_586418.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586417;
    
    angle_part_prefix_sum_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_274571 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_274571 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_274571 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_274572 = in0->v5->shape[0];
    dim_274571 = in0->v5->shape[1];
    total_angle_no_274582 = in0->v6;
    total_grid_no_274583 = in0->v7;
    total_part_no_274584 = in0->v8;
    angle_part_prefix_sum_mem_586417 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_586418 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_586419 = in1->v2->mem;
    dim_274571 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_586420 = in1->v3->mem;
    dim_274571 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_586421 = in1->v4->mem;
    dim_274571 = in1->v4->shape[0];
    start_of_grid_partition_mem_586422 = in1->v5->mem;
    dz2080U_274574 = in1->v5->shape[0];
    dim_274571 = in1->v5->shape[1];
    total_angle_no_274591 = in1->v6;
    total_grid_no_274592 = in1->v7;
    total_part_no_274593 = in1->v8;
    xs_mem_586423 = in2->mem;
    n_274575 = in2->shape[0];
    dim_274571 = in2->shape[1];
    offset_274595 = in3;
    use_measure_for_sorting_274596 = in4;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 == in0->v1->shape[0] && (dim_274571 == in0->v2->shape[0] && (dim_274571 == in0->v3->shape[0] && (dim_274571 == in0->v4->shape[0] && (dz2080U_274572 == in0->v5->shape[0] && dim_274571 == in0->v5->shape[1])))))) && ((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573 == in1->v1->shape[0] && (dim_274571 == in1->v2->shape[0] && (dim_274571 == in1->v3->shape[0] && (dim_274571 == in1->v4->shape[0] && (dz2080U_274574 == in1->v5->shape[0] && dim_274571 == in1->v5->shape[1])))))) && (n_274575 == in2->shape[0] && dim_274571 == in2->shape[1])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, angle_part_prefix_sum_mem_586417, angle_partitions_per_dim_mem_586418, grid_part_prefix_sum_mem_586419, grid_part_sizze_per_dim_mem_586420, grid_partitions_per_dim_mem_586421, start_of_grid_partition_mem_586422, xs_mem_586423, dim_274571, dz2080U_274572, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_274573, dz2080U_274574, n_274575, total_angle_no_274582, total_grid_no_274583, total_part_no_274584, total_angle_no_274591, total_grid_no_274592, total_part_no_274593, offset_274595, use_measure_for_sorting_274596);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_274571;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_opaque_skylineBase_float *in1, const struct futhark_f32_2d *in2, const int64_t in3, const bool in4)
{
    int64_t dim_438949 = (int64_t) 0;
    int64_t dz2080U_438950 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 = (int64_t) 0;
    int64_t dz2080U_438952 = (int64_t) 0;
    int64_t n_438953 = (int64_t) 0;
    int64_t total_angle_no_438960 = (int64_t) 0;
    int64_t total_grid_no_438961 = (int64_t) 0;
    int64_t total_part_no_438962 = (int64_t) 0;
    int64_t total_angle_no_438969 = (int64_t) 0;
    int64_t total_grid_no_438970 = (int64_t) 0;
    int64_t total_part_no_438971 = (int64_t) 0;
    int64_t offset_438973 = (int64_t) 0;
    bool use_measure_for_sorting_438974 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586423;
    
    xs_mem_586423.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586422;
    
    start_of_grid_partition_mem_586422.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586421;
    
    grid_partitions_per_dim_mem_586421.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586420;
    
    grid_part_sizze_per_dim_mem_586420.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586419;
    
    grid_part_prefix_sum_mem_586419.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586418;
    
    angle_partitions_per_dim_mem_586418.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586417;
    
    angle_part_prefix_sum_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_438949 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_438949 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_438949 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_438950 = in0->v5->shape[0];
    dim_438949 = in0->v5->shape[1];
    total_angle_no_438960 = in0->v6;
    total_grid_no_438961 = in0->v7;
    total_part_no_438962 = in0->v8;
    angle_part_prefix_sum_mem_586417 = in1->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 = in1->v0->shape[0];
    angle_partitions_per_dim_mem_586418 = in1->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 = in1->v1->shape[0];
    grid_part_prefix_sum_mem_586419 = in1->v2->mem;
    dim_438949 = in1->v2->shape[0];
    grid_part_sizze_per_dim_mem_586420 = in1->v3->mem;
    dim_438949 = in1->v3->shape[0];
    grid_partitions_per_dim_mem_586421 = in1->v4->mem;
    dim_438949 = in1->v4->shape[0];
    start_of_grid_partition_mem_586422 = in1->v5->mem;
    dz2080U_438952 = in1->v5->shape[0];
    dim_438949 = in1->v5->shape[1];
    total_angle_no_438969 = in1->v6;
    total_grid_no_438970 = in1->v7;
    total_part_no_438971 = in1->v8;
    xs_mem_586423 = in2->mem;
    n_438953 = in2->shape[0];
    dim_438949 = in2->shape[1];
    offset_438973 = in3;
    use_measure_for_sorting_438974 = in4;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 == in0->v1->shape[0] && (dim_438949 == in0->v2->shape[0] && (dim_438949 == in0->v3->shape[0] && (dim_438949 == in0->v4->shape[0] && (dz2080U_438950 == in0->v5->shape[0] && dim_438949 == in0->v5->shape[1])))))) && ((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 == in1->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951 == in1->v1->shape[0] && (dim_438949 == in1->v2->shape[0] && (dim_438949 == in1->v3->shape[0] && (dim_438949 == in1->v4->shape[0] && (dz2080U_438952 == in1->v5->shape[0] && dim_438949 == in1->v5->shape[1])))))) && (n_438953 == in2->shape[0] && dim_438949 == in2->shape[1])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partwise_slice_and_dice_for_Skyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, angle_part_prefix_sum_mem_586417, angle_partitions_per_dim_mem_586418, grid_part_prefix_sum_mem_586419, grid_part_sizze_per_dim_mem_586420, grid_partitions_per_dim_mem_586421, start_of_grid_partition_mem_586422, xs_mem_586423, dim_438949, dz2080U_438950, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_438951, dz2080U_438952, n_438953, total_angle_no_438960, total_grid_no_438961, total_part_no_438962, total_angle_no_438969, total_grid_no_438970, total_part_no_438971, offset_438973, use_measure_for_sorting_438974);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_438949;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_pointwise_slice_and_dice_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_f64_2d *in1, const int64_t in2, const bool in3)
{
    int64_t dim_293582 = (int64_t) 0;
    int64_t dz2080U_293583 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584 = (int64_t) 0;
    int64_t n_293585 = (int64_t) 0;
    int64_t total_angle_no_293592 = (int64_t) 0;
    int64_t total_grid_no_293593 = (int64_t) 0;
    int64_t total_part_no_293594 = (int64_t) 0;
    int64_t offset_293596 = (int64_t) 0;
    bool use_measure_for_sorting_293597 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586417;
    
    xs_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_293582 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_293582 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_293582 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_293583 = in0->v5->shape[0];
    dim_293582 = in0->v5->shape[1];
    total_angle_no_293592 = in0->v6;
    total_grid_no_293593 = in0->v7;
    total_part_no_293594 = in0->v8;
    xs_mem_586417 = in1->mem;
    n_293585 = in1->shape[0];
    dim_293582 = in1->shape[1];
    offset_293596 = in2;
    use_measure_for_sorting_293597 = in3;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584 == in0->v1->shape[0] && (dim_293582 == in0->v2->shape[0] && (dim_293582 == in0->v3->shape[0] && (dim_293582 == in0->v4->shape[0] && (dz2080U_293583 == in0->v5->shape[0] && dim_293582 == in0->v5->shape[1])))))) && (n_293585 == in1->shape[0] && dim_293582 == in1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, xs_mem_586417, dim_293582, dz2080U_293583, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_293584, n_293585, total_angle_no_293592, total_grid_no_293593, total_part_no_293594, offset_293596, use_measure_for_sorting_293597);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_293582;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_pointwise_slice_and_dice_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3)
{
    int64_t dim_457918 = (int64_t) 0;
    int64_t dz2080U_457919 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920 = (int64_t) 0;
    int64_t n_457921 = (int64_t) 0;
    int64_t total_angle_no_457928 = (int64_t) 0;
    int64_t total_grid_no_457929 = (int64_t) 0;
    int64_t total_part_no_457930 = (int64_t) 0;
    int64_t offset_457932 = (int64_t) 0;
    bool use_measure_for_sorting_457933 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586417;
    
    xs_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_457918 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_457918 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_457918 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_457919 = in0->v5->shape[0];
    dim_457918 = in0->v5->shape[1];
    total_angle_no_457928 = in0->v6;
    total_grid_no_457929 = in0->v7;
    total_part_no_457930 = in0->v8;
    xs_mem_586417 = in1->mem;
    n_457921 = in1->shape[0];
    dim_457918 = in1->shape[1];
    offset_457932 = in2;
    use_measure_for_sorting_457933 = in3;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920 == in0->v1->shape[0] && (dim_457918 == in0->v2->shape[0] && (dim_457918 == in0->v3->shape[0] && (dim_457918 == in0->v4->shape[0] && (dz2080U_457919 == in0->v5->shape[0] && dim_457918 == in0->v5->shape[1])))))) && (n_457921 == in1->shape[0] && dim_457918 == in1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_pointwise_slice_and_dice_for_Skyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, xs_mem_586417, dim_457918, dz2080U_457919, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_457920, n_457921, total_angle_no_457928, total_grid_no_457929, total_part_no_457930, offset_457932, use_measure_for_sorting_457933);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_457918;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sort_for_Skyline_GFUR_double(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_double **out0, const struct futhark_opaque_skylineBase_double *in0, const struct futhark_f64_2d *in1, const int64_t in2, const bool in3)
{
    int64_t dim_251930 = (int64_t) 0;
    int64_t dz2080U_251931 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932 = (int64_t) 0;
    int64_t n_251933 = (int64_t) 0;
    int64_t total_angle_no_251940 = (int64_t) 0;
    int64_t total_grid_no_251941 = (int64_t) 0;
    int64_t total_part_no_251942 = (int64_t) 0;
    int64_t offset_251944 = (int64_t) 0;
    bool use_measure_for_sorting_251945 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586417;
    
    xs_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_251930 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_251930 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_251930 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_251931 = in0->v5->shape[0];
    dim_251930 = in0->v5->shape[1];
    total_angle_no_251940 = in0->v6;
    total_grid_no_251941 = in0->v7;
    total_part_no_251942 = in0->v8;
    xs_mem_586417 = in1->mem;
    n_251933 = in1->shape[0];
    dim_251930 = in1->shape[1];
    offset_251944 = in2;
    use_measure_for_sorting_251945 = in3;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932 == in0->v1->shape[0] && (dim_251930 == in0->v2->shape[0] && (dim_251930 == in0->v3->shape[0] && (dim_251930 == in0->v4->shape[0] && (dz2080U_251931 == in0->v5->shape[0] && dim_251930 == in0->v5->shape[1])))))) && (n_251933 == in1->shape[0] && dim_251930 == in1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sort_for_Skyline_GFUR_double(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, xs_mem_586417, dim_251930, dz2080U_251931, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_251932, n_251933, total_angle_no_251940, total_grid_no_251941, total_part_no_251942, offset_251944, use_measure_for_sorting_251945);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_double *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f64_2d *) malloc(sizeof(struct futhark_f64_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_251930;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sort_for_Skyline_GFUR_float(struct futhark_context *ctx, struct futhark_opaque_skylineInfo_GFUR_float **out0, const struct futhark_opaque_skylineBase_float *in0, const struct futhark_f32_2d *in1, const int64_t in2, const bool in3)
{
    int64_t dim_416322 = (int64_t) 0;
    int64_t dz2080U_416323 = (int64_t) 0;
    int64_t dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324 = (int64_t) 0;
    int64_t n_416325 = (int64_t) 0;
    int64_t total_angle_no_416332 = (int64_t) 0;
    int64_t total_grid_no_416333 = (int64_t) 0;
    int64_t total_part_no_416334 = (int64_t) 0;
    int64_t offset_416336 = (int64_t) 0;
    bool use_measure_for_sorting_416337 = 0;
    int64_t prim_out_588011 = (int64_t) 0;
    int64_t prim_out_588012 = (int64_t) 0;
    int64_t prim_out_588013 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_588010;
    
    mem_out_588010.references = NULL;
    
    struct memblock mem_out_588009;
    
    mem_out_588009.references = NULL;
    
    struct memblock mem_out_588008;
    
    mem_out_588008.references = NULL;
    
    struct memblock mem_out_588007;
    
    mem_out_588007.references = NULL;
    
    struct memblock xs_mem_586417;
    
    xs_mem_586417.references = NULL;
    
    struct memblock start_of_grid_partition_mem_586416;
    
    start_of_grid_partition_mem_586416.references = NULL;
    
    struct memblock grid_partitions_per_dim_mem_586415;
    
    grid_partitions_per_dim_mem_586415.references = NULL;
    
    struct memblock grid_part_sizze_per_dim_mem_586414;
    
    grid_part_sizze_per_dim_mem_586414.references = NULL;
    
    struct memblock grid_part_prefix_sum_mem_586413;
    
    grid_part_prefix_sum_mem_586413.references = NULL;
    
    struct memblock angle_partitions_per_dim_mem_586412;
    
    angle_partitions_per_dim_mem_586412.references = NULL;
    
    struct memblock angle_part_prefix_sum_mem_586411;
    
    angle_part_prefix_sum_mem_586411.references = NULL;
    angle_part_prefix_sum_mem_586411 = in0->v0->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324 = in0->v0->shape[0];
    angle_partitions_per_dim_mem_586412 = in0->v1->mem;
    dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324 = in0->v1->shape[0];
    grid_part_prefix_sum_mem_586413 = in0->v2->mem;
    dim_416322 = in0->v2->shape[0];
    grid_part_sizze_per_dim_mem_586414 = in0->v3->mem;
    dim_416322 = in0->v3->shape[0];
    grid_partitions_per_dim_mem_586415 = in0->v4->mem;
    dim_416322 = in0->v4->shape[0];
    start_of_grid_partition_mem_586416 = in0->v5->mem;
    dz2080U_416323 = in0->v5->shape[0];
    dim_416322 = in0->v5->shape[1];
    total_angle_no_416332 = in0->v6;
    total_grid_no_416333 = in0->v7;
    total_part_no_416334 = in0->v8;
    xs_mem_586417 = in1->mem;
    n_416325 = in1->shape[0];
    dim_416322 = in1->shape[1];
    offset_416336 = in2;
    use_measure_for_sorting_416337 = in3;
    if (!((dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324 == in0->v0->shape[0] && (dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324 == in0->v1->shape[0] && (dim_416322 == in0->v2->shape[0] && (dim_416322 == in0->v3->shape[0] && (dim_416322 == in0->v4->shape[0] && (dz2080U_416323 == in0->v5->shape[0] && dim_416322 == in0->v5->shape[1])))))) && (n_416325 == in1->shape[0] && dim_416322 == in1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sort_for_Skyline_GFUR_float(ctx, &mem_out_588007, &mem_out_588008, &mem_out_588009, &mem_out_588010, &prim_out_588011, &prim_out_588012, &prim_out_588013, angle_part_prefix_sum_mem_586411, angle_partitions_per_dim_mem_586412, grid_part_prefix_sum_mem_586413, grid_part_sizze_per_dim_mem_586414, grid_partitions_per_dim_mem_586415, start_of_grid_partition_mem_586416, xs_mem_586417, dim_416322, dz2080U_416323, dzlz7bUZLzmZRz20Udimz20U1z7dUzg_416324, n_416325, total_angle_no_416332, total_grid_no_416333, total_part_no_416334, offset_416336, use_measure_for_sorting_416337);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_skylineInfo_GFUR_float *) malloc(sizeof(struct futhark_opaque_skylineInfo_GFUR_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_bool_1d *) malloc(sizeof(struct futhark_bool_1d))) != NULL);
            (*out0)->v0->mem = mem_out_588007;
            (*out0)->v0->shape[0] = prim_out_588011;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_588008;
            (*out0)->v1->shape[0] = prim_out_588012;
            assert(((*out0)->v2 = (struct futhark_f32_2d *) malloc(sizeof(struct futhark_f32_2d))) != NULL);
            (*out0)->v2->mem = mem_out_588009;
            (*out0)->v2->shape[0] = prim_out_588013;
            (*out0)->v2->shape[1] = dim_416322;
            assert(((*out0)->v3 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v3->mem = mem_out_588010;
            (*out0)->v3->shape[0] = prim_out_588013;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
