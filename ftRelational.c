// Generated by Futhark 0.26.0 (prerelease - include info below when reporting bugs).
// git: 1de4f0c (Fri Jan 24 11:10:52 2025 +0100)
// Compiled with GHC 9.4.8.

// We need to define _GNU_SOURCE before
// _any_ headers files are imported to get
// the usage statistics of a thread (i.e. have RUSAGE_THREAD) on GNU/Linux
// https://manpages.courier-mta.org/htmlman2/getrusage.2.html
#ifndef _GNU_SOURCE // Avoid possible double-definition warning.
#define _GNU_SOURCE
#endif

#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wunused-const-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#pragma clang diagnostic ignored "-Wunused-but-set-variable"
#elif __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wunused-const-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#pragma GCC diagnostic ignored "-Wunused-but-set-variable"
#endif

// Headers
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <stdio.h>
#include <float.h>

#ifdef __cplusplus
extern "C" {
#endif

// Initialisation
struct futhark_context_config;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
int futhark_context_config_set_tuning_param(struct futhark_context_config *cfg, const char *param_name, size_t new_value);
struct futhark_context;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *cfg);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag);
int futhark_get_tuning_param_count(void);
const char *futhark_get_tuning_param_name(int);
const char *futhark_get_tuning_param_class(int);

// Arrays
struct futhark_f32_1d;
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0);
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data);
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr);
struct futhark_f64_1d;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data);
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr);
struct futhark_i16_1d;
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0);
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data);
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr);
struct futhark_i32_1d;
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0);
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data);
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr);
struct futhark_i64_1d;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data);
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0);
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr);
struct futhark_u8_2d;
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1);
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1);
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data);
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1);
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr);

// Opaque values
struct futhark_opaque_joinPairs_bsq;
struct futhark_opaque_joinPairs_double;
struct futhark_opaque_joinPairs_float;
struct futhark_opaque_joinPairs_int;
struct futhark_opaque_joinPairs_long;
struct futhark_opaque_joinPairs_short;
struct futhark_opaque_partitionInfo;
struct futhark_opaque_partitionedSet_GFTR;
struct futhark_opaque_partitionedSet_GFUR;
struct futhark_opaque_radix_hashTable;
struct futhark_opaque_sortInfo_double;
struct futhark_opaque_sortInfo_float;
struct futhark_opaque_sortInfo_int;
struct futhark_opaque_sortInfo_long;
struct futhark_opaque_sortInfo_short;
struct futhark_opaque_sortStruct_double;
struct futhark_opaque_sortStruct_float;
struct futhark_opaque_sortStruct_int;
struct futhark_opaque_sortStruct_long;
struct futhark_opaque_sortStruct_short;
struct futhark_opaque_sortgroupInfo;
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj);
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj);
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs);
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj);
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj);
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs);
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj);
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj);
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs);
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj);
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj);
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs);
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj);
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj);
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs);
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj);
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n);
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj);
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs);
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj);
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n);
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj);
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj);
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth);
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj);
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n);
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj);
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks);
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj);
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n);
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj);
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx);
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj);
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj);
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs);
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj);
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj);
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs);
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj);
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj);
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs);
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj);
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj);
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs);
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj);
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n);
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj);
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs);
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj);
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj);
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj);
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj);
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj);
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj);
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj);
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj);
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj);
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n);
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj);
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL);
int futhark_free_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo *obj);
int futhark_store_opaque_sortgroupInfo(struct futhark_context *ctx, const struct futhark_opaque_sortgroupInfo *obj, void **p, size_t *n);
struct futhark_opaque_sortgroupInfo *futhark_restore_opaque_sortgroupInfo(struct futhark_context *ctx, const void *p);
int futhark_project_opaque_sortgroupInfo_group_count(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj);
int futhark_project_opaque_sortgroupInfo_group_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj);
int futhark_new_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out, const struct futhark_i64_1d *f_group_count, const struct futhark_i64_1d *f_group_idx);

// Entry points
int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4);
int futhark_entry_alt_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2);
int futhark_entry_alt_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_alt_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2);
int futhark_entry_alt_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_alt_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_alt_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_alt_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2);
int futhark_entry_alt_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_alt_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2);
int futhark_entry_alt_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0);
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0);
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4);
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3);
int futhark_entry_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2);
int futhark_entry_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2);
int futhark_entry_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4);
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4);
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4);
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4);
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4);
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4);
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5);
int futhark_entry_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2);
int futhark_entry_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2);
int futhark_entry_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_maximum_double(struct futhark_context *ctx, double *out0, const struct futhark_f64_1d *in0);
int futhark_entry_maximum_float(struct futhark_context *ctx, float *out0, const struct futhark_f32_1d *in0);
int futhark_entry_maximum_int(struct futhark_context *ctx, int32_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_maximum_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_maximum_short(struct futhark_context *ctx, int16_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1);
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1);
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1);
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1);
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1);
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0);
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0);
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0);
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0);
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0);
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_minimum_double(struct futhark_context *ctx, double *out0, const struct futhark_f64_1d *in0);
int futhark_entry_minimum_float(struct futhark_context *ctx, float *out0, const struct futhark_f32_1d *in0);
int futhark_entry_minimum_int(struct futhark_context *ctx, int32_t *out0, const struct futhark_i32_1d *in0);
int futhark_entry_minimum_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0);
int futhark_entry_minimum_short(struct futhark_context *ctx, int16_t *out0, const struct futhark_i16_1d *in0);
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3);
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3);
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3);
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3);
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7);
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2);
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2);
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2);
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2);
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2);
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int64_t in0, const struct futhark_opaque_sortStruct_double *in1);
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int64_t in0, const struct futhark_opaque_sortStruct_float *in1);
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int64_t in0, const struct futhark_opaque_sortStruct_int *in1);
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int64_t in0, const struct futhark_opaque_sortStruct_long *in1);
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int64_t in0, const struct futhark_opaque_sortStruct_short *in1);
int futhark_entry_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2);
int futhark_entry_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3);
int futhark_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1);
int futhark_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1);
int futhark_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0);
int futhark_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0);

// Miscellaneous
int futhark_context_sync(struct futhark_context *ctx);
void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
#define FUTHARK_BACKEND_c
#define FUTHARK_SUCCESS 0
#define FUTHARK_PROGRAM_ERROR 2
#define FUTHARK_OUT_OF_MEMORY 3

#ifdef __cplusplus
}
#endif

#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
// If NDEBUG is set, the assert() macro will do nothing. Since Futhark
// (unfortunately) makes use of assert() for error detection (and even some
// side effects), we want to avoid that.
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
#define SCALAR_FUN_ATTR static inline
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) __attribute__((noreturn));
static char* msgprintf(const char *s, ...);
static void* slurp_file(const char *filename, size_t *size);
static int dump_file(const char *file, const void *buf, size_t n);
struct str_builder;
static void str_builder_init(struct str_builder *b);
static void str_builder(struct str_builder *b, const char *s, ...);
static char *strclone(const char *str);

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}

static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                             const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, ...) check_err(err, 0, __func__, __LINE__, __VA_ARGS__)
#define CHECK_ERRNO(err, ...) check_err(err, 1, __func__, __LINE__, __VA_ARGS__)

// Read the rest of an open file into a NUL-terminated string; returns
// NULL on error.
static void* fslurp_file(FILE *f, size_t *size) {
  long start = ftell(f);
  fseek(f, 0, SEEK_END);
  long src_size = ftell(f)-start;
  fseek(f, start, SEEK_SET);
  unsigned char *s = (unsigned char*) malloc((size_t)src_size + 1);
  if (fread(s, 1, (size_t)src_size, f) != (size_t)src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }

  if (size) {
    *size = (size_t)src_size;
  }

  return s;
}

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  unsigned char *s = fslurp_file(f, size);
  fclose(f);
  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

static void str_builder_str(struct str_builder *b, const char *s) {
  size_t needed = strlen(s);
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  strcpy(b->str+b->used, s);
  b->used += needed;
}

static void str_builder_char(struct str_builder *b, char c) {
  size_t needed = 1;
  if (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }
  b->str[b->used] = c;
  b->str[b->used+1] = 0;
  b->used += needed;
}

static void str_builder_json_str(struct str_builder* sb, const char* s) {
  str_builder_char(sb, '"');
  for (int j = 0; s[j]; j++) {
    char c = s[j];
    switch (c) {
    case '\n':
      str_builder_str(sb, "\\n");
      break;
    case '"':
      str_builder_str(sb, "\\\"");
      break;
    default:
      str_builder_char(sb, c);
    }
  }
  str_builder_char(sb, '"');
}

static char *strclone(const char *str) {
  size_t size = strlen(str) + 1;
  char *copy = (char*) malloc(size);
  if (copy == NULL) {
    return NULL;
  }

  memcpy(copy, str, size);
  return copy;
}

// Assumes NULL-terminated.
static char *strconcat(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

// End of util.h.
// Start of cache.h

#define CACHE_HASH_SIZE 8 // In 32-bit words.

struct cache_hash {
  uint32_t hash[CACHE_HASH_SIZE];
};

// Initialise a blank cache.
static void cache_hash_init(struct cache_hash *c);

// Hash some bytes and add them to the accumulated hash.
static void cache_hash(struct cache_hash *out, const char *in, size_t n);

// Try to restore cache contents from a file with the given name.
// Assumes the cache is invalid if it contains the given hash.
// Allocates memory and reads the cache conents, which is returned in
// *buf with size *buflen.  If the cache is successfully loaded, this
// function returns 0.  Otherwise it returns nonzero.  Errno is set if
// the failure to load the cache is due to anything except invalid
// cache conents.  Note that failing to restore the cache is not
// necessarily a problem: it might just be invalid or not created yet.
static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen);

// Store cache contents in the given file, with the given hash.
static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen);

// Now for the implementation.

static void cache_hash_init(struct cache_hash *c) {
  memset(c->hash, 0, CACHE_HASH_SIZE * sizeof(uint32_t));
}

static void cache_hash(struct cache_hash *out, const char *in, size_t n) {
  // Adaptation of djb2 for larger output size by storing intermediate
  // states.
  uint32_t hash = 5381;
  for (size_t i = 0; i < n; i++) {
    hash = ((hash << 5) + hash) + in[i];
    out->hash[i % CACHE_HASH_SIZE] ^= hash;
  }
}

#define CACHE_HEADER_SIZE 8
static const char cache_header[CACHE_HEADER_SIZE] = "FUTHARK\0";

static int cache_restore(const char *fname, const struct cache_hash *hash,
                         unsigned char **buf, size_t *buflen) {
  FILE *f = fopen(fname, "rb");

  if (f == NULL) {
    return 1;
  }

  char f_header[CACHE_HEADER_SIZE];

  if (fread(f_header, sizeof(char), CACHE_HEADER_SIZE, f) != CACHE_HEADER_SIZE) {
    goto error;
  }

  if (memcmp(f_header, cache_header, CACHE_HEADER_SIZE) != 0) {
    goto error;
  }

  if (fseek(f, 0, SEEK_END) != 0) {
    goto error;
  }
  int64_t f_size = (int64_t)ftell(f);
  if (fseek(f, CACHE_HEADER_SIZE, SEEK_SET) != 0) {
    goto error;
  }

  int64_t expected_size;

  if (fread(&expected_size, sizeof(int64_t), 1, f) != 1) {
    goto error;
  }

  if (f_size != expected_size) {
    errno = 0;
    goto error;
  }

  int32_t f_hash[CACHE_HASH_SIZE];

  if (fread(f_hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (memcmp(f_hash, hash->hash, CACHE_HASH_SIZE) != 0) {
    errno = 0;
    goto error;
  }

  *buflen = f_size - CACHE_HEADER_SIZE - sizeof(int64_t) - CACHE_HASH_SIZE*sizeof(int32_t);
  *buf = malloc(*buflen);
  if (fread(*buf, sizeof(char), *buflen, f) != *buflen) {
    free(*buf);
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

static int cache_store(const char *fname, const struct cache_hash *hash,
                       const unsigned char *buf, size_t buflen) {
  FILE *f = fopen(fname, "wb");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(cache_header, CACHE_HEADER_SIZE, 1, f) != 1) {
    goto error;
  }

  int64_t size = CACHE_HEADER_SIZE + sizeof(int64_t) + CACHE_HASH_SIZE*sizeof(int32_t) + buflen;

  if (fwrite(&size, sizeof(size), 1, f) != 1) {
    goto error;
  }

  if (fwrite(hash->hash, sizeof(int32_t), CACHE_HASH_SIZE, f) != CACHE_HASH_SIZE) {
    goto error;
  }

  if (fwrite(buf, sizeof(unsigned char), buflen, f) != buflen) {
    goto error;
  }

  fclose(f);

  return 0;

 error:
  fclose(f);
  return 1;
}

// End of cache.h
// Start of half.h.

// Conversion functions are from http://half.sourceforge.net/, but
// translated to C.
//
// Copyright (c) 2012-2021 Christian Rau
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#ifndef __OPENCL_VERSION__
#define __constant
#endif

__constant static const uint16_t base_table[512] = {
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
  0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0002, 0x0004, 0x0008, 0x0010, 0x0020, 0x0040, 0x0080, 0x0100,
  0x0200, 0x0400, 0x0800, 0x0C00, 0x1000, 0x1400, 0x1800, 0x1C00, 0x2000, 0x2400, 0x2800, 0x2C00, 0x3000, 0x3400, 0x3800, 0x3C00,
  0x4000, 0x4400, 0x4800, 0x4C00, 0x5000, 0x5400, 0x5800, 0x5C00, 0x6000, 0x6400, 0x6800, 0x6C00, 0x7000, 0x7400, 0x7800, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00, 0x7C00,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000,
  0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8000, 0x8001, 0x8002, 0x8004, 0x8008, 0x8010, 0x8020, 0x8040, 0x8080, 0x8100,
  0x8200, 0x8400, 0x8800, 0x8C00, 0x9000, 0x9400, 0x9800, 0x9C00, 0xA000, 0xA400, 0xA800, 0xAC00, 0xB000, 0xB400, 0xB800, 0xBC00,
  0xC000, 0xC400, 0xC800, 0xCC00, 0xD000, 0xD400, 0xD800, 0xDC00, 0xE000, 0xE400, 0xE800, 0xEC00, 0xF000, 0xF400, 0xF800, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00,
  0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00, 0xFC00 };

__constant static const unsigned char shift_table[512] = {
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13,
  13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
  24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 13 };

__constant static const uint32_t mantissa_table[2048] = {
  0x00000000, 0x33800000, 0x34000000, 0x34400000, 0x34800000, 0x34A00000, 0x34C00000, 0x34E00000, 0x35000000, 0x35100000, 0x35200000, 0x35300000, 0x35400000, 0x35500000, 0x35600000, 0x35700000,
  0x35800000, 0x35880000, 0x35900000, 0x35980000, 0x35A00000, 0x35A80000, 0x35B00000, 0x35B80000, 0x35C00000, 0x35C80000, 0x35D00000, 0x35D80000, 0x35E00000, 0x35E80000, 0x35F00000, 0x35F80000,
  0x36000000, 0x36040000, 0x36080000, 0x360C0000, 0x36100000, 0x36140000, 0x36180000, 0x361C0000, 0x36200000, 0x36240000, 0x36280000, 0x362C0000, 0x36300000, 0x36340000, 0x36380000, 0x363C0000,
  0x36400000, 0x36440000, 0x36480000, 0x364C0000, 0x36500000, 0x36540000, 0x36580000, 0x365C0000, 0x36600000, 0x36640000, 0x36680000, 0x366C0000, 0x36700000, 0x36740000, 0x36780000, 0x367C0000,
  0x36800000, 0x36820000, 0x36840000, 0x36860000, 0x36880000, 0x368A0000, 0x368C0000, 0x368E0000, 0x36900000, 0x36920000, 0x36940000, 0x36960000, 0x36980000, 0x369A0000, 0x369C0000, 0x369E0000,
  0x36A00000, 0x36A20000, 0x36A40000, 0x36A60000, 0x36A80000, 0x36AA0000, 0x36AC0000, 0x36AE0000, 0x36B00000, 0x36B20000, 0x36B40000, 0x36B60000, 0x36B80000, 0x36BA0000, 0x36BC0000, 0x36BE0000,
  0x36C00000, 0x36C20000, 0x36C40000, 0x36C60000, 0x36C80000, 0x36CA0000, 0x36CC0000, 0x36CE0000, 0x36D00000, 0x36D20000, 0x36D40000, 0x36D60000, 0x36D80000, 0x36DA0000, 0x36DC0000, 0x36DE0000,
  0x36E00000, 0x36E20000, 0x36E40000, 0x36E60000, 0x36E80000, 0x36EA0000, 0x36EC0000, 0x36EE0000, 0x36F00000, 0x36F20000, 0x36F40000, 0x36F60000, 0x36F80000, 0x36FA0000, 0x36FC0000, 0x36FE0000,
  0x37000000, 0x37010000, 0x37020000, 0x37030000, 0x37040000, 0x37050000, 0x37060000, 0x37070000, 0x37080000, 0x37090000, 0x370A0000, 0x370B0000, 0x370C0000, 0x370D0000, 0x370E0000, 0x370F0000,
  0x37100000, 0x37110000, 0x37120000, 0x37130000, 0x37140000, 0x37150000, 0x37160000, 0x37170000, 0x37180000, 0x37190000, 0x371A0000, 0x371B0000, 0x371C0000, 0x371D0000, 0x371E0000, 0x371F0000,
  0x37200000, 0x37210000, 0x37220000, 0x37230000, 0x37240000, 0x37250000, 0x37260000, 0x37270000, 0x37280000, 0x37290000, 0x372A0000, 0x372B0000, 0x372C0000, 0x372D0000, 0x372E0000, 0x372F0000,
  0x37300000, 0x37310000, 0x37320000, 0x37330000, 0x37340000, 0x37350000, 0x37360000, 0x37370000, 0x37380000, 0x37390000, 0x373A0000, 0x373B0000, 0x373C0000, 0x373D0000, 0x373E0000, 0x373F0000,
  0x37400000, 0x37410000, 0x37420000, 0x37430000, 0x37440000, 0x37450000, 0x37460000, 0x37470000, 0x37480000, 0x37490000, 0x374A0000, 0x374B0000, 0x374C0000, 0x374D0000, 0x374E0000, 0x374F0000,
  0x37500000, 0x37510000, 0x37520000, 0x37530000, 0x37540000, 0x37550000, 0x37560000, 0x37570000, 0x37580000, 0x37590000, 0x375A0000, 0x375B0000, 0x375C0000, 0x375D0000, 0x375E0000, 0x375F0000,
  0x37600000, 0x37610000, 0x37620000, 0x37630000, 0x37640000, 0x37650000, 0x37660000, 0x37670000, 0x37680000, 0x37690000, 0x376A0000, 0x376B0000, 0x376C0000, 0x376D0000, 0x376E0000, 0x376F0000,
  0x37700000, 0x37710000, 0x37720000, 0x37730000, 0x37740000, 0x37750000, 0x37760000, 0x37770000, 0x37780000, 0x37790000, 0x377A0000, 0x377B0000, 0x377C0000, 0x377D0000, 0x377E0000, 0x377F0000,
  0x37800000, 0x37808000, 0x37810000, 0x37818000, 0x37820000, 0x37828000, 0x37830000, 0x37838000, 0x37840000, 0x37848000, 0x37850000, 0x37858000, 0x37860000, 0x37868000, 0x37870000, 0x37878000,
  0x37880000, 0x37888000, 0x37890000, 0x37898000, 0x378A0000, 0x378A8000, 0x378B0000, 0x378B8000, 0x378C0000, 0x378C8000, 0x378D0000, 0x378D8000, 0x378E0000, 0x378E8000, 0x378F0000, 0x378F8000,
  0x37900000, 0x37908000, 0x37910000, 0x37918000, 0x37920000, 0x37928000, 0x37930000, 0x37938000, 0x37940000, 0x37948000, 0x37950000, 0x37958000, 0x37960000, 0x37968000, 0x37970000, 0x37978000,
  0x37980000, 0x37988000, 0x37990000, 0x37998000, 0x379A0000, 0x379A8000, 0x379B0000, 0x379B8000, 0x379C0000, 0x379C8000, 0x379D0000, 0x379D8000, 0x379E0000, 0x379E8000, 0x379F0000, 0x379F8000,
  0x37A00000, 0x37A08000, 0x37A10000, 0x37A18000, 0x37A20000, 0x37A28000, 0x37A30000, 0x37A38000, 0x37A40000, 0x37A48000, 0x37A50000, 0x37A58000, 0x37A60000, 0x37A68000, 0x37A70000, 0x37A78000,
  0x37A80000, 0x37A88000, 0x37A90000, 0x37A98000, 0x37AA0000, 0x37AA8000, 0x37AB0000, 0x37AB8000, 0x37AC0000, 0x37AC8000, 0x37AD0000, 0x37AD8000, 0x37AE0000, 0x37AE8000, 0x37AF0000, 0x37AF8000,
  0x37B00000, 0x37B08000, 0x37B10000, 0x37B18000, 0x37B20000, 0x37B28000, 0x37B30000, 0x37B38000, 0x37B40000, 0x37B48000, 0x37B50000, 0x37B58000, 0x37B60000, 0x37B68000, 0x37B70000, 0x37B78000,
  0x37B80000, 0x37B88000, 0x37B90000, 0x37B98000, 0x37BA0000, 0x37BA8000, 0x37BB0000, 0x37BB8000, 0x37BC0000, 0x37BC8000, 0x37BD0000, 0x37BD8000, 0x37BE0000, 0x37BE8000, 0x37BF0000, 0x37BF8000,
  0x37C00000, 0x37C08000, 0x37C10000, 0x37C18000, 0x37C20000, 0x37C28000, 0x37C30000, 0x37C38000, 0x37C40000, 0x37C48000, 0x37C50000, 0x37C58000, 0x37C60000, 0x37C68000, 0x37C70000, 0x37C78000,
  0x37C80000, 0x37C88000, 0x37C90000, 0x37C98000, 0x37CA0000, 0x37CA8000, 0x37CB0000, 0x37CB8000, 0x37CC0000, 0x37CC8000, 0x37CD0000, 0x37CD8000, 0x37CE0000, 0x37CE8000, 0x37CF0000, 0x37CF8000,
  0x37D00000, 0x37D08000, 0x37D10000, 0x37D18000, 0x37D20000, 0x37D28000, 0x37D30000, 0x37D38000, 0x37D40000, 0x37D48000, 0x37D50000, 0x37D58000, 0x37D60000, 0x37D68000, 0x37D70000, 0x37D78000,
  0x37D80000, 0x37D88000, 0x37D90000, 0x37D98000, 0x37DA0000, 0x37DA8000, 0x37DB0000, 0x37DB8000, 0x37DC0000, 0x37DC8000, 0x37DD0000, 0x37DD8000, 0x37DE0000, 0x37DE8000, 0x37DF0000, 0x37DF8000,
  0x37E00000, 0x37E08000, 0x37E10000, 0x37E18000, 0x37E20000, 0x37E28000, 0x37E30000, 0x37E38000, 0x37E40000, 0x37E48000, 0x37E50000, 0x37E58000, 0x37E60000, 0x37E68000, 0x37E70000, 0x37E78000,
  0x37E80000, 0x37E88000, 0x37E90000, 0x37E98000, 0x37EA0000, 0x37EA8000, 0x37EB0000, 0x37EB8000, 0x37EC0000, 0x37EC8000, 0x37ED0000, 0x37ED8000, 0x37EE0000, 0x37EE8000, 0x37EF0000, 0x37EF8000,
  0x37F00000, 0x37F08000, 0x37F10000, 0x37F18000, 0x37F20000, 0x37F28000, 0x37F30000, 0x37F38000, 0x37F40000, 0x37F48000, 0x37F50000, 0x37F58000, 0x37F60000, 0x37F68000, 0x37F70000, 0x37F78000,
  0x37F80000, 0x37F88000, 0x37F90000, 0x37F98000, 0x37FA0000, 0x37FA8000, 0x37FB0000, 0x37FB8000, 0x37FC0000, 0x37FC8000, 0x37FD0000, 0x37FD8000, 0x37FE0000, 0x37FE8000, 0x37FF0000, 0x37FF8000,
  0x38000000, 0x38004000, 0x38008000, 0x3800C000, 0x38010000, 0x38014000, 0x38018000, 0x3801C000, 0x38020000, 0x38024000, 0x38028000, 0x3802C000, 0x38030000, 0x38034000, 0x38038000, 0x3803C000,
  0x38040000, 0x38044000, 0x38048000, 0x3804C000, 0x38050000, 0x38054000, 0x38058000, 0x3805C000, 0x38060000, 0x38064000, 0x38068000, 0x3806C000, 0x38070000, 0x38074000, 0x38078000, 0x3807C000,
  0x38080000, 0x38084000, 0x38088000, 0x3808C000, 0x38090000, 0x38094000, 0x38098000, 0x3809C000, 0x380A0000, 0x380A4000, 0x380A8000, 0x380AC000, 0x380B0000, 0x380B4000, 0x380B8000, 0x380BC000,
  0x380C0000, 0x380C4000, 0x380C8000, 0x380CC000, 0x380D0000, 0x380D4000, 0x380D8000, 0x380DC000, 0x380E0000, 0x380E4000, 0x380E8000, 0x380EC000, 0x380F0000, 0x380F4000, 0x380F8000, 0x380FC000,
  0x38100000, 0x38104000, 0x38108000, 0x3810C000, 0x38110000, 0x38114000, 0x38118000, 0x3811C000, 0x38120000, 0x38124000, 0x38128000, 0x3812C000, 0x38130000, 0x38134000, 0x38138000, 0x3813C000,
  0x38140000, 0x38144000, 0x38148000, 0x3814C000, 0x38150000, 0x38154000, 0x38158000, 0x3815C000, 0x38160000, 0x38164000, 0x38168000, 0x3816C000, 0x38170000, 0x38174000, 0x38178000, 0x3817C000,
  0x38180000, 0x38184000, 0x38188000, 0x3818C000, 0x38190000, 0x38194000, 0x38198000, 0x3819C000, 0x381A0000, 0x381A4000, 0x381A8000, 0x381AC000, 0x381B0000, 0x381B4000, 0x381B8000, 0x381BC000,
  0x381C0000, 0x381C4000, 0x381C8000, 0x381CC000, 0x381D0000, 0x381D4000, 0x381D8000, 0x381DC000, 0x381E0000, 0x381E4000, 0x381E8000, 0x381EC000, 0x381F0000, 0x381F4000, 0x381F8000, 0x381FC000,
  0x38200000, 0x38204000, 0x38208000, 0x3820C000, 0x38210000, 0x38214000, 0x38218000, 0x3821C000, 0x38220000, 0x38224000, 0x38228000, 0x3822C000, 0x38230000, 0x38234000, 0x38238000, 0x3823C000,
  0x38240000, 0x38244000, 0x38248000, 0x3824C000, 0x38250000, 0x38254000, 0x38258000, 0x3825C000, 0x38260000, 0x38264000, 0x38268000, 0x3826C000, 0x38270000, 0x38274000, 0x38278000, 0x3827C000,
  0x38280000, 0x38284000, 0x38288000, 0x3828C000, 0x38290000, 0x38294000, 0x38298000, 0x3829C000, 0x382A0000, 0x382A4000, 0x382A8000, 0x382AC000, 0x382B0000, 0x382B4000, 0x382B8000, 0x382BC000,
  0x382C0000, 0x382C4000, 0x382C8000, 0x382CC000, 0x382D0000, 0x382D4000, 0x382D8000, 0x382DC000, 0x382E0000, 0x382E4000, 0x382E8000, 0x382EC000, 0x382F0000, 0x382F4000, 0x382F8000, 0x382FC000,
  0x38300000, 0x38304000, 0x38308000, 0x3830C000, 0x38310000, 0x38314000, 0x38318000, 0x3831C000, 0x38320000, 0x38324000, 0x38328000, 0x3832C000, 0x38330000, 0x38334000, 0x38338000, 0x3833C000,
  0x38340000, 0x38344000, 0x38348000, 0x3834C000, 0x38350000, 0x38354000, 0x38358000, 0x3835C000, 0x38360000, 0x38364000, 0x38368000, 0x3836C000, 0x38370000, 0x38374000, 0x38378000, 0x3837C000,
  0x38380000, 0x38384000, 0x38388000, 0x3838C000, 0x38390000, 0x38394000, 0x38398000, 0x3839C000, 0x383A0000, 0x383A4000, 0x383A8000, 0x383AC000, 0x383B0000, 0x383B4000, 0x383B8000, 0x383BC000,
  0x383C0000, 0x383C4000, 0x383C8000, 0x383CC000, 0x383D0000, 0x383D4000, 0x383D8000, 0x383DC000, 0x383E0000, 0x383E4000, 0x383E8000, 0x383EC000, 0x383F0000, 0x383F4000, 0x383F8000, 0x383FC000,
  0x38400000, 0x38404000, 0x38408000, 0x3840C000, 0x38410000, 0x38414000, 0x38418000, 0x3841C000, 0x38420000, 0x38424000, 0x38428000, 0x3842C000, 0x38430000, 0x38434000, 0x38438000, 0x3843C000,
  0x38440000, 0x38444000, 0x38448000, 0x3844C000, 0x38450000, 0x38454000, 0x38458000, 0x3845C000, 0x38460000, 0x38464000, 0x38468000, 0x3846C000, 0x38470000, 0x38474000, 0x38478000, 0x3847C000,
  0x38480000, 0x38484000, 0x38488000, 0x3848C000, 0x38490000, 0x38494000, 0x38498000, 0x3849C000, 0x384A0000, 0x384A4000, 0x384A8000, 0x384AC000, 0x384B0000, 0x384B4000, 0x384B8000, 0x384BC000,
  0x384C0000, 0x384C4000, 0x384C8000, 0x384CC000, 0x384D0000, 0x384D4000, 0x384D8000, 0x384DC000, 0x384E0000, 0x384E4000, 0x384E8000, 0x384EC000, 0x384F0000, 0x384F4000, 0x384F8000, 0x384FC000,
  0x38500000, 0x38504000, 0x38508000, 0x3850C000, 0x38510000, 0x38514000, 0x38518000, 0x3851C000, 0x38520000, 0x38524000, 0x38528000, 0x3852C000, 0x38530000, 0x38534000, 0x38538000, 0x3853C000,
  0x38540000, 0x38544000, 0x38548000, 0x3854C000, 0x38550000, 0x38554000, 0x38558000, 0x3855C000, 0x38560000, 0x38564000, 0x38568000, 0x3856C000, 0x38570000, 0x38574000, 0x38578000, 0x3857C000,
  0x38580000, 0x38584000, 0x38588000, 0x3858C000, 0x38590000, 0x38594000, 0x38598000, 0x3859C000, 0x385A0000, 0x385A4000, 0x385A8000, 0x385AC000, 0x385B0000, 0x385B4000, 0x385B8000, 0x385BC000,
  0x385C0000, 0x385C4000, 0x385C8000, 0x385CC000, 0x385D0000, 0x385D4000, 0x385D8000, 0x385DC000, 0x385E0000, 0x385E4000, 0x385E8000, 0x385EC000, 0x385F0000, 0x385F4000, 0x385F8000, 0x385FC000,
  0x38600000, 0x38604000, 0x38608000, 0x3860C000, 0x38610000, 0x38614000, 0x38618000, 0x3861C000, 0x38620000, 0x38624000, 0x38628000, 0x3862C000, 0x38630000, 0x38634000, 0x38638000, 0x3863C000,
  0x38640000, 0x38644000, 0x38648000, 0x3864C000, 0x38650000, 0x38654000, 0x38658000, 0x3865C000, 0x38660000, 0x38664000, 0x38668000, 0x3866C000, 0x38670000, 0x38674000, 0x38678000, 0x3867C000,
  0x38680000, 0x38684000, 0x38688000, 0x3868C000, 0x38690000, 0x38694000, 0x38698000, 0x3869C000, 0x386A0000, 0x386A4000, 0x386A8000, 0x386AC000, 0x386B0000, 0x386B4000, 0x386B8000, 0x386BC000,
  0x386C0000, 0x386C4000, 0x386C8000, 0x386CC000, 0x386D0000, 0x386D4000, 0x386D8000, 0x386DC000, 0x386E0000, 0x386E4000, 0x386E8000, 0x386EC000, 0x386F0000, 0x386F4000, 0x386F8000, 0x386FC000,
  0x38700000, 0x38704000, 0x38708000, 0x3870C000, 0x38710000, 0x38714000, 0x38718000, 0x3871C000, 0x38720000, 0x38724000, 0x38728000, 0x3872C000, 0x38730000, 0x38734000, 0x38738000, 0x3873C000,
  0x38740000, 0x38744000, 0x38748000, 0x3874C000, 0x38750000, 0x38754000, 0x38758000, 0x3875C000, 0x38760000, 0x38764000, 0x38768000, 0x3876C000, 0x38770000, 0x38774000, 0x38778000, 0x3877C000,
  0x38780000, 0x38784000, 0x38788000, 0x3878C000, 0x38790000, 0x38794000, 0x38798000, 0x3879C000, 0x387A0000, 0x387A4000, 0x387A8000, 0x387AC000, 0x387B0000, 0x387B4000, 0x387B8000, 0x387BC000,
  0x387C0000, 0x387C4000, 0x387C8000, 0x387CC000, 0x387D0000, 0x387D4000, 0x387D8000, 0x387DC000, 0x387E0000, 0x387E4000, 0x387E8000, 0x387EC000, 0x387F0000, 0x387F4000, 0x387F8000, 0x387FC000,
  0x38000000, 0x38002000, 0x38004000, 0x38006000, 0x38008000, 0x3800A000, 0x3800C000, 0x3800E000, 0x38010000, 0x38012000, 0x38014000, 0x38016000, 0x38018000, 0x3801A000, 0x3801C000, 0x3801E000,
  0x38020000, 0x38022000, 0x38024000, 0x38026000, 0x38028000, 0x3802A000, 0x3802C000, 0x3802E000, 0x38030000, 0x38032000, 0x38034000, 0x38036000, 0x38038000, 0x3803A000, 0x3803C000, 0x3803E000,
  0x38040000, 0x38042000, 0x38044000, 0x38046000, 0x38048000, 0x3804A000, 0x3804C000, 0x3804E000, 0x38050000, 0x38052000, 0x38054000, 0x38056000, 0x38058000, 0x3805A000, 0x3805C000, 0x3805E000,
  0x38060000, 0x38062000, 0x38064000, 0x38066000, 0x38068000, 0x3806A000, 0x3806C000, 0x3806E000, 0x38070000, 0x38072000, 0x38074000, 0x38076000, 0x38078000, 0x3807A000, 0x3807C000, 0x3807E000,
  0x38080000, 0x38082000, 0x38084000, 0x38086000, 0x38088000, 0x3808A000, 0x3808C000, 0x3808E000, 0x38090000, 0x38092000, 0x38094000, 0x38096000, 0x38098000, 0x3809A000, 0x3809C000, 0x3809E000,
  0x380A0000, 0x380A2000, 0x380A4000, 0x380A6000, 0x380A8000, 0x380AA000, 0x380AC000, 0x380AE000, 0x380B0000, 0x380B2000, 0x380B4000, 0x380B6000, 0x380B8000, 0x380BA000, 0x380BC000, 0x380BE000,
  0x380C0000, 0x380C2000, 0x380C4000, 0x380C6000, 0x380C8000, 0x380CA000, 0x380CC000, 0x380CE000, 0x380D0000, 0x380D2000, 0x380D4000, 0x380D6000, 0x380D8000, 0x380DA000, 0x380DC000, 0x380DE000,
  0x380E0000, 0x380E2000, 0x380E4000, 0x380E6000, 0x380E8000, 0x380EA000, 0x380EC000, 0x380EE000, 0x380F0000, 0x380F2000, 0x380F4000, 0x380F6000, 0x380F8000, 0x380FA000, 0x380FC000, 0x380FE000,
  0x38100000, 0x38102000, 0x38104000, 0x38106000, 0x38108000, 0x3810A000, 0x3810C000, 0x3810E000, 0x38110000, 0x38112000, 0x38114000, 0x38116000, 0x38118000, 0x3811A000, 0x3811C000, 0x3811E000,
  0x38120000, 0x38122000, 0x38124000, 0x38126000, 0x38128000, 0x3812A000, 0x3812C000, 0x3812E000, 0x38130000, 0x38132000, 0x38134000, 0x38136000, 0x38138000, 0x3813A000, 0x3813C000, 0x3813E000,
  0x38140000, 0x38142000, 0x38144000, 0x38146000, 0x38148000, 0x3814A000, 0x3814C000, 0x3814E000, 0x38150000, 0x38152000, 0x38154000, 0x38156000, 0x38158000, 0x3815A000, 0x3815C000, 0x3815E000,
  0x38160000, 0x38162000, 0x38164000, 0x38166000, 0x38168000, 0x3816A000, 0x3816C000, 0x3816E000, 0x38170000, 0x38172000, 0x38174000, 0x38176000, 0x38178000, 0x3817A000, 0x3817C000, 0x3817E000,
  0x38180000, 0x38182000, 0x38184000, 0x38186000, 0x38188000, 0x3818A000, 0x3818C000, 0x3818E000, 0x38190000, 0x38192000, 0x38194000, 0x38196000, 0x38198000, 0x3819A000, 0x3819C000, 0x3819E000,
  0x381A0000, 0x381A2000, 0x381A4000, 0x381A6000, 0x381A8000, 0x381AA000, 0x381AC000, 0x381AE000, 0x381B0000, 0x381B2000, 0x381B4000, 0x381B6000, 0x381B8000, 0x381BA000, 0x381BC000, 0x381BE000,
  0x381C0000, 0x381C2000, 0x381C4000, 0x381C6000, 0x381C8000, 0x381CA000, 0x381CC000, 0x381CE000, 0x381D0000, 0x381D2000, 0x381D4000, 0x381D6000, 0x381D8000, 0x381DA000, 0x381DC000, 0x381DE000,
  0x381E0000, 0x381E2000, 0x381E4000, 0x381E6000, 0x381E8000, 0x381EA000, 0x381EC000, 0x381EE000, 0x381F0000, 0x381F2000, 0x381F4000, 0x381F6000, 0x381F8000, 0x381FA000, 0x381FC000, 0x381FE000,
  0x38200000, 0x38202000, 0x38204000, 0x38206000, 0x38208000, 0x3820A000, 0x3820C000, 0x3820E000, 0x38210000, 0x38212000, 0x38214000, 0x38216000, 0x38218000, 0x3821A000, 0x3821C000, 0x3821E000,
  0x38220000, 0x38222000, 0x38224000, 0x38226000, 0x38228000, 0x3822A000, 0x3822C000, 0x3822E000, 0x38230000, 0x38232000, 0x38234000, 0x38236000, 0x38238000, 0x3823A000, 0x3823C000, 0x3823E000,
  0x38240000, 0x38242000, 0x38244000, 0x38246000, 0x38248000, 0x3824A000, 0x3824C000, 0x3824E000, 0x38250000, 0x38252000, 0x38254000, 0x38256000, 0x38258000, 0x3825A000, 0x3825C000, 0x3825E000,
  0x38260000, 0x38262000, 0x38264000, 0x38266000, 0x38268000, 0x3826A000, 0x3826C000, 0x3826E000, 0x38270000, 0x38272000, 0x38274000, 0x38276000, 0x38278000, 0x3827A000, 0x3827C000, 0x3827E000,
  0x38280000, 0x38282000, 0x38284000, 0x38286000, 0x38288000, 0x3828A000, 0x3828C000, 0x3828E000, 0x38290000, 0x38292000, 0x38294000, 0x38296000, 0x38298000, 0x3829A000, 0x3829C000, 0x3829E000,
  0x382A0000, 0x382A2000, 0x382A4000, 0x382A6000, 0x382A8000, 0x382AA000, 0x382AC000, 0x382AE000, 0x382B0000, 0x382B2000, 0x382B4000, 0x382B6000, 0x382B8000, 0x382BA000, 0x382BC000, 0x382BE000,
  0x382C0000, 0x382C2000, 0x382C4000, 0x382C6000, 0x382C8000, 0x382CA000, 0x382CC000, 0x382CE000, 0x382D0000, 0x382D2000, 0x382D4000, 0x382D6000, 0x382D8000, 0x382DA000, 0x382DC000, 0x382DE000,
  0x382E0000, 0x382E2000, 0x382E4000, 0x382E6000, 0x382E8000, 0x382EA000, 0x382EC000, 0x382EE000, 0x382F0000, 0x382F2000, 0x382F4000, 0x382F6000, 0x382F8000, 0x382FA000, 0x382FC000, 0x382FE000,
  0x38300000, 0x38302000, 0x38304000, 0x38306000, 0x38308000, 0x3830A000, 0x3830C000, 0x3830E000, 0x38310000, 0x38312000, 0x38314000, 0x38316000, 0x38318000, 0x3831A000, 0x3831C000, 0x3831E000,
  0x38320000, 0x38322000, 0x38324000, 0x38326000, 0x38328000, 0x3832A000, 0x3832C000, 0x3832E000, 0x38330000, 0x38332000, 0x38334000, 0x38336000, 0x38338000, 0x3833A000, 0x3833C000, 0x3833E000,
  0x38340000, 0x38342000, 0x38344000, 0x38346000, 0x38348000, 0x3834A000, 0x3834C000, 0x3834E000, 0x38350000, 0x38352000, 0x38354000, 0x38356000, 0x38358000, 0x3835A000, 0x3835C000, 0x3835E000,
  0x38360000, 0x38362000, 0x38364000, 0x38366000, 0x38368000, 0x3836A000, 0x3836C000, 0x3836E000, 0x38370000, 0x38372000, 0x38374000, 0x38376000, 0x38378000, 0x3837A000, 0x3837C000, 0x3837E000,
  0x38380000, 0x38382000, 0x38384000, 0x38386000, 0x38388000, 0x3838A000, 0x3838C000, 0x3838E000, 0x38390000, 0x38392000, 0x38394000, 0x38396000, 0x38398000, 0x3839A000, 0x3839C000, 0x3839E000,
  0x383A0000, 0x383A2000, 0x383A4000, 0x383A6000, 0x383A8000, 0x383AA000, 0x383AC000, 0x383AE000, 0x383B0000, 0x383B2000, 0x383B4000, 0x383B6000, 0x383B8000, 0x383BA000, 0x383BC000, 0x383BE000,
  0x383C0000, 0x383C2000, 0x383C4000, 0x383C6000, 0x383C8000, 0x383CA000, 0x383CC000, 0x383CE000, 0x383D0000, 0x383D2000, 0x383D4000, 0x383D6000, 0x383D8000, 0x383DA000, 0x383DC000, 0x383DE000,
  0x383E0000, 0x383E2000, 0x383E4000, 0x383E6000, 0x383E8000, 0x383EA000, 0x383EC000, 0x383EE000, 0x383F0000, 0x383F2000, 0x383F4000, 0x383F6000, 0x383F8000, 0x383FA000, 0x383FC000, 0x383FE000,
  0x38400000, 0x38402000, 0x38404000, 0x38406000, 0x38408000, 0x3840A000, 0x3840C000, 0x3840E000, 0x38410000, 0x38412000, 0x38414000, 0x38416000, 0x38418000, 0x3841A000, 0x3841C000, 0x3841E000,
  0x38420000, 0x38422000, 0x38424000, 0x38426000, 0x38428000, 0x3842A000, 0x3842C000, 0x3842E000, 0x38430000, 0x38432000, 0x38434000, 0x38436000, 0x38438000, 0x3843A000, 0x3843C000, 0x3843E000,
  0x38440000, 0x38442000, 0x38444000, 0x38446000, 0x38448000, 0x3844A000, 0x3844C000, 0x3844E000, 0x38450000, 0x38452000, 0x38454000, 0x38456000, 0x38458000, 0x3845A000, 0x3845C000, 0x3845E000,
  0x38460000, 0x38462000, 0x38464000, 0x38466000, 0x38468000, 0x3846A000, 0x3846C000, 0x3846E000, 0x38470000, 0x38472000, 0x38474000, 0x38476000, 0x38478000, 0x3847A000, 0x3847C000, 0x3847E000,
  0x38480000, 0x38482000, 0x38484000, 0x38486000, 0x38488000, 0x3848A000, 0x3848C000, 0x3848E000, 0x38490000, 0x38492000, 0x38494000, 0x38496000, 0x38498000, 0x3849A000, 0x3849C000, 0x3849E000,
  0x384A0000, 0x384A2000, 0x384A4000, 0x384A6000, 0x384A8000, 0x384AA000, 0x384AC000, 0x384AE000, 0x384B0000, 0x384B2000, 0x384B4000, 0x384B6000, 0x384B8000, 0x384BA000, 0x384BC000, 0x384BE000,
  0x384C0000, 0x384C2000, 0x384C4000, 0x384C6000, 0x384C8000, 0x384CA000, 0x384CC000, 0x384CE000, 0x384D0000, 0x384D2000, 0x384D4000, 0x384D6000, 0x384D8000, 0x384DA000, 0x384DC000, 0x384DE000,
  0x384E0000, 0x384E2000, 0x384E4000, 0x384E6000, 0x384E8000, 0x384EA000, 0x384EC000, 0x384EE000, 0x384F0000, 0x384F2000, 0x384F4000, 0x384F6000, 0x384F8000, 0x384FA000, 0x384FC000, 0x384FE000,
  0x38500000, 0x38502000, 0x38504000, 0x38506000, 0x38508000, 0x3850A000, 0x3850C000, 0x3850E000, 0x38510000, 0x38512000, 0x38514000, 0x38516000, 0x38518000, 0x3851A000, 0x3851C000, 0x3851E000,
  0x38520000, 0x38522000, 0x38524000, 0x38526000, 0x38528000, 0x3852A000, 0x3852C000, 0x3852E000, 0x38530000, 0x38532000, 0x38534000, 0x38536000, 0x38538000, 0x3853A000, 0x3853C000, 0x3853E000,
  0x38540000, 0x38542000, 0x38544000, 0x38546000, 0x38548000, 0x3854A000, 0x3854C000, 0x3854E000, 0x38550000, 0x38552000, 0x38554000, 0x38556000, 0x38558000, 0x3855A000, 0x3855C000, 0x3855E000,
  0x38560000, 0x38562000, 0x38564000, 0x38566000, 0x38568000, 0x3856A000, 0x3856C000, 0x3856E000, 0x38570000, 0x38572000, 0x38574000, 0x38576000, 0x38578000, 0x3857A000, 0x3857C000, 0x3857E000,
  0x38580000, 0x38582000, 0x38584000, 0x38586000, 0x38588000, 0x3858A000, 0x3858C000, 0x3858E000, 0x38590000, 0x38592000, 0x38594000, 0x38596000, 0x38598000, 0x3859A000, 0x3859C000, 0x3859E000,
  0x385A0000, 0x385A2000, 0x385A4000, 0x385A6000, 0x385A8000, 0x385AA000, 0x385AC000, 0x385AE000, 0x385B0000, 0x385B2000, 0x385B4000, 0x385B6000, 0x385B8000, 0x385BA000, 0x385BC000, 0x385BE000,
  0x385C0000, 0x385C2000, 0x385C4000, 0x385C6000, 0x385C8000, 0x385CA000, 0x385CC000, 0x385CE000, 0x385D0000, 0x385D2000, 0x385D4000, 0x385D6000, 0x385D8000, 0x385DA000, 0x385DC000, 0x385DE000,
  0x385E0000, 0x385E2000, 0x385E4000, 0x385E6000, 0x385E8000, 0x385EA000, 0x385EC000, 0x385EE000, 0x385F0000, 0x385F2000, 0x385F4000, 0x385F6000, 0x385F8000, 0x385FA000, 0x385FC000, 0x385FE000,
  0x38600000, 0x38602000, 0x38604000, 0x38606000, 0x38608000, 0x3860A000, 0x3860C000, 0x3860E000, 0x38610000, 0x38612000, 0x38614000, 0x38616000, 0x38618000, 0x3861A000, 0x3861C000, 0x3861E000,
  0x38620000, 0x38622000, 0x38624000, 0x38626000, 0x38628000, 0x3862A000, 0x3862C000, 0x3862E000, 0x38630000, 0x38632000, 0x38634000, 0x38636000, 0x38638000, 0x3863A000, 0x3863C000, 0x3863E000,
  0x38640000, 0x38642000, 0x38644000, 0x38646000, 0x38648000, 0x3864A000, 0x3864C000, 0x3864E000, 0x38650000, 0x38652000, 0x38654000, 0x38656000, 0x38658000, 0x3865A000, 0x3865C000, 0x3865E000,
  0x38660000, 0x38662000, 0x38664000, 0x38666000, 0x38668000, 0x3866A000, 0x3866C000, 0x3866E000, 0x38670000, 0x38672000, 0x38674000, 0x38676000, 0x38678000, 0x3867A000, 0x3867C000, 0x3867E000,
  0x38680000, 0x38682000, 0x38684000, 0x38686000, 0x38688000, 0x3868A000, 0x3868C000, 0x3868E000, 0x38690000, 0x38692000, 0x38694000, 0x38696000, 0x38698000, 0x3869A000, 0x3869C000, 0x3869E000,
  0x386A0000, 0x386A2000, 0x386A4000, 0x386A6000, 0x386A8000, 0x386AA000, 0x386AC000, 0x386AE000, 0x386B0000, 0x386B2000, 0x386B4000, 0x386B6000, 0x386B8000, 0x386BA000, 0x386BC000, 0x386BE000,
  0x386C0000, 0x386C2000, 0x386C4000, 0x386C6000, 0x386C8000, 0x386CA000, 0x386CC000, 0x386CE000, 0x386D0000, 0x386D2000, 0x386D4000, 0x386D6000, 0x386D8000, 0x386DA000, 0x386DC000, 0x386DE000,
  0x386E0000, 0x386E2000, 0x386E4000, 0x386E6000, 0x386E8000, 0x386EA000, 0x386EC000, 0x386EE000, 0x386F0000, 0x386F2000, 0x386F4000, 0x386F6000, 0x386F8000, 0x386FA000, 0x386FC000, 0x386FE000,
  0x38700000, 0x38702000, 0x38704000, 0x38706000, 0x38708000, 0x3870A000, 0x3870C000, 0x3870E000, 0x38710000, 0x38712000, 0x38714000, 0x38716000, 0x38718000, 0x3871A000, 0x3871C000, 0x3871E000,
  0x38720000, 0x38722000, 0x38724000, 0x38726000, 0x38728000, 0x3872A000, 0x3872C000, 0x3872E000, 0x38730000, 0x38732000, 0x38734000, 0x38736000, 0x38738000, 0x3873A000, 0x3873C000, 0x3873E000,
  0x38740000, 0x38742000, 0x38744000, 0x38746000, 0x38748000, 0x3874A000, 0x3874C000, 0x3874E000, 0x38750000, 0x38752000, 0x38754000, 0x38756000, 0x38758000, 0x3875A000, 0x3875C000, 0x3875E000,
  0x38760000, 0x38762000, 0x38764000, 0x38766000, 0x38768000, 0x3876A000, 0x3876C000, 0x3876E000, 0x38770000, 0x38772000, 0x38774000, 0x38776000, 0x38778000, 0x3877A000, 0x3877C000, 0x3877E000,
  0x38780000, 0x38782000, 0x38784000, 0x38786000, 0x38788000, 0x3878A000, 0x3878C000, 0x3878E000, 0x38790000, 0x38792000, 0x38794000, 0x38796000, 0x38798000, 0x3879A000, 0x3879C000, 0x3879E000,
  0x387A0000, 0x387A2000, 0x387A4000, 0x387A6000, 0x387A8000, 0x387AA000, 0x387AC000, 0x387AE000, 0x387B0000, 0x387B2000, 0x387B4000, 0x387B6000, 0x387B8000, 0x387BA000, 0x387BC000, 0x387BE000,
  0x387C0000, 0x387C2000, 0x387C4000, 0x387C6000, 0x387C8000, 0x387CA000, 0x387CC000, 0x387CE000, 0x387D0000, 0x387D2000, 0x387D4000, 0x387D6000, 0x387D8000, 0x387DA000, 0x387DC000, 0x387DE000,
  0x387E0000, 0x387E2000, 0x387E4000, 0x387E6000, 0x387E8000, 0x387EA000, 0x387EC000, 0x387EE000, 0x387F0000, 0x387F2000, 0x387F4000, 0x387F6000, 0x387F8000, 0x387FA000, 0x387FC000, 0x387FE000 };
__constant static const uint32_t exponent_table[64] = {
  0x00000000, 0x00800000, 0x01000000, 0x01800000, 0x02000000, 0x02800000, 0x03000000, 0x03800000, 0x04000000, 0x04800000, 0x05000000, 0x05800000, 0x06000000, 0x06800000, 0x07000000, 0x07800000,
  0x08000000, 0x08800000, 0x09000000, 0x09800000, 0x0A000000, 0x0A800000, 0x0B000000, 0x0B800000, 0x0C000000, 0x0C800000, 0x0D000000, 0x0D800000, 0x0E000000, 0x0E800000, 0x0F000000, 0x47800000,
  0x80000000, 0x80800000, 0x81000000, 0x81800000, 0x82000000, 0x82800000, 0x83000000, 0x83800000, 0x84000000, 0x84800000, 0x85000000, 0x85800000, 0x86000000, 0x86800000, 0x87000000, 0x87800000,
  0x88000000, 0x88800000, 0x89000000, 0x89800000, 0x8A000000, 0x8A800000, 0x8B000000, 0x8B800000, 0x8C000000, 0x8C800000, 0x8D000000, 0x8D800000, 0x8E000000, 0x8E800000, 0x8F000000, 0xC7800000 };
__constant static const unsigned short offset_table[64] = {
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024,
  0, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024 };

SCALAR_FUN_ATTR uint16_t float2halfbits(float value) {
  union { float x; uint32_t y; } u;
  u.x = value;
  uint32_t bits = u.y;

  uint16_t hbits = base_table[bits>>23] + (uint16_t)((bits&0x7FFFFF)>>shift_table[bits>>23]);;

  return hbits;
}

SCALAR_FUN_ATTR float halfbits2float(uint16_t value) {
  uint32_t bits = mantissa_table[offset_table[value>>10]+(value&0x3FF)] + exponent_table[value>>10];

  union { uint32_t x; float y; } u;
  u.x = bits;
  return u.y;
}

SCALAR_FUN_ATTR uint16_t halfbitsnextafter(uint16_t from, uint16_t to) {
  int fabs = from & 0x7FFF, tabs = to & 0x7FFF;
  if(fabs > 0x7C00 || tabs > 0x7C00) {
    return ((from&0x7FFF)>0x7C00) ? (from|0x200) : (to|0x200);
  }
  if(from == to || !(fabs|tabs)) {
    return to;
  }
  if(!fabs) {
    return (to&0x8000)+1;
  }
  unsigned int out =
    from +
    (((from>>15)^(unsigned int)((from^(0x8000|(0x8000-(from>>15))))<(to^(0x8000|(0x8000-(to>>15))))))<<1)
    - 1;
  return out;
}

// End of half.h.
// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

static int64_t get_wall_time_ns(void) {
  return get_wall_time() * 1000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.
// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.
// Start of free_list.h.

typedef uintptr_t fl_mem;

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries; // Pointer to entries.
  int capacity;                    // Number of entries.
  int used;                        // Number of valid entries.
  lock_t lock;                     // Thread safety.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
  create_lock(&l->lock);
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  lock_lock(&l->lock);
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      if (i > p) {
        l->entries[i].valid = 0;
      }
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
  lock_unlock(&l->lock);
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
  free_lock(&l->lock);
}

// Not part of the interface, so no locking.
static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem mem, const char *tag) {
  lock_lock(&l->lock);
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
  lock_unlock(&l->lock);
}

// Determine whether this entry in the free list is acceptable for
// satisfying the request.  Not public, so no locking.
static bool free_list_acceptable(size_t size, const char* tag, struct free_list_entry *entry) {
  // We check not just the hard requirement (is the entry acceptable
  // and big enough?) but also put a cap on how much wasted space
  // (internal fragmentation) we allow.  This is necessarily a
  // heuristic, and a crude one.

  if (!entry->valid) {
    return false;
  }

  if (size > entry->size) {
    return false;
  }

  // We know the block fits.  Now the question is whether it is too
  // big.  Our policy is as follows:
  //
  // 1) We don't care about wasted space below 4096 bytes (to avoid
  // churn in tiny allocations).
  //
  // 2) If the tag matches, we allow _any_ amount of wasted space.
  //
  // 3) Otherwise we allow up to 50% wasted space.

  if (entry->size < 4096) {
    return true;
  }

  if (entry->tag == tag) {
    return true;
  }

  if (entry->size < size * 2) {
    return true;
  }

  return false;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size, const char *tag,
                          size_t *size_out, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int size_match = -1;
  int i;
  int ret = 1;
  for (i = 0; i < l->capacity; i++) {
    if (free_list_acceptable(size, tag, &l->entries[i]) &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    ret = 0;
  }
  lock_unlock(&l->lock);
  return ret;
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem *mem_out) {
  lock_lock(&l->lock);
  int ret = 1;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      ret = 0;
      break;
    }
  }
  lock_unlock(&l->lock);
  return ret;
}

// End of free_list.h.
// Start of event_list.h

typedef int (*event_report_fn)(struct str_builder*, void*);

struct event {
  void* data;
  event_report_fn f;
  const char* name;
  char *description;
};

struct event_list {
  struct event *events;
  int num_events;
  int capacity;
};

static void event_list_init(struct event_list *l) {
  l->capacity = 100;
  l->num_events = 0;
  l->events = calloc(l->capacity, sizeof(struct event));
}

static void event_list_free(struct event_list *l) {
  free(l->events);
}

static void add_event_to_list(struct event_list *l,
                              const char* name,
                              char* description,
                              void* data,
                              event_report_fn f) {
  if (l->num_events == l->capacity) {
    l->capacity *= 2;
    l->events = realloc(l->events, l->capacity * sizeof(struct event));
  }
  l->events[l->num_events].name = name;
  l->events[l->num_events].description = description;
  l->events[l->num_events].data = data;
  l->events[l->num_events].f = f;
  l->num_events++;
}

static int report_events_in_list(struct event_list *l,
                                 struct str_builder* sb) {
  int ret = 0;
  for (int i = 0; i < l->num_events; i++) {
    if (i != 0) {
      str_builder_str(sb, ",");
    }
    str_builder_str(sb, "{\"name\":");
    str_builder_json_str(sb, l->events[i].name);
    str_builder_str(sb, ",\"description\":");
    str_builder_json_str(sb, l->events[i].description);
    free(l->events[i].description);
    if (l->events[i].f(sb, l->events[i].data) != 0) {
      ret = 1;
      break;
    }
    str_builder(sb, "}");
  }
  event_list_free(l);
  event_list_init(l);
  return ret;
}

// End of event_list.h

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <string.h>
#include <errno.h>
#include <assert.h>
#include <ctype.h>



#define FUTHARK_F64_ENABLED

// Start of scalar.h.

// Implementation of the primitive scalar operations.  Very
// repetitive.  This code is inserted directly into both CUDA and
// OpenCL programs, as well as the CPU code, so it has some #ifdefs to
// work everywhere.  Some operations are defined as macros because
// this allows us to use them as constant expressions in things like
// array sizes and static initialisers.

// Some of the #ifdefs are because OpenCL uses type-generic functions
// for some operations (e.g. sqrt), while C and CUDA sensibly use
// distinct functions for different precisions (e.g. sqrtf() and
// sqrt()).  This is quite annoying.  Due to C's unfortunate casting
// rules, it is also really easy to accidentally implement
// floating-point functions in the wrong precision, so be careful.

// Double-precision definitions are only included if the preprocessor
// macro FUTHARK_F64_ENABLED is set.

SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x);
SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x);

SCALAR_FUN_ATTR uint8_t add8(uint8_t x, uint8_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint16_t add16(uint16_t x, uint16_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint32_t add32(uint32_t x, uint32_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint64_t add64(uint64_t x, uint64_t y) {
  return x + y;
}

SCALAR_FUN_ATTR uint8_t sub8(uint8_t x, uint8_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint16_t sub16(uint16_t x, uint16_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint32_t sub32(uint32_t x, uint32_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint64_t sub64(uint64_t x, uint64_t y) {
  return x - y;
}

SCALAR_FUN_ATTR uint8_t mul8(uint8_t x, uint8_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint16_t mul16(uint16_t x, uint16_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint32_t mul32(uint32_t x, uint32_t y) {
  return x * y;
}

SCALAR_FUN_ATTR uint64_t mul64(uint64_t x, uint64_t y) {
  return x * y;
}

#if ISPC

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  // This strange pattern is used to prevent the ISPC compiler from
  // causing SIGFPEs and bogus results on divisions where inactive lanes
  // have 0-valued divisors. It ensures that any inactive lane instead
  // has a divisor of 1. https://github.com/ispc/ispc/issues/2292
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }


  return x % ys;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : (x + y - 1) / ys;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  uint8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  uint16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  uint32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  uint64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t q = x / ys;
  int8_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t q = x / ys;
  int16_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }
  int32_t q = x / ys;
  int32_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t q = x / ys;
  int64_t r = x % ys;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int8_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int16_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int32_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  int64_t r = x % ys;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x / ys;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return x % ys;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x / ys;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  int8_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  int16_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  int32_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  int64_t ys = 1;
  foreach_active(i){
    ys = y;
  }

  return y == 0 ? 0 : x % ys;
}

#else

SCALAR_FUN_ATTR uint8_t udiv8(uint8_t x, uint8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint16_t udiv16(uint16_t x, uint16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint32_t udiv32(uint32_t x, uint32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint64_t udiv64(uint64_t x, uint64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up8(uint8_t x, uint8_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up16(uint16_t x, uint16_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up32(uint32_t x, uint32_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up64(uint64_t x, uint64_t y) {
  return (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod8(uint8_t x, uint8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint16_t umod16(uint16_t x, uint16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint32_t umod32(uint32_t x, uint32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint64_t umod64(uint64_t x, uint64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR uint8_t udiv_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint16_t udiv_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint32_t udiv_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint64_t udiv_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR uint8_t udiv_up_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint16_t udiv_up_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint32_t udiv_up_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint64_t udiv_up_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : (x + y - 1) / y;
}

SCALAR_FUN_ATTR uint8_t umod_safe8(uint8_t x, uint8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint16_t umod_safe16(uint16_t x, uint16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint32_t umod_safe32(uint32_t x, uint32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR uint64_t umod_safe64(uint64_t x, uint64_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int8_t sdiv8(int8_t x, int8_t y) {
  int8_t q = x / y;
  int8_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int16_t sdiv16(int16_t x, int16_t y) {
  int16_t q = x / y;
  int16_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int32_t sdiv32(int32_t x, int32_t y) {
  int32_t q = x / y;
  int32_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int64_t sdiv64(int64_t x, int64_t y) {
  int64_t q = x / y;
  int64_t r = x % y;

  return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}

SCALAR_FUN_ATTR int8_t sdiv_up8(int8_t x, int8_t y) {
  return sdiv8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up16(int16_t x, int16_t y) {
  return sdiv16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up32(int32_t x, int32_t y) {
  return sdiv32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up64(int64_t x, int64_t y) {
  return sdiv64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod8(int8_t x, int8_t y) {
  int8_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int16_t smod16(int16_t x, int16_t y) {
  int16_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int32_t smod32(int32_t x, int32_t y) {
  int32_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int64_t smod64(int64_t x, int64_t y) {
  int64_t r = x % y;

  return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}

SCALAR_FUN_ATTR int8_t sdiv_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : sdiv8(x, y);
}

SCALAR_FUN_ATTR int16_t sdiv_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : sdiv16(x, y);
}

SCALAR_FUN_ATTR int32_t sdiv_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : sdiv32(x, y);
}

SCALAR_FUN_ATTR int64_t sdiv_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : sdiv64(x, y);
}

SCALAR_FUN_ATTR int8_t sdiv_up_safe8(int8_t x, int8_t y) {
  return sdiv_safe8(x + y - 1, y);
}

SCALAR_FUN_ATTR int16_t sdiv_up_safe16(int16_t x, int16_t y) {
  return sdiv_safe16(x + y - 1, y);
}

SCALAR_FUN_ATTR int32_t sdiv_up_safe32(int32_t x, int32_t y) {
  return sdiv_safe32(x + y - 1, y);
}

SCALAR_FUN_ATTR int64_t sdiv_up_safe64(int64_t x, int64_t y) {
  return sdiv_safe64(x + y - 1, y);
}

SCALAR_FUN_ATTR int8_t smod_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : smod8(x, y);
}

SCALAR_FUN_ATTR int16_t smod_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : smod16(x, y);
}

SCALAR_FUN_ATTR int32_t smod_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : smod32(x, y);
}

SCALAR_FUN_ATTR int64_t smod_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : smod64(x, y);
}

SCALAR_FUN_ATTR int8_t squot8(int8_t x, int8_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int16_t squot16(int16_t x, int16_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int32_t squot32(int32_t x, int32_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int64_t squot64(int64_t x, int64_t y) {
  return x / y;
}

SCALAR_FUN_ATTR int8_t srem8(int8_t x, int8_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int16_t srem16(int16_t x, int16_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int32_t srem32(int32_t x, int32_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int64_t srem64(int64_t x, int64_t y) {
  return x % y;
}

SCALAR_FUN_ATTR int8_t squot_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int16_t squot_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int32_t squot_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int64_t squot_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x / y;
}

SCALAR_FUN_ATTR int8_t srem_safe8(int8_t x, int8_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int16_t srem_safe16(int16_t x, int16_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int32_t srem_safe32(int32_t x, int32_t y) {
  return y == 0 ? 0 : x % y;
}

SCALAR_FUN_ATTR int64_t srem_safe64(int64_t x, int64_t y) {
  return y == 0 ? 0 : x % y;
}

#endif

SCALAR_FUN_ATTR int8_t smin8(int8_t x, int8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int16_t smin16(int16_t x, int16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int32_t smin32(int32_t x, int32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int64_t smin64(int64_t x, int64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint8_t umin8(uint8_t x, uint8_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint16_t umin16(uint16_t x, uint16_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint32_t umin32(uint32_t x, uint32_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR uint64_t umin64(uint64_t x, uint64_t y) {
  return x < y ? x : y;
}

SCALAR_FUN_ATTR int8_t smax8(int8_t x, int8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int16_t smax16(int16_t x, int16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int32_t smax32(int32_t x, int32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR int64_t smax64(int64_t x, int64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t umax8(uint8_t x, uint8_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint16_t umax16(uint16_t x, uint16_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint32_t umax32(uint32_t x, uint32_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint64_t umax64(uint64_t x, uint64_t y) {
  return x < y ? y : x;
}

SCALAR_FUN_ATTR uint8_t shl8(uint8_t x, uint8_t y) {
  return (uint8_t)(x << y);
}

SCALAR_FUN_ATTR uint16_t shl16(uint16_t x, uint16_t y) {
  return (uint16_t)(x << y);
}

SCALAR_FUN_ATTR uint32_t shl32(uint32_t x, uint32_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint64_t shl64(uint64_t x, uint64_t y) {
  return x << y;
}

SCALAR_FUN_ATTR uint8_t lshr8(uint8_t x, uint8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint16_t lshr16(uint16_t x, uint16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint32_t lshr32(uint32_t x, uint32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint64_t lshr64(uint64_t x, uint64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int8_t ashr8(int8_t x, int8_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int16_t ashr16(int16_t x, int16_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int32_t ashr32(int32_t x, int32_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR int64_t ashr64(int64_t x, int64_t y) {
  return x >> y;
}

SCALAR_FUN_ATTR uint8_t and8(uint8_t x, uint8_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint16_t and16(uint16_t x, uint16_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint32_t and32(uint32_t x, uint32_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint64_t and64(uint64_t x, uint64_t y) {
  return x & y;
}

SCALAR_FUN_ATTR uint8_t or8(uint8_t x, uint8_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint16_t or16(uint16_t x, uint16_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint32_t or32(uint32_t x, uint32_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint64_t or64(uint64_t x, uint64_t y) {
  return x | y;
}

SCALAR_FUN_ATTR uint8_t xor8(uint8_t x, uint8_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint16_t xor16(uint16_t x, uint16_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint32_t xor32(uint32_t x, uint32_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR uint64_t xor64(uint64_t x, uint64_t y) {
  return x ^ y;
}

SCALAR_FUN_ATTR bool ult8(uint8_t x, uint8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult16(uint16_t x, uint16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult32(uint32_t x, uint32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ult64(uint64_t x, uint64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool ule8(uint8_t x, uint8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule16(uint16_t x, uint16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule32(uint32_t x, uint32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool ule64(uint64_t x, uint64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool slt8(int8_t x, int8_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt16(int16_t x, int16_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt32(int32_t x, int32_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool slt64(int64_t x, int64_t y) {
  return x < y;
}

SCALAR_FUN_ATTR bool sle8(int8_t x, int8_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle16(int16_t x, int16_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle32(int32_t x, int32_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR bool sle64(int64_t x, int64_t y) {
  return x <= y;
}

SCALAR_FUN_ATTR uint8_t pow8(uint8_t x, uint8_t y) {
  uint8_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint16_t pow16(uint16_t x, uint16_t y) {
  uint16_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint32_t pow32(uint32_t x, uint32_t y) {
  uint32_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR uint64_t pow64(uint64_t x, uint64_t y) {
  uint64_t res = 1, rem = y;

  while (rem != 0) {
    if (rem & 1)
      res *= x;
    rem >>= 1;
    x *= x;
  }
  return res;
}

SCALAR_FUN_ATTR bool itob_i8_bool(int8_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i16_bool(int16_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i32_bool(int32_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR bool itob_i64_bool(int64_t x) {
  return x != 0;
}

SCALAR_FUN_ATTR int8_t btoi_bool_i8(bool x) {
  return x;
}

SCALAR_FUN_ATTR int16_t btoi_bool_i16(bool x) {
  return x;
}

SCALAR_FUN_ATTR int32_t btoi_bool_i32(bool x) {
  return x;
}

SCALAR_FUN_ATTR int64_t btoi_bool_i64(bool x) {
  return x;
}

#define sext_i8_i8(x) ((int8_t) (int8_t) (x))
#define sext_i8_i16(x) ((int16_t) (int8_t) (x))
#define sext_i8_i32(x) ((int32_t) (int8_t) (x))
#define sext_i8_i64(x) ((int64_t) (int8_t) (x))
#define sext_i16_i8(x) ((int8_t) (int16_t) (x))
#define sext_i16_i16(x) ((int16_t) (int16_t) (x))
#define sext_i16_i32(x) ((int32_t) (int16_t) (x))
#define sext_i16_i64(x) ((int64_t) (int16_t) (x))
#define sext_i32_i8(x) ((int8_t) (int32_t) (x))
#define sext_i32_i16(x) ((int16_t) (int32_t) (x))
#define sext_i32_i32(x) ((int32_t) (int32_t) (x))
#define sext_i32_i64(x) ((int64_t) (int32_t) (x))
#define sext_i64_i8(x) ((int8_t) (int64_t) (x))
#define sext_i64_i16(x) ((int16_t) (int64_t) (x))
#define sext_i64_i32(x) ((int32_t) (int64_t) (x))
#define sext_i64_i64(x) ((int64_t) (int64_t) (x))
#define zext_i8_i8(x) ((int8_t) (uint8_t) (x))
#define zext_i8_i16(x) ((int16_t) (uint8_t) (x))
#define zext_i8_i32(x) ((int32_t) (uint8_t) (x))
#define zext_i8_i64(x) ((int64_t) (uint8_t) (x))
#define zext_i16_i8(x) ((int8_t) (uint16_t) (x))
#define zext_i16_i16(x) ((int16_t) (uint16_t) (x))
#define zext_i16_i32(x) ((int32_t) (uint16_t) (x))
#define zext_i16_i64(x) ((int64_t) (uint16_t) (x))
#define zext_i32_i8(x) ((int8_t) (uint32_t) (x))
#define zext_i32_i16(x) ((int16_t) (uint32_t) (x))
#define zext_i32_i32(x) ((int32_t) (uint32_t) (x))
#define zext_i32_i64(x) ((int64_t) (uint32_t) (x))
#define zext_i64_i8(x) ((int8_t) (uint64_t) (x))
#define zext_i64_i16(x) ((int16_t) (uint64_t) (x))
#define zext_i64_i32(x) ((int32_t) (uint64_t) (x))
#define zext_i64_i64(x) ((int64_t) (uint64_t) (x))

SCALAR_FUN_ATTR int8_t abs8(int8_t x) {
  return (int8_t)abs(x);
}

SCALAR_FUN_ATTR int16_t abs16(int16_t x) {
  return (int16_t)abs(x);
}

SCALAR_FUN_ATTR int32_t abs32(int32_t x) {
  return abs(x);
}

SCALAR_FUN_ATTR int64_t abs64(int64_t x) {
#if defined(__OPENCL_VERSION__) || defined(ISPC)
  return abs(x);
#else
  return llabs(x);
#endif
}

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return popcount(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return popcount(x);
}
#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_popc8(int8_t x) {
  return __popc(zext_i8_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc16(int16_t x) {
  return __popc(zext_i16_i32(x));
}

SCALAR_FUN_ATTR int32_t futrts_popc32(int32_t x) {
  return __popc(x);
}

SCALAR_FUN_ATTR int32_t futrts_popc64(int64_t x) {
  return __popcll(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_popc8(uint8_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc16(uint16_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc32(uint32_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}

SCALAR_FUN_ATTR int32_t futrts_popc64(uint64_t x) {
  int c = 0;
  for (; x; ++c) { x &= x - 1; }
  return c;
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR uint8_t  futrts_umul_hi8 ( uint8_t a,  uint8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint8_t  futrts_smul_hi8 ( int8_t a,  int8_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return mul_hi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return mul_hi(a, b); }
#elif defined(__CUDA_ARCH__)
SCALAR_FUN_ATTR  uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return __umulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return __umul64hi(a, b); }
SCALAR_FUN_ATTR  uint8_t futrts_smul_hi8 ( int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_smul_hi32(int32_t a, int32_t b) { return __mulhi(a, b); }
SCALAR_FUN_ATTR uint64_t futrts_smul_hi64(int64_t a, int64_t b) { return __mul64hi(a, b); }
#elif ISPC
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 = al * bl;
  uint64_t p2 = al * bh;
  uint64_t p3 = ah * bl;
  uint64_t p4 = ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}
SCALAR_FUN_ATTR  int8_t futrts_smul_hi8 ( int8_t a,  int8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) {
  uint64_t ah = a >> 32;
  uint64_t al = a & 0xffffffff;
  uint64_t bh = b >> 32;
  uint64_t bl = b & 0xffffffff;

  uint64_t p1 =  al * bl;
  int64_t  p2 = al * bh;
  int64_t  p3 = ah * bl;
  uint64_t p4 =  ah * bh;

  uint64_t p1h = p1 >> 32;
  uint64_t p2h = p2 >> 32;
  uint64_t p3h = p3 >> 32;
  uint64_t p2l = p2 & 0xffffffff;
  uint64_t p3l = p3 & 0xffffffff;

  uint64_t l = p1h + p2l + p3l;
  uint64_t m = (p2 >> 32) + (p3 >> 32);
  uint64_t h = (l >> 32) + m + p4;

  return h;
}

#else // Not OpenCL, ISPC, or CUDA, but plain C.
SCALAR_FUN_ATTR uint8_t futrts_umul_hi8(uint8_t a, uint8_t b) { return ((uint16_t)a) * ((uint16_t)b) >> 8; }
SCALAR_FUN_ATTR uint16_t futrts_umul_hi16(uint16_t a, uint16_t b) { return ((uint32_t)a) * ((uint32_t)b) >> 16; }
SCALAR_FUN_ATTR uint32_t futrts_umul_hi32(uint32_t a, uint32_t b) { return ((uint64_t)a) * ((uint64_t)b) >> 32; }
SCALAR_FUN_ATTR uint64_t futrts_umul_hi64(uint64_t a, uint64_t b) { return ((__uint128_t)a) * ((__uint128_t)b) >> 64; }
SCALAR_FUN_ATTR int8_t futrts_smul_hi8(int8_t a, int8_t b) { return ((int16_t)a) * ((int16_t)b) >> 8; }
SCALAR_FUN_ATTR int16_t futrts_smul_hi16(int16_t a, int16_t b) { return ((int32_t)a) * ((int32_t)b) >> 16; }
SCALAR_FUN_ATTR int32_t futrts_smul_hi32(int32_t a, int32_t b) { return ((int64_t)a) * ((int64_t)b) >> 32; }
SCALAR_FUN_ATTR int64_t futrts_smul_hi64(int64_t a, int64_t b) { return ((__int128_t)a) * ((__int128_t)b) >> 64; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8 ( uint8_t a,  uint8_t b,  uint8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8( int8_t a,  int8_t b,   int8_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return mad_hi(a, b, c); }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return mad_hi(a, b, c); }
#else // Not OpenCL

SCALAR_FUN_ATTR  uint8_t futrts_umad_hi8( uint8_t a,  uint8_t b,  uint8_t c) { return futrts_umul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_umad_hi16(uint16_t a, uint16_t b, uint16_t c) { return futrts_umul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_umad_hi32(uint32_t a, uint32_t b, uint32_t c) { return futrts_umul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_umad_hi64(uint64_t a, uint64_t b, uint64_t c) { return futrts_umul_hi64(a, b) + c; }
SCALAR_FUN_ATTR  uint8_t futrts_smad_hi8 ( int8_t a,  int8_t b,  int8_t c) { return futrts_smul_hi8(a, b) + c; }
SCALAR_FUN_ATTR uint16_t futrts_smad_hi16(int16_t a, int16_t b, int16_t c) { return futrts_smul_hi16(a, b) + c; }
SCALAR_FUN_ATTR uint32_t futrts_smad_hi32(int32_t a, int32_t b, int32_t c) { return futrts_smul_hi32(a, b) + c; }
SCALAR_FUN_ATTR uint64_t futrts_smad_hi64(int64_t a, int64_t b, int64_t c) { return futrts_smul_hi64(a, b) + c; }
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return clz(x);
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return __clz(zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return __clz(zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return __clz(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return __clzll(x);
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return count_leading_zeros((int32_t)(uint8_t)x)-24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return count_leading_zeros((int32_t)(uint16_t)x)-16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return count_leading_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return count_leading_zeros(x);
}

#else // Not OpenCL, ISPC or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_clzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_clz((uint32_t)zext_i8_i32(x)) - 24;
}

SCALAR_FUN_ATTR int32_t futrts_clzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_clz((uint32_t)zext_i16_i32(x)) - 16;
}

SCALAR_FUN_ATTR int32_t futrts_clzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_clz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_clzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_clzll((uint64_t)x);
}
#endif

#if defined(__OPENCL_VERSION__)
SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int i = 0;
  for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int i = 0;
  for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int i = 0;
  for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int i = 0;
  for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
    ;
  return i;
}

#elif defined(__CUDA_ARCH__)

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  int y = __ffs(x);
  return y == 0 ? 8 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  int y = __ffs(x);
  return y == 0 ? 16 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  int y = __ffs(x);
  return y == 0 ? 32 : y - 1;
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  int y = __ffsll(x);
  return y == 0 ? 64 : y - 1;
}

#elif ISPC

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : count_trailing_zeros((int32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return count_trailing_zeros(x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return count_trailing_zeros(x);
}

#else // Not OpenCL or CUDA, but plain C.

SCALAR_FUN_ATTR int32_t futrts_ctzz8(int8_t x) {
  return x == 0 ? 8 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz16(int16_t x) {
  return x == 0 ? 16 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz32(int32_t x) {
  return x == 0 ? 32 : __builtin_ctz((uint32_t)x);
}

SCALAR_FUN_ATTR int32_t futrts_ctzz64(int64_t x) {
  return x == 0 ? 64 : __builtin_ctzll((uint64_t)x);
}
#endif

SCALAR_FUN_ATTR float fdiv32(float x, float y) {
  return x / y;
}

SCALAR_FUN_ATTR float fadd32(float x, float y) {
  return x + y;
}

SCALAR_FUN_ATTR float fsub32(float x, float y) {
  return x - y;
}

SCALAR_FUN_ATTR float fmul32(float x, float y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt32(float x, float y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple32(float x, float y) {
  return x <= y;
}

SCALAR_FUN_ATTR float sitofp_i8_f32(int8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i16_f32(int16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i32_f32(int32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float sitofp_i64_f32(int64_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i8_f32(uint8_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i16_f32(uint16_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i32_f32(uint32_t x) {
  return (float) x;
}

SCALAR_FUN_ATTR float uitofp_i64_f32(uint64_t x) {
  return (float) x;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float fabs32(float x) {
  return fabs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return pow(x, y);
}

#elif ISPC

SCALAR_FUN_ATTR float fabs32(float x) {
  return abs(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR float fpow32(float a, float b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

#else // Not OpenCL, but CUDA or plain C.

SCALAR_FUN_ATTR float fabs32(float x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR float fmax32(float x, float y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR float fmin32(float x, float y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR float fpow32(float x, float y) {
  return powf(x, y);
}
#endif

SCALAR_FUN_ATTR bool futrts_isnan32(float x) {
  return isnan(x);
}

#if ISPC

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite32(float x) {
  return !isnan(x) && !futrts_isinf32(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf32(float x) {
  return isinf(x);
}

#endif

SCALAR_FUN_ATTR int8_t fptosi_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (int64_t) x;
  };
}

SCALAR_FUN_ATTR uint8_t fptoui_f32_i8(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f32_i16(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f32_i32(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f32_i64(float x) {
  if (futrts_isnan32(x) || futrts_isinf32(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f32_bool(float x) {
  return x != 0;
}

SCALAR_FUN_ATTR float btof_bool_f32(bool x) {
  return x ? 1 : 0;
}

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR float futrts_log32(float x) {
  return log(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1p(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return cosh(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinh(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanh(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acosh(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinh(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanh(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erf(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfc(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rint(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fma(a, b, c);
}

#elif ISPC

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return futrts_isfinite32(x) || (futrts_isinf32(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return futrts_log32(x) / log(2.0f);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return futrts_log32(x) / log(10.0f);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  if(x == -1.0f || (futrts_isinf32(x) && x > 0.0f)) return x / 0.0f;
  float y = 1.0f + x;
  float z = y - 1.0f;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrt(x);
}

extern "C" unmasked uniform float cbrtf(uniform float);
SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return exp(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cos(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sin(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tan(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acos(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asin(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atan(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return (exp(x)+exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return (exp(x)-exp(-x)) / 2.0f;
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return futrts_sinh32(x)/futrts_cosh32(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  float f = x+sqrt(x*x-1);
  if(futrts_isfinite32(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  float f = x+sqrt(x*x+1);
  if(futrts_isfinite32(f)) return log(f);
  return f;

}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  float f = (1+x)/(1-x);
  if(futrts_isfinite32(f)) return log(f)/2.0f;
  return f;

}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return (x == 0.0f && y == 0.0f) ? 0.0f : atan2(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  if (futrts_isfinite32(x) && futrts_isfinite32(y)) {
    x = abs(x);
    y = abs(y);
    float a;
    float b;
    if (x >= y){
        a = x;
        b = y;
    } else {
        a = y;
        b = x;
    }
    if(b == 0){
      return a;
    }

    int e;
    float an;
    float bn;
    an = frexp (a, &e);
    bn = ldexp (b, - e);
    float cn;
    cn = sqrt (an * an + bn * bn);
    return ldexp (cn, e);
  } else {
    if (futrts_isinf32(x) || futrts_isinf32(y)) return INFINITY;
    else return x + y;
  }

}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = tgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = lgammaf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erff(uniform float x);
SCALAR_FUN_ATTR float futrts_erf32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erff(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float erfcf(uniform float x);
SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  float res;
  foreach_active (i) {
    uniform float r = erfcf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return round(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floor(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceil(x);
}

extern "C" unmasked uniform float nextafterf(uniform float x, uniform float y);
SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  float res;
  foreach_active (i) {
    uniform float r = nextafterf(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  int32_t xb = futrts_to_bits32(x);
  int32_t yb = futrts_to_bits32(y);
  return futrts_from_bits32((xb & ~(1<<31)) | (yb & (1<<31)));
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return a * b + c;
}

#else // Not OpenCL or ISPC, but CUDA or plain C.

SCALAR_FUN_ATTR float futrts_log32(float x) {
  return logf(x);
}

SCALAR_FUN_ATTR float futrts_log2_32(float x) {
  return log2f(x);
}

SCALAR_FUN_ATTR float futrts_log10_32(float x) {
  return log10f(x);
}

SCALAR_FUN_ATTR float futrts_log1p_32(float x) {
  return log1pf(x);
}

SCALAR_FUN_ATTR float futrts_sqrt32(float x) {
  return sqrtf(x);
}

SCALAR_FUN_ATTR float futrts_cbrt32(float x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR float futrts_exp32(float x) {
  return expf(x);
}

SCALAR_FUN_ATTR float futrts_cos32(float x) {
  return cosf(x);
}

SCALAR_FUN_ATTR float futrts_sin32(float x) {
  return sinf(x);
}

SCALAR_FUN_ATTR float futrts_tan32(float x) {
  return tanf(x);
}

SCALAR_FUN_ATTR float futrts_acos32(float x) {
  return acosf(x);
}

SCALAR_FUN_ATTR float futrts_asin32(float x) {
  return asinf(x);
}

SCALAR_FUN_ATTR float futrts_atan32(float x) {
  return atanf(x);
}

SCALAR_FUN_ATTR float futrts_cosh32(float x) {
  return coshf(x);
}

SCALAR_FUN_ATTR float futrts_sinh32(float x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR float futrts_tanh32(float x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR float futrts_acosh32(float x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR float futrts_asinh32(float x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR float futrts_atanh32(float x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR float futrts_atan2_32(float x, float y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR float futrts_hypot32(float x, float y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR float futrts_gamma32(float x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR float futrts_lgamma32(float x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR float futrts_erf32(float x) {
  return erff(x);
}

SCALAR_FUN_ATTR float futrts_erfc32(float x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR float fmod32(float x, float y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR float futrts_round32(float x) {
  return rintf(x);
}

SCALAR_FUN_ATTR float futrts_floor32(float x) {
  return floorf(x);
}

SCALAR_FUN_ATTR float futrts_ceil32(float x) {
  return ceilf(x);
}

SCALAR_FUN_ATTR float futrts_nextafter32(float x, float y) {
  return nextafterf(x, y);
}

SCALAR_FUN_ATTR float futrts_lerp32(float v0, float v1, float t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR float futrts_ldexp32(float x, int32_t y) {
  return ldexpf(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign32(float x, float y) {
  return copysignf(x, y);
}

SCALAR_FUN_ATTR float futrts_mad32(float a, float b, float c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float futrts_fma32(float a, float b, float c) {
  return fmaf(a, b, c);
}
#endif

#if ISPC
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  return intbits(x);
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  return floatbits(x);
}
#else
SCALAR_FUN_ATTR int32_t futrts_to_bits32(float x) {
  union {
    float f;
    int32_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR float futrts_from_bits32(int32_t x) {
  union {
    int32_t f;
    float t;
  } p;

  p.f = x;
  return p.t;
}
#endif

SCALAR_FUN_ATTR float fsignum32(float x) {
  return futrts_isnan32(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x);
SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x);

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf64(float x) {
  return !isnan(x) && isnan(x - x);
}

SCALAR_FUN_ATTR bool futrts_isfinite64(float x) {
  return !isnan(x) && !futrts_isinf64(x);
}

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return abs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return isnan(x) ? y : isnan(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR double fpow64(double a, double b) {
  float ret;
  foreach_active (i) {
      uniform float r = __stdlib_powf(extract(a, i), extract(b, i));
      ret = insert(ret, i, r);
  }
  return ret;
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return futrts_isfinite64(x) || (futrts_isinf64(x) && x < 0)? log(x) : x;
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return futrts_log64(x)/log(2.0d);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return futrts_log64(x)/log(10.0d);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  if(x == -1.0d || (futrts_isinf64(x) && x > 0.0d)) return x / 0.0d;
  double y = 1.0d + x;
  double z = y - 1.0d;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

extern "C" unmasked uniform double cbrt(uniform double);
SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = cbrtf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return (exp(x)+exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return (exp(x)-exp(-x)) / 2.0d;
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return futrts_sinh64(x)/futrts_cosh64(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  double f = x+sqrt(x*x-1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  double f = x+sqrt(x*x+1.0d);
  if(futrts_isfinite64(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  double f = (1.0d+x)/(1.0d-x);
  if(futrts_isfinite64(f)) return log(f)/2.0d;
  return f;

}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

extern "C" unmasked uniform double hypot(uniform double x, uniform double y);
SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = hypot(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double tgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = tgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double lgamma(uniform double x);
SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = lgamma(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erf(uniform double x);
SCALAR_FUN_ATTR double futrts_erf64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erf(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform double erfc(uniform double x);
SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  double res;
  foreach_active (i) {
    uniform double r = erfc(extract(x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return round(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

extern "C" unmasked uniform double nextafter(uniform float x, uniform double y);
SCALAR_FUN_ATTR float futrts_nextafter64(double x, double y) {
  double res;
  foreach_active (i) {
    uniform double r = nextafter(extract(x, i), extract(y, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0.0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1.0 : 0.0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  int64_t res;
  foreach_active (i) {
    uniform double tmp = extract(x, i);
    uniform int64_t r = *((uniform int64_t* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  double res;
  foreach_active (i) {
    uniform int64_t tmp = extract(x, i);
    uniform double r = *((uniform double* uniform)&tmp);
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return x - y * trunc(x/y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0 ? 1.0d : 0.0d) - (x < 0 ? 1.0d : 0.0d);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return x * pow((double)2.0, (double)y);
}

SCALAR_FUN_ATTR double futrts_copysign64(double x, double y) {
  int64_t xb = futrts_to_bits64(x);
  int64_t yb = futrts_to_bits64(y);
  return futrts_from_bits64((xb & ~(((int64_t)1)<<63)) | (yb & (((int64_t)1)<<63)));
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
  return a * b + c;
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#else

SCALAR_FUN_ATTR double fdiv64(double x, double y) {
  return x / y;
}

SCALAR_FUN_ATTR double fadd64(double x, double y) {
  return x + y;
}

SCALAR_FUN_ATTR double fsub64(double x, double y) {
  return x - y;
}

SCALAR_FUN_ATTR double fmul64(double x, double y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt64(double x, double y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple64(double x, double y) {
  return x <= y;
}

SCALAR_FUN_ATTR double sitofp_i8_f64(int8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i16_f64(int16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i32_f64(int32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double sitofp_i64_f64(int64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i8_f64(uint8_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i16_f64(uint16_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i32_f64(uint32_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double uitofp_i64_f64(uint64_t x) {
  return (double) x;
}

SCALAR_FUN_ATTR double fabs64(double x) {
  return fabs(x);
}

SCALAR_FUN_ATTR double fmax64(double x, double y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR double fmin64(double x, double y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR double fpow64(double x, double y) {
  return pow(x, y);
}

SCALAR_FUN_ATTR double futrts_log64(double x) {
  return log(x);
}

SCALAR_FUN_ATTR double futrts_log2_64(double x) {
  return log2(x);
}

SCALAR_FUN_ATTR double futrts_log10_64(double x) {
  return log10(x);
}

SCALAR_FUN_ATTR double futrts_log1p_64(double x) {
  return log1p(x);
}

SCALAR_FUN_ATTR double futrts_sqrt64(double x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR double futrts_cbrt64(double x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR double futrts_exp64(double x) {
  return exp(x);
}

SCALAR_FUN_ATTR double futrts_cos64(double x) {
  return cos(x);
}

SCALAR_FUN_ATTR double futrts_sin64(double x) {
  return sin(x);
}

SCALAR_FUN_ATTR double futrts_tan64(double x) {
  return tan(x);
}

SCALAR_FUN_ATTR double futrts_acos64(double x) {
  return acos(x);
}

SCALAR_FUN_ATTR double futrts_asin64(double x) {
  return asin(x);
}

SCALAR_FUN_ATTR double futrts_atan64(double x) {
  return atan(x);
}

SCALAR_FUN_ATTR double futrts_cosh64(double x) {
  return cosh(x);
}

SCALAR_FUN_ATTR double futrts_sinh64(double x) {
  return sinh(x);
}

SCALAR_FUN_ATTR double futrts_tanh64(double x) {
  return tanh(x);
}

SCALAR_FUN_ATTR double futrts_acosh64(double x) {
  return acosh(x);
}

SCALAR_FUN_ATTR double futrts_asinh64(double x) {
  return asinh(x);
}

SCALAR_FUN_ATTR double futrts_atanh64(double x) {
  return atanh(x);
}

SCALAR_FUN_ATTR double futrts_atan2_64(double x, double y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR double futrts_hypot64(double x, double y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR double futrts_gamma64(double x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR double futrts_lgamma64(double x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR double futrts_erf64(double x) {
  return erf(x);
}

SCALAR_FUN_ATTR double futrts_erfc64(double x) {
  return erfc(x);
}

SCALAR_FUN_ATTR double futrts_fma64(double a, double b, double c) {
  return fma(a, b, c);
}

SCALAR_FUN_ATTR double futrts_round64(double x) {
  return rint(x);
}

SCALAR_FUN_ATTR double futrts_ceil64(double x) {
  return ceil(x);
}

SCALAR_FUN_ATTR float futrts_nextafter64(float x, float y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR double futrts_floor64(double x) {
  return floor(x);
}

SCALAR_FUN_ATTR bool futrts_isnan64(double x) {
  return isnan(x);
}

SCALAR_FUN_ATTR bool futrts_isinf64(double x) {
  return isinf(x);
}

SCALAR_FUN_ATTR int8_t fptosi_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int8_t) x;
  }
}

SCALAR_FUN_ATTR int16_t fptosi_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int16_t) x;
  }
}

SCALAR_FUN_ATTR int32_t fptosi_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int32_t) x;
  }
}

SCALAR_FUN_ATTR int64_t fptosi_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (int64_t) x;
  }
}

SCALAR_FUN_ATTR uint8_t fptoui_f64_i8(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint8_t) (int8_t) x;
  }
}

SCALAR_FUN_ATTR uint16_t fptoui_f64_i16(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint16_t) (int16_t) x;
  }
}

SCALAR_FUN_ATTR uint32_t fptoui_f64_i32(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint32_t) (int32_t) x;
  }
}

SCALAR_FUN_ATTR uint64_t fptoui_f64_i64(double x) {
  if (futrts_isnan64(x) || futrts_isinf64(x)) {
    return 0;
  } else {
    return (uint64_t) (int64_t) x;
  }
}

SCALAR_FUN_ATTR bool ftob_f64_bool(double x) {
  return x != 0;
}

SCALAR_FUN_ATTR double btof_bool_f64(bool x) {
  return x ? 1 : 0;
}

SCALAR_FUN_ATTR int64_t futrts_to_bits64(double x) {
  union {
    double f;
    int64_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double futrts_from_bits64(int64_t x) {
  union {
    int64_t f;
    double t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR double fmod64(double x, double y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR double fsignum64(double x) {
  return futrts_isnan64(x) ? x : (x > 0) - (x < 0);
}

SCALAR_FUN_ATTR double futrts_lerp64(double v0, double v1, double t) {
#ifdef __OPENCL_VERSION__
  return mix(v0, v1, t);
#else
  return v0 + (v1 - v0) * t;
#endif
}

SCALAR_FUN_ATTR double futrts_ldexp64(double x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR float futrts_copysign64(double x, double y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR double futrts_mad64(double a, double b, double c) {
#ifdef __OPENCL_VERSION__
  return mad(a, b, c);
#else
  return a * b + c;
#endif
}

SCALAR_FUN_ATTR float fpconv_f32_f32(float x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f32_f64(float x) {
  return (double) x;
}

SCALAR_FUN_ATTR float fpconv_f64_f32(double x) {
  return (float) x;
}

SCALAR_FUN_ATTR double fpconv_f64_f64(double x) {
  return (double) x;
}

#endif

#endif

// End of scalar.h.
// Start of scalar_f16.h.

// Half-precision is emulated if needed (e.g. in straight C) with the
// native type used if possible.  The emulation works by typedef'ing
// 'float' to 'f16', and then implementing all operations on single
// precision.  To cut down on duplication, we use the same code for
// those Futhark functions that require just operators or casts.  The
// in-memory representation for arrays will still be 16 bits even
// under emulation, so the compiler will have to be careful when
// generating reads or writes.

#if !defined(cl_khr_fp16) && !(defined(__CUDA_ARCH__) && __CUDA_ARCH__ >= 600) && !(defined(ISPC))
#define EMULATE_F16
#endif

#if !defined(EMULATE_F16) && defined(__OPENCL_VERSION__)
#pragma OPENCL EXTENSION cl_khr_fp16 : enable
#endif

#ifdef EMULATE_F16

// Note that the half-precision storage format is still 16 bits - the
// compiler will have to be real careful!
typedef float f16;

#elif ISPC
typedef float16 f16;

#else

#ifdef __CUDA_ARCH__
#include <cuda_fp16.h>
#endif

typedef half f16;

#endif

// Some of these functions convert to single precision because half
// precision versions are not available.

SCALAR_FUN_ATTR f16 fadd16(f16 x, f16 y) {
  return x + y;
}

SCALAR_FUN_ATTR f16 fsub16(f16 x, f16 y) {
  return x - y;
}

SCALAR_FUN_ATTR f16 fmul16(f16 x, f16 y) {
  return x * y;
}

SCALAR_FUN_ATTR bool cmplt16(f16 x, f16 y) {
  return x < y;
}

SCALAR_FUN_ATTR bool cmple16(f16 x, f16 y) {
  return x <= y;
}

SCALAR_FUN_ATTR f16 sitofp_i8_f16(int8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i16_f16(int16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i32_f16(int32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 sitofp_i64_f16(int64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i8_f16(uint8_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i16_f16(uint16_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i32_f16(uint32_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR f16 uitofp_i64_f16(uint64_t x) {
  return (f16) x;
}

SCALAR_FUN_ATTR int8_t fptosi_f16_i8(f16 x) {
  return (int8_t) (float) x;
}

SCALAR_FUN_ATTR int16_t fptosi_f16_i16(f16 x) {
  return (int16_t) x;
}

SCALAR_FUN_ATTR int32_t fptosi_f16_i32(f16 x) {
  return (int32_t) x;
}

SCALAR_FUN_ATTR int64_t fptosi_f16_i64(f16 x) {
  return (int64_t) x;
}

SCALAR_FUN_ATTR uint8_t fptoui_f16_i8(f16 x) {
  return (uint8_t) (float) x;
}

SCALAR_FUN_ATTR uint16_t fptoui_f16_i16(f16 x) {
  return (uint16_t) x;
}

SCALAR_FUN_ATTR uint32_t fptoui_f16_i32(f16 x) {
  return (uint32_t) x;
}

SCALAR_FUN_ATTR uint64_t fptoui_f16_i64(f16 x) {
  return (uint64_t) x;
}

SCALAR_FUN_ATTR bool ftob_f16_bool(f16 x) {
  return x != (f16)0;
}

SCALAR_FUN_ATTR f16 btof_bool_f16(bool x) {
  return x ? 1 : 0;
}

#ifndef EMULATE_F16
SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return isnan((float)x);
}

#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#elif ISPC
SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return abs(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : max(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return futrts_isnan16(x) ? y : futrts_isnan16(y) ? x : min(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return pow(x, y);
}

#else // Assuming CUDA.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabsf(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmaxf(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fminf(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return powf(x, y);
}
#endif

#if ISPC
SCALAR_FUN_ATTR bool futrts_isinf16(float x) {
  return !futrts_isnan16(x) && futrts_isnan16(x - x);
}
SCALAR_FUN_ATTR bool futrts_isfinite16(float x) {
  return !futrts_isnan16(x) && !futrts_isinf16(x);
}

#else

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return isinf((float)x);
}
#endif

#ifdef __OPENCL_VERSION__
SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return log(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return log2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return log10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return log1p(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return sqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrt(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return cos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return sin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tan(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acos(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asin(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atan(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return cosh(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinh(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanh(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acosh(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinh(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanh(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypot(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgamma(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erf(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfc(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rint(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return floor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return ceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return nextafter(x, y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return mix(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return ldexp(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return copysign(x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return mad(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fma(a, b, c);
}
#elif ISPC

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_isfinite16(x) || (futrts_isinf16(x) && x < 0) ? log(x) : x;
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log16(x) / log(2.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log16(x) / log(10.0f16);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  if(x == -1.0f16 || (futrts_isinf16(x) && x > 0.0f16)) return x / 0.0f16;
  f16 y = 1.0f16 + x;
  f16 z = y - 1.0f16;
  return log(y) - (z-x)/y;
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return (float16)sqrt((float)x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return exp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return (float16)cos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return (float16)sin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return (float16)tan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return (float16)acos((float)x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return (float16)asin((float)x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return (float16)atan((float)x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return (exp(x)+exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return (exp(x)-exp(-x)) / 2.0f16;
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_sinh16(x)/futrts_cosh16(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x-1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  float16 f = x+(float16)sqrt((float)(x*x+1));
  if(futrts_isfinite16(f)) return log(f);
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  float16 f = (1+x)/(1-x);
  if(futrts_isfinite16(f)) return log(f)/2.0f16;
  return f;
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return (float16)atan2((float)x, (float)y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return (float16)futrts_hypot32((float)x, (float)y);
}

extern "C" unmasked uniform float tgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)tgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

extern "C" unmasked uniform float lgammaf(uniform float x);
SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  f16 res;
  foreach_active (i) {
    uniform f16 r = (f16)lgammaf(extract((float)x, i));
    res = insert(res, i, r);
  }
  return res;
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  f16 res = (f16)futrts_cbrt32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  f16 res = (f16)futrts_erf32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  f16 res = (f16)futrts_erfc32((float)x);
  return res;
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return x - y * (float16)trunc((float) (x/y));
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return (float16)round((float)x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return (float16)floor((float)x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return (float16)ceil((float)x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return (float16)futrts_nextafter32((float)x, (float) y);
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

#else // Assume CUDA.

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return hlog(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return hlog2(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return hlog10(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return (f16)log1pf((float)x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return hsqrt(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return cbrtf(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return hexp(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return hcos(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return hsin(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return tanf(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return acosf(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return asinf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return atanf(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return coshf(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return sinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return tanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return acoshf(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return asinhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return atanhf(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return atan2f(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return hypotf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return tgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return lgammaf(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return erff(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return erfcf(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmodf(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return rintf(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return hfloor(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return hceil(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return __ushort_as_half(halfbitsnextafter(__half_as_ushort(x), __half_as_ushort(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return v0 + (v1 - v0) * t;
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return a * b + c;
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return fmaf(a, b, c);
}

#endif

// The CUDA __half type cannot be put in unions for some reason, so we
// use bespoke conversion functions instead.
#ifdef __CUDA_ARCH__
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return __half_as_ushort(x);
}
SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return __ushort_as_half(x);
}
#elif ISPC

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  varying int16_t y = *((varying int16_t * uniform)&x);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  varying f16 y = *((varying f16 * uniform)&x);
  return y;
}
#else
SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  union {
    f16 f;
    int16_t t;
  } p;

  p.f = x;
  return p.t;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  union {
    int16_t f;
    f16 t;
  } p;

  p.f = x;
  return p.t;
}
#endif

#else // No native f16 - emulate.

SCALAR_FUN_ATTR f16 fabs16(f16 x) {
  return fabs32(x);
}

SCALAR_FUN_ATTR f16 fmax16(f16 x, f16 y) {
  return fmax32(x, y);
}

SCALAR_FUN_ATTR f16 fmin16(f16 x, f16 y) {
  return fmin32(x, y);
}

SCALAR_FUN_ATTR f16 fpow16(f16 x, f16 y) {
  return fpow32(x, y);
}

SCALAR_FUN_ATTR bool futrts_isnan16(f16 x) {
  return futrts_isnan32(x);
}

SCALAR_FUN_ATTR bool futrts_isinf16(f16 x) {
  return futrts_isinf32(x);
}

SCALAR_FUN_ATTR f16 futrts_log16(f16 x) {
  return futrts_log32(x);
}

SCALAR_FUN_ATTR f16 futrts_log2_16(f16 x) {
  return futrts_log2_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log10_16(f16 x) {
  return futrts_log10_32(x);
}

SCALAR_FUN_ATTR f16 futrts_log1p_16(f16 x) {
  return futrts_log1p_32(x);
}

SCALAR_FUN_ATTR f16 futrts_sqrt16(f16 x) {
  return futrts_sqrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_cbrt16(f16 x) {
  return futrts_cbrt32(x);
}

SCALAR_FUN_ATTR f16 futrts_exp16(f16 x) {
  return futrts_exp32(x);
}

SCALAR_FUN_ATTR f16 futrts_cos16(f16 x) {
  return futrts_cos32(x);
}

SCALAR_FUN_ATTR f16 futrts_sin16(f16 x) {
  return futrts_sin32(x);
}

SCALAR_FUN_ATTR f16 futrts_tan16(f16 x) {
  return futrts_tan32(x);
}

SCALAR_FUN_ATTR f16 futrts_acos16(f16 x) {
  return futrts_acos32(x);
}

SCALAR_FUN_ATTR f16 futrts_asin16(f16 x) {
  return futrts_asin32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan16(f16 x) {
  return futrts_atan32(x);
}

SCALAR_FUN_ATTR f16 futrts_cosh16(f16 x) {
  return futrts_cosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_sinh16(f16 x) {
  return futrts_sinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_tanh16(f16 x) {
  return futrts_tanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_acosh16(f16 x) {
  return futrts_acosh32(x);
}

SCALAR_FUN_ATTR f16 futrts_asinh16(f16 x) {
  return futrts_asinh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atanh16(f16 x) {
  return futrts_atanh32(x);
}

SCALAR_FUN_ATTR f16 futrts_atan2_16(f16 x, f16 y) {
  return futrts_atan2_32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_hypot16(f16 x, f16 y) {
  return futrts_hypot32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_gamma16(f16 x) {
  return futrts_gamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_lgamma16(f16 x) {
  return futrts_lgamma32(x);
}

SCALAR_FUN_ATTR f16 futrts_erf16(f16 x) {
  return futrts_erf32(x);
}

SCALAR_FUN_ATTR f16 futrts_erfc16(f16 x) {
  return futrts_erfc32(x);
}

SCALAR_FUN_ATTR f16 fmod16(f16 x, f16 y) {
  return fmod32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_round16(f16 x) {
  return futrts_round32(x);
}

SCALAR_FUN_ATTR f16 futrts_floor16(f16 x) {
  return futrts_floor32(x);
}

SCALAR_FUN_ATTR f16 futrts_ceil16(f16 x) {
  return futrts_ceil32(x);
}

SCALAR_FUN_ATTR f16 futrts_nextafter16(f16 x, f16 y) {
  return halfbits2float(halfbitsnextafter(float2halfbits(x), float2halfbits(y)));
}

SCALAR_FUN_ATTR f16 futrts_lerp16(f16 v0, f16 v1, f16 t) {
  return futrts_lerp32(v0, v1, t);
}

SCALAR_FUN_ATTR f16 futrts_ldexp16(f16 x, int32_t y) {
  return futrts_ldexp32(x, y);
}

SCALAR_FUN_ATTR f16 futrts_copysign16(f16 x, f16 y) {
  return futrts_copysign32((float)x, y);
}

SCALAR_FUN_ATTR f16 futrts_mad16(f16 a, f16 b, f16 c) {
  return futrts_mad32(a, b, c);
}

SCALAR_FUN_ATTR f16 futrts_fma16(f16 a, f16 b, f16 c) {
  return futrts_fma32(a, b, c);
}

// Even when we are using an OpenCL that does not support cl_khr_fp16,
// it must still support vload_half for actually creating a
// half-precision number, which can then be efficiently converted to a
// float.  Similarly for vstore_half.
#ifdef __OPENCL_VERSION__

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  int16_t y;
  // Violating strict aliasing here.
  vstore_half((float)x, 0, (half*)&y);
  return y;
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return (f16)vload_half(0, (half*)&x);
}

#else

SCALAR_FUN_ATTR int16_t futrts_to_bits16(f16 x) {
  return (int16_t)float2halfbits(x);
}

SCALAR_FUN_ATTR f16 futrts_from_bits16(int16_t x) {
  return halfbits2float((uint16_t)x);
}

SCALAR_FUN_ATTR f16 fsignum16(f16 x) {
  return futrts_isnan16(x) ? x : (x > 0 ? 1 : 0) - (x < 0 ? 1 : 0);
}

#endif

#endif

SCALAR_FUN_ATTR float fpconv_f16_f16(f16 x) {
  return x;
}

SCALAR_FUN_ATTR float fpconv_f16_f32(f16 x) {
  return x;
}

SCALAR_FUN_ATTR f16 fpconv_f32_f16(float x) {
  return (f16) x;
}

#ifdef FUTHARK_F64_ENABLED

SCALAR_FUN_ATTR double fpconv_f16_f64(f16 x) {
  return (double) x;
}

#if ISPC
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) ((float)x);
}
#else
SCALAR_FUN_ATTR f16 fpconv_f64_f16(double x) {
  return (f16) x;
}
#endif
#endif


// End of scalar_f16.h.

// Start of context_prototypes.h
//
// Prototypes for the functions in context.h, or that will be called
// from those functions, that need to be available very early.

struct futhark_context_config;
struct futhark_context;

static void set_error(struct futhark_context* ctx, char *error);

// These are called in context/config new/free functions and contain
// shared setup.  They are generated by the compiler itself.
static int init_constants(struct futhark_context*);
static int free_constants(struct futhark_context*);
static void setup_program(struct futhark_context* ctx);
static void teardown_program(struct futhark_context *ctx);

// Allocate host memory.  Must be freed with host_free().
static void host_alloc(struct futhark_context* ctx, size_t size, const char* tag, size_t* size_out, void** mem_out);
// Allocate memory allocated with host_alloc().
static void host_free(struct futhark_context* ctx, size_t size, const char* tag, void* mem);

// Log that a copy has occurred.
static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]);

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t m, int64_t n);

static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]);

static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]);

static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]);

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f);

// Functions that must be defined by the backend.
static void backend_context_config_setup(struct futhark_context_config* cfg);
static void backend_context_config_teardown(struct futhark_context_config* cfg);
static int backend_context_setup(struct futhark_context *ctx);
static void backend_context_teardown(struct futhark_context *ctx);

// End of of context_prototypes.h

struct memblock {
    int *references;
    unsigned char *mem;
    int64_t size;
    const char *desc;
};
struct constants {
    int dummy;
};
struct tuning_params {
    int dummy;
};
static const int num_tuning_params = 0;
static const char *tuning_param_names[] = {NULL};
static const char *tuning_param_vars[] = {NULL};
static const char *tuning_param_classes[] = {NULL};
static int64_t tuning_param_defaults[] = {0};
// Start of backends/c.h

struct futhark_context_config {
  int in_use;
  int debugging;
  int profiling;
  int logging;
  char *cache_fname;
  int num_tuning_params;
  int64_t *tuning_params;
  const char** tuning_param_names;
  const char** tuning_param_vars;
  const char** tuning_param_classes;
};

static void backend_context_config_setup(struct futhark_context_config* cfg) {
  (void)cfg;
}

static void backend_context_config_teardown(struct futhark_context_config* cfg) {
  (void)cfg;
}

int futhark_context_config_set_tuning_param(struct futhark_context_config* cfg, const char *param_name, size_t param_value) {
  (void)cfg; (void)param_name; (void)param_value;
  return 1;
}

struct futhark_context {
  struct futhark_context_config* cfg;
  int detail_memory;
  int debugging;
  int profiling;
  int profiling_paused;
  int logging;
  lock_t lock;
  char *error;
  lock_t error_lock;
  FILE *log;
  struct constants *constants;
  struct free_list free_list;
  struct event_list event_list;
  int64_t peak_mem_usage_default;
  int64_t cur_mem_usage_default;
  struct program* program;
  bool program_initialised;
};

int backend_context_setup(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

void backend_context_teardown(struct futhark_context* ctx) {
  (void)ctx;
}

int futhark_context_sync(struct futhark_context* ctx) {
  (void)ctx;
  return 0;
}

// End of backends/c.h

struct program {
    int dummy;
};
static void setup_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    ctx->program = malloc(sizeof(struct program));
}
static void teardown_program(struct futhark_context *ctx)
{
    (void) ctx;
    
    int error = 0;
    
    (void) error;
    free(ctx->program);
}
static void set_tuning_params(struct futhark_context *ctx)
{
    (void) ctx;
}
int memblock_unref(struct futhark_context *ctx, struct memblock *block, const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(ctx->log, "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n", desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            host_free(ctx, (size_t) block->size, desc, (void *) block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(ctx->log, "%lld bytes freed (now allocated: %lld bytes)\n", (long long) block->size, (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
int memblock_alloc(struct futhark_context *ctx, struct memblock *block, int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1, "Negative allocation of %lld bytes attempted for %s in %s.\n", (long long) size, desc, "default space", ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    if (ret != FUTHARK_SUCCESS)
        return ret;
    if (ctx->detail_memory)
        fprintf(ctx->log, "Allocating %lld bytes for %s in %s (currently allocated: %lld bytes).\n", (long long) size, desc, "default space", (long long) ctx->cur_mem_usage_default);
    host_alloc(ctx, (size_t) size, desc, (size_t *) &size, (void *) &block->mem);
    if (ctx->error == NULL) {
        block->references = (int *) malloc(sizeof(int));
        *block->references = 1;
        block->size = size;
        block->desc = desc;
        
        long long new_usage = ctx->cur_mem_usage_default + size;
        
        if (ctx->detail_memory)
            fprintf(ctx->log, "Received block of %lld bytes; now allocated: %lld bytes", (long long) block->size, new_usage);
        ctx->cur_mem_usage_default = new_usage;
        if (new_usage > ctx->peak_mem_usage_default) {
            ctx->peak_mem_usage_default = new_usage;
            if (ctx->detail_memory)
                fprintf(ctx->log, " (new peak).\n");
        } else if (ctx->detail_memory)
            fprintf(ctx->log, ".\n");
        return FUTHARK_SUCCESS;
    } else {
        // We are naively assuming that any memory allocation error is due to OOM.
        lock_lock(&ctx->error_lock);
        
        char *old_error = ctx->error;
        
        ctx->error = msgprintf("Failed to allocate memory in %s.\nAttempted allocation: %12lld bytes\nCurrently allocated:  %12lld bytes\n%s", "default space", (long long) size, (long long) ctx->cur_mem_usage_default, old_error);
        free(old_error);
        lock_unlock(&ctx->error_lock);
        return FUTHARK_OUT_OF_MEMORY;
    }
}
int memblock_set(struct futhark_context *ctx, struct memblock *lhs, struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    if (futhark_context_sync(ctx) != 0)
        return NULL;
    
    struct str_builder builder;
    
    str_builder_init(&builder);
    str_builder_char(&builder, '{');
    str_builder_str(&builder, "\"memory\":{");
    str_builder(&builder, "\"default space\": %lld", (long long) ctx->peak_mem_usage_default);
    str_builder_str(&builder, "},\"events\":[");
    if (report_events_in_list(&ctx->event_list, &builder) != 0) {
        free(builder.str);
        return NULL;
    } else {
        str_builder_str(&builder, "]}");
        return builder.str;
    }
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    ctx->peak_mem_usage_default = 0;
    lock_unlock(&ctx->lock);
    return ctx->error != NULL;
}

// Start of context.h

// Internal functions.

static void set_error(struct futhark_context* ctx, char *error) {
  lock_lock(&ctx->error_lock);
  if (ctx->error == NULL) {
    ctx->error = error;
  } else {
    free(error);
  }
  lock_unlock(&ctx->error_lock);
}

// XXX: should be static, but used in ispc_util.h
void lexical_realloc_error(struct futhark_context* ctx, size_t new_size) {
  set_error(ctx,
            msgprintf("Failed to allocate memory.\nAttempted allocation: %12lld bytes\n",
                      (long long) new_size));
}

static int lexical_realloc(struct futhark_context *ctx,
                           unsigned char **ptr,
                           int64_t *old_size,
                           int64_t new_size) {
  unsigned char *new = realloc(*ptr, (size_t)new_size);
  if (new == NULL) {
    lexical_realloc_error(ctx, new_size);
    return FUTHARK_OUT_OF_MEMORY;
  } else {
    *ptr = new;
    *old_size = new_size;
    return FUTHARK_SUCCESS;
  }
}

static void free_all_in_free_list(struct futhark_context* ctx) {
  fl_mem mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, (fl_mem*)&mem) == 0) {
    free((void*)mem);
  }
}

static int is_small_alloc(size_t size) {
  return size < 1024*1024;
}

static void host_alloc(struct futhark_context* ctx,
                       size_t size, const char* tag, size_t* size_out, void** mem_out) {
  if (is_small_alloc(size) || free_list_find(&ctx->free_list, size, tag, size_out, (fl_mem*)mem_out) != 0) {
    *size_out = size;
    *mem_out = malloc(size);
  }
}

static void host_free(struct futhark_context* ctx,
                      size_t size, const char* tag, void* mem) {
  // Small allocations are handled by malloc()s own free list.  The
  // threshold here is kind of arbitrary, but seems to work OK.
  // Larger allocations are mmap()ed/munmapped() every time, which is
  // very slow, and Futhark programs tend to use a few very large
  // allocations.
  if (is_small_alloc(size)) {
    free(mem);
  } else {
    free_list_insert(&ctx->free_list, size, (fl_mem)mem, tag);
  }
}

static void add_event(struct futhark_context* ctx,
                      const char* name,
                      char* description,
                      void* data,
                      event_report_fn f) {
  if (ctx->logging) {
    fprintf(ctx->log, "Event: %s\n%s\n", name, description);
  }
  add_event_to_list(&ctx->event_list, name, description, data, f);
}

char *futhark_context_get_error(struct futhark_context *ctx) {
  char *error = ctx->error;
  ctx->error = NULL;
  return error;
}

void futhark_context_config_set_debugging(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = cfg->logging = cfg->debugging = flag;
}

void futhark_context_config_set_profiling(struct futhark_context_config *cfg, int flag) {
    cfg->profiling = flag;
}

void futhark_context_config_set_logging(struct futhark_context_config *cfg, int flag) {
    cfg->logging = flag;
}

void futhark_context_config_set_cache_file(struct futhark_context_config *cfg, const char *f) {
  cfg->cache_fname = strdup(f);
}

int futhark_get_tuning_param_count(void) {
  return num_tuning_params;
}

const char *futhark_get_tuning_param_name(int i) {
  return tuning_param_names[i];
}

const char *futhark_get_tuning_param_class(int i) {
    return tuning_param_classes[i];
}

void futhark_context_set_logging_file(struct futhark_context *ctx, FILE *f){
  ctx->log = f;
}

void futhark_context_pause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 1;
}

void futhark_context_unpause_profiling(struct futhark_context *ctx) {
  ctx->profiling_paused = 0;
}

struct futhark_context_config* futhark_context_config_new(void) {
  struct futhark_context_config* cfg = malloc(sizeof(struct futhark_context_config));
  if (cfg == NULL) {
    return NULL;
  }
  cfg->in_use = 0;
  cfg->debugging = 0;
  cfg->profiling = 0;
  cfg->logging = 0;
  cfg->cache_fname = NULL;
  cfg->num_tuning_params = num_tuning_params;
  cfg->tuning_params = malloc(cfg->num_tuning_params * sizeof(int64_t));
  memcpy(cfg->tuning_params, tuning_param_defaults,
         cfg->num_tuning_params * sizeof(int64_t));
  cfg->tuning_param_names = tuning_param_names;
  cfg->tuning_param_vars = tuning_param_vars;
  cfg->tuning_param_classes = tuning_param_classes;
  backend_context_config_setup(cfg);
  return cfg;
}

void futhark_context_config_free(struct futhark_context_config* cfg) {
  assert(!cfg->in_use);
  backend_context_config_teardown(cfg);
  free(cfg->cache_fname);
  free(cfg->tuning_params);
  free(cfg);
}

struct futhark_context* futhark_context_new(struct futhark_context_config* cfg) {
  struct futhark_context* ctx = malloc(sizeof(struct futhark_context));
  if (ctx == NULL) {
    return NULL;
  }
  assert(!cfg->in_use);
  ctx->cfg = cfg;
  ctx->cfg->in_use = 1;
  ctx->program_initialised = false;
  create_lock(&ctx->error_lock);
  create_lock(&ctx->lock);
  free_list_init(&ctx->free_list);
  event_list_init(&ctx->event_list);
  ctx->peak_mem_usage_default = 0;
  ctx->cur_mem_usage_default = 0;
  ctx->constants = malloc(sizeof(struct constants));
  ctx->debugging = cfg->debugging;
  ctx->logging = cfg->logging;
  ctx->detail_memory = cfg->logging;
  ctx->profiling = cfg->profiling;
  ctx->profiling_paused = 0;
  ctx->error = NULL;
  ctx->log = stderr;
  set_tuning_params(ctx);
  if (backend_context_setup(ctx) == 0) {
    setup_program(ctx);
    init_constants(ctx);
    ctx->program_initialised = true;
    (void)futhark_context_clear_caches(ctx);
    (void)futhark_context_sync(ctx);
  }
  return ctx;
}

void futhark_context_free(struct futhark_context* ctx) {
  if (ctx->program_initialised) {
    free_constants(ctx);
    teardown_program(ctx);
  }
  backend_context_teardown(ctx);
  free_all_in_free_list(ctx);
  free_list_destroy(&ctx->free_list);
  event_list_free(&ctx->event_list);
  free(ctx->constants);
  free(ctx->error);
  free_lock(&ctx->lock);
  free_lock(&ctx->error_lock);
  ctx->cfg->in_use = 0;
  free(ctx);
}

// End of context.h

// Start of copy.h

// Cache-oblivious map-transpose function.
#define GEN_MAP_TRANSPOSE(NAME, ELEM_TYPE)                              \
  static void map_transpose_##NAME                                      \
  (ELEM_TYPE* dst, ELEM_TYPE* src,                                      \
   int64_t k, int64_t m, int64_t n,                                     \
   int64_t cb, int64_t ce, int64_t rb, int64_t re)                      \
  {                                                                     \
  int32_t r = re - rb;                                                  \
  int32_t c = ce - cb;                                                  \
  if (k == 1) {                                                         \
    if (r <= 64 && c <= 64) {                                           \
      for (int64_t j = 0; j < c; j++) {                                 \
        for (int64_t i = 0; i < r; i++) {                               \
          dst[(j + cb) * n + (i + rb)] = src[(i + rb) * m + (j + cb)];  \
        }                                                               \
      }                                                                 \
    } else if (c <= r) {                                                \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb, rb + r/2);    \
      map_transpose_##NAME(dst, src, k, m, n, cb, ce, rb + r/2, re);    \
    } else {                                                            \
      map_transpose_##NAME(dst, src, k, m, n, cb, cb + c/2, rb, re);    \
      map_transpose_##NAME(dst, src, k, m, n, cb + c/2, ce, rb, re);    \
    }                                                                   \
  } else {                                                              \
  for (int64_t i = 0; i < k; i++) {                                     \
    map_transpose_##NAME(dst + i * m * n, src + i * m * n, 1, m, n, cb, ce, rb, re); \
  }\
} \
}

// Straightforward LMAD copy function.
#define GEN_LMAD_COPY_ELEMENTS(NAME, ELEM_TYPE)                         \
  static void lmad_copy_elements_##NAME(int r,                          \
                                        ELEM_TYPE* dst, int64_t dst_strides[r], \
                                        ELEM_TYPE *src, int64_t src_strides[r], \
                                        int64_t shape[r]) {             \
    if (r == 1) {                                                       \
      for (int i = 0; i < shape[0]; i++) {                              \
        dst[i*dst_strides[0]] = src[i*src_strides[0]];                  \
      }                                                                 \
    } else if (r > 1) {                                                 \
      for (int i = 0; i < shape[0]; i++) {                              \
        lmad_copy_elements_##NAME(r-1,                                  \
                                  dst+i*dst_strides[0], dst_strides+1,  \
                                  src+i*src_strides[0], src_strides+1,  \
                                  shape+1);                             \
      }                                                                 \
    }                                                                   \
  }                                                                     \

// Check whether this LMAD can be seen as a transposed 2D array.  This
// is done by checking every possible splitting point.
static bool lmad_is_tr(int64_t *n_out, int64_t *m_out,
                       int r,
                       const int64_t strides[r],
                       const int64_t shape[r]) {
  for (int i = 1; i < r; i++) {
    int n = 1, m = 1;
    bool ok = true;
    int64_t expected = 1;
    // Check strides before 'i'.
    for (int j = i-1; j >= 0; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      n *= shape[j];
    }
    // Check strides after 'i'.
    for (int j = r-1; j >= i; j--) {
      ok = ok && strides[j] == expected;
      expected *= shape[j];
      m *= shape[j];
    }
    if (ok) {
      *n_out = n;
      *m_out = m;
      return true;
    }
  }
  return false;
}

// This function determines whether the a 'dst' LMAD is row-major and
// 'src' LMAD is column-major.  Both LMADs are for arrays of the same
// shape.  Both LMADs are allowed to have additional dimensions "on
// top".  Essentially, this function determines whether a copy from
// 'src' to 'dst' is a "map(transpose)" that we know how to implement
// efficiently.  The LMADs can have arbitrary rank, and the main
// challenge here is checking whether the src LMAD actually
// corresponds to a 2D column-major layout by morally collapsing
// dimensions.  There is a lot of looping here, but the actual trip
// count is going to be very low in practice.
//
// Returns true if this is indeed a map(transpose), and writes the
// number of arrays, and moral array size to appropriate output
// parameters.
static bool lmad_map_tr(int64_t *num_arrays_out, int64_t *n_out, int64_t *m_out,
                        int r,
                        const int64_t dst_strides[r],
                        const int64_t src_strides[r],
                        const int64_t shape[r]) {
  int64_t rowmajor_strides[r];
  rowmajor_strides[r-1] = 1;

  for (int i = r-2; i >= 0; i--) {
    rowmajor_strides[i] = rowmajor_strides[i+1] * shape[i+1];
  }

  // map_r will be the number of mapped dimensions on top.
  int map_r = 0;
  int64_t num_arrays = 1;
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != rowmajor_strides[i] ||
        src_strides[i] != rowmajor_strides[i]) {
      break;
    } else {
      num_arrays *= shape[i];
      map_r++;
    }
  }

  *num_arrays_out = num_arrays;

  if (r==map_r) {
    return false;
  }

  if (memcmp(&rowmajor_strides[map_r],
             &dst_strides[map_r],
             sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(n_out, m_out, r-map_r, src_strides+map_r, shape+map_r);
  } else if (memcmp(&rowmajor_strides[map_r],
                    &src_strides[map_r],
                    sizeof(int64_t)*(r-map_r)) == 0) {
    return lmad_is_tr(m_out, n_out, r-map_r, dst_strides+map_r, shape+map_r);
  }
  return false;
}

// Check if the strides correspond to row-major strides of *any*
// permutation of the shape.  This is done by recursive search with
// backtracking.  This is worst-case exponential, but hopefully the
// arrays we encounter do not have that many dimensions.
static bool lmad_contiguous_search(int checked, int64_t expected,
                                   int r,
                                   int64_t strides[r], int64_t shape[r], bool used[r]) {
  for (int i = 0; i < r; i++) {
    for (int j = 0; j < r; j++) {
      if (!used[j] && strides[j] == expected && strides[j] >= 0) {
        used[j] = true;
        if (checked+1 == r ||
            lmad_contiguous_search(checked+1, expected * shape[j], r, strides, shape, used)) {
          return true;
        }
        used[j] = false;
      }
    }
  }
  return false;
}

// Does this LMAD correspond to an array with positive strides and no
// holes?
static bool lmad_contiguous(int r, int64_t strides[r], int64_t shape[r]) {
  bool used[r];
  for (int i = 0; i < r; i++) {
    used[i] = false;
  }
  return lmad_contiguous_search(0, 1, r, strides, shape, used);
}

// Does this copy correspond to something that could be done with a
// memcpy()-like operation?  I.e. do the LMADs actually represent the
// same in-memory layout and are they contiguous?
static bool lmad_memcpyable(int r,
                            int64_t dst_strides[r], int64_t src_strides[r], int64_t shape[r]) {
  if (!lmad_contiguous(r, dst_strides, shape)) {
    return false;
  }
  for (int i = 0; i < r; i++) {
    if (dst_strides[i] != src_strides[i] && shape[i] != 1) {
      return false;
    }
  }
  return true;
}


static void log_copy(struct futhark_context* ctx,
                     const char *kind, int r,
                     int64_t dst_offset, int64_t dst_strides[r],
                     int64_t src_offset, int64_t src_strides[r],
                     int64_t shape[r]) {
  if (ctx->logging) {
    fprintf(ctx->log, "\n# Copy %s\n", kind);
    fprintf(ctx->log, "Shape: ");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, "[%ld]", (long int)shape[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Dst offset: %ld\n", (long int)dst_offset);
    fprintf(ctx->log, "Dst strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)dst_strides[i]); }
    fprintf(ctx->log, "\n");
    fprintf(ctx->log, "Src offset: %ld\n", (long int)src_offset);
    fprintf(ctx->log, "Src strides:");
    for (int i = 0; i < r; i++) { fprintf(ctx->log, " %ld", (long int)src_strides[i]); }
    fprintf(ctx->log, "\n");
  }
}

static void log_transpose(struct futhark_context* ctx,
                          int64_t k, int64_t n, int64_t m) {
  if (ctx->logging) {
    fprintf(ctx->log, "## Transpose\n");
    fprintf(ctx->log, "Arrays     : %ld\n", (long int)k);
    fprintf(ctx->log, "X elements : %ld\n", (long int)m);
    fprintf(ctx->log, "Y elements : %ld\n", (long int)n);
    fprintf(ctx->log, "\n");
  }
}

#define GEN_LMAD_COPY(NAME, ELEM_TYPE)                                  \
  static void lmad_copy_##NAME                                          \
  (struct futhark_context *ctx, int r,                                  \
   ELEM_TYPE* dst, int64_t dst_offset, int64_t dst_strides[r],          \
   ELEM_TYPE *src, int64_t src_offset, int64_t src_strides[r],          \
   int64_t shape[r]) {                                                  \
    log_copy(ctx, "CPU to CPU", r, dst_offset, dst_strides,             \
             src_offset, src_strides, shape);                           \
    int64_t size = 1;                                                   \
    for (int i = 0; i < r; i++) { size *= shape[i]; }                   \
    if (size == 0) { return; }                                          \
    int64_t k, n, m;                                                    \
    if (lmad_map_tr(&k, &n, &m,                                         \
                    r, dst_strides, src_strides, shape)) {              \
      log_transpose(ctx, k, n, m);                                      \
      map_transpose_##NAME                                              \
        (dst+dst_offset, src+src_offset, k, n, m, 0, n, 0, m);          \
    } else if (lmad_memcpyable(r, dst_strides, src_strides, shape)) {   \
      if (ctx->logging) {fprintf(ctx->log, "## Flat copy\n\n");}          \
      memcpy(dst+dst_offset, src+src_offset, size*sizeof(*dst));        \
    } else {                                                            \
      if (ctx->logging) {fprintf(ctx->log, "## General copy\n\n");}       \
      lmad_copy_elements_##NAME                                         \
        (r,                                                             \
         dst+dst_offset, dst_strides,                                   \
         src+src_offset, src_strides, shape);                           \
    }                                                                   \
  }

GEN_MAP_TRANSPOSE(1b, uint8_t)
GEN_MAP_TRANSPOSE(2b, uint16_t)
GEN_MAP_TRANSPOSE(4b, uint32_t)
GEN_MAP_TRANSPOSE(8b, uint64_t)

GEN_LMAD_COPY_ELEMENTS(1b, uint8_t)
GEN_LMAD_COPY_ELEMENTS(2b, uint16_t)
GEN_LMAD_COPY_ELEMENTS(4b, uint32_t)
GEN_LMAD_COPY_ELEMENTS(8b, uint64_t)

GEN_LMAD_COPY(1b, uint8_t)
GEN_LMAD_COPY(2b, uint16_t)
GEN_LMAD_COPY(4b, uint32_t)
GEN_LMAD_COPY(8b, uint64_t)

// End of copy.h

#define FUTHARK_FUN_ATTR static

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_172688, struct memblock *mem_out_p_172689, struct memblock *mem_out_p_172690, int64_t *out_prim_out_172691, struct memblock pR_mem_171818, struct memblock pS_mem_171819, struct memblock bounds_mem_171820, struct memblock depths_mem_171821, struct memblock first_info_idx_mem_171822, struct memblock last_info_idx_mem_171823, int64_t nR_141120, int64_t b_141121, int64_t nS_141122, int64_t dz2081U_141123, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, int32_t radix_sizze_141125, int32_t maxDepth_141130);
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_172732, struct memblock *mem_out_p_172733, struct memblock *mem_out_p_172734, int64_t *out_prim_out_172735, struct memblock pR_mem_171818, struct memblock pS_mem_171819, struct memblock bounds_mem_171820, struct memblock depths_mem_171821, struct memblock first_info_idx_mem_171822, struct memblock last_info_idx_mem_171823, int64_t nR_143593, int64_t b_143594, int64_t nS_143595, int64_t dz2081U_143596, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, int32_t radix_sizze_143598, int32_t maxDepth_143603);
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172748, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_152590, int64_t nz2080U_152591);
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172749, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_152657, int64_t nz2080U_152658);
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172751, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_152149, int64_t nz2080U_152150);
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172752, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_152216, int64_t nz2080U_152217);
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172754, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_151276, int64_t nz2080U_151277);
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172755, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_151343, int64_t nz2080U_151344);
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172757, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_151708, int64_t nz2080U_151709);
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172758, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_151775, int64_t nz2080U_151776);
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172760, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_150844, int64_t nz2080U_150845);
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172761, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_150911, int64_t nz2080U_150912);
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_172763, struct memblock ks_mem_171818, int64_t n_79709);
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_172764, struct memblock ks_mem_171818, int64_t n_79532);
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_172765, struct memblock ks_mem_171818, int64_t n_79181);
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_172766, struct memblock ks_mem_171818, int64_t n_79355);
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_172767, struct memblock ks_mem_171818, int64_t n_79007);
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172768, struct memblock *mem_out_p_172769, int64_t *out_prim_out_172770, int32_t *out_prim_out_172771, struct memblock pXs_mem_171818, int64_t n_132232, int64_t b_132233, int32_t radix_sizze_132234, int64_t offset_132236, int64_t sizze_thresh_132237, int32_t max_depth_132238);
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172779, struct memblock *mem_out_p_172780, int64_t *out_prim_out_172781, struct memblock pXs_mem_171818, struct memblock bounds_mem_171819, struct memblock depths_mem_171820, int64_t n_132814, int64_t b_132815, int64_t dz2080U_132816, int64_t dz2081U_132817, int32_t radix_sizze_132818, int32_t maxDepth_132822, int64_t scatter_psizze_132823);
FUTHARK_FUN_ATTR int futrts_entry_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172784, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_150394, int64_t group_no_150395);
FUTHARK_FUN_ATTR int futrts_entry_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172785, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150471, int64_t group_no_150472);
FUTHARK_FUN_ATTR int futrts_entry_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172786, struct memblock ks_mem_171818, int64_t nz2082U_143701, int64_t key_no_143702);
FUTHARK_FUN_ATTR int futrts_entry_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172787, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_150183, int64_t group_no_150184);
FUTHARK_FUN_ATTR int futrts_entry_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172788, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150260, int64_t group_no_150261);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172789, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_82032, int64_t dz2083U_82033, int64_t incr_82034, int64_t psizze_82035, int64_t pL_bytes_82037);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_172791, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81665, int64_t dz2083U_81666, int64_t incr_81667, int64_t psizze_81668);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172793, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82320, int64_t n_82321, int64_t incr_82322, int64_t psizze_82323);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_172795, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81600, int64_t dz2083U_81601, int64_t incr_81602, int64_t psizze_81603);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172797, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82263, int64_t n_82264, int64_t incr_82265, int64_t psizze_82266);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_172799, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81470, int64_t dz2083U_81471, int64_t incr_81472, int64_t psizze_81473);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172801, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82149, int64_t n_82150, int64_t incr_82151, int64_t psizze_82152);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_172803, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81535, int64_t dz2083U_81536, int64_t incr_81537, int64_t psizze_81538);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172805, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82206, int64_t n_82207, int64_t incr_82208, int64_t psizze_82209);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_172807, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81405, int64_t dz2083U_81406, int64_t incr_81407, int64_t psizze_81408);
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172809, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82092, int64_t n_82093, int64_t incr_82094, int64_t psizze_82095);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_172811, struct memblock *mem_out_p_172812, struct memblock *mem_out_p_172813, int64_t *out_prim_out_172814, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_127457, int64_t nS_127458, int64_t offset_R_127461, int64_t offset_S_127462, int64_t partitionSizze_127463, int64_t scatter_psizze_127464);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_172825, struct memblock *mem_out_p_172826, struct memblock *mem_out_p_172827, int64_t *out_prim_out_172828, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_124794, int64_t nS_124795, int64_t offset_R_124798, int64_t offset_S_124799, int64_t partitionSizze_124800, int64_t scatter_psizze_124801);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_172839, struct memblock *mem_out_p_172840, struct memblock *mem_out_p_172841, int64_t *out_prim_out_172842, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_119480, int64_t nS_119481, int64_t offset_R_119484, int64_t offset_S_119485, int64_t partitionSizze_119486, int64_t scatter_psizze_119487);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_172853, struct memblock *mem_out_p_172854, struct memblock *mem_out_p_172855, int64_t *out_prim_out_172856, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_122131, int64_t nS_122132, int64_t offset_R_122135, int64_t offset_S_122136, int64_t partitionSizze_122137, int64_t scatter_psizze_122138);
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_172867, struct memblock *mem_out_p_172868, struct memblock *mem_out_p_172869, int64_t *out_prim_out_172870, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_116817, int64_t nS_116818, int64_t offset_R_116821, int64_t offset_S_116822, int64_t partitionSizze_116823, int64_t scatter_psizze_116824);
FUTHARK_FUN_ATTR int futrts_entry_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172881, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149774, int64_t group_no_149775);
FUTHARK_FUN_ATTR int futrts_entry_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172882, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_149851, int64_t group_no_149852);
FUTHARK_FUN_ATTR int futrts_entry_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172883, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149980, int64_t group_no_149981);
FUTHARK_FUN_ATTR int futrts_entry_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172884, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150047, int64_t group_no_150048);
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_172885, struct memblock eta_p_mem_171818, int64_t nz2080U_80076);
FUTHARK_FUN_ATTR int futrts_entry_maximum_double(struct futhark_context *ctx, double *out_prim_out_172886, struct memblock eta_p_mem_171818, int64_t nz2080U_80058);
FUTHARK_FUN_ATTR int futrts_entry_maximum_float(struct futhark_context *ctx, float *out_prim_out_172887, struct memblock eta_p_mem_171818, int64_t nz2080U_79990);
FUTHARK_FUN_ATTR int futrts_entry_maximum_int(struct futhark_context *ctx, int32_t *out_prim_out_172888, struct memblock eta_p_mem_171818, int64_t nz2080U_79851);
FUTHARK_FUN_ATTR int futrts_entry_maximum_long(struct futhark_context *ctx, int64_t *out_prim_out_172889, struct memblock eta_p_mem_171818, int64_t nz2080U_79922);
FUTHARK_FUN_ATTR int futrts_entry_maximum_short(struct futhark_context *ctx, int16_t *out_prim_out_172890, struct memblock eta_p_mem_171818, int64_t nz2080U_79780);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172891, struct memblock *mem_out_p_172892, struct memblock xs_mem_171818, int64_t n_113912, int64_t incr_113913);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172903, struct memblock *mem_out_p_172904, struct memblock xs_mem_171818, int64_t n_111767, int64_t incr_111768);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172915, struct memblock *mem_out_p_172916, struct memblock xs_mem_171818, int64_t n_107481, int64_t incr_107482);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172927, struct memblock *mem_out_p_172928, struct memblock xs_mem_171818, int64_t n_109622, int64_t incr_109623);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172939, struct memblock *mem_out_p_172940, struct memblock xs_mem_171818, int64_t n_105336, int64_t incr_105337);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172951, struct memblock *mem_out_p_172952, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_98843, int64_t b_98844);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172963, struct memblock *mem_out_p_172964, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_96478, int64_t b_96479);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172975, struct memblock *mem_out_p_172976, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_91754, int64_t b_91755);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172987, struct memblock *mem_out_p_172988, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_94113, int64_t b_94114);
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172999, struct memblock *mem_out_p_173000, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_89389, int64_t b_89390);
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_173011, struct memblock eta_p_mem_171818, int64_t nz2080U_80067);
FUTHARK_FUN_ATTR int futrts_entry_minimum_double(struct futhark_context *ctx, double *out_prim_out_173012, struct memblock eta_p_mem_171818, int64_t nz2080U_80024);
FUTHARK_FUN_ATTR int futrts_entry_minimum_float(struct futhark_context *ctx, float *out_prim_out_173013, struct memblock eta_p_mem_171818, int64_t nz2080U_79956);
FUTHARK_FUN_ATTR int futrts_entry_minimum_int(struct futhark_context *ctx, int32_t *out_prim_out_173014, struct memblock eta_p_mem_171818, int64_t nz2080U_79814);
FUTHARK_FUN_ATTR int futrts_entry_minimum_long(struct futhark_context *ctx, int64_t *out_prim_out_173015, struct memblock eta_p_mem_171818, int64_t nz2080U_79885);
FUTHARK_FUN_ATTR int futrts_entry_minimum_short(struct futhark_context *ctx, int16_t *out_prim_out_173016, struct memblock eta_p_mem_171818, int64_t nz2080U_79743);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_173017, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_81338, int64_t incr_81339, int64_t block_sizze_81340);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_173019, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_81086, int64_t incr_81087, int64_t block_sizze_81088);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_173021, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80582, int64_t incr_80583, int64_t block_sizze_80584);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_173023, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80834, int64_t incr_80835, int64_t block_sizze_80836);
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_173025, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80330, int64_t incr_80331, int64_t block_sizze_80332);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_173027, struct memblock *mem_out_p_173028, struct memblock xs_mem_171818, struct memblock pL_mem_171819, int64_t n_130036, int64_t b_130037, int64_t pL_b_130038, int16_t block_sizze_130039, int64_t gather_psizze_130040, int32_t radix_sizze_130041, int64_t sizze_thresh_130044, int32_t max_depth_130045, int32_t bit_step_130046);
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_173040, struct memblock *mem_out_p_173041, struct memblock xs_mem_171818, int64_t n_131406, int64_t b_131407, int16_t block_sizze_131408, int64_t gather_psizze_131409, int32_t radix_sizze_131410, int64_t offset_131412, int64_t sizze_thresh_131413, int32_t max_depth_131414, int32_t bit_step_131415);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_173052, struct memblock *mem_out_p_173053, struct memblock xs_mem_171818, int64_t n_103190, int64_t incr_103191, int64_t block_sizze_103192);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_173057, struct memblock *mem_out_p_173058, struct memblock xs_mem_171818, int64_t n_102308, int64_t incr_102309, int64_t block_sizze_102310);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_173062, struct memblock *mem_out_p_173063, struct memblock xs_mem_171818, int64_t n_100565, int64_t incr_100566, int64_t block_sizze_100567);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_173067, struct memblock *mem_out_p_173068, struct memblock xs_mem_171818, int64_t n_101426, int64_t incr_101427, int64_t block_sizze_101428);
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_173072, struct memblock *mem_out_p_173073, struct memblock xs_mem_171818, int64_t n_99704, int64_t incr_99705, int64_t block_sizze_99706);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_173077, struct memblock *mem_out_p_173078, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_86918, int64_t b_86919, int64_t block_sizze_86920);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_173083, struct memblock *mem_out_p_173084, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_85975, int64_t b_85976, int64_t block_sizze_85977);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_173089, struct memblock *mem_out_p_173090, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_84157, int64_t b_84158, int64_t block_sizze_84159);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_173095, struct memblock *mem_out_p_173096, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_85036, int64_t b_85037, int64_t block_sizze_85038);
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_173101, struct memblock *mem_out_p_173102, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_83270, int64_t b_83271, int64_t block_sizze_83272);
FUTHARK_FUN_ATTR int futrts_entry_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_173107, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149566, int64_t group_no_149567);
FUTHARK_FUN_ATTR int futrts_entry_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_173108, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_149643, int64_t group_no_149644);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_173109, struct memblock *mem_out_p_173110, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_147656, int64_t dz2081U_147657);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_173111, struct memblock *mem_out_p_173112, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_146866, int64_t dz2081U_146867);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_173113, struct memblock *mem_out_p_173114, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_145286, int64_t dz2081U_145287);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_173115, struct memblock *mem_out_p_173116, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_146076, int64_t dz2081U_146077);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_173117, struct memblock *mem_out_p_173118, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_144496, int64_t dz2081U_144497);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_173119, struct memblock *mem_out_p_173120, int64_t *out_prim_out_173121, struct memblock ks_mem_171818, int64_t dz2080U_149434);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_173124, struct memblock *mem_out_p_173125, int64_t *out_prim_out_173126, struct memblock ks_mem_171818, int64_t dz2080U_149086);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_173129, struct memblock *mem_out_p_173130, int64_t *out_prim_out_173131, struct memblock ks_mem_171818, int64_t dz2080U_148390);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_173134, struct memblock *mem_out_p_173135, int64_t *out_prim_out_173136, struct memblock ks_mem_171818, int64_t dz2080U_148738);
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_173139, struct memblock *mem_out_p_173140, int64_t *out_prim_out_173141, struct memblock ks_mem_171818, int64_t dz2080U_148042);
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_16885(struct futhark_context *ctx, struct memblock *mem_out_p_173144, struct memblock *mem_out_p_173145, int64_t *out_prim_out_173146, int64_t *out_prim_out_173147, int32_t *out_prim_out_173148, struct memblock pXs_mem_171818, int64_t n_129182, int64_t b_129183, int32_t curDepth_129184, int32_t i_129186, int32_t j_129187);
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_173155, int32_t bit_82646, int16_t x_82647);
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_173156, int32_t bit_84412, int64_t x_84413);
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5312(struct futhark_context *ctx, int64_t *out_prim_out_173157, int64_t upper_bound_86947, int64_t n_86948);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16298(struct futhark_context *ctx, struct memblock *mem_out_p_173158, struct memblock nameless_mem_171818, int64_t n_98868, int64_t incr_98869);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16319(struct futhark_context *ctx, struct memblock *mem_out_p_173159, struct memblock nameless_mem_171818, int64_t n_99729, int64_t incr_99730);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16341(struct futhark_context *ctx, struct memblock *mem_out_p_173160, struct memblock nameless_mem_171818, int64_t n_100590, int64_t incr_100591);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16363(struct futhark_context *ctx, struct memblock *mem_out_p_173161, struct memblock nameless_mem_171818, int64_t n_101451, int64_t incr_101452);
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16384(struct futhark_context *ctx, struct memblock *mem_out_p_173162, struct memblock nameless_mem_171818, int64_t n_102333, int64_t incr_102334);
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_15243(struct futhark_context *ctx, int64_t *out_prim_out_173163, int64_t *out_prim_out_173164, int64_t *out_prim_out_173165, int64_t *out_prim_out_173166, int64_t *out_prim_out_173167, int64_t slo_87177, int64_t shi_87178, int64_t tlo_87179, int64_t thi_87180, int64_t count_87181);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15620(struct futhark_context *ctx, struct memblock *mem_out_p_173168, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80196, int64_t n_80197, int32_t n_bits_80198, int64_t psizze_80199);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15632(struct futhark_context *ctx, struct memblock *mem_out_p_173169, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80448, int64_t n_80449, int32_t n_bits_80450, int64_t psizze_80451);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15643(struct futhark_context *ctx, struct memblock *mem_out_p_173170, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80700, int64_t n_80701, int32_t n_bits_80702, int64_t psizze_80703);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15655(struct futhark_context *ctx, struct memblock *mem_out_p_173171, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80952, int64_t n_80953, int32_t n_bits_80954, int64_t psizze_80955);
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15667(struct futhark_context *ctx, struct memblock *mem_out_p_173172, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_81204, int64_t n_81205, int32_t n_bits_81206, int64_t psizze_81207);
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_173173, int32_t bit_82355, int8_t x_82356, int32_t b_82357);

static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
struct futhark_u8_2d {
    struct memblock mem;
    int64_t shape[2];
};
struct futhark_u8_2d *futhark_new_u8_2d(struct futhark_context *ctx, const uint8_t *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * dim1 * 1, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    if ((size_t) (dim0 * dim1) * 1 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) (dim0 * dim1) * 1);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_u8_2d *futhark_new_raw_u8_2d(struct futhark_context *ctx, unsigned char *data, int64_t dim0, int64_t dim1)
{
    int err = 0;
    struct futhark_u8_2d *bad = NULL;
    struct futhark_u8_2d *arr = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    arr->shape[1] = dim1;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr, uint8_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) (arr->shape[0] * arr->shape[1]) * 1 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) (arr->shape[0] * arr->shape[1]) * 1);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_u8_2d(struct futhark_context *ctx, uint8_t *out, struct futhark_u8_2d *arr, int64_t i0, int64_t i1)
{
    int err = 0;
    
    if ((i0 >= 0 && i0 < arr->shape[0]) && (i1 >= 0 && i1 < arr->shape[1])) {
        lock_lock(&ctx->lock);
        if (1 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 1 * (i0 * arr->shape[1] + i1 * 1), 1);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_u8_2d(struct futhark_context *ctx, struct futhark_u8_2d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i16_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i16_1d *futhark_new_i16_1d(struct futhark_context *ctx, const int16_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 2, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 2 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 2);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i16_1d *futhark_new_raw_i16_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i16_1d *bad = NULL;
    struct futhark_i16_1d *arr = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr, int16_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 2 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 2);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i16_1d(struct futhark_context *ctx, int16_t *out, struct futhark_i16_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (2 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 2 * (i0 * 1), 2);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i16_1d(struct futhark_context *ctx, struct futhark_i16_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i32_1d *futhark_new_i32_1d(struct futhark_context *ctx, const int32_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i32_1d *futhark_new_raw_i32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i32_1d *bad = NULL;
    struct futhark_i32_1d *arr = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr, int32_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i32_1d(struct futhark_context *ctx, int32_t *out, struct futhark_i32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i32_1d(struct futhark_context *ctx, struct futhark_i32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_i64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const int64_t *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr, int64_t *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_i64_1d(struct futhark_context *ctx, int64_t *out, struct futhark_i64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f32_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f32_1d *futhark_new_f32_1d(struct futhark_context *ctx, const float *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 4, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 4 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 4);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f32_1d *futhark_new_raw_f32_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f32_1d *bad = NULL;
    struct futhark_f32_1d *arr = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr, float *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 4 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 4);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f32_1d(struct futhark_context *ctx, float *out, struct futhark_f32_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (4 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 4 * (i0 * 1), 4);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f32_1d(struct futhark_context *ctx, struct futhark_f32_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock mem;
    int64_t shape[1];
};
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const double *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    if (memblock_alloc(ctx, &arr->mem, dim0 * 8, "arr->mem"))
        err = 1;
    arr->shape[0] = dim0;
    if ((size_t) dim0 * 8 > 0)
        memmove(arr->mem.mem + 0, (const unsigned char *) data + 0, (size_t) dim0 * 8);
    lock_unlock(&ctx->lock);
    if (err != 0) {
        free(arr);
        return bad;
    }
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, unsigned char *data, int64_t dim0)
{
    int err = 0;
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    arr->mem.references = NULL;
    arr->mem.mem = data;
    arr->shape[0] = dim0;
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    if (memblock_unref(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr, double *data)
{
    int err = 0;
    
    lock_lock(&ctx->lock);
    if ((size_t) arr->shape[0] * 8 > 0)
        memmove((unsigned char *) data + 0, arr->mem.mem + 0, (size_t) arr->shape[0] * 8);
    lock_unlock(&ctx->lock);
    return err;
}
int futhark_index_f64_1d(struct futhark_context *ctx, double *out, struct futhark_f64_1d *arr, int64_t i0)
{
    int err = 0;
    
    if (i0 >= 0 && i0 < arr->shape[0]) {
        lock_lock(&ctx->lock);
        if (8 > 0)
            memmove((unsigned char *) out + 0, arr->mem.mem + 8 * (i0 * 1), 8);
        lock_unlock(&ctx->lock);
    } else {
        err = 1;
        set_error(ctx, strdup("Index out of bounds."));
    }
    return err;
}
unsigned char *futhark_values_raw_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_opaque_sortStruct_short {
    struct futhark_i16_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_short_k(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_short_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out, const struct futhark_i16_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_short *v = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i16_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_short(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v0)[0] * sizeof(int16_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_short *futhark_restore_opaque_sortStruct_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_short *obj = malloc(sizeof(struct futhark_opaque_sortStruct_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int16_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i16_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_int {
    struct futhark_i32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_int_k(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_int_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out, const struct futhark_i32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_int *v = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_int(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v0)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_int *futhark_restore_opaque_sortStruct_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_int *obj = malloc(sizeof(struct futhark_opaque_sortStruct_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int32_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_long {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_long_k(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_long_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out, const struct futhark_i64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_long *v = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_long(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_long *futhark_restore_opaque_sortStruct_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_long *obj = malloc(sizeof(struct futhark_opaque_sortStruct_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_float {
    struct futhark_f32_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_float_k(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_float_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out, const struct futhark_f32_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_float *v = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f32_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_float(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v0)[0] * sizeof(float);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_float *futhark_restore_opaque_sortStruct_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_float *obj = malloc(sizeof(struct futhark_opaque_sortStruct_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(float);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f32_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortStruct_double {
    struct futhark_f64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_sortStruct_double_k(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortStruct_double_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out, const struct futhark_f64_1d *f_k, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_sortStruct_double *v = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_f64_1d));
        *v->v0 = *f_k;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortStruct_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortStruct_double(struct futhark_context *ctx, const struct futhark_opaque_sortStruct_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v0)[0] * sizeof(double);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_sortStruct_double *futhark_restore_opaque_sortStruct_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortStruct_double *obj = malloc(sizeof(struct futhark_opaque_sortStruct_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(double);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_f64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_short {
    struct futhark_i64_1d *v0;
    struct futhark_i16_1d *v1;
};
int futhark_project_opaque_sortInfo_short_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_short_xs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out, const struct futhark_i64_1d *f_is, const struct futhark_i16_1d *f_xs)
{
    struct futhark_opaque_sortInfo_short *v = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i16_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_short(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v1)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_short *futhark_restore_opaque_sortInfo_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_short *obj = malloc(sizeof(struct futhark_opaque_sortInfo_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i16_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_int {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
};
int futhark_project_opaque_sortInfo_int_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_int_xs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out, const struct futhark_i64_1d *f_is, const struct futhark_i32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_int *v = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_int(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_int *futhark_restore_opaque_sortInfo_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_int *obj = malloc(sizeof(struct futhark_opaque_sortInfo_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortInfo_long_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_long_xs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out, const struct futhark_i64_1d *f_is, const struct futhark_i64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_long *v = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_long(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortInfo_long *futhark_restore_opaque_sortInfo_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_long *obj = malloc(sizeof(struct futhark_opaque_sortInfo_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_float {
    struct futhark_i64_1d *v0;
    struct futhark_f32_1d *v1;
};
int futhark_project_opaque_sortInfo_float_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_float_xs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out, const struct futhark_i64_1d *f_is, const struct futhark_f32_1d *f_xs)
{
    struct futhark_opaque_sortInfo_float *v = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f32_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_float(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v1)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_sortInfo_float *futhark_restore_opaque_sortInfo_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_float *obj = malloc(sizeof(struct futhark_opaque_sortInfo_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortInfo_double {
    struct futhark_i64_1d *v0;
    struct futhark_f64_1d *v1;
};
int futhark_project_opaque_sortInfo_double_is(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortInfo_double_xs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out, const struct futhark_i64_1d *f_is, const struct futhark_f64_1d *f_xs)
{
    struct futhark_opaque_sortInfo_double *v = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_is;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_f64_1d));
        *v->v1 = *f_xs;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortInfo_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortInfo_double(struct futhark_context *ctx, const struct futhark_opaque_sortInfo_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v1)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_sortInfo_double *futhark_restore_opaque_sortInfo_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortInfo_double *obj = malloc(sizeof(struct futhark_opaque_sortInfo_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_f64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_short {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i16_1d *v2;
};
int futhark_project_opaque_joinPairs_short_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_short_vs(struct futhark_context *ctx, struct futhark_i16_1d **out, const struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    struct futhark_i16_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i16_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i16_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i16_1d *f_vs)
{
    struct futhark_opaque_joinPairs_short *v = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i16_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_short(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_short *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i16", 4);
        out += 4;
        memcpy(out, futhark_shape_i16_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i16_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i16_1d(ctx, obj->v2)[0] * sizeof(int16_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_short *futhark_restore_opaque_joinPairs_short(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_short *obj = malloc(sizeof(struct futhark_opaque_joinPairs_short));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i16", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int16_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i16_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i16_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_int {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i32_1d *v2;
};
int futhark_project_opaque_joinPairs_int_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_int_vs(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_int *v = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_int(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_int *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v2)[0] * sizeof(int32_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_int *futhark_restore_opaque_joinPairs_int(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_int *obj = malloc(sizeof(struct futhark_opaque_joinPairs_int));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int32_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_long {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_i64_1d *v2;
};
int futhark_project_opaque_joinPairs_long_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_long_vs(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_i64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_long *v = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_i64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_long(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_long *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v2)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_long *futhark_restore_opaque_joinPairs_long(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_long *obj = malloc(sizeof(struct futhark_opaque_joinPairs_long));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_i64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_float {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f32_1d *v2;
};
int futhark_project_opaque_joinPairs_float_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_float_vs(struct futhark_context *ctx, struct futhark_f32_1d **out, const struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    struct futhark_f32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f32_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f32_1d *f_vs)
{
    struct futhark_opaque_joinPairs_float *v = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f32_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_float(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_float *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f32", 4);
        out += 4;
        memcpy(out, futhark_shape_f32_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f32_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f32_1d(ctx, obj->v2)[0] * sizeof(float);
    }
    return ret;
}
struct futhark_opaque_joinPairs_float *futhark_restore_opaque_joinPairs_float(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_float *obj = malloc(sizeof(struct futhark_opaque_joinPairs_float));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(float);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f32_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f32_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_double {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_f64_1d *v2;
};
int futhark_project_opaque_joinPairs_double_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_double_vs(struct futhark_context *ctx, struct futhark_f64_1d **out, const struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    struct futhark_f64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_f64_1d));
    memcpy(v, obj->v2, sizeof(struct futhark_f64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_f64_1d *f_vs)
{
    struct futhark_opaque_joinPairs_double *v = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_f64_1d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_double(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_double *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 1 * sizeof(int64_t) + futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " f64", 4);
        out += 4;
        memcpy(out, futhark_shape_f64_1d(ctx, obj->v2), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_f64_1d(ctx, obj->v2, (void *) out);
        out += futhark_shape_f64_1d(ctx, obj->v2)[0] * sizeof(double);
    }
    return ret;
}
struct futhark_opaque_joinPairs_double *futhark_restore_opaque_joinPairs_double(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_double *obj = malloc(sizeof(struct futhark_opaque_joinPairs_double));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " f64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * sizeof(double);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_f64_1d(ctx, data_2, shape_2[0]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_f64_1d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFTR {
    struct futhark_u8_2d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFTR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v0, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFTR_pL(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out, const struct futhark_u8_2d *f_ks, const struct futhark_u8_2d *f_pL)
{
    struct futhark_opaque_partitionedSet_GFTR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_u8_2d));
        *v->v0 = *f_ks;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_pL;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFTR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v0), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v0, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v0)[0] * futhark_shape_u8_2d(ctx, obj->v0)[1] * sizeof(int8_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFTR *futhark_restore_opaque_partitionedSet_GFTR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFTR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR));
    int64_t shape_0[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * shape_0[1] * sizeof(int8_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_u8_2d(ctx, data_0, shape_0[0], shape_0[1]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionedSet_GFUR {
    struct futhark_i64_1d *v0;
    struct futhark_u8_2d *v1;
};
int futhark_project_opaque_partitionedSet_GFUR_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionedSet_GFUR_ks(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v1, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out, const struct futhark_i64_1d *f_idx, const struct futhark_u8_2d *f_ks)
{
    struct futhark_opaque_partitionedSet_GFUR *v = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_u8_2d));
        *v->v1 = *f_ks;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionedSet_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const struct futhark_opaque_partitionedSet_GFUR *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v1), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v1, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v1)[0] * futhark_shape_u8_2d(ctx, obj->v1)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_partitionedSet_GFUR *futhark_restore_opaque_partitionedSet_GFUR(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionedSet_GFUR *obj = malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * shape_1[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_u8_2d(ctx, data_1, shape_1[0], shape_1[1]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_partitionInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i32_1d *v1;
    int32_t v2;
};
int futhark_project_opaque_partitionInfo_bounds(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_depths(struct futhark_context *ctx, struct futhark_i32_1d **out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    struct futhark_i32_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i32_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i32_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_partitionInfo_maxDepth(struct futhark_context *ctx, int32_t *out, const struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int32_t v;
    
    v = obj->v2;
    *out = v;
    return 0;
}
int futhark_new_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out, const struct futhark_i64_1d *f_bounds, const struct futhark_i32_1d *f_depths, const int32_t f_maxDepth)
{
    struct futhark_opaque_partitionInfo *v = malloc(sizeof(struct futhark_opaque_partitionInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_bounds;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i32_1d));
        *v->v1 = *f_depths;
        (void) (*v->v1->mem.references)++;
    }
    v->v2 = f_maxDepth;
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_partitionInfo(struct futhark_context *ctx, struct futhark_opaque_partitionInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_partitionInfo(struct futhark_context *ctx, const struct futhark_opaque_partitionInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
    int64_t size_2 = 7 + 0 * sizeof(int64_t) + 1 * sizeof(int32_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, futhark_shape_i32_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i32_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i32_1d(ctx, obj->v1)[0] * sizeof(int32_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 0;
        memcpy(out, " i32", 4);
        out += 4;
        memcpy(out, &obj->v2, sizeof(obj->v2));
        out += sizeof(obj->v2);
    }
    return ret;
}
struct futhark_opaque_partitionInfo *futhark_restore_opaque_partitionInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_partitionInfo *obj = malloc(sizeof(struct futhark_opaque_partitionInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int32_t);
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 0;
    err |= memcmp(src, " i32", 4) != 0;
    src += 4;
    if (err == 0) {
        src += 0 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    src += sizeof(obj->v2);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i32_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        memcpy(&obj->v2, data_2, sizeof(obj->v2));
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i32_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_radix_hashTable {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_radix_hashTable_first_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_radix_hashTable_last_info_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out, const struct futhark_i64_1d *f_first_info_idx, const struct futhark_i64_1d *f_last_info_idx)
{
    struct futhark_opaque_radix_hashTable *v = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_first_info_idx;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_last_info_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_radix_hashTable(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_radix_hashTable(struct futhark_context *ctx, const struct futhark_opaque_radix_hashTable *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_radix_hashTable *futhark_restore_opaque_radix_hashTable(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_radix_hashTable *obj = malloc(sizeof(struct futhark_opaque_radix_hashTable));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_joinPairs_bsq {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
    struct futhark_u8_2d *v2;
};
int futhark_project_opaque_joinPairs_bsq_ix(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_iy(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_joinPairs_bsq_vs(struct futhark_context *ctx, struct futhark_u8_2d **out, const struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    struct futhark_u8_2d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_u8_2d));
    memcpy(v, obj->v2, sizeof(struct futhark_u8_2d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out, const struct futhark_i64_1d *f_ix, const struct futhark_i64_1d *f_iy, const struct futhark_u8_2d *f_vs)
{
    struct futhark_opaque_joinPairs_bsq *v = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_ix;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_iy;
        (void) (*v->v1->mem.references)++;
    }
    {
        v->v2 = malloc(sizeof(struct futhark_u8_2d));
        *v->v2 = *f_vs;
        (void) (*v->v2->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_joinPairs_bsq(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_joinPairs_bsq(struct futhark_context *ctx, const struct futhark_opaque_joinPairs_bsq *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    int64_t size_2 = 7 + 2 * sizeof(int64_t) + futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    
    *n = size_0 + size_1 + size_2;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 2;
        memcpy(out, "  u8", 4);
        out += 4;
        memcpy(out, futhark_shape_u8_2d(ctx, obj->v2), 2 * sizeof(int64_t));
        out += 2 * sizeof(int64_t);
        ret |= futhark_values_u8_2d(ctx, obj->v2, (void *) out);
        out += futhark_shape_u8_2d(ctx, obj->v2)[0] * futhark_shape_u8_2d(ctx, obj->v2)[1] * sizeof(int8_t);
    }
    return ret;
}
struct futhark_opaque_joinPairs_bsq *futhark_restore_opaque_joinPairs_bsq(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_joinPairs_bsq *obj = malloc(sizeof(struct futhark_opaque_joinPairs_bsq));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    
    int64_t shape_2[2] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 2;
    err |= memcmp(src, "  u8", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_2, src, 2 * sizeof(int64_t));
        src += 2 * sizeof(int64_t);
    }
    
    const void *data_2 = src;
    
    obj->v2 = NULL;
    src += shape_2[0] * shape_2[1] * sizeof(int8_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
        obj->v2 = futhark_new_u8_2d(ctx, data_2, shape_2[0], shape_2[1]);
        if (obj->v2 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        if (obj->v2 != NULL && (tmp = futhark_free_u8_2d(ctx, obj->v2)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}
struct futhark_opaque_sortgroupInfo {
    struct futhark_i64_1d *v0;
    struct futhark_i64_1d *v1;
};
int futhark_project_opaque_sortgroupInfo_group_count(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v0, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_project_opaque_sortgroupInfo_group_idx(struct futhark_context *ctx, struct futhark_i64_1d **out, const struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    struct futhark_i64_1d *v;
    
    lock_lock(&ctx->lock);
    v = malloc(sizeof(struct futhark_i64_1d));
    memcpy(v, obj->v1, sizeof(struct futhark_i64_1d));
    (void) (*v->mem.references)++;
    lock_unlock(&ctx->lock);
    *out = v;
    return 0;
}
int futhark_new_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out, const struct futhark_i64_1d *f_group_count, const struct futhark_i64_1d *f_group_idx)
{
    struct futhark_opaque_sortgroupInfo *v = malloc(sizeof(struct futhark_opaque_sortgroupInfo));
    
    lock_lock(&ctx->lock);
    {
        v->v0 = malloc(sizeof(struct futhark_i64_1d));
        *v->v0 = *f_group_count;
        (void) (*v->v0->mem.references)++;
    }
    {
        v->v1 = malloc(sizeof(struct futhark_i64_1d));
        *v->v1 = *f_group_idx;
        (void) (*v->v1->mem.references)++;
    }
    lock_unlock(&ctx->lock);
    *out = v;
    return FUTHARK_SUCCESS;
}
int futhark_free_opaque_sortgroupInfo(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo *obj)
{
    (void) ctx;
    
    int ret = 0, tmp;
    
    if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
        ret = tmp;
    if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
        ret = tmp;
    free(obj);
    return ret;
}
int futhark_store_opaque_sortgroupInfo(struct futhark_context *ctx, const struct futhark_opaque_sortgroupInfo *obj, void **p, size_t *n)
{
    (void) ctx;
    
    int ret = 0;
    int64_t size_0 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
    int64_t size_1 = 7 + 1 * sizeof(int64_t) + futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    
    *n = size_0 + size_1;
    if (p != NULL && *p == NULL)
        *p = malloc(*n);
    if (p != NULL) {
        unsigned char *out = *p;
        
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v0), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v0, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v0)[0] * sizeof(int64_t);
        *out++ = 'b';
        *out++ = 2;
        *out++ = 1;
        memcpy(out, " i64", 4);
        out += 4;
        memcpy(out, futhark_shape_i64_1d(ctx, obj->v1), 1 * sizeof(int64_t));
        out += 1 * sizeof(int64_t);
        ret |= futhark_values_i64_1d(ctx, obj->v1, (void *) out);
        out += futhark_shape_i64_1d(ctx, obj->v1)[0] * sizeof(int64_t);
    }
    return ret;
}
struct futhark_opaque_sortgroupInfo *futhark_restore_opaque_sortgroupInfo(struct futhark_context *ctx, const void *p)
{
    (void) ctx;
    
    int err = 0;
    const unsigned char *src = p;
    struct futhark_opaque_sortgroupInfo *obj = malloc(sizeof(struct futhark_opaque_sortgroupInfo));
    int64_t shape_0[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_0, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_0 = src;
    
    obj->v0 = NULL;
    src += shape_0[0] * sizeof(int64_t);
    
    int64_t shape_1[1] = {0};
    
    err |= *src++ != 'b';
    err |= *src++ != 2;
    err |= *src++ != 1;
    err |= memcmp(src, " i64", 4) != 0;
    src += 4;
    if (err == 0) {
        memcpy(shape_1, src, 1 * sizeof(int64_t));
        src += 1 * sizeof(int64_t);
    }
    
    const void *data_1 = src;
    
    obj->v1 = NULL;
    src += shape_1[0] * sizeof(int64_t);
    if (err == 0) {
        obj->v0 = futhark_new_i64_1d(ctx, data_0, shape_0[0]);
        if (obj->v0 == NULL)
            err = 1;
        obj->v1 = futhark_new_i64_1d(ctx, data_1, shape_1[0]);
        if (obj->v1 == NULL)
            err = 1;
    }
    if (err != 0) {
        int ret = 0, tmp;
        
        if (obj->v0 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v0)) != 0)
            ret = tmp;
        if (obj->v1 != NULL && (tmp = futhark_free_i64_1d(ctx, obj->v1)) != 0)
            ret = tmp;
        free(obj);
        obj = NULL;
    }
    return obj;
}

FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct memblock *mem_out_p_172688, struct memblock *mem_out_p_172689, struct memblock *mem_out_p_172690, int64_t *out_prim_out_172691, struct memblock pR_mem_171818, struct memblock pS_mem_171819, struct memblock bounds_mem_171820, struct memblock depths_mem_171821, struct memblock first_info_idx_mem_171822, struct memblock last_info_idx_mem_171823, int64_t nR_141120, int64_t b_141121, int64_t nS_141122, int64_t dz2081U_141123, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, int32_t radix_sizze_141125, int32_t maxDepth_141130)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171825_cached_sizze_172692 = 0;
    unsigned char *mem_171825 = NULL;
    int64_t mem_171833_cached_sizze_172693 = 0;
    unsigned char *mem_171833 = NULL;
    int64_t mem_171835_cached_sizze_172694 = 0;
    unsigned char *mem_171835 = NULL;
    int64_t mem_171837_cached_sizze_172695 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172696 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171841_cached_sizze_172697 = 0;
    unsigned char *mem_171841 = NULL;
    int64_t mem_171843_cached_sizze_172698 = 0;
    unsigned char *mem_171843 = NULL;
    int64_t mem_171881_cached_sizze_172699 = 0;
    unsigned char *mem_171881 = NULL;
    int64_t mem_171889_cached_sizze_172700 = 0;
    unsigned char *mem_171889 = NULL;
    int64_t mem_171891_cached_sizze_172701 = 0;
    unsigned char *mem_171891 = NULL;
    int64_t mem_171963_cached_sizze_172702 = 0;
    unsigned char *mem_171963 = NULL;
    int64_t mem_171971_cached_sizze_172703 = 0;
    unsigned char *mem_171971 = NULL;
    int64_t mem_171973_cached_sizze_172704 = 0;
    unsigned char *mem_171973 = NULL;
    int64_t mem_171975_cached_sizze_172705 = 0;
    unsigned char *mem_171975 = NULL;
    int64_t mem_171977_cached_sizze_172706 = 0;
    unsigned char *mem_171977 = NULL;
    int64_t mem_171979_cached_sizze_172707 = 0;
    unsigned char *mem_171979 = NULL;
    int64_t mem_171981_cached_sizze_172708 = 0;
    unsigned char *mem_171981 = NULL;
    int64_t mem_172019_cached_sizze_172709 = 0;
    unsigned char *mem_172019 = NULL;
    int64_t mem_172027_cached_sizze_172710 = 0;
    unsigned char *mem_172027 = NULL;
    int64_t mem_172029_cached_sizze_172711 = 0;
    unsigned char *mem_172029 = NULL;
    int64_t mem_172109_cached_sizze_172712 = 0;
    unsigned char *mem_172109 = NULL;
    int64_t mem_172117_cached_sizze_172713 = 0;
    unsigned char *mem_172117 = NULL;
    int64_t mem_172119_cached_sizze_172714 = 0;
    unsigned char *mem_172119 = NULL;
    int64_t mem_172121_cached_sizze_172715 = 0;
    unsigned char *mem_172121 = NULL;
    int64_t mem_172123_cached_sizze_172716 = 0;
    unsigned char *mem_172123 = NULL;
    int64_t mem_172125_cached_sizze_172717 = 0;
    unsigned char *mem_172125 = NULL;
    int64_t mem_172127_cached_sizze_172718 = 0;
    unsigned char *mem_172127 = NULL;
    int64_t mem_172165_cached_sizze_172719 = 0;
    unsigned char *mem_172165 = NULL;
    int64_t mem_172173_cached_sizze_172720 = 0;
    unsigned char *mem_172173 = NULL;
    int64_t mem_172175_cached_sizze_172721 = 0;
    unsigned char *mem_172175 = NULL;
    int64_t mem_172254_cached_sizze_172722 = 0;
    unsigned char *mem_172254 = NULL;
    int64_t mem_172262_cached_sizze_172723 = 0;
    unsigned char *mem_172262 = NULL;
    int64_t mem_172264_cached_sizze_172724 = 0;
    unsigned char *mem_172264 = NULL;
    int64_t mem_172266_cached_sizze_172725 = 0;
    unsigned char *mem_172266 = NULL;
    int64_t mem_172268_cached_sizze_172726 = 0;
    unsigned char *mem_172268 = NULL;
    int64_t mem_172270_cached_sizze_172727 = 0;
    unsigned char *mem_172270 = NULL;
    int64_t mem_172271_cached_sizze_172728 = 0;
    unsigned char *mem_172271 = NULL;
    int64_t mem_172309_cached_sizze_172729 = 0;
    unsigned char *mem_172309 = NULL;
    int64_t mem_172317_cached_sizze_172730 = 0;
    unsigned char *mem_172317 = NULL;
    int64_t mem_172319_cached_sizze_172731 = 0;
    unsigned char *mem_172319 = NULL;
    struct memblock mem_171961;
    
    mem_171961.references = NULL;
    
    struct memblock mem_171945;
    
    mem_171945.references = NULL;
    
    struct memblock mem_171943;
    
    mem_171943.references = NULL;
    
    struct memblock mem_param_tmp_172678;
    
    mem_param_tmp_172678.references = NULL;
    
    struct memblock mem_param_tmp_172677;
    
    mem_param_tmp_172677.references = NULL;
    
    struct memblock mem_171923;
    
    mem_171923.references = NULL;
    
    struct memblock mem_171921;
    
    mem_171921.references = NULL;
    
    struct memblock mem_param_171919;
    
    mem_param_171919.references = NULL;
    
    struct memblock mem_param_171916;
    
    mem_param_171916.references = NULL;
    
    struct memblock ext_mem_171940;
    
    ext_mem_171940.references = NULL;
    
    struct memblock ext_mem_171941;
    
    ext_mem_171941.references = NULL;
    
    struct memblock mem_171913;
    
    mem_171913.references = NULL;
    
    struct memblock mem_171905;
    
    mem_171905.references = NULL;
    
    struct memblock mem_172099;
    
    mem_172099.references = NULL;
    
    struct memblock mem_172083;
    
    mem_172083.references = NULL;
    
    struct memblock mem_172081;
    
    mem_172081.references = NULL;
    
    struct memblock mem_param_tmp_172632;
    
    mem_param_tmp_172632.references = NULL;
    
    struct memblock mem_param_tmp_172631;
    
    mem_param_tmp_172631.references = NULL;
    
    struct memblock mem_172061;
    
    mem_172061.references = NULL;
    
    struct memblock mem_172059;
    
    mem_172059.references = NULL;
    
    struct memblock mem_param_172057;
    
    mem_param_172057.references = NULL;
    
    struct memblock mem_param_172054;
    
    mem_param_172054.references = NULL;
    
    struct memblock ext_mem_172078;
    
    ext_mem_172078.references = NULL;
    
    struct memblock ext_mem_172079;
    
    ext_mem_172079.references = NULL;
    
    struct memblock mem_172051;
    
    mem_172051.references = NULL;
    
    struct memblock mem_172043;
    
    mem_172043.references = NULL;
    
    struct memblock ext_mem_172103;
    
    ext_mem_172103.references = NULL;
    
    struct memblock ext_mem_172106;
    
    ext_mem_172106.references = NULL;
    
    struct memblock ext_mem_172107;
    
    ext_mem_172107.references = NULL;
    
    struct memblock mem_172245;
    
    mem_172245.references = NULL;
    
    struct memblock mem_172229;
    
    mem_172229.references = NULL;
    
    struct memblock mem_172227;
    
    mem_172227.references = NULL;
    
    struct memblock mem_param_tmp_172586;
    
    mem_param_tmp_172586.references = NULL;
    
    struct memblock mem_param_tmp_172585;
    
    mem_param_tmp_172585.references = NULL;
    
    struct memblock mem_172207;
    
    mem_172207.references = NULL;
    
    struct memblock mem_172205;
    
    mem_172205.references = NULL;
    
    struct memblock mem_param_172203;
    
    mem_param_172203.references = NULL;
    
    struct memblock mem_param_172200;
    
    mem_param_172200.references = NULL;
    
    struct memblock ext_mem_172224;
    
    ext_mem_172224.references = NULL;
    
    struct memblock ext_mem_172225;
    
    ext_mem_172225.references = NULL;
    
    struct memblock mem_172197;
    
    mem_172197.references = NULL;
    
    struct memblock mem_172189;
    
    mem_172189.references = NULL;
    
    struct memblock ext_mem_172249;
    
    ext_mem_172249.references = NULL;
    
    struct memblock ext_mem_172252;
    
    ext_mem_172252.references = NULL;
    
    struct memblock ext_mem_172253;
    
    ext_mem_172253.references = NULL;
    
    struct memblock mem_172389;
    
    mem_172389.references = NULL;
    
    struct memblock mem_172373;
    
    mem_172373.references = NULL;
    
    struct memblock mem_172371;
    
    mem_172371.references = NULL;
    
    struct memblock mem_param_tmp_172540;
    
    mem_param_tmp_172540.references = NULL;
    
    struct memblock mem_param_tmp_172539;
    
    mem_param_tmp_172539.references = NULL;
    
    struct memblock mem_172351;
    
    mem_172351.references = NULL;
    
    struct memblock mem_172349;
    
    mem_172349.references = NULL;
    
    struct memblock mem_param_172347;
    
    mem_param_172347.references = NULL;
    
    struct memblock mem_param_172344;
    
    mem_param_172344.references = NULL;
    
    struct memblock ext_mem_172368;
    
    ext_mem_172368.references = NULL;
    
    struct memblock ext_mem_172369;
    
    ext_mem_172369.references = NULL;
    
    struct memblock mem_172341;
    
    mem_172341.references = NULL;
    
    struct memblock mem_172333;
    
    mem_172333.references = NULL;
    
    struct memblock ext_mem_172393;
    
    ext_mem_172393.references = NULL;
    
    struct memblock ext_mem_172396;
    
    ext_mem_172396.references = NULL;
    
    struct memblock ext_mem_172397;
    
    ext_mem_172397.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t i32_res_159240 = sext_i32_i64(radix_sizze_141125);
    bool nonnegative_159241 = sle64((int64_t) 0, i32_res_159240);
    bool nonzzero_cert_159242;
    
    if (!nonnegative_159241) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:7:47-274:55\n   #1  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_159243 = shl64((int64_t) 1, i32_res_159240);
    bool assert_cond_159244 = arg_159243 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124;
    bool assert_c_159245;
    
    if (!assert_cond_159244) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:274:6-276:20\n   #1  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_159246 = b_141121 == (int64_t) 1;
    bool cond_159247 = b_141121 == (int64_t) 2;
    bool cond_159248 = sle64(b_141121, (int64_t) 4);
    int64_t unsign_arg0_159249 = zext_i32_i64(radix_sizze_141125);
    int64_t asPow_159250 = shl64((int64_t) 1, unsign_arg0_159249);
    int64_t u64_arg0_159251 = sub64(asPow_159250, (int64_t) 1);
    int64_t zeze_rhs_159252 = sub64(dz2081U_141123, (int64_t) 1);
    bool cond_159253 = nR_141120 == (int64_t) 0;
    bool x_159254 = !cond_159253;
    int64_t tmp_159255 = sub64(nR_141120, (int64_t) 1);
    bool x_159256 = sle64((int64_t) 0, tmp_159255);
    bool y_159257 = slt64(tmp_159255, nR_141120);
    bool bounds_check_159258 = x_159256 && y_159257;
    bool protect_assert_disj_159259 = cond_159253 || bounds_check_159258;
    bool protect_assert_disj_159260 = cond_159248 || protect_assert_disj_159259;
    bool protect_assert_disj_159261 = cond_159247 || protect_assert_disj_159260;
    bool protect_assert_disj_159262 = cond_159246 || protect_assert_disj_159261;
    bool index_certs_159263;
    
    if (!protect_assert_disj_159262) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_159255, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-856:46\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t u64_res_159264 = zext_i64_i32(asPow_159250);
    int32_t za_rhs_159265 = sub32(u64_res_159264, 1);
    bool loop_not_taken_159266 = !cond_159248;
    bool protect_assert_disj_159267 = protect_assert_disj_159259 || loop_not_taken_159266;
    bool protect_assert_disj_159268 = cond_159247 || protect_assert_disj_159267;
    bool protect_assert_disj_159269 = cond_159246 || protect_assert_disj_159268;
    bool index_certs_159270;
    
    if (!protect_assert_disj_159269) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_159255, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-855:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int16_t u64_res_159271 = zext_i64_i16(u64_arg0_159251);
    bool loop_not_taken_159272 = !cond_159247;
    bool protect_assert_disj_159273 = protect_assert_disj_159259 || loop_not_taken_159272;
    bool protect_assert_disj_159274 = cond_159246 || protect_assert_disj_159273;
    bool index_certs_159275;
    
    if (!protect_assert_disj_159274) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_159255, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-854:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int8_t u64_res_159276 = zext_i64_i8(u64_arg0_159251);
    bool loop_not_taken_159277 = !cond_159246;
    bool protect_assert_disj_159278 = protect_assert_disj_159259 || loop_not_taken_159277;
    bool index_certs_159279;
    
    if (!protect_assert_disj_159278) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_159255, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-853:53\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 8 * nS_141122;
    int64_t bytes_171832 = (int64_t) 8 * nR_141120;
    int64_t bytes_171962 = (int64_t) 4 * nS_141122;
    int64_t bytes_171980 = (int64_t) 4 * nR_141120;
    int64_t bytes_172108 = (int64_t) 2 * nS_141122;
    int64_t bytes_172126 = (int64_t) 2 * nR_141120;
    int64_t radix_hash_join_res_159280;
    int64_t radix_hash_join_res_159281;
    int64_t radix_hash_join_res_159282;
    
    if (cond_159246) {
        if (mem_172254_cached_sizze_172722 < nS_141122) {
            err = lexical_realloc(ctx, &mem_172254, &mem_172254_cached_sizze_172722, nS_141122);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < nS_141122; i_171547++) {
            int8_t defunc_0_byteSeq_to_prim_res_169962;
            int8_t y_169964 = (int8_t) 0;
            
            for (int64_t i_169963 = 0; i_169963 < b_141121; i_169963++) {
                int64_t zm_lhs_169965 = sub64(b_141121, i_169963);
                int64_t from_u8_arg0_169966 = sub64(zm_lhs_169965, (int64_t) 1);
                bool x_169967 = sle64((int64_t) 0, from_u8_arg0_169966);
                bool y_169968 = slt64(from_u8_arg0_169966, b_141121);
                bool bounds_check_169969 = x_169967 && y_169968;
                bool index_certs_169970;
                
                if (!bounds_check_169969) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169966, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:423:72-78\n   #2  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_169971 = ((int8_t *) pS_mem_171819.mem)[i_171547 * b_141121 + from_u8_arg0_169966];
                int32_t i64_res_169972 = sext_i64_i32(i_169963);
                int32_t shift_left_rhs_169973 = mul32(8, i64_res_169972);
                int8_t unsign_arg0_169974 = zext_i32_i8(shift_left_rhs_169973);
                int8_t lifted_lambda_res_169975 = shl8(from_u8_arg0_169971, unsign_arg0_169974);
                int8_t unsign_arg0_169976 = y_169964 | lifted_lambda_res_169975;
                int8_t y_tmp_172505 = unsign_arg0_169976;
                
                y_169964 = y_tmp_172505;
            }
            defunc_0_byteSeq_to_prim_res_169962 = y_169964;
            ((int8_t *) mem_172254)[i_171547] = defunc_0_byteSeq_to_prim_res_169962;
        }
        if (mem_172262_cached_sizze_172723 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172262, &mem_172262_cached_sizze_172723, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172264_cached_sizze_172724 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172264, &mem_172264_cached_sizze_172724, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172266_cached_sizze_172725 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172266, &mem_172266_cached_sizze_172725, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172268_cached_sizze_172726 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172268, &mem_172268_cached_sizze_172726, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172270_cached_sizze_172727 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172270, &mem_172270_cached_sizze_172727, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172271_cached_sizze_172728 < nR_141120) {
            err = lexical_realloc(ctx, &mem_172271, &mem_172271_cached_sizze_172728, nR_141120);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171571;
        int64_t discard_171572;
        int64_t defunc_res_169981;
        int64_t scanacc_171555;
        int64_t scanacc_171556;
        int64_t redout_171559;
        
        scanacc_171555 = (int64_t) 0;
        scanacc_171556 = (int64_t) 0;
        redout_171559 = (int64_t) 0;
        for (int64_t i_171564 = 0; i_171564 < nR_141120; i_171564++) {
            int8_t defunc_0_byteSeq_to_prim_res_169987;
            int8_t y_169989 = (int8_t) 0;
            
            for (int64_t i_169988 = 0; i_169988 < b_141121; i_169988++) {
                int64_t zm_lhs_169990 = sub64(b_141121, i_169988);
                int64_t from_u8_arg0_169991 = sub64(zm_lhs_169990, (int64_t) 1);
                bool x_169992 = sle64((int64_t) 0, from_u8_arg0_169991);
                bool y_169993 = slt64(from_u8_arg0_169991, b_141121);
                bool bounds_check_169994 = x_169992 && y_169993;
                bool index_certs_169995;
                
                if (!bounds_check_169994) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_169991, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:423:72-78\n   #2  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_169996 = ((int8_t *) pR_mem_171818.mem)[i_171564 * b_141121 + from_u8_arg0_169991];
                int32_t i64_res_169997 = sext_i64_i32(i_169988);
                int32_t shift_left_rhs_169998 = mul32(8, i64_res_169997);
                int8_t unsign_arg0_169999 = zext_i32_i8(shift_left_rhs_169998);
                int8_t lifted_lambda_res_170000 = shl8(from_u8_arg0_169996, unsign_arg0_169999);
                int8_t unsign_arg0_170001 = y_169989 | lifted_lambda_res_170000;
                int8_t y_tmp_172515 = unsign_arg0_170001;
                
                y_169989 = y_tmp_172515;
            }
            defunc_0_byteSeq_to_prim_res_169987 = y_169989;
            
            int8_t lifted_lambda_res_170002 = u64_res_159276 & defunc_0_byteSeq_to_prim_res_169987;
            int64_t u8_res_170003 = zext_i8_i64(lifted_lambda_res_170002);
            bool x_170004 = sle64((int64_t) 0, u8_res_170003);
            bool y_170005 = slt64(u8_res_170003, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124);
            bool bounds_check_170006 = x_170004 && y_170005;
            bool index_certs_170007;
            
            if (!bounds_check_170006) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_res_170003, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t spi_170008 = ((int64_t *) first_info_idx_mem_171822.mem)[u8_res_170003];
            bool cond_170009 = slt64(spi_170008, (int64_t) 0);
            int64_t defunc_res_170010;
            
            if (cond_170009) {
                defunc_res_170010 = (int64_t) -1;
            } else {
                int64_t zeze_rhs_170011 = ((int64_t *) last_info_idx_mem_171823.mem)[u8_res_170003];
                bool cond_170012 = spi_170008 == zeze_rhs_170011;
                int64_t defunc_res_f_res_170013;
                
                if (cond_170012) {
                    defunc_res_f_res_170013 = spi_170008;
                } else {
                    int64_t zs_lhs_170014 = sub64(zeze_rhs_170011, spi_170008);
                    int64_t max_arg1_170015 = sdiv64(zs_lhs_170014, (int64_t) 2);
                    int64_t max_res_170016 = smax64((int64_t) 1, max_arg1_170015);
                    bool loop_cond_170017 = slt64((int64_t) 0, max_res_170016);
                    bool bsearch_170018;
                    int64_t bsearch_170019;
                    int64_t bsearch_170020;
                    bool loop_while_170021;
                    int64_t heshi_170022;
                    int64_t step_170023;
                    
                    loop_while_170021 = loop_cond_170017;
                    heshi_170022 = spi_170008;
                    step_170023 = max_res_170016;
                    while (loop_while_170021) {
                        bool x_170024 = sle64((int64_t) 0, heshi_170022);
                        bool y_170025 = slt64(heshi_170022, dz2081U_141123);
                        bool bounds_check_170026 = x_170024 && y_170025;
                        bool index_certs_170027;
                        
                        if (!bounds_check_170026) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_170022, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t cur_S_170045 = ((int64_t *) bounds_mem_171820.mem)[heshi_170022];
                        bool x_170046 = sle64((int64_t) 0, cur_S_170045);
                        bool y_170047 = slt64(cur_S_170045, nS_141122);
                        bool bounds_check_170048 = x_170046 && y_170047;
                        bool index_certs_170049;
                        
                        if (!bounds_check_170048) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_170045, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t cur_depth_170028 = ((int32_t *) depths_mem_171821.mem)[heshi_170022];
                        bool cond_170029 = heshi_170022 == spi_170008;
                        int32_t prev_depth_170030;
                        
                        if (cond_170029) {
                            prev_depth_170030 = cur_depth_170028;
                        } else {
                            int64_t tmp_170031 = sub64(heshi_170022, (int64_t) 1);
                            bool x_170032 = sle64((int64_t) 0, tmp_170031);
                            bool y_170033 = slt64(tmp_170031, dz2081U_141123);
                            bool bounds_check_170034 = x_170032 && y_170033;
                            bool index_certs_170035;
                            
                            if (!bounds_check_170034) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170031, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t prev_depth_f_res_170036 = ((int32_t *) depths_mem_171821.mem)[tmp_170031];
                            
                            prev_depth_170030 = prev_depth_f_res_170036;
                        }
                        
                        bool cond_170037 = heshi_170022 == zeze_rhs_170011;
                        int32_t next_depth_170038;
                        
                        if (cond_170037) {
                            next_depth_170038 = cur_depth_170028;
                        } else {
                            int64_t tmp_170039 = add64((int64_t) 1, heshi_170022);
                            bool x_170040 = sle64((int64_t) 0, tmp_170039);
                            bool y_170041 = slt64(tmp_170039, dz2081U_141123);
                            bool bounds_check_170042 = x_170040 && y_170041;
                            bool index_certs_170043;
                            
                            if (!bounds_check_170042) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170039, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t next_depth_f_res_170044 = ((int32_t *) depths_mem_171821.mem)[tmp_170039];
                            
                            next_depth_170038 = next_depth_f_res_170044;
                        }
                        
                        int8_t cur_S_170050 = ((int8_t *) mem_172254)[cur_S_170045];
                        int8_t prev_S_170051;
                        
                        if (cond_170029) {
                            prev_S_170051 = cur_S_170050;
                        } else {
                            int64_t tmp_170052 = sub64(heshi_170022, (int64_t) 1);
                            bool x_170053 = sle64((int64_t) 0, tmp_170052);
                            bool y_170054 = slt64(tmp_170052, dz2081U_141123);
                            bool bounds_check_170055 = x_170053 && y_170054;
                            bool index_certs_170056;
                            
                            if (!bounds_check_170055) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170052, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_170057 = ((int64_t *) bounds_mem_171820.mem)[tmp_170052];
                            bool x_170058 = sle64((int64_t) 0, tmp_170057);
                            bool y_170059 = slt64(tmp_170057, nS_141122);
                            bool bounds_check_170060 = x_170058 && y_170059;
                            bool index_certs_170061;
                            
                            if (!bounds_check_170060) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170057, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t prev_S_f_res_170062 = ((int8_t *) mem_172254)[tmp_170057];
                            
                            prev_S_170051 = prev_S_f_res_170062;
                        }
                        
                        int8_t next_S_170063;
                        
                        if (cond_170037) {
                            next_S_170063 = cur_S_170050;
                        } else {
                            int64_t tmp_170064 = add64((int64_t) 1, heshi_170022);
                            bool x_170065 = sle64((int64_t) 0, tmp_170064);
                            bool y_170066 = slt64(tmp_170064, dz2081U_141123);
                            bool bounds_check_170067 = x_170065 && y_170066;
                            bool index_certs_170068;
                            
                            if (!bounds_check_170067) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170064, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_170069 = ((int64_t *) bounds_mem_171820.mem)[tmp_170064];
                            bool x_170070 = sle64((int64_t) 0, tmp_170069);
                            bool y_170071 = slt64(tmp_170069, nS_141122);
                            bool bounds_check_170072 = x_170070 && y_170071;
                            bool index_certs_170073;
                            
                            if (!bounds_check_170072) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170069, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:594:5-601:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t next_S_f_res_170074 = ((int8_t *) mem_172254)[tmp_170069];
                            
                            next_S_170063 = next_S_f_res_170074;
                        }
                        
                        int32_t prim_get_radix_arg0_170075 = mul32(radix_sizze_141125, cur_depth_170028);
                        int64_t unsign_arg0_170076 = zext_i32_i64(prim_get_radix_arg0_170075);
                        int64_t asPow_170077 = shl64((int64_t) 1, unsign_arg0_170076);
                        int64_t u64_arg0_170078 = sub64(asPow_170077, (int64_t) 1);
                        int8_t u64_res_170079 = zext_i64_i8(u64_arg0_170078);
                        int8_t lifted_lambda_res_170080 = defunc_0_byteSeq_to_prim_res_169987 & u64_res_170079;
                        int8_t lifted_lambda_res_170081 = cur_S_170050 & u64_res_170079;
                        bool defunc_0_eq_res_170082 = lifted_lambda_res_170080 == lifted_lambda_res_170081;
                        int64_t loopres_170083;
                        int64_t loopres_170084;
                        
                        if (defunc_0_eq_res_170082) {
                            loopres_170083 = heshi_170022;
                            loopres_170084 = (int64_t) 0;
                        } else {
                            bool loop_cond_t_res_170085 = slt32(0, cur_depth_170028);
                            bool is_lt_170086;
                            bool is_lt_170087;
                            int32_t is_lt_170088;
                            bool loop_while_170089;
                            bool def_lt_170090;
                            int32_t bi_170091;
                            
                            loop_while_170089 = loop_cond_t_res_170085;
                            def_lt_170090 = 0;
                            bi_170091 = 0;
                            while (loop_while_170089) {
                                int32_t zt_rhs_170092 = add32(1, bi_170091);
                                int32_t prim_get_radix_arg0_170093 = mul32(radix_sizze_141125, zt_rhs_170092);
                                int64_t unsign_arg0_170094 = zext_i32_i64(prim_get_radix_arg0_170093);
                                int64_t asPow_170095 = shl64((int64_t) 1, unsign_arg0_170094);
                                int64_t u64_arg0_170096 = sub64(asPow_170095, (int64_t) 1);
                                int8_t u64_res_170097 = zext_i64_i8(u64_arg0_170096);
                                int8_t lifted_lambda_res_170098 = defunc_0_byteSeq_to_prim_res_169987 & u64_res_170097;
                                int8_t lifted_lambda_res_170099 = cur_S_170050 & u64_res_170097;
                                bool defunc_0_lt_res_170100 = ult8(lifted_lambda_res_170098, lifted_lambda_res_170099);
                                bool defunc_0_lt_res_170101 = ult8(lifted_lambda_res_170099, lifted_lambda_res_170098);
                                bool cond_170102 = !defunc_0_lt_res_170101;
                                bool cond_t_res_170103 = !defunc_0_lt_res_170100;
                                bool x_170104 = cond_170102 && cond_t_res_170103;
                                bool loop_cond_t_res_170105 = slt32(zt_rhs_170092, cur_depth_170028);
                                bool x_170106 = x_170104 && loop_cond_t_res_170105;
                                bool loop_while_tmp_172519 = x_170106;
                                bool def_lt_tmp_172520 = defunc_0_lt_res_170100;
                                int32_t bi_tmp_172521 = zt_rhs_170092;
                                
                                loop_while_170089 = loop_while_tmp_172519;
                                def_lt_170090 = def_lt_tmp_172520;
                                bi_170091 = bi_tmp_172521;
                            }
                            is_lt_170086 = loop_while_170089;
                            is_lt_170087 = def_lt_170090;
                            is_lt_170088 = bi_170091;
                            
                            int64_t loopres_f_res_170107;
                            int64_t loopres_f_res_170108;
                            
                            if (is_lt_170087) {
                                bool loop_cond_t_res_170109 = slt32(0, prev_depth_170030);
                                bool is_gt_170110;
                                bool is_gt_170111;
                                int32_t is_gt_170112;
                                bool loop_while_170113;
                                bool def_gt_170114;
                                int32_t bi_170115;
                                
                                loop_while_170113 = loop_cond_t_res_170109;
                                def_gt_170114 = 0;
                                bi_170115 = 0;
                                while (loop_while_170113) {
                                    int32_t zt_rhs_170116 = add32(1, bi_170115);
                                    int32_t prim_get_radix_arg0_170117 = mul32(radix_sizze_141125, zt_rhs_170116);
                                    int64_t unsign_arg0_170118 = zext_i32_i64(prim_get_radix_arg0_170117);
                                    int64_t asPow_170119 = shl64((int64_t) 1, unsign_arg0_170118);
                                    int64_t u64_arg0_170120 = sub64(asPow_170119, (int64_t) 1);
                                    int8_t u64_res_170121 = zext_i64_i8(u64_arg0_170120);
                                    int8_t lifted_lambda_res_170122 = defunc_0_byteSeq_to_prim_res_169987 & u64_res_170121;
                                    int8_t lifted_lambda_res_170123 = prev_S_170051 & u64_res_170121;
                                    bool defunc_0_gt_res_170124 = ult8(lifted_lambda_res_170123, lifted_lambda_res_170122);
                                    bool defunc_0_gt_res_170125 = ult8(lifted_lambda_res_170122, lifted_lambda_res_170123);
                                    bool cond_170126 = !defunc_0_gt_res_170124;
                                    bool cond_t_res_170127 = !defunc_0_gt_res_170125;
                                    bool x_170128 = cond_170126 && cond_t_res_170127;
                                    bool loop_cond_t_res_170129 = slt32(zt_rhs_170116, prev_depth_170030);
                                    bool x_170130 = x_170128 && loop_cond_t_res_170129;
                                    bool loop_while_tmp_172522 = x_170130;
                                    bool def_gt_tmp_172523 = defunc_0_gt_res_170124;
                                    int32_t bi_tmp_172524 = zt_rhs_170116;
                                    
                                    loop_while_170113 = loop_while_tmp_172522;
                                    def_gt_170114 = def_gt_tmp_172523;
                                    bi_170115 = bi_tmp_172524;
                                }
                                is_gt_170110 = loop_while_170113;
                                is_gt_170111 = def_gt_170114;
                                is_gt_170112 = bi_170115;
                                
                                bool x_170131 = !cond_170029;
                                bool y_170132 = is_gt_170111 && x_170131;
                                bool cond_170133 = cond_170029 || y_170132;
                                int64_t loopres_f_res_t_res_170134;
                                int64_t loopres_f_res_t_res_170135;
                                
                                if (cond_170133) {
                                    loopres_f_res_t_res_170134 = (int64_t) -1;
                                    loopres_f_res_t_res_170135 = (int64_t) 0;
                                } else {
                                    int64_t tmp_170136 = sub64(heshi_170022, step_170023);
                                    int64_t max_arg1_170137 = sdiv64(step_170023, (int64_t) 2);
                                    int64_t max_res_170138 = smax64((int64_t) 1, max_arg1_170137);
                                    
                                    loopres_f_res_t_res_170134 = tmp_170136;
                                    loopres_f_res_t_res_170135 = max_res_170138;
                                }
                                loopres_f_res_170107 = loopres_f_res_t_res_170134;
                                loopres_f_res_170108 = loopres_f_res_t_res_170135;
                            } else {
                                bool loop_cond_t_res_170139 = slt32(0, next_depth_170038);
                                bool is_lt_170140;
                                bool is_lt_170141;
                                int32_t is_lt_170142;
                                bool loop_while_170143;
                                bool def_lt_170144;
                                int32_t bi_170145;
                                
                                loop_while_170143 = loop_cond_t_res_170139;
                                def_lt_170144 = 0;
                                bi_170145 = 0;
                                while (loop_while_170143) {
                                    int32_t zt_rhs_170146 = add32(1, bi_170145);
                                    int32_t prim_get_radix_arg0_170147 = mul32(radix_sizze_141125, zt_rhs_170146);
                                    int64_t unsign_arg0_170148 = zext_i32_i64(prim_get_radix_arg0_170147);
                                    int64_t asPow_170149 = shl64((int64_t) 1, unsign_arg0_170148);
                                    int64_t u64_arg0_170150 = sub64(asPow_170149, (int64_t) 1);
                                    int8_t u64_res_170151 = zext_i64_i8(u64_arg0_170150);
                                    int8_t lifted_lambda_res_170152 = defunc_0_byteSeq_to_prim_res_169987 & u64_res_170151;
                                    int8_t lifted_lambda_res_170153 = next_S_170063 & u64_res_170151;
                                    bool defunc_0_lt_res_170154 = ult8(lifted_lambda_res_170152, lifted_lambda_res_170153);
                                    bool defunc_0_lt_res_170155 = ult8(lifted_lambda_res_170153, lifted_lambda_res_170152);
                                    bool cond_170156 = !defunc_0_lt_res_170155;
                                    bool cond_t_res_170157 = !defunc_0_lt_res_170154;
                                    bool x_170158 = cond_170156 && cond_t_res_170157;
                                    bool loop_cond_t_res_170159 = slt32(zt_rhs_170146, next_depth_170038);
                                    bool x_170160 = x_170158 && loop_cond_t_res_170159;
                                    bool loop_while_tmp_172525 = x_170160;
                                    bool def_lt_tmp_172526 = defunc_0_lt_res_170154;
                                    int32_t bi_tmp_172527 = zt_rhs_170146;
                                    
                                    loop_while_170143 = loop_while_tmp_172525;
                                    def_lt_170144 = def_lt_tmp_172526;
                                    bi_170145 = bi_tmp_172527;
                                }
                                is_lt_170140 = loop_while_170143;
                                is_lt_170141 = def_lt_170144;
                                is_lt_170142 = bi_170145;
                                
                                bool x_170161 = !cond_170037;
                                bool y_170162 = is_lt_170141 && x_170161;
                                bool cond_170163 = cond_170037 || y_170162;
                                int64_t loopres_f_res_f_res_170164;
                                int64_t loopres_f_res_f_res_170165;
                                
                                if (cond_170163) {
                                    loopres_f_res_f_res_170164 = (int64_t) -1;
                                    loopres_f_res_f_res_170165 = (int64_t) 0;
                                } else {
                                    int64_t tmp_170166 = add64(heshi_170022, step_170023);
                                    int64_t max_arg1_170167 = sdiv64(step_170023, (int64_t) 2);
                                    int64_t max_res_170168 = smax64((int64_t) 1, max_arg1_170167);
                                    
                                    loopres_f_res_f_res_170164 = tmp_170166;
                                    loopres_f_res_f_res_170165 = max_res_170168;
                                }
                                loopres_f_res_170107 = loopres_f_res_f_res_170164;
                                loopres_f_res_170108 = loopres_f_res_f_res_170165;
                            }
                            loopres_170083 = loopres_f_res_170107;
                            loopres_170084 = loopres_f_res_170108;
                        }
                        
                        bool loop_cond_170169 = slt64((int64_t) 0, loopres_170084);
                        bool loop_while_tmp_172516 = loop_cond_170169;
                        int64_t heshi_tmp_172517 = loopres_170083;
                        int64_t step_tmp_172518 = loopres_170084;
                        
                        loop_while_170021 = loop_while_tmp_172516;
                        heshi_170022 = heshi_tmp_172517;
                        step_170023 = step_tmp_172518;
                    }
                    bsearch_170018 = loop_while_170021;
                    bsearch_170019 = heshi_170022;
                    bsearch_170020 = step_170023;
                    defunc_res_f_res_170013 = bsearch_170019;
                }
                defunc_res_170010 = defunc_res_f_res_170013;
            }
            
            bool cond_170170 = sle64(defunc_res_170010, (int64_t) 0);
            int64_t inf_170171;
            
            if (cond_170170) {
                inf_170171 = (int64_t) 0;
            } else {
                bool x_170172 = sle64((int64_t) 0, defunc_res_170010);
                bool y_170173 = slt64(defunc_res_170010, dz2081U_141123);
                bool bounds_check_170174 = x_170172 && y_170173;
                bool index_certs_170175;
                
                if (!bounds_check_170174) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_170010, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:602:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-853:53\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t inf_f_res_170176 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_170010];
                
                inf_170171 = inf_f_res_170176;
            }
            
            bool cond_170177 = defunc_res_170010 == zeze_rhs_159252;
            int64_t sup_170178;
            
            if (cond_170177) {
                sup_170178 = nS_141122;
            } else {
                int64_t tmp_170179 = add64((int64_t) 1, defunc_res_170010);
                bool x_170180 = sle64((int64_t) 0, tmp_170179);
                bool y_170181 = slt64(tmp_170179, dz2081U_141123);
                bool bounds_check_170182 = x_170180 && y_170181;
                bool index_certs_170183;
                
                if (!bounds_check_170182) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170179, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:603:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-853:53\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t sup_f_res_170184 = ((int64_t *) bounds_mem_171820.mem)[tmp_170179];
                
                sup_170178 = sup_f_res_170184;
            }
            
            bool loop_cond_170185 = slt64(inf_170171, sup_170178);
            bool lifted_lambda_res_170186;
            int64_t lifted_lambda_res_170187;
            int64_t lifted_lambda_res_170188;
            int64_t lifted_lambda_res_170189;
            bool loop_while_170190;
            int64_t j_170191;
            int64_t duome_170192;
            int64_t i_170193;
            
            loop_while_170190 = loop_cond_170185;
            j_170191 = inf_170171;
            duome_170192 = (int64_t) 0;
            i_170193 = inf_170171;
            while (loop_while_170190) {
                bool x_170194 = sle64((int64_t) 0, i_170193);
                bool y_170195 = slt64(i_170193, nS_141122);
                bool bounds_check_170196 = x_170194 && y_170195;
                bool index_certs_170197;
                
                if (!bounds_check_170196) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_170193, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:606:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-853:53\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_170198 = ((int8_t *) mem_172254)[i_170193];
                bool is_eq_170199 = defunc_0_byteSeq_to_prim_res_169987 == zeze_rhs_170198;
                bool cond_170200 = slt64((int64_t) 0, duome_170192);
                bool cond_170201 = is_eq_170199 || cond_170200;
                int64_t next_j_170202;
                
                if (cond_170201) {
                    next_j_170202 = j_170191;
                } else {
                    int64_t next_j_f_res_170203 = add64((int64_t) 1, j_170191);
                    
                    next_j_170202 = next_j_f_res_170203;
                }
                
                int64_t next_duome_170204;
                
                if (is_eq_170199) {
                    int64_t next_duome_t_res_170205 = add64((int64_t) 1, duome_170192);
                    
                    next_duome_170204 = next_duome_t_res_170205;
                } else {
                    next_duome_170204 = duome_170192;
                }
                
                int64_t tmp_170206 = add64((int64_t) 1, i_170193);
                bool loop_cond_170207 = slt64(tmp_170206, sup_170178);
                bool loop_while_tmp_172528 = loop_cond_170207;
                int64_t j_tmp_172529 = next_j_170202;
                int64_t duome_tmp_172530 = next_duome_170204;
                int64_t i_tmp_172531 = tmp_170206;
                
                loop_while_170190 = loop_while_tmp_172528;
                j_170191 = j_tmp_172529;
                duome_170192 = duome_tmp_172530;
                i_170193 = i_tmp_172531;
            }
            lifted_lambda_res_170186 = loop_while_170190;
            lifted_lambda_res_170187 = j_170191;
            lifted_lambda_res_170188 = duome_170192;
            lifted_lambda_res_170189 = i_170193;
            
            bool cond_170208 = slt64(lifted_lambda_res_170187, sup_170178);
            int64_t lifted_lambda_res_170209;
            
            if (cond_170208) {
                lifted_lambda_res_170209 = lifted_lambda_res_170188;
            } else {
                lifted_lambda_res_170209 = (int64_t) 0;
            }
            
            int64_t lifted_lambda_res_170210;
            
            if (cond_170208) {
                lifted_lambda_res_170210 = lifted_lambda_res_170187;
            } else {
                lifted_lambda_res_170210 = (int64_t) -1;
            }
            
            bool lifted_lambda_res_170211 = slt64((int64_t) 1, lifted_lambda_res_170209);
            int64_t defunc_0_f_res_170212 = btoi_bool_i64(lifted_lambda_res_170211);
            int64_t defunc_0_op_res_170215 = add64(defunc_0_f_res_170212, scanacc_171555);
            int64_t defunc_0_op_res_170218 = add64(lifted_lambda_res_170209, scanacc_171556);
            int64_t zp_res_170221 = add64(lifted_lambda_res_170209, redout_171559);
            
            ((int64_t *) mem_172262)[i_171564] = defunc_0_op_res_170215;
            ((int64_t *) mem_172264)[i_171564] = defunc_0_op_res_170218;
            ((int64_t *) mem_172266)[i_171564] = defunc_0_f_res_170212;
            ((int64_t *) mem_172268)[i_171564] = lifted_lambda_res_170210;
            ((int64_t *) mem_172270)[i_171564] = lifted_lambda_res_170209;
            ((int8_t *) mem_172271)[i_171564] = defunc_0_byteSeq_to_prim_res_169987;
            
            int64_t scanacc_tmp_172506 = defunc_0_op_res_170215;
            int64_t scanacc_tmp_172507 = defunc_0_op_res_170218;
            int64_t redout_tmp_172510 = zp_res_170221;
            
            scanacc_171555 = scanacc_tmp_172506;
            scanacc_171556 = scanacc_tmp_172507;
            redout_171559 = redout_tmp_172510;
        }
        discard_171571 = scanacc_171555;
        discard_171572 = scanacc_171556;
        defunc_res_169981 = redout_171559;
        
        int64_t m_f_res_170249;
        
        if (x_159254) {
            int64_t x_170250 = ((int64_t *) mem_172262)[tmp_159255];
            
            m_f_res_170249 = x_170250;
        } else {
            m_f_res_170249 = (int64_t) 0;
        }
        
        int64_t m_170251;
        
        if (cond_159253) {
            m_170251 = (int64_t) 0;
        } else {
            m_170251 = m_f_res_170249;
        }
        
        bool cond_170252 = slt64((int64_t) 0, m_170251);
        int64_t m_170253 = sub64(m_170251, (int64_t) 1);
        bool i_p_m_t_s_leq_w_170254 = slt64(m_170253, nR_141120);
        bool zzero_leq_i_p_m_t_s_170255 = sle64((int64_t) 0, m_170253);
        bool y_170256 = i_p_m_t_s_leq_w_170254 && zzero_leq_i_p_m_t_s_170255;
        bool i_lte_j_170257 = sle64((int64_t) 0, m_170251);
        bool forwards_ok_170258 = y_170256 && i_lte_j_170257;
        bool eq_x_zz_170259 = (int64_t) 0 == m_f_res_170249;
        bool p_and_eq_x_y_170260 = x_159254 && eq_x_zz_170259;
        bool empty_slice_170261 = cond_159253 || p_and_eq_x_y_170260;
        bool ok_or_empty_170262 = forwards_ok_170258 || empty_slice_170261;
        bool index_certs_170263;
        
        if (!ok_or_empty_170262) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_170251, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-853:53\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_172316 = (int64_t) 8 * m_170251;
        
        if (mem_172317_cached_sizze_172730 < bytes_172316) {
            err = lexical_realloc(ctx, &mem_172317, &mem_172317_cached_sizze_172730, bytes_172316);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172317, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172270, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_170251});
        
        int64_t max_mult_170266;
        
        if (cond_170252) {
            if (mem_172319_cached_sizze_172731 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172319, &mem_172319_cached_sizze_172731, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171579 = 0; i_171579 < nR_141120; i_171579++) {
                int64_t eta_p_170268 = ((int64_t *) mem_172266)[i_171579];
                int64_t eta_p_170269 = ((int64_t *) mem_172262)[i_171579];
                bool cond_170270 = eta_p_170268 == (int64_t) 1;
                int64_t lifted_lambda_res_170271;
                
                if (cond_170270) {
                    int64_t lifted_lambda_res_t_res_170272 = sub64(eta_p_170269, (int64_t) 1);
                    
                    lifted_lambda_res_170271 = lifted_lambda_res_t_res_170272;
                } else {
                    lifted_lambda_res_170271 = (int64_t) -1;
                }
                ((int64_t *) mem_172319)[i_171579] = lifted_lambda_res_170271;
            }
            for (int64_t write_iter_171581 = 0; write_iter_171581 < nR_141120; write_iter_171581++) {
                int64_t write_iv_171583 = ((int64_t *) mem_172319)[write_iter_171581];
                int64_t write_iv_171584 = ((int64_t *) mem_172270)[write_iter_171581];
                
                if (sle64((int64_t) 0, write_iv_171583) && slt64(write_iv_171583, m_170251)) {
                    ((int64_t *) mem_172317)[write_iv_171583] = write_iv_171584;
                }
            }
            
            int64_t defunc_0_reduce_res_170284;
            int64_t redout_171586 = (int64_t) -9223372036854775808;
            
            for (int64_t i_171587 = 0; i_171587 < m_170251; i_171587++) {
                int64_t x_170285 = ((int64_t *) mem_172317)[i_171587];
                int64_t max_res_170288 = smax64(x_170285, redout_171586);
                int64_t redout_tmp_172534 = max_res_170288;
                
                redout_171586 = redout_tmp_172534;
            }
            defunc_0_reduce_res_170284 = redout_171586;
            max_mult_170266 = defunc_0_reduce_res_170284;
        } else {
            max_mult_170266 = (int64_t) 1;
        }
        
        int64_t bytes_172332 = (int64_t) 8 * defunc_res_169981;
        bool bounds_invalid_upwards_170316 = slt64(max_mult_170266, (int64_t) 1);
        bool valid_170318 = !bounds_invalid_upwards_170316;
        bool range_valid_c_170319;
        
        if (!valid_170318) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_170266, " is invalid.", "-> #0  ftHashJoin.fut:629:20-32\n   #1  ftHashJoin.fut:850:6-853:53\n   #2  ftRelational.fut:273:6-276:37\n   #3  ftRelational.fut:269:3-276:56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_172370 = b_141121 * defunc_res_169981;
        
        if (mem_172309_cached_sizze_172729 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172309, &mem_172309_cached_sizze_172729, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171575 = 0; i_171575 < nR_141120; i_171575++) {
            int64_t eta_p_170239 = ((int64_t *) mem_172270)[i_171575];
            int64_t zv_lhs_170240 = add64((int64_t) -1, i_171575);
            int64_t tmp_170241 = smod64(zv_lhs_170240, nR_141120);
            int64_t lifted_lambda_res_170242 = ((int64_t *) mem_172264)[tmp_170241];
            bool cond_170243 = i_171575 == (int64_t) 0;
            int64_t lifted_lambda_res_170244;
            
            if (cond_170243) {
                lifted_lambda_res_170244 = (int64_t) 0;
            } else {
                lifted_lambda_res_170244 = lifted_lambda_res_170242;
            }
            
            bool cond_170245 = slt64((int64_t) 0, eta_p_170239);
            int64_t lifted_lambda_res_170246;
            
            if (cond_170245) {
                lifted_lambda_res_170246 = lifted_lambda_res_170244;
            } else {
                lifted_lambda_res_170246 = (int64_t) -1;
            }
            ((int64_t *) mem_172309)[i_171575] = lifted_lambda_res_170246;
        }
        if (memblock_alloc(ctx, &mem_172333, bytes_172332, "mem_172333")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172536 = 0; nest_i_172536 < defunc_res_169981; nest_i_172536++) {
            ((int64_t *) mem_172333.mem)[nest_i_172536] = (int64_t) 0;
        }
        for (int64_t write_iter_171588 = 0; write_iter_171588 < nR_141120; write_iter_171588++) {
            int64_t write_iv_171590 = ((int64_t *) mem_172309)[write_iter_171588];
            
            if (sle64((int64_t) 0, write_iv_171590) && slt64(write_iv_171590, defunc_res_169981)) {
                ((int64_t *) mem_172333.mem)[write_iv_171590] = write_iter_171588;
            }
        }
        if (memblock_alloc(ctx, &mem_172341, bytes_172332, "mem_172341")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172538 = 0; nest_i_172538 < defunc_res_169981; nest_i_172538++) {
            ((int64_t *) mem_172341.mem)[nest_i_172538] = (int64_t) 1;
        }
        
        int64_t distance_170317 = sub64(max_mult_170266, (int64_t) 1);
        
        if (memblock_set(ctx, &mem_param_172344, &mem_172341, "mem_172341") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172347, &mem_172333, "mem_172333") != 0)
            return 1;
        for (int64_t i_170322 = 0; i_170322 < distance_170317; i_170322++) {
            int64_t index_primexp_170325 = add64((int64_t) 1, i_170322);
            
            if (memblock_alloc(ctx, &mem_172349, bytes_172332, "mem_172349")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172349.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172347.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169981});
            if (memblock_alloc(ctx, &mem_172351, bytes_172332, "mem_172351")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172351.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172344.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169981});
            
            int64_t replicate_arg1_170328 = add64((int64_t) 2, i_170322);
            
            for (int64_t write_iter_171593 = 0; write_iter_171593 < nR_141120; write_iter_171593++) {
                int64_t zlze_lhs_170336 = ((int64_t *) mem_172270)[write_iter_171593];
                bool cond_170337 = sle64(zlze_lhs_170336, index_primexp_170325);
                int64_t lifted_lambda_res_170338;
                
                if (cond_170337) {
                    lifted_lambda_res_170338 = (int64_t) -1;
                } else {
                    int64_t zp_lhs_170339 = ((int64_t *) mem_172309)[write_iter_171593];
                    int64_t lifted_lambda_res_f_res_170340 = add64(index_primexp_170325, zp_lhs_170339);
                    
                    lifted_lambda_res_170338 = lifted_lambda_res_f_res_170340;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_170338) && slt64(lifted_lambda_res_170338, defunc_res_169981)) {
                    ((int64_t *) mem_172351.mem)[lifted_lambda_res_170338] = replicate_arg1_170328;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_170338) && slt64(lifted_lambda_res_170338, defunc_res_169981)) {
                    ((int64_t *) mem_172349.mem)[lifted_lambda_res_170338] = write_iter_171593;
                }
            }
            if (memblock_set(ctx, &mem_param_tmp_172539, &mem_172351, "mem_172351") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172540, &mem_172349, "mem_172349") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_172344, &mem_param_tmp_172539, "mem_param_tmp_172539") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_172347, &mem_param_tmp_172540, "mem_param_tmp_172540") != 0)
                return 1;
        }
        if (memblock_set(ctx, &ext_mem_172369, &mem_param_172344, "mem_param_172344") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172368, &mem_param_172347, "mem_param_172347") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172333, "mem_172333") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172341, "mem_172341") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_172371, bytes_172370, "mem_172371")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_172373, bytes_172332, "mem_172373")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171603 = 0; i_171603 < defunc_res_169981; i_171603++) {
            int64_t eta_p_170350 = ((int64_t *) ext_mem_172368.mem)[i_171603];
            bool x_170351 = sle64((int64_t) 0, eta_p_170350);
            bool y_170352 = slt64(eta_p_170350, nR_141120);
            bool bounds_check_170353 = x_170351 && y_170352;
            bool index_certs_170354;
            
            if (!bounds_check_170353) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_170350, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  ftHashJoin.fut:639:18-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:638:10-646:8\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t eta_p_170349 = ((int64_t *) ext_mem_172369.mem)[i_171603];
            int8_t rv_170355 = ((int8_t *) mem_172271)[eta_p_170350];
            int64_t inf_s_idx_170356 = ((int64_t *) mem_172268)[eta_p_170350];
            int64_t tmp_170357 = sub64(inf_s_idx_170356, (int64_t) 1);
            bool loop_cond_170358 = slt64((int64_t) 0, eta_p_170349);
            bool kth_match_170359;
            int64_t kth_match_170360;
            int64_t kth_match_170361;
            bool loop_while_170362;
            int64_t j_170363;
            int64_t m_170364;
            
            loop_while_170362 = loop_cond_170358;
            j_170363 = tmp_170357;
            m_170364 = (int64_t) 0;
            while (loop_while_170362) {
                int64_t zeze_rhs_170365 = add64((int64_t) 1, j_170363);
                bool x_170366 = sle64((int64_t) 0, zeze_rhs_170365);
                bool y_170367 = slt64(zeze_rhs_170365, nS_141122);
                bool bounds_check_170368 = x_170366 && y_170367;
                bool index_certs_170369;
                
                if (!bounds_check_170368) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_170365, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:643:31-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:638:10-646:8\n   #3  ftHashJoin.fut:850:6-853:53\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_170370 = ((int8_t *) mem_172254)[zeze_rhs_170365];
                bool is_eq_170371 = rv_170355 == zeze_rhs_170370;
                int64_t loopres_170372;
                
                if (is_eq_170371) {
                    int64_t tmp_170373 = add64((int64_t) 1, m_170364);
                    
                    loopres_170372 = tmp_170373;
                } else {
                    loopres_170372 = m_170364;
                }
                
                bool loop_cond_170374 = slt64(loopres_170372, eta_p_170349);
                bool loop_while_tmp_172547 = loop_cond_170374;
                int64_t j_tmp_172548 = zeze_rhs_170365;
                int64_t m_tmp_172549 = loopres_170372;
                
                loop_while_170362 = loop_while_tmp_172547;
                j_170363 = j_tmp_172548;
                m_170364 = m_tmp_172549;
            }
            kth_match_170359 = loop_while_170362;
            kth_match_170360 = j_170363;
            kth_match_170361 = m_170364;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_172371.mem, i_171603 * b_141121, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171818.mem, eta_p_170350 * b_141121, (int64_t []) {(int64_t) 1}, (int64_t []) {b_141121});
            ((int64_t *) mem_172373.mem)[i_171603] = kth_match_170360;
        }
        if (memblock_unref(ctx, &ext_mem_172369, "ext_mem_172369") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_172389, bytes_172332, "mem_172389")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172389.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172368.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_169981});
        if (memblock_unref(ctx, &ext_mem_172368, "ext_mem_172368") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172397, &mem_172389, "mem_172389") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172396, &mem_172373, "mem_172373") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172393, &mem_172371, "mem_172371") != 0)
            return 1;
        radix_hash_join_res_159280 = defunc_res_169981;
        radix_hash_join_res_159281 = defunc_res_169981;
        radix_hash_join_res_159282 = defunc_res_169981;
    } else {
        int64_t radix_hash_join_res_f_res_159639;
        int64_t radix_hash_join_res_f_res_159640;
        int64_t radix_hash_join_res_f_res_159641;
        
        if (cond_159247) {
            if (mem_172109_cached_sizze_172712 < bytes_172108) {
                err = lexical_realloc(ctx, &mem_172109, &mem_172109_cached_sizze_172712, bytes_172108);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171608 = 0; i_171608 < nS_141122; i_171608++) {
                int16_t defunc_0_byteSeq_to_prim_res_170469;
                int16_t y_170471 = (int16_t) 0;
                
                for (int64_t i_170470 = 0; i_170470 < b_141121; i_170470++) {
                    int64_t zm_lhs_170472 = sub64(b_141121, i_170470);
                    int64_t from_u8_arg0_170473 = sub64(zm_lhs_170472, (int64_t) 1);
                    bool x_170474 = sle64((int64_t) 0, from_u8_arg0_170473);
                    bool y_170475 = slt64(from_u8_arg0_170473, b_141121);
                    bool bounds_check_170476 = x_170474 && y_170475;
                    bool index_certs_170477;
                    
                    if (!bounds_check_170476) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_170473, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:425:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_170478 = ((int8_t *) pS_mem_171819.mem)[i_171608 * b_141121 + from_u8_arg0_170473];
                    int16_t u8_res_170479 = zext_i8_i16(from_u8_arg0_170478);
                    int32_t i64_res_170480 = sext_i64_i32(i_170470);
                    int32_t shift_left_rhs_170481 = mul32(8, i64_res_170480);
                    int16_t unsign_arg0_170482 = zext_i32_i16(shift_left_rhs_170481);
                    int16_t lifted_lambda_res_170483 = shl16(u8_res_170479, unsign_arg0_170482);
                    int16_t unsign_arg0_170484 = y_170471 | lifted_lambda_res_170483;
                    int16_t y_tmp_172551 = unsign_arg0_170484;
                    
                    y_170471 = y_tmp_172551;
                }
                defunc_0_byteSeq_to_prim_res_170469 = y_170471;
                ((int16_t *) mem_172109)[i_171608] = defunc_0_byteSeq_to_prim_res_170469;
            }
            if (mem_172117_cached_sizze_172713 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172117, &mem_172117_cached_sizze_172713, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_172119_cached_sizze_172714 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172119, &mem_172119_cached_sizze_172714, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_172121_cached_sizze_172715 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172121, &mem_172121_cached_sizze_172715, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_172123_cached_sizze_172716 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172123, &mem_172123_cached_sizze_172716, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_172125_cached_sizze_172717 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172125, &mem_172125_cached_sizze_172717, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_172127_cached_sizze_172718 < bytes_172126) {
                err = lexical_realloc(ctx, &mem_172127, &mem_172127_cached_sizze_172718, bytes_172126);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171632;
            int64_t discard_171633;
            int64_t defunc_res_170490;
            int64_t scanacc_171616;
            int64_t scanacc_171617;
            int64_t redout_171620;
            
            scanacc_171616 = (int64_t) 0;
            scanacc_171617 = (int64_t) 0;
            redout_171620 = (int64_t) 0;
            for (int64_t i_171625 = 0; i_171625 < nR_141120; i_171625++) {
                int16_t defunc_0_byteSeq_to_prim_res_170496;
                int16_t y_170498 = (int16_t) 0;
                
                for (int64_t i_170497 = 0; i_170497 < b_141121; i_170497++) {
                    int64_t zm_lhs_170499 = sub64(b_141121, i_170497);
                    int64_t from_u8_arg0_170500 = sub64(zm_lhs_170499, (int64_t) 1);
                    bool x_170501 = sle64((int64_t) 0, from_u8_arg0_170500);
                    bool y_170502 = slt64(from_u8_arg0_170500, b_141121);
                    bool bounds_check_170503 = x_170501 && y_170502;
                    bool index_certs_170504;
                    
                    if (!bounds_check_170503) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_170500, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:425:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_170505 = ((int8_t *) pR_mem_171818.mem)[i_171625 * b_141121 + from_u8_arg0_170500];
                    int16_t u8_res_170506 = zext_i8_i16(from_u8_arg0_170505);
                    int32_t i64_res_170507 = sext_i64_i32(i_170497);
                    int32_t shift_left_rhs_170508 = mul32(8, i64_res_170507);
                    int16_t unsign_arg0_170509 = zext_i32_i16(shift_left_rhs_170508);
                    int16_t lifted_lambda_res_170510 = shl16(u8_res_170506, unsign_arg0_170509);
                    int16_t unsign_arg0_170511 = y_170498 | lifted_lambda_res_170510;
                    int16_t y_tmp_172561 = unsign_arg0_170511;
                    
                    y_170498 = y_tmp_172561;
                }
                defunc_0_byteSeq_to_prim_res_170496 = y_170498;
                
                int16_t lifted_lambda_res_170512 = u64_res_159271 & defunc_0_byteSeq_to_prim_res_170496;
                int64_t u16_res_170513 = zext_i16_i64(lifted_lambda_res_170512);
                bool x_170514 = sle64((int64_t) 0, u16_res_170513);
                bool y_170515 = slt64(u16_res_170513, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124);
                bool bounds_check_170516 = x_170514 && y_170515;
                bool index_certs_170517;
                
                if (!bounds_check_170516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u16_res_170513, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t spi_170518 = ((int64_t *) first_info_idx_mem_171822.mem)[u16_res_170513];
                bool cond_170519 = slt64(spi_170518, (int64_t) 0);
                int64_t defunc_res_170520;
                
                if (cond_170519) {
                    defunc_res_170520 = (int64_t) -1;
                } else {
                    int64_t zeze_rhs_170521 = ((int64_t *) last_info_idx_mem_171823.mem)[u16_res_170513];
                    bool cond_170522 = spi_170518 == zeze_rhs_170521;
                    int64_t defunc_res_f_res_170523;
                    
                    if (cond_170522) {
                        defunc_res_f_res_170523 = spi_170518;
                    } else {
                        int64_t zs_lhs_170524 = sub64(zeze_rhs_170521, spi_170518);
                        int64_t max_arg1_170525 = sdiv64(zs_lhs_170524, (int64_t) 2);
                        int64_t max_res_170526 = smax64((int64_t) 1, max_arg1_170525);
                        bool loop_cond_170527 = slt64((int64_t) 0, max_res_170526);
                        bool bsearch_170528;
                        int64_t bsearch_170529;
                        int64_t bsearch_170530;
                        bool loop_while_170531;
                        int64_t heshi_170532;
                        int64_t step_170533;
                        
                        loop_while_170531 = loop_cond_170527;
                        heshi_170532 = spi_170518;
                        step_170533 = max_res_170526;
                        while (loop_while_170531) {
                            bool x_170534 = sle64((int64_t) 0, heshi_170532);
                            bool y_170535 = slt64(heshi_170532, dz2081U_141123);
                            bool bounds_check_170536 = x_170534 && y_170535;
                            bool index_certs_170537;
                            
                            if (!bounds_check_170536) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_170532, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t cur_S_170555 = ((int64_t *) bounds_mem_171820.mem)[heshi_170532];
                            bool x_170556 = sle64((int64_t) 0, cur_S_170555);
                            bool y_170557 = slt64(cur_S_170555, nS_141122);
                            bool bounds_check_170558 = x_170556 && y_170557;
                            bool index_certs_170559;
                            
                            if (!bounds_check_170558) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_170555, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t cur_depth_170538 = ((int32_t *) depths_mem_171821.mem)[heshi_170532];
                            bool cond_170539 = heshi_170532 == spi_170518;
                            int32_t prev_depth_170540;
                            
                            if (cond_170539) {
                                prev_depth_170540 = cur_depth_170538;
                            } else {
                                int64_t tmp_170541 = sub64(heshi_170532, (int64_t) 1);
                                bool x_170542 = sle64((int64_t) 0, tmp_170541);
                                bool y_170543 = slt64(tmp_170541, dz2081U_141123);
                                bool bounds_check_170544 = x_170542 && y_170543;
                                bool index_certs_170545;
                                
                                if (!bounds_check_170544) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170541, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t prev_depth_f_res_170546 = ((int32_t *) depths_mem_171821.mem)[tmp_170541];
                                
                                prev_depth_170540 = prev_depth_f_res_170546;
                            }
                            
                            bool cond_170547 = heshi_170532 == zeze_rhs_170521;
                            int32_t next_depth_170548;
                            
                            if (cond_170547) {
                                next_depth_170548 = cur_depth_170538;
                            } else {
                                int64_t tmp_170549 = add64((int64_t) 1, heshi_170532);
                                bool x_170550 = sle64((int64_t) 0, tmp_170549);
                                bool y_170551 = slt64(tmp_170549, dz2081U_141123);
                                bool bounds_check_170552 = x_170550 && y_170551;
                                bool index_certs_170553;
                                
                                if (!bounds_check_170552) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170549, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t next_depth_f_res_170554 = ((int32_t *) depths_mem_171821.mem)[tmp_170549];
                                
                                next_depth_170548 = next_depth_f_res_170554;
                            }
                            
                            int16_t cur_S_170560 = ((int16_t *) mem_172109)[cur_S_170555];
                            int16_t prev_S_170561;
                            
                            if (cond_170539) {
                                prev_S_170561 = cur_S_170560;
                            } else {
                                int64_t tmp_170562 = sub64(heshi_170532, (int64_t) 1);
                                bool x_170563 = sle64((int64_t) 0, tmp_170562);
                                bool y_170564 = slt64(tmp_170562, dz2081U_141123);
                                bool bounds_check_170565 = x_170563 && y_170564;
                                bool index_certs_170566;
                                
                                if (!bounds_check_170565) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170562, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_170567 = ((int64_t *) bounds_mem_171820.mem)[tmp_170562];
                                bool x_170568 = sle64((int64_t) 0, tmp_170567);
                                bool y_170569 = slt64(tmp_170567, nS_141122);
                                bool bounds_check_170570 = x_170568 && y_170569;
                                bool index_certs_170571;
                                
                                if (!bounds_check_170570) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170567, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t prev_S_f_res_170572 = ((int16_t *) mem_172109)[tmp_170567];
                                
                                prev_S_170561 = prev_S_f_res_170572;
                            }
                            
                            int16_t next_S_170573;
                            
                            if (cond_170547) {
                                next_S_170573 = cur_S_170560;
                            } else {
                                int64_t tmp_170574 = add64((int64_t) 1, heshi_170532);
                                bool x_170575 = sle64((int64_t) 0, tmp_170574);
                                bool y_170576 = slt64(tmp_170574, dz2081U_141123);
                                bool bounds_check_170577 = x_170575 && y_170576;
                                bool index_certs_170578;
                                
                                if (!bounds_check_170577) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170574, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_170579 = ((int64_t *) bounds_mem_171820.mem)[tmp_170574];
                                bool x_170580 = sle64((int64_t) 0, tmp_170579);
                                bool y_170581 = slt64(tmp_170579, nS_141122);
                                bool bounds_check_170582 = x_170580 && y_170581;
                                bool index_certs_170583;
                                
                                if (!bounds_check_170582) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170579, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:658:5-665:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t next_S_f_res_170584 = ((int16_t *) mem_172109)[tmp_170579];
                                
                                next_S_170573 = next_S_f_res_170584;
                            }
                            
                            int32_t prim_get_radix_arg0_170585 = mul32(radix_sizze_141125, cur_depth_170538);
                            int64_t unsign_arg0_170586 = zext_i32_i64(prim_get_radix_arg0_170585);
                            int64_t asPow_170587 = shl64((int64_t) 1, unsign_arg0_170586);
                            int64_t u64_arg0_170588 = sub64(asPow_170587, (int64_t) 1);
                            int16_t u64_res_170589 = zext_i64_i16(u64_arg0_170588);
                            int16_t lifted_lambda_res_170590 = defunc_0_byteSeq_to_prim_res_170496 & u64_res_170589;
                            int16_t lifted_lambda_res_170591 = cur_S_170560 & u64_res_170589;
                            bool defunc_0_eq_res_170592 = lifted_lambda_res_170590 == lifted_lambda_res_170591;
                            int64_t loopres_170593;
                            int64_t loopres_170594;
                            
                            if (defunc_0_eq_res_170592) {
                                loopres_170593 = heshi_170532;
                                loopres_170594 = (int64_t) 0;
                            } else {
                                bool loop_cond_t_res_170595 = slt32(0, cur_depth_170538);
                                bool is_lt_170596;
                                bool is_lt_170597;
                                int32_t is_lt_170598;
                                bool loop_while_170599;
                                bool def_lt_170600;
                                int32_t bi_170601;
                                
                                loop_while_170599 = loop_cond_t_res_170595;
                                def_lt_170600 = 0;
                                bi_170601 = 0;
                                while (loop_while_170599) {
                                    int32_t zt_rhs_170602 = add32(1, bi_170601);
                                    int32_t prim_get_radix_arg0_170603 = mul32(radix_sizze_141125, zt_rhs_170602);
                                    int64_t unsign_arg0_170604 = zext_i32_i64(prim_get_radix_arg0_170603);
                                    int64_t asPow_170605 = shl64((int64_t) 1, unsign_arg0_170604);
                                    int64_t u64_arg0_170606 = sub64(asPow_170605, (int64_t) 1);
                                    int16_t u64_res_170607 = zext_i64_i16(u64_arg0_170606);
                                    int16_t lifted_lambda_res_170608 = defunc_0_byteSeq_to_prim_res_170496 & u64_res_170607;
                                    int16_t lifted_lambda_res_170609 = cur_S_170560 & u64_res_170607;
                                    bool defunc_0_lt_res_170610 = ult16(lifted_lambda_res_170608, lifted_lambda_res_170609);
                                    bool defunc_0_lt_res_170611 = ult16(lifted_lambda_res_170609, lifted_lambda_res_170608);
                                    bool cond_170612 = !defunc_0_lt_res_170611;
                                    bool cond_t_res_170613 = !defunc_0_lt_res_170610;
                                    bool x_170614 = cond_170612 && cond_t_res_170613;
                                    bool loop_cond_t_res_170615 = slt32(zt_rhs_170602, cur_depth_170538);
                                    bool x_170616 = x_170614 && loop_cond_t_res_170615;
                                    bool loop_while_tmp_172565 = x_170616;
                                    bool def_lt_tmp_172566 = defunc_0_lt_res_170610;
                                    int32_t bi_tmp_172567 = zt_rhs_170602;
                                    
                                    loop_while_170599 = loop_while_tmp_172565;
                                    def_lt_170600 = def_lt_tmp_172566;
                                    bi_170601 = bi_tmp_172567;
                                }
                                is_lt_170596 = loop_while_170599;
                                is_lt_170597 = def_lt_170600;
                                is_lt_170598 = bi_170601;
                                
                                int64_t loopres_f_res_170617;
                                int64_t loopres_f_res_170618;
                                
                                if (is_lt_170597) {
                                    bool loop_cond_t_res_170619 = slt32(0, prev_depth_170540);
                                    bool is_gt_170620;
                                    bool is_gt_170621;
                                    int32_t is_gt_170622;
                                    bool loop_while_170623;
                                    bool def_gt_170624;
                                    int32_t bi_170625;
                                    
                                    loop_while_170623 = loop_cond_t_res_170619;
                                    def_gt_170624 = 0;
                                    bi_170625 = 0;
                                    while (loop_while_170623) {
                                        int32_t zt_rhs_170626 = add32(1, bi_170625);
                                        int32_t prim_get_radix_arg0_170627 = mul32(radix_sizze_141125, zt_rhs_170626);
                                        int64_t unsign_arg0_170628 = zext_i32_i64(prim_get_radix_arg0_170627);
                                        int64_t asPow_170629 = shl64((int64_t) 1, unsign_arg0_170628);
                                        int64_t u64_arg0_170630 = sub64(asPow_170629, (int64_t) 1);
                                        int16_t u64_res_170631 = zext_i64_i16(u64_arg0_170630);
                                        int16_t lifted_lambda_res_170632 = defunc_0_byteSeq_to_prim_res_170496 & u64_res_170631;
                                        int16_t lifted_lambda_res_170633 = prev_S_170561 & u64_res_170631;
                                        bool defunc_0_gt_res_170634 = ult16(lifted_lambda_res_170633, lifted_lambda_res_170632);
                                        bool defunc_0_gt_res_170635 = ult16(lifted_lambda_res_170632, lifted_lambda_res_170633);
                                        bool cond_170636 = !defunc_0_gt_res_170634;
                                        bool cond_t_res_170637 = !defunc_0_gt_res_170635;
                                        bool x_170638 = cond_170636 && cond_t_res_170637;
                                        bool loop_cond_t_res_170639 = slt32(zt_rhs_170626, prev_depth_170540);
                                        bool x_170640 = x_170638 && loop_cond_t_res_170639;
                                        bool loop_while_tmp_172568 = x_170640;
                                        bool def_gt_tmp_172569 = defunc_0_gt_res_170634;
                                        int32_t bi_tmp_172570 = zt_rhs_170626;
                                        
                                        loop_while_170623 = loop_while_tmp_172568;
                                        def_gt_170624 = def_gt_tmp_172569;
                                        bi_170625 = bi_tmp_172570;
                                    }
                                    is_gt_170620 = loop_while_170623;
                                    is_gt_170621 = def_gt_170624;
                                    is_gt_170622 = bi_170625;
                                    
                                    bool x_170641 = !cond_170539;
                                    bool y_170642 = is_gt_170621 && x_170641;
                                    bool cond_170643 = cond_170539 || y_170642;
                                    int64_t loopres_f_res_t_res_170644;
                                    int64_t loopres_f_res_t_res_170645;
                                    
                                    if (cond_170643) {
                                        loopres_f_res_t_res_170644 = (int64_t) -1;
                                        loopres_f_res_t_res_170645 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_170646 = sub64(heshi_170532, step_170533);
                                        int64_t max_arg1_170647 = sdiv64(step_170533, (int64_t) 2);
                                        int64_t max_res_170648 = smax64((int64_t) 1, max_arg1_170647);
                                        
                                        loopres_f_res_t_res_170644 = tmp_170646;
                                        loopres_f_res_t_res_170645 = max_res_170648;
                                    }
                                    loopres_f_res_170617 = loopres_f_res_t_res_170644;
                                    loopres_f_res_170618 = loopres_f_res_t_res_170645;
                                } else {
                                    bool loop_cond_t_res_170649 = slt32(0, next_depth_170548);
                                    bool is_lt_170650;
                                    bool is_lt_170651;
                                    int32_t is_lt_170652;
                                    bool loop_while_170653;
                                    bool def_lt_170654;
                                    int32_t bi_170655;
                                    
                                    loop_while_170653 = loop_cond_t_res_170649;
                                    def_lt_170654 = 0;
                                    bi_170655 = 0;
                                    while (loop_while_170653) {
                                        int32_t zt_rhs_170656 = add32(1, bi_170655);
                                        int32_t prim_get_radix_arg0_170657 = mul32(radix_sizze_141125, zt_rhs_170656);
                                        int64_t unsign_arg0_170658 = zext_i32_i64(prim_get_radix_arg0_170657);
                                        int64_t asPow_170659 = shl64((int64_t) 1, unsign_arg0_170658);
                                        int64_t u64_arg0_170660 = sub64(asPow_170659, (int64_t) 1);
                                        int16_t u64_res_170661 = zext_i64_i16(u64_arg0_170660);
                                        int16_t lifted_lambda_res_170662 = defunc_0_byteSeq_to_prim_res_170496 & u64_res_170661;
                                        int16_t lifted_lambda_res_170663 = next_S_170573 & u64_res_170661;
                                        bool defunc_0_lt_res_170664 = ult16(lifted_lambda_res_170662, lifted_lambda_res_170663);
                                        bool defunc_0_lt_res_170665 = ult16(lifted_lambda_res_170663, lifted_lambda_res_170662);
                                        bool cond_170666 = !defunc_0_lt_res_170665;
                                        bool cond_t_res_170667 = !defunc_0_lt_res_170664;
                                        bool x_170668 = cond_170666 && cond_t_res_170667;
                                        bool loop_cond_t_res_170669 = slt32(zt_rhs_170656, next_depth_170548);
                                        bool x_170670 = x_170668 && loop_cond_t_res_170669;
                                        bool loop_while_tmp_172571 = x_170670;
                                        bool def_lt_tmp_172572 = defunc_0_lt_res_170664;
                                        int32_t bi_tmp_172573 = zt_rhs_170656;
                                        
                                        loop_while_170653 = loop_while_tmp_172571;
                                        def_lt_170654 = def_lt_tmp_172572;
                                        bi_170655 = bi_tmp_172573;
                                    }
                                    is_lt_170650 = loop_while_170653;
                                    is_lt_170651 = def_lt_170654;
                                    is_lt_170652 = bi_170655;
                                    
                                    bool x_170671 = !cond_170547;
                                    bool y_170672 = is_lt_170651 && x_170671;
                                    bool cond_170673 = cond_170547 || y_170672;
                                    int64_t loopres_f_res_f_res_170674;
                                    int64_t loopres_f_res_f_res_170675;
                                    
                                    if (cond_170673) {
                                        loopres_f_res_f_res_170674 = (int64_t) -1;
                                        loopres_f_res_f_res_170675 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_170676 = add64(heshi_170532, step_170533);
                                        int64_t max_arg1_170677 = sdiv64(step_170533, (int64_t) 2);
                                        int64_t max_res_170678 = smax64((int64_t) 1, max_arg1_170677);
                                        
                                        loopres_f_res_f_res_170674 = tmp_170676;
                                        loopres_f_res_f_res_170675 = max_res_170678;
                                    }
                                    loopres_f_res_170617 = loopres_f_res_f_res_170674;
                                    loopres_f_res_170618 = loopres_f_res_f_res_170675;
                                }
                                loopres_170593 = loopres_f_res_170617;
                                loopres_170594 = loopres_f_res_170618;
                            }
                            
                            bool loop_cond_170679 = slt64((int64_t) 0, loopres_170594);
                            bool loop_while_tmp_172562 = loop_cond_170679;
                            int64_t heshi_tmp_172563 = loopres_170593;
                            int64_t step_tmp_172564 = loopres_170594;
                            
                            loop_while_170531 = loop_while_tmp_172562;
                            heshi_170532 = heshi_tmp_172563;
                            step_170533 = step_tmp_172564;
                        }
                        bsearch_170528 = loop_while_170531;
                        bsearch_170529 = heshi_170532;
                        bsearch_170530 = step_170533;
                        defunc_res_f_res_170523 = bsearch_170529;
                    }
                    defunc_res_170520 = defunc_res_f_res_170523;
                }
                
                bool cond_170680 = sle64(defunc_res_170520, (int64_t) 0);
                int64_t inf_170681;
                
                if (cond_170680) {
                    inf_170681 = (int64_t) 0;
                } else {
                    bool x_170682 = sle64((int64_t) 0, defunc_res_170520);
                    bool y_170683 = slt64(defunc_res_170520, dz2081U_141123);
                    bool bounds_check_170684 = x_170682 && y_170683;
                    bool index_certs_170685;
                    
                    if (!bounds_check_170684) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_170520, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:666:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-854:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t inf_f_res_170686 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_170520];
                    
                    inf_170681 = inf_f_res_170686;
                }
                
                bool cond_170687 = defunc_res_170520 == zeze_rhs_159252;
                int64_t sup_170688;
                
                if (cond_170687) {
                    sup_170688 = nS_141122;
                } else {
                    int64_t tmp_170689 = add64((int64_t) 1, defunc_res_170520);
                    bool x_170690 = sle64((int64_t) 0, tmp_170689);
                    bool y_170691 = slt64(tmp_170689, dz2081U_141123);
                    bool bounds_check_170692 = x_170690 && y_170691;
                    bool index_certs_170693;
                    
                    if (!bounds_check_170692) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_170689, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:667:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-854:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t sup_f_res_170694 = ((int64_t *) bounds_mem_171820.mem)[tmp_170689];
                    
                    sup_170688 = sup_f_res_170694;
                }
                
                bool loop_cond_170695 = slt64(inf_170681, sup_170688);
                bool lifted_lambda_res_170696;
                int64_t lifted_lambda_res_170697;
                int64_t lifted_lambda_res_170698;
                int64_t lifted_lambda_res_170699;
                bool loop_while_170700;
                int64_t j_170701;
                int64_t duome_170702;
                int64_t i_170703;
                
                loop_while_170700 = loop_cond_170695;
                j_170701 = inf_170681;
                duome_170702 = (int64_t) 0;
                i_170703 = inf_170681;
                while (loop_while_170700) {
                    bool x_170704 = sle64((int64_t) 0, i_170703);
                    bool y_170705 = slt64(i_170703, nS_141122);
                    bool bounds_check_170706 = x_170704 && y_170705;
                    bool index_certs_170707;
                    
                    if (!bounds_check_170706) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_170703, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:670:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-854:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_170708 = ((int16_t *) mem_172109)[i_170703];
                    bool is_eq_170709 = defunc_0_byteSeq_to_prim_res_170496 == zeze_rhs_170708;
                    bool cond_170710 = slt64((int64_t) 0, duome_170702);
                    bool cond_170711 = is_eq_170709 || cond_170710;
                    int64_t next_j_170712;
                    
                    if (cond_170711) {
                        next_j_170712 = j_170701;
                    } else {
                        int64_t next_j_f_res_170713 = add64((int64_t) 1, j_170701);
                        
                        next_j_170712 = next_j_f_res_170713;
                    }
                    
                    int64_t next_duome_170714;
                    
                    if (is_eq_170709) {
                        int64_t next_duome_t_res_170715 = add64((int64_t) 1, duome_170702);
                        
                        next_duome_170714 = next_duome_t_res_170715;
                    } else {
                        next_duome_170714 = duome_170702;
                    }
                    
                    int64_t tmp_170716 = add64((int64_t) 1, i_170703);
                    bool loop_cond_170717 = slt64(tmp_170716, sup_170688);
                    bool loop_while_tmp_172574 = loop_cond_170717;
                    int64_t j_tmp_172575 = next_j_170712;
                    int64_t duome_tmp_172576 = next_duome_170714;
                    int64_t i_tmp_172577 = tmp_170716;
                    
                    loop_while_170700 = loop_while_tmp_172574;
                    j_170701 = j_tmp_172575;
                    duome_170702 = duome_tmp_172576;
                    i_170703 = i_tmp_172577;
                }
                lifted_lambda_res_170696 = loop_while_170700;
                lifted_lambda_res_170697 = j_170701;
                lifted_lambda_res_170698 = duome_170702;
                lifted_lambda_res_170699 = i_170703;
                
                bool cond_170718 = slt64(lifted_lambda_res_170697, sup_170688);
                int64_t lifted_lambda_res_170719;
                
                if (cond_170718) {
                    lifted_lambda_res_170719 = lifted_lambda_res_170698;
                } else {
                    lifted_lambda_res_170719 = (int64_t) 0;
                }
                
                int64_t lifted_lambda_res_170720;
                
                if (cond_170718) {
                    lifted_lambda_res_170720 = lifted_lambda_res_170697;
                } else {
                    lifted_lambda_res_170720 = (int64_t) -1;
                }
                
                bool lifted_lambda_res_170721 = slt64((int64_t) 1, lifted_lambda_res_170719);
                int64_t defunc_0_f_res_170722 = btoi_bool_i64(lifted_lambda_res_170721);
                int64_t defunc_0_op_res_170725 = add64(defunc_0_f_res_170722, scanacc_171616);
                int64_t defunc_0_op_res_170728 = add64(lifted_lambda_res_170719, scanacc_171617);
                int64_t zp_res_170731 = add64(lifted_lambda_res_170719, redout_171620);
                
                ((int64_t *) mem_172117)[i_171625] = defunc_0_op_res_170725;
                ((int64_t *) mem_172119)[i_171625] = defunc_0_op_res_170728;
                ((int64_t *) mem_172121)[i_171625] = defunc_0_f_res_170722;
                ((int64_t *) mem_172123)[i_171625] = lifted_lambda_res_170720;
                ((int64_t *) mem_172125)[i_171625] = lifted_lambda_res_170719;
                ((int16_t *) mem_172127)[i_171625] = defunc_0_byteSeq_to_prim_res_170496;
                
                int64_t scanacc_tmp_172552 = defunc_0_op_res_170725;
                int64_t scanacc_tmp_172553 = defunc_0_op_res_170728;
                int64_t redout_tmp_172556 = zp_res_170731;
                
                scanacc_171616 = scanacc_tmp_172552;
                scanacc_171617 = scanacc_tmp_172553;
                redout_171620 = redout_tmp_172556;
            }
            discard_171632 = scanacc_171616;
            discard_171633 = scanacc_171617;
            defunc_res_170490 = redout_171620;
            
            int64_t m_f_res_170767;
            
            if (x_159254) {
                int64_t x_170768 = ((int64_t *) mem_172117)[tmp_159255];
                
                m_f_res_170767 = x_170768;
            } else {
                m_f_res_170767 = (int64_t) 0;
            }
            
            int64_t m_170769;
            
            if (cond_159253) {
                m_170769 = (int64_t) 0;
            } else {
                m_170769 = m_f_res_170767;
            }
            
            bool cond_170770 = slt64((int64_t) 0, m_170769);
            int64_t m_170771 = sub64(m_170769, (int64_t) 1);
            bool i_p_m_t_s_leq_w_170772 = slt64(m_170771, nR_141120);
            bool zzero_leq_i_p_m_t_s_170773 = sle64((int64_t) 0, m_170771);
            bool y_170774 = i_p_m_t_s_leq_w_170772 && zzero_leq_i_p_m_t_s_170773;
            bool i_lte_j_170775 = sle64((int64_t) 0, m_170769);
            bool forwards_ok_170776 = y_170774 && i_lte_j_170775;
            bool eq_x_zz_170777 = (int64_t) 0 == m_f_res_170767;
            bool p_and_eq_x_y_170778 = x_159254 && eq_x_zz_170777;
            bool empty_slice_170779 = cond_159253 || p_and_eq_x_y_170778;
            bool ok_or_empty_170780 = forwards_ok_170776 || empty_slice_170779;
            bool index_certs_170781;
            
            if (!ok_or_empty_170780) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_170769, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-854:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_172172 = (int64_t) 8 * m_170769;
            
            if (mem_172173_cached_sizze_172720 < bytes_172172) {
                err = lexical_realloc(ctx, &mem_172173, &mem_172173_cached_sizze_172720, bytes_172172);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172173, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172125, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_170769});
            
            int64_t max_mult_170784;
            
            if (cond_170770) {
                if (mem_172175_cached_sizze_172721 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_172175, &mem_172175_cached_sizze_172721, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171640 = 0; i_171640 < nR_141120; i_171640++) {
                    int64_t eta_p_170786 = ((int64_t *) mem_172121)[i_171640];
                    int64_t eta_p_170787 = ((int64_t *) mem_172117)[i_171640];
                    bool cond_170788 = eta_p_170786 == (int64_t) 1;
                    int64_t lifted_lambda_res_170789;
                    
                    if (cond_170788) {
                        int64_t lifted_lambda_res_t_res_170790 = sub64(eta_p_170787, (int64_t) 1);
                        
                        lifted_lambda_res_170789 = lifted_lambda_res_t_res_170790;
                    } else {
                        lifted_lambda_res_170789 = (int64_t) -1;
                    }
                    ((int64_t *) mem_172175)[i_171640] = lifted_lambda_res_170789;
                }
                for (int64_t write_iter_171642 = 0; write_iter_171642 < nR_141120; write_iter_171642++) {
                    int64_t write_iv_171644 = ((int64_t *) mem_172175)[write_iter_171642];
                    int64_t write_iv_171645 = ((int64_t *) mem_172125)[write_iter_171642];
                    
                    if (sle64((int64_t) 0, write_iv_171644) && slt64(write_iv_171644, m_170769)) {
                        ((int64_t *) mem_172173)[write_iv_171644] = write_iv_171645;
                    }
                }
                
                int64_t defunc_0_reduce_res_170804;
                int64_t redout_171647 = (int64_t) -9223372036854775808;
                
                for (int64_t i_171648 = 0; i_171648 < m_170769; i_171648++) {
                    int64_t x_170805 = ((int64_t *) mem_172173)[i_171648];
                    int64_t max_res_170808 = smax64(x_170805, redout_171647);
                    int64_t redout_tmp_172580 = max_res_170808;
                    
                    redout_171647 = redout_tmp_172580;
                }
                defunc_0_reduce_res_170804 = redout_171647;
                max_mult_170784 = defunc_0_reduce_res_170804;
            } else {
                max_mult_170784 = (int64_t) 1;
            }
            
            int64_t bytes_172188 = (int64_t) 8 * defunc_res_170490;
            bool bounds_invalid_upwards_170840 = slt64(max_mult_170784, (int64_t) 1);
            bool valid_170842 = !bounds_invalid_upwards_170840;
            bool range_valid_c_170843;
            
            if (!valid_170842) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_170784, " is invalid.", "-> #0  ftHashJoin.fut:693:20-32\n   #1  ftHashJoin.fut:850:6-854:59\n   #2  ftRelational.fut:273:6-276:37\n   #3  ftRelational.fut:269:3-276:56\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_172226 = b_141121 * defunc_res_170490;
            
            if (mem_172165_cached_sizze_172719 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_172165, &mem_172165_cached_sizze_172719, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171636 = 0; i_171636 < nR_141120; i_171636++) {
                int64_t eta_p_170756 = ((int64_t *) mem_172125)[i_171636];
                int64_t zv_lhs_170757 = add64((int64_t) -1, i_171636);
                int64_t tmp_170758 = smod64(zv_lhs_170757, nR_141120);
                int64_t lifted_lambda_res_170759 = ((int64_t *) mem_172119)[tmp_170758];
                bool cond_170760 = i_171636 == (int64_t) 0;
                int64_t lifted_lambda_res_170761;
                
                if (cond_170760) {
                    lifted_lambda_res_170761 = (int64_t) 0;
                } else {
                    lifted_lambda_res_170761 = lifted_lambda_res_170759;
                }
                
                bool cond_170762 = slt64((int64_t) 0, eta_p_170756);
                int64_t lifted_lambda_res_170763;
                
                if (cond_170762) {
                    lifted_lambda_res_170763 = lifted_lambda_res_170761;
                } else {
                    lifted_lambda_res_170763 = (int64_t) -1;
                }
                ((int64_t *) mem_172165)[i_171636] = lifted_lambda_res_170763;
            }
            if (memblock_alloc(ctx, &mem_172189, bytes_172188, "mem_172189")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172582 = 0; nest_i_172582 < defunc_res_170490; nest_i_172582++) {
                ((int64_t *) mem_172189.mem)[nest_i_172582] = (int64_t) 0;
            }
            for (int64_t write_iter_171649 = 0; write_iter_171649 < nR_141120; write_iter_171649++) {
                int64_t write_iv_171651 = ((int64_t *) mem_172165)[write_iter_171649];
                
                if (sle64((int64_t) 0, write_iv_171651) && slt64(write_iv_171651, defunc_res_170490)) {
                    ((int64_t *) mem_172189.mem)[write_iv_171651] = write_iter_171649;
                }
            }
            if (memblock_alloc(ctx, &mem_172197, bytes_172188, "mem_172197")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172584 = 0; nest_i_172584 < defunc_res_170490; nest_i_172584++) {
                ((int64_t *) mem_172197.mem)[nest_i_172584] = (int64_t) 1;
            }
            
            int64_t distance_170841 = sub64(max_mult_170784, (int64_t) 1);
            
            if (memblock_set(ctx, &mem_param_172200, &mem_172197, "mem_172197") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_172203, &mem_172189, "mem_172189") != 0)
                return 1;
            for (int64_t i_170846 = 0; i_170846 < distance_170841; i_170846++) {
                int64_t index_primexp_170849 = add64((int64_t) 1, i_170846);
                
                if (memblock_alloc(ctx, &mem_172205, bytes_172188, "mem_172205")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172205.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172203.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170490});
                if (memblock_alloc(ctx, &mem_172207, bytes_172188, "mem_172207")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172207.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172200.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170490});
                
                int64_t replicate_arg1_170852 = add64((int64_t) 2, i_170846);
                
                for (int64_t write_iter_171654 = 0; write_iter_171654 < nR_141120; write_iter_171654++) {
                    int64_t zlze_lhs_170860 = ((int64_t *) mem_172125)[write_iter_171654];
                    bool cond_170861 = sle64(zlze_lhs_170860, index_primexp_170849);
                    int64_t lifted_lambda_res_170862;
                    
                    if (cond_170861) {
                        lifted_lambda_res_170862 = (int64_t) -1;
                    } else {
                        int64_t zp_lhs_170863 = ((int64_t *) mem_172165)[write_iter_171654];
                        int64_t lifted_lambda_res_f_res_170864 = add64(index_primexp_170849, zp_lhs_170863);
                        
                        lifted_lambda_res_170862 = lifted_lambda_res_f_res_170864;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_170862) && slt64(lifted_lambda_res_170862, defunc_res_170490)) {
                        ((int64_t *) mem_172207.mem)[lifted_lambda_res_170862] = replicate_arg1_170852;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_170862) && slt64(lifted_lambda_res_170862, defunc_res_170490)) {
                        ((int64_t *) mem_172205.mem)[lifted_lambda_res_170862] = write_iter_171654;
                    }
                }
                if (memblock_set(ctx, &mem_param_tmp_172585, &mem_172207, "mem_172207") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172586, &mem_172205, "mem_172205") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_172200, &mem_param_tmp_172585, "mem_param_tmp_172585") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_172203, &mem_param_tmp_172586, "mem_param_tmp_172586") != 0)
                    return 1;
            }
            if (memblock_set(ctx, &ext_mem_172225, &mem_param_172200, "mem_param_172200") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172224, &mem_param_172203, "mem_param_172203") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_172189, "mem_172189") != 0)
                return 1;
            if (memblock_unref(ctx, &mem_172197, "mem_172197") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_172227, bytes_172226, "mem_172227")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_172229, bytes_172188, "mem_172229")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171664 = 0; i_171664 < defunc_res_170490; i_171664++) {
                int64_t eta_p_170876 = ((int64_t *) ext_mem_172224.mem)[i_171664];
                bool x_170877 = sle64((int64_t) 0, eta_p_170876);
                bool y_170878 = slt64(eta_p_170876, nR_141120);
                bool bounds_check_170879 = x_170877 && y_170878;
                bool index_certs_170880;
                
                if (!bounds_check_170879) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_170876, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  ftHashJoin.fut:703:18-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:702:10-710:8\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t eta_p_170875 = ((int64_t *) ext_mem_172225.mem)[i_171664];
                int16_t rv_170881 = ((int16_t *) mem_172127)[eta_p_170876];
                int64_t inf_s_idx_170882 = ((int64_t *) mem_172123)[eta_p_170876];
                int64_t tmp_170883 = sub64(inf_s_idx_170882, (int64_t) 1);
                bool loop_cond_170884 = slt64((int64_t) 0, eta_p_170875);
                bool kth_match_170885;
                int64_t kth_match_170886;
                int64_t kth_match_170887;
                bool loop_while_170888;
                int64_t j_170889;
                int64_t m_170890;
                
                loop_while_170888 = loop_cond_170884;
                j_170889 = tmp_170883;
                m_170890 = (int64_t) 0;
                while (loop_while_170888) {
                    int64_t zeze_rhs_170891 = add64((int64_t) 1, j_170889);
                    bool x_170892 = sle64((int64_t) 0, zeze_rhs_170891);
                    bool y_170893 = slt64(zeze_rhs_170891, nS_141122);
                    bool bounds_check_170894 = x_170892 && y_170893;
                    bool index_certs_170895;
                    
                    if (!bounds_check_170894) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_170891, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:707:31-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:702:10-710:8\n   #3  ftHashJoin.fut:850:6-854:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_170896 = ((int16_t *) mem_172109)[zeze_rhs_170891];
                    bool is_eq_170897 = rv_170881 == zeze_rhs_170896;
                    int64_t loopres_170898;
                    
                    if (is_eq_170897) {
                        int64_t tmp_170899 = add64((int64_t) 1, m_170890);
                        
                        loopres_170898 = tmp_170899;
                    } else {
                        loopres_170898 = m_170890;
                    }
                    
                    bool loop_cond_170900 = slt64(loopres_170898, eta_p_170875);
                    bool loop_while_tmp_172593 = loop_cond_170900;
                    int64_t j_tmp_172594 = zeze_rhs_170891;
                    int64_t m_tmp_172595 = loopres_170898;
                    
                    loop_while_170888 = loop_while_tmp_172593;
                    j_170889 = j_tmp_172594;
                    m_170890 = m_tmp_172595;
                }
                kth_match_170885 = loop_while_170888;
                kth_match_170886 = j_170889;
                kth_match_170887 = m_170890;
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_172227.mem, i_171664 * b_141121, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171818.mem, eta_p_170876 * b_141121, (int64_t []) {(int64_t) 1}, (int64_t []) {b_141121});
                ((int64_t *) mem_172229.mem)[i_171664] = kth_match_170886;
            }
            if (memblock_unref(ctx, &ext_mem_172225, "ext_mem_172225") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_172245, bytes_172188, "mem_172245")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172245.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172224.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_170490});
            if (memblock_unref(ctx, &ext_mem_172224, "ext_mem_172224") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172253, &mem_172245, "mem_172245") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172252, &mem_172229, "mem_172229") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172249, &mem_172227, "mem_172227") != 0)
                return 1;
            radix_hash_join_res_f_res_159639 = defunc_res_170490;
            radix_hash_join_res_f_res_159640 = defunc_res_170490;
            radix_hash_join_res_f_res_159641 = defunc_res_170490;
        } else {
            int64_t radix_hash_join_res_f_res_f_res_159998;
            
            if (cond_159248) {
                if (mem_171963_cached_sizze_172702 < bytes_171962) {
                    err = lexical_realloc(ctx, &mem_171963, &mem_171963_cached_sizze_172702, bytes_171962);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171669 = 0; i_171669 < nS_141122; i_171669++) {
                    int32_t defunc_0_byteSeq_to_prim_res_171000;
                    int32_t y_171002 = 0;
                    
                    for (int64_t i_171001 = 0; i_171001 < b_141121; i_171001++) {
                        int64_t zm_lhs_171003 = sub64(b_141121, i_171001);
                        int64_t from_u8_arg0_171004 = sub64(zm_lhs_171003, (int64_t) 1);
                        bool x_171005 = sle64((int64_t) 0, from_u8_arg0_171004);
                        bool y_171006 = slt64(from_u8_arg0_171004, b_141121);
                        bool bounds_check_171007 = x_171005 && y_171006;
                        bool index_certs_171008;
                        
                        if (!bounds_check_171007) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_171004, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:427:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_171009 = ((int8_t *) pS_mem_171819.mem)[i_171669 * b_141121 + from_u8_arg0_171004];
                        int32_t u8_res_171010 = zext_i8_i32(from_u8_arg0_171009);
                        int32_t i64_res_171011 = sext_i64_i32(i_171001);
                        int32_t shift_left_rhs_171012 = mul32(8, i64_res_171011);
                        int32_t lifted_lambda_res_171013 = shl32(u8_res_171010, shift_left_rhs_171012);
                        int32_t unsign_arg0_171014 = y_171002 | lifted_lambda_res_171013;
                        int32_t y_tmp_172597 = unsign_arg0_171014;
                        
                        y_171002 = y_tmp_172597;
                    }
                    defunc_0_byteSeq_to_prim_res_171000 = y_171002;
                    ((int32_t *) mem_171963)[i_171669] = defunc_0_byteSeq_to_prim_res_171000;
                }
                if (mem_171971_cached_sizze_172703 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171971, &mem_171971_cached_sizze_172703, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171973_cached_sizze_172704 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171973, &mem_171973_cached_sizze_172704, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171975_cached_sizze_172705 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171975, &mem_171975_cached_sizze_172705, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171977_cached_sizze_172706 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171977, &mem_171977_cached_sizze_172706, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171979_cached_sizze_172707 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171979, &mem_171979_cached_sizze_172707, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171981_cached_sizze_172708 < bytes_171980) {
                    err = lexical_realloc(ctx, &mem_171981, &mem_171981_cached_sizze_172708, bytes_171980);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171693;
                int64_t discard_171694;
                int64_t defunc_res_171021;
                int64_t scanacc_171677;
                int64_t scanacc_171678;
                int64_t redout_171681;
                
                scanacc_171677 = (int64_t) 0;
                scanacc_171678 = (int64_t) 0;
                redout_171681 = (int64_t) 0;
                for (int64_t i_171686 = 0; i_171686 < nR_141120; i_171686++) {
                    int32_t defunc_0_byteSeq_to_prim_res_171027;
                    int32_t y_171029 = 0;
                    
                    for (int64_t i_171028 = 0; i_171028 < b_141121; i_171028++) {
                        int64_t zm_lhs_171030 = sub64(b_141121, i_171028);
                        int64_t from_u8_arg0_171031 = sub64(zm_lhs_171030, (int64_t) 1);
                        bool x_171032 = sle64((int64_t) 0, from_u8_arg0_171031);
                        bool y_171033 = slt64(from_u8_arg0_171031, b_141121);
                        bool bounds_check_171034 = x_171032 && y_171033;
                        bool index_certs_171035;
                        
                        if (!bounds_check_171034) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_171031, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:427:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_171036 = ((int8_t *) pR_mem_171818.mem)[i_171686 * b_141121 + from_u8_arg0_171031];
                        int32_t u8_res_171037 = zext_i8_i32(from_u8_arg0_171036);
                        int32_t i64_res_171038 = sext_i64_i32(i_171028);
                        int32_t shift_left_rhs_171039 = mul32(8, i64_res_171038);
                        int32_t lifted_lambda_res_171040 = shl32(u8_res_171037, shift_left_rhs_171039);
                        int32_t unsign_arg0_171041 = y_171029 | lifted_lambda_res_171040;
                        int32_t y_tmp_172607 = unsign_arg0_171041;
                        
                        y_171029 = y_tmp_172607;
                    }
                    defunc_0_byteSeq_to_prim_res_171027 = y_171029;
                    
                    int32_t lifted_lambda_res_171042 = za_rhs_159265 & defunc_0_byteSeq_to_prim_res_171027;
                    int64_t u32_res_171043 = zext_i32_i64(lifted_lambda_res_171042);
                    bool x_171044 = sle64((int64_t) 0, u32_res_171043);
                    bool y_171045 = slt64(u32_res_171043, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124);
                    bool bounds_check_171046 = x_171044 && y_171045;
                    bool index_certs_171047;
                    
                    if (!bounds_check_171046) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u32_res_171043, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_171048 = ((int64_t *) first_info_idx_mem_171822.mem)[u32_res_171043];
                    bool cond_171049 = slt64(spi_171048, (int64_t) 0);
                    int64_t defunc_res_171050;
                    
                    if (cond_171049) {
                        defunc_res_171050 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_171051 = ((int64_t *) last_info_idx_mem_171823.mem)[u32_res_171043];
                        bool cond_171052 = spi_171048 == zeze_rhs_171051;
                        int64_t defunc_res_f_res_171053;
                        
                        if (cond_171052) {
                            defunc_res_f_res_171053 = spi_171048;
                        } else {
                            int64_t zs_lhs_171054 = sub64(zeze_rhs_171051, spi_171048);
                            int64_t max_arg1_171055 = sdiv64(zs_lhs_171054, (int64_t) 2);
                            int64_t max_res_171056 = smax64((int64_t) 1, max_arg1_171055);
                            bool loop_cond_171057 = slt64((int64_t) 0, max_res_171056);
                            bool bsearch_171058;
                            int64_t bsearch_171059;
                            int64_t bsearch_171060;
                            bool loop_while_171061;
                            int64_t heshi_171062;
                            int64_t step_171063;
                            
                            loop_while_171061 = loop_cond_171057;
                            heshi_171062 = spi_171048;
                            step_171063 = max_res_171056;
                            while (loop_while_171061) {
                                bool x_171064 = sle64((int64_t) 0, heshi_171062);
                                bool y_171065 = slt64(heshi_171062, dz2081U_141123);
                                bool bounds_check_171066 = x_171064 && y_171065;
                                bool index_certs_171067;
                                
                                if (!bounds_check_171066) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_171062, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_171085 = ((int64_t *) bounds_mem_171820.mem)[heshi_171062];
                                bool x_171086 = sle64((int64_t) 0, cur_S_171085);
                                bool y_171087 = slt64(cur_S_171085, nS_141122);
                                bool bounds_check_171088 = x_171086 && y_171087;
                                bool index_certs_171089;
                                
                                if (!bounds_check_171088) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_171085, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_171068 = ((int32_t *) depths_mem_171821.mem)[heshi_171062];
                                bool cond_171069 = heshi_171062 == spi_171048;
                                int32_t prev_depth_171070;
                                
                                if (cond_171069) {
                                    prev_depth_171070 = cur_depth_171068;
                                } else {
                                    int64_t tmp_171071 = sub64(heshi_171062, (int64_t) 1);
                                    bool x_171072 = sle64((int64_t) 0, tmp_171071);
                                    bool y_171073 = slt64(tmp_171071, dz2081U_141123);
                                    bool bounds_check_171074 = x_171072 && y_171073;
                                    bool index_certs_171075;
                                    
                                    if (!bounds_check_171074) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171071, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_171076 = ((int32_t *) depths_mem_171821.mem)[tmp_171071];
                                    
                                    prev_depth_171070 = prev_depth_f_res_171076;
                                }
                                
                                bool cond_171077 = heshi_171062 == zeze_rhs_171051;
                                int32_t next_depth_171078;
                                
                                if (cond_171077) {
                                    next_depth_171078 = cur_depth_171068;
                                } else {
                                    int64_t tmp_171079 = add64((int64_t) 1, heshi_171062);
                                    bool x_171080 = sle64((int64_t) 0, tmp_171079);
                                    bool y_171081 = slt64(tmp_171079, dz2081U_141123);
                                    bool bounds_check_171082 = x_171080 && y_171081;
                                    bool index_certs_171083;
                                    
                                    if (!bounds_check_171082) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171079, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_171084 = ((int32_t *) depths_mem_171821.mem)[tmp_171079];
                                    
                                    next_depth_171078 = next_depth_f_res_171084;
                                }
                                
                                int32_t cur_S_171090 = ((int32_t *) mem_171963)[cur_S_171085];
                                int32_t prev_S_171091;
                                
                                if (cond_171069) {
                                    prev_S_171091 = cur_S_171090;
                                } else {
                                    int64_t tmp_171092 = sub64(heshi_171062, (int64_t) 1);
                                    bool x_171093 = sle64((int64_t) 0, tmp_171092);
                                    bool y_171094 = slt64(tmp_171092, dz2081U_141123);
                                    bool bounds_check_171095 = x_171093 && y_171094;
                                    bool index_certs_171096;
                                    
                                    if (!bounds_check_171095) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171092, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_171097 = ((int64_t *) bounds_mem_171820.mem)[tmp_171092];
                                    bool x_171098 = sle64((int64_t) 0, tmp_171097);
                                    bool y_171099 = slt64(tmp_171097, nS_141122);
                                    bool bounds_check_171100 = x_171098 && y_171099;
                                    bool index_certs_171101;
                                    
                                    if (!bounds_check_171100) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171097, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_S_f_res_171102 = ((int32_t *) mem_171963)[tmp_171097];
                                    
                                    prev_S_171091 = prev_S_f_res_171102;
                                }
                                
                                int32_t next_S_171103;
                                
                                if (cond_171077) {
                                    next_S_171103 = cur_S_171090;
                                } else {
                                    int64_t tmp_171104 = add64((int64_t) 1, heshi_171062);
                                    bool x_171105 = sle64((int64_t) 0, tmp_171104);
                                    bool y_171106 = slt64(tmp_171104, dz2081U_141123);
                                    bool bounds_check_171107 = x_171105 && y_171106;
                                    bool index_certs_171108;
                                    
                                    if (!bounds_check_171107) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171104, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_171109 = ((int64_t *) bounds_mem_171820.mem)[tmp_171104];
                                    bool x_171110 = sle64((int64_t) 0, tmp_171109);
                                    bool y_171111 = slt64(tmp_171109, nS_141122);
                                    bool bounds_check_171112 = x_171110 && y_171111;
                                    bool index_certs_171113;
                                    
                                    if (!bounds_check_171112) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171109, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:722:5-729:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_S_f_res_171114 = ((int32_t *) mem_171963)[tmp_171109];
                                    
                                    next_S_171103 = next_S_f_res_171114;
                                }
                                
                                int32_t prim_get_radix_arg0_171115 = mul32(radix_sizze_141125, cur_depth_171068);
                                int64_t unsign_arg0_171116 = zext_i32_i64(prim_get_radix_arg0_171115);
                                int64_t asPow_171117 = shl64((int64_t) 1, unsign_arg0_171116);
                                int64_t u64_arg0_171118 = sub64(asPow_171117, (int64_t) 1);
                                int32_t u64_res_171119 = zext_i64_i32(u64_arg0_171118);
                                int32_t lifted_lambda_res_171120 = defunc_0_byteSeq_to_prim_res_171027 & u64_res_171119;
                                int32_t lifted_lambda_res_171121 = cur_S_171090 & u64_res_171119;
                                bool defunc_0_eq_res_171122 = lifted_lambda_res_171120 == lifted_lambda_res_171121;
                                int64_t loopres_171123;
                                int64_t loopres_171124;
                                
                                if (defunc_0_eq_res_171122) {
                                    loopres_171123 = heshi_171062;
                                    loopres_171124 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_171125 = slt32(0, cur_depth_171068);
                                    bool is_lt_171126;
                                    bool is_lt_171127;
                                    int32_t is_lt_171128;
                                    bool loop_while_171129;
                                    bool def_lt_171130;
                                    int32_t bi_171131;
                                    
                                    loop_while_171129 = loop_cond_t_res_171125;
                                    def_lt_171130 = 0;
                                    bi_171131 = 0;
                                    while (loop_while_171129) {
                                        int32_t zt_rhs_171132 = add32(1, bi_171131);
                                        int32_t prim_get_radix_arg0_171133 = mul32(radix_sizze_141125, zt_rhs_171132);
                                        int64_t unsign_arg0_171134 = zext_i32_i64(prim_get_radix_arg0_171133);
                                        int64_t asPow_171135 = shl64((int64_t) 1, unsign_arg0_171134);
                                        int64_t u64_arg0_171136 = sub64(asPow_171135, (int64_t) 1);
                                        int32_t u64_res_171137 = zext_i64_i32(u64_arg0_171136);
                                        int32_t lifted_lambda_res_171138 = defunc_0_byteSeq_to_prim_res_171027 & u64_res_171137;
                                        int32_t lifted_lambda_res_171139 = cur_S_171090 & u64_res_171137;
                                        bool defunc_0_lt_res_171140 = ult32(lifted_lambda_res_171138, lifted_lambda_res_171139);
                                        bool defunc_0_lt_res_171141 = ult32(lifted_lambda_res_171139, lifted_lambda_res_171138);
                                        bool cond_171142 = !defunc_0_lt_res_171141;
                                        bool cond_t_res_171143 = !defunc_0_lt_res_171140;
                                        bool x_171144 = cond_171142 && cond_t_res_171143;
                                        bool loop_cond_t_res_171145 = slt32(zt_rhs_171132, cur_depth_171068);
                                        bool x_171146 = x_171144 && loop_cond_t_res_171145;
                                        bool loop_while_tmp_172611 = x_171146;
                                        bool def_lt_tmp_172612 = defunc_0_lt_res_171140;
                                        int32_t bi_tmp_172613 = zt_rhs_171132;
                                        
                                        loop_while_171129 = loop_while_tmp_172611;
                                        def_lt_171130 = def_lt_tmp_172612;
                                        bi_171131 = bi_tmp_172613;
                                    }
                                    is_lt_171126 = loop_while_171129;
                                    is_lt_171127 = def_lt_171130;
                                    is_lt_171128 = bi_171131;
                                    
                                    int64_t loopres_f_res_171147;
                                    int64_t loopres_f_res_171148;
                                    
                                    if (is_lt_171127) {
                                        bool loop_cond_t_res_171149 = slt32(0, prev_depth_171070);
                                        bool is_gt_171150;
                                        bool is_gt_171151;
                                        int32_t is_gt_171152;
                                        bool loop_while_171153;
                                        bool def_gt_171154;
                                        int32_t bi_171155;
                                        
                                        loop_while_171153 = loop_cond_t_res_171149;
                                        def_gt_171154 = 0;
                                        bi_171155 = 0;
                                        while (loop_while_171153) {
                                            int32_t zt_rhs_171156 = add32(1, bi_171155);
                                            int32_t prim_get_radix_arg0_171157 = mul32(radix_sizze_141125, zt_rhs_171156);
                                            int64_t unsign_arg0_171158 = zext_i32_i64(prim_get_radix_arg0_171157);
                                            int64_t asPow_171159 = shl64((int64_t) 1, unsign_arg0_171158);
                                            int64_t u64_arg0_171160 = sub64(asPow_171159, (int64_t) 1);
                                            int32_t u64_res_171161 = zext_i64_i32(u64_arg0_171160);
                                            int32_t lifted_lambda_res_171162 = defunc_0_byteSeq_to_prim_res_171027 & u64_res_171161;
                                            int32_t lifted_lambda_res_171163 = prev_S_171091 & u64_res_171161;
                                            bool defunc_0_gt_res_171164 = ult32(lifted_lambda_res_171163, lifted_lambda_res_171162);
                                            bool defunc_0_gt_res_171165 = ult32(lifted_lambda_res_171162, lifted_lambda_res_171163);
                                            bool cond_171166 = !defunc_0_gt_res_171164;
                                            bool cond_t_res_171167 = !defunc_0_gt_res_171165;
                                            bool x_171168 = cond_171166 && cond_t_res_171167;
                                            bool loop_cond_t_res_171169 = slt32(zt_rhs_171156, prev_depth_171070);
                                            bool x_171170 = x_171168 && loop_cond_t_res_171169;
                                            bool loop_while_tmp_172614 = x_171170;
                                            bool def_gt_tmp_172615 = defunc_0_gt_res_171164;
                                            int32_t bi_tmp_172616 = zt_rhs_171156;
                                            
                                            loop_while_171153 = loop_while_tmp_172614;
                                            def_gt_171154 = def_gt_tmp_172615;
                                            bi_171155 = bi_tmp_172616;
                                        }
                                        is_gt_171150 = loop_while_171153;
                                        is_gt_171151 = def_gt_171154;
                                        is_gt_171152 = bi_171155;
                                        
                                        bool x_171171 = !cond_171069;
                                        bool y_171172 = is_gt_171151 && x_171171;
                                        bool cond_171173 = cond_171069 || y_171172;
                                        int64_t loopres_f_res_t_res_171174;
                                        int64_t loopres_f_res_t_res_171175;
                                        
                                        if (cond_171173) {
                                            loopres_f_res_t_res_171174 = (int64_t) -1;
                                            loopres_f_res_t_res_171175 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_171176 = sub64(heshi_171062, step_171063);
                                            int64_t max_arg1_171177 = sdiv64(step_171063, (int64_t) 2);
                                            int64_t max_res_171178 = smax64((int64_t) 1, max_arg1_171177);
                                            
                                            loopres_f_res_t_res_171174 = tmp_171176;
                                            loopres_f_res_t_res_171175 = max_res_171178;
                                        }
                                        loopres_f_res_171147 = loopres_f_res_t_res_171174;
                                        loopres_f_res_171148 = loopres_f_res_t_res_171175;
                                    } else {
                                        bool loop_cond_t_res_171179 = slt32(0, next_depth_171078);
                                        bool is_lt_171180;
                                        bool is_lt_171181;
                                        int32_t is_lt_171182;
                                        bool loop_while_171183;
                                        bool def_lt_171184;
                                        int32_t bi_171185;
                                        
                                        loop_while_171183 = loop_cond_t_res_171179;
                                        def_lt_171184 = 0;
                                        bi_171185 = 0;
                                        while (loop_while_171183) {
                                            int32_t zt_rhs_171186 = add32(1, bi_171185);
                                            int32_t prim_get_radix_arg0_171187 = mul32(radix_sizze_141125, zt_rhs_171186);
                                            int64_t unsign_arg0_171188 = zext_i32_i64(prim_get_radix_arg0_171187);
                                            int64_t asPow_171189 = shl64((int64_t) 1, unsign_arg0_171188);
                                            int64_t u64_arg0_171190 = sub64(asPow_171189, (int64_t) 1);
                                            int32_t u64_res_171191 = zext_i64_i32(u64_arg0_171190);
                                            int32_t lifted_lambda_res_171192 = defunc_0_byteSeq_to_prim_res_171027 & u64_res_171191;
                                            int32_t lifted_lambda_res_171193 = next_S_171103 & u64_res_171191;
                                            bool defunc_0_lt_res_171194 = ult32(lifted_lambda_res_171192, lifted_lambda_res_171193);
                                            bool defunc_0_lt_res_171195 = ult32(lifted_lambda_res_171193, lifted_lambda_res_171192);
                                            bool cond_171196 = !defunc_0_lt_res_171195;
                                            bool cond_t_res_171197 = !defunc_0_lt_res_171194;
                                            bool x_171198 = cond_171196 && cond_t_res_171197;
                                            bool loop_cond_t_res_171199 = slt32(zt_rhs_171186, next_depth_171078);
                                            bool x_171200 = x_171198 && loop_cond_t_res_171199;
                                            bool loop_while_tmp_172617 = x_171200;
                                            bool def_lt_tmp_172618 = defunc_0_lt_res_171194;
                                            int32_t bi_tmp_172619 = zt_rhs_171186;
                                            
                                            loop_while_171183 = loop_while_tmp_172617;
                                            def_lt_171184 = def_lt_tmp_172618;
                                            bi_171185 = bi_tmp_172619;
                                        }
                                        is_lt_171180 = loop_while_171183;
                                        is_lt_171181 = def_lt_171184;
                                        is_lt_171182 = bi_171185;
                                        
                                        bool x_171201 = !cond_171077;
                                        bool y_171202 = is_lt_171181 && x_171201;
                                        bool cond_171203 = cond_171077 || y_171202;
                                        int64_t loopres_f_res_f_res_171204;
                                        int64_t loopres_f_res_f_res_171205;
                                        
                                        if (cond_171203) {
                                            loopres_f_res_f_res_171204 = (int64_t) -1;
                                            loopres_f_res_f_res_171205 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_171206 = add64(heshi_171062, step_171063);
                                            int64_t max_arg1_171207 = sdiv64(step_171063, (int64_t) 2);
                                            int64_t max_res_171208 = smax64((int64_t) 1, max_arg1_171207);
                                            
                                            loopres_f_res_f_res_171204 = tmp_171206;
                                            loopres_f_res_f_res_171205 = max_res_171208;
                                        }
                                        loopres_f_res_171147 = loopres_f_res_f_res_171204;
                                        loopres_f_res_171148 = loopres_f_res_f_res_171205;
                                    }
                                    loopres_171123 = loopres_f_res_171147;
                                    loopres_171124 = loopres_f_res_171148;
                                }
                                
                                bool loop_cond_171209 = slt64((int64_t) 0, loopres_171124);
                                bool loop_while_tmp_172608 = loop_cond_171209;
                                int64_t heshi_tmp_172609 = loopres_171123;
                                int64_t step_tmp_172610 = loopres_171124;
                                
                                loop_while_171061 = loop_while_tmp_172608;
                                heshi_171062 = heshi_tmp_172609;
                                step_171063 = step_tmp_172610;
                            }
                            bsearch_171058 = loop_while_171061;
                            bsearch_171059 = heshi_171062;
                            bsearch_171060 = step_171063;
                            defunc_res_f_res_171053 = bsearch_171059;
                        }
                        defunc_res_171050 = defunc_res_f_res_171053;
                    }
                    
                    bool cond_171210 = sle64(defunc_res_171050, (int64_t) 0);
                    int64_t inf_171211;
                    
                    if (cond_171210) {
                        inf_171211 = (int64_t) 0;
                    } else {
                        bool x_171212 = sle64((int64_t) 0, defunc_res_171050);
                        bool y_171213 = slt64(defunc_res_171050, dz2081U_141123);
                        bool bounds_check_171214 = x_171212 && y_171213;
                        bool index_certs_171215;
                        
                        if (!bounds_check_171214) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_171050, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:730:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-855:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_171216 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_171050];
                        
                        inf_171211 = inf_f_res_171216;
                    }
                    
                    bool cond_171217 = defunc_res_171050 == zeze_rhs_159252;
                    int64_t sup_171218;
                    
                    if (cond_171217) {
                        sup_171218 = nS_141122;
                    } else {
                        int64_t tmp_171219 = add64((int64_t) 1, defunc_res_171050);
                        bool x_171220 = sle64((int64_t) 0, tmp_171219);
                        bool y_171221 = slt64(tmp_171219, dz2081U_141123);
                        bool bounds_check_171222 = x_171220 && y_171221;
                        bool index_certs_171223;
                        
                        if (!bounds_check_171222) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_171219, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:731:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-855:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_171224 = ((int64_t *) bounds_mem_171820.mem)[tmp_171219];
                        
                        sup_171218 = sup_f_res_171224;
                    }
                    
                    bool loop_cond_171225 = slt64(inf_171211, sup_171218);
                    bool lifted_lambda_res_171226;
                    int64_t lifted_lambda_res_171227;
                    int64_t lifted_lambda_res_171228;
                    int64_t lifted_lambda_res_171229;
                    bool loop_while_171230;
                    int64_t j_171231;
                    int64_t duome_171232;
                    int64_t i_171233;
                    
                    loop_while_171230 = loop_cond_171225;
                    j_171231 = inf_171211;
                    duome_171232 = (int64_t) 0;
                    i_171233 = inf_171211;
                    while (loop_while_171230) {
                        bool x_171234 = sle64((int64_t) 0, i_171233);
                        bool y_171235 = slt64(i_171233, nS_141122);
                        bool bounds_check_171236 = x_171234 && y_171235;
                        bool index_certs_171237;
                        
                        if (!bounds_check_171236) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171233, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:734:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-855:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_171238 = ((int32_t *) mem_171963)[i_171233];
                        bool is_eq_171239 = defunc_0_byteSeq_to_prim_res_171027 == zeze_rhs_171238;
                        bool cond_171240 = slt64((int64_t) 0, duome_171232);
                        bool cond_171241 = is_eq_171239 || cond_171240;
                        int64_t next_j_171242;
                        
                        if (cond_171241) {
                            next_j_171242 = j_171231;
                        } else {
                            int64_t next_j_f_res_171243 = add64((int64_t) 1, j_171231);
                            
                            next_j_171242 = next_j_f_res_171243;
                        }
                        
                        int64_t next_duome_171244;
                        
                        if (is_eq_171239) {
                            int64_t next_duome_t_res_171245 = add64((int64_t) 1, duome_171232);
                            
                            next_duome_171244 = next_duome_t_res_171245;
                        } else {
                            next_duome_171244 = duome_171232;
                        }
                        
                        int64_t tmp_171246 = add64((int64_t) 1, i_171233);
                        bool loop_cond_171247 = slt64(tmp_171246, sup_171218);
                        bool loop_while_tmp_172620 = loop_cond_171247;
                        int64_t j_tmp_172621 = next_j_171242;
                        int64_t duome_tmp_172622 = next_duome_171244;
                        int64_t i_tmp_172623 = tmp_171246;
                        
                        loop_while_171230 = loop_while_tmp_172620;
                        j_171231 = j_tmp_172621;
                        duome_171232 = duome_tmp_172622;
                        i_171233 = i_tmp_172623;
                    }
                    lifted_lambda_res_171226 = loop_while_171230;
                    lifted_lambda_res_171227 = j_171231;
                    lifted_lambda_res_171228 = duome_171232;
                    lifted_lambda_res_171229 = i_171233;
                    
                    bool cond_171248 = slt64(lifted_lambda_res_171227, sup_171218);
                    int64_t lifted_lambda_res_171249;
                    
                    if (cond_171248) {
                        lifted_lambda_res_171249 = lifted_lambda_res_171228;
                    } else {
                        lifted_lambda_res_171249 = (int64_t) 0;
                    }
                    
                    int64_t lifted_lambda_res_171250;
                    
                    if (cond_171248) {
                        lifted_lambda_res_171250 = lifted_lambda_res_171227;
                    } else {
                        lifted_lambda_res_171250 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_171251 = slt64((int64_t) 1, lifted_lambda_res_171249);
                    int64_t defunc_0_f_res_171252 = btoi_bool_i64(lifted_lambda_res_171251);
                    int64_t defunc_0_op_res_171255 = add64(defunc_0_f_res_171252, scanacc_171677);
                    int64_t defunc_0_op_res_171258 = add64(lifted_lambda_res_171249, scanacc_171678);
                    int64_t zp_res_171261 = add64(lifted_lambda_res_171249, redout_171681);
                    
                    ((int64_t *) mem_171971)[i_171686] = defunc_0_op_res_171255;
                    ((int64_t *) mem_171973)[i_171686] = defunc_0_op_res_171258;
                    ((int64_t *) mem_171975)[i_171686] = defunc_0_f_res_171252;
                    ((int64_t *) mem_171977)[i_171686] = lifted_lambda_res_171250;
                    ((int64_t *) mem_171979)[i_171686] = lifted_lambda_res_171249;
                    ((int32_t *) mem_171981)[i_171686] = defunc_0_byteSeq_to_prim_res_171027;
                    
                    int64_t scanacc_tmp_172598 = defunc_0_op_res_171255;
                    int64_t scanacc_tmp_172599 = defunc_0_op_res_171258;
                    int64_t redout_tmp_172602 = zp_res_171261;
                    
                    scanacc_171677 = scanacc_tmp_172598;
                    scanacc_171678 = scanacc_tmp_172599;
                    redout_171681 = redout_tmp_172602;
                }
                discard_171693 = scanacc_171677;
                discard_171694 = scanacc_171678;
                defunc_res_171021 = redout_171681;
                
                int64_t m_f_res_171305;
                
                if (x_159254) {
                    int64_t x_171306 = ((int64_t *) mem_171971)[tmp_159255];
                    
                    m_f_res_171305 = x_171306;
                } else {
                    m_f_res_171305 = (int64_t) 0;
                }
                
                int64_t m_171307;
                
                if (cond_159253) {
                    m_171307 = (int64_t) 0;
                } else {
                    m_171307 = m_f_res_171305;
                }
                
                bool cond_171308 = slt64((int64_t) 0, m_171307);
                int64_t m_171309 = sub64(m_171307, (int64_t) 1);
                bool i_p_m_t_s_leq_w_171310 = slt64(m_171309, nR_141120);
                bool zzero_leq_i_p_m_t_s_171311 = sle64((int64_t) 0, m_171309);
                bool y_171312 = i_p_m_t_s_leq_w_171310 && zzero_leq_i_p_m_t_s_171311;
                bool i_lte_j_171313 = sle64((int64_t) 0, m_171307);
                bool forwards_ok_171314 = y_171312 && i_lte_j_171313;
                bool eq_x_zz_171315 = (int64_t) 0 == m_f_res_171305;
                bool p_and_eq_x_y_171316 = x_159254 && eq_x_zz_171315;
                bool empty_slice_171317 = cond_159253 || p_and_eq_x_y_171316;
                bool ok_or_empty_171318 = forwards_ok_171314 || empty_slice_171317;
                bool index_certs_171319;
                
                if (!ok_or_empty_171318) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_171307, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-855:59\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_172026 = (int64_t) 8 * m_171307;
                
                if (mem_172027_cached_sizze_172710 < bytes_172026) {
                    err = lexical_realloc(ctx, &mem_172027, &mem_172027_cached_sizze_172710, bytes_172026);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171979, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_171307});
                
                int64_t max_mult_171322;
                
                if (cond_171308) {
                    if (mem_172029_cached_sizze_172711 < bytes_171832) {
                        err = lexical_realloc(ctx, &mem_172029, &mem_172029_cached_sizze_172711, bytes_171832);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171701 = 0; i_171701 < nR_141120; i_171701++) {
                        int64_t eta_p_171324 = ((int64_t *) mem_171975)[i_171701];
                        int64_t eta_p_171325 = ((int64_t *) mem_171971)[i_171701];
                        bool cond_171326 = eta_p_171324 == (int64_t) 1;
                        int64_t lifted_lambda_res_171327;
                        
                        if (cond_171326) {
                            int64_t lifted_lambda_res_t_res_171328 = sub64(eta_p_171325, (int64_t) 1);
                            
                            lifted_lambda_res_171327 = lifted_lambda_res_t_res_171328;
                        } else {
                            lifted_lambda_res_171327 = (int64_t) -1;
                        }
                        ((int64_t *) mem_172029)[i_171701] = lifted_lambda_res_171327;
                    }
                    for (int64_t write_iter_171703 = 0; write_iter_171703 < nR_141120; write_iter_171703++) {
                        int64_t write_iv_171705 = ((int64_t *) mem_172029)[write_iter_171703];
                        int64_t write_iv_171706 = ((int64_t *) mem_171979)[write_iter_171703];
                        
                        if (sle64((int64_t) 0, write_iv_171705) && slt64(write_iv_171705, m_171307)) {
                            ((int64_t *) mem_172027)[write_iv_171705] = write_iv_171706;
                        }
                    }
                    
                    int64_t defunc_0_reduce_res_171344;
                    int64_t redout_171708 = (int64_t) -9223372036854775808;
                    
                    for (int64_t i_171709 = 0; i_171709 < m_171307; i_171709++) {
                        int64_t x_171345 = ((int64_t *) mem_172027)[i_171709];
                        int64_t max_res_171348 = smax64(x_171345, redout_171708);
                        int64_t redout_tmp_172626 = max_res_171348;
                        
                        redout_171708 = redout_tmp_172626;
                    }
                    defunc_0_reduce_res_171344 = redout_171708;
                    max_mult_171322 = defunc_0_reduce_res_171344;
                } else {
                    max_mult_171322 = (int64_t) 1;
                }
                
                int64_t bytes_172042 = (int64_t) 8 * defunc_res_171021;
                bool bounds_invalid_upwards_171384 = slt64(max_mult_171322, (int64_t) 1);
                bool valid_171386 = !bounds_invalid_upwards_171384;
                bool range_valid_c_171387;
                
                if (!valid_171386) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_171322, " is invalid.", "-> #0  ftHashJoin.fut:757:20-32\n   #1  ftHashJoin.fut:850:6-855:59\n   #2  ftRelational.fut:273:6-276:37\n   #3  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_172080 = b_141121 * defunc_res_171021;
                
                if (mem_172019_cached_sizze_172709 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_172019, &mem_172019_cached_sizze_172709, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171697 = 0; i_171697 < nR_141120; i_171697++) {
                    int64_t eta_p_171293 = ((int64_t *) mem_171979)[i_171697];
                    int64_t zv_lhs_171294 = add64((int64_t) -1, i_171697);
                    int64_t tmp_171295 = smod64(zv_lhs_171294, nR_141120);
                    int64_t lifted_lambda_res_171296 = ((int64_t *) mem_171973)[tmp_171295];
                    bool cond_171297 = i_171697 == (int64_t) 0;
                    int64_t lifted_lambda_res_171298;
                    
                    if (cond_171297) {
                        lifted_lambda_res_171298 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_171298 = lifted_lambda_res_171296;
                    }
                    
                    bool cond_171299 = slt64((int64_t) 0, eta_p_171293);
                    int64_t lifted_lambda_res_171300;
                    
                    if (cond_171299) {
                        lifted_lambda_res_171300 = lifted_lambda_res_171298;
                    } else {
                        lifted_lambda_res_171300 = (int64_t) -1;
                    }
                    ((int64_t *) mem_172019)[i_171697] = lifted_lambda_res_171300;
                }
                if (memblock_alloc(ctx, &mem_172043, bytes_172042, "mem_172043")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172628 = 0; nest_i_172628 < defunc_res_171021; nest_i_172628++) {
                    ((int64_t *) mem_172043.mem)[nest_i_172628] = (int64_t) 0;
                }
                for (int64_t write_iter_171710 = 0; write_iter_171710 < nR_141120; write_iter_171710++) {
                    int64_t write_iv_171712 = ((int64_t *) mem_172019)[write_iter_171710];
                    
                    if (sle64((int64_t) 0, write_iv_171712) && slt64(write_iv_171712, defunc_res_171021)) {
                        ((int64_t *) mem_172043.mem)[write_iv_171712] = write_iter_171710;
                    }
                }
                if (memblock_alloc(ctx, &mem_172051, bytes_172042, "mem_172051")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172630 = 0; nest_i_172630 < defunc_res_171021; nest_i_172630++) {
                    ((int64_t *) mem_172051.mem)[nest_i_172630] = (int64_t) 1;
                }
                
                int64_t distance_171385 = sub64(max_mult_171322, (int64_t) 1);
                
                if (memblock_set(ctx, &mem_param_172054, &mem_172051, "mem_172051") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_172057, &mem_172043, "mem_172043") != 0)
                    return 1;
                for (int64_t i_171390 = 0; i_171390 < distance_171385; i_171390++) {
                    int64_t index_primexp_171393 = add64((int64_t) 1, i_171390);
                    
                    if (memblock_alloc(ctx, &mem_172059, bytes_172042, "mem_172059")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172059.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171021});
                    if (memblock_alloc(ctx, &mem_172061, bytes_172042, "mem_172061")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172061.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172054.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171021});
                    
                    int64_t replicate_arg1_171396 = add64((int64_t) 2, i_171390);
                    
                    for (int64_t write_iter_171715 = 0; write_iter_171715 < nR_141120; write_iter_171715++) {
                        int64_t zlze_lhs_171404 = ((int64_t *) mem_171979)[write_iter_171715];
                        bool cond_171405 = sle64(zlze_lhs_171404, index_primexp_171393);
                        int64_t lifted_lambda_res_171406;
                        
                        if (cond_171405) {
                            lifted_lambda_res_171406 = (int64_t) -1;
                        } else {
                            int64_t zp_lhs_171407 = ((int64_t *) mem_172019)[write_iter_171715];
                            int64_t lifted_lambda_res_f_res_171408 = add64(index_primexp_171393, zp_lhs_171407);
                            
                            lifted_lambda_res_171406 = lifted_lambda_res_f_res_171408;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_171406) && slt64(lifted_lambda_res_171406, defunc_res_171021)) {
                            ((int64_t *) mem_172061.mem)[lifted_lambda_res_171406] = replicate_arg1_171396;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_171406) && slt64(lifted_lambda_res_171406, defunc_res_171021)) {
                            ((int64_t *) mem_172059.mem)[lifted_lambda_res_171406] = write_iter_171715;
                        }
                    }
                    if (memblock_set(ctx, &mem_param_tmp_172631, &mem_172061, "mem_172061") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_172632, &mem_172059, "mem_172059") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_172054, &mem_param_tmp_172631, "mem_param_tmp_172631") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_172057, &mem_param_tmp_172632, "mem_param_tmp_172632") != 0)
                        return 1;
                }
                if (memblock_set(ctx, &ext_mem_172079, &mem_param_172054, "mem_param_172054") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172078, &mem_param_172057, "mem_param_172057") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_172043, "mem_172043") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_172051, "mem_172051") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_172081, bytes_172080, "mem_172081")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc(ctx, &mem_172083, bytes_172042, "mem_172083")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171725 = 0; i_171725 < defunc_res_171021; i_171725++) {
                    int64_t eta_p_171422 = ((int64_t *) ext_mem_172078.mem)[i_171725];
                    bool x_171423 = sle64((int64_t) 0, eta_p_171422);
                    bool y_171424 = slt64(eta_p_171422, nR_141120);
                    bool bounds_check_171425 = x_171423 && y_171424;
                    bool index_certs_171426;
                    
                    if (!bounds_check_171425) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_171422, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  ftHashJoin.fut:767:18-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:766:10-774:8\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t eta_p_171421 = ((int64_t *) ext_mem_172079.mem)[i_171725];
                    int32_t rv_171427 = ((int32_t *) mem_171981)[eta_p_171422];
                    int64_t inf_s_idx_171428 = ((int64_t *) mem_171977)[eta_p_171422];
                    int64_t tmp_171429 = sub64(inf_s_idx_171428, (int64_t) 1);
                    bool loop_cond_171430 = slt64((int64_t) 0, eta_p_171421);
                    bool kth_match_171431;
                    int64_t kth_match_171432;
                    int64_t kth_match_171433;
                    bool loop_while_171434;
                    int64_t j_171435;
                    int64_t m_171436;
                    
                    loop_while_171434 = loop_cond_171430;
                    j_171435 = tmp_171429;
                    m_171436 = (int64_t) 0;
                    while (loop_while_171434) {
                        int64_t zeze_rhs_171437 = add64((int64_t) 1, j_171435);
                        bool x_171438 = sle64((int64_t) 0, zeze_rhs_171437);
                        bool y_171439 = slt64(zeze_rhs_171437, nS_141122);
                        bool bounds_check_171440 = x_171438 && y_171439;
                        bool index_certs_171441;
                        
                        if (!bounds_check_171440) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_171437, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:771:31-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:766:10-774:8\n   #3  ftHashJoin.fut:850:6-855:59\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_171442 = ((int32_t *) mem_171963)[zeze_rhs_171437];
                        bool is_eq_171443 = rv_171427 == zeze_rhs_171442;
                        int64_t loopres_171444;
                        
                        if (is_eq_171443) {
                            int64_t tmp_171445 = add64((int64_t) 1, m_171436);
                            
                            loopres_171444 = tmp_171445;
                        } else {
                            loopres_171444 = m_171436;
                        }
                        
                        bool loop_cond_171446 = slt64(loopres_171444, eta_p_171421);
                        bool loop_while_tmp_172639 = loop_cond_171446;
                        int64_t j_tmp_172640 = zeze_rhs_171437;
                        int64_t m_tmp_172641 = loopres_171444;
                        
                        loop_while_171434 = loop_while_tmp_172639;
                        j_171435 = j_tmp_172640;
                        m_171436 = m_tmp_172641;
                    }
                    kth_match_171431 = loop_while_171434;
                    kth_match_171432 = j_171435;
                    kth_match_171433 = m_171436;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_172081.mem, i_171725 * b_141121, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171818.mem, eta_p_171422 * b_141121, (int64_t []) {(int64_t) 1}, (int64_t []) {b_141121});
                    ((int64_t *) mem_172083.mem)[i_171725] = kth_match_171432;
                }
                if (memblock_unref(ctx, &ext_mem_172079, "ext_mem_172079") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_172099, bytes_172042, "mem_172099")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172099.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172078.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171021});
                if (memblock_unref(ctx, &ext_mem_172078, "ext_mem_172078") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172107, &mem_172099, "mem_172099") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172106, &mem_172083, "mem_172083") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172103, &mem_172081, "mem_172081") != 0)
                    return 1;
                radix_hash_join_res_f_res_f_res_159998 = defunc_res_171021;
            } else {
                if (mem_171825_cached_sizze_172692 < bytes_171824) {
                    err = lexical_realloc(ctx, &mem_171825, &mem_171825_cached_sizze_172692, bytes_171824);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171730 = 0; i_171730 < nS_141122; i_171730++) {
                    int64_t defunc_0_byteSeq_to_prim_res_162408;
                    int64_t y_162410 = (int64_t) 0;
                    
                    for (int64_t i_162409 = 0; i_162409 < b_141121; i_162409++) {
                        int64_t zm_lhs_162411 = sub64(b_141121, i_162409);
                        int64_t from_u8_arg0_162412 = sub64(zm_lhs_162411, (int64_t) 1);
                        bool x_162413 = sle64((int64_t) 0, from_u8_arg0_162412);
                        bool y_162414 = slt64(from_u8_arg0_162412, b_141121);
                        bool bounds_check_162415 = x_162413 && y_162414;
                        bool index_certs_162416;
                        
                        if (!bounds_check_162415) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_162412, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:429:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_162417 = ((int8_t *) pS_mem_171819.mem)[i_171730 * b_141121 + from_u8_arg0_162412];
                        int64_t u8_res_162418 = zext_i8_i64(from_u8_arg0_162417);
                        int32_t i64_res_162419 = sext_i64_i32(i_162409);
                        int32_t shift_left_rhs_162420 = mul32(8, i64_res_162419);
                        int64_t unsign_arg0_162421 = zext_i32_i64(shift_left_rhs_162420);
                        int64_t lifted_lambda_res_162422 = shl64(u8_res_162418, unsign_arg0_162421);
                        int64_t unsign_arg0_162423 = y_162410 | lifted_lambda_res_162422;
                        int64_t y_tmp_172643 = unsign_arg0_162423;
                        
                        y_162410 = y_tmp_172643;
                    }
                    defunc_0_byteSeq_to_prim_res_162408 = y_162410;
                    ((int64_t *) mem_171825)[i_171730] = defunc_0_byteSeq_to_prim_res_162408;
                }
                if (mem_171833_cached_sizze_172693 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171833, &mem_171833_cached_sizze_172693, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171835_cached_sizze_172694 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171835, &mem_171835_cached_sizze_172694, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171837_cached_sizze_172695 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172695, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171839_cached_sizze_172696 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172696, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171841_cached_sizze_172697 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171841, &mem_171841_cached_sizze_172697, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171843_cached_sizze_172698 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171843, &mem_171843_cached_sizze_172698, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171754;
                int64_t discard_171755;
                int64_t defunc_res_171536;
                int64_t scanacc_171738;
                int64_t scanacc_171739;
                int64_t redout_171742;
                
                scanacc_171738 = (int64_t) 0;
                scanacc_171739 = (int64_t) 0;
                redout_171742 = (int64_t) 0;
                for (int64_t i_171747 = 0; i_171747 < nR_141120; i_171747++) {
                    int64_t defunc_0_byteSeq_to_prim_res_167768;
                    int64_t y_167770 = (int64_t) 0;
                    
                    for (int64_t i_167769 = 0; i_167769 < b_141121; i_167769++) {
                        int64_t zm_lhs_167771 = sub64(b_141121, i_167769);
                        int64_t from_u8_arg0_167772 = sub64(zm_lhs_167771, (int64_t) 1);
                        bool x_167773 = sle64((int64_t) 0, from_u8_arg0_167772);
                        bool y_167774 = slt64(from_u8_arg0_167772, b_141121);
                        bool bounds_check_167775 = x_167773 && y_167774;
                        bool index_certs_167776;
                        
                        if (!bounds_check_167775) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167772, "] out of bounds for array of shape [", (long long) b_141121, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:429:77-84\n   #2  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_167777 = ((int8_t *) pR_mem_171818.mem)[i_171747 * b_141121 + from_u8_arg0_167772];
                        int64_t u8_res_167778 = zext_i8_i64(from_u8_arg0_167777);
                        int32_t i64_res_167779 = sext_i64_i32(i_167769);
                        int32_t shift_left_rhs_167780 = mul32(8, i64_res_167779);
                        int64_t unsign_arg0_167781 = zext_i32_i64(shift_left_rhs_167780);
                        int64_t lifted_lambda_res_167782 = shl64(u8_res_167778, unsign_arg0_167781);
                        int64_t unsign_arg0_167783 = y_167770 | lifted_lambda_res_167782;
                        int64_t y_tmp_172653 = unsign_arg0_167783;
                        
                        y_167770 = y_tmp_172653;
                    }
                    defunc_0_byteSeq_to_prim_res_167768 = y_167770;
                    
                    int64_t lifted_lambda_res_167785 = u64_arg0_159251 & defunc_0_byteSeq_to_prim_res_167768;
                    bool x_167786 = sle64((int64_t) 0, lifted_lambda_res_167785);
                    bool y_167787 = slt64(lifted_lambda_res_167785, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124);
                    bool bounds_check_167788 = x_167786 && y_167787;
                    bool index_certs_167789;
                    
                    if (!bounds_check_167788) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_167785, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_167790 = ((int64_t *) first_info_idx_mem_171822.mem)[lifted_lambda_res_167785];
                    bool cond_167791 = slt64(spi_167790, (int64_t) 0);
                    int64_t defunc_res_167792;
                    
                    if (cond_167791) {
                        defunc_res_167792 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_167793 = ((int64_t *) last_info_idx_mem_171823.mem)[lifted_lambda_res_167785];
                        bool cond_167794 = spi_167790 == zeze_rhs_167793;
                        int64_t defunc_res_f_res_167795;
                        
                        if (cond_167794) {
                            defunc_res_f_res_167795 = spi_167790;
                        } else {
                            int64_t zs_lhs_167796 = sub64(zeze_rhs_167793, spi_167790);
                            int64_t max_arg1_167797 = sdiv64(zs_lhs_167796, (int64_t) 2);
                            int64_t max_res_167798 = smax64((int64_t) 1, max_arg1_167797);
                            bool loop_cond_167799 = slt64((int64_t) 0, max_res_167798);
                            bool bsearch_167800;
                            int64_t bsearch_167801;
                            int64_t bsearch_167802;
                            bool loop_while_167803;
                            int64_t heshi_167804;
                            int64_t step_167805;
                            
                            loop_while_167803 = loop_cond_167799;
                            heshi_167804 = spi_167790;
                            step_167805 = max_res_167798;
                            while (loop_while_167803) {
                                bool x_167806 = sle64((int64_t) 0, heshi_167804);
                                bool y_167807 = slt64(heshi_167804, dz2081U_141123);
                                bool bounds_check_167808 = x_167806 && y_167807;
                                bool index_certs_167809;
                                
                                if (!bounds_check_167808) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167804, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_167827 = ((int64_t *) bounds_mem_171820.mem)[heshi_167804];
                                bool x_167828 = sle64((int64_t) 0, cur_S_167827);
                                bool y_167829 = slt64(cur_S_167827, nS_141122);
                                bool bounds_check_167830 = x_167828 && y_167829;
                                bool index_certs_167831;
                                
                                if (!bounds_check_167830) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167827, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_167810 = ((int32_t *) depths_mem_171821.mem)[heshi_167804];
                                bool cond_167811 = heshi_167804 == spi_167790;
                                int32_t prev_depth_167812;
                                
                                if (cond_167811) {
                                    prev_depth_167812 = cur_depth_167810;
                                } else {
                                    int64_t tmp_167813 = sub64(heshi_167804, (int64_t) 1);
                                    bool x_167814 = sle64((int64_t) 0, tmp_167813);
                                    bool y_167815 = slt64(tmp_167813, dz2081U_141123);
                                    bool bounds_check_167816 = x_167814 && y_167815;
                                    bool index_certs_167817;
                                    
                                    if (!bounds_check_167816) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167813, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_167818 = ((int32_t *) depths_mem_171821.mem)[tmp_167813];
                                    
                                    prev_depth_167812 = prev_depth_f_res_167818;
                                }
                                
                                bool cond_167819 = heshi_167804 == zeze_rhs_167793;
                                int32_t next_depth_167820;
                                
                                if (cond_167819) {
                                    next_depth_167820 = cur_depth_167810;
                                } else {
                                    int64_t tmp_167821 = add64((int64_t) 1, heshi_167804);
                                    bool x_167822 = sle64((int64_t) 0, tmp_167821);
                                    bool y_167823 = slt64(tmp_167821, dz2081U_141123);
                                    bool bounds_check_167824 = x_167822 && y_167823;
                                    bool index_certs_167825;
                                    
                                    if (!bounds_check_167824) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167821, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_167826 = ((int32_t *) depths_mem_171821.mem)[tmp_167821];
                                    
                                    next_depth_167820 = next_depth_f_res_167826;
                                }
                                
                                int64_t cur_S_167832 = ((int64_t *) mem_171825)[cur_S_167827];
                                int64_t prev_S_167833;
                                
                                if (cond_167811) {
                                    prev_S_167833 = cur_S_167832;
                                } else {
                                    int64_t tmp_167834 = sub64(heshi_167804, (int64_t) 1);
                                    bool x_167835 = sle64((int64_t) 0, tmp_167834);
                                    bool y_167836 = slt64(tmp_167834, dz2081U_141123);
                                    bool bounds_check_167837 = x_167835 && y_167836;
                                    bool index_certs_167838;
                                    
                                    if (!bounds_check_167837) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167834, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167839 = ((int64_t *) bounds_mem_171820.mem)[tmp_167834];
                                    bool x_167840 = sle64((int64_t) 0, tmp_167839);
                                    bool y_167841 = slt64(tmp_167839, nS_141122);
                                    bool bounds_check_167842 = x_167840 && y_167841;
                                    bool index_certs_167843;
                                    
                                    if (!bounds_check_167842) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167839, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t prev_S_f_res_167844 = ((int64_t *) mem_171825)[tmp_167839];
                                    
                                    prev_S_167833 = prev_S_f_res_167844;
                                }
                                
                                int64_t next_S_167845;
                                
                                if (cond_167819) {
                                    next_S_167845 = cur_S_167832;
                                } else {
                                    int64_t tmp_167846 = add64((int64_t) 1, heshi_167804);
                                    bool x_167847 = sle64((int64_t) 0, tmp_167846);
                                    bool y_167848 = slt64(tmp_167846, dz2081U_141123);
                                    bool bounds_check_167849 = x_167847 && y_167848;
                                    bool index_certs_167850;
                                    
                                    if (!bounds_check_167849) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167846, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_167851 = ((int64_t *) bounds_mem_171820.mem)[tmp_167846];
                                    bool x_167852 = sle64((int64_t) 0, tmp_167851);
                                    bool y_167853 = slt64(tmp_167851, nS_141122);
                                    bool bounds_check_167854 = x_167852 && y_167853;
                                    bool index_certs_167855;
                                    
                                    if (!bounds_check_167854) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167851, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:786:5-793:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t next_S_f_res_167856 = ((int64_t *) mem_171825)[tmp_167851];
                                    
                                    next_S_167845 = next_S_f_res_167856;
                                }
                                
                                int32_t prim_get_radix_arg0_167857 = mul32(radix_sizze_141125, cur_depth_167810);
                                int64_t unsign_arg0_167858 = zext_i32_i64(prim_get_radix_arg0_167857);
                                int64_t asPow_167859 = shl64((int64_t) 1, unsign_arg0_167858);
                                int64_t za_rhs_167860 = sub64(asPow_167859, (int64_t) 1);
                                int64_t lifted_lambda_res_167861 = defunc_0_byteSeq_to_prim_res_167768 & za_rhs_167860;
                                int64_t lifted_lambda_res_167862 = cur_S_167832 & za_rhs_167860;
                                bool defunc_0_eq_res_167863 = lifted_lambda_res_167861 == lifted_lambda_res_167862;
                                int64_t loopres_167864;
                                int64_t loopres_167865;
                                
                                if (defunc_0_eq_res_167863) {
                                    loopres_167864 = heshi_167804;
                                    loopres_167865 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_167866 = slt32(0, cur_depth_167810);
                                    bool is_lt_167867;
                                    bool is_lt_167868;
                                    int32_t is_lt_167869;
                                    bool loop_while_167870;
                                    bool def_lt_167871;
                                    int32_t bi_167872;
                                    
                                    loop_while_167870 = loop_cond_t_res_167866;
                                    def_lt_167871 = 0;
                                    bi_167872 = 0;
                                    while (loop_while_167870) {
                                        int32_t zt_rhs_167873 = add32(1, bi_167872);
                                        int32_t prim_get_radix_arg0_167874 = mul32(radix_sizze_141125, zt_rhs_167873);
                                        int64_t unsign_arg0_167875 = zext_i32_i64(prim_get_radix_arg0_167874);
                                        int64_t asPow_167876 = shl64((int64_t) 1, unsign_arg0_167875);
                                        int64_t za_rhs_167877 = sub64(asPow_167876, (int64_t) 1);
                                        int64_t lifted_lambda_res_167878 = defunc_0_byteSeq_to_prim_res_167768 & za_rhs_167877;
                                        int64_t lifted_lambda_res_167879 = cur_S_167832 & za_rhs_167877;
                                        bool defunc_0_lt_res_167880 = ult64(lifted_lambda_res_167878, lifted_lambda_res_167879);
                                        bool defunc_0_lt_res_167881 = ult64(lifted_lambda_res_167879, lifted_lambda_res_167878);
                                        bool cond_167882 = !defunc_0_lt_res_167881;
                                        bool cond_t_res_167883 = !defunc_0_lt_res_167880;
                                        bool x_167884 = cond_167882 && cond_t_res_167883;
                                        bool loop_cond_t_res_167885 = slt32(zt_rhs_167873, cur_depth_167810);
                                        bool x_167886 = x_167884 && loop_cond_t_res_167885;
                                        bool loop_while_tmp_172657 = x_167886;
                                        bool def_lt_tmp_172658 = defunc_0_lt_res_167880;
                                        int32_t bi_tmp_172659 = zt_rhs_167873;
                                        
                                        loop_while_167870 = loop_while_tmp_172657;
                                        def_lt_167871 = def_lt_tmp_172658;
                                        bi_167872 = bi_tmp_172659;
                                    }
                                    is_lt_167867 = loop_while_167870;
                                    is_lt_167868 = def_lt_167871;
                                    is_lt_167869 = bi_167872;
                                    
                                    int64_t loopres_f_res_167887;
                                    int64_t loopres_f_res_167888;
                                    
                                    if (is_lt_167868) {
                                        bool loop_cond_t_res_171461 = slt32(0, prev_depth_167812);
                                        bool is_gt_171462;
                                        bool is_gt_171463;
                                        int32_t is_gt_171464;
                                        bool loop_while_171465;
                                        bool def_gt_171466;
                                        int32_t bi_171467;
                                        
                                        loop_while_171465 = loop_cond_t_res_171461;
                                        def_gt_171466 = 0;
                                        bi_171467 = 0;
                                        while (loop_while_171465) {
                                            int32_t zt_rhs_171468 = add32(1, bi_171467);
                                            int32_t prim_get_radix_arg0_171469 = mul32(radix_sizze_141125, zt_rhs_171468);
                                            int64_t unsign_arg0_171470 = zext_i32_i64(prim_get_radix_arg0_171469);
                                            int64_t asPow_171471 = shl64((int64_t) 1, unsign_arg0_171470);
                                            int64_t za_rhs_171472 = sub64(asPow_171471, (int64_t) 1);
                                            int64_t lifted_lambda_res_171473 = defunc_0_byteSeq_to_prim_res_167768 & za_rhs_171472;
                                            int64_t lifted_lambda_res_171474 = prev_S_167833 & za_rhs_171472;
                                            bool defunc_0_gt_res_171475 = ult64(lifted_lambda_res_171474, lifted_lambda_res_171473);
                                            bool defunc_0_gt_res_171476 = ult64(lifted_lambda_res_171473, lifted_lambda_res_171474);
                                            bool cond_171477 = !defunc_0_gt_res_171475;
                                            bool cond_t_res_171478 = !defunc_0_gt_res_171476;
                                            bool x_171479 = cond_171477 && cond_t_res_171478;
                                            bool loop_cond_t_res_171480 = slt32(zt_rhs_171468, prev_depth_167812);
                                            bool x_171481 = x_171479 && loop_cond_t_res_171480;
                                            bool loop_while_tmp_172660 = x_171481;
                                            bool def_gt_tmp_172661 = defunc_0_gt_res_171475;
                                            int32_t bi_tmp_172662 = zt_rhs_171468;
                                            
                                            loop_while_171465 = loop_while_tmp_172660;
                                            def_gt_171466 = def_gt_tmp_172661;
                                            bi_171467 = bi_tmp_172662;
                                        }
                                        is_gt_171462 = loop_while_171465;
                                        is_gt_171463 = def_gt_171466;
                                        is_gt_171464 = bi_171467;
                                        
                                        bool x_171482 = !cond_167811;
                                        bool y_171483 = is_gt_171463 && x_171482;
                                        bool cond_171484 = cond_167811 || y_171483;
                                        int64_t loopres_f_res_t_res_171485;
                                        int64_t loopres_f_res_t_res_171486;
                                        
                                        if (cond_171484) {
                                            loopres_f_res_t_res_171485 = (int64_t) -1;
                                            loopres_f_res_t_res_171486 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_171487 = sub64(heshi_167804, step_167805);
                                            int64_t max_arg1_171488 = sdiv64(step_167805, (int64_t) 2);
                                            int64_t max_res_171489 = smax64((int64_t) 1, max_arg1_171488);
                                            
                                            loopres_f_res_t_res_171485 = tmp_171487;
                                            loopres_f_res_t_res_171486 = max_res_171489;
                                        }
                                        loopres_f_res_167887 = loopres_f_res_t_res_171485;
                                        loopres_f_res_167888 = loopres_f_res_t_res_171486;
                                    } else {
                                        bool loop_cond_t_res_167918 = slt32(0, next_depth_167820);
                                        bool is_lt_167919;
                                        bool is_lt_167920;
                                        int32_t is_lt_167921;
                                        bool loop_while_167922;
                                        bool def_lt_167923;
                                        int32_t bi_167924;
                                        
                                        loop_while_167922 = loop_cond_t_res_167918;
                                        def_lt_167923 = 0;
                                        bi_167924 = 0;
                                        while (loop_while_167922) {
                                            int32_t zt_rhs_167925 = add32(1, bi_167924);
                                            int32_t prim_get_radix_arg0_167926 = mul32(radix_sizze_141125, zt_rhs_167925);
                                            int64_t unsign_arg0_167927 = zext_i32_i64(prim_get_radix_arg0_167926);
                                            int64_t asPow_167928 = shl64((int64_t) 1, unsign_arg0_167927);
                                            int64_t za_rhs_167929 = sub64(asPow_167928, (int64_t) 1);
                                            int64_t lifted_lambda_res_167930 = defunc_0_byteSeq_to_prim_res_167768 & za_rhs_167929;
                                            int64_t lifted_lambda_res_167931 = next_S_167845 & za_rhs_167929;
                                            bool defunc_0_lt_res_167932 = ult64(lifted_lambda_res_167930, lifted_lambda_res_167931);
                                            bool defunc_0_lt_res_167933 = ult64(lifted_lambda_res_167931, lifted_lambda_res_167930);
                                            bool cond_167934 = !defunc_0_lt_res_167933;
                                            bool cond_t_res_167935 = !defunc_0_lt_res_167932;
                                            bool x_167936 = cond_167934 && cond_t_res_167935;
                                            bool loop_cond_t_res_167937 = slt32(zt_rhs_167925, next_depth_167820);
                                            bool x_167938 = x_167936 && loop_cond_t_res_167937;
                                            bool loop_while_tmp_172663 = x_167938;
                                            bool def_lt_tmp_172664 = defunc_0_lt_res_167932;
                                            int32_t bi_tmp_172665 = zt_rhs_167925;
                                            
                                            loop_while_167922 = loop_while_tmp_172663;
                                            def_lt_167923 = def_lt_tmp_172664;
                                            bi_167924 = bi_tmp_172665;
                                        }
                                        is_lt_167919 = loop_while_167922;
                                        is_lt_167920 = def_lt_167923;
                                        is_lt_167921 = bi_167924;
                                        
                                        bool x_167939 = !cond_167819;
                                        bool y_167940 = is_lt_167920 && x_167939;
                                        bool cond_167941 = cond_167819 || y_167940;
                                        int64_t loopres_f_res_f_res_167942;
                                        int64_t loopres_f_res_f_res_167943;
                                        
                                        if (cond_167941) {
                                            loopres_f_res_f_res_167942 = (int64_t) -1;
                                            loopres_f_res_f_res_167943 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_167944 = add64(heshi_167804, step_167805);
                                            int64_t max_arg1_167945 = sdiv64(step_167805, (int64_t) 2);
                                            int64_t max_res_167946 = smax64((int64_t) 1, max_arg1_167945);
                                            
                                            loopres_f_res_f_res_167942 = tmp_167944;
                                            loopres_f_res_f_res_167943 = max_res_167946;
                                        }
                                        loopres_f_res_167887 = loopres_f_res_f_res_167942;
                                        loopres_f_res_167888 = loopres_f_res_f_res_167943;
                                    }
                                    loopres_167864 = loopres_f_res_167887;
                                    loopres_167865 = loopres_f_res_167888;
                                }
                                
                                bool loop_cond_167947 = slt64((int64_t) 0, loopres_167865);
                                bool loop_while_tmp_172654 = loop_cond_167947;
                                int64_t heshi_tmp_172655 = loopres_167864;
                                int64_t step_tmp_172656 = loopres_167865;
                                
                                loop_while_167803 = loop_while_tmp_172654;
                                heshi_167804 = heshi_tmp_172655;
                                step_167805 = step_tmp_172656;
                            }
                            bsearch_167800 = loop_while_167803;
                            bsearch_167801 = heshi_167804;
                            bsearch_167802 = step_167805;
                            defunc_res_f_res_167795 = bsearch_167801;
                        }
                        defunc_res_167792 = defunc_res_f_res_167795;
                    }
                    
                    bool cond_167948 = sle64(defunc_res_167792, (int64_t) 0);
                    int64_t inf_167949;
                    
                    if (cond_167948) {
                        inf_167949 = (int64_t) 0;
                    } else {
                        bool x_167950 = sle64((int64_t) 0, defunc_res_167792);
                        bool y_167951 = slt64(defunc_res_167792, dz2081U_141123);
                        bool bounds_check_167952 = x_167950 && y_167951;
                        bool index_certs_167953;
                        
                        if (!bounds_check_167952) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167792, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:794:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-856:46\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_167954 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_167792];
                        
                        inf_167949 = inf_f_res_167954;
                    }
                    
                    bool cond_167955 = defunc_res_167792 == zeze_rhs_159252;
                    int64_t sup_167956;
                    
                    if (cond_167955) {
                        sup_167956 = nS_141122;
                    } else {
                        int64_t tmp_167957 = add64((int64_t) 1, defunc_res_167792);
                        bool x_167958 = sle64((int64_t) 0, tmp_167957);
                        bool y_167959 = slt64(tmp_167957, dz2081U_141123);
                        bool bounds_check_167960 = x_167958 && y_167959;
                        bool index_certs_167961;
                        
                        if (!bounds_check_167960) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167957, "] out of bounds for array of shape [", (long long) dz2081U_141123, "].", "-> #0  ftHashJoin.fut:795:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-856:46\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_167962 = ((int64_t *) bounds_mem_171820.mem)[tmp_167957];
                        
                        sup_167956 = sup_f_res_167962;
                    }
                    
                    bool loop_cond_167963 = slt64(inf_167949, sup_167956);
                    bool lifted_lambda_res_167964;
                    int64_t lifted_lambda_res_167965;
                    int64_t lifted_lambda_res_167966;
                    int64_t lifted_lambda_res_167967;
                    bool loop_while_167968;
                    int64_t j_167969;
                    int64_t duome_167970;
                    int64_t i_167971;
                    
                    loop_while_167968 = loop_cond_167963;
                    j_167969 = inf_167949;
                    duome_167970 = (int64_t) 0;
                    i_167971 = inf_167949;
                    while (loop_while_167968) {
                        bool x_167972 = sle64((int64_t) 0, i_167971);
                        bool y_167973 = slt64(i_167971, nS_141122);
                        bool bounds_check_167974 = x_167972 && y_167973;
                        bool index_certs_167975;
                        
                        if (!bounds_check_167974) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_167971, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:798:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-856:46\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_167976 = ((int64_t *) mem_171825)[i_167971];
                        bool is_eq_167977 = defunc_0_byteSeq_to_prim_res_167768 == zeze_rhs_167976;
                        bool cond_167978 = slt64((int64_t) 0, duome_167970);
                        bool cond_167979 = is_eq_167977 || cond_167978;
                        int64_t next_j_167980;
                        
                        if (cond_167979) {
                            next_j_167980 = j_167969;
                        } else {
                            int64_t next_j_f_res_167981 = add64((int64_t) 1, j_167969);
                            
                            next_j_167980 = next_j_f_res_167981;
                        }
                        
                        int64_t next_duome_167982;
                        
                        if (is_eq_167977) {
                            int64_t next_duome_t_res_171490 = add64((int64_t) 1, duome_167970);
                            
                            next_duome_167982 = next_duome_t_res_171490;
                        } else {
                            next_duome_167982 = duome_167970;
                        }
                        
                        int64_t tmp_167984 = add64((int64_t) 1, i_167971);
                        bool loop_cond_167985 = slt64(tmp_167984, sup_167956);
                        bool loop_while_tmp_172666 = loop_cond_167985;
                        int64_t j_tmp_172667 = next_j_167980;
                        int64_t duome_tmp_172668 = next_duome_167982;
                        int64_t i_tmp_172669 = tmp_167984;
                        
                        loop_while_167968 = loop_while_tmp_172666;
                        j_167969 = j_tmp_172667;
                        duome_167970 = duome_tmp_172668;
                        i_167971 = i_tmp_172669;
                    }
                    lifted_lambda_res_167964 = loop_while_167968;
                    lifted_lambda_res_167965 = j_167969;
                    lifted_lambda_res_167966 = duome_167970;
                    lifted_lambda_res_167967 = i_167971;
                    
                    bool cond_167986 = slt64(lifted_lambda_res_167965, sup_167956);
                    int64_t lifted_lambda_res_167987;
                    
                    if (cond_167986) {
                        lifted_lambda_res_167987 = lifted_lambda_res_167966;
                    } else {
                        lifted_lambda_res_167987 = (int64_t) 0;
                    }
                    
                    int64_t lifted_lambda_res_167988;
                    
                    if (cond_167986) {
                        lifted_lambda_res_167988 = lifted_lambda_res_167965;
                    } else {
                        lifted_lambda_res_167988 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_167991 = slt64((int64_t) 1, lifted_lambda_res_167987);
                    int64_t defunc_0_f_res_167992 = btoi_bool_i64(lifted_lambda_res_167991);
                    int64_t defunc_0_op_res_160602 = add64(defunc_0_f_res_167992, scanacc_171738);
                    int64_t defunc_0_op_res_160572 = add64(lifted_lambda_res_167987, scanacc_171739);
                    int64_t zp_res_160593 = add64(lifted_lambda_res_167987, redout_171742);
                    
                    ((int64_t *) mem_171833)[i_171747] = defunc_0_op_res_160602;
                    ((int64_t *) mem_171835)[i_171747] = defunc_0_op_res_160572;
                    ((int64_t *) mem_171837)[i_171747] = defunc_0_f_res_167992;
                    ((int64_t *) mem_171839)[i_171747] = lifted_lambda_res_167988;
                    ((int64_t *) mem_171841)[i_171747] = lifted_lambda_res_167987;
                    ((int64_t *) mem_171843)[i_171747] = defunc_0_byteSeq_to_prim_res_167768;
                    
                    int64_t scanacc_tmp_172644 = defunc_0_op_res_160602;
                    int64_t scanacc_tmp_172645 = defunc_0_op_res_160572;
                    int64_t redout_tmp_172648 = zp_res_160593;
                    
                    scanacc_171738 = scanacc_tmp_172644;
                    scanacc_171739 = scanacc_tmp_172645;
                    redout_171742 = redout_tmp_172648;
                }
                discard_171754 = scanacc_171738;
                discard_171755 = scanacc_171739;
                defunc_res_171536 = redout_171742;
                
                int64_t m_f_res_160603;
                
                if (x_159254) {
                    int64_t x_171491 = ((int64_t *) mem_171833)[tmp_159255];
                    
                    m_f_res_160603 = x_171491;
                } else {
                    m_f_res_160603 = (int64_t) 0;
                }
                
                int64_t m_160605;
                
                if (cond_159253) {
                    m_160605 = (int64_t) 0;
                } else {
                    m_160605 = m_f_res_160603;
                }
                
                bool cond_160628 = slt64((int64_t) 0, m_160605);
                int64_t m_160615 = sub64(m_160605, (int64_t) 1);
                bool i_p_m_t_s_leq_w_160617 = slt64(m_160615, nR_141120);
                bool zzero_leq_i_p_m_t_s_160616 = sle64((int64_t) 0, m_160615);
                bool y_160619 = zzero_leq_i_p_m_t_s_160616 && i_p_m_t_s_leq_w_160617;
                bool i_lte_j_160618 = sle64((int64_t) 0, m_160605);
                bool forwards_ok_160620 = i_lte_j_160618 && y_160619;
                bool eq_x_zz_160612 = (int64_t) 0 == m_f_res_160603;
                bool p_and_eq_x_y_160613 = x_159254 && eq_x_zz_160612;
                bool empty_slice_160614 = cond_159253 || p_and_eq_x_y_160613;
                bool ok_or_empty_160621 = empty_slice_160614 || forwards_ok_160620;
                bool index_certs_160622;
                
                if (!ok_or_empty_160621) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_160605, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:850:6-856:46\n   #3  ftRelational.fut:273:6-276:37\n   #4  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171888 = (int64_t) 8 * m_160605;
                
                if (mem_171889_cached_sizze_172700 < bytes_171888) {
                    err = lexical_realloc(ctx, &mem_171889, &mem_171889_cached_sizze_172700, bytes_171888);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171889, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171841, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_160605});
                
                int64_t max_mult_160629;
                
                if (cond_160628) {
                    if (mem_171891_cached_sizze_172701 < bytes_171832) {
                        err = lexical_realloc(ctx, &mem_171891, &mem_171891_cached_sizze_172701, bytes_171832);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171762 = 0; i_171762 < nR_141120; i_171762++) {
                        int64_t eta_p_171497 = ((int64_t *) mem_171837)[i_171762];
                        int64_t eta_p_171498 = ((int64_t *) mem_171833)[i_171762];
                        bool cond_171499 = eta_p_171497 == (int64_t) 1;
                        int64_t lifted_lambda_res_171500;
                        
                        if (cond_171499) {
                            int64_t lifted_lambda_res_t_res_171501 = sub64(eta_p_171498, (int64_t) 1);
                            
                            lifted_lambda_res_171500 = lifted_lambda_res_t_res_171501;
                        } else {
                            lifted_lambda_res_171500 = (int64_t) -1;
                        }
                        ((int64_t *) mem_171891)[i_171762] = lifted_lambda_res_171500;
                    }
                    for (int64_t write_iter_171764 = 0; write_iter_171764 < nR_141120; write_iter_171764++) {
                        int64_t write_iv_171766 = ((int64_t *) mem_171891)[write_iter_171764];
                        int64_t write_iv_171767 = ((int64_t *) mem_171841)[write_iter_171764];
                        
                        if (sle64((int64_t) 0, write_iv_171766) && slt64(write_iv_171766, m_160605)) {
                            ((int64_t *) mem_171889)[write_iv_171766] = write_iv_171767;
                        }
                    }
                    
                    int64_t defunc_0_reduce_res_171517;
                    int64_t redout_171769 = (int64_t) -9223372036854775808;
                    
                    for (int64_t i_171770 = 0; i_171770 < m_160605; i_171770++) {
                        int64_t x_171518 = ((int64_t *) mem_171889)[i_171770];
                        int64_t max_res_171521 = smax64(x_171518, redout_171769);
                        int64_t redout_tmp_172672 = max_res_171521;
                        
                        redout_171769 = redout_tmp_172672;
                    }
                    defunc_0_reduce_res_171517 = redout_171769;
                    max_mult_160629 = defunc_0_reduce_res_171517;
                } else {
                    max_mult_160629 = (int64_t) 1;
                }
                
                int64_t bytes_171904 = (int64_t) 8 * defunc_res_171536;
                bool bounds_invalid_upwards_160640 = slt64(max_mult_160629, (int64_t) 1);
                bool valid_160642 = !bounds_invalid_upwards_160640;
                bool range_valid_c_160643;
                
                if (!valid_160642) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_160629, " is invalid.", "-> #0  ftHashJoin.fut:821:20-32\n   #1  ftHashJoin.fut:850:6-856:46\n   #2  ftRelational.fut:273:6-276:37\n   #3  ftRelational.fut:269:3-276:56\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t bytes_171942 = b_141121 * defunc_res_171536;
                
                if (mem_171881_cached_sizze_172699 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171881, &mem_171881_cached_sizze_172699, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171758 = 0; i_171758 < nR_141120; i_171758++) {
                    int64_t eta_p_167105 = ((int64_t *) mem_171841)[i_171758];
                    int64_t zv_lhs_167107 = add64((int64_t) -1, i_171758);
                    int64_t tmp_167108 = smod64(zv_lhs_167107, nR_141120);
                    int64_t lifted_lambda_res_167109 = ((int64_t *) mem_171835)[tmp_167108];
                    bool cond_167111 = i_171758 == (int64_t) 0;
                    int64_t lifted_lambda_res_167112;
                    
                    if (cond_167111) {
                        lifted_lambda_res_167112 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_167112 = lifted_lambda_res_167109;
                    }
                    
                    bool cond_167114 = slt64((int64_t) 0, eta_p_167105);
                    int64_t lifted_lambda_res_167115;
                    
                    if (cond_167114) {
                        lifted_lambda_res_167115 = lifted_lambda_res_167112;
                    } else {
                        lifted_lambda_res_167115 = (int64_t) -1;
                    }
                    ((int64_t *) mem_171881)[i_171758] = lifted_lambda_res_167115;
                }
                if (memblock_alloc(ctx, &mem_171905, bytes_171904, "mem_171905")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172674 = 0; nest_i_172674 < defunc_res_171536; nest_i_172674++) {
                    ((int64_t *) mem_171905.mem)[nest_i_172674] = (int64_t) 0;
                }
                for (int64_t write_iter_171771 = 0; write_iter_171771 < nR_141120; write_iter_171771++) {
                    int64_t write_iv_171773 = ((int64_t *) mem_171881)[write_iter_171771];
                    
                    if (sle64((int64_t) 0, write_iv_171773) && slt64(write_iv_171773, defunc_res_171536)) {
                        ((int64_t *) mem_171905.mem)[write_iv_171773] = write_iter_171771;
                    }
                }
                if (memblock_alloc(ctx, &mem_171913, bytes_171904, "mem_171913")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172676 = 0; nest_i_172676 < defunc_res_171536; nest_i_172676++) {
                    ((int64_t *) mem_171913.mem)[nest_i_172676] = (int64_t) 1;
                }
                
                int64_t distance_160641 = sub64(max_mult_160629, (int64_t) 1);
                
                if (memblock_set(ctx, &mem_param_171916, &mem_171913, "mem_171913") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171919, &mem_171905, "mem_171905") != 0)
                    return 1;
                for (int64_t i_160646 = 0; i_160646 < distance_160641; i_160646++) {
                    int64_t index_primexp_160649 = add64((int64_t) 1, i_160646);
                    
                    if (memblock_alloc(ctx, &mem_171921, bytes_171904, "mem_171921")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171921.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171919.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171536});
                    if (memblock_alloc(ctx, &mem_171923, bytes_171904, "mem_171923")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171923.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171916.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171536});
                    
                    int64_t replicate_arg1_160661 = add64((int64_t) 2, i_160646);
                    
                    for (int64_t write_iter_171776 = 0; write_iter_171776 < nR_141120; write_iter_171776++) {
                        int64_t zlze_lhs_168102 = ((int64_t *) mem_171841)[write_iter_171776];
                        bool cond_168103 = sle64(zlze_lhs_168102, index_primexp_160649);
                        int64_t lifted_lambda_res_168104;
                        
                        if (cond_168103) {
                            lifted_lambda_res_168104 = (int64_t) -1;
                        } else {
                            int64_t zp_lhs_168105 = ((int64_t *) mem_171881)[write_iter_171776];
                            int64_t lifted_lambda_res_f_res_168106 = add64(index_primexp_160649, zp_lhs_168105);
                            
                            lifted_lambda_res_168104 = lifted_lambda_res_f_res_168106;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_168104) && slt64(lifted_lambda_res_168104, defunc_res_171536)) {
                            ((int64_t *) mem_171923.mem)[lifted_lambda_res_168104] = replicate_arg1_160661;
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_168104) && slt64(lifted_lambda_res_168104, defunc_res_171536)) {
                            ((int64_t *) mem_171921.mem)[lifted_lambda_res_168104] = write_iter_171776;
                        }
                    }
                    if (memblock_set(ctx, &mem_param_tmp_172677, &mem_171923, "mem_171923") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_tmp_172678, &mem_171921, "mem_171921") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171916, &mem_param_tmp_172677, "mem_param_tmp_172677") != 0)
                        return 1;
                    if (memblock_set(ctx, &mem_param_171919, &mem_param_tmp_172678, "mem_param_tmp_172678") != 0)
                        return 1;
                }
                if (memblock_set(ctx, &ext_mem_171941, &mem_param_171916, "mem_param_171916") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171940, &mem_param_171919, "mem_param_171919") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171905, "mem_171905") != 0)
                    return 1;
                if (memblock_unref(ctx, &mem_171913, "mem_171913") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171943, bytes_171942, "mem_171943")) {
                    err = 1;
                    goto cleanup;
                }
                if (memblock_alloc(ctx, &mem_171945, bytes_171904, "mem_171945")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171786 = 0; i_171786 < defunc_res_171536; i_171786++) {
                    int64_t eta_p_168002 = ((int64_t *) ext_mem_171940.mem)[i_171786];
                    bool x_168004 = sle64((int64_t) 0, eta_p_168002);
                    bool y_168005 = slt64(eta_p_168002, nR_141120);
                    bool bounds_check_168006 = x_168004 && y_168005;
                    bool index_certs_168007;
                    
                    if (!bounds_check_168006) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_168002, "] out of bounds for array of shape [", (long long) nR_141120, "].", "-> #0  ftHashJoin.fut:831:18-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:830:10-838:8\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t eta_p_168001 = ((int64_t *) ext_mem_171941.mem)[i_171786];
                    int64_t rv_168008 = ((int64_t *) mem_171843)[eta_p_168002];
                    int64_t inf_s_idx_168009 = ((int64_t *) mem_171839)[eta_p_168002];
                    int64_t tmp_168010 = sub64(inf_s_idx_168009, (int64_t) 1);
                    bool loop_cond_168011 = slt64((int64_t) 0, eta_p_168001);
                    bool kth_match_168012;
                    int64_t kth_match_168013;
                    int64_t kth_match_168014;
                    bool loop_while_168015;
                    int64_t j_168016;
                    int64_t m_168017;
                    
                    loop_while_168015 = loop_cond_168011;
                    j_168016 = tmp_168010;
                    m_168017 = (int64_t) 0;
                    while (loop_while_168015) {
                        int64_t zeze_rhs_168018 = add64((int64_t) 1, j_168016);
                        bool x_168019 = sle64((int64_t) 0, zeze_rhs_168018);
                        bool y_168020 = slt64(zeze_rhs_168018, nS_141122);
                        bool bounds_check_168021 = x_168019 && y_168020;
                        bool index_certs_168022;
                        
                        if (!bounds_check_168021) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zeze_rhs_168018, "] out of bounds for array of shape [", (long long) nS_141122, "].", "-> #0  ftHashJoin.fut:835:31-42\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:830:10-838:8\n   #3  ftHashJoin.fut:850:6-856:46\n   #4  ftRelational.fut:273:6-276:37\n   #5  ftRelational.fut:269:3-276:56\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_168023 = ((int64_t *) mem_171825)[zeze_rhs_168018];
                        bool is_eq_168024 = rv_168008 == zeze_rhs_168023;
                        int64_t loopres_168025;
                        
                        if (is_eq_168024) {
                            int64_t tmp_171532 = add64((int64_t) 1, m_168017);
                            
                            loopres_168025 = tmp_171532;
                        } else {
                            loopres_168025 = m_168017;
                        }
                        
                        bool loop_cond_168027 = slt64(loopres_168025, eta_p_168001);
                        bool loop_while_tmp_172685 = loop_cond_168027;
                        int64_t j_tmp_172686 = zeze_rhs_168018;
                        int64_t m_tmp_172687 = loopres_168025;
                        
                        loop_while_168015 = loop_while_tmp_172685;
                        j_168016 = j_tmp_172686;
                        m_168017 = m_tmp_172687;
                    }
                    kth_match_168012 = loop_while_168015;
                    kth_match_168013 = j_168016;
                    kth_match_168014 = m_168017;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171943.mem, i_171786 * b_141121, (int64_t []) {(int64_t) 1}, (uint8_t *) pR_mem_171818.mem, eta_p_168002 * b_141121, (int64_t []) {(int64_t) 1}, (int64_t []) {b_141121});
                    ((int64_t *) mem_171945.mem)[i_171786] = kth_match_168013;
                }
                if (memblock_unref(ctx, &ext_mem_171941, "ext_mem_171941") != 0)
                    return 1;
                if (memblock_alloc(ctx, &mem_171961, bytes_171904, "mem_171961")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171961.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171940.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_171536});
                if (memblock_unref(ctx, &ext_mem_171940, "ext_mem_171940") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172107, &mem_171961, "mem_171961") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172106, &mem_171945, "mem_171945") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_172103, &mem_171943, "mem_171943") != 0)
                    return 1;
                radix_hash_join_res_f_res_f_res_159998 = defunc_res_171536;
            }
            if (memblock_set(ctx, &ext_mem_172253, &ext_mem_172107, "ext_mem_172107") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172252, &ext_mem_172106, "ext_mem_172106") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172249, &ext_mem_172103, "ext_mem_172103") != 0)
                return 1;
            radix_hash_join_res_f_res_159639 = radix_hash_join_res_f_res_f_res_159998;
            radix_hash_join_res_f_res_159640 = radix_hash_join_res_f_res_f_res_159998;
            radix_hash_join_res_f_res_159641 = radix_hash_join_res_f_res_f_res_159998;
        }
        if (memblock_set(ctx, &ext_mem_172397, &ext_mem_172253, "ext_mem_172253") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172396, &ext_mem_172252, "ext_mem_172252") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172393, &ext_mem_172249, "ext_mem_172249") != 0)
            return 1;
        radix_hash_join_res_159280 = radix_hash_join_res_f_res_159639;
        radix_hash_join_res_159281 = radix_hash_join_res_f_res_159640;
        radix_hash_join_res_159282 = radix_hash_join_res_f_res_159641;
    }
    
    bool dim_match_160703 = radix_hash_join_res_159280 == radix_hash_join_res_159281;
    bool empty_or_match_cert_160704;
    
    if (!dim_match_160703) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:846:3-856:54\n   #1  ftRelational.fut:273:6-276:37\n   #2  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_160706 = radix_hash_join_res_159280 == radix_hash_join_res_159282;
    bool empty_or_match_cert_160707;
    
    if (!dim_match_160706) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:846:3-856:54\n   #1  ftRelational.fut:273:6-276:37\n   #2  ftRelational.fut:269:3-276:56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_172397, "ext_mem_172397") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_172396, "ext_mem_172396") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &ext_mem_172393, "ext_mem_172393") != 0)
        return 1;
    prim_out_172503 = radix_hash_join_res_159280;
    if (memblock_set(ctx, &*mem_out_p_172688, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172689, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172690, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172691 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171825);
        free(mem_171833);
        free(mem_171835);
        free(mem_171837);
        free(mem_171839);
        free(mem_171841);
        free(mem_171843);
        free(mem_171881);
        free(mem_171889);
        free(mem_171891);
        free(mem_171963);
        free(mem_171971);
        free(mem_171973);
        free(mem_171975);
        free(mem_171977);
        free(mem_171979);
        free(mem_171981);
        free(mem_172019);
        free(mem_172027);
        free(mem_172029);
        free(mem_172109);
        free(mem_172117);
        free(mem_172119);
        free(mem_172121);
        free(mem_172123);
        free(mem_172125);
        free(mem_172127);
        free(mem_172165);
        free(mem_172173);
        free(mem_172175);
        free(mem_172254);
        free(mem_172262);
        free(mem_172264);
        free(mem_172266);
        free(mem_172268);
        free(mem_172270);
        free(mem_172271);
        free(mem_172309);
        free(mem_172317);
        free(mem_172319);
        if (memblock_unref(ctx, &mem_171961, "mem_171961") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171945, "mem_171945") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171943, "mem_171943") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172678, "mem_param_tmp_172678") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172677, "mem_param_tmp_172677") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171923, "mem_171923") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171921, "mem_171921") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171919, "mem_param_171919") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171916, "mem_param_171916") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171940, "ext_mem_171940") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171941, "ext_mem_171941") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171913, "mem_171913") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171905, "mem_171905") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172099, "mem_172099") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172083, "mem_172083") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172081, "mem_172081") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172632, "mem_param_tmp_172632") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172631, "mem_param_tmp_172631") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172061, "mem_172061") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172059, "mem_172059") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172057, "mem_param_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172054, "mem_param_172054") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172078, "ext_mem_172078") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172079, "ext_mem_172079") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172051, "mem_172051") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172043, "mem_172043") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172103, "ext_mem_172103") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172106, "ext_mem_172106") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172107, "ext_mem_172107") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172245, "mem_172245") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172229, "mem_172229") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172227, "mem_172227") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172586, "mem_param_tmp_172586") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172585, "mem_param_tmp_172585") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172207, "mem_172207") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172205, "mem_172205") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172203, "mem_param_172203") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172200, "mem_param_172200") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172224, "ext_mem_172224") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172225, "ext_mem_172225") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172197, "mem_172197") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172189, "mem_172189") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172249, "ext_mem_172249") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172252, "ext_mem_172252") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172253, "ext_mem_172253") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172389, "mem_172389") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172373, "mem_172373") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172371, "mem_172371") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172540, "mem_param_tmp_172540") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172539, "mem_param_tmp_172539") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172351, "mem_172351") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172349, "mem_172349") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172347, "mem_param_172347") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172344, "mem_param_172344") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172368, "ext_mem_172368") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172369, "ext_mem_172369") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172341, "mem_172341") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172333, "mem_172333") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172393, "ext_mem_172393") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172396, "ext_mem_172396") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172397, "ext_mem_172397") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct memblock *mem_out_p_172732, struct memblock *mem_out_p_172733, struct memblock *mem_out_p_172734, int64_t *out_prim_out_172735, struct memblock pR_mem_171818, struct memblock pS_mem_171819, struct memblock bounds_mem_171820, struct memblock depths_mem_171821, struct memblock first_info_idx_mem_171822, struct memblock last_info_idx_mem_171823, int64_t nR_143593, int64_t b_143594, int64_t nS_143595, int64_t dz2081U_143596, int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, int32_t radix_sizze_143598, int32_t maxDepth_143603)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171825_cached_sizze_172736 = 0;
    unsigned char *mem_171825 = NULL;
    int64_t mem_171833_cached_sizze_172737 = 0;
    unsigned char *mem_171833 = NULL;
    int64_t mem_171835_cached_sizze_172738 = 0;
    unsigned char *mem_171835 = NULL;
    int64_t mem_171879_cached_sizze_172739 = 0;
    unsigned char *mem_171879 = NULL;
    int64_t mem_171887_cached_sizze_172740 = 0;
    unsigned char *mem_171887 = NULL;
    int64_t mem_171889_cached_sizze_172741 = 0;
    unsigned char *mem_171889 = NULL;
    int64_t mem_171943_cached_sizze_172742 = 0;
    unsigned char *mem_171943 = NULL;
    int64_t mem_171951_cached_sizze_172743 = 0;
    unsigned char *mem_171951 = NULL;
    int64_t mem_171953_cached_sizze_172744 = 0;
    unsigned char *mem_171953 = NULL;
    int64_t mem_172006_cached_sizze_172745 = 0;
    unsigned char *mem_172006 = NULL;
    int64_t mem_172014_cached_sizze_172746 = 0;
    unsigned char *mem_172014 = NULL;
    int64_t mem_172016_cached_sizze_172747 = 0;
    unsigned char *mem_172016 = NULL;
    struct memblock ext_mem_171873;
    
    ext_mem_171873.references = NULL;
    
    struct memblock mem_171866;
    
    mem_171866.references = NULL;
    
    struct memblock mem_171864;
    
    mem_171864.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_171849;
    
    mem_171849.references = NULL;
    
    struct memblock ext_mem_171927;
    
    ext_mem_171927.references = NULL;
    
    struct memblock mem_171920;
    
    mem_171920.references = NULL;
    
    struct memblock mem_171918;
    
    mem_171918.references = NULL;
    
    struct memblock mem_171905;
    
    mem_171905.references = NULL;
    
    struct memblock mem_171903;
    
    mem_171903.references = NULL;
    
    struct memblock ext_mem_171935;
    
    ext_mem_171935.references = NULL;
    
    struct memblock ext_mem_171938;
    
    ext_mem_171938.references = NULL;
    
    struct memblock ext_mem_171941;
    
    ext_mem_171941.references = NULL;
    
    struct memblock ext_mem_171991;
    
    ext_mem_171991.references = NULL;
    
    struct memblock mem_171984;
    
    mem_171984.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171969;
    
    mem_171969.references = NULL;
    
    struct memblock mem_171967;
    
    mem_171967.references = NULL;
    
    struct memblock ext_mem_171999;
    
    ext_mem_171999.references = NULL;
    
    struct memblock ext_mem_172002;
    
    ext_mem_172002.references = NULL;
    
    struct memblock ext_mem_172005;
    
    ext_mem_172005.references = NULL;
    
    struct memblock ext_mem_172054;
    
    ext_mem_172054.references = NULL;
    
    struct memblock mem_172047;
    
    mem_172047.references = NULL;
    
    struct memblock mem_172045;
    
    mem_172045.references = NULL;
    
    struct memblock mem_172032;
    
    mem_172032.references = NULL;
    
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock ext_mem_172062;
    
    ext_mem_172062.references = NULL;
    
    struct memblock ext_mem_172065;
    
    ext_mem_172065.references = NULL;
    
    struct memblock ext_mem_172068;
    
    ext_mem_172068.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t i32_res_159240 = sext_i32_i64(radix_sizze_143598);
    bool nonnegative_159241 = sle64((int64_t) 0, i32_res_159240);
    bool nonzzero_cert_159242;
    
    if (!nonnegative_159241) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:7:47-283:55\n   #1  ftRelational.fut:278:3-285:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t arg_159243 = shl64((int64_t) 1, i32_res_159240);
    bool assert_cond_159244 = arg_159243 == dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597;
    bool assert_c_159245;
    
    if (!assert_cond_159244) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: entry point arguments have invalid sizes.", "-> #0  ftRelational.fut:283:6-285:39\n   #1  ftRelational.fut:278:3-285:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_159246 = b_143594 == (int64_t) 1;
    bool cond_159247 = b_143594 == (int64_t) 2;
    bool cond_159248 = sle64(b_143594, (int64_t) 4);
    int64_t unsign_arg0_159249 = zext_i32_i64(radix_sizze_143598);
    int64_t asPow_159250 = shl64((int64_t) 1, unsign_arg0_159249);
    int64_t u64_arg0_159251 = sub64(asPow_159250, (int64_t) 1);
    int64_t zeze_rhs_159252 = sub64(dz2081U_143596, (int64_t) 1);
    int32_t u64_res_159253 = zext_i64_i32(asPow_159250);
    int32_t za_rhs_159254 = sub32(u64_res_159253, 1);
    int16_t u64_res_159255 = zext_i64_i16(u64_arg0_159251);
    int8_t u64_res_159256 = zext_i64_i8(u64_arg0_159251);
    int64_t bytes_171824 = (int64_t) 8 * nS_143595;
    int64_t bytes_171832 = (int64_t) 8 * nR_143593;
    int64_t bytes_171878 = (int64_t) 4 * nS_143595;
    int64_t bytes_171942 = (int64_t) 2 * nS_143595;
    int64_t radix_hash_join_with_S_keys_unique_res_159257;
    int64_t radix_hash_join_with_S_keys_unique_res_159258;
    int64_t radix_hash_join_with_S_keys_unique_res_159259;
    
    if (cond_159246) {
        if (mem_172006_cached_sizze_172745 < nS_143595) {
            err = lexical_realloc(ctx, &mem_172006, &mem_172006_cached_sizze_172745, nS_143595);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < nS_143595; i_171547++) {
            int8_t defunc_0_byteSeq_to_prim_res_167626;
            int8_t y_167628 = (int8_t) 0;
            
            for (int64_t i_167627 = 0; i_167627 < b_143594; i_167627++) {
                int64_t zm_lhs_167629 = sub64(b_143594, i_167627);
                int64_t from_u8_arg0_167630 = sub64(zm_lhs_167629, (int64_t) 1);
                bool x_167631 = sle64((int64_t) 0, from_u8_arg0_167630);
                bool y_167632 = slt64(from_u8_arg0_167630, b_143594);
                bool bounds_check_167633 = x_167631 && y_167632;
                bool index_certs_167634;
                
                if (!bounds_check_167633) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167630, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:423:72-78\n   #2  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_167635 = ((int8_t *) pS_mem_171819.mem)[i_171547 * b_143594 + from_u8_arg0_167630];
                int32_t i64_res_167636 = sext_i64_i32(i_167627);
                int32_t shift_left_rhs_167637 = mul32(8, i64_res_167636);
                int8_t unsign_arg0_167638 = zext_i32_i8(shift_left_rhs_167637);
                int8_t lifted_lambda_res_167639 = shl8(from_u8_arg0_167635, unsign_arg0_167638);
                int8_t unsign_arg0_167640 = y_167628 | lifted_lambda_res_167639;
                int8_t y_tmp_172505 = unsign_arg0_167640;
                
                y_167628 = y_tmp_172505;
            }
            defunc_0_byteSeq_to_prim_res_167626 = y_167628;
            ((int8_t *) mem_172006)[i_171547] = defunc_0_byteSeq_to_prim_res_167626;
        }
        if (mem_172014_cached_sizze_172746 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172014, &mem_172014_cached_sizze_172746, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_172016_cached_sizze_172747 < bytes_171832) {
            err = lexical_realloc(ctx, &mem_172016, &mem_172016_cached_sizze_172747, bytes_171832);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171558;
        int64_t defunc_res_167644;
        int64_t scanacc_171551;
        int64_t redout_171553;
        
        scanacc_171551 = (int64_t) 0;
        redout_171553 = (int64_t) 0;
        for (int64_t i_171555 = 0; i_171555 < nR_143593; i_171555++) {
            int8_t defunc_0_byteSeq_to_prim_res_167647;
            int8_t y_167649 = (int8_t) 0;
            
            for (int64_t i_167648 = 0; i_167648 < b_143594; i_167648++) {
                int64_t zm_lhs_167650 = sub64(b_143594, i_167648);
                int64_t from_u8_arg0_167651 = sub64(zm_lhs_167650, (int64_t) 1);
                bool x_167652 = sle64((int64_t) 0, from_u8_arg0_167651);
                bool y_167653 = slt64(from_u8_arg0_167651, b_143594);
                bool bounds_check_167654 = x_167652 && y_167653;
                bool index_certs_167655;
                
                if (!bounds_check_167654) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167651, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:423:72-78\n   #2  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t from_u8_arg0_167656 = ((int8_t *) pR_mem_171818.mem)[i_171555 * b_143594 + from_u8_arg0_167651];
                int32_t i64_res_167657 = sext_i64_i32(i_167648);
                int32_t shift_left_rhs_167658 = mul32(8, i64_res_167657);
                int8_t unsign_arg0_167659 = zext_i32_i8(shift_left_rhs_167658);
                int8_t lifted_lambda_res_167660 = shl8(from_u8_arg0_167656, unsign_arg0_167659);
                int8_t unsign_arg0_167661 = y_167649 | lifted_lambda_res_167660;
                int8_t y_tmp_172510 = unsign_arg0_167661;
                
                y_167649 = y_tmp_172510;
            }
            defunc_0_byteSeq_to_prim_res_167647 = y_167649;
            
            int8_t lifted_lambda_res_167662 = u64_res_159256 & defunc_0_byteSeq_to_prim_res_167647;
            int64_t u8_res_167663 = zext_i8_i64(lifted_lambda_res_167662);
            bool x_167664 = sle64((int64_t) 0, u8_res_167663);
            bool y_167665 = slt64(u8_res_167663, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597);
            bool bounds_check_167666 = x_167664 && y_167665;
            bool index_certs_167667;
            
            if (!bounds_check_167666) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_res_167663, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t spi_167668 = ((int64_t *) first_info_idx_mem_171822.mem)[u8_res_167663];
            bool cond_167669 = slt64(spi_167668, (int64_t) 0);
            int64_t defunc_res_167670;
            
            if (cond_167669) {
                defunc_res_167670 = (int64_t) -1;
            } else {
                int64_t zeze_rhs_167671 = ((int64_t *) last_info_idx_mem_171823.mem)[u8_res_167663];
                bool cond_167672 = spi_167668 == zeze_rhs_167671;
                int64_t defunc_res_f_res_167673;
                
                if (cond_167672) {
                    defunc_res_f_res_167673 = spi_167668;
                } else {
                    int64_t zs_lhs_167674 = sub64(zeze_rhs_167671, spi_167668);
                    int64_t max_arg1_167675 = sdiv64(zs_lhs_167674, (int64_t) 2);
                    int64_t max_res_167676 = smax64((int64_t) 1, max_arg1_167675);
                    bool loop_cond_167677 = slt64((int64_t) 0, max_res_167676);
                    bool bsearch_167678;
                    int64_t bsearch_167679;
                    int64_t bsearch_167680;
                    bool loop_while_167681;
                    int64_t heshi_167682;
                    int64_t step_167683;
                    
                    loop_while_167681 = loop_cond_167677;
                    heshi_167682 = spi_167668;
                    step_167683 = max_res_167676;
                    while (loop_while_167681) {
                        bool x_167684 = sle64((int64_t) 0, heshi_167682);
                        bool y_167685 = slt64(heshi_167682, dz2081U_143596);
                        bool bounds_check_167686 = x_167684 && y_167685;
                        bool index_certs_167687;
                        
                        if (!bounds_check_167686) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_167682, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t cur_S_167705 = ((int64_t *) bounds_mem_171820.mem)[heshi_167682];
                        bool x_167706 = sle64((int64_t) 0, cur_S_167705);
                        bool y_167707 = slt64(cur_S_167705, nS_143595);
                        bool bounds_check_167708 = x_167706 && y_167707;
                        bool index_certs_167709;
                        
                        if (!bounds_check_167708) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_167705, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t cur_depth_167688 = ((int32_t *) depths_mem_171821.mem)[heshi_167682];
                        bool cond_167689 = heshi_167682 == spi_167668;
                        int32_t prev_depth_167690;
                        
                        if (cond_167689) {
                            prev_depth_167690 = cur_depth_167688;
                        } else {
                            int64_t tmp_167691 = sub64(heshi_167682, (int64_t) 1);
                            bool x_167692 = sle64((int64_t) 0, tmp_167691);
                            bool y_167693 = slt64(tmp_167691, dz2081U_143596);
                            bool bounds_check_167694 = x_167692 && y_167693;
                            bool index_certs_167695;
                            
                            if (!bounds_check_167694) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167691, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t prev_depth_f_res_167696 = ((int32_t *) depths_mem_171821.mem)[tmp_167691];
                            
                            prev_depth_167690 = prev_depth_f_res_167696;
                        }
                        
                        bool cond_167697 = heshi_167682 == zeze_rhs_167671;
                        int32_t next_depth_167698;
                        
                        if (cond_167697) {
                            next_depth_167698 = cur_depth_167688;
                        } else {
                            int64_t tmp_167699 = add64((int64_t) 1, heshi_167682);
                            bool x_167700 = sle64((int64_t) 0, tmp_167699);
                            bool y_167701 = slt64(tmp_167699, dz2081U_143596);
                            bool bounds_check_167702 = x_167700 && y_167701;
                            bool index_certs_167703;
                            
                            if (!bounds_check_167702) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167699, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t next_depth_f_res_167704 = ((int32_t *) depths_mem_171821.mem)[tmp_167699];
                            
                            next_depth_167698 = next_depth_f_res_167704;
                        }
                        
                        int8_t cur_S_167710 = ((int8_t *) mem_172006)[cur_S_167705];
                        int8_t prev_S_167711;
                        
                        if (cond_167689) {
                            prev_S_167711 = cur_S_167710;
                        } else {
                            int64_t tmp_167712 = sub64(heshi_167682, (int64_t) 1);
                            bool x_167713 = sle64((int64_t) 0, tmp_167712);
                            bool y_167714 = slt64(tmp_167712, dz2081U_143596);
                            bool bounds_check_167715 = x_167713 && y_167714;
                            bool index_certs_167716;
                            
                            if (!bounds_check_167715) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167712, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_167717 = ((int64_t *) bounds_mem_171820.mem)[tmp_167712];
                            bool x_167718 = sle64((int64_t) 0, tmp_167717);
                            bool y_167719 = slt64(tmp_167717, nS_143595);
                            bool bounds_check_167720 = x_167718 && y_167719;
                            bool index_certs_167721;
                            
                            if (!bounds_check_167720) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167717, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t prev_S_f_res_167722 = ((int8_t *) mem_172006)[tmp_167717];
                            
                            prev_S_167711 = prev_S_f_res_167722;
                        }
                        
                        int8_t next_S_167723;
                        
                        if (cond_167697) {
                            next_S_167723 = cur_S_167710;
                        } else {
                            int64_t tmp_167724 = add64((int64_t) 1, heshi_167682);
                            bool x_167725 = sle64((int64_t) 0, tmp_167724);
                            bool y_167726 = slt64(tmp_167724, dz2081U_143596);
                            bool bounds_check_167727 = x_167725 && y_167726;
                            bool index_certs_167728;
                            
                            if (!bounds_check_167727) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167724, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_167729 = ((int64_t *) bounds_mem_171820.mem)[tmp_167724];
                            bool x_167730 = sle64((int64_t) 0, tmp_167729);
                            bool y_167731 = slt64(tmp_167729, nS_143595);
                            bool bounds_check_167732 = x_167730 && y_167731;
                            bool index_certs_167733;
                            
                            if (!bounds_check_167732) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167729, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:863:6-870:88\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-986:72\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int8_t next_S_f_res_167734 = ((int8_t *) mem_172006)[tmp_167729];
                            
                            next_S_167723 = next_S_f_res_167734;
                        }
                        
                        int32_t prim_get_radix_arg0_167735 = mul32(radix_sizze_143598, cur_depth_167688);
                        int64_t unsign_arg0_167736 = zext_i32_i64(prim_get_radix_arg0_167735);
                        int64_t asPow_167737 = shl64((int64_t) 1, unsign_arg0_167736);
                        int64_t u64_arg0_167738 = sub64(asPow_167737, (int64_t) 1);
                        int8_t u64_res_167739 = zext_i64_i8(u64_arg0_167738);
                        int8_t lifted_lambda_res_167740 = defunc_0_byteSeq_to_prim_res_167647 & u64_res_167739;
                        int8_t lifted_lambda_res_167741 = cur_S_167710 & u64_res_167739;
                        bool defunc_0_eq_res_167742 = lifted_lambda_res_167740 == lifted_lambda_res_167741;
                        int64_t loopres_167743;
                        int64_t loopres_167744;
                        
                        if (defunc_0_eq_res_167742) {
                            loopres_167743 = heshi_167682;
                            loopres_167744 = (int64_t) 0;
                        } else {
                            bool loop_cond_t_res_167745 = slt32(0, cur_depth_167688);
                            bool is_lt_167746;
                            bool is_lt_167747;
                            int32_t is_lt_167748;
                            bool loop_while_167749;
                            bool def_lt_167750;
                            int32_t bi_167751;
                            
                            loop_while_167749 = loop_cond_t_res_167745;
                            def_lt_167750 = 0;
                            bi_167751 = 0;
                            while (loop_while_167749) {
                                int32_t zt_rhs_167752 = add32(1, bi_167751);
                                int32_t prim_get_radix_arg0_167753 = mul32(radix_sizze_143598, zt_rhs_167752);
                                int64_t unsign_arg0_167754 = zext_i32_i64(prim_get_radix_arg0_167753);
                                int64_t asPow_167755 = shl64((int64_t) 1, unsign_arg0_167754);
                                int64_t u64_arg0_167756 = sub64(asPow_167755, (int64_t) 1);
                                int8_t u64_res_167757 = zext_i64_i8(u64_arg0_167756);
                                int8_t lifted_lambda_res_167758 = defunc_0_byteSeq_to_prim_res_167647 & u64_res_167757;
                                int8_t lifted_lambda_res_167759 = cur_S_167710 & u64_res_167757;
                                bool defunc_0_lt_res_167760 = ult8(lifted_lambda_res_167758, lifted_lambda_res_167759);
                                bool defunc_0_lt_res_167761 = ult8(lifted_lambda_res_167759, lifted_lambda_res_167758);
                                bool cond_167762 = !defunc_0_lt_res_167761;
                                bool cond_t_res_167763 = !defunc_0_lt_res_167760;
                                bool x_167764 = cond_167762 && cond_t_res_167763;
                                bool loop_cond_t_res_167765 = slt32(zt_rhs_167752, cur_depth_167688);
                                bool x_167766 = x_167764 && loop_cond_t_res_167765;
                                bool loop_while_tmp_172514 = x_167766;
                                bool def_lt_tmp_172515 = defunc_0_lt_res_167760;
                                int32_t bi_tmp_172516 = zt_rhs_167752;
                                
                                loop_while_167749 = loop_while_tmp_172514;
                                def_lt_167750 = def_lt_tmp_172515;
                                bi_167751 = bi_tmp_172516;
                            }
                            is_lt_167746 = loop_while_167749;
                            is_lt_167747 = def_lt_167750;
                            is_lt_167748 = bi_167751;
                            
                            int64_t loopres_f_res_167767;
                            int64_t loopres_f_res_167768;
                            
                            if (is_lt_167747) {
                                bool loop_cond_t_res_167769 = slt32(0, prev_depth_167690);
                                bool is_gt_167770;
                                bool is_gt_167771;
                                int32_t is_gt_167772;
                                bool loop_while_167773;
                                bool def_gt_167774;
                                int32_t bi_167775;
                                
                                loop_while_167773 = loop_cond_t_res_167769;
                                def_gt_167774 = 0;
                                bi_167775 = 0;
                                while (loop_while_167773) {
                                    int32_t zt_rhs_167776 = add32(1, bi_167775);
                                    int32_t prim_get_radix_arg0_167777 = mul32(radix_sizze_143598, zt_rhs_167776);
                                    int64_t unsign_arg0_167778 = zext_i32_i64(prim_get_radix_arg0_167777);
                                    int64_t asPow_167779 = shl64((int64_t) 1, unsign_arg0_167778);
                                    int64_t u64_arg0_167780 = sub64(asPow_167779, (int64_t) 1);
                                    int8_t u64_res_167781 = zext_i64_i8(u64_arg0_167780);
                                    int8_t lifted_lambda_res_167782 = defunc_0_byteSeq_to_prim_res_167647 & u64_res_167781;
                                    int8_t lifted_lambda_res_167783 = prev_S_167711 & u64_res_167781;
                                    bool defunc_0_gt_res_167784 = ult8(lifted_lambda_res_167783, lifted_lambda_res_167782);
                                    bool defunc_0_gt_res_167785 = ult8(lifted_lambda_res_167782, lifted_lambda_res_167783);
                                    bool cond_167786 = !defunc_0_gt_res_167784;
                                    bool cond_t_res_167787 = !defunc_0_gt_res_167785;
                                    bool x_167788 = cond_167786 && cond_t_res_167787;
                                    bool loop_cond_t_res_167789 = slt32(zt_rhs_167776, prev_depth_167690);
                                    bool x_167790 = x_167788 && loop_cond_t_res_167789;
                                    bool loop_while_tmp_172517 = x_167790;
                                    bool def_gt_tmp_172518 = defunc_0_gt_res_167784;
                                    int32_t bi_tmp_172519 = zt_rhs_167776;
                                    
                                    loop_while_167773 = loop_while_tmp_172517;
                                    def_gt_167774 = def_gt_tmp_172518;
                                    bi_167775 = bi_tmp_172519;
                                }
                                is_gt_167770 = loop_while_167773;
                                is_gt_167771 = def_gt_167774;
                                is_gt_167772 = bi_167775;
                                
                                bool x_167791 = !cond_167689;
                                bool y_167792 = is_gt_167771 && x_167791;
                                bool cond_167793 = cond_167689 || y_167792;
                                int64_t loopres_f_res_t_res_167794;
                                int64_t loopres_f_res_t_res_167795;
                                
                                if (cond_167793) {
                                    loopres_f_res_t_res_167794 = (int64_t) -1;
                                    loopres_f_res_t_res_167795 = (int64_t) 0;
                                } else {
                                    int64_t tmp_167796 = sub64(heshi_167682, step_167683);
                                    int64_t max_arg1_167797 = sdiv64(step_167683, (int64_t) 2);
                                    int64_t max_res_167798 = smax64((int64_t) 1, max_arg1_167797);
                                    
                                    loopres_f_res_t_res_167794 = tmp_167796;
                                    loopres_f_res_t_res_167795 = max_res_167798;
                                }
                                loopres_f_res_167767 = loopres_f_res_t_res_167794;
                                loopres_f_res_167768 = loopres_f_res_t_res_167795;
                            } else {
                                bool loop_cond_t_res_167799 = slt32(0, next_depth_167698);
                                bool is_lt_167800;
                                bool is_lt_167801;
                                int32_t is_lt_167802;
                                bool loop_while_167803;
                                bool def_lt_167804;
                                int32_t bi_167805;
                                
                                loop_while_167803 = loop_cond_t_res_167799;
                                def_lt_167804 = 0;
                                bi_167805 = 0;
                                while (loop_while_167803) {
                                    int32_t zt_rhs_167806 = add32(1, bi_167805);
                                    int32_t prim_get_radix_arg0_167807 = mul32(radix_sizze_143598, zt_rhs_167806);
                                    int64_t unsign_arg0_167808 = zext_i32_i64(prim_get_radix_arg0_167807);
                                    int64_t asPow_167809 = shl64((int64_t) 1, unsign_arg0_167808);
                                    int64_t u64_arg0_167810 = sub64(asPow_167809, (int64_t) 1);
                                    int8_t u64_res_167811 = zext_i64_i8(u64_arg0_167810);
                                    int8_t lifted_lambda_res_167812 = defunc_0_byteSeq_to_prim_res_167647 & u64_res_167811;
                                    int8_t lifted_lambda_res_167813 = next_S_167723 & u64_res_167811;
                                    bool defunc_0_lt_res_167814 = ult8(lifted_lambda_res_167812, lifted_lambda_res_167813);
                                    bool defunc_0_lt_res_167815 = ult8(lifted_lambda_res_167813, lifted_lambda_res_167812);
                                    bool cond_167816 = !defunc_0_lt_res_167815;
                                    bool cond_t_res_167817 = !defunc_0_lt_res_167814;
                                    bool x_167818 = cond_167816 && cond_t_res_167817;
                                    bool loop_cond_t_res_167819 = slt32(zt_rhs_167806, next_depth_167698);
                                    bool x_167820 = x_167818 && loop_cond_t_res_167819;
                                    bool loop_while_tmp_172520 = x_167820;
                                    bool def_lt_tmp_172521 = defunc_0_lt_res_167814;
                                    int32_t bi_tmp_172522 = zt_rhs_167806;
                                    
                                    loop_while_167803 = loop_while_tmp_172520;
                                    def_lt_167804 = def_lt_tmp_172521;
                                    bi_167805 = bi_tmp_172522;
                                }
                                is_lt_167800 = loop_while_167803;
                                is_lt_167801 = def_lt_167804;
                                is_lt_167802 = bi_167805;
                                
                                bool x_167821 = !cond_167697;
                                bool y_167822 = is_lt_167801 && x_167821;
                                bool cond_167823 = cond_167697 || y_167822;
                                int64_t loopres_f_res_f_res_167824;
                                int64_t loopres_f_res_f_res_167825;
                                
                                if (cond_167823) {
                                    loopres_f_res_f_res_167824 = (int64_t) -1;
                                    loopres_f_res_f_res_167825 = (int64_t) 0;
                                } else {
                                    int64_t tmp_167826 = add64(heshi_167682, step_167683);
                                    int64_t max_arg1_167827 = sdiv64(step_167683, (int64_t) 2);
                                    int64_t max_res_167828 = smax64((int64_t) 1, max_arg1_167827);
                                    
                                    loopres_f_res_f_res_167824 = tmp_167826;
                                    loopres_f_res_f_res_167825 = max_res_167828;
                                }
                                loopres_f_res_167767 = loopres_f_res_f_res_167824;
                                loopres_f_res_167768 = loopres_f_res_f_res_167825;
                            }
                            loopres_167743 = loopres_f_res_167767;
                            loopres_167744 = loopres_f_res_167768;
                        }
                        
                        bool loop_cond_167829 = slt64((int64_t) 0, loopres_167744);
                        bool loop_while_tmp_172511 = loop_cond_167829;
                        int64_t heshi_tmp_172512 = loopres_167743;
                        int64_t step_tmp_172513 = loopres_167744;
                        
                        loop_while_167681 = loop_while_tmp_172511;
                        heshi_167682 = heshi_tmp_172512;
                        step_167683 = step_tmp_172513;
                    }
                    bsearch_167678 = loop_while_167681;
                    bsearch_167679 = heshi_167682;
                    bsearch_167680 = step_167683;
                    defunc_res_f_res_167673 = bsearch_167679;
                }
                defunc_res_167670 = defunc_res_f_res_167673;
            }
            
            bool cond_167830 = sle64(defunc_res_167670, (int64_t) 0);
            int64_t inf_167831;
            
            if (cond_167830) {
                inf_167831 = (int64_t) 0;
            } else {
                bool x_167832 = sle64((int64_t) 0, defunc_res_167670);
                bool y_167833 = slt64(defunc_res_167670, dz2081U_143596);
                bool bounds_check_167834 = x_167832 && y_167833;
                bool index_certs_167835;
                
                if (!bounds_check_167834) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167670, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:871:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-986:72\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t inf_f_res_167836 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_167670];
                
                inf_167831 = inf_f_res_167836;
            }
            
            bool cond_167837 = defunc_res_167670 == zeze_rhs_159252;
            int64_t sup_167838;
            
            if (cond_167837) {
                sup_167838 = nS_143595;
            } else {
                int64_t tmp_167839 = add64((int64_t) 1, defunc_res_167670);
                bool x_167840 = sle64((int64_t) 0, tmp_167839);
                bool y_167841 = slt64(tmp_167839, dz2081U_143596);
                bool bounds_check_167842 = x_167840 && y_167841;
                bool index_certs_167843;
                
                if (!bounds_check_167842) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_167839, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:872:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-986:72\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t sup_f_res_167844 = ((int64_t *) bounds_mem_171820.mem)[tmp_167839];
                
                sup_167838 = sup_f_res_167844;
            }
            
            bool cond_167845 = slt64(inf_167831, sup_167838);
            bool sm_167846;
            int64_t sm_167847;
            bool loop_while_167848;
            int64_t j_167849;
            
            loop_while_167848 = cond_167845;
            j_167849 = inf_167831;
            while (loop_while_167848) {
                bool x_167850 = sle64((int64_t) 0, j_167849);
                bool y_167851 = slt64(j_167849, nS_143595);
                bool bounds_check_167852 = x_167850 && y_167851;
                bool index_certs_167853;
                
                if (!bounds_check_167852) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_167849, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:875:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-986:72\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int8_t zeze_rhs_167854 = ((int8_t *) mem_172006)[j_167849];
                bool is_eq_167855 = defunc_0_byteSeq_to_prim_res_167647 == zeze_rhs_167854;
                int64_t loopres_167856;
                
                if (is_eq_167855) {
                    loopres_167856 = j_167849;
                } else {
                    int64_t tmp_167857 = add64((int64_t) 1, j_167849);
                    
                    loopres_167856 = tmp_167857;
                }
                
                bool cond_167858 = slt64(loopres_167856, sup_167838);
                bool loop_cond_t_res_167859 = !is_eq_167855;
                bool x_167860 = cond_167858 && loop_cond_t_res_167859;
                bool loop_while_tmp_172523 = x_167860;
                int64_t j_tmp_172524 = loopres_167856;
                
                loop_while_167848 = loop_while_tmp_172523;
                j_167849 = j_tmp_172524;
            }
            sm_167846 = loop_while_167848;
            sm_167847 = j_167849;
            
            bool cond_167861 = slt64(sm_167847, sup_167838);
            int64_t lifted_lambda_res_167862;
            
            if (cond_167861) {
                lifted_lambda_res_167862 = sm_167847;
            } else {
                lifted_lambda_res_167862 = (int64_t) -1;
            }
            
            bool lifted_lambda_res_167863 = sle64((int64_t) 0, lifted_lambda_res_167862);
            int64_t bool_res_167864 = btoi_bool_i64(lifted_lambda_res_167863);
            int64_t defunc_0_op_res_167869 = add64(bool_res_167864, scanacc_171551);
            int64_t zp_res_167872 = add64(bool_res_167864, redout_171553);
            
            ((int64_t *) mem_172014)[i_171555] = defunc_0_op_res_167869;
            ((int64_t *) mem_172016)[i_171555] = lifted_lambda_res_167862;
            
            int64_t scanacc_tmp_172506 = defunc_0_op_res_167869;
            int64_t redout_tmp_172508 = zp_res_167872;
            
            scanacc_171551 = scanacc_tmp_172506;
            redout_171553 = redout_tmp_172508;
        }
        discard_171558 = scanacc_171551;
        defunc_res_167644 = redout_171553;
        
        int64_t bytes_172029 = (int64_t) 8 * defunc_res_167644;
        int64_t bytes_172046 = b_143594 * defunc_res_167644;
        
        if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172525 = 0; nest_i_172525 < defunc_res_167644; nest_i_172525++) {
            ((int64_t *) mem_172030.mem)[nest_i_172525] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_172032, bytes_172029, "mem_172032")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172526 = 0; nest_i_172526 < defunc_res_167644; nest_i_172526++) {
            ((int64_t *) mem_172032.mem)[nest_i_172526] = (int64_t) -1;
        }
        for (int64_t write_iter_171559 = 0; write_iter_171559 < nR_143593; write_iter_171559++) {
            int64_t write_iv_171563 = ((int64_t *) mem_172016)[write_iter_171559];
            int64_t zv_lhs_167886 = add64((int64_t) -1, write_iter_171559);
            int64_t tmp_167887 = smod64(zv_lhs_167886, nR_143593);
            int64_t lifted_lambda_res_167888 = ((int64_t *) mem_172014)[tmp_167887];
            bool cond_167889 = write_iter_171559 == (int64_t) 0;
            int64_t lifted_lambda_res_167890;
            
            if (cond_167889) {
                lifted_lambda_res_167890 = (int64_t) 0;
            } else {
                lifted_lambda_res_167890 = lifted_lambda_res_167888;
            }
            
            bool cond_167891 = sle64((int64_t) 0, write_iv_171563);
            int64_t lifted_lambda_res_167892;
            
            if (cond_167891) {
                lifted_lambda_res_167892 = lifted_lambda_res_167890;
            } else {
                lifted_lambda_res_167892 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_167892) && slt64(lifted_lambda_res_167892, defunc_res_167644)) {
                ((int64_t *) mem_172030.mem)[lifted_lambda_res_167892] = write_iv_171563;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_167892) && slt64(lifted_lambda_res_167892, defunc_res_167644)) {
                ((int64_t *) mem_172032.mem)[lifted_lambda_res_167892] = write_iter_171559;
            }
        }
        if (memblock_alloc(ctx, &mem_172045, b_143594, "mem_172045")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172529 = 0; nest_i_172529 < b_143594; nest_i_172529++) {
            ((int8_t *) mem_172045.mem)[nest_i_172529] = (int8_t) 0;
        }
        if (memblock_alloc(ctx, &mem_172047, bytes_172046, "mem_172047")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171568 = 0; i_171568 < defunc_res_167644; i_171568++) {
            int64_t eta_p_167899 = ((int64_t *) mem_172032.mem)[i_171568];
            bool cond_167900 = sle64((int64_t) 0, eta_p_167899);
            bool cond_t_res_167901 = slt64(eta_p_167899, nR_143593);
            bool x_167902 = cond_167900 && cond_t_res_167901;
            int64_t lmad_ext_172052 = b_143594 * eta_p_167899;
            int64_t ext_172053;
            
            if (x_167902) {
                ext_172053 = lmad_ext_172052;
            } else {
                ext_172053 = (int64_t) 0;
            }
            if (x_167902) {
                bool index_certs_167904;
                
                if (!x_167902) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_167899, "] out of bounds for array of shape [", (long long) nR_143593, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_172054, &pR_mem_171818, "pR_mem_171818") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_172054, &mem_172045, "mem_172045") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_172047.mem, i_171568 * b_143594, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_172054.mem, ext_172053, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143594});
            if (memblock_unref(ctx, &ext_mem_172054, "ext_mem_172054") != 0)
                return 1;
        }
        if (memblock_unref(ctx, &mem_172045, "mem_172045") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172068, &mem_172032, "mem_172032") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172065, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172062, &mem_172047, "mem_172047") != 0)
            return 1;
        radix_hash_join_with_S_keys_unique_res_159257 = defunc_res_167644;
        radix_hash_join_with_S_keys_unique_res_159258 = defunc_res_167644;
        radix_hash_join_with_S_keys_unique_res_159259 = defunc_res_167644;
    } else {
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_159516;
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_159517;
        int64_t radix_hash_join_with_S_keys_unique_res_f_res_159518;
        
        if (cond_159247) {
            if (mem_171943_cached_sizze_172742 < bytes_171942) {
                err = lexical_realloc(ctx, &mem_171943, &mem_171943_cached_sizze_172742, bytes_171942);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            for (int64_t i_171572 = 0; i_171572 < nS_143595; i_171572++) {
                int16_t defunc_0_byteSeq_to_prim_res_167949;
                int16_t y_167951 = (int16_t) 0;
                
                for (int64_t i_167950 = 0; i_167950 < b_143594; i_167950++) {
                    int64_t zm_lhs_167952 = sub64(b_143594, i_167950);
                    int64_t from_u8_arg0_167953 = sub64(zm_lhs_167952, (int64_t) 1);
                    bool x_167954 = sle64((int64_t) 0, from_u8_arg0_167953);
                    bool y_167955 = slt64(from_u8_arg0_167953, b_143594);
                    bool bounds_check_167956 = x_167954 && y_167955;
                    bool index_certs_167957;
                    
                    if (!bounds_check_167956) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167953, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:425:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_167958 = ((int8_t *) pS_mem_171819.mem)[i_171572 * b_143594 + from_u8_arg0_167953];
                    int16_t u8_res_167959 = zext_i8_i16(from_u8_arg0_167958);
                    int32_t i64_res_167960 = sext_i64_i32(i_167950);
                    int32_t shift_left_rhs_167961 = mul32(8, i64_res_167960);
                    int16_t unsign_arg0_167962 = zext_i32_i16(shift_left_rhs_167961);
                    int16_t lifted_lambda_res_167963 = shl16(u8_res_167959, unsign_arg0_167962);
                    int16_t unsign_arg0_167964 = y_167951 | lifted_lambda_res_167963;
                    int16_t y_tmp_172532 = unsign_arg0_167964;
                    
                    y_167951 = y_tmp_172532;
                }
                defunc_0_byteSeq_to_prim_res_167949 = y_167951;
                ((int16_t *) mem_171943)[i_171572] = defunc_0_byteSeq_to_prim_res_167949;
            }
            if (mem_171951_cached_sizze_172743 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_171951, &mem_171951_cached_sizze_172743, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171953_cached_sizze_172744 < bytes_171832) {
                err = lexical_realloc(ctx, &mem_171953, &mem_171953_cached_sizze_172744, bytes_171832);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171583;
            int64_t defunc_res_167969;
            int64_t scanacc_171576;
            int64_t redout_171578;
            
            scanacc_171576 = (int64_t) 0;
            redout_171578 = (int64_t) 0;
            for (int64_t i_171580 = 0; i_171580 < nR_143593; i_171580++) {
                int16_t defunc_0_byteSeq_to_prim_res_167972;
                int16_t y_167974 = (int16_t) 0;
                
                for (int64_t i_167973 = 0; i_167973 < b_143594; i_167973++) {
                    int64_t zm_lhs_167975 = sub64(b_143594, i_167973);
                    int64_t from_u8_arg0_167976 = sub64(zm_lhs_167975, (int64_t) 1);
                    bool x_167977 = sle64((int64_t) 0, from_u8_arg0_167976);
                    bool y_167978 = slt64(from_u8_arg0_167976, b_143594);
                    bool bounds_check_167979 = x_167977 && y_167978;
                    bool index_certs_167980;
                    
                    if (!bounds_check_167979) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_167976, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:425:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int8_t from_u8_arg0_167981 = ((int8_t *) pR_mem_171818.mem)[i_171580 * b_143594 + from_u8_arg0_167976];
                    int16_t u8_res_167982 = zext_i8_i16(from_u8_arg0_167981);
                    int32_t i64_res_167983 = sext_i64_i32(i_167973);
                    int32_t shift_left_rhs_167984 = mul32(8, i64_res_167983);
                    int16_t unsign_arg0_167985 = zext_i32_i16(shift_left_rhs_167984);
                    int16_t lifted_lambda_res_167986 = shl16(u8_res_167982, unsign_arg0_167985);
                    int16_t unsign_arg0_167987 = y_167974 | lifted_lambda_res_167986;
                    int16_t y_tmp_172537 = unsign_arg0_167987;
                    
                    y_167974 = y_tmp_172537;
                }
                defunc_0_byteSeq_to_prim_res_167972 = y_167974;
                
                int16_t lifted_lambda_res_167988 = u64_res_159255 & defunc_0_byteSeq_to_prim_res_167972;
                int64_t u16_res_167989 = zext_i16_i64(lifted_lambda_res_167988);
                bool x_167990 = sle64((int64_t) 0, u16_res_167989);
                bool y_167991 = slt64(u16_res_167989, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597);
                bool bounds_check_167992 = x_167990 && y_167991;
                bool index_certs_167993;
                
                if (!bounds_check_167992) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u16_res_167989, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t spi_167994 = ((int64_t *) first_info_idx_mem_171822.mem)[u16_res_167989];
                bool cond_167995 = slt64(spi_167994, (int64_t) 0);
                int64_t defunc_res_167996;
                
                if (cond_167995) {
                    defunc_res_167996 = (int64_t) -1;
                } else {
                    int64_t zeze_rhs_167997 = ((int64_t *) last_info_idx_mem_171823.mem)[u16_res_167989];
                    bool cond_167998 = spi_167994 == zeze_rhs_167997;
                    int64_t defunc_res_f_res_167999;
                    
                    if (cond_167998) {
                        defunc_res_f_res_167999 = spi_167994;
                    } else {
                        int64_t zs_lhs_168000 = sub64(zeze_rhs_167997, spi_167994);
                        int64_t max_arg1_168001 = sdiv64(zs_lhs_168000, (int64_t) 2);
                        int64_t max_res_168002 = smax64((int64_t) 1, max_arg1_168001);
                        bool loop_cond_168003 = slt64((int64_t) 0, max_res_168002);
                        bool bsearch_168004;
                        int64_t bsearch_168005;
                        int64_t bsearch_168006;
                        bool loop_while_168007;
                        int64_t heshi_168008;
                        int64_t step_168009;
                        
                        loop_while_168007 = loop_cond_168003;
                        heshi_168008 = spi_167994;
                        step_168009 = max_res_168002;
                        while (loop_while_168007) {
                            bool x_168010 = sle64((int64_t) 0, heshi_168008);
                            bool y_168011 = slt64(heshi_168008, dz2081U_143596);
                            bool bounds_check_168012 = x_168010 && y_168011;
                            bool index_certs_168013;
                            
                            if (!bounds_check_168012) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_168008, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t cur_S_168031 = ((int64_t *) bounds_mem_171820.mem)[heshi_168008];
                            bool x_168032 = sle64((int64_t) 0, cur_S_168031);
                            bool y_168033 = slt64(cur_S_168031, nS_143595);
                            bool bounds_check_168034 = x_168032 && y_168033;
                            bool index_certs_168035;
                            
                            if (!bounds_check_168034) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_168031, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t cur_depth_168014 = ((int32_t *) depths_mem_171821.mem)[heshi_168008];
                            bool cond_168015 = heshi_168008 == spi_167994;
                            int32_t prev_depth_168016;
                            
                            if (cond_168015) {
                                prev_depth_168016 = cur_depth_168014;
                            } else {
                                int64_t tmp_168017 = sub64(heshi_168008, (int64_t) 1);
                                bool x_168018 = sle64((int64_t) 0, tmp_168017);
                                bool y_168019 = slt64(tmp_168017, dz2081U_143596);
                                bool bounds_check_168020 = x_168018 && y_168019;
                                bool index_certs_168021;
                                
                                if (!bounds_check_168020) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168017, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t prev_depth_f_res_168022 = ((int32_t *) depths_mem_171821.mem)[tmp_168017];
                                
                                prev_depth_168016 = prev_depth_f_res_168022;
                            }
                            
                            bool cond_168023 = heshi_168008 == zeze_rhs_167997;
                            int32_t next_depth_168024;
                            
                            if (cond_168023) {
                                next_depth_168024 = cur_depth_168014;
                            } else {
                                int64_t tmp_168025 = add64((int64_t) 1, heshi_168008);
                                bool x_168026 = sle64((int64_t) 0, tmp_168025);
                                bool y_168027 = slt64(tmp_168025, dz2081U_143596);
                                bool bounds_check_168028 = x_168026 && y_168027;
                                bool index_certs_168029;
                                
                                if (!bounds_check_168028) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168025, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t next_depth_f_res_168030 = ((int32_t *) depths_mem_171821.mem)[tmp_168025];
                                
                                next_depth_168024 = next_depth_f_res_168030;
                            }
                            
                            int16_t cur_S_168036 = ((int16_t *) mem_171943)[cur_S_168031];
                            int16_t prev_S_168037;
                            
                            if (cond_168015) {
                                prev_S_168037 = cur_S_168036;
                            } else {
                                int64_t tmp_168038 = sub64(heshi_168008, (int64_t) 1);
                                bool x_168039 = sle64((int64_t) 0, tmp_168038);
                                bool y_168040 = slt64(tmp_168038, dz2081U_143596);
                                bool bounds_check_168041 = x_168039 && y_168040;
                                bool index_certs_168042;
                                
                                if (!bounds_check_168041) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168038, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_168043 = ((int64_t *) bounds_mem_171820.mem)[tmp_168038];
                                bool x_168044 = sle64((int64_t) 0, tmp_168043);
                                bool y_168045 = slt64(tmp_168043, nS_143595);
                                bool bounds_check_168046 = x_168044 && y_168045;
                                bool index_certs_168047;
                                
                                if (!bounds_check_168046) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168043, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t prev_S_f_res_168048 = ((int16_t *) mem_171943)[tmp_168043];
                                
                                prev_S_168037 = prev_S_f_res_168048;
                            }
                            
                            int16_t next_S_168049;
                            
                            if (cond_168023) {
                                next_S_168049 = cur_S_168036;
                            } else {
                                int64_t tmp_168050 = add64((int64_t) 1, heshi_168008);
                                bool x_168051 = sle64((int64_t) 0, tmp_168050);
                                bool y_168052 = slt64(tmp_168050, dz2081U_143596);
                                bool bounds_check_168053 = x_168051 && y_168052;
                                bool index_certs_168054;
                                
                                if (!bounds_check_168053) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168050, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_168055 = ((int64_t *) bounds_mem_171820.mem)[tmp_168050];
                                bool x_168056 = sle64((int64_t) 0, tmp_168055);
                                bool y_168057 = slt64(tmp_168055, nS_143595);
                                bool bounds_check_168058 = x_168056 && y_168057;
                                bool index_certs_168059;
                                
                                if (!bounds_check_168058) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168055, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:893:6-900:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-987:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int16_t next_S_f_res_168060 = ((int16_t *) mem_171943)[tmp_168055];
                                
                                next_S_168049 = next_S_f_res_168060;
                            }
                            
                            int32_t prim_get_radix_arg0_168061 = mul32(radix_sizze_143598, cur_depth_168014);
                            int64_t unsign_arg0_168062 = zext_i32_i64(prim_get_radix_arg0_168061);
                            int64_t asPow_168063 = shl64((int64_t) 1, unsign_arg0_168062);
                            int64_t u64_arg0_168064 = sub64(asPow_168063, (int64_t) 1);
                            int16_t u64_res_168065 = zext_i64_i16(u64_arg0_168064);
                            int16_t lifted_lambda_res_168066 = defunc_0_byteSeq_to_prim_res_167972 & u64_res_168065;
                            int16_t lifted_lambda_res_168067 = cur_S_168036 & u64_res_168065;
                            bool defunc_0_eq_res_168068 = lifted_lambda_res_168066 == lifted_lambda_res_168067;
                            int64_t loopres_168069;
                            int64_t loopres_168070;
                            
                            if (defunc_0_eq_res_168068) {
                                loopres_168069 = heshi_168008;
                                loopres_168070 = (int64_t) 0;
                            } else {
                                bool loop_cond_t_res_168071 = slt32(0, cur_depth_168014);
                                bool is_lt_168072;
                                bool is_lt_168073;
                                int32_t is_lt_168074;
                                bool loop_while_168075;
                                bool def_lt_168076;
                                int32_t bi_168077;
                                
                                loop_while_168075 = loop_cond_t_res_168071;
                                def_lt_168076 = 0;
                                bi_168077 = 0;
                                while (loop_while_168075) {
                                    int32_t zt_rhs_168078 = add32(1, bi_168077);
                                    int32_t prim_get_radix_arg0_168079 = mul32(radix_sizze_143598, zt_rhs_168078);
                                    int64_t unsign_arg0_168080 = zext_i32_i64(prim_get_radix_arg0_168079);
                                    int64_t asPow_168081 = shl64((int64_t) 1, unsign_arg0_168080);
                                    int64_t u64_arg0_168082 = sub64(asPow_168081, (int64_t) 1);
                                    int16_t u64_res_168083 = zext_i64_i16(u64_arg0_168082);
                                    int16_t lifted_lambda_res_168084 = defunc_0_byteSeq_to_prim_res_167972 & u64_res_168083;
                                    int16_t lifted_lambda_res_168085 = cur_S_168036 & u64_res_168083;
                                    bool defunc_0_lt_res_168086 = ult16(lifted_lambda_res_168084, lifted_lambda_res_168085);
                                    bool defunc_0_lt_res_168087 = ult16(lifted_lambda_res_168085, lifted_lambda_res_168084);
                                    bool cond_168088 = !defunc_0_lt_res_168087;
                                    bool cond_t_res_168089 = !defunc_0_lt_res_168086;
                                    bool x_168090 = cond_168088 && cond_t_res_168089;
                                    bool loop_cond_t_res_168091 = slt32(zt_rhs_168078, cur_depth_168014);
                                    bool x_168092 = x_168090 && loop_cond_t_res_168091;
                                    bool loop_while_tmp_172541 = x_168092;
                                    bool def_lt_tmp_172542 = defunc_0_lt_res_168086;
                                    int32_t bi_tmp_172543 = zt_rhs_168078;
                                    
                                    loop_while_168075 = loop_while_tmp_172541;
                                    def_lt_168076 = def_lt_tmp_172542;
                                    bi_168077 = bi_tmp_172543;
                                }
                                is_lt_168072 = loop_while_168075;
                                is_lt_168073 = def_lt_168076;
                                is_lt_168074 = bi_168077;
                                
                                int64_t loopres_f_res_168093;
                                int64_t loopres_f_res_168094;
                                
                                if (is_lt_168073) {
                                    bool loop_cond_t_res_168095 = slt32(0, prev_depth_168016);
                                    bool is_gt_168096;
                                    bool is_gt_168097;
                                    int32_t is_gt_168098;
                                    bool loop_while_168099;
                                    bool def_gt_168100;
                                    int32_t bi_168101;
                                    
                                    loop_while_168099 = loop_cond_t_res_168095;
                                    def_gt_168100 = 0;
                                    bi_168101 = 0;
                                    while (loop_while_168099) {
                                        int32_t zt_rhs_168102 = add32(1, bi_168101);
                                        int32_t prim_get_radix_arg0_168103 = mul32(radix_sizze_143598, zt_rhs_168102);
                                        int64_t unsign_arg0_168104 = zext_i32_i64(prim_get_radix_arg0_168103);
                                        int64_t asPow_168105 = shl64((int64_t) 1, unsign_arg0_168104);
                                        int64_t u64_arg0_168106 = sub64(asPow_168105, (int64_t) 1);
                                        int16_t u64_res_168107 = zext_i64_i16(u64_arg0_168106);
                                        int16_t lifted_lambda_res_168108 = defunc_0_byteSeq_to_prim_res_167972 & u64_res_168107;
                                        int16_t lifted_lambda_res_168109 = prev_S_168037 & u64_res_168107;
                                        bool defunc_0_gt_res_168110 = ult16(lifted_lambda_res_168109, lifted_lambda_res_168108);
                                        bool defunc_0_gt_res_168111 = ult16(lifted_lambda_res_168108, lifted_lambda_res_168109);
                                        bool cond_168112 = !defunc_0_gt_res_168110;
                                        bool cond_t_res_168113 = !defunc_0_gt_res_168111;
                                        bool x_168114 = cond_168112 && cond_t_res_168113;
                                        bool loop_cond_t_res_168115 = slt32(zt_rhs_168102, prev_depth_168016);
                                        bool x_168116 = x_168114 && loop_cond_t_res_168115;
                                        bool loop_while_tmp_172544 = x_168116;
                                        bool def_gt_tmp_172545 = defunc_0_gt_res_168110;
                                        int32_t bi_tmp_172546 = zt_rhs_168102;
                                        
                                        loop_while_168099 = loop_while_tmp_172544;
                                        def_gt_168100 = def_gt_tmp_172545;
                                        bi_168101 = bi_tmp_172546;
                                    }
                                    is_gt_168096 = loop_while_168099;
                                    is_gt_168097 = def_gt_168100;
                                    is_gt_168098 = bi_168101;
                                    
                                    bool x_168117 = !cond_168015;
                                    bool y_168118 = is_gt_168097 && x_168117;
                                    bool cond_168119 = cond_168015 || y_168118;
                                    int64_t loopres_f_res_t_res_168120;
                                    int64_t loopres_f_res_t_res_168121;
                                    
                                    if (cond_168119) {
                                        loopres_f_res_t_res_168120 = (int64_t) -1;
                                        loopres_f_res_t_res_168121 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_168122 = sub64(heshi_168008, step_168009);
                                        int64_t max_arg1_168123 = sdiv64(step_168009, (int64_t) 2);
                                        int64_t max_res_168124 = smax64((int64_t) 1, max_arg1_168123);
                                        
                                        loopres_f_res_t_res_168120 = tmp_168122;
                                        loopres_f_res_t_res_168121 = max_res_168124;
                                    }
                                    loopres_f_res_168093 = loopres_f_res_t_res_168120;
                                    loopres_f_res_168094 = loopres_f_res_t_res_168121;
                                } else {
                                    bool loop_cond_t_res_168125 = slt32(0, next_depth_168024);
                                    bool is_lt_168126;
                                    bool is_lt_168127;
                                    int32_t is_lt_168128;
                                    bool loop_while_168129;
                                    bool def_lt_168130;
                                    int32_t bi_168131;
                                    
                                    loop_while_168129 = loop_cond_t_res_168125;
                                    def_lt_168130 = 0;
                                    bi_168131 = 0;
                                    while (loop_while_168129) {
                                        int32_t zt_rhs_168132 = add32(1, bi_168131);
                                        int32_t prim_get_radix_arg0_168133 = mul32(radix_sizze_143598, zt_rhs_168132);
                                        int64_t unsign_arg0_168134 = zext_i32_i64(prim_get_radix_arg0_168133);
                                        int64_t asPow_168135 = shl64((int64_t) 1, unsign_arg0_168134);
                                        int64_t u64_arg0_168136 = sub64(asPow_168135, (int64_t) 1);
                                        int16_t u64_res_168137 = zext_i64_i16(u64_arg0_168136);
                                        int16_t lifted_lambda_res_168138 = defunc_0_byteSeq_to_prim_res_167972 & u64_res_168137;
                                        int16_t lifted_lambda_res_168139 = next_S_168049 & u64_res_168137;
                                        bool defunc_0_lt_res_168140 = ult16(lifted_lambda_res_168138, lifted_lambda_res_168139);
                                        bool defunc_0_lt_res_168141 = ult16(lifted_lambda_res_168139, lifted_lambda_res_168138);
                                        bool cond_168142 = !defunc_0_lt_res_168141;
                                        bool cond_t_res_168143 = !defunc_0_lt_res_168140;
                                        bool x_168144 = cond_168142 && cond_t_res_168143;
                                        bool loop_cond_t_res_168145 = slt32(zt_rhs_168132, next_depth_168024);
                                        bool x_168146 = x_168144 && loop_cond_t_res_168145;
                                        bool loop_while_tmp_172547 = x_168146;
                                        bool def_lt_tmp_172548 = defunc_0_lt_res_168140;
                                        int32_t bi_tmp_172549 = zt_rhs_168132;
                                        
                                        loop_while_168129 = loop_while_tmp_172547;
                                        def_lt_168130 = def_lt_tmp_172548;
                                        bi_168131 = bi_tmp_172549;
                                    }
                                    is_lt_168126 = loop_while_168129;
                                    is_lt_168127 = def_lt_168130;
                                    is_lt_168128 = bi_168131;
                                    
                                    bool x_168147 = !cond_168023;
                                    bool y_168148 = is_lt_168127 && x_168147;
                                    bool cond_168149 = cond_168023 || y_168148;
                                    int64_t loopres_f_res_f_res_168150;
                                    int64_t loopres_f_res_f_res_168151;
                                    
                                    if (cond_168149) {
                                        loopres_f_res_f_res_168150 = (int64_t) -1;
                                        loopres_f_res_f_res_168151 = (int64_t) 0;
                                    } else {
                                        int64_t tmp_168152 = add64(heshi_168008, step_168009);
                                        int64_t max_arg1_168153 = sdiv64(step_168009, (int64_t) 2);
                                        int64_t max_res_168154 = smax64((int64_t) 1, max_arg1_168153);
                                        
                                        loopres_f_res_f_res_168150 = tmp_168152;
                                        loopres_f_res_f_res_168151 = max_res_168154;
                                    }
                                    loopres_f_res_168093 = loopres_f_res_f_res_168150;
                                    loopres_f_res_168094 = loopres_f_res_f_res_168151;
                                }
                                loopres_168069 = loopres_f_res_168093;
                                loopres_168070 = loopres_f_res_168094;
                            }
                            
                            bool loop_cond_168155 = slt64((int64_t) 0, loopres_168070);
                            bool loop_while_tmp_172538 = loop_cond_168155;
                            int64_t heshi_tmp_172539 = loopres_168069;
                            int64_t step_tmp_172540 = loopres_168070;
                            
                            loop_while_168007 = loop_while_tmp_172538;
                            heshi_168008 = heshi_tmp_172539;
                            step_168009 = step_tmp_172540;
                        }
                        bsearch_168004 = loop_while_168007;
                        bsearch_168005 = heshi_168008;
                        bsearch_168006 = step_168009;
                        defunc_res_f_res_167999 = bsearch_168005;
                    }
                    defunc_res_167996 = defunc_res_f_res_167999;
                }
                
                bool cond_168156 = sle64(defunc_res_167996, (int64_t) 0);
                int64_t inf_168157;
                
                if (cond_168156) {
                    inf_168157 = (int64_t) 0;
                } else {
                    bool x_168158 = sle64((int64_t) 0, defunc_res_167996);
                    bool y_168159 = slt64(defunc_res_167996, dz2081U_143596);
                    bool bounds_check_168160 = x_168158 && y_168159;
                    bool index_certs_168161;
                    
                    if (!bounds_check_168160) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_167996, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:901:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-987:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t inf_f_res_168162 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_167996];
                    
                    inf_168157 = inf_f_res_168162;
                }
                
                bool cond_168163 = defunc_res_167996 == zeze_rhs_159252;
                int64_t sup_168164;
                
                if (cond_168163) {
                    sup_168164 = nS_143595;
                } else {
                    int64_t tmp_168165 = add64((int64_t) 1, defunc_res_167996);
                    bool x_168166 = sle64((int64_t) 0, tmp_168165);
                    bool y_168167 = slt64(tmp_168165, dz2081U_143596);
                    bool bounds_check_168168 = x_168166 && y_168167;
                    bool index_certs_168169;
                    
                    if (!bounds_check_168168) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168165, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:902:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-987:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t sup_f_res_168170 = ((int64_t *) bounds_mem_171820.mem)[tmp_168165];
                    
                    sup_168164 = sup_f_res_168170;
                }
                
                bool cond_168171 = slt64(inf_168157, sup_168164);
                bool sm_168172;
                int64_t sm_168173;
                bool loop_while_168174;
                int64_t j_168175;
                
                loop_while_168174 = cond_168171;
                j_168175 = inf_168157;
                while (loop_while_168174) {
                    bool x_168176 = sle64((int64_t) 0, j_168175);
                    bool y_168177 = slt64(j_168175, nS_143595);
                    bool bounds_check_168178 = x_168176 && y_168177;
                    bool index_certs_168179;
                    
                    if (!bounds_check_168178) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_168175, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:905:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-987:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t zeze_rhs_168180 = ((int16_t *) mem_171943)[j_168175];
                    bool is_eq_168181 = defunc_0_byteSeq_to_prim_res_167972 == zeze_rhs_168180;
                    int64_t loopres_168182;
                    
                    if (is_eq_168181) {
                        loopres_168182 = j_168175;
                    } else {
                        int64_t tmp_168183 = add64((int64_t) 1, j_168175);
                        
                        loopres_168182 = tmp_168183;
                    }
                    
                    bool cond_168184 = slt64(loopres_168182, sup_168164);
                    bool loop_cond_t_res_168185 = !is_eq_168181;
                    bool x_168186 = cond_168184 && loop_cond_t_res_168185;
                    bool loop_while_tmp_172550 = x_168186;
                    int64_t j_tmp_172551 = loopres_168182;
                    
                    loop_while_168174 = loop_while_tmp_172550;
                    j_168175 = j_tmp_172551;
                }
                sm_168172 = loop_while_168174;
                sm_168173 = j_168175;
                
                bool cond_168187 = slt64(sm_168173, sup_168164);
                int64_t lifted_lambda_res_168188;
                
                if (cond_168187) {
                    lifted_lambda_res_168188 = sm_168173;
                } else {
                    lifted_lambda_res_168188 = (int64_t) -1;
                }
                
                bool lifted_lambda_res_168189 = sle64((int64_t) 0, lifted_lambda_res_168188);
                int64_t bool_res_168190 = btoi_bool_i64(lifted_lambda_res_168189);
                int64_t defunc_0_op_res_168195 = add64(bool_res_168190, scanacc_171576);
                int64_t zp_res_168198 = add64(bool_res_168190, redout_171578);
                
                ((int64_t *) mem_171951)[i_171580] = defunc_0_op_res_168195;
                ((int64_t *) mem_171953)[i_171580] = lifted_lambda_res_168188;
                
                int64_t scanacc_tmp_172533 = defunc_0_op_res_168195;
                int64_t redout_tmp_172535 = zp_res_168198;
                
                scanacc_171576 = scanacc_tmp_172533;
                redout_171578 = redout_tmp_172535;
            }
            discard_171583 = scanacc_171576;
            defunc_res_167969 = redout_171578;
            
            int64_t bytes_171966 = (int64_t) 8 * defunc_res_167969;
            int64_t bytes_171983 = b_143594 * defunc_res_167969;
            
            if (memblock_alloc(ctx, &mem_171967, bytes_171966, "mem_171967")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_167969; nest_i_172552++) {
                ((int64_t *) mem_171967.mem)[nest_i_172552] = (int64_t) -1;
            }
            if (memblock_alloc(ctx, &mem_171969, bytes_171966, "mem_171969")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172553 = 0; nest_i_172553 < defunc_res_167969; nest_i_172553++) {
                ((int64_t *) mem_171969.mem)[nest_i_172553] = (int64_t) -1;
            }
            for (int64_t write_iter_171584 = 0; write_iter_171584 < nR_143593; write_iter_171584++) {
                int64_t write_iv_171588 = ((int64_t *) mem_171953)[write_iter_171584];
                int64_t zv_lhs_168215 = add64((int64_t) -1, write_iter_171584);
                int64_t tmp_168216 = smod64(zv_lhs_168215, nR_143593);
                int64_t lifted_lambda_res_168217 = ((int64_t *) mem_171951)[tmp_168216];
                bool cond_168218 = write_iter_171584 == (int64_t) 0;
                int64_t lifted_lambda_res_168219;
                
                if (cond_168218) {
                    lifted_lambda_res_168219 = (int64_t) 0;
                } else {
                    lifted_lambda_res_168219 = lifted_lambda_res_168217;
                }
                
                bool cond_168220 = sle64((int64_t) 0, write_iv_171588);
                int64_t lifted_lambda_res_168221;
                
                if (cond_168220) {
                    lifted_lambda_res_168221 = lifted_lambda_res_168219;
                } else {
                    lifted_lambda_res_168221 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_168221) && slt64(lifted_lambda_res_168221, defunc_res_167969)) {
                    ((int64_t *) mem_171967.mem)[lifted_lambda_res_168221] = write_iv_171588;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_168221) && slt64(lifted_lambda_res_168221, defunc_res_167969)) {
                    ((int64_t *) mem_171969.mem)[lifted_lambda_res_168221] = write_iter_171584;
                }
            }
            if (memblock_alloc(ctx, &mem_171982, b_143594, "mem_171982")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172556 = 0; nest_i_172556 < b_143594; nest_i_172556++) {
                ((int8_t *) mem_171982.mem)[nest_i_172556] = (int8_t) 0;
            }
            if (memblock_alloc(ctx, &mem_171984, bytes_171983, "mem_171984")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171593 = 0; i_171593 < defunc_res_167969; i_171593++) {
                int64_t eta_p_168230 = ((int64_t *) mem_171969.mem)[i_171593];
                bool cond_168231 = sle64((int64_t) 0, eta_p_168230);
                bool cond_t_res_168232 = slt64(eta_p_168230, nR_143593);
                bool x_168233 = cond_168231 && cond_t_res_168232;
                int64_t lmad_ext_171989 = b_143594 * eta_p_168230;
                int64_t ext_171990;
                
                if (x_168233) {
                    ext_171990 = lmad_ext_171989;
                } else {
                    ext_171990 = (int64_t) 0;
                }
                if (x_168233) {
                    bool index_certs_168235;
                    
                    if (!x_168233) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_168230, "] out of bounds for array of shape [", (long long) nR_143593, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    if (memblock_set(ctx, &ext_mem_171991, &pR_mem_171818, "pR_mem_171818") != 0)
                        return 1;
                } else if (memblock_set(ctx, &ext_mem_171991, &mem_171982, "mem_171982") != 0)
                    return 1;
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171984.mem, i_171593 * b_143594, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171991.mem, ext_171990, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143594});
                if (memblock_unref(ctx, &ext_mem_171991, "ext_mem_171991") != 0)
                    return 1;
            }
            if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172005, &mem_171969, "mem_171969") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172002, &mem_171967, "mem_171967") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171999, &mem_171984, "mem_171984") != 0)
                return 1;
            radix_hash_join_with_S_keys_unique_res_f_res_159516 = defunc_res_167969;
            radix_hash_join_with_S_keys_unique_res_f_res_159517 = defunc_res_167969;
            radix_hash_join_with_S_keys_unique_res_f_res_159518 = defunc_res_167969;
        } else {
            int64_t radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775;
            
            if (cond_159248) {
                if (mem_171879_cached_sizze_172739 < bytes_171878) {
                    err = lexical_realloc(ctx, &mem_171879, &mem_171879_cached_sizze_172739, bytes_171878);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171597 = 0; i_171597 < nS_143595; i_171597++) {
                    int32_t defunc_0_byteSeq_to_prim_res_168281;
                    int32_t y_168283 = 0;
                    
                    for (int64_t i_168282 = 0; i_168282 < b_143594; i_168282++) {
                        int64_t zm_lhs_168284 = sub64(b_143594, i_168282);
                        int64_t from_u8_arg0_168285 = sub64(zm_lhs_168284, (int64_t) 1);
                        bool x_168286 = sle64((int64_t) 0, from_u8_arg0_168285);
                        bool y_168287 = slt64(from_u8_arg0_168285, b_143594);
                        bool bounds_check_168288 = x_168286 && y_168287;
                        bool index_certs_168289;
                        
                        if (!bounds_check_168288) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_168285, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:427:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_168290 = ((int8_t *) pS_mem_171819.mem)[i_171597 * b_143594 + from_u8_arg0_168285];
                        int32_t u8_res_168291 = zext_i8_i32(from_u8_arg0_168290);
                        int32_t i64_res_168292 = sext_i64_i32(i_168282);
                        int32_t shift_left_rhs_168293 = mul32(8, i64_res_168292);
                        int32_t lifted_lambda_res_168294 = shl32(u8_res_168291, shift_left_rhs_168293);
                        int32_t unsign_arg0_168295 = y_168283 | lifted_lambda_res_168294;
                        int32_t y_tmp_172559 = unsign_arg0_168295;
                        
                        y_168283 = y_tmp_172559;
                    }
                    defunc_0_byteSeq_to_prim_res_168281 = y_168283;
                    ((int32_t *) mem_171879)[i_171597] = defunc_0_byteSeq_to_prim_res_168281;
                }
                if (mem_171887_cached_sizze_172740 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171887, &mem_171887_cached_sizze_172740, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171889_cached_sizze_172741 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171889, &mem_171889_cached_sizze_172741, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171608;
                int64_t defunc_res_168301;
                int64_t scanacc_171601;
                int64_t redout_171603;
                
                scanacc_171601 = (int64_t) 0;
                redout_171603 = (int64_t) 0;
                for (int64_t i_171605 = 0; i_171605 < nR_143593; i_171605++) {
                    int32_t defunc_0_byteSeq_to_prim_res_168304;
                    int32_t y_168306 = 0;
                    
                    for (int64_t i_168305 = 0; i_168305 < b_143594; i_168305++) {
                        int64_t zm_lhs_168307 = sub64(b_143594, i_168305);
                        int64_t from_u8_arg0_168308 = sub64(zm_lhs_168307, (int64_t) 1);
                        bool x_168309 = sle64((int64_t) 0, from_u8_arg0_168308);
                        bool y_168310 = slt64(from_u8_arg0_168308, b_143594);
                        bool bounds_check_168311 = x_168309 && y_168310;
                        bool index_certs_168312;
                        
                        if (!bounds_check_168311) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_168308, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:427:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_168313 = ((int8_t *) pR_mem_171818.mem)[i_171605 * b_143594 + from_u8_arg0_168308];
                        int32_t u8_res_168314 = zext_i8_i32(from_u8_arg0_168313);
                        int32_t i64_res_168315 = sext_i64_i32(i_168305);
                        int32_t shift_left_rhs_168316 = mul32(8, i64_res_168315);
                        int32_t lifted_lambda_res_168317 = shl32(u8_res_168314, shift_left_rhs_168316);
                        int32_t unsign_arg0_168318 = y_168306 | lifted_lambda_res_168317;
                        int32_t y_tmp_172564 = unsign_arg0_168318;
                        
                        y_168306 = y_tmp_172564;
                    }
                    defunc_0_byteSeq_to_prim_res_168304 = y_168306;
                    
                    int32_t lifted_lambda_res_168319 = za_rhs_159254 & defunc_0_byteSeq_to_prim_res_168304;
                    int64_t u32_res_168320 = zext_i32_i64(lifted_lambda_res_168319);
                    bool x_168321 = sle64((int64_t) 0, u32_res_168320);
                    bool y_168322 = slt64(u32_res_168320, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597);
                    bool bounds_check_168323 = x_168321 && y_168322;
                    bool index_certs_168324;
                    
                    if (!bounds_check_168323) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u32_res_168320, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_168325 = ((int64_t *) first_info_idx_mem_171822.mem)[u32_res_168320];
                    bool cond_168326 = slt64(spi_168325, (int64_t) 0);
                    int64_t defunc_res_168327;
                    
                    if (cond_168326) {
                        defunc_res_168327 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_168328 = ((int64_t *) last_info_idx_mem_171823.mem)[u32_res_168320];
                        bool cond_168329 = spi_168325 == zeze_rhs_168328;
                        int64_t defunc_res_f_res_168330;
                        
                        if (cond_168329) {
                            defunc_res_f_res_168330 = spi_168325;
                        } else {
                            int64_t zs_lhs_168331 = sub64(zeze_rhs_168328, spi_168325);
                            int64_t max_arg1_168332 = sdiv64(zs_lhs_168331, (int64_t) 2);
                            int64_t max_res_168333 = smax64((int64_t) 1, max_arg1_168332);
                            bool loop_cond_168334 = slt64((int64_t) 0, max_res_168333);
                            bool bsearch_168335;
                            int64_t bsearch_168336;
                            int64_t bsearch_168337;
                            bool loop_while_168338;
                            int64_t heshi_168339;
                            int64_t step_168340;
                            
                            loop_while_168338 = loop_cond_168334;
                            heshi_168339 = spi_168325;
                            step_168340 = max_res_168333;
                            while (loop_while_168338) {
                                bool x_168341 = sle64((int64_t) 0, heshi_168339);
                                bool y_168342 = slt64(heshi_168339, dz2081U_143596);
                                bool bounds_check_168343 = x_168341 && y_168342;
                                bool index_certs_168344;
                                
                                if (!bounds_check_168343) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_168339, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_168362 = ((int64_t *) bounds_mem_171820.mem)[heshi_168339];
                                bool x_168363 = sle64((int64_t) 0, cur_S_168362);
                                bool y_168364 = slt64(cur_S_168362, nS_143595);
                                bool bounds_check_168365 = x_168363 && y_168364;
                                bool index_certs_168366;
                                
                                if (!bounds_check_168365) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_168362, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_168345 = ((int32_t *) depths_mem_171821.mem)[heshi_168339];
                                bool cond_168346 = heshi_168339 == spi_168325;
                                int32_t prev_depth_168347;
                                
                                if (cond_168346) {
                                    prev_depth_168347 = cur_depth_168345;
                                } else {
                                    int64_t tmp_168348 = sub64(heshi_168339, (int64_t) 1);
                                    bool x_168349 = sle64((int64_t) 0, tmp_168348);
                                    bool y_168350 = slt64(tmp_168348, dz2081U_143596);
                                    bool bounds_check_168351 = x_168349 && y_168350;
                                    bool index_certs_168352;
                                    
                                    if (!bounds_check_168351) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168348, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_168353 = ((int32_t *) depths_mem_171821.mem)[tmp_168348];
                                    
                                    prev_depth_168347 = prev_depth_f_res_168353;
                                }
                                
                                bool cond_168354 = heshi_168339 == zeze_rhs_168328;
                                int32_t next_depth_168355;
                                
                                if (cond_168354) {
                                    next_depth_168355 = cur_depth_168345;
                                } else {
                                    int64_t tmp_168356 = add64((int64_t) 1, heshi_168339);
                                    bool x_168357 = sle64((int64_t) 0, tmp_168356);
                                    bool y_168358 = slt64(tmp_168356, dz2081U_143596);
                                    bool bounds_check_168359 = x_168357 && y_168358;
                                    bool index_certs_168360;
                                    
                                    if (!bounds_check_168359) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168356, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_168361 = ((int32_t *) depths_mem_171821.mem)[tmp_168356];
                                    
                                    next_depth_168355 = next_depth_f_res_168361;
                                }
                                
                                int32_t cur_S_168367 = ((int32_t *) mem_171879)[cur_S_168362];
                                int32_t prev_S_168368;
                                
                                if (cond_168346) {
                                    prev_S_168368 = cur_S_168367;
                                } else {
                                    int64_t tmp_168369 = sub64(heshi_168339, (int64_t) 1);
                                    bool x_168370 = sle64((int64_t) 0, tmp_168369);
                                    bool y_168371 = slt64(tmp_168369, dz2081U_143596);
                                    bool bounds_check_168372 = x_168370 && y_168371;
                                    bool index_certs_168373;
                                    
                                    if (!bounds_check_168372) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168369, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_168374 = ((int64_t *) bounds_mem_171820.mem)[tmp_168369];
                                    bool x_168375 = sle64((int64_t) 0, tmp_168374);
                                    bool y_168376 = slt64(tmp_168374, nS_143595);
                                    bool bounds_check_168377 = x_168375 && y_168376;
                                    bool index_certs_168378;
                                    
                                    if (!bounds_check_168377) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168374, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_S_f_res_168379 = ((int32_t *) mem_171879)[tmp_168374];
                                    
                                    prev_S_168368 = prev_S_f_res_168379;
                                }
                                
                                int32_t next_S_168380;
                                
                                if (cond_168354) {
                                    next_S_168380 = cur_S_168367;
                                } else {
                                    int64_t tmp_168381 = add64((int64_t) 1, heshi_168339);
                                    bool x_168382 = sle64((int64_t) 0, tmp_168381);
                                    bool y_168383 = slt64(tmp_168381, dz2081U_143596);
                                    bool bounds_check_168384 = x_168382 && y_168383;
                                    bool index_certs_168385;
                                    
                                    if (!bounds_check_168384) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168381, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_168386 = ((int64_t *) bounds_mem_171820.mem)[tmp_168381];
                                    bool x_168387 = sle64((int64_t) 0, tmp_168386);
                                    bool y_168388 = slt64(tmp_168386, nS_143595);
                                    bool bounds_check_168389 = x_168387 && y_168388;
                                    bool index_certs_168390;
                                    
                                    if (!bounds_check_168389) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168386, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:923:6-930:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-988:78\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_S_f_res_168391 = ((int32_t *) mem_171879)[tmp_168386];
                                    
                                    next_S_168380 = next_S_f_res_168391;
                                }
                                
                                int32_t prim_get_radix_arg0_168392 = mul32(radix_sizze_143598, cur_depth_168345);
                                int64_t unsign_arg0_168393 = zext_i32_i64(prim_get_radix_arg0_168392);
                                int64_t asPow_168394 = shl64((int64_t) 1, unsign_arg0_168393);
                                int64_t u64_arg0_168395 = sub64(asPow_168394, (int64_t) 1);
                                int32_t u64_res_168396 = zext_i64_i32(u64_arg0_168395);
                                int32_t lifted_lambda_res_168397 = defunc_0_byteSeq_to_prim_res_168304 & u64_res_168396;
                                int32_t lifted_lambda_res_168398 = cur_S_168367 & u64_res_168396;
                                bool defunc_0_eq_res_168399 = lifted_lambda_res_168397 == lifted_lambda_res_168398;
                                int64_t loopres_168400;
                                int64_t loopres_168401;
                                
                                if (defunc_0_eq_res_168399) {
                                    loopres_168400 = heshi_168339;
                                    loopres_168401 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_168402 = slt32(0, cur_depth_168345);
                                    bool is_lt_168403;
                                    bool is_lt_168404;
                                    int32_t is_lt_168405;
                                    bool loop_while_168406;
                                    bool def_lt_168407;
                                    int32_t bi_168408;
                                    
                                    loop_while_168406 = loop_cond_t_res_168402;
                                    def_lt_168407 = 0;
                                    bi_168408 = 0;
                                    while (loop_while_168406) {
                                        int32_t zt_rhs_168409 = add32(1, bi_168408);
                                        int32_t prim_get_radix_arg0_168410 = mul32(radix_sizze_143598, zt_rhs_168409);
                                        int64_t unsign_arg0_168411 = zext_i32_i64(prim_get_radix_arg0_168410);
                                        int64_t asPow_168412 = shl64((int64_t) 1, unsign_arg0_168411);
                                        int64_t u64_arg0_168413 = sub64(asPow_168412, (int64_t) 1);
                                        int32_t u64_res_168414 = zext_i64_i32(u64_arg0_168413);
                                        int32_t lifted_lambda_res_168415 = defunc_0_byteSeq_to_prim_res_168304 & u64_res_168414;
                                        int32_t lifted_lambda_res_168416 = cur_S_168367 & u64_res_168414;
                                        bool defunc_0_lt_res_168417 = ult32(lifted_lambda_res_168415, lifted_lambda_res_168416);
                                        bool defunc_0_lt_res_168418 = ult32(lifted_lambda_res_168416, lifted_lambda_res_168415);
                                        bool cond_168419 = !defunc_0_lt_res_168418;
                                        bool cond_t_res_168420 = !defunc_0_lt_res_168417;
                                        bool x_168421 = cond_168419 && cond_t_res_168420;
                                        bool loop_cond_t_res_168422 = slt32(zt_rhs_168409, cur_depth_168345);
                                        bool x_168423 = x_168421 && loop_cond_t_res_168422;
                                        bool loop_while_tmp_172568 = x_168423;
                                        bool def_lt_tmp_172569 = defunc_0_lt_res_168417;
                                        int32_t bi_tmp_172570 = zt_rhs_168409;
                                        
                                        loop_while_168406 = loop_while_tmp_172568;
                                        def_lt_168407 = def_lt_tmp_172569;
                                        bi_168408 = bi_tmp_172570;
                                    }
                                    is_lt_168403 = loop_while_168406;
                                    is_lt_168404 = def_lt_168407;
                                    is_lt_168405 = bi_168408;
                                    
                                    int64_t loopres_f_res_168424;
                                    int64_t loopres_f_res_168425;
                                    
                                    if (is_lt_168404) {
                                        bool loop_cond_t_res_168426 = slt32(0, prev_depth_168347);
                                        bool is_gt_168427;
                                        bool is_gt_168428;
                                        int32_t is_gt_168429;
                                        bool loop_while_168430;
                                        bool def_gt_168431;
                                        int32_t bi_168432;
                                        
                                        loop_while_168430 = loop_cond_t_res_168426;
                                        def_gt_168431 = 0;
                                        bi_168432 = 0;
                                        while (loop_while_168430) {
                                            int32_t zt_rhs_168433 = add32(1, bi_168432);
                                            int32_t prim_get_radix_arg0_168434 = mul32(radix_sizze_143598, zt_rhs_168433);
                                            int64_t unsign_arg0_168435 = zext_i32_i64(prim_get_radix_arg0_168434);
                                            int64_t asPow_168436 = shl64((int64_t) 1, unsign_arg0_168435);
                                            int64_t u64_arg0_168437 = sub64(asPow_168436, (int64_t) 1);
                                            int32_t u64_res_168438 = zext_i64_i32(u64_arg0_168437);
                                            int32_t lifted_lambda_res_168439 = defunc_0_byteSeq_to_prim_res_168304 & u64_res_168438;
                                            int32_t lifted_lambda_res_168440 = prev_S_168368 & u64_res_168438;
                                            bool defunc_0_gt_res_168441 = ult32(lifted_lambda_res_168440, lifted_lambda_res_168439);
                                            bool defunc_0_gt_res_168442 = ult32(lifted_lambda_res_168439, lifted_lambda_res_168440);
                                            bool cond_168443 = !defunc_0_gt_res_168441;
                                            bool cond_t_res_168444 = !defunc_0_gt_res_168442;
                                            bool x_168445 = cond_168443 && cond_t_res_168444;
                                            bool loop_cond_t_res_168446 = slt32(zt_rhs_168433, prev_depth_168347);
                                            bool x_168447 = x_168445 && loop_cond_t_res_168446;
                                            bool loop_while_tmp_172571 = x_168447;
                                            bool def_gt_tmp_172572 = defunc_0_gt_res_168441;
                                            int32_t bi_tmp_172573 = zt_rhs_168433;
                                            
                                            loop_while_168430 = loop_while_tmp_172571;
                                            def_gt_168431 = def_gt_tmp_172572;
                                            bi_168432 = bi_tmp_172573;
                                        }
                                        is_gt_168427 = loop_while_168430;
                                        is_gt_168428 = def_gt_168431;
                                        is_gt_168429 = bi_168432;
                                        
                                        bool x_168448 = !cond_168346;
                                        bool y_168449 = is_gt_168428 && x_168448;
                                        bool cond_168450 = cond_168346 || y_168449;
                                        int64_t loopres_f_res_t_res_168451;
                                        int64_t loopres_f_res_t_res_168452;
                                        
                                        if (cond_168450) {
                                            loopres_f_res_t_res_168451 = (int64_t) -1;
                                            loopres_f_res_t_res_168452 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_168453 = sub64(heshi_168339, step_168340);
                                            int64_t max_arg1_168454 = sdiv64(step_168340, (int64_t) 2);
                                            int64_t max_res_168455 = smax64((int64_t) 1, max_arg1_168454);
                                            
                                            loopres_f_res_t_res_168451 = tmp_168453;
                                            loopres_f_res_t_res_168452 = max_res_168455;
                                        }
                                        loopres_f_res_168424 = loopres_f_res_t_res_168451;
                                        loopres_f_res_168425 = loopres_f_res_t_res_168452;
                                    } else {
                                        bool loop_cond_t_res_168456 = slt32(0, next_depth_168355);
                                        bool is_lt_168457;
                                        bool is_lt_168458;
                                        int32_t is_lt_168459;
                                        bool loop_while_168460;
                                        bool def_lt_168461;
                                        int32_t bi_168462;
                                        
                                        loop_while_168460 = loop_cond_t_res_168456;
                                        def_lt_168461 = 0;
                                        bi_168462 = 0;
                                        while (loop_while_168460) {
                                            int32_t zt_rhs_168463 = add32(1, bi_168462);
                                            int32_t prim_get_radix_arg0_168464 = mul32(radix_sizze_143598, zt_rhs_168463);
                                            int64_t unsign_arg0_168465 = zext_i32_i64(prim_get_radix_arg0_168464);
                                            int64_t asPow_168466 = shl64((int64_t) 1, unsign_arg0_168465);
                                            int64_t u64_arg0_168467 = sub64(asPow_168466, (int64_t) 1);
                                            int32_t u64_res_168468 = zext_i64_i32(u64_arg0_168467);
                                            int32_t lifted_lambda_res_168469 = defunc_0_byteSeq_to_prim_res_168304 & u64_res_168468;
                                            int32_t lifted_lambda_res_168470 = next_S_168380 & u64_res_168468;
                                            bool defunc_0_lt_res_168471 = ult32(lifted_lambda_res_168469, lifted_lambda_res_168470);
                                            bool defunc_0_lt_res_168472 = ult32(lifted_lambda_res_168470, lifted_lambda_res_168469);
                                            bool cond_168473 = !defunc_0_lt_res_168472;
                                            bool cond_t_res_168474 = !defunc_0_lt_res_168471;
                                            bool x_168475 = cond_168473 && cond_t_res_168474;
                                            bool loop_cond_t_res_168476 = slt32(zt_rhs_168463, next_depth_168355);
                                            bool x_168477 = x_168475 && loop_cond_t_res_168476;
                                            bool loop_while_tmp_172574 = x_168477;
                                            bool def_lt_tmp_172575 = defunc_0_lt_res_168471;
                                            int32_t bi_tmp_172576 = zt_rhs_168463;
                                            
                                            loop_while_168460 = loop_while_tmp_172574;
                                            def_lt_168461 = def_lt_tmp_172575;
                                            bi_168462 = bi_tmp_172576;
                                        }
                                        is_lt_168457 = loop_while_168460;
                                        is_lt_168458 = def_lt_168461;
                                        is_lt_168459 = bi_168462;
                                        
                                        bool x_168478 = !cond_168354;
                                        bool y_168479 = is_lt_168458 && x_168478;
                                        bool cond_168480 = cond_168354 || y_168479;
                                        int64_t loopres_f_res_f_res_168481;
                                        int64_t loopres_f_res_f_res_168482;
                                        
                                        if (cond_168480) {
                                            loopres_f_res_f_res_168481 = (int64_t) -1;
                                            loopres_f_res_f_res_168482 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_168483 = add64(heshi_168339, step_168340);
                                            int64_t max_arg1_168484 = sdiv64(step_168340, (int64_t) 2);
                                            int64_t max_res_168485 = smax64((int64_t) 1, max_arg1_168484);
                                            
                                            loopres_f_res_f_res_168481 = tmp_168483;
                                            loopres_f_res_f_res_168482 = max_res_168485;
                                        }
                                        loopres_f_res_168424 = loopres_f_res_f_res_168481;
                                        loopres_f_res_168425 = loopres_f_res_f_res_168482;
                                    }
                                    loopres_168400 = loopres_f_res_168424;
                                    loopres_168401 = loopres_f_res_168425;
                                }
                                
                                bool loop_cond_168486 = slt64((int64_t) 0, loopres_168401);
                                bool loop_while_tmp_172565 = loop_cond_168486;
                                int64_t heshi_tmp_172566 = loopres_168400;
                                int64_t step_tmp_172567 = loopres_168401;
                                
                                loop_while_168338 = loop_while_tmp_172565;
                                heshi_168339 = heshi_tmp_172566;
                                step_168340 = step_tmp_172567;
                            }
                            bsearch_168335 = loop_while_168338;
                            bsearch_168336 = heshi_168339;
                            bsearch_168337 = step_168340;
                            defunc_res_f_res_168330 = bsearch_168336;
                        }
                        defunc_res_168327 = defunc_res_f_res_168330;
                    }
                    
                    bool cond_168487 = sle64(defunc_res_168327, (int64_t) 0);
                    int64_t inf_168488;
                    
                    if (cond_168487) {
                        inf_168488 = (int64_t) 0;
                    } else {
                        bool x_168489 = sle64((int64_t) 0, defunc_res_168327);
                        bool y_168490 = slt64(defunc_res_168327, dz2081U_143596);
                        bool bounds_check_168491 = x_168489 && y_168490;
                        bool index_certs_168492;
                        
                        if (!bounds_check_168491) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_168327, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:931:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-988:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_168493 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_168327];
                        
                        inf_168488 = inf_f_res_168493;
                    }
                    
                    bool cond_168494 = defunc_res_168327 == zeze_rhs_159252;
                    int64_t sup_168495;
                    
                    if (cond_168494) {
                        sup_168495 = nS_143595;
                    } else {
                        int64_t tmp_168496 = add64((int64_t) 1, defunc_res_168327);
                        bool x_168497 = sle64((int64_t) 0, tmp_168496);
                        bool y_168498 = slt64(tmp_168496, dz2081U_143596);
                        bool bounds_check_168499 = x_168497 && y_168498;
                        bool index_certs_168500;
                        
                        if (!bounds_check_168499) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_168496, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:932:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-988:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_168501 = ((int64_t *) bounds_mem_171820.mem)[tmp_168496];
                        
                        sup_168495 = sup_f_res_168501;
                    }
                    
                    bool cond_168502 = slt64(inf_168488, sup_168495);
                    bool sm_168503;
                    int64_t sm_168504;
                    bool loop_while_168505;
                    int64_t j_168506;
                    
                    loop_while_168505 = cond_168502;
                    j_168506 = inf_168488;
                    while (loop_while_168505) {
                        bool x_168507 = sle64((int64_t) 0, j_168506);
                        bool y_168508 = slt64(j_168506, nS_143595);
                        bool bounds_check_168509 = x_168507 && y_168508;
                        bool index_certs_168510;
                        
                        if (!bounds_check_168509) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_168506, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:935:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-988:78\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t zeze_rhs_168511 = ((int32_t *) mem_171879)[j_168506];
                        bool is_eq_168512 = defunc_0_byteSeq_to_prim_res_168304 == zeze_rhs_168511;
                        int64_t loopres_168513;
                        
                        if (is_eq_168512) {
                            loopres_168513 = j_168506;
                        } else {
                            int64_t tmp_168514 = add64((int64_t) 1, j_168506);
                            
                            loopres_168513 = tmp_168514;
                        }
                        
                        bool cond_168515 = slt64(loopres_168513, sup_168495);
                        bool loop_cond_t_res_168516 = !is_eq_168512;
                        bool x_168517 = cond_168515 && loop_cond_t_res_168516;
                        bool loop_while_tmp_172577 = x_168517;
                        int64_t j_tmp_172578 = loopres_168513;
                        
                        loop_while_168505 = loop_while_tmp_172577;
                        j_168506 = j_tmp_172578;
                    }
                    sm_168503 = loop_while_168505;
                    sm_168504 = j_168506;
                    
                    bool cond_168518 = slt64(sm_168504, sup_168495);
                    int64_t lifted_lambda_res_168519;
                    
                    if (cond_168518) {
                        lifted_lambda_res_168519 = sm_168504;
                    } else {
                        lifted_lambda_res_168519 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_168520 = sle64((int64_t) 0, lifted_lambda_res_168519);
                    int64_t bool_res_168521 = btoi_bool_i64(lifted_lambda_res_168520);
                    int64_t defunc_0_op_res_168526 = add64(bool_res_168521, scanacc_171601);
                    int64_t zp_res_168529 = add64(bool_res_168521, redout_171603);
                    
                    ((int64_t *) mem_171887)[i_171605] = defunc_0_op_res_168526;
                    ((int64_t *) mem_171889)[i_171605] = lifted_lambda_res_168519;
                    
                    int64_t scanacc_tmp_172560 = defunc_0_op_res_168526;
                    int64_t redout_tmp_172562 = zp_res_168529;
                    
                    scanacc_171601 = scanacc_tmp_172560;
                    redout_171603 = redout_tmp_172562;
                }
                discard_171608 = scanacc_171601;
                defunc_res_168301 = redout_171603;
                
                int64_t bytes_171902 = (int64_t) 8 * defunc_res_168301;
                int64_t bytes_171919 = b_143594 * defunc_res_168301;
                
                if (memblock_alloc(ctx, &mem_171903, bytes_171902, "mem_171903")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172579 = 0; nest_i_172579 < defunc_res_168301; nest_i_172579++) {
                    ((int64_t *) mem_171903.mem)[nest_i_172579] = (int64_t) -1;
                }
                if (memblock_alloc(ctx, &mem_171905, bytes_171902, "mem_171905")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172580 = 0; nest_i_172580 < defunc_res_168301; nest_i_172580++) {
                    ((int64_t *) mem_171905.mem)[nest_i_172580] = (int64_t) -1;
                }
                for (int64_t write_iter_171609 = 0; write_iter_171609 < nR_143593; write_iter_171609++) {
                    int64_t write_iv_171613 = ((int64_t *) mem_171889)[write_iter_171609];
                    int64_t zv_lhs_168549 = add64((int64_t) -1, write_iter_171609);
                    int64_t tmp_168550 = smod64(zv_lhs_168549, nR_143593);
                    int64_t lifted_lambda_res_168551 = ((int64_t *) mem_171887)[tmp_168550];
                    bool cond_168552 = write_iter_171609 == (int64_t) 0;
                    int64_t lifted_lambda_res_168553;
                    
                    if (cond_168552) {
                        lifted_lambda_res_168553 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_168553 = lifted_lambda_res_168551;
                    }
                    
                    bool cond_168554 = sle64((int64_t) 0, write_iv_171613);
                    int64_t lifted_lambda_res_168555;
                    
                    if (cond_168554) {
                        lifted_lambda_res_168555 = lifted_lambda_res_168553;
                    } else {
                        lifted_lambda_res_168555 = (int64_t) -1;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_168555) && slt64(lifted_lambda_res_168555, defunc_res_168301)) {
                        ((int64_t *) mem_171903.mem)[lifted_lambda_res_168555] = write_iv_171613;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_168555) && slt64(lifted_lambda_res_168555, defunc_res_168301)) {
                        ((int64_t *) mem_171905.mem)[lifted_lambda_res_168555] = write_iter_171609;
                    }
                }
                if (memblock_alloc(ctx, &mem_171918, b_143594, "mem_171918")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172583 = 0; nest_i_172583 < b_143594; nest_i_172583++) {
                    ((int8_t *) mem_171918.mem)[nest_i_172583] = (int8_t) 0;
                }
                if (memblock_alloc(ctx, &mem_171920, bytes_171919, "mem_171920")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171618 = 0; i_171618 < defunc_res_168301; i_171618++) {
                    int64_t eta_p_168566 = ((int64_t *) mem_171905.mem)[i_171618];
                    bool cond_168567 = sle64((int64_t) 0, eta_p_168566);
                    bool cond_t_res_168568 = slt64(eta_p_168566, nR_143593);
                    bool x_168569 = cond_168567 && cond_t_res_168568;
                    int64_t lmad_ext_171925 = b_143594 * eta_p_168566;
                    int64_t ext_171926;
                    
                    if (x_168569) {
                        ext_171926 = lmad_ext_171925;
                    } else {
                        ext_171926 = (int64_t) 0;
                    }
                    if (x_168569) {
                        bool index_certs_168571;
                        
                        if (!x_168569) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_168566, "] out of bounds for array of shape [", (long long) nR_143593, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (memblock_set(ctx, &ext_mem_171927, &pR_mem_171818, "pR_mem_171818") != 0)
                            return 1;
                    } else if (memblock_set(ctx, &ext_mem_171927, &mem_171918, "mem_171918") != 0)
                        return 1;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171920.mem, i_171618 * b_143594, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171927.mem, ext_171926, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143594});
                    if (memblock_unref(ctx, &ext_mem_171927, "ext_mem_171927") != 0)
                        return 1;
                }
                if (memblock_unref(ctx, &mem_171918, "mem_171918") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171941, &mem_171905, "mem_171905") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171938, &mem_171903, "mem_171903") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171935, &mem_171920, "mem_171920") != 0)
                    return 1;
                radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775 = defunc_res_168301;
            } else {
                if (mem_171825_cached_sizze_172736 < bytes_171824) {
                    err = lexical_realloc(ctx, &mem_171825, &mem_171825_cached_sizze_172736, bytes_171824);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                for (int64_t i_171622 = 0; i_171622 < nS_143595; i_171622++) {
                    int64_t defunc_0_byteSeq_to_prim_res_162450;
                    int64_t y_162452 = (int64_t) 0;
                    
                    for (int64_t i_162451 = 0; i_162451 < b_143594; i_162451++) {
                        int64_t zm_lhs_162453 = sub64(b_143594, i_162451);
                        int64_t from_u8_arg0_162454 = sub64(zm_lhs_162453, (int64_t) 1);
                        bool x_162455 = sle64((int64_t) 0, from_u8_arg0_162454);
                        bool y_162456 = slt64(from_u8_arg0_162454, b_143594);
                        bool bounds_check_162457 = x_162455 && y_162456;
                        bool index_certs_162458;
                        
                        if (!bounds_check_162457) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_162454, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:429:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_162459 = ((int8_t *) pS_mem_171819.mem)[i_171622 * b_143594 + from_u8_arg0_162454];
                        int64_t u8_res_162460 = zext_i8_i64(from_u8_arg0_162459);
                        int32_t i64_res_162461 = sext_i64_i32(i_162451);
                        int32_t shift_left_rhs_162462 = mul32(8, i64_res_162461);
                        int64_t unsign_arg0_162463 = zext_i32_i64(shift_left_rhs_162462);
                        int64_t lifted_lambda_res_162464 = shl64(u8_res_162460, unsign_arg0_162463);
                        int64_t unsign_arg0_162465 = y_162452 | lifted_lambda_res_162464;
                        int64_t y_tmp_172586 = unsign_arg0_162465;
                        
                        y_162452 = y_tmp_172586;
                    }
                    defunc_0_byteSeq_to_prim_res_162450 = y_162452;
                    ((int64_t *) mem_171825)[i_171622] = defunc_0_byteSeq_to_prim_res_162450;
                }
                if (mem_171833_cached_sizze_172737 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171833, &mem_171833_cached_sizze_172737, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                if (mem_171835_cached_sizze_172738 < bytes_171832) {
                    err = lexical_realloc(ctx, &mem_171835, &mem_171835_cached_sizze_172738, bytes_171832);
                    if (err != FUTHARK_SUCCESS)
                        goto cleanup;
                }
                
                int64_t discard_171633;
                int64_t defunc_res_168610;
                int64_t scanacc_171626;
                int64_t redout_171628;
                
                scanacc_171626 = (int64_t) 0;
                redout_171628 = (int64_t) 0;
                for (int64_t i_171630 = 0; i_171630 < nR_143593; i_171630++) {
                    int64_t defunc_0_byteSeq_to_prim_res_166191;
                    int64_t y_166193 = (int64_t) 0;
                    
                    for (int64_t i_166192 = 0; i_166192 < b_143594; i_166192++) {
                        int64_t zm_lhs_166194 = sub64(b_143594, i_166192);
                        int64_t from_u8_arg0_166195 = sub64(zm_lhs_166194, (int64_t) 1);
                        bool x_166196 = sle64((int64_t) 0, from_u8_arg0_166195);
                        bool y_166197 = slt64(from_u8_arg0_166195, b_143594);
                        bool bounds_check_166198 = x_166196 && y_166197;
                        bool index_certs_166199;
                        
                        if (!bounds_check_166198) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) from_u8_arg0_166195, "] out of bounds for array of shape [", (long long) b_143594, "].", "-> #0  ftHashJoin.fut:419:24-32\n   #1  ftHashJoin.fut:429:77-84\n   #2  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int8_t from_u8_arg0_166200 = ((int8_t *) pR_mem_171818.mem)[i_171630 * b_143594 + from_u8_arg0_166195];
                        int64_t u8_res_166201 = zext_i8_i64(from_u8_arg0_166200);
                        int32_t i64_res_166202 = sext_i64_i32(i_166192);
                        int32_t shift_left_rhs_166203 = mul32(8, i64_res_166202);
                        int64_t unsign_arg0_166204 = zext_i32_i64(shift_left_rhs_166203);
                        int64_t lifted_lambda_res_166205 = shl64(u8_res_166201, unsign_arg0_166204);
                        int64_t unsign_arg0_166206 = y_166193 | lifted_lambda_res_166205;
                        int64_t y_tmp_172591 = unsign_arg0_166206;
                        
                        y_166193 = y_tmp_172591;
                    }
                    defunc_0_byteSeq_to_prim_res_166191 = y_166193;
                    
                    int64_t lifted_lambda_res_166208 = u64_arg0_159251 & defunc_0_byteSeq_to_prim_res_166191;
                    bool x_166209 = sle64((int64_t) 0, lifted_lambda_res_166208);
                    bool y_166210 = slt64(lifted_lambda_res_166208, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597);
                    bool bounds_check_166211 = x_166209 && y_166210;
                    bool index_certs_166212;
                    
                    if (!bounds_check_166211) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_166208, "] out of bounds for array of shape [", (long long) dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, "].", "-> #0  ftHashJoin.fut:532:15-37\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t spi_166213 = ((int64_t *) first_info_idx_mem_171822.mem)[lifted_lambda_res_166208];
                    bool cond_166214 = slt64(spi_166213, (int64_t) 0);
                    int64_t defunc_res_166215;
                    
                    if (cond_166214) {
                        defunc_res_166215 = (int64_t) -1;
                    } else {
                        int64_t zeze_rhs_166216 = ((int64_t *) last_info_idx_mem_171823.mem)[lifted_lambda_res_166208];
                        bool cond_166217 = spi_166213 == zeze_rhs_166216;
                        int64_t defunc_res_f_res_166218;
                        
                        if (cond_166217) {
                            defunc_res_f_res_166218 = spi_166213;
                        } else {
                            int64_t zs_lhs_166219 = sub64(zeze_rhs_166216, spi_166213);
                            int64_t max_arg1_166220 = sdiv64(zs_lhs_166219, (int64_t) 2);
                            int64_t max_res_166221 = smax64((int64_t) 1, max_arg1_166220);
                            bool loop_cond_166222 = slt64((int64_t) 0, max_res_166221);
                            bool bsearch_166223;
                            int64_t bsearch_166224;
                            int64_t bsearch_166225;
                            bool loop_while_166226;
                            int64_t heshi_166227;
                            int64_t step_166228;
                            
                            loop_while_166226 = loop_cond_166222;
                            heshi_166227 = spi_166213;
                            step_166228 = max_res_166221;
                            while (loop_while_166226) {
                                bool x_166229 = sle64((int64_t) 0, heshi_166227);
                                bool y_166230 = slt64(heshi_166227, dz2081U_143596);
                                bool bounds_check_166231 = x_166229 && y_166230;
                                bool index_certs_166232;
                                
                                if (!bounds_check_166231) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) heshi_166227, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:541:27-42\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t cur_S_166250 = ((int64_t *) bounds_mem_171820.mem)[heshi_166227];
                                bool x_166251 = sle64((int64_t) 0, cur_S_166250);
                                bool y_166252 = slt64(cur_S_166250, nS_143595);
                                bool bounds_check_166253 = x_166251 && y_166252;
                                bool index_certs_166254;
                                
                                if (!bounds_check_166253) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) cur_S_166250, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:544:23-42\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int32_t cur_depth_166233 = ((int32_t *) depths_mem_171821.mem)[heshi_166227];
                                bool cond_166234 = heshi_166227 == spi_166213;
                                int32_t prev_depth_166235;
                                
                                if (cond_166234) {
                                    prev_depth_166235 = cur_depth_166233;
                                } else {
                                    int64_t tmp_166236 = sub64(heshi_166227, (int64_t) 1);
                                    bool x_166237 = sle64((int64_t) 0, tmp_166236);
                                    bool y_166238 = slt64(tmp_166236, dz2081U_143596);
                                    bool bounds_check_166239 = x_166237 && y_166238;
                                    bool index_certs_166240;
                                    
                                    if (!bounds_check_166239) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166236, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:542:62-79\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t prev_depth_f_res_166241 = ((int32_t *) depths_mem_171821.mem)[tmp_166236];
                                    
                                    prev_depth_166235 = prev_depth_f_res_166241;
                                }
                                
                                bool cond_166242 = heshi_166227 == zeze_rhs_166216;
                                int32_t next_depth_166243;
                                
                                if (cond_166242) {
                                    next_depth_166243 = cur_depth_166233;
                                } else {
                                    int64_t tmp_166244 = add64((int64_t) 1, heshi_166227);
                                    bool x_166245 = sle64((int64_t) 0, tmp_166244);
                                    bool y_166246 = slt64(tmp_166244, dz2081U_143596);
                                    bool bounds_check_166247 = x_166245 && y_166246;
                                    bool index_certs_166248;
                                    
                                    if (!bounds_check_166247) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166244, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:543:66-83\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int32_t next_depth_f_res_166249 = ((int32_t *) depths_mem_171821.mem)[tmp_166244];
                                    
                                    next_depth_166243 = next_depth_f_res_166249;
                                }
                                
                                int64_t cur_S_166255 = ((int64_t *) mem_171825)[cur_S_166250];
                                int64_t prev_S_166256;
                                
                                if (cond_166234) {
                                    prev_S_166256 = cur_S_166255;
                                } else {
                                    int64_t tmp_166257 = sub64(heshi_166227, (int64_t) 1);
                                    bool x_166258 = sle64((int64_t) 0, tmp_166257);
                                    bool y_166259 = slt64(tmp_166257, dz2081U_143596);
                                    bool bounds_check_166260 = x_166258 && y_166259;
                                    bool index_certs_166261;
                                    
                                    if (!bounds_check_166260) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166257, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:545:57-74\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_166262 = ((int64_t *) bounds_mem_171820.mem)[tmp_166257];
                                    bool x_166263 = sle64((int64_t) 0, tmp_166262);
                                    bool y_166264 = slt64(tmp_166262, nS_143595);
                                    bool bounds_check_166265 = x_166263 && y_166264;
                                    bool index_certs_166266;
                                    
                                    if (!bounds_check_166265) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166262, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:545:54-75\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t prev_S_f_res_166267 = ((int64_t *) mem_171825)[tmp_166262];
                                    
                                    prev_S_166256 = prev_S_f_res_166267;
                                }
                                
                                int64_t next_S_166268;
                                
                                if (cond_166242) {
                                    next_S_166268 = cur_S_166255;
                                } else {
                                    int64_t tmp_166269 = add64((int64_t) 1, heshi_166227);
                                    bool x_166270 = sle64((int64_t) 0, tmp_166269);
                                    bool y_166271 = slt64(tmp_166269, dz2081U_143596);
                                    bool bounds_check_166272 = x_166270 && y_166271;
                                    bool index_certs_166273;
                                    
                                    if (!bounds_check_166272) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166269, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:546:61-78\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t tmp_166274 = ((int64_t *) bounds_mem_171820.mem)[tmp_166269];
                                    bool x_166275 = sle64((int64_t) 0, tmp_166274);
                                    bool y_166276 = slt64(tmp_166274, nS_143595);
                                    bool bounds_check_166277 = x_166275 && y_166276;
                                    bool index_certs_166278;
                                    
                                    if (!bounds_check_166277) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166274, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:546:58-79\n   #1  ftHashJoin.fut:953:6-960:89\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftHashJoin.fut:983:6-989:65\n   #4  ftRelational.fut:282:6-285:56\n   #5  ftRelational.fut:278:3-285:75\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t next_S_f_res_166279 = ((int64_t *) mem_171825)[tmp_166274];
                                    
                                    next_S_166268 = next_S_f_res_166279;
                                }
                                
                                int32_t prim_get_radix_arg0_166280 = mul32(radix_sizze_143598, cur_depth_166233);
                                int64_t unsign_arg0_166281 = zext_i32_i64(prim_get_radix_arg0_166280);
                                int64_t asPow_166282 = shl64((int64_t) 1, unsign_arg0_166281);
                                int64_t za_rhs_166283 = sub64(asPow_166282, (int64_t) 1);
                                int64_t lifted_lambda_res_166284 = defunc_0_byteSeq_to_prim_res_166191 & za_rhs_166283;
                                int64_t lifted_lambda_res_166285 = cur_S_166255 & za_rhs_166283;
                                bool defunc_0_eq_res_166286 = lifted_lambda_res_166284 == lifted_lambda_res_166285;
                                int64_t loopres_166287;
                                int64_t loopres_166288;
                                
                                if (defunc_0_eq_res_166286) {
                                    loopres_166287 = heshi_166227;
                                    loopres_166288 = (int64_t) 0;
                                } else {
                                    bool loop_cond_t_res_166289 = slt32(0, cur_depth_166233);
                                    bool is_lt_166290;
                                    bool is_lt_166291;
                                    int32_t is_lt_166292;
                                    bool loop_while_166293;
                                    bool def_lt_166294;
                                    int32_t bi_166295;
                                    
                                    loop_while_166293 = loop_cond_t_res_166289;
                                    def_lt_166294 = 0;
                                    bi_166295 = 0;
                                    while (loop_while_166293) {
                                        int32_t zt_rhs_166296 = add32(1, bi_166295);
                                        int32_t prim_get_radix_arg0_166297 = mul32(radix_sizze_143598, zt_rhs_166296);
                                        int64_t unsign_arg0_166298 = zext_i32_i64(prim_get_radix_arg0_166297);
                                        int64_t asPow_166299 = shl64((int64_t) 1, unsign_arg0_166298);
                                        int64_t za_rhs_166300 = sub64(asPow_166299, (int64_t) 1);
                                        int64_t lifted_lambda_res_166301 = defunc_0_byteSeq_to_prim_res_166191 & za_rhs_166300;
                                        int64_t lifted_lambda_res_166302 = cur_S_166255 & za_rhs_166300;
                                        bool defunc_0_lt_res_166303 = ult64(lifted_lambda_res_166301, lifted_lambda_res_166302);
                                        bool defunc_0_lt_res_166304 = ult64(lifted_lambda_res_166302, lifted_lambda_res_166301);
                                        bool cond_166305 = !defunc_0_lt_res_166304;
                                        bool cond_t_res_166306 = !defunc_0_lt_res_166303;
                                        bool x_166307 = cond_166305 && cond_t_res_166306;
                                        bool loop_cond_t_res_166308 = slt32(zt_rhs_166296, cur_depth_166233);
                                        bool x_166309 = x_166307 && loop_cond_t_res_166308;
                                        bool loop_while_tmp_172595 = x_166309;
                                        bool def_lt_tmp_172596 = defunc_0_lt_res_166303;
                                        int32_t bi_tmp_172597 = zt_rhs_166296;
                                        
                                        loop_while_166293 = loop_while_tmp_172595;
                                        def_lt_166294 = def_lt_tmp_172596;
                                        bi_166295 = bi_tmp_172597;
                                    }
                                    is_lt_166290 = loop_while_166293;
                                    is_lt_166291 = def_lt_166294;
                                    is_lt_166292 = bi_166295;
                                    
                                    int64_t loopres_f_res_166310;
                                    int64_t loopres_f_res_166311;
                                    
                                    if (is_lt_166291) {
                                        bool loop_cond_t_res_168577 = slt32(0, prev_depth_166235);
                                        bool is_gt_168578;
                                        bool is_gt_168579;
                                        int32_t is_gt_168580;
                                        bool loop_while_168581;
                                        bool def_gt_168582;
                                        int32_t bi_168583;
                                        
                                        loop_while_168581 = loop_cond_t_res_168577;
                                        def_gt_168582 = 0;
                                        bi_168583 = 0;
                                        while (loop_while_168581) {
                                            int32_t zt_rhs_168584 = add32(1, bi_168583);
                                            int32_t prim_get_radix_arg0_168585 = mul32(radix_sizze_143598, zt_rhs_168584);
                                            int64_t unsign_arg0_168586 = zext_i32_i64(prim_get_radix_arg0_168585);
                                            int64_t asPow_168587 = shl64((int64_t) 1, unsign_arg0_168586);
                                            int64_t za_rhs_168588 = sub64(asPow_168587, (int64_t) 1);
                                            int64_t lifted_lambda_res_168589 = defunc_0_byteSeq_to_prim_res_166191 & za_rhs_168588;
                                            int64_t lifted_lambda_res_168590 = prev_S_166256 & za_rhs_168588;
                                            bool defunc_0_gt_res_168591 = ult64(lifted_lambda_res_168590, lifted_lambda_res_168589);
                                            bool defunc_0_gt_res_168592 = ult64(lifted_lambda_res_168589, lifted_lambda_res_168590);
                                            bool cond_168593 = !defunc_0_gt_res_168591;
                                            bool cond_t_res_168594 = !defunc_0_gt_res_168592;
                                            bool x_168595 = cond_168593 && cond_t_res_168594;
                                            bool loop_cond_t_res_168596 = slt32(zt_rhs_168584, prev_depth_166235);
                                            bool x_168597 = x_168595 && loop_cond_t_res_168596;
                                            bool loop_while_tmp_172598 = x_168597;
                                            bool def_gt_tmp_172599 = defunc_0_gt_res_168591;
                                            int32_t bi_tmp_172600 = zt_rhs_168584;
                                            
                                            loop_while_168581 = loop_while_tmp_172598;
                                            def_gt_168582 = def_gt_tmp_172599;
                                            bi_168583 = bi_tmp_172600;
                                        }
                                        is_gt_168578 = loop_while_168581;
                                        is_gt_168579 = def_gt_168582;
                                        is_gt_168580 = bi_168583;
                                        
                                        bool x_168598 = !cond_166234;
                                        bool y_168599 = is_gt_168579 && x_168598;
                                        bool cond_168600 = cond_166234 || y_168599;
                                        int64_t loopres_f_res_t_res_168601;
                                        int64_t loopres_f_res_t_res_168602;
                                        
                                        if (cond_168600) {
                                            loopres_f_res_t_res_168601 = (int64_t) -1;
                                            loopres_f_res_t_res_168602 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_168603 = sub64(heshi_166227, step_166228);
                                            int64_t max_arg1_168604 = sdiv64(step_166228, (int64_t) 2);
                                            int64_t max_res_168605 = smax64((int64_t) 1, max_arg1_168604);
                                            
                                            loopres_f_res_t_res_168601 = tmp_168603;
                                            loopres_f_res_t_res_168602 = max_res_168605;
                                        }
                                        loopres_f_res_166310 = loopres_f_res_t_res_168601;
                                        loopres_f_res_166311 = loopres_f_res_t_res_168602;
                                    } else {
                                        bool loop_cond_t_res_166341 = slt32(0, next_depth_166243);
                                        bool is_lt_166342;
                                        bool is_lt_166343;
                                        int32_t is_lt_166344;
                                        bool loop_while_166345;
                                        bool def_lt_166346;
                                        int32_t bi_166347;
                                        
                                        loop_while_166345 = loop_cond_t_res_166341;
                                        def_lt_166346 = 0;
                                        bi_166347 = 0;
                                        while (loop_while_166345) {
                                            int32_t zt_rhs_166348 = add32(1, bi_166347);
                                            int32_t prim_get_radix_arg0_166349 = mul32(radix_sizze_143598, zt_rhs_166348);
                                            int64_t unsign_arg0_166350 = zext_i32_i64(prim_get_radix_arg0_166349);
                                            int64_t asPow_166351 = shl64((int64_t) 1, unsign_arg0_166350);
                                            int64_t za_rhs_166352 = sub64(asPow_166351, (int64_t) 1);
                                            int64_t lifted_lambda_res_166353 = defunc_0_byteSeq_to_prim_res_166191 & za_rhs_166352;
                                            int64_t lifted_lambda_res_166354 = next_S_166268 & za_rhs_166352;
                                            bool defunc_0_lt_res_166355 = ult64(lifted_lambda_res_166353, lifted_lambda_res_166354);
                                            bool defunc_0_lt_res_166356 = ult64(lifted_lambda_res_166354, lifted_lambda_res_166353);
                                            bool cond_166357 = !defunc_0_lt_res_166356;
                                            bool cond_t_res_166358 = !defunc_0_lt_res_166355;
                                            bool x_166359 = cond_166357 && cond_t_res_166358;
                                            bool loop_cond_t_res_166360 = slt32(zt_rhs_166348, next_depth_166243);
                                            bool x_166361 = x_166359 && loop_cond_t_res_166360;
                                            bool loop_while_tmp_172601 = x_166361;
                                            bool def_lt_tmp_172602 = defunc_0_lt_res_166355;
                                            int32_t bi_tmp_172603 = zt_rhs_166348;
                                            
                                            loop_while_166345 = loop_while_tmp_172601;
                                            def_lt_166346 = def_lt_tmp_172602;
                                            bi_166347 = bi_tmp_172603;
                                        }
                                        is_lt_166342 = loop_while_166345;
                                        is_lt_166343 = def_lt_166346;
                                        is_lt_166344 = bi_166347;
                                        
                                        bool x_166362 = !cond_166242;
                                        bool y_166363 = is_lt_166343 && x_166362;
                                        bool cond_166364 = cond_166242 || y_166363;
                                        int64_t loopres_f_res_f_res_166365;
                                        int64_t loopres_f_res_f_res_166366;
                                        
                                        if (cond_166364) {
                                            loopres_f_res_f_res_166365 = (int64_t) -1;
                                            loopres_f_res_f_res_166366 = (int64_t) 0;
                                        } else {
                                            int64_t tmp_166367 = add64(heshi_166227, step_166228);
                                            int64_t max_arg1_166368 = sdiv64(step_166228, (int64_t) 2);
                                            int64_t max_res_166369 = smax64((int64_t) 1, max_arg1_166368);
                                            
                                            loopres_f_res_f_res_166365 = tmp_166367;
                                            loopres_f_res_f_res_166366 = max_res_166369;
                                        }
                                        loopres_f_res_166310 = loopres_f_res_f_res_166365;
                                        loopres_f_res_166311 = loopres_f_res_f_res_166366;
                                    }
                                    loopres_166287 = loopres_f_res_166310;
                                    loopres_166288 = loopres_f_res_166311;
                                }
                                
                                bool loop_cond_166370 = slt64((int64_t) 0, loopres_166288);
                                bool loop_while_tmp_172592 = loop_cond_166370;
                                int64_t heshi_tmp_172593 = loopres_166287;
                                int64_t step_tmp_172594 = loopres_166288;
                                
                                loop_while_166226 = loop_while_tmp_172592;
                                heshi_166227 = heshi_tmp_172593;
                                step_166228 = step_tmp_172594;
                            }
                            bsearch_166223 = loop_while_166226;
                            bsearch_166224 = heshi_166227;
                            bsearch_166225 = step_166228;
                            defunc_res_f_res_166218 = bsearch_166224;
                        }
                        defunc_res_166215 = defunc_res_f_res_166218;
                    }
                    
                    bool cond_166371 = sle64(defunc_res_166215, (int64_t) 0);
                    int64_t inf_166372;
                    
                    if (cond_166371) {
                        inf_166372 = (int64_t) 0;
                    } else {
                        bool x_166373 = sle64((int64_t) 0, defunc_res_166215);
                        bool y_166374 = slt64(defunc_res_166215, dz2081U_143596);
                        bool bounds_check_166375 = x_166373 && y_166374;
                        bool index_certs_166376;
                        
                        if (!bounds_check_166375) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_res_166215, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:961:43-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-989:65\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t inf_f_res_166377 = ((int64_t *) bounds_mem_171820.mem)[defunc_res_166215];
                        
                        inf_166372 = inf_f_res_166377;
                    }
                    
                    bool cond_166378 = defunc_res_166215 == zeze_rhs_159252;
                    int64_t sup_166379;
                    
                    if (cond_166378) {
                        sup_166379 = nS_143595;
                    } else {
                        int64_t tmp_166380 = add64((int64_t) 1, defunc_res_166215);
                        bool x_166381 = sle64((int64_t) 0, tmp_166380);
                        bool y_166382 = slt64(tmp_166380, dz2081U_143596);
                        bool bounds_check_166383 = x_166381 && y_166382;
                        bool index_certs_166384;
                        
                        if (!bounds_check_166383) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_166380, "] out of bounds for array of shape [", (long long) dz2081U_143596, "].", "-> #0  ftHashJoin.fut:962:49-67\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-989:65\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t sup_f_res_166385 = ((int64_t *) bounds_mem_171820.mem)[tmp_166380];
                        
                        sup_166379 = sup_f_res_166385;
                    }
                    
                    bool cond_166386 = slt64(inf_166372, sup_166379);
                    bool sm_166387;
                    int64_t sm_166388;
                    bool loop_while_166389;
                    int64_t j_166390;
                    
                    loop_while_166389 = cond_166386;
                    j_166390 = inf_166372;
                    while (loop_while_166389) {
                        bool x_166391 = sle64((int64_t) 0, j_166390);
                        bool y_166392 = slt64(j_166390, nS_143595);
                        bool bounds_check_166393 = x_166391 && y_166392;
                        bool index_certs_166394;
                        
                        if (!bounds_check_166393) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_166390, "] out of bounds for array of shape [", (long long) nS_143595, "].", "-> #0  ftHashJoin.fut:965:31-40\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:983:6-989:65\n   #3  ftRelational.fut:282:6-285:56\n   #4  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t zeze_rhs_166395 = ((int64_t *) mem_171825)[j_166390];
                        bool is_eq_166396 = defunc_0_byteSeq_to_prim_res_166191 == zeze_rhs_166395;
                        int64_t loopres_166397;
                        
                        if (is_eq_166396) {
                            loopres_166397 = j_166390;
                        } else {
                            int64_t tmp_166398 = add64((int64_t) 1, j_166390);
                            
                            loopres_166397 = tmp_166398;
                        }
                        
                        bool cond_166399 = slt64(loopres_166397, sup_166379);
                        bool loop_cond_t_res_166400 = !is_eq_166396;
                        bool x_166401 = cond_166399 && loop_cond_t_res_166400;
                        bool loop_while_tmp_172604 = x_166401;
                        int64_t j_tmp_172605 = loopres_166397;
                        
                        loop_while_166389 = loop_while_tmp_172604;
                        j_166390 = j_tmp_172605;
                    }
                    sm_166387 = loop_while_166389;
                    sm_166388 = j_166390;
                    
                    bool cond_166402 = slt64(sm_166388, sup_166379);
                    int64_t lifted_lambda_res_166403;
                    
                    if (cond_166402) {
                        lifted_lambda_res_166403 = sm_166388;
                    } else {
                        lifted_lambda_res_166403 = (int64_t) -1;
                    }
                    
                    bool lifted_lambda_res_166405 = sle64((int64_t) 0, lifted_lambda_res_166403);
                    int64_t bool_res_166406 = btoi_bool_i64(lifted_lambda_res_166405);
                    int64_t defunc_0_op_res_160253 = add64(bool_res_166406, scanacc_171626);
                    int64_t zp_res_160244 = add64(bool_res_166406, redout_171628);
                    
                    ((int64_t *) mem_171833)[i_171630] = defunc_0_op_res_160253;
                    ((int64_t *) mem_171835)[i_171630] = lifted_lambda_res_166403;
                    
                    int64_t scanacc_tmp_172587 = defunc_0_op_res_160253;
                    int64_t redout_tmp_172589 = zp_res_160244;
                    
                    scanacc_171626 = scanacc_tmp_172587;
                    redout_171628 = redout_tmp_172589;
                }
                discard_171633 = scanacc_171626;
                defunc_res_168610 = redout_171628;
                
                int64_t bytes_171848 = (int64_t) 8 * defunc_res_168610;
                int64_t bytes_171865 = b_143594 * defunc_res_168610;
                
                if (memblock_alloc(ctx, &mem_171849, bytes_171848, "mem_171849")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172606 = 0; nest_i_172606 < defunc_res_168610; nest_i_172606++) {
                    ((int64_t *) mem_171849.mem)[nest_i_172606] = (int64_t) -1;
                }
                if (memblock_alloc(ctx, &mem_171851, bytes_171848, "mem_171851")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172607 = 0; nest_i_172607 < defunc_res_168610; nest_i_172607++) {
                    ((int64_t *) mem_171851.mem)[nest_i_172607] = (int64_t) -1;
                }
                for (int64_t write_iter_171634 = 0; write_iter_171634 < nR_143593; write_iter_171634++) {
                    int64_t write_iv_171638 = ((int64_t *) mem_171835)[write_iter_171634];
                    int64_t zv_lhs_166453 = add64((int64_t) -1, write_iter_171634);
                    int64_t tmp_166454 = smod64(zv_lhs_166453, nR_143593);
                    int64_t lifted_lambda_res_166455 = ((int64_t *) mem_171833)[tmp_166454];
                    bool cond_166456 = write_iter_171634 == (int64_t) 0;
                    int64_t lifted_lambda_res_166457;
                    
                    if (cond_166456) {
                        lifted_lambda_res_166457 = (int64_t) 0;
                    } else {
                        lifted_lambda_res_166457 = lifted_lambda_res_166455;
                    }
                    
                    bool cond_166458 = sle64((int64_t) 0, write_iv_171638);
                    int64_t lifted_lambda_res_166459;
                    
                    if (cond_166458) {
                        lifted_lambda_res_166459 = lifted_lambda_res_166457;
                    } else {
                        lifted_lambda_res_166459 = (int64_t) -1;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_166459) && slt64(lifted_lambda_res_166459, defunc_res_168610)) {
                        ((int64_t *) mem_171849.mem)[lifted_lambda_res_166459] = write_iv_171638;
                    }
                    if (sle64((int64_t) 0, lifted_lambda_res_166459) && slt64(lifted_lambda_res_166459, defunc_res_168610)) {
                        ((int64_t *) mem_171851.mem)[lifted_lambda_res_166459] = write_iter_171634;
                    }
                }
                if (memblock_alloc(ctx, &mem_171864, b_143594, "mem_171864")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t nest_i_172610 = 0; nest_i_172610 < b_143594; nest_i_172610++) {
                    ((int8_t *) mem_171864.mem)[nest_i_172610] = (int8_t) 0;
                }
                if (memblock_alloc(ctx, &mem_171866, bytes_171865, "mem_171866")) {
                    err = 1;
                    goto cleanup;
                }
                for (int64_t i_171643 = 0; i_171643 < defunc_res_168610; i_171643++) {
                    int64_t eta_p_162473 = ((int64_t *) mem_171851.mem)[i_171643];
                    bool cond_162474 = sle64((int64_t) 0, eta_p_162473);
                    bool cond_t_res_162475 = slt64(eta_p_162473, nR_143593);
                    bool x_162476 = cond_162474 && cond_t_res_162475;
                    int64_t lmad_ext_171871 = b_143594 * eta_p_162473;
                    int64_t ext_171872;
                    
                    if (x_162476) {
                        ext_171872 = lmad_ext_171871;
                    } else {
                        ext_171872 = (int64_t) 0;
                    }
                    if (x_162476) {
                        bool index_certs_168606;
                        
                        if (!x_162476) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162473, "] out of bounds for array of shape [", (long long) nR_143593, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:278:3-285:75\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        if (memblock_set(ctx, &ext_mem_171873, &pR_mem_171818, "pR_mem_171818") != 0)
                            return 1;
                    } else if (memblock_set(ctx, &ext_mem_171873, &mem_171864, "mem_171864") != 0)
                        return 1;
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171866.mem, i_171643 * b_143594, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171873.mem, ext_171872, (int64_t []) {(int64_t) 1}, (int64_t []) {b_143594});
                    if (memblock_unref(ctx, &ext_mem_171873, "ext_mem_171873") != 0)
                        return 1;
                }
                if (memblock_unref(ctx, &mem_171864, "mem_171864") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171941, &mem_171851, "mem_171851") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171938, &mem_171849, "mem_171849") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171935, &mem_171866, "mem_171866") != 0)
                    return 1;
                radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775 = defunc_res_168610;
            }
            if (memblock_set(ctx, &ext_mem_172005, &ext_mem_171941, "ext_mem_171941") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_172002, &ext_mem_171938, "ext_mem_171938") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171999, &ext_mem_171935, "ext_mem_171935") != 0)
                return 1;
            radix_hash_join_with_S_keys_unique_res_f_res_159516 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775;
            radix_hash_join_with_S_keys_unique_res_f_res_159517 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775;
            radix_hash_join_with_S_keys_unique_res_f_res_159518 = radix_hash_join_with_S_keys_unique_res_f_res_f_res_159775;
        }
        if (memblock_set(ctx, &ext_mem_172068, &ext_mem_172005, "ext_mem_172005") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172065, &ext_mem_172002, "ext_mem_172002") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172062, &ext_mem_171999, "ext_mem_171999") != 0)
            return 1;
        radix_hash_join_with_S_keys_unique_res_159257 = radix_hash_join_with_S_keys_unique_res_f_res_159516;
        radix_hash_join_with_S_keys_unique_res_159258 = radix_hash_join_with_S_keys_unique_res_f_res_159517;
        radix_hash_join_with_S_keys_unique_res_159259 = radix_hash_join_with_S_keys_unique_res_f_res_159518;
    }
    
    bool dim_match_160280 = radix_hash_join_with_S_keys_unique_res_159257 == radix_hash_join_with_S_keys_unique_res_159258;
    bool empty_or_match_cert_160281;
    
    if (!dim_match_160280) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:979:3-989:73\n   #1  ftRelational.fut:282:6-285:56\n   #2  ftRelational.fut:278:3-285:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool dim_match_160283 = radix_hash_join_with_S_keys_unique_res_159257 == radix_hash_join_with_S_keys_unique_res_159259;
    bool empty_or_match_cert_160284;
    
    if (!dim_match_160283) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Function return value does not match shape of declared return type.", "-> #0  ftHashJoin.fut:979:3-989:73\n   #1  ftRelational.fut:282:6-285:56\n   #2  ftRelational.fut:278:3-285:75\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_172068, "ext_mem_172068") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_172065, "ext_mem_172065") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &ext_mem_172062, "ext_mem_172062") != 0)
        return 1;
    prim_out_172503 = radix_hash_join_with_S_keys_unique_res_159257;
    if (memblock_set(ctx, &*mem_out_p_172732, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172733, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172734, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172735 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171825);
        free(mem_171833);
        free(mem_171835);
        free(mem_171879);
        free(mem_171887);
        free(mem_171889);
        free(mem_171943);
        free(mem_171951);
        free(mem_171953);
        free(mem_172006);
        free(mem_172014);
        free(mem_172016);
        if (memblock_unref(ctx, &ext_mem_171873, "ext_mem_171873") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171866, "mem_171866") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171864, "mem_171864") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171849, "mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171927, "ext_mem_171927") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171920, "mem_171920") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171918, "mem_171918") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171905, "mem_171905") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171903, "mem_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171935, "ext_mem_171935") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171938, "ext_mem_171938") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171941, "ext_mem_171941") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171991, "ext_mem_171991") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171984, "mem_171984") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171969, "mem_171969") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171967, "mem_171967") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171999, "ext_mem_171999") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172002, "ext_mem_172002") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172005, "ext_mem_172005") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172054, "ext_mem_172054") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172047, "mem_172047") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172045, "mem_172045") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172032, "mem_172032") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172062, "ext_mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172065, "ext_mem_172065") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172068, "ext_mem_172068") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172748, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_152590, int64_t nz2080U_152591)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * group_noz2081U_152590;
    int64_t defunc_0_reduce_res_162547;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < group_noz2081U_152590; i_171546++) {
        int64_t x_154941 = ((int64_t *) eta_p_mem_171819.mem)[i_171546];
        int64_t max_res_154944 = smax64(x_154941, redout_171545);
        int64_t redout_tmp_172501 = max_res_154944;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162547 = redout_171545;
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < group_noz2081U_152590; i_171551++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171551];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171551];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_152591);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_152591, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ftRelational.fut:364:28-60\n   #5  ftRelational.fut:364:5-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double defunc_0_reduce_comm_res_162546;
        double redout_171547 = 0.0;
        
        for (int64_t i_171548 = 0; i_171548 < defunc_0_reduce_res_162547; i_171548++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171548);
            double index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0.0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171548;
                double index_concat_171793 = ((double *) eta_p_mem_171820.mem)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            double zp_res_162544 = redout_171547 + index_concat_branch_171794;
            double redout_tmp_172503 = zp_res_162544;
            
            redout_171547 = redout_tmp_172503;
        }
        defunc_0_reduce_comm_res_162546 = redout_171547;
        ((double *) mem_171822.mem)[i_171551] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172748, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172749, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_152657, int64_t nz2080U_152658)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171823_cached_sizze_172750 = 0;
    unsigned char *mem_171823 = NULL;
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171822 = (int64_t) 8 * nz2080U_152658;
    int64_t bytes_171830 = (int64_t) 8 * group_noz2081U_152657;
    
    if (mem_171823_cached_sizze_172750 < bytes_171822) {
        err = lexical_realloc(ctx, &mem_171823, &mem_171823_cached_sizze_172750, bytes_171822);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < nz2080U_152658; i_171547++) {
        double eta_p_155308 = ((double *) eta_p_mem_171820.mem)[i_171547];
        double eta_p_155309 = ((double *) eta_p_mem_171821.mem)[i_171547];
        double zt_res_155310 = eta_p_155308 * eta_p_155309;
        
        ((double *) mem_171823)[i_171547] = zt_res_155310;
    }
    
    int64_t defunc_0_reduce_res_162548;
    int64_t redout_171549 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171550 = 0; i_171550 < group_noz2081U_152657; i_171550++) {
        int64_t x_155312 = ((int64_t *) eta_p_mem_171819.mem)[i_171550];
        int64_t max_res_155315 = smax64(x_155312, redout_171549);
        int64_t redout_tmp_172502 = max_res_155315;
        
        redout_171549 = redout_tmp_172502;
    }
    defunc_0_reduce_res_162548 = redout_171549;
    if (memblock_alloc(ctx, &mem_171831, bytes_171830, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < group_noz2081U_152657; i_171555++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171555];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171555];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_152658);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_152658, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ft_SortGroupBy.fut:430:19-64\n   #5  ftRelational.fut:365:31-66\n   #6  ftRelational.fut:365:5-66\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double defunc_0_reduce_comm_res_162546;
        double redout_171551 = 0.0;
        
        for (int64_t i_171552 = 0; i_171552 < defunc_0_reduce_res_162548; i_171552++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171552);
            double index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0.0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171552;
                double index_concat_171793 = ((double *) mem_171823)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            double zp_res_162544 = redout_171551 + index_concat_branch_171794;
            double redout_tmp_172504 = zp_res_162544;
            
            redout_171551 = redout_tmp_172504;
        }
        defunc_0_reduce_comm_res_162546 = redout_171551;
        ((double *) mem_171831.mem)[i_171555] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172749, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171823);
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172751, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_152149, int64_t nz2080U_152150)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 4 * group_noz2081U_152149;
    int64_t defunc_0_reduce_res_162547;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < group_noz2081U_152149; i_171546++) {
        int64_t x_154941 = ((int64_t *) eta_p_mem_171819.mem)[i_171546];
        int64_t max_res_154944 = smax64(x_154941, redout_171545);
        int64_t redout_tmp_172501 = max_res_154944;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162547 = redout_171545;
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < group_noz2081U_152149; i_171551++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171551];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171551];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_152150);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_152150, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ftRelational.fut:361:27-58\n   #5  ftRelational.fut:361:5-58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float defunc_0_reduce_comm_res_162546;
        float redout_171547 = 0.0F;
        
        for (int64_t i_171548 = 0; i_171548 < defunc_0_reduce_res_162547; i_171548++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171548);
            float index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0.0F;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171548;
                float index_concat_171793 = ((float *) eta_p_mem_171820.mem)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            float zp_res_162544 = redout_171547 + index_concat_branch_171794;
            float redout_tmp_172503 = zp_res_162544;
            
            redout_171547 = redout_tmp_172503;
        }
        defunc_0_reduce_comm_res_162546 = redout_171547;
        ((float *) mem_171822.mem)[i_171551] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172751, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172752, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_152216, int64_t nz2080U_152217)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171823_cached_sizze_172753 = 0;
    unsigned char *mem_171823 = NULL;
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171822 = (int64_t) 4 * nz2080U_152217;
    int64_t bytes_171830 = (int64_t) 4 * group_noz2081U_152216;
    
    if (mem_171823_cached_sizze_172753 < bytes_171822) {
        err = lexical_realloc(ctx, &mem_171823, &mem_171823_cached_sizze_172753, bytes_171822);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < nz2080U_152217; i_171547++) {
        float eta_p_155308 = ((float *) eta_p_mem_171820.mem)[i_171547];
        float eta_p_155309 = ((float *) eta_p_mem_171821.mem)[i_171547];
        float zt_res_155310 = eta_p_155308 * eta_p_155309;
        
        ((float *) mem_171823)[i_171547] = zt_res_155310;
    }
    
    int64_t defunc_0_reduce_res_162548;
    int64_t redout_171549 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171550 = 0; i_171550 < group_noz2081U_152216; i_171550++) {
        int64_t x_155312 = ((int64_t *) eta_p_mem_171819.mem)[i_171550];
        int64_t max_res_155315 = smax64(x_155312, redout_171549);
        int64_t redout_tmp_172502 = max_res_155315;
        
        redout_171549 = redout_tmp_172502;
    }
    defunc_0_reduce_res_162548 = redout_171549;
    if (memblock_alloc(ctx, &mem_171831, bytes_171830, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < group_noz2081U_152216; i_171555++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171555];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171555];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_152217);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_152217, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ft_SortGroupBy.fut:430:19-64\n   #5  ftRelational.fut:362:30-64\n   #6  ftRelational.fut:362:5-64\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float defunc_0_reduce_comm_res_162546;
        float redout_171551 = 0.0F;
        
        for (int64_t i_171552 = 0; i_171552 < defunc_0_reduce_res_162548; i_171552++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171552);
            float index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0.0F;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171552;
                float index_concat_171793 = ((float *) mem_171823)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            float zp_res_162544 = redout_171551 + index_concat_branch_171794;
            float redout_tmp_172504 = zp_res_162544;
            
            redout_171551 = redout_tmp_172504;
        }
        defunc_0_reduce_comm_res_162546 = redout_171551;
        ((float *) mem_171831.mem)[i_171555] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172752, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171823);
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172754, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_151276, int64_t nz2080U_151277)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 4 * group_noz2081U_151276;
    int64_t defunc_0_reduce_res_162547;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < group_noz2081U_151276; i_171546++) {
        int64_t x_154941 = ((int64_t *) eta_p_mem_171819.mem)[i_171546];
        int64_t max_res_154944 = smax64(x_154941, redout_171545);
        int64_t redout_tmp_172501 = max_res_154944;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162547 = redout_171545;
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < group_noz2081U_151276; i_171551++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171551];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171551];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_151277);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_151277, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ftRelational.fut:355:25-54\n   #5  ftRelational.fut:355:5-54\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t defunc_0_reduce_comm_res_162546;
        int32_t redout_171547 = 0;
        
        for (int64_t i_171548 = 0; i_171548 < defunc_0_reduce_res_162547; i_171548++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171548);
            int32_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171548;
                int32_t index_concat_171793 = ((int32_t *) eta_p_mem_171820.mem)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int32_t zp_res_162544 = add32(redout_171547, index_concat_branch_171794);
            int32_t redout_tmp_172503 = zp_res_162544;
            
            redout_171547 = redout_tmp_172503;
        }
        defunc_0_reduce_comm_res_162546 = redout_171547;
        ((int32_t *) mem_171822.mem)[i_171551] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172754, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172755, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_151343, int64_t nz2080U_151344)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171823_cached_sizze_172756 = 0;
    unsigned char *mem_171823 = NULL;
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171822 = (int64_t) 4 * nz2080U_151344;
    int64_t bytes_171830 = (int64_t) 4 * group_noz2081U_151343;
    
    if (mem_171823_cached_sizze_172756 < bytes_171822) {
        err = lexical_realloc(ctx, &mem_171823, &mem_171823_cached_sizze_172756, bytes_171822);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < nz2080U_151344; i_171547++) {
        int32_t eta_p_155308 = ((int32_t *) eta_p_mem_171820.mem)[i_171547];
        int32_t eta_p_155309 = ((int32_t *) eta_p_mem_171821.mem)[i_171547];
        int32_t zt_res_155310 = mul32(eta_p_155308, eta_p_155309);
        
        ((int32_t *) mem_171823)[i_171547] = zt_res_155310;
    }
    
    int64_t defunc_0_reduce_res_162548;
    int64_t redout_171549 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171550 = 0; i_171550 < group_noz2081U_151343; i_171550++) {
        int64_t x_155312 = ((int64_t *) eta_p_mem_171819.mem)[i_171550];
        int64_t max_res_155315 = smax64(x_155312, redout_171549);
        int64_t redout_tmp_172502 = max_res_155315;
        
        redout_171549 = redout_tmp_172502;
    }
    defunc_0_reduce_res_162548 = redout_171549;
    if (memblock_alloc(ctx, &mem_171831, bytes_171830, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < group_noz2081U_151343; i_171555++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171555];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171555];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_151344);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_151344, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ft_SortGroupBy.fut:430:19-64\n   #5  ftRelational.fut:356:28-60\n   #6  ftRelational.fut:356:5-60\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t defunc_0_reduce_comm_res_162546;
        int32_t redout_171551 = 0;
        
        for (int64_t i_171552 = 0; i_171552 < defunc_0_reduce_res_162548; i_171552++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171552);
            int32_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171552;
                int32_t index_concat_171793 = ((int32_t *) mem_171823)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int32_t zp_res_162544 = add32(redout_171551, index_concat_branch_171794);
            int32_t redout_tmp_172504 = zp_res_162544;
            
            redout_171551 = redout_tmp_172504;
        }
        defunc_0_reduce_comm_res_162546 = redout_171551;
        ((int32_t *) mem_171831.mem)[i_171555] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172755, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171823);
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172757, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_151708, int64_t nz2080U_151709)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * group_noz2081U_151708;
    int64_t defunc_0_reduce_res_162547;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < group_noz2081U_151708; i_171546++) {
        int64_t x_154941 = ((int64_t *) eta_p_mem_171819.mem)[i_171546];
        int64_t max_res_154944 = smax64(x_154941, redout_171545);
        int64_t redout_tmp_172501 = max_res_154944;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162547 = redout_171545;
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < group_noz2081U_151708; i_171551++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171551];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171551];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_151709);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_151709, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ftRelational.fut:358:26-56\n   #5  ftRelational.fut:358:5-56\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t defunc_0_reduce_comm_res_162546;
        int64_t redout_171547 = (int64_t) 0;
        
        for (int64_t i_171548 = 0; i_171548 < defunc_0_reduce_res_162547; i_171548++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171548);
            int64_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = (int64_t) 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171548;
                int64_t index_concat_171793 = ((int64_t *) eta_p_mem_171820.mem)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int64_t zp_res_162544 = add64(redout_171547, index_concat_branch_171794);
            int64_t redout_tmp_172503 = zp_res_162544;
            
            redout_171547 = redout_tmp_172503;
        }
        defunc_0_reduce_comm_res_162546 = redout_171547;
        ((int64_t *) mem_171822.mem)[i_171551] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172757, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172758, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_151775, int64_t nz2080U_151776)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171823_cached_sizze_172759 = 0;
    unsigned char *mem_171823 = NULL;
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171822 = (int64_t) 8 * nz2080U_151776;
    int64_t bytes_171830 = (int64_t) 8 * group_noz2081U_151775;
    
    if (mem_171823_cached_sizze_172759 < bytes_171822) {
        err = lexical_realloc(ctx, &mem_171823, &mem_171823_cached_sizze_172759, bytes_171822);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < nz2080U_151776; i_171547++) {
        int64_t eta_p_155308 = ((int64_t *) eta_p_mem_171820.mem)[i_171547];
        int64_t eta_p_155309 = ((int64_t *) eta_p_mem_171821.mem)[i_171547];
        int64_t zt_res_155310 = mul64(eta_p_155308, eta_p_155309);
        
        ((int64_t *) mem_171823)[i_171547] = zt_res_155310;
    }
    
    int64_t defunc_0_reduce_res_162548;
    int64_t redout_171549 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171550 = 0; i_171550 < group_noz2081U_151775; i_171550++) {
        int64_t x_155312 = ((int64_t *) eta_p_mem_171819.mem)[i_171550];
        int64_t max_res_155315 = smax64(x_155312, redout_171549);
        int64_t redout_tmp_172502 = max_res_155315;
        
        redout_171549 = redout_tmp_172502;
    }
    defunc_0_reduce_res_162548 = redout_171549;
    if (memblock_alloc(ctx, &mem_171831, bytes_171830, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < group_noz2081U_151775; i_171555++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171555];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171555];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_151776);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_151776, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ft_SortGroupBy.fut:430:19-64\n   #5  ftRelational.fut:359:29-62\n   #6  ftRelational.fut:359:5-62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t defunc_0_reduce_comm_res_162546;
        int64_t redout_171551 = (int64_t) 0;
        
        for (int64_t i_171552 = 0; i_171552 < defunc_0_reduce_res_162548; i_171552++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171552);
            int64_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = (int64_t) 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171552;
                int64_t index_concat_171793 = ((int64_t *) mem_171823)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int64_t zp_res_162544 = add64(redout_171551, index_concat_branch_171794);
            int64_t redout_tmp_172504 = zp_res_162544;
            
            redout_171551 = redout_tmp_172504;
        }
        defunc_0_reduce_comm_res_162546 = redout_171551;
        ((int64_t *) mem_171831.mem)[i_171555] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172758, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171823);
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172760, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t group_noz2081U_150844, int64_t nz2080U_150845)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 2 * group_noz2081U_150844;
    int64_t defunc_0_reduce_res_162547;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < group_noz2081U_150844; i_171546++) {
        int64_t x_154941 = ((int64_t *) eta_p_mem_171819.mem)[i_171546];
        int64_t max_res_154944 = smax64(x_154941, redout_171545);
        int64_t redout_tmp_172501 = max_res_154944;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162547 = redout_171545;
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < group_noz2081U_150844; i_171551++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171551];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171551];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_150845);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_150845, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ftRelational.fut:352:27-58\n   #5  ftRelational.fut:352:5-58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t defunc_0_reduce_comm_res_162546;
        int16_t redout_171547 = (int16_t) 0;
        
        for (int64_t i_171548 = 0; i_171548 < defunc_0_reduce_res_162547; i_171548++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171548);
            int16_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = (int16_t) 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171548;
                int16_t index_concat_171793 = ((int16_t *) eta_p_mem_171820.mem)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int16_t zp_res_162544 = add16(redout_171547, index_concat_branch_171794);
            int16_t redout_tmp_172503 = zp_res_162544;
            
            redout_171547 = redout_tmp_172503;
        }
        defunc_0_reduce_comm_res_162546 = redout_171547;
        ((int16_t *) mem_171822.mem)[i_171551] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172760, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_alt_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172761, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, struct memblock eta_p_mem_171821, int64_t group_noz2081U_150911, int64_t nz2080U_150912)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171823_cached_sizze_172762 = 0;
    unsigned char *mem_171823 = NULL;
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171822 = (int64_t) 2 * nz2080U_150912;
    int64_t bytes_171830 = (int64_t) 2 * group_noz2081U_150911;
    
    if (mem_171823_cached_sizze_172762 < bytes_171822) {
        err = lexical_realloc(ctx, &mem_171823, &mem_171823_cached_sizze_172762, bytes_171822);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < nz2080U_150912; i_171547++) {
        int16_t eta_p_155308 = ((int16_t *) eta_p_mem_171820.mem)[i_171547];
        int16_t eta_p_155309 = ((int16_t *) eta_p_mem_171821.mem)[i_171547];
        int16_t zt_res_155310 = mul16(eta_p_155308, eta_p_155309);
        
        ((int16_t *) mem_171823)[i_171547] = zt_res_155310;
    }
    
    int64_t defunc_0_reduce_res_162548;
    int64_t redout_171549 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171550 = 0; i_171550 < group_noz2081U_150911; i_171550++) {
        int64_t x_155312 = ((int64_t *) eta_p_mem_171819.mem)[i_171550];
        int64_t max_res_155315 = smax64(x_155312, redout_171549);
        int64_t redout_tmp_172502 = max_res_155315;
        
        redout_171549 = redout_tmp_172502;
    }
    defunc_0_reduce_res_162548 = redout_171549;
    if (memblock_alloc(ctx, &mem_171831, bytes_171830, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < group_noz2081U_150911; i_171555++) {
        int64_t this_inf_162520 = ((int64_t *) eta_p_mem_171818.mem)[i_171555];
        int64_t zp_rhs_162521 = ((int64_t *) eta_p_mem_171819.mem)[i_171555];
        int64_t this_sup_162522 = add64(this_inf_162520, zp_rhs_162521);
        bool empty_slice_162524 = zp_rhs_162521 == (int64_t) 0;
        int64_t m_162525 = sub64(zp_rhs_162521, (int64_t) 1);
        int64_t i_p_m_t_s_162526 = add64(this_inf_162520, m_162525);
        bool zzero_leq_i_p_m_t_s_162527 = sle64((int64_t) 0, i_p_m_t_s_162526);
        bool i_p_m_t_s_leq_w_162528 = slt64(i_p_m_t_s_162526, nz2080U_150912);
        bool zzero_lte_i_162529 = sle64((int64_t) 0, this_inf_162520);
        bool i_lte_j_162530 = sle64(this_inf_162520, this_sup_162522);
        bool y_162531 = i_p_m_t_s_leq_w_162528 && zzero_lte_i_162529;
        bool y_162532 = zzero_leq_i_p_m_t_s_162527 && y_162531;
        bool forwards_ok_162533 = i_lte_j_162530 && y_162532;
        bool ok_or_empty_162534 = empty_slice_162524 || forwards_ok_162533;
        bool index_certs_162535;
        
        if (!ok_or_empty_162534) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) this_inf_162520, ":", (long long) this_sup_162522, "] out of bounds for array of shape [", (long long) nz2080U_150912, "].", "-> #0  ft_SortGroupBy.fut:301:37-58\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:297:28-302:26\n   #3  ft_SortGroupBy.fut:424:72-74\n   #4  ft_SortGroupBy.fut:430:19-64\n   #5  ftRelational.fut:353:30-64\n   #6  ftRelational.fut:353:5-64\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t defunc_0_reduce_comm_res_162546;
        int16_t redout_171551 = (int16_t) 0;
        
        for (int64_t i_171552 = 0; i_171552 < defunc_0_reduce_res_162548; i_171552++) {
            bool index_concat_cmp_171790 = sle64(zp_rhs_162521, i_171552);
            int16_t index_concat_branch_171794;
            
            if (index_concat_cmp_171790) {
                index_concat_branch_171794 = (int16_t) 0;
            } else {
                int64_t slice_171797 = this_inf_162520 + i_171552;
                int16_t index_concat_171793 = ((int16_t *) mem_171823)[slice_171797];
                
                index_concat_branch_171794 = index_concat_171793;
            }
            
            int16_t zp_res_162544 = add16(redout_171551, index_concat_branch_171794);
            int16_t redout_tmp_172504 = zp_res_162544;
            
            redout_171551 = redout_tmp_172504;
        }
        defunc_0_reduce_comm_res_162546 = redout_171551;
        ((int16_t *) mem_171831.mem)[i_171555] = defunc_0_reduce_comm_res_162546;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172761, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171823);
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_double(struct futhark_context *ctx, int64_t *out_prim_out_172763, struct memblock ks_mem_171818, int64_t n_79709)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_comm_res_162514;
    double defunc_0_reduce_comm_res_162515;
    int64_t redout_171545;
    double redout_171546;
    
    redout_171545 = n_79709;
    redout_171546 = INFINITY;
    for (int64_t i_171547 = 0; i_171547 < n_79709; i_171547++) {
        double x_153537 = ((double *) ks_mem_171818.mem)[i_171547];
        bool defunc_0_lt_res_153542 = redout_171546 < x_153537;
        bool defunc_0_eq_res_153544 = redout_171546 == x_153537;
        bool cond_f_res_t_res_153545 = slt64(redout_171545, i_171547);
        bool x_153546 = defunc_0_eq_res_153544 && cond_f_res_t_res_153545;
        bool x_162312 = !defunc_0_lt_res_153542;
        bool y_162313 = x_153546 && x_162312;
        bool cond_153543 = defunc_0_lt_res_153542 || y_162313;
        int64_t defunc_0_op_res_153547;
        
        if (cond_153543) {
            defunc_0_op_res_153547 = redout_171545;
        } else {
            defunc_0_op_res_153547 = i_171547;
        }
        
        double defunc_0_op_res_153548;
        
        if (cond_153543) {
            defunc_0_op_res_153548 = redout_171546;
        } else {
            defunc_0_op_res_153548 = x_153537;
        }
        
        int64_t redout_tmp_172501 = defunc_0_op_res_153547;
        double redout_tmp_172502 = defunc_0_op_res_153548;
        
        redout_171545 = redout_tmp_172501;
        redout_171546 = redout_tmp_172502;
    }
    defunc_0_reduce_comm_res_162514 = redout_171545;
    defunc_0_reduce_comm_res_162515 = redout_171546;
    prim_out_172500 = defunc_0_reduce_comm_res_162514;
    *out_prim_out_172763 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_float(struct futhark_context *ctx, int64_t *out_prim_out_172764, struct memblock ks_mem_171818, int64_t n_79532)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_comm_res_162514;
    float defunc_0_reduce_comm_res_162515;
    int64_t redout_171545;
    float redout_171546;
    
    redout_171545 = n_79532;
    redout_171546 = INFINITY;
    for (int64_t i_171547 = 0; i_171547 < n_79532; i_171547++) {
        float x_153537 = ((float *) ks_mem_171818.mem)[i_171547];
        bool defunc_0_lt_res_153542 = redout_171546 < x_153537;
        bool defunc_0_eq_res_153544 = redout_171546 == x_153537;
        bool cond_f_res_t_res_153545 = slt64(redout_171545, i_171547);
        bool x_153546 = defunc_0_eq_res_153544 && cond_f_res_t_res_153545;
        bool x_162312 = !defunc_0_lt_res_153542;
        bool y_162313 = x_153546 && x_162312;
        bool cond_153543 = defunc_0_lt_res_153542 || y_162313;
        int64_t defunc_0_op_res_153547;
        
        if (cond_153543) {
            defunc_0_op_res_153547 = redout_171545;
        } else {
            defunc_0_op_res_153547 = i_171547;
        }
        
        float defunc_0_op_res_153548;
        
        if (cond_153543) {
            defunc_0_op_res_153548 = redout_171546;
        } else {
            defunc_0_op_res_153548 = x_153537;
        }
        
        int64_t redout_tmp_172501 = defunc_0_op_res_153547;
        float redout_tmp_172502 = defunc_0_op_res_153548;
        
        redout_171545 = redout_tmp_172501;
        redout_171546 = redout_tmp_172502;
    }
    defunc_0_reduce_comm_res_162514 = redout_171545;
    defunc_0_reduce_comm_res_162515 = redout_171546;
    prim_out_172500 = defunc_0_reduce_comm_res_162514;
    *out_prim_out_172764 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_int(struct futhark_context *ctx, int64_t *out_prim_out_172765, struct memblock ks_mem_171818, int64_t n_79181)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_comm_res_162514;
    int32_t defunc_0_reduce_comm_res_162515;
    int64_t redout_171545;
    int32_t redout_171546;
    
    redout_171545 = n_79181;
    redout_171546 = 2147483647;
    for (int64_t i_171547 = 0; i_171547 < n_79181; i_171547++) {
        int32_t x_153537 = ((int32_t *) ks_mem_171818.mem)[i_171547];
        bool defunc_0_lt_res_153542 = slt32(redout_171546, x_153537);
        bool defunc_0_eq_res_153544 = redout_171546 == x_153537;
        bool cond_f_res_t_res_153545 = slt64(redout_171545, i_171547);
        bool x_153546 = defunc_0_eq_res_153544 && cond_f_res_t_res_153545;
        bool x_162312 = !defunc_0_lt_res_153542;
        bool y_162313 = x_153546 && x_162312;
        bool cond_153543 = defunc_0_lt_res_153542 || y_162313;
        int64_t defunc_0_op_res_153547;
        
        if (cond_153543) {
            defunc_0_op_res_153547 = redout_171545;
        } else {
            defunc_0_op_res_153547 = i_171547;
        }
        
        int32_t defunc_0_op_res_153548;
        
        if (cond_153543) {
            defunc_0_op_res_153548 = redout_171546;
        } else {
            defunc_0_op_res_153548 = x_153537;
        }
        
        int64_t redout_tmp_172501 = defunc_0_op_res_153547;
        int32_t redout_tmp_172502 = defunc_0_op_res_153548;
        
        redout_171545 = redout_tmp_172501;
        redout_171546 = redout_tmp_172502;
    }
    defunc_0_reduce_comm_res_162514 = redout_171545;
    defunc_0_reduce_comm_res_162515 = redout_171546;
    prim_out_172500 = defunc_0_reduce_comm_res_162514;
    *out_prim_out_172765 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_long(struct futhark_context *ctx, int64_t *out_prim_out_172766, struct memblock ks_mem_171818, int64_t n_79355)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_comm_res_162514;
    int64_t defunc_0_reduce_comm_res_162515;
    int64_t redout_171545;
    int64_t redout_171546;
    
    redout_171545 = n_79355;
    redout_171546 = (int64_t) 9223372036854775807;
    for (int64_t i_171547 = 0; i_171547 < n_79355; i_171547++) {
        int64_t x_153537 = ((int64_t *) ks_mem_171818.mem)[i_171547];
        bool defunc_0_lt_res_153542 = slt64(redout_171546, x_153537);
        bool defunc_0_eq_res_153544 = redout_171546 == x_153537;
        bool cond_f_res_t_res_153545 = slt64(redout_171545, i_171547);
        bool x_153546 = defunc_0_eq_res_153544 && cond_f_res_t_res_153545;
        bool x_162312 = !defunc_0_lt_res_153542;
        bool y_162313 = x_153546 && x_162312;
        bool cond_153543 = defunc_0_lt_res_153542 || y_162313;
        int64_t defunc_0_op_res_153547;
        
        if (cond_153543) {
            defunc_0_op_res_153547 = redout_171545;
        } else {
            defunc_0_op_res_153547 = i_171547;
        }
        
        int64_t defunc_0_op_res_153548;
        
        if (cond_153543) {
            defunc_0_op_res_153548 = redout_171546;
        } else {
            defunc_0_op_res_153548 = x_153537;
        }
        
        int64_t redout_tmp_172501 = defunc_0_op_res_153547;
        int64_t redout_tmp_172502 = defunc_0_op_res_153548;
        
        redout_171545 = redout_tmp_172501;
        redout_171546 = redout_tmp_172502;
    }
    defunc_0_reduce_comm_res_162514 = redout_171545;
    defunc_0_reduce_comm_res_162515 = redout_171546;
    prim_out_172500 = defunc_0_reduce_comm_res_162514;
    *out_prim_out_172766 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_argmin_short(struct futhark_context *ctx, int64_t *out_prim_out_172767, struct memblock ks_mem_171818, int64_t n_79007)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_comm_res_162514;
    int16_t defunc_0_reduce_comm_res_162515;
    int64_t redout_171545;
    int16_t redout_171546;
    
    redout_171545 = n_79007;
    redout_171546 = (int16_t) 32767;
    for (int64_t i_171547 = 0; i_171547 < n_79007; i_171547++) {
        int16_t x_153537 = ((int16_t *) ks_mem_171818.mem)[i_171547];
        bool defunc_0_lt_res_153542 = slt16(redout_171546, x_153537);
        bool defunc_0_eq_res_153544 = redout_171546 == x_153537;
        bool cond_f_res_t_res_153545 = slt64(redout_171545, i_171547);
        bool x_153546 = defunc_0_eq_res_153544 && cond_f_res_t_res_153545;
        bool x_162312 = !defunc_0_lt_res_153542;
        bool y_162313 = x_153546 && x_162312;
        bool cond_153543 = defunc_0_lt_res_153542 || y_162313;
        int64_t defunc_0_op_res_153547;
        
        if (cond_153543) {
            defunc_0_op_res_153547 = redout_171545;
        } else {
            defunc_0_op_res_153547 = i_171547;
        }
        
        int16_t defunc_0_op_res_153548;
        
        if (cond_153543) {
            defunc_0_op_res_153548 = redout_171546;
        } else {
            defunc_0_op_res_153548 = x_153537;
        }
        
        int64_t redout_tmp_172501 = defunc_0_op_res_153547;
        int16_t redout_tmp_172502 = defunc_0_op_res_153548;
        
        redout_171545 = redout_tmp_172501;
        redout_171546 = redout_tmp_172502;
    }
    defunc_0_reduce_comm_res_162514 = redout_171545;
    defunc_0_reduce_comm_res_162515 = redout_171546;
    prim_out_172500 = defunc_0_reduce_comm_res_162514;
    *out_prim_out_172767 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172768, struct memblock *mem_out_p_172769, int64_t *out_prim_out_172770, int32_t *out_prim_out_172771, struct memblock pXs_mem_171818, int64_t n_132232, int64_t b_132233, int32_t radix_sizze_132234, int64_t offset_132236, int64_t sizze_thresh_132237, int32_t max_depth_132238)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_172772 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171830_cached_sizze_172773 = 0;
    unsigned char *mem_171830 = NULL;
    int64_t mem_171832_cached_sizze_172774 = 0;
    unsigned char *mem_171832 = NULL;
    int64_t mem_171834_cached_sizze_172775 = 0;
    unsigned char *mem_171834 = NULL;
    int64_t mem_171860_cached_sizze_172776 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_172777 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_172778 = 0;
    unsigned char *mem_171864 = NULL;
    struct memblock mem_171919;
    
    mem_171919.references = NULL;
    
    struct memblock mem_param_tmp_172505;
    
    mem_param_tmp_172505.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172523;
    
    mem_param_tmp_172523.references = NULL;
    
    struct memblock mem_param_tmp_172522;
    
    mem_param_tmp_172522.references = NULL;
    
    struct memblock mem_171905;
    
    mem_171905.references = NULL;
    
    struct memblock mem_171903;
    
    mem_171903.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_param_171888;
    
    mem_param_171888.references = NULL;
    
    struct memblock mem_param_171885;
    
    mem_param_171885.references = NULL;
    
    struct memblock ext_mem_171910;
    
    ext_mem_171910.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock mem_param_171826;
    
    mem_param_171826.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171916;
    
    ext_mem_171916.references = NULL;
    
    struct memblock ext_mem_171917;
    
    ext_mem_171917.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int32_t prim_out_172503;
    int32_t getPartitionBounds_arg3_154058 = sub32(radix_sizze_132234, 1);
    int64_t calc_partInfo_res_154059;
    int64_t calc_partInfo_res_154060;
    int32_t calc_partInfo_res_154063;
    
    if (futrts_getPartitionBounds_16885(ctx, &ext_mem_171820, &ext_mem_171819, &calc_partInfo_res_154059, &calc_partInfo_res_154060, &calc_partInfo_res_154063, pXs_mem_171818, n_132232, b_132233, 1, 0, getPartitionBounds_arg3_154058) != 0) {
        err = 1;
        goto cleanup;
    }
    
    bool cond_154064 = slt32(calc_partInfo_res_154063, max_depth_132238);
    int64_t calc_partInfo_res_154065;
    int64_t calc_partInfo_res_154066;
    bool calc_partInfo_res_154067;
    int32_t calc_partInfo_res_154070;
    int64_t loop_dz2088U_154071;
    int64_t loop_dz2089U_154072;
    bool loop_while_154073;
    int32_t p_154076;
    
    if (memblock_set(ctx, &mem_param_171823, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171826, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    loop_dz2088U_154071 = calc_partInfo_res_154059;
    loop_dz2089U_154072 = calc_partInfo_res_154060;
    loop_while_154073 = cond_154064;
    p_154076 = calc_partInfo_res_154063;
    while (loop_while_154073) {
        int64_t zl_rhs_154078 = sub64(loop_dz2088U_154071, (int64_t) 1);
        int64_t bytes_171827 = (int64_t) 8 * loop_dz2088U_154071;
        
        if (mem_171828_cached_sizze_172772 < bytes_171827) {
            err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_172772, bytes_171827);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171830_cached_sizze_172773 < bytes_171827) {
            err = lexical_realloc(ctx, &mem_171830, &mem_171830_cached_sizze_172773, bytes_171827);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171832_cached_sizze_172774 < bytes_171827) {
            err = lexical_realloc(ctx, &mem_171832, &mem_171832_cached_sizze_172774, bytes_171827);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171834_cached_sizze_172775 < bytes_171827) {
            err = lexical_realloc(ctx, &mem_171834, &mem_171834_cached_sizze_172775, bytes_171827);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        
        int64_t discard_171559;
        int64_t scanacc_171549 = (int64_t) 0;
        
        for (int64_t i_171554 = 0; i_171554 < loop_dz2088U_154071; i_171554++) {
            int64_t tmp_162538 = ((int64_t *) mem_param_171823.mem)[i_171554];
            bool cond_162539 = slt64(i_171554, zl_rhs_154078);
            int64_t tmp_162540;
            
            if (cond_162539) {
                int64_t tmp_162578 = add64((int64_t) 1, i_171554);
                bool x_162579 = sle64((int64_t) 0, tmp_162578);
                bool y_162580 = slt64(tmp_162578, loop_dz2088U_154071);
                bool bounds_check_162581 = x_162579 && y_162580;
                bool index_certs_162582;
                
                if (!bounds_check_162581) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162578, "] out of bounds for array of shape [", (long long) loop_dz2088U_154071, "].", "-> #0  ftHashJoin.fut:336:57-64\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:257:5-62\n   #3  ftRelational.fut:250:3-257:62\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t tmp_t_res_162583 = ((int64_t *) mem_param_171823.mem)[tmp_162578];
                
                tmp_162540 = tmp_t_res_162583;
            } else {
                tmp_162540 = n_132232;
            }
            
            int64_t zg_lhs_162549 = sub64(tmp_162540, tmp_162538);
            bool lifted_lambda_res_162550 = slt64(sizze_thresh_132237, zg_lhs_162549);
            int64_t defunc_0_f_res_162551 = btoi_bool_i64(lifted_lambda_res_162550);
            int64_t defunc_0_op_res_154105 = add64(defunc_0_f_res_162551, scanacc_171549);
            
            ((int64_t *) mem_171828)[i_171554] = defunc_0_op_res_154105;
            ((int64_t *) mem_171830)[i_171554] = defunc_0_f_res_162551;
            ((int64_t *) mem_171832)[i_171554] = tmp_162538;
            ((int64_t *) mem_171834)[i_171554] = tmp_162540;
            
            int64_t scanacc_tmp_172512 = defunc_0_op_res_154105;
            
            scanacc_171549 = scanacc_tmp_172512;
        }
        discard_171559 = scanacc_171549;
        
        bool cond_154106 = loop_dz2088U_154071 == (int64_t) 0;
        bool x_154107 = !cond_154106;
        bool x_154108 = sle64((int64_t) 0, zl_rhs_154078);
        bool y_154109 = slt64(zl_rhs_154078, loop_dz2088U_154071);
        bool bounds_check_154110 = x_154108 && y_154109;
        bool protect_assert_disj_154111 = cond_154106 || bounds_check_154110;
        bool index_certs_154112;
        
        if (!protect_assert_disj_154111) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_154078, "] out of bounds for array of shape [", (long long) loop_dz2088U_154071, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:257:5-62\n   #3  ftRelational.fut:250:3-257:62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t m_f_res_154113;
        
        if (x_154107) {
            int64_t x_162584 = ((int64_t *) mem_171828)[zl_rhs_154078];
            
            m_f_res_154113 = x_162584;
        } else {
            m_f_res_154113 = (int64_t) 0;
        }
        
        int64_t m_154115;
        
        if (cond_154106) {
            m_154115 = (int64_t) 0;
        } else {
            m_154115 = m_f_res_154113;
        }
        
        int64_t m_154125 = sub64(m_154115, (int64_t) 1);
        bool i_p_m_t_s_leq_w_154127 = slt64(m_154125, loop_dz2088U_154071);
        bool zzero_leq_i_p_m_t_s_154126 = sle64((int64_t) 0, m_154125);
        bool y_154129 = zzero_leq_i_p_m_t_s_154126 && i_p_m_t_s_leq_w_154127;
        bool i_lte_j_154128 = sle64((int64_t) 0, m_154115);
        bool forwards_ok_154130 = i_lte_j_154128 && y_154129;
        bool eq_x_zz_154122 = (int64_t) 0 == m_f_res_154113;
        bool p_and_eq_x_y_154123 = x_154107 && eq_x_zz_154122;
        bool empty_slice_154124 = cond_154106 || p_and_eq_x_y_154123;
        bool ok_or_empty_154131 = empty_slice_154124 || forwards_ok_154130;
        bool index_certs_154132;
        
        if (!ok_or_empty_154131) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154115, "] out of bounds for array of shape [", (long long) loop_dz2088U_154071, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:257:5-62\n   #3  ftRelational.fut:250:3-257:62\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171859 = (int64_t) 8 * m_154115;
        
        if (mem_171860_cached_sizze_172776 < bytes_171859) {
            err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_172776, bytes_171859);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_172517 = 0; i_172517 < m_154115; i_172517++) {
            int64_t x_172518 = (int64_t) 0 + i_172517 * (int64_t) 1;
            
            ((int64_t *) mem_171860)[i_172517] = x_172518;
        }
        if (mem_171862_cached_sizze_172777 < bytes_171859) {
            err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_172777, bytes_171859);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171834, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154115});
        if (mem_171864_cached_sizze_172778 < bytes_171859) {
            err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_172778, bytes_171859);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171832, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154115});
        for (int64_t write_iter_171560 = 0; write_iter_171560 < loop_dz2088U_154071; write_iter_171560++) {
            int64_t write_iv_171564 = ((int64_t *) mem_171830)[write_iter_171560];
            int64_t write_iv_171565 = ((int64_t *) mem_171828)[write_iter_171560];
            int64_t write_iv_171566 = ((int64_t *) mem_171832)[write_iter_171560];
            int64_t write_iv_171567 = ((int64_t *) mem_171834)[write_iter_171560];
            bool cond_162520 = write_iv_171564 == (int64_t) 1;
            int64_t lifted_lambda_res_162521;
            
            if (cond_162520) {
                int64_t lifted_lambda_res_t_res_162585 = sub64(write_iv_171565, (int64_t) 1);
                
                lifted_lambda_res_162521 = lifted_lambda_res_t_res_162585;
            } else {
                lifted_lambda_res_162521 = (int64_t) -1;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162521) && slt64(lifted_lambda_res_162521, m_154115)) {
                ((int64_t *) mem_171864)[lifted_lambda_res_162521] = write_iv_171566;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162521) && slt64(lifted_lambda_res_162521, m_154115)) {
                ((int64_t *) mem_171862)[lifted_lambda_res_162521] = write_iv_171567;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_162521) && slt64(lifted_lambda_res_162521, m_154115)) {
                ((int64_t *) mem_171860)[lifted_lambda_res_162521] = write_iter_171560;
            }
        }
        
        int32_t new_i_154145 = mul32(radix_sizze_132234, p_154076);
        int32_t zt_rhs_154146 = add32(1, p_154076);
        int32_t zm_lhs_154147 = mul32(radix_sizze_132234, zt_rhs_154146);
        int32_t new_j_154148 = sub32(zm_lhs_154147, 1);
        int64_t loopres_154149;
        int64_t loopres_154150;
        int32_t loopres_154153;
        int64_t loopres_154154;
        int64_t loopres_154155;
        int64_t loop_dz2084Uz2089U_154157;
        int64_t loop_dz2085Uz2080U_154158;
        int32_t q_154161;
        int64_t ad_154162;
        int64_t ox_154163;
        
        if (memblock_set(ctx, &mem_param_171885, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171888, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        loop_dz2084Uz2089U_154157 = loop_dz2088U_154071;
        loop_dz2085Uz2080U_154158 = loop_dz2089U_154072;
        q_154161 = p_154076;
        ad_154162 = (int64_t) 0;
        ox_154163 = (int64_t) 0;
        for (int64_t i_154156 = 0; i_154156 < m_154115; i_154156++) {
            int64_t bounds_154164 = ((int64_t *) mem_171864)[i_154156];
            int64_t bounds_154165 = ((int64_t *) mem_171862)[i_154156];
            int64_t bounds_154166 = ((int64_t *) mem_171860)[i_154156];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167 = sub64(bounds_154165, bounds_154164);
            bool empty_slice_154168 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167 == (int64_t) 0;
            int64_t m_154169 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167, (int64_t) 1);
            int64_t i_p_m_t_s_154170 = add64(bounds_154164, m_154169);
            bool zzero_leq_i_p_m_t_s_154171 = sle64((int64_t) 0, i_p_m_t_s_154170);
            bool i_p_m_t_s_leq_w_154172 = slt64(i_p_m_t_s_154170, n_132232);
            bool zzero_lte_i_154173 = sle64((int64_t) 0, bounds_154164);
            bool i_lte_j_154174 = sle64(bounds_154164, bounds_154165);
            bool y_154175 = i_p_m_t_s_leq_w_154172 && zzero_lte_i_154173;
            bool y_154176 = zzero_leq_i_p_m_t_s_154171 && y_154175;
            bool forwards_ok_154177 = i_lte_j_154174 && y_154176;
            bool ok_or_empty_154178 = empty_slice_154168 || forwards_ok_154177;
            bool index_certs_154179;
            
            if (!ok_or_empty_154178) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_154164, ":", (long long) bounds_154165, "] out of bounds for array of shape [", (long long) n_132232, "].", "-> #0  ftHashJoin.fut:342:23-45\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171889 = b_132233 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167;
            
            if (memblock_alloc(ctx, &mem_171890, bytes_171889, "mem_171890")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {b_132233, (int64_t) 1}, (uint8_t *) pXs_mem_171818.mem, b_132233 * bounds_154164, (int64_t []) {b_132233, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167, b_132233});
            
            int64_t loopres_154181;
            int64_t loopres_154182;
            int32_t loopres_154185;
            
            if (futrts_getPartitionBounds_16885(ctx, &ext_mem_171893, &ext_mem_171892, &loopres_154181, &loopres_154182, &loopres_154185, mem_171890, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154167, b_132233, zt_rhs_154146, new_i_154145, new_j_154148) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
                return 1;
            
            int64_t zm_lhs_154186 = add64(ox_154163, bounds_154166);
            int64_t stitch_154187 = sub64(zm_lhs_154186, ad_154162);
            bool empty_slice_154188 = stitch_154187 == (int64_t) 0;
            int64_t m_154189 = sub64(stitch_154187, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_154190 = sle64((int64_t) 0, m_154189);
            bool i_p_m_t_s_leq_w_154191 = slt64(m_154189, loop_dz2084Uz2089U_154157);
            bool i_lte_j_154192 = sle64((int64_t) 0, stitch_154187);
            bool y_154193 = zzero_leq_i_p_m_t_s_154190 && i_p_m_t_s_leq_w_154191;
            bool forwards_ok_154194 = i_lte_j_154192 && y_154193;
            bool ok_or_empty_154195 = empty_slice_154188 || forwards_ok_154194;
            bool index_certs_154196;
            
            if (!ok_or_empty_154195) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_154187, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_154157, "].", "-> #0  ftHashJoin.fut:350:20-38\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_154201 = loopres_154181 + stitch_154187;
            int64_t zpzp_rhs_154202 = add64((int64_t) 1, stitch_154187);
            int64_t j_m_i_154203 = sub64(loop_dz2084Uz2089U_154157, zpzp_rhs_154202);
            bool empty_slice_154204 = j_m_i_154203 == (int64_t) 0;
            int64_t m_154205 = sub64(j_m_i_154203, (int64_t) 1);
            int64_t i_p_m_t_s_154206 = add64(zpzp_rhs_154202, m_154205);
            bool zzero_leq_i_p_m_t_s_154207 = sle64((int64_t) 0, i_p_m_t_s_154206);
            bool i_p_m_t_s_leq_w_154208 = slt64(i_p_m_t_s_154206, loop_dz2084Uz2089U_154157);
            bool zzero_lte_i_154209 = sle64((int64_t) 0, zpzp_rhs_154202);
            bool i_lte_j_154210 = sle64(zpzp_rhs_154202, loop_dz2084Uz2089U_154157);
            bool y_154211 = i_p_m_t_s_leq_w_154208 && zzero_lte_i_154209;
            bool y_154212 = zzero_leq_i_p_m_t_s_154207 && y_154211;
            bool forwards_ok_154213 = i_lte_j_154210 && y_154212;
            bool ok_or_empty_154214 = empty_slice_154204 || forwards_ok_154213;
            bool index_certs_154215;
            
            if (!ok_or_empty_154214) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_154202, ":", (long long) loop_dz2084Uz2089U_154157, "] out of bounds for array of shape [", (long long) loop_dz2084Uz2089U_154157, "].", "-> #0  ftHashJoin.fut:350:92-128\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_154217 = conc_tmp_154201 + j_m_i_154203;
            int64_t bytes_171902 = (int64_t) 8 * conc_tmp_154217;
            bool i_p_m_t_s_leq_w_154219 = slt64(m_154189, loop_dz2085Uz2080U_154158);
            bool y_154220 = zzero_leq_i_p_m_t_s_154190 && i_p_m_t_s_leq_w_154219;
            bool ok_or_empty_154221 = empty_slice_154188 || y_154220;
            bool index_certs_154222;
            
            if (!ok_or_empty_154221) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) stitch_154187, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_154158, "].", "-> #0  ftHashJoin.fut:351:20-38\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_154224 = loopres_154182 + stitch_154187;
            int64_t j_m_i_154225 = sub64(loop_dz2085Uz2080U_154158, zpzp_rhs_154202);
            bool empty_slice_154226 = j_m_i_154225 == (int64_t) 0;
            int64_t m_154227 = sub64(j_m_i_154225, (int64_t) 1);
            int64_t i_p_m_t_s_154228 = add64(zpzp_rhs_154202, m_154227);
            bool zzero_leq_i_p_m_t_s_154229 = sle64((int64_t) 0, i_p_m_t_s_154228);
            bool i_p_m_t_s_leq_w_154230 = slt64(i_p_m_t_s_154228, loop_dz2085Uz2080U_154158);
            bool i_lte_j_154231 = sle64(zpzp_rhs_154202, loop_dz2085Uz2080U_154158);
            bool y_154232 = zzero_lte_i_154209 && i_p_m_t_s_leq_w_154230;
            bool y_154233 = zzero_leq_i_p_m_t_s_154229 && y_154232;
            bool forwards_ok_154234 = i_lte_j_154231 && y_154233;
            bool ok_or_empty_154235 = empty_slice_154226 || forwards_ok_154234;
            bool index_certs_154236;
            
            if (!ok_or_empty_154235) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zpzp_rhs_154202, ":", (long long) loop_dz2085Uz2080U_154158, "] out of bounds for array of shape [", (long long) loop_dz2085Uz2080U_154158, "].", "-> #0  ftHashJoin.fut:351:64-100\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t conc_tmp_154238 = conc_tmp_154224 + j_m_i_154225;
            int64_t bytes_171904 = (int64_t) 4 * conc_tmp_154238;
            
            if (memblock_alloc(ctx, &mem_171903, bytes_171902, "mem_171903")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171574 = 0; i_171574 < loopres_154181; i_171574++) {
                int64_t eta_p_154199 = ((int64_t *) ext_mem_171893.mem)[i_171574];
                int64_t lifted_lambda_res_154200 = add64(bounds_154164, eta_p_154199);
                
                ((int64_t *) mem_171903.mem)[stitch_154187 + i_171574] = lifted_lambda_res_154200;
            }
            if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t tmp_offs_172532 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171903.mem, tmp_offs_172532, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_154187});
            tmp_offs_172532 += stitch_154187;
            if (!(tmp_offs_172532 == stitch_154187)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171903.mem, tmp_offs_172532, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171903.mem, stitch_154187, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_154181});
            }
            tmp_offs_172532 += loopres_154181;
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171903.mem, tmp_offs_172532, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171885.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_154202, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154203});
            tmp_offs_172532 += j_m_i_154203;
            if (memblock_alloc(ctx, &mem_171905, bytes_171904, "mem_171905")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_172533 = (int64_t) 0;
            
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171905.mem, tmp_offs_172533, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {stitch_154187});
            tmp_offs_172533 += stitch_154187;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171905.mem, tmp_offs_172533, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loopres_154182});
            tmp_offs_172533 += loopres_154182;
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171905.mem, tmp_offs_172533, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171888.mem, (int64_t) 0 + (int64_t) 1 * zpzp_rhs_154202, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_154225});
            tmp_offs_172533 += j_m_i_154225;
            if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
                return 1;
            
            int64_t tmp_154240 = add64((int64_t) 1, ad_154162);
            int64_t tmp_154241 = add64(ox_154163, loopres_154181);
            
            if (memblock_set(ctx, &mem_param_tmp_172522, &mem_171903, "mem_171903") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172523, &mem_171905, "mem_171905") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2089U_tmp_172524 = conc_tmp_154217;
            int64_t loop_dz2085Uz2080U_tmp_172525 = conc_tmp_154238;
            int32_t q_tmp_172528 = zt_rhs_154146;
            int64_t ad_tmp_172529 = tmp_154240;
            int64_t ox_tmp_172530 = tmp_154241;
            
            if (memblock_set(ctx, &mem_param_171885, &mem_param_tmp_172522, "mem_param_tmp_172522") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171888, &mem_param_tmp_172523, "mem_param_tmp_172523") != 0)
                return 1;
            loop_dz2084Uz2089U_154157 = loop_dz2084Uz2089U_tmp_172524;
            loop_dz2085Uz2080U_154158 = loop_dz2085Uz2080U_tmp_172525;
            q_154161 = q_tmp_172528;
            ad_154162 = ad_tmp_172529;
            ox_154163 = ox_tmp_172530;
        }
        if (memblock_set(ctx, &ext_mem_171911, &mem_param_171885, "mem_param_171885") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171910, &mem_param_171888, "mem_param_171888") != 0)
            return 1;
        loopres_154149 = loop_dz2084Uz2089U_154157;
        loopres_154150 = loop_dz2085Uz2080U_154158;
        loopres_154153 = q_154161;
        loopres_154154 = ad_154162;
        loopres_154155 = ox_154163;
        
        bool tmp_154242 = slt64((int64_t) 0, m_154115);
        bool cond_154243 = slt32(loopres_154153, max_depth_132238);
        bool x_154244 = tmp_154242 && cond_154243;
        
        if (memblock_set(ctx, &mem_param_tmp_172504, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172505, &ext_mem_171910, "ext_mem_171910") != 0)
            return 1;
        
        int64_t loop_dz2088U_tmp_172506 = loopres_154149;
        int64_t loop_dz2089U_tmp_172507 = loopres_154150;
        bool loop_while_tmp_172508 = x_154244;
        int32_t p_tmp_172511 = loopres_154153;
        
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171826, &mem_param_tmp_172505, "mem_param_tmp_172505") != 0)
            return 1;
        loop_dz2088U_154071 = loop_dz2088U_tmp_172506;
        loop_dz2089U_154072 = loop_dz2089U_tmp_172507;
        loop_while_154073 = loop_while_tmp_172508;
        p_154076 = p_tmp_172511;
    }
    if (memblock_set(ctx, &ext_mem_171917, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171916, &mem_param_171826, "mem_param_171826") != 0)
        return 1;
    calc_partInfo_res_154065 = loop_dz2088U_154071;
    calc_partInfo_res_154066 = loop_dz2089U_154072;
    calc_partInfo_res_154067 = loop_while_154073;
    calc_partInfo_res_154070 = p_154076;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    
    int64_t bytes_171918 = (int64_t) 8 * calc_partInfo_res_154065;
    bool dim_match_154248 = calc_partInfo_res_154065 == calc_partInfo_res_154066;
    bool empty_or_match_cert_154249;
    
    if (!dim_match_154248) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Value of (desugared) shape [", (long long) calc_partInfo_res_154066, "] cannot match shape of type `[", (long long) calc_partInfo_res_154065, "]i32`.", "-> #0  ftHashJoin.fut:359:16-56\n   #1  ftRelational.fut:257:5-62\n   #2  ftRelational.fut:250:3-257:62\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171919, bytes_171918, "mem_171919")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171578 = 0; i_171578 < calc_partInfo_res_154065; i_171578++) {
        int64_t eta_p_154246 = ((int64_t *) ext_mem_171917.mem)[i_171578];
        int64_t lifted_lambda_res_154247 = add64(offset_132236, eta_p_154246);
        
        ((int64_t *) mem_171919.mem)[i_171578] = lifted_lambda_res_154247;
    }
    if (memblock_unref(ctx, &ext_mem_171917, "ext_mem_171917") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171919, "mem_171919") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171916, "ext_mem_171916") != 0)
        return 1;
    prim_out_172502 = calc_partInfo_res_154065;
    prim_out_172503 = calc_partInfo_res_154070;
    if (memblock_set(ctx, &*mem_out_p_172768, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172769, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_172770 = prim_out_172502;
    *out_prim_out_172771 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171830);
        free(mem_171832);
        free(mem_171834);
        free(mem_171860);
        free(mem_171862);
        free(mem_171864);
        if (memblock_unref(ctx, &mem_171919, "mem_171919") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172505, "mem_param_tmp_172505") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172523, "mem_param_tmp_172523") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172522, "mem_param_tmp_172522") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171905, "mem_171905") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171903, "mem_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171888, "mem_param_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171885, "mem_param_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171910, "ext_mem_171910") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171916, "ext_mem_171916") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171917, "ext_mem_171917") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct memblock *mem_out_p_172779, struct memblock *mem_out_p_172780, int64_t *out_prim_out_172781, struct memblock pXs_mem_171818, struct memblock bounds_mem_171819, struct memblock depths_mem_171820, int64_t n_132814, int64_t b_132815, int64_t dz2080U_132816, int64_t dz2081U_132817, int32_t radix_sizze_132818, int32_t maxDepth_132822, int64_t scatter_psizze_132823)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172782 = 0;
    unsigned char *mem_171822 = NULL;
    int64_t mem_171826_cached_sizze_172783 = 0;
    unsigned char *mem_171826 = NULL;
    struct memblock mem_171860;
    
    mem_171860.references = NULL;
    
    struct memblock mem_171858;
    
    mem_171858.references = NULL;
    
    struct memblock mem_171837;
    
    mem_171837.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock ext_mem_171853;
    
    ext_mem_171853.references = NULL;
    
    struct memblock ext_mem_171856;
    
    ext_mem_171856.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t i32_res_153848 = sext_i32_i64(radix_sizze_132818);
    bool nonnegative_153849 = sle64((int64_t) 0, i32_res_153848);
    bool nonzzero_cert_153850;
    
    if (!nonnegative_153849) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "negative exponent", "-> #0  ftHashJoin.fut:388:54-59\n   #1  ftRelational.fut:262:6-265:58\n   #2  ftRelational.fut:259:3-265:58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851 = shl64((int64_t) 1, i32_res_153848);
    int32_t getRadix_arg1_153853 = sub32(radix_sizze_132818, 1);
    int32_t zm_lhs_153854 = add32(8, radix_sizze_132818);
    int32_t zs_lhs_153855 = sub32(zm_lhs_153854, 1);
    int32_t i32_arg0_153856 = sdiv32(zs_lhs_153855, 8);
    int64_t i32_res_153857 = sext_i32_i64(i32_arg0_153856);
    bool bounds_invalid_upwards_153858 = slt64(i32_res_153857, (int64_t) 0);
    bool valid_153859 = !bounds_invalid_upwards_153858;
    bool range_valid_c_153860;
    
    if (!valid_153859) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) i32_res_153857, " is invalid.", "-> #0  ftHashJoin.fut:42:17-32\n   #1  ftHashJoin.fut:373:22-69\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:262:6-265:58\n   #4  ftRelational.fut:259:3-265:58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t i64_res_162322 = sext_i64_i32(b_132815);
    int32_t zm_lhs_162323 = mul32(8, i64_res_162322);
    int32_t min_arg1_162324 = sub32(zm_lhs_162323, 1);
    int32_t min_res_162325 = smin32(getRadix_arg1_153853, min_arg1_162324);
    int32_t i32_arg0_162329 = sub32(i64_res_162322, 1);
    int64_t i32_res_162330 = sext_i32_i64(i32_arg0_162329);
    int32_t zm_rhs_162332 = sdiv32(min_res_162325, 8);
    int32_t zm_lhs_162333 = sub32(i64_res_162322, zm_rhs_162332);
    int32_t i32_arg0_162334 = sub32(zm_lhs_162333, 1);
    int64_t i32_res_162335 = sext_i32_i64(i32_arg0_162334);
    int64_t zm_lhs_162336 = mul64((int64_t) 8, b_132815);
    int64_t min_arg1_162337 = sub64(zm_lhs_162336, (int64_t) 1);
    int64_t min_res_162338 = smin64(i32_res_162335, min_arg1_162337);
    bool x_162355 = sle64((int64_t) 0, i32_res_162330);
    bool y_162356 = slt64(i32_res_162330, b_132815);
    bool bounds_check_162357 = x_162355 && y_162356;
    bool index_certs_162358;
    
    if (!bounds_check_162357) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_162330, "] out of bounds for array of shape [", (long long) b_132815, "].", "-> #0  ftHashJoin.fut:33:50-66\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool x_162366 = sle64((int64_t) 0, min_res_162338);
    bool y_162367 = slt64(min_res_162338, b_132815);
    bool bounds_check_162368 = x_162366 && y_162367;
    bool index_certs_162369;
    
    if (!bounds_check_162368) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_162338, "] out of bounds for array of shape [", (long long) b_132815, "].", "-> #0  ftHashJoin.fut:34:40-56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * dz2080U_132816;
    int64_t bytes_171857 = (int64_t) 8 * dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851;
    int32_t lastBit_162340 = smod32(min_res_162325, 8);
    int32_t zm_lhs_162343 = sub32(8, lastBit_162340);
    int32_t i32_arg0_162344 = sub32(zm_lhs_162343, 1);
    int8_t unsign_arg0_162345 = zext_i32_i8(i32_arg0_162344);
    int8_t unsign_arg0_162346 = lshr8((int8_t) -1, unsign_arg0_162345);
    
    if (mem_171822_cached_sizze_172782 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172782, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171826_cached_sizze_172783 < b_132815) {
        err = lexical_realloc(ctx, &mem_171826, &mem_171826_cached_sizze_172783, b_132815);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171551 = 0; i_171551 < dz2080U_132816; i_171551++) {
        int64_t radix_to_idx_arg1_153867 = ((int64_t *) bounds_mem_171819.mem)[i_171551];
        bool x_153868 = sle64((int64_t) 0, radix_to_idx_arg1_153867);
        bool y_153869 = slt64(radix_to_idx_arg1_153867, n_132814);
        bool bounds_check_153870 = x_153868 && y_153869;
        bool index_certs_153871;
        
        if (!bounds_check_153870) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) radix_to_idx_arg1_153867, "] out of bounds for array of shape [", (long long) n_132814, "].", "-> #0  ftHashJoin.fut:373:48-69\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:262:6-265:58\n   #3  ftRelational.fut:259:3-265:58\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < b_132815; i_171547++) {
            int8_t eta_p_162350 = ((int8_t *) pXs_mem_171818.mem)[radix_to_idx_arg1_153867 * b_132815 + i_171547];
            bool cond_162351 = sle64(i_171547, i32_res_162330);
            bool cond_t_res_162352 = sle64(min_res_162338, i_171547);
            bool x_162353 = cond_162351 && cond_t_res_162352;
            int8_t lifted_lambda_res_162354;
            
            if (x_162353) {
                lifted_lambda_res_162354 = eta_p_162350;
            } else {
                lifted_lambda_res_162354 = (int8_t) 0;
            }
            ((int8_t *) mem_171826)[i_171547] = lifted_lambda_res_162354;
        }
        
        int8_t za_lhs_162359 = ((int8_t *) mem_171826)[i32_res_162330];
        int8_t mod1_x_162360 = (int8_t) -1 & za_lhs_162359;
        
        ((int8_t *) mem_171826)[i32_res_162330] = mod1_x_162360;
        
        int8_t za_lhs_162370 = ((int8_t *) mem_171826)[min_res_162338];
        int8_t tmp_162371 = unsign_arg0_162346 & za_lhs_162370;
        
        ((int8_t *) mem_171826)[min_res_162338] = tmp_162371;
        
        int64_t radix_to_idx_res_153874;
        int64_t y_153876 = (int64_t) 0;
        
        for (int64_t i_153875 = 0; i_153875 < i32_res_153857; i_153875++) {
            int64_t zm_lhs_153877 = sub64(b_132815, i_153875);
            int64_t u8_arg0_153878 = sub64(zm_lhs_153877, (int64_t) 1);
            bool x_153879 = sle64((int64_t) 0, u8_arg0_153878);
            bool y_153880 = slt64(u8_arg0_153878, b_132815);
            bool bounds_check_153881 = x_153879 && y_153880;
            bool index_certs_153882;
            
            if (!bounds_check_153881) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) u8_arg0_153878, "] out of bounds for array of shape [", (long long) b_132815, "].", "-> #0  ftHashJoin.fut:43:25-35\n   #1  ftHashJoin.fut:373:22-69\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftRelational.fut:262:6-265:58\n   #4  ftRelational.fut:259:3-265:58\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int8_t u8_arg0_153883 = ((int8_t *) mem_171826)[u8_arg0_153878];
            int64_t u8_res_153884 = zext_i8_i64(u8_arg0_153883);
            int64_t zlzl_rhs_153885 = mul64((int64_t) 8, i_153875);
            int64_t r_153886 = shl64(u8_res_153884, zlzl_rhs_153885);
            int64_t loopres_153887 = y_153876 | r_153886;
            int64_t y_tmp_172505 = loopres_153887;
            
            y_153876 = y_tmp_172505;
        }
        radix_to_idx_res_153874 = y_153876;
        ((int64_t *) mem_171822)[i_171551] = radix_to_idx_res_153874;
    }
    
    bool cond_153891 = maxDepth_132822 == 1;
    
    if (cond_153891) {
        if (memblock_alloc(ctx, &mem_171850, dz2080U_132816, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172506 = 0; nest_i_172506 < dz2080U_132816; nest_i_172506++) {
            ((bool *) mem_171850.mem)[nest_i_172506] = 1;
        }
        if (memblock_set(ctx, &ext_mem_171856, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171853, &mem_171850, "mem_171850") != 0)
            return 1;
    } else {
        int64_t zeze_rhs_153895 = sub64(dz2080U_132816, (int64_t) 1);
        
        if (memblock_alloc(ctx, &mem_171836, dz2080U_132816, "mem_171836")) {
            err = 1;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171837, dz2080U_132816, "mem_171837")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171557 = 0; i_171557 < dz2080U_132816; i_171557++) {
            int64_t cur_i_153903 = ((int64_t *) mem_171822)[i_171557];
            bool cond_153904 = i_171557 == (int64_t) 0;
            int64_t pre_i_153905;
            
            if (cond_153904) {
                pre_i_153905 = (int64_t) -1;
            } else {
                int64_t tmp_153906 = sub64(i_171557, (int64_t) 1);
                bool x_153907 = sle64((int64_t) 0, tmp_153906);
                bool y_153908 = slt64(tmp_153906, dz2080U_132816);
                bool bounds_check_153909 = x_153907 && y_153908;
                bool index_certs_153910;
                
                if (!bounds_check_153909) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_153906, "] out of bounds for array of shape [", (long long) dz2080U_132816, "].", "-> #0  ftHashJoin.fut:380:44-76\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:378:12-385:10\n   #3  ftRelational.fut:262:6-265:58\n   #4  ftRelational.fut:259:3-265:58\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pre_i_f_res_153911 = ((int64_t *) mem_171822)[tmp_153906];
                
                pre_i_153905 = pre_i_f_res_153911;
            }
            
            bool is_first_153912 = cur_i_153903 == pre_i_153905;
            bool is_first_153913 = !is_first_153912;
            bool cond_153914 = i_171557 == zeze_rhs_153895;
            int64_t pos_i_153915;
            
            if (cond_153914) {
                pos_i_153915 = (int64_t) -1;
            } else {
                int64_t tmp_153916 = add64((int64_t) 1, i_171557);
                bool x_153917 = sle64((int64_t) 0, tmp_153916);
                bool y_153918 = slt64(tmp_153916, dz2080U_132816);
                bool bounds_check_153919 = x_153917 && y_153918;
                bool index_certs_153920;
                
                if (!bounds_check_153919) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_153916, "] out of bounds for array of shape [", (long long) dz2080U_132816, "].", "-> #0  ftHashJoin.fut:382:48-80\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:378:12-385:10\n   #3  ftRelational.fut:262:6-265:58\n   #4  ftRelational.fut:259:3-265:58\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t pos_i_f_res_153921 = ((int64_t *) mem_171822)[tmp_153916];
                
                pos_i_153915 = pos_i_f_res_153921;
            }
            
            bool is_last_153922 = cur_i_153903 == pos_i_153915;
            bool is_last_153923 = !is_last_153922;
            
            ((bool *) mem_171836.mem)[i_171557] = is_first_153913;
            ((bool *) mem_171837.mem)[i_171557] = is_last_153923;
        }
        if (memblock_set(ctx, &ext_mem_171856, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171853, &mem_171837, "mem_171837") != 0)
            return 1;
    }
    if (memblock_alloc(ctx, &mem_171858, bytes_171857, "mem_171858")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172509 = 0; nest_i_172509 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851; nest_i_172509++) {
        ((int64_t *) mem_171858.mem)[nest_i_172509] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171860, bytes_171857, "mem_171860")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172510 = 0; nest_i_172510 < dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851; nest_i_172510++) {
        ((int64_t *) mem_171860.mem)[nest_i_172510] = (int64_t) -1;
    }
    for (int64_t write_iter_171560 = 0; write_iter_171560 < dz2080U_132816; write_iter_171560++) {
        bool write_iv_171563 = ((bool *) ext_mem_171853.mem)[write_iter_171560];
        bool write_iv_171565 = ((bool *) ext_mem_171856.mem)[write_iter_171560];
        int64_t lifted_lambda_res_162542;
        
        if (write_iv_171565) {
            int64_t lifted_lambda_res_t_res_162581 = ((int64_t *) mem_171822)[write_iter_171560];
            
            lifted_lambda_res_162542 = lifted_lambda_res_t_res_162581;
        } else {
            lifted_lambda_res_162542 = (int64_t) -1;
        }
        
        int64_t lifted_lambda_res_162550;
        
        if (write_iv_171563) {
            int64_t lifted_lambda_res_t_res_162586 = ((int64_t *) mem_171822)[write_iter_171560];
            
            lifted_lambda_res_162550 = lifted_lambda_res_t_res_162586;
        } else {
            lifted_lambda_res_162550 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162550) && slt64(lifted_lambda_res_162550, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851)) {
            ((int64_t *) mem_171858.mem)[lifted_lambda_res_162550] = write_iter_171560;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162542) && slt64(lifted_lambda_res_162542, dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851)) {
            ((int64_t *) mem_171860.mem)[lifted_lambda_res_162542] = write_iter_171560;
        }
    }
    if (memblock_unref(ctx, &ext_mem_171853, "ext_mem_171853") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171856, "ext_mem_171856") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171860, "mem_171860") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171858, "mem_171858") != 0)
        return 1;
    prim_out_172502 = dzlz7bUZLztztZRz20U2z20Ursz7dUzg_153851;
    if (memblock_set(ctx, &*mem_out_p_172779, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172780, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_172781 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171822);
        free(mem_171826);
        if (memblock_unref(ctx, &mem_171860, "mem_171860") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171858, "mem_171858") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171837, "mem_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171853, "ext_mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171856, "ext_mem_171856") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_double_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172784, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_150394, int64_t group_no_150395)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_162322 = slt64(group_no_150395, (int64_t) 0);
    bool valid_162323 = !bounds_invalid_upwards_162322;
    bool range_valid_c_162324;
    
    if (!valid_162323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_150395, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:49-51\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:349:24-52\n   #4  ftRelational.fut:349:5-52\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171820 = (int64_t) 8 * group_no_150395;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_150395; nest_i_172501++) {
        ((double *) mem_171821.mem)[nest_i_172501] = 0.0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_150394; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        double pixel_171548 = ((double *) eta_p_mem_171819.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(group_no_150395, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            double read_hist_171553 = ((double *) mem_171821.mem)[pixel_171547];
            double zp_res_162329 = pixel_171548 + read_hist_171553;
            
            ((double *) mem_171821.mem)[pixel_171547] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172784, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_double_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172785, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150471, int64_t group_no_150472)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * group_no_150472;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_150472; nest_i_172501++) {
        ((double *) mem_171822.mem)[nest_i_172501] = 0.0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_150471; iter_171545++) {
        double pixel_171547 = ((double *) eta_p_mem_171819.mem)[iter_171545];
        double pixel_171548 = ((double *) eta_p_mem_171820.mem)[iter_171545];
        int64_t pixel_171549 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        double zt_res_162518 = pixel_171547 * pixel_171548;
        bool less_than_zzero_171550 = slt64(pixel_171549, (int64_t) 0);
        bool greater_than_sizze_171551 = sle64(group_no_150472, pixel_171549);
        bool outside_bounds_dim_171552 = less_than_zzero_171550 || greater_than_sizze_171551;
        
        if (!outside_bounds_dim_171552) {
            double read_hist_171554 = ((double *) mem_171822.mem)[pixel_171549];
            double zp_res_162329 = zt_res_162518 + read_hist_171554;
            
            ((double *) mem_171822.mem)[pixel_171549] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172785, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_172786, struct memblock ks_mem_171818, int64_t nz2082U_143701, int64_t key_no_143702)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_153359 = slt64(key_no_143702, (int64_t) 0);
    bool valid_153360 = !bounds_invalid_upwards_153359;
    bool range_valid_c_153361;
    
    if (!valid_153360) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) key_no_143702, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:40:39-52\n   #2  ftRelational.fut:289:7-38\n   #3  ftRelational.fut:288:5-289:38\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * key_no_143702;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < key_no_143702; nest_i_172501++) {
        ((int64_t *) mem_171820.mem)[nest_i_172501] = (int64_t) 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2082U_143701; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) ks_mem_171818.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(key_no_143702, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            int64_t read_hist_171553 = ((int64_t *) mem_171820.mem)[pixel_171547];
            int64_t defunc_0_op_res_153366 = add64((int64_t) 1, read_hist_171553);
            
            ((int64_t *) mem_171820.mem)[pixel_171547] = defunc_0_op_res_153366;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172786, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_float_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172787, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_150183, int64_t group_no_150184)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_162322 = slt64(group_no_150184, (int64_t) 0);
    bool valid_162323 = !bounds_invalid_upwards_162322;
    bool range_valid_c_162324;
    
    if (!valid_162323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_150184, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:49-51\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:346:23-50\n   #4  ftRelational.fut:346:5-50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171820 = (int64_t) 4 * group_no_150184;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_150184; nest_i_172501++) {
        ((float *) mem_171821.mem)[nest_i_172501] = 0.0F;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_150183; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        float pixel_171548 = ((float *) eta_p_mem_171819.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(group_no_150184, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            float read_hist_171553 = ((float *) mem_171821.mem)[pixel_171547];
            float zp_res_162329 = pixel_171548 + read_hist_171553;
            
            ((float *) mem_171821.mem)[pixel_171547] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172787, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_float_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172788, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150260, int64_t group_no_150261)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 4 * group_no_150261;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_150261; nest_i_172501++) {
        ((float *) mem_171822.mem)[nest_i_172501] = 0.0F;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_150260; iter_171545++) {
        float pixel_171547 = ((float *) eta_p_mem_171819.mem)[iter_171545];
        float pixel_171548 = ((float *) eta_p_mem_171820.mem)[iter_171545];
        int64_t pixel_171549 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        float zt_res_162518 = pixel_171547 * pixel_171548;
        bool less_than_zzero_171550 = slt64(pixel_171549, (int64_t) 0);
        bool greater_than_sizze_171551 = sle64(group_no_150261, pixel_171549);
        bool outside_bounds_dim_171552 = less_than_zzero_171550 || greater_than_sizze_171551;
        
        if (!outside_bounds_dim_171552) {
            float read_hist_171554 = ((float *) mem_171822.mem)[pixel_171549];
            float zp_res_162329 = zt_res_162518 + read_hist_171554;
            
            ((float *) mem_171822.mem)[pixel_171549] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172788, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_172789, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_82032, int64_t dz2083U_82033, int64_t incr_82034, int64_t psizze_82035, int64_t pL_bytes_82037)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172790 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock ext_mem_171845;
    
    ext_mem_171845.references = NULL;
    
    struct memblock mem_171835;
    
    mem_171835.references = NULL;
    
    struct memblock mem_param_171833;
    
    mem_param_171833.references = NULL;
    
    struct memblock ext_mem_171853;
    
    ext_mem_171853.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t i64_res_153845 = sext_i64_i32(pL_bytes_82037);
    int32_t gather_payloads_arg0_153846 = mul32(8, i64_res_153845);
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_82032;
    int64_t bytes_171828 = niz2084U_82032 * pL_bytes_82037;
    int32_t zm_lhs_153851 = add32(8, gather_payloads_arg0_153846);
    int32_t zs_lhs_153852 = sub32(zm_lhs_153851, 1);
    int32_t i32_arg0_153853 = sdiv32(zs_lhs_153852, 8);
    int64_t i32_res_153854 = sext_i32_i64(i32_arg0_153853);
    bool zzero_153855 = i32_res_153854 == (int64_t) 0;
    bool nonzzero_153856 = !zzero_153855;
    bool nonzzero_cert_153857;
    
    if (!nonzzero_153856) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n   #1  ftRelational.fut:68:3-69:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_153858 = sdiv64(psizze_82035, i32_res_153854);
    int64_t max_res_153859 = smax64((int64_t) 1, max_arg1_153858);
    int64_t zm_lhs_153860 = add64(dz2083U_82033, max_res_153859);
    int64_t zs_lhs_153861 = sub64(zm_lhs_153860, (int64_t) 1);
    bool zzero_153862 = max_res_153859 == (int64_t) 0;
    bool nonzzero_153863 = !zzero_153862;
    bool nonzzero_cert_153864;
    
    if (!nonzzero_153863) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n   #1  ftRelational.fut:68:3-69:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_153865 = sdiv64(zs_lhs_153861, max_res_153859);
    bool bounds_invalid_upwards_153866 = slt64(max_iter_153865, (int64_t) 0);
    bool valid_153867 = !bounds_invalid_upwards_153866;
    bool range_valid_c_153868;
    
    if (!valid_153867) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_153865, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n   #2  ftRelational.fut:68:3-69:104\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171821_cached_sizze_172790 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172790, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_82032; i_171547++) {
        int64_t eta_p_153848 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153849 = sub64(eta_p_153848, incr_82034);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153849;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_82032; nest_i_172502++) {
        for (int64_t nest_i_172503 = 0; nest_i_172503 < pL_bytes_82037; nest_i_172503++) {
            ((int8_t *) mem_171829.mem)[nest_i_172502 * pL_bytes_82037 + nest_i_172503] = (int8_t) 0;
        }
    }
    if (memblock_set(ctx, &mem_param_171833, &mem_171829, "mem_171829") != 0)
        return 1;
    for (int64_t i_153870 = 0; i_153870 < max_iter_153865; i_153870++) {
        int64_t inf_153872 = mul64(max_res_153859, i_153870);
        int64_t min_arg1_153873 = add64(max_res_153859, inf_153872);
        int64_t min_res_153874 = smin64(dz2083U_82033, min_arg1_153873);
        
        if (memblock_alloc(ctx, &mem_171835, bytes_171828, "mem_171835")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < niz2084U_82032; i_171551++) {
            int64_t eta_p_153876 = ((int64_t *) mem_171821)[i_171551];
            bool cond_153878 = sle64(inf_153872, eta_p_153876);
            bool cond_t_res_153879 = slt64(eta_p_153876, min_res_153874);
            bool x_153880 = cond_153878 && cond_t_res_153879;
            int64_t binop_y_171840 = pL_bytes_82037 * i_171551;
            int64_t lmad_ext_171842 = pL_bytes_82037 * eta_p_153876;
            int64_t ext_171844;
            
            if (x_153880) {
                ext_171844 = lmad_ext_171842;
            } else {
                ext_171844 = binop_y_171840;
            }
            if (x_153880) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153876);
                bool y_162515 = slt64(eta_p_153876, dz2083U_82033);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153876, "] out of bounds for array of shape [", (long long) dz2083U_82033, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n   #3  ftRelational.fut:68:3-69:104\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (memblock_set(ctx, &ext_mem_171845, &ys_mem_171819, "ys_mem_171819") != 0)
                    return 1;
            } else if (memblock_set(ctx, &ext_mem_171845, &mem_param_171833, "mem_param_171833") != 0)
                return 1;
            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171835.mem, i_171551 * pL_bytes_82037, (int64_t []) {(int64_t) 1}, (uint8_t *) ext_mem_171845.mem, ext_171844, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_bytes_82037});
            if (memblock_unref(ctx, &ext_mem_171845, "ext_mem_171845") != 0)
                return 1;
        }
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171835, "mem_171835") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171833, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171853, &mem_param_171833, "mem_param_171833") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171853, "ext_mem_171853") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172789, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171845, "ext_mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171835, "mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171833, "mem_param_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171853, "ext_mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double(struct futhark_context *ctx, struct memblock *mem_out_p_172791, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81665, int64_t dz2083U_81666, int64_t incr_81667, int64_t psizze_81668)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172792 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_81665;
    
    if (mem_171821_cached_sizze_172792 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172792, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_81665; i_171547++) {
        int64_t eta_p_153530 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153531 = sub64(eta_p_153530, incr_81667);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153531;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171820, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_81665; nest_i_172502++) {
        ((double *) mem_171829.mem)[nest_i_172502] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81665});
    if (futrts_partitioned_gather_over_array_15667(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, niz2084U_81665, dz2083U_81666, 64, psizze_81668) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172791, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172793, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82320, int64_t n_82321, int64_t incr_82322, int64_t psizze_82323)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172794 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock ext_mem_171832;
    
    ext_mem_171832.references = NULL;
    
    struct memblock mem_171830;
    
    mem_171830.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * ni_82320;
    
    if (mem_171822_cached_sizze_172794 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172794, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < ni_82320; i_171547++) {
        int64_t eta_p_153363 = ((int64_t *) is_mem_171819.mem)[i_171547];
        int64_t lifted_lambda_res_153364 = sub64(eta_p_153363, incr_82322);
        
        ((int64_t *) mem_171822)[i_171547] = lifted_lambda_res_153364;
    }
    if (memblock_alloc(ctx, &mem_171830, bytes_171821, "mem_171830")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171822, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_82320});
    if (futrts_partitioned_gather_over_array_15667(ctx, &ext_mem_171832, preVals_mem_171818, ys_mem_171820, mem_171830, ni_82320, n_82321, 64, psizze_82323) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171832, "ext_mem_171832") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172793, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171822);
        if (memblock_unref(ctx, &ext_mem_171832, "ext_mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float(struct futhark_context *ctx, struct memblock *mem_out_p_172795, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81600, int64_t dz2083U_81601, int64_t incr_81602, int64_t psizze_81603)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172796 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_81600;
    int64_t bytes_171828 = (int64_t) 4 * niz2084U_81600;
    
    if (mem_171821_cached_sizze_172796 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172796, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_81600; i_171547++) {
        int64_t eta_p_153530 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153531 = sub64(eta_p_153530, incr_81602);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153531;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_81600; nest_i_172502++) {
        ((float *) mem_171829.mem)[nest_i_172502] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81600});
    if (futrts_partitioned_gather_over_array_15655(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, niz2084U_81600, dz2083U_81601, 32, psizze_81603) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172795, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172797, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82263, int64_t n_82264, int64_t incr_82265, int64_t psizze_82266)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172798 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock ext_mem_171832;
    
    ext_mem_171832.references = NULL;
    
    struct memblock mem_171830;
    
    mem_171830.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * ni_82263;
    
    if (mem_171822_cached_sizze_172798 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172798, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < ni_82263; i_171547++) {
        int64_t eta_p_153363 = ((int64_t *) is_mem_171819.mem)[i_171547];
        int64_t lifted_lambda_res_153364 = sub64(eta_p_153363, incr_82265);
        
        ((int64_t *) mem_171822)[i_171547] = lifted_lambda_res_153364;
    }
    if (memblock_alloc(ctx, &mem_171830, bytes_171821, "mem_171830")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171822, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_82263});
    if (futrts_partitioned_gather_over_array_15655(ctx, &ext_mem_171832, preVals_mem_171818, ys_mem_171820, mem_171830, ni_82263, n_82264, 32, psizze_82266) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171832, "ext_mem_171832") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172797, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171822);
        if (memblock_unref(ctx, &ext_mem_171832, "ext_mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int(struct futhark_context *ctx, struct memblock *mem_out_p_172799, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81470, int64_t dz2083U_81471, int64_t incr_81472, int64_t psizze_81473)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172800 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_81470;
    int64_t bytes_171828 = (int64_t) 4 * niz2084U_81470;
    
    if (mem_171821_cached_sizze_172800 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172800, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_81470; i_171547++) {
        int64_t eta_p_153530 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153531 = sub64(eta_p_153530, incr_81472);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153531;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_81470; nest_i_172502++) {
        ((int32_t *) mem_171829.mem)[nest_i_172502] = 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81470});
    if (futrts_partitioned_gather_over_array_15632(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, niz2084U_81470, dz2083U_81471, 32, psizze_81473) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172799, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172801, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82149, int64_t n_82150, int64_t incr_82151, int64_t psizze_82152)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172802 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock ext_mem_171832;
    
    ext_mem_171832.references = NULL;
    
    struct memblock mem_171830;
    
    mem_171830.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * ni_82149;
    
    if (mem_171822_cached_sizze_172802 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172802, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < ni_82149; i_171547++) {
        int64_t eta_p_153363 = ((int64_t *) is_mem_171819.mem)[i_171547];
        int64_t lifted_lambda_res_153364 = sub64(eta_p_153363, incr_82151);
        
        ((int64_t *) mem_171822)[i_171547] = lifted_lambda_res_153364;
    }
    if (memblock_alloc(ctx, &mem_171830, bytes_171821, "mem_171830")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171822, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_82149});
    if (futrts_partitioned_gather_over_array_15632(ctx, &ext_mem_171832, preVals_mem_171818, ys_mem_171820, mem_171830, ni_82149, n_82150, 32, psizze_82152) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171832, "ext_mem_171832") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172801, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171822);
        if (memblock_unref(ctx, &ext_mem_171832, "ext_mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long(struct futhark_context *ctx, struct memblock *mem_out_p_172803, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81535, int64_t dz2083U_81536, int64_t incr_81537, int64_t psizze_81538)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172804 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_81535;
    
    if (mem_171821_cached_sizze_172804 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172804, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_81535; i_171547++) {
        int64_t eta_p_153530 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153531 = sub64(eta_p_153530, incr_81537);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153531;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171820, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_81535; nest_i_172502++) {
        ((int64_t *) mem_171829.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81535});
    if (futrts_partitioned_gather_over_array_15643(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, niz2084U_81535, dz2083U_81536, 64, psizze_81538) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172803, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172805, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82206, int64_t n_82207, int64_t incr_82208, int64_t psizze_82209)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172806 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock ext_mem_171832;
    
    ext_mem_171832.references = NULL;
    
    struct memblock mem_171830;
    
    mem_171830.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * ni_82206;
    
    if (mem_171822_cached_sizze_172806 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172806, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < ni_82206; i_171547++) {
        int64_t eta_p_153363 = ((int64_t *) is_mem_171819.mem)[i_171547];
        int64_t lifted_lambda_res_153364 = sub64(eta_p_153363, incr_82208);
        
        ((int64_t *) mem_171822)[i_171547] = lifted_lambda_res_153364;
    }
    if (memblock_alloc(ctx, &mem_171830, bytes_171821, "mem_171830")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171822, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_82206});
    if (futrts_partitioned_gather_over_array_15643(ctx, &ext_mem_171832, preVals_mem_171818, ys_mem_171820, mem_171830, ni_82206, n_82207, 64, psizze_82209) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171832, "ext_mem_171832") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172805, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171822);
        if (memblock_unref(ctx, &ext_mem_171832, "ext_mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short(struct futhark_context *ctx, struct memblock *mem_out_p_172807, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t niz2084U_81405, int64_t dz2083U_81406, int64_t incr_81407, int64_t psizze_81408)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_172808 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * niz2084U_81405;
    int64_t bytes_171828 = (int64_t) 2 * niz2084U_81405;
    
    if (mem_171821_cached_sizze_172808 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_172808, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < niz2084U_81405; i_171547++) {
        int64_t eta_p_153530 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153531 = sub64(eta_p_153530, incr_81407);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153531;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < niz2084U_81405; nest_i_172502++) {
        ((int16_t *) mem_171829.mem)[nest_i_172502] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {niz2084U_81405});
    if (futrts_partitioned_gather_over_array_15620(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, niz2084U_81405, dz2083U_81406, 16, psizze_81408) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172807, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_172809, struct memblock preVals_mem_171818, struct memblock is_mem_171819, struct memblock ys_mem_171820, int64_t ni_82092, int64_t n_82093, int64_t incr_82094, int64_t psizze_82095)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171822_cached_sizze_172810 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock ext_mem_171832;
    
    ext_mem_171832.references = NULL;
    
    struct memblock mem_171830;
    
    mem_171830.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * ni_82092;
    
    if (mem_171822_cached_sizze_172810 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_172810, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < ni_82092; i_171547++) {
        int64_t eta_p_153363 = ((int64_t *) is_mem_171819.mem)[i_171547];
        int64_t lifted_lambda_res_153364 = sub64(eta_p_153363, incr_82094);
        
        ((int64_t *) mem_171822)[i_171547] = lifted_lambda_res_153364;
    }
    if (memblock_alloc(ctx, &mem_171830, bytes_171821, "mem_171830")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171822, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {ni_82092});
    if (futrts_partitioned_gather_over_array_15620(ctx, &ext_mem_171832, preVals_mem_171818, ys_mem_171820, mem_171830, ni_82092, n_82093, 16, psizze_82095) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171832, "ext_mem_171832") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172809, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171822);
        if (memblock_unref(ctx, &ext_mem_171832, "ext_mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171830, "mem_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_double(struct futhark_context *ctx, struct memblock *mem_out_p_172811, struct memblock *mem_out_p_172812, struct memblock *mem_out_p_172813, int64_t *out_prim_out_172814, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_127457, int64_t nS_127458, int64_t offset_R_127461, int64_t offset_S_127462, int64_t partitionSizze_127463, int64_t scatter_psizze_127464)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171914_cached_sizze_172815 = 0;
    unsigned char *mem_171914 = NULL;
    int64_t mem_171916_cached_sizze_172816 = 0;
    unsigned char *mem_171916 = NULL;
    int64_t mem_171918_cached_sizze_172817 = 0;
    unsigned char *mem_171918 = NULL;
    int64_t mem_171920_cached_sizze_172818 = 0;
    unsigned char *mem_171920 = NULL;
    int64_t mem_171922_cached_sizze_172819 = 0;
    unsigned char *mem_171922 = NULL;
    int64_t mem_171924_cached_sizze_172820 = 0;
    unsigned char *mem_171924 = NULL;
    int64_t mem_171926_cached_sizze_172821 = 0;
    unsigned char *mem_171926 = NULL;
    int64_t mem_171970_cached_sizze_172822 = 0;
    unsigned char *mem_171970 = NULL;
    int64_t mem_172002_cached_sizze_172823 = 0;
    unsigned char *mem_172002 = NULL;
    int64_t mem_172004_cached_sizze_172824 = 0;
    unsigned char *mem_172004 = NULL;
    struct memblock mem_172064;
    
    mem_172064.references = NULL;
    
    struct memblock mem_172062;
    
    mem_172062.references = NULL;
    
    struct memblock mem_172060;
    
    mem_172060.references = NULL;
    
    struct memblock mem_param_tmp_172558;
    
    mem_param_tmp_172558.references = NULL;
    
    struct memblock mem_param_tmp_172557;
    
    mem_param_tmp_172557.references = NULL;
    
    struct memblock mem_param_tmp_172556;
    
    mem_param_tmp_172556.references = NULL;
    
    struct memblock mem_172031;
    
    mem_172031.references = NULL;
    
    struct memblock mem_172029;
    
    mem_172029.references = NULL;
    
    struct memblock mem_172027;
    
    mem_172027.references = NULL;
    
    struct memblock mem_param_172025;
    
    mem_param_172025.references = NULL;
    
    struct memblock mem_param_172022;
    
    mem_param_172022.references = NULL;
    
    struct memblock mem_param_172019;
    
    mem_param_172019.references = NULL;
    
    struct memblock ext_mem_172056;
    
    ext_mem_172056.references = NULL;
    
    struct memblock ext_mem_172057;
    
    ext_mem_172057.references = NULL;
    
    struct memblock ext_mem_172058;
    
    ext_mem_172058.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171980;
    
    mem_171980.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_171906;
    
    mem_171906.references = NULL;
    
    struct memblock mem_171904;
    
    mem_171904.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_171872;
    
    mem_171872.references = NULL;
    
    struct memblock mem_171870;
    
    mem_171870.references = NULL;
    
    struct memblock mem_param_tmp_172530;
    
    mem_param_tmp_172530.references = NULL;
    
    struct memblock mem_171859;
    
    mem_171859.references = NULL;
    
    struct memblock mem_param_171857;
    
    mem_param_171857.references = NULL;
    
    struct memblock ext_mem_171868;
    
    ext_mem_171868.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_param_171843;
    
    mem_param_171843.references = NULL;
    
    struct memblock ext_mem_171854;
    
    ext_mem_171854.references = NULL;
    
    struct memblock ext_mem_171887;
    
    ext_mem_171887.references = NULL;
    
    struct memblock ext_mem_171890;
    
    ext_mem_171890.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock ext_mem_171896;
    
    ext_mem_171896.references = NULL;
    
    struct memblock mem_param_171840;
    
    mem_param_171840.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171901;
    
    ext_mem_171901.references = NULL;
    
    struct memblock ext_mem_171902;
    
    ext_mem_171902.references = NULL;
    
    struct memblock mem_171834;
    
    mem_171834.references = NULL;
    
    struct memblock mem_171832;
    
    mem_171832.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock ext_mem_171912;
    
    ext_mem_171912.references = NULL;
    
    struct memblock mem_171824;
    
    mem_171824.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t partitionSizze_154510 = sdiv64(partitionSizze_127463, (int64_t) 8);
    int64_t zm_lhs_154511 = add64(nR_127457, partitionSizze_154510);
    int64_t zs_lhs_154512 = sub64(zm_lhs_154511, (int64_t) 1);
    bool zzero_154513 = partitionSizze_154510 == (int64_t) 0;
    bool nonzzero_154514 = !zzero_154513;
    bool nonzzero_cert_154515;
    
    if (!nonzzero_154514) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_154516 = sdiv64(zs_lhs_154512, partitionSizze_154510);
    int64_t zm_lhs_154517 = add64(nS_127458, partitionSizze_154510);
    int64_t zs_lhs_154518 = sub64(zm_lhs_154517, (int64_t) 1);
    int64_t numIter_S_154519 = sdiv64(zs_lhs_154518, partitionSizze_154510);
    
    if (futrts_indicesWithIncrement_16384(ctx, &ext_mem_171820, tR_mem_171818, nR_127457, offset_R_127461) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * nR_127457;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < nR_127457; nest_i_172504++) {
        ((int64_t *) mem_171822.mem)[nest_i_172504] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171824, bytes_171821, "mem_171824")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < nR_127457; nest_i_172505++) {
        ((int64_t *) mem_171824.mem)[nest_i_172505] = (int64_t) 0;
    }
    
    bool loop_cond_154523 = slt64((int64_t) 0, numIter_R_154516);
    bool defunc_0_mergeJoin_res_154524;
    int64_t defunc_0_mergeJoin_res_154525;
    int64_t defunc_0_mergeJoin_res_154528;
    bool loop_while_154529;
    int64_t iter_154530;
    int64_t first_relevant_in_S_154533;
    
    if (memblock_set(ctx, &mem_param_171827, &mem_171824, "mem_171824") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_while_154529 = loop_cond_154523;
    iter_154530 = (int64_t) 0;
    first_relevant_in_S_154533 = (int64_t) 0;
    while (loop_while_154529) {
        int64_t tR_start_154534 = mul64(partitionSizze_154510, iter_154530);
        int64_t min_arg1_154535 = add64(partitionSizze_154510, tR_start_154534);
        int64_t min_res_154536 = smin64(nR_127457, min_arg1_154535);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 = sub64(min_res_154536, tR_start_154534);
        bool empty_slice_154538 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 == (int64_t) 0;
        int64_t m_154539 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, (int64_t) 1);
        int64_t i_p_m_t_s_154540 = add64(tR_start_154534, m_154539);
        bool zzero_leq_i_p_m_t_s_154541 = sle64((int64_t) 0, i_p_m_t_s_154540);
        bool i_p_m_t_s_leq_w_154542 = slt64(i_p_m_t_s_154540, nR_127457);
        bool zzero_lte_i_154543 = sle64((int64_t) 0, tR_start_154534);
        bool i_lte_j_154544 = sle64(tR_start_154534, min_res_154536);
        bool y_154545 = i_p_m_t_s_leq_w_154542 && zzero_lte_i_154543;
        bool y_154546 = zzero_leq_i_p_m_t_s_154541 && y_154545;
        bool forwards_ok_154547 = i_lte_j_154544 && y_154546;
        bool ok_or_empty_154548 = empty_slice_154538 || forwards_ok_154547;
        bool index_certs_154549;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171831 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537;
        bool cond_154553 = slt64(first_relevant_in_S_154533, numIter_S_154519);
        bool y_154554 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool loop_not_taken_154555 = !cond_154553;
        bool protect_assert_disj_154556 = y_154554 || loop_not_taken_154555;
        bool index_certs_154557;
        
        if (!protect_assert_disj_154556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154560 = sle64((int64_t) 0, m_154539);
        bool y_154561 = slt64(m_154539, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool bounds_check_154562 = x_154560 && y_154561;
        bool protect_assert_disj_154563 = loop_not_taken_154555 || bounds_check_154562;
        bool index_certs_154564;
        
        if (!protect_assert_disj_154563) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154795;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:216:99-102\n   #4  ftRelational.fut:207:3-216:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171832, bytes_171831, "mem_171832")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172513 = 0; nest_i_172513 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172513++) {
            ((int64_t *) mem_171832.mem)[nest_i_172513] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171834, bytes_171831, "mem_171834")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172514 = 0; nest_i_172514 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172514++) {
            ((int64_t *) mem_171834.mem)[nest_i_172514] = (int64_t) 0;
        }
        
        double gt_lhs_154558;
        
        if (cond_154553) {
            double x_163142 = ((double *) tR_mem_171818.mem)[tR_start_154534];
            
            gt_lhs_154558 = x_163142;
        } else {
            gt_lhs_154558 = 0.0;
        }
        
        double lt_lhs_154565;
        
        if (cond_154553) {
            double x_163143 = ((double *) tR_mem_171818.mem)[i_p_m_t_s_154540];
            
            lt_lhs_154565 = x_163143;
        } else {
            lt_lhs_154565 = 0.0;
        }
        
        int64_t ext_171900;
        int64_t ext_171899;
        int64_t ext_171898;
        int64_t ext_171897;
        bool loopres_154567;
        int64_t loopres_154568;
        int64_t loopres_154571;
        bool loop_while_154572;
        int64_t s_iter_154573;
        int64_t minRelevant_154576;
        int64_t ctx_param_ext_171835;
        int64_t ctx_param_ext_171836;
        int64_t ctx_param_ext_171838;
        int64_t ctx_param_ext_171839;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171840, &mem_171832, "mem_171832") != 0)
            return 1;
        ctx_param_ext_171835 = (int64_t) 0;
        ctx_param_ext_171836 = (int64_t) 1;
        ctx_param_ext_171838 = (int64_t) 0;
        ctx_param_ext_171839 = (int64_t) 1;
        loop_while_154572 = cond_154553;
        s_iter_154573 = first_relevant_in_S_154533;
        minRelevant_154576 = first_relevant_in_S_154533;
        while (loop_while_154572) {
            int64_t tS_start_154577 = mul64(partitionSizze_154510, s_iter_154573);
            int64_t min_arg1_154578 = add64(partitionSizze_154510, tS_start_154577);
            int64_t min_res_154579 = smin64(nS_127458, min_arg1_154578);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 = sub64(min_res_154579, tS_start_154577);
            bool empty_slice_154581 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 == (int64_t) 0;
            int64_t m_154582 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, (int64_t) 1);
            int64_t i_p_m_t_s_154583 = add64(tS_start_154577, m_154582);
            bool zzero_leq_i_p_m_t_s_154584 = sle64((int64_t) 0, i_p_m_t_s_154583);
            bool i_p_m_t_s_leq_w_154585 = slt64(i_p_m_t_s_154583, nS_127458);
            bool zzero_lte_i_154586 = sle64((int64_t) 0, tS_start_154577);
            bool i_lte_j_154587 = sle64(tS_start_154577, min_res_154579);
            bool y_154588 = i_p_m_t_s_leq_w_154585 && zzero_lte_i_154586;
            bool y_154589 = zzero_leq_i_p_m_t_s_154584 && y_154588;
            bool forwards_ok_154590 = i_lte_j_154587 && y_154589;
            bool ok_or_empty_154591 = empty_slice_154581 || forwards_ok_154590;
            bool index_certs_154592;
            
            if (!ok_or_empty_154591) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154577, ":", (long long) min_res_154579, "] out of bounds for array of shape [", (long long) nS_127458, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154593 = sle64((int64_t) 0, m_154582);
            bool y_154594 = slt64(m_154582, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool bounds_check_154595 = x_154593 && y_154594;
            bool index_certs_154596;
            
            if (!bounds_check_154595) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154599 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool index_certs_154600;
            
            if (!y_154599) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double gt_rhs_154597 = ((double *) tS_mem_171819.mem)[i_p_m_t_s_154583];
            bool defunc_0_gt_res_154598 = gt_rhs_154597 < gt_lhs_154558;
            double lt_rhs_154601 = ((double *) tS_mem_171819.mem)[tS_start_154577];
            bool defunc_0_lt_res_154602 = lt_lhs_154565 < lt_rhs_154601;
            bool thisStillRel_154603 = !defunc_0_lt_res_154602;
            int64_t ext_171889;
            
            if (defunc_0_lt_res_154602) {
                ext_171889 = ctx_param_ext_171835;
            } else {
                ext_171889 = (int64_t) 0;
            }
            
            int64_t ext_171888;
            
            if (defunc_0_lt_res_154602) {
                ext_171888 = ctx_param_ext_171836;
            } else {
                ext_171888 = (int64_t) 1;
            }
            
            int64_t ext_171886;
            
            if (defunc_0_lt_res_154602) {
                ext_171886 = ctx_param_ext_171838;
            } else {
                ext_171886 = (int64_t) 0;
            }
            
            int64_t ext_171885;
            
            if (defunc_0_lt_res_154602) {
                ext_171885 = ctx_param_ext_171839;
            } else {
                ext_171885 = (int64_t) 1;
            }
            
            int64_t ext_171895;
            
            if (defunc_0_gt_res_154598) {
                ext_171895 = ctx_param_ext_171835;
            } else {
                ext_171895 = ext_171889;
            }
            
            int64_t ext_171894;
            
            if (defunc_0_gt_res_154598) {
                ext_171894 = ctx_param_ext_171836;
            } else {
                ext_171894 = ext_171888;
            }
            
            int64_t ext_171892;
            
            if (defunc_0_gt_res_154598) {
                ext_171892 = ctx_param_ext_171838;
            } else {
                ext_171892 = ext_171886;
            }
            
            int64_t ext_171891;
            
            if (defunc_0_gt_res_154598) {
                ext_171891 = ctx_param_ext_171839;
            } else {
                ext_171891 = ext_171885;
            }
            
            int64_t loopres_154604;
            bool loopres_154607;
            int64_t loopres_154608;
            
            if (defunc_0_gt_res_154598) {
                int64_t tmp_163144 = add64((int64_t) 1, s_iter_154573);
                
                if (memblock_set(ctx, &ext_mem_171896, &mem_param_171837, "mem_param_171837") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &mem_param_171840, "mem_param_171840") != 0)
                    return 1;
                loopres_154604 = tmp_163144;
                loopres_154607 = 1;
                loopres_154608 = tmp_163144;
            } else {
                int64_t loopres_f_res_154610;
                bool loopres_f_res_154613;
                
                if (defunc_0_lt_res_154602) {
                    if (memblock_set(ctx, &ext_mem_171890, &mem_param_171837, "mem_param_171837") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_param_171840, "mem_param_171840") != 0)
                        return 1;
                    loopres_f_res_154610 = s_iter_154573;
                    loopres_f_res_154613 = thisStillRel_154603;
                } else {
                    bool index_certs_154614;
                    
                    if (!bounds_check_154562) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lt_lhs_154615 = ((double *) tR_mem_171818.mem)[i_p_m_t_s_154540];
                    bool defunc_0_lt_res_154616 = lt_lhs_154615 < gt_rhs_154597;
                    bool nextRel_154617 = !defunc_0_lt_res_154616;
                    int64_t find_joinTuples_arg3_154618 = add64(offset_S_127462, tS_start_154577);
                    double i64_res_154619 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                    double log2_res_154620 = futrts_log2_64(i64_res_154619);
                    double ceil_res_154621 = futrts_ceil64(log2_res_154620);
                    int64_t f64_res_154622 = fptosi_f64_i64(ceil_res_154621);
                    int64_t num_iter_154623 = add64((int64_t) 1, f64_res_154622);
                    int64_t bsearch_first_154625;
                    int64_t last_step_154628;
                    
                    if (memblock_set(ctx, &mem_param_171843, &mem_171834, "mem_171834") != 0)
                        return 1;
                    last_step_154628 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154626 = 0; i_154626 < num_iter_154623; i_154626++) {
                        int64_t zs_lhs_154629 = add64((int64_t) 1, last_step_154628);
                        int64_t this_step_154630 = sdiv64(zs_lhs_154629, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171845, bytes_171831, "mem_171845")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171547++) {
                            int64_t eta_p_162698 = ((int64_t *) mem_param_171843.mem)[i_171547];
                            int64_t slice_171796 = tR_start_154534 + i_171547;
                            double eta_p_162699 = ((double *) tR_mem_171818.mem)[slice_171796];
                            bool cond_162701 = sle64(eta_p_162698, (int64_t) 0);
                            double prev_elem_162702;
                            
                            if (cond_162701) {
                                bool index_certs_163146;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162702 = lt_rhs_154601;
                            } else {
                                int64_t tmp_162706 = sub64(eta_p_162698, (int64_t) 1);
                                bool x_162707 = sle64((int64_t) 0, tmp_162706);
                                bool y_162708 = slt64(tmp_162706, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162709 = x_162707 && y_162708;
                                bool index_certs_162710;
                                
                                if (!bounds_check_162709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162706, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162711 = tS_start_154577 + tmp_162706;
                                double prev_elem_f_res_162712 = ((double *) tS_mem_171819.mem)[slice_162711];
                                
                                prev_elem_162702 = prev_elem_f_res_162712;
                            }
                            
                            bool cond_162713 = slt64(eta_p_162698, (int64_t) 0);
                            double cur_elem_162714;
                            
                            if (cond_162713) {
                                bool index_certs_163149;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162714 = lt_rhs_154601;
                            } else {
                                bool x_162718 = sle64((int64_t) 0, eta_p_162698);
                                bool y_162719 = slt64(eta_p_162698, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162720 = x_162718 && y_162719;
                                bool index_certs_162721;
                                
                                if (!bounds_check_162720) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162698, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162722 = tS_start_154577 + eta_p_162698;
                                double cur_elem_f_res_162723 = ((double *) tS_mem_171819.mem)[slice_162722];
                                
                                cur_elem_162714 = cur_elem_f_res_162723;
                            }
                            
                            bool cond_162724 = sle64(m_154582, eta_p_162698);
                            double next_elem_162725;
                            
                            if (cond_162724) {
                                bool index_certs_163155;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162725 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162733 = add64((int64_t) 1, eta_p_162698);
                                bool x_162734 = sle64((int64_t) 0, tmp_162733);
                                bool y_162735 = slt64(tmp_162733, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162736 = x_162734 && y_162735;
                                bool index_certs_162737;
                                
                                if (!bounds_check_162736) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162733, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162738 = tS_start_154577 + tmp_162733;
                                double next_elem_f_res_162739 = ((double *) tS_mem_171819.mem)[slice_162738];
                                
                                next_elem_162725 = next_elem_f_res_162739;
                            }
                            
                            int64_t defunc_0_f_res_162744;
                            
                            if (cond_162713) {
                                defunc_0_f_res_162744 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162745 = eta_p_162699 == cur_elem_162714;
                                bool cond_162746 = eta_p_162698 == (int64_t) 0;
                                bool defunc_0_gt_res_162747 = prev_elem_162702 < eta_p_162699;
                                bool x_162748 = !cond_162746;
                                bool y_162749 = defunc_0_gt_res_162747 && x_162748;
                                bool cond_t_res_162750 = cond_162746 || y_162749;
                                bool x_162751 = defunc_0_eq_res_162745 && cond_t_res_162750;
                                int64_t defunc_0_f_res_f_res_162752;
                                
                                if (x_162751) {
                                    defunc_0_f_res_f_res_162752 = eta_p_162698;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162753;
                                    
                                    if (defunc_0_eq_res_162745) {
                                        int64_t max_arg1_163158 = sub64(eta_p_162698, this_step_154630);
                                        int64_t max_res_163159 = smax64((int64_t) 0, max_arg1_163158);
                                        
                                        defunc_0_f_res_f_res_f_res_162753 = max_res_163159;
                                    } else {
                                        bool defunc_0_gt_res_162756 = cur_elem_162714 < eta_p_162699;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162757;
                                        
                                        if (defunc_0_gt_res_162756) {
                                            bool cond_163161 = eta_p_162698 == m_154582;
                                            bool defunc_0_lt_res_163162 = eta_p_162699 < next_elem_162725;
                                            bool x_163163 = !cond_163161;
                                            bool y_163164 = defunc_0_lt_res_163162 && x_163163;
                                            bool cond_163165 = cond_163161 || y_163164;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                            
                                            if (cond_163165) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_163167 = add64(this_step_154630, eta_p_162698);
                                                int64_t min_res_163168 = smin64(m_154582, min_arg1_163167);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = min_res_163168;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                            
                                            if (cond_t_res_162750) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162768 = sub64(eta_p_162698, this_step_154630);
                                                int64_t max_res_162769 = smax64((int64_t) 0, max_arg1_162768);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = max_res_162769;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                        }
                                        defunc_0_f_res_f_res_f_res_162753 = defunc_0_f_res_f_res_f_res_f_res_162757;
                                    }
                                    defunc_0_f_res_f_res_162752 = defunc_0_f_res_f_res_f_res_162753;
                                }
                                defunc_0_f_res_162744 = defunc_0_f_res_f_res_162752;
                            }
                            ((int64_t *) mem_171845.mem)[i_171547] = defunc_0_f_res_162744;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171845, "mem_171845") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172528 = this_step_154630;
                        
                        if (memblock_set(ctx, &mem_param_171843, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                            return 1;
                        last_step_154628 = last_step_tmp_172528;
                    }
                    if (memblock_set(ctx, &ext_mem_171854, &mem_param_171843, "mem_param_171843") != 0)
                        return 1;
                    bsearch_first_154625 = last_step_154628;
                    
                    int64_t bsearch_last_154708;
                    int64_t last_step_154711;
                    
                    if (memblock_set(ctx, &mem_param_171857, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    last_step_154711 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154709 = 0; i_154709 < num_iter_154623; i_154709++) {
                        int64_t zs_lhs_154712 = add64((int64_t) 1, last_step_154711);
                        int64_t max_arg1_154713 = sdiv64(zs_lhs_154712, (int64_t) 2);
                        int64_t max_res_154714 = smax64((int64_t) 1, max_arg1_154713);
                        
                        if (memblock_alloc(ctx, &mem_171859, bytes_171831, "mem_171859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171551 = 0; i_171551 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171551++) {
                            int64_t eta_p_162821 = ((int64_t *) mem_param_171857.mem)[i_171551];
                            int64_t slice_171795 = tR_start_154534 + i_171551;
                            double eta_p_162822 = ((double *) tR_mem_171818.mem)[slice_171795];
                            bool cond_162824 = slt64(eta_p_162821, (int64_t) 0);
                            double cur_elem_162825;
                            
                            if (cond_162824) {
                                bool index_certs_163171;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162825 = lt_rhs_154601;
                            } else {
                                bool x_162829 = sle64((int64_t) 0, eta_p_162821);
                                bool y_162830 = slt64(eta_p_162821, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162831 = x_162829 && y_162830;
                                bool index_certs_162832;
                                
                                if (!bounds_check_162831) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162821, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162833 = tS_start_154577 + eta_p_162821;
                                double cur_elem_f_res_162834 = ((double *) tS_mem_171819.mem)[slice_162833];
                                
                                cur_elem_162825 = cur_elem_f_res_162834;
                            }
                            
                            bool cond_162835 = sle64(m_154582, eta_p_162821);
                            double next_elem_162836;
                            
                            if (cond_162835) {
                                bool index_certs_163177;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162836 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162844 = add64((int64_t) 1, eta_p_162821);
                                bool x_162845 = sle64((int64_t) 0, tmp_162844);
                                bool y_162846 = slt64(tmp_162844, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162847 = x_162845 && y_162846;
                                bool index_certs_162848;
                                
                                if (!bounds_check_162847) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162844, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162849 = tS_start_154577 + tmp_162844;
                                double next_elem_f_res_162850 = ((double *) tS_mem_171819.mem)[slice_162849];
                                
                                next_elem_162836 = next_elem_f_res_162850;
                            }
                            
                            int64_t defunc_0_f_res_162854;
                            
                            if (cond_162824) {
                                defunc_0_f_res_162854 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162855 = eta_p_162822 == cur_elem_162825;
                                bool cond_162857 = eta_p_162821 == m_154582;
                                bool defunc_0_gt_res_162858 = eta_p_162822 < next_elem_162836;
                                bool x_162859 = !cond_162857;
                                bool y_162860 = defunc_0_gt_res_162858 && x_162859;
                                bool cond_t_res_162861 = cond_162857 || y_162860;
                                bool x_162862 = defunc_0_eq_res_162855 && cond_t_res_162861;
                                int64_t defunc_0_f_res_f_res_162863;
                                
                                if (x_162862) {
                                    defunc_0_f_res_f_res_162863 = eta_p_162821;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162864;
                                    
                                    if (defunc_0_eq_res_162855) {
                                        int64_t min_arg1_163180 = add64(max_res_154714, eta_p_162821);
                                        int64_t min_res_163181 = smin64(m_154582, min_arg1_163180);
                                        
                                        defunc_0_f_res_f_res_f_res_162864 = min_res_163181;
                                    } else {
                                        bool defunc_0_gt_res_162867 = cur_elem_162825 < eta_p_162822;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162868;
                                        
                                        if (defunc_0_gt_res_162867) {
                                            int64_t min_arg1_163182 = add64(max_res_154714, eta_p_162821);
                                            int64_t min_res_163183 = smin64(m_154582, min_arg1_163182);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = min_res_163183;
                                        } else {
                                            int64_t max_arg1_162871 = sub64(eta_p_162821, max_res_154714);
                                            int64_t max_res_162872 = smax64((int64_t) 0, max_arg1_162871);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = max_res_162872;
                                        }
                                        defunc_0_f_res_f_res_f_res_162864 = defunc_0_f_res_f_res_f_res_f_res_162868;
                                    }
                                    defunc_0_f_res_f_res_162863 = defunc_0_f_res_f_res_f_res_162864;
                                }
                                defunc_0_f_res_162854 = defunc_0_f_res_f_res_162863;
                            }
                            ((int64_t *) mem_171859.mem)[i_171551] = defunc_0_f_res_162854;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172530, &mem_171859, "mem_171859") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172532 = max_res_154714;
                        
                        if (memblock_set(ctx, &mem_param_171857, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
                            return 1;
                        last_step_154711 = last_step_tmp_172532;
                    }
                    if (memblock_set(ctx, &ext_mem_171868, &mem_param_171857, "mem_param_171857") != 0)
                        return 1;
                    bsearch_last_154708 = last_step_154711;
                    if (memblock_alloc(ctx, &mem_171870, bytes_171831, "mem_171870")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171872, bytes_171831, "mem_171872")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171557 = 0; i_171557 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171557++) {
                        int64_t eta_p_162677 = ((int64_t *) ext_mem_171854.mem)[i_171557];
                        int64_t eta_p_162678 = ((int64_t *) mem_param_171840.mem)[ctx_param_ext_171838 + i_171557 * ctx_param_ext_171839];
                        int64_t eta_p_162679 = ((int64_t *) ext_mem_171868.mem)[i_171557];
                        int64_t eta_p_162680 = ((int64_t *) mem_param_171837.mem)[ctx_param_ext_171835 + i_171557 * ctx_param_ext_171836];
                        bool cond_162682 = slt64(eta_p_162677, (int64_t) 0);
                        int64_t lifted_lambda_res_162683;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162683 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162684 = sub64(eta_p_162679, eta_p_162677);
                            int64_t lifted_lambda_res_f_res_162685 = add64((int64_t) 1, zp_lhs_162684);
                            
                            lifted_lambda_res_162683 = lifted_lambda_res_f_res_162685;
                        }
                        
                        int64_t defunc_0_f_res_162687 = add64(eta_p_162680, lifted_lambda_res_162683);
                        int64_t lifted_lambda_res_162690;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162690 = eta_p_162677;
                        } else {
                            int64_t lifted_lambda_res_f_res_162691 = add64(find_joinTuples_arg3_154618, eta_p_162677);
                            
                            lifted_lambda_res_162690 = lifted_lambda_res_f_res_162691;
                        }
                        
                        bool cond_162693 = slt64(eta_p_162678, (int64_t) 0);
                        int64_t lifted_lambda_res_162694;
                        
                        if (cond_162693) {
                            lifted_lambda_res_162694 = lifted_lambda_res_162690;
                        } else {
                            lifted_lambda_res_162694 = eta_p_162678;
                        }
                        ((int64_t *) mem_171870.mem)[i_171557] = lifted_lambda_res_162694;
                        ((int64_t *) mem_171872.mem)[i_171557] = defunc_0_f_res_162687;
                    }
                    if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
                        return 1;
                    
                    int64_t tmp_154791 = add64((int64_t) 1, s_iter_154573);
                    
                    if (memblock_set(ctx, &ext_mem_171890, &mem_171872, "mem_171872") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_171870, "mem_171870") != 0)
                        return 1;
                    loopres_f_res_154610 = tmp_154791;
                    loopres_f_res_154613 = nextRel_154617;
                }
                if (memblock_set(ctx, &ext_mem_171896, &ext_mem_171890, "ext_mem_171890") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &ext_mem_171887, "ext_mem_171887") != 0)
                    return 1;
                loopres_154604 = loopres_f_res_154610;
                loopres_154607 = loopres_f_res_154613;
                loopres_154608 = minRelevant_154576;
            }
            
            bool cond_154792 = slt64(loopres_154604, numIter_S_154519);
            bool x_154793 = loopres_154607 && cond_154792;
            
            if (memblock_set(ctx, &mem_param_tmp_172515, &ext_mem_171896, "ext_mem_171896") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_172517 = ext_171895;
            int64_t ctx_param_ext_tmp_172518 = ext_171894;
            int64_t ctx_param_ext_tmp_172519 = ext_171892;
            int64_t ctx_param_ext_tmp_172520 = ext_171891;
            bool loop_while_tmp_172521 = x_154793;
            int64_t s_iter_tmp_172522 = loopres_154604;
            int64_t minRelevant_tmp_172525 = loopres_154608;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171840, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            ctx_param_ext_171835 = ctx_param_ext_tmp_172517;
            ctx_param_ext_171836 = ctx_param_ext_tmp_172518;
            ctx_param_ext_171838 = ctx_param_ext_tmp_172519;
            ctx_param_ext_171839 = ctx_param_ext_tmp_172520;
            loop_while_154572 = loop_while_tmp_172521;
            s_iter_154573 = s_iter_tmp_172522;
            minRelevant_154576 = minRelevant_tmp_172525;
        }
        if (memblock_set(ctx, &ext_mem_171902, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171901, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        ext_171900 = ctx_param_ext_171835;
        ext_171899 = ctx_param_ext_171836;
        ext_171898 = ctx_param_ext_171838;
        ext_171897 = ctx_param_ext_171839;
        loopres_154567 = loop_while_154572;
        loopres_154568 = s_iter_154573;
        loopres_154571 = minRelevant_154576;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171904, bytes_171821, "mem_171904")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_127457});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171901.mem, ext_171898, (int64_t []) {ext_171897}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171906, bytes_171821, "mem_171906")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_127457});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171902.mem, ext_171900, (int64_t []) {ext_171899}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        
        int64_t tmp_154799 = add64((int64_t) 1, iter_154530);
        bool loop_cond_154800 = slt64(tmp_154799, numIter_R_154516);
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171904, "mem_171904") != 0)
            return 1;
        
        bool loop_while_tmp_172508 = loop_cond_154800;
        int64_t iter_tmp_172509 = tmp_154799;
        int64_t first_relevant_in_S_tmp_172512 = loopres_154571;
        
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_while_154529 = loop_while_tmp_172508;
        iter_154530 = iter_tmp_172509;
        first_relevant_in_S_154533 = first_relevant_in_S_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_171912, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171911, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    defunc_0_mergeJoin_res_154524 = loop_while_154529;
    defunc_0_mergeJoin_res_154525 = iter_154530;
    defunc_0_mergeJoin_res_154528 = first_relevant_in_S_154533;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
        return 1;
    if (mem_171914_cached_sizze_172815 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171914, &mem_171914_cached_sizze_172815, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171916_cached_sizze_172816 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171916, &mem_171916_cached_sizze_172816, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171918_cached_sizze_172817 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171918, &mem_171918_cached_sizze_172817, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171920_cached_sizze_172818 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171920, &mem_171920_cached_sizze_172818, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171922_cached_sizze_172819 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171922, &mem_171922_cached_sizze_172819, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171924_cached_sizze_172820 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171924, &mem_171924_cached_sizze_172820, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171926_cached_sizze_172821 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171926, &mem_171926_cached_sizze_172821, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171585;
    int64_t discard_171586;
    int64_t defunc_res_163230;
    int64_t scanacc_171567;
    int64_t scanacc_171568;
    int64_t redout_171571;
    
    scanacc_171567 = (int64_t) 0;
    scanacc_171568 = (int64_t) 0;
    redout_171571 = (int64_t) 0;
    for (int64_t i_171577 = 0; i_171577 < nR_127457; i_171577++) {
        int64_t zg_lhs_162623 = ((int64_t *) ext_mem_171912.mem)[i_171577];
        bool cond_162624 = slt64((int64_t) 0, zg_lhs_162623);
        int64_t lifted_lambda_res_162625;
        
        if (cond_162624) {
            lifted_lambda_res_162625 = i_171577;
        } else {
            lifted_lambda_res_162625 = (int64_t) -1;
        }
        
        bool cond_162627 = sle64((int64_t) 0, lifted_lambda_res_162625);
        bool cond_t_res_162628 = slt64(lifted_lambda_res_162625, nR_127457);
        bool x_162629 = cond_162627 && cond_t_res_162628;
        int64_t lifted_lambda_res_162630;
        
        if (x_162629) {
            bool index_certs_163187;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:216:99-102\n   #4  ftRelational.fut:207:3-216:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163188 = ((int64_t *) ext_mem_171912.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162630 = lifted_lambda_res_t_res_163188;
        } else {
            lifted_lambda_res_162630 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162634 = slt64((int64_t) 1, lifted_lambda_res_162630);
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(lifted_lambda_res_162634);
        double lifted_lambda_res_162647;
        int64_t lifted_lambda_res_162648;
        int64_t lifted_lambda_res_162649;
        
        if (x_162629) {
            bool index_certs_163189;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:216:99-102\n   #5  ftRelational.fut:207:3-216:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double lifted_lambda_res_t_res_163190 = ((double *) tR_mem_171818.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163191 = ((int64_t *) ext_mem_171820.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163192 = ((int64_t *) ext_mem_171911.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162647 = lifted_lambda_res_t_res_163190;
            lifted_lambda_res_162648 = lifted_lambda_res_t_res_163191;
            lifted_lambda_res_162649 = lifted_lambda_res_t_res_163192;
        } else {
            lifted_lambda_res_162647 = 0.0;
            lifted_lambda_res_162648 = (int64_t) -1;
            lifted_lambda_res_162649 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154863 = add64(defunc_0_f_res_162635, scanacc_171567);
        int64_t lifted_lambda_res_154824 = add64(lifted_lambda_res_162630, scanacc_171568);
        int64_t zp_res_154844 = add64(lifted_lambda_res_162630, redout_171571);
        
        ((int64_t *) mem_171914)[i_171577] = defunc_0_op_res_154863;
        ((int64_t *) mem_171916)[i_171577] = lifted_lambda_res_154824;
        ((double *) mem_171918)[i_171577] = lifted_lambda_res_162647;
        ((int64_t *) mem_171920)[i_171577] = lifted_lambda_res_162648;
        ((int64_t *) mem_171922)[i_171577] = lifted_lambda_res_162649;
        ((int64_t *) mem_171924)[i_171577] = defunc_0_f_res_162635;
        ((int64_t *) mem_171926)[i_171577] = lifted_lambda_res_162630;
        
        int64_t scanacc_tmp_172536 = defunc_0_op_res_154863;
        int64_t scanacc_tmp_172537 = lifted_lambda_res_154824;
        int64_t redout_tmp_172540 = zp_res_154844;
        
        scanacc_171567 = scanacc_tmp_172536;
        scanacc_171568 = scanacc_tmp_172537;
        redout_171571 = redout_tmp_172540;
    }
    discard_171585 = scanacc_171567;
    discard_171586 = scanacc_171568;
    defunc_res_163230 = redout_171571;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
        return 1;
    
    int64_t bytes_171977 = (int64_t) 8 * defunc_res_163230;
    bool cond_154864 = nR_127457 == (int64_t) 0;
    bool x_154865 = !cond_154864;
    int64_t tmp_154866 = sub64(nR_127457, (int64_t) 1);
    bool x_154867 = sle64((int64_t) 0, tmp_154866);
    bool y_154868 = slt64(tmp_154866, nR_127457);
    bool bounds_check_154869 = x_154867 && y_154868;
    bool protect_assert_disj_154870 = cond_154864 || bounds_check_154869;
    bool index_certs_154871;
    
    if (!protect_assert_disj_154870) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154866, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:216:99-102\n   #4  ftRelational.fut:207:3-216:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154872;
    
    if (x_154865) {
        int64_t x_163193 = ((int64_t *) mem_171914)[tmp_154866];
        
        m_f_res_154872 = x_163193;
    } else {
        m_f_res_154872 = (int64_t) 0;
    }
    
    int64_t m_154874;
    
    if (cond_154864) {
        m_154874 = (int64_t) 0;
    } else {
        m_154874 = m_f_res_154872;
    }
    
    bool cond_154897 = slt64((int64_t) 0, m_154874);
    int64_t m_154884 = sub64(m_154874, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154886 = slt64(m_154884, nR_127457);
    bool zzero_leq_i_p_m_t_s_154885 = sle64((int64_t) 0, m_154884);
    bool y_154888 = zzero_leq_i_p_m_t_s_154885 && i_p_m_t_s_leq_w_154886;
    bool i_lte_j_154887 = sle64((int64_t) 0, m_154874);
    bool forwards_ok_154889 = i_lte_j_154887 && y_154888;
    bool eq_x_zz_154881 = (int64_t) 0 == m_f_res_154872;
    bool p_and_eq_x_y_154882 = x_154865 && eq_x_zz_154881;
    bool empty_slice_154883 = cond_154864 || p_and_eq_x_y_154882;
    bool ok_or_empty_154890 = empty_slice_154883 || forwards_ok_154889;
    bool index_certs_154891;
    
    if (!ok_or_empty_154890) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154874, "] out of bounds for array of shape [", (long long) nR_127457, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:216:99-102\n   #4  ftRelational.fut:207:3-216:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172001 = (int64_t) 8 * m_154874;
    
    if (mem_172002_cached_sizze_172823 < bytes_172001) {
        err = lexical_realloc(ctx, &mem_172002, &mem_172002_cached_sizze_172823, bytes_172001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171926, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154874});
    
    int64_t max_mult_154898;
    
    if (cond_154897) {
        if (mem_172004_cached_sizze_172824 < bytes_171821) {
            err = lexical_realloc(ctx, &mem_172004, &mem_172004_cached_sizze_172824, bytes_171821);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171604 = 0; i_171604 < nR_127457; i_171604++) {
            int64_t eta_p_163199 = ((int64_t *) mem_171924)[i_171604];
            int64_t eta_p_163200 = ((int64_t *) mem_171914)[i_171604];
            bool cond_163201 = eta_p_163199 == (int64_t) 1;
            int64_t lifted_lambda_res_163202;
            
            if (cond_163201) {
                int64_t lifted_lambda_res_t_res_163203 = sub64(eta_p_163200, (int64_t) 1);
                
                lifted_lambda_res_163202 = lifted_lambda_res_t_res_163203;
            } else {
                lifted_lambda_res_163202 = (int64_t) -1;
            }
            ((int64_t *) mem_172004)[i_171604] = lifted_lambda_res_163202;
        }
        for (int64_t write_iter_171606 = 0; write_iter_171606 < nR_127457; write_iter_171606++) {
            int64_t write_iv_171608 = ((int64_t *) mem_172004)[write_iter_171606];
            int64_t write_iv_171609 = ((int64_t *) mem_171926)[write_iter_171606];
            
            if (sle64((int64_t) 0, write_iv_171608) && slt64(write_iv_171608, m_154874)) {
                ((int64_t *) mem_172002)[write_iv_171608] = write_iv_171609;
            }
        }
        
        int64_t defunc_0_reduce_res_163213;
        int64_t redout_171611 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171612 = 0; i_171612 < m_154874; i_171612++) {
            int64_t x_163214 = ((int64_t *) mem_172002)[i_171612];
            int64_t max_res_163217 = smax64(x_163214, redout_171611);
            int64_t redout_tmp_172548 = max_res_163217;
            
            redout_171611 = redout_tmp_172548;
        }
        defunc_0_reduce_res_163213 = redout_171611;
        max_mult_154898 = defunc_0_reduce_res_163213;
    } else {
        max_mult_154898 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154904 = slt64(max_mult_154898, (int64_t) 1);
    bool valid_154906 = !bounds_invalid_upwards_154904;
    bool range_valid_c_154907;
    
    if (!valid_154906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154898, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:216:99-102\n   #3  ftRelational.fut:207:3-216:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171970_cached_sizze_172822 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171970, &mem_171970_cached_sizze_172822, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171589 = 0; i_171589 < nR_127457; i_171589++) {
        int64_t eta_p_162530 = ((int64_t *) mem_171926)[i_171589];
        int64_t zv_lhs_162532 = add64((int64_t) -1, i_171589);
        int64_t tmp_162533 = smod64(zv_lhs_162532, nR_127457);
        int64_t lifted_lambda_res_162534 = ((int64_t *) mem_171916)[tmp_162533];
        bool cond_162536 = i_171589 == (int64_t) 0;
        int64_t lifted_lambda_res_162537;
        
        if (cond_162536) {
            lifted_lambda_res_162537 = (int64_t) 0;
        } else {
            lifted_lambda_res_162537 = lifted_lambda_res_162534;
        }
        
        bool cond_162539 = slt64((int64_t) 0, eta_p_162530);
        int64_t lifted_lambda_res_162540;
        
        if (cond_162539) {
            lifted_lambda_res_162540 = lifted_lambda_res_162537;
        } else {
            lifted_lambda_res_162540 = (int64_t) -1;
        }
        ((int64_t *) mem_171970)[i_171589] = lifted_lambda_res_162540;
    }
    if (memblock_alloc(ctx, &mem_171978, bytes_171977, "mem_171978")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172550 = 0; nest_i_172550 < defunc_res_163230; nest_i_172550++) {
        ((double *) mem_171978.mem)[nest_i_172550] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171980, bytes_171977, "mem_171980")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172551 = 0; nest_i_172551 < defunc_res_163230; nest_i_172551++) {
        ((int64_t *) mem_171980.mem)[nest_i_172551] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171982, bytes_171977, "mem_171982")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_163230; nest_i_172552++) {
        ((int64_t *) mem_171982.mem)[nest_i_172552] = (int64_t) -1;
    }
    for (int64_t write_iter_171591 = 0; write_iter_171591 < nR_127457; write_iter_171591++) {
        int64_t write_iv_171595 = ((int64_t *) mem_171970)[write_iter_171591];
        double write_iv_171596 = ((double *) mem_171918)[write_iter_171591];
        int64_t write_iv_171597 = ((int64_t *) mem_171920)[write_iter_171591];
        int64_t write_iv_171598 = ((int64_t *) mem_171922)[write_iter_171591];
        
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((double *) mem_171978.mem)[write_iv_171595] = write_iv_171596;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171980.mem)[write_iv_171595] = write_iv_171597;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171982.mem)[write_iv_171595] = write_iv_171598;
        }
    }
    
    int64_t distance_154905 = sub64(max_mult_154898, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_172019, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172022, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172025, &mem_171982, "mem_171982") != 0)
        return 1;
    for (int64_t i_154911 = 0; i_154911 < distance_154905; i_154911++) {
        int64_t index_primexp_154915 = add64((int64_t) 1, i_154911);
        
        if (memblock_alloc(ctx, &mem_172027, bytes_171977, "mem_172027")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172029, bytes_171977, "mem_172029")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172029.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172022.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172031, bytes_171977, "mem_172031")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172031.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        for (int64_t write_iter_171613 = 0; write_iter_171613 < nR_127457; write_iter_171613++) {
            int64_t write_iv_171618 = ((int64_t *) mem_171922)[write_iter_171613];
            double write_iv_171619 = ((double *) mem_171918)[write_iter_171613];
            int64_t write_iv_171620 = ((int64_t *) mem_171920)[write_iter_171613];
            int64_t zg_lhs_163127 = ((int64_t *) mem_171926)[write_iter_171613];
            bool cond_163128 = slt64(index_primexp_154915, zg_lhs_163127);
            int64_t lifted_lambda_res_163129;
            
            if (cond_163128) {
                int64_t zp_lhs_163223 = ((int64_t *) mem_171970)[write_iter_171613];
                int64_t lifted_lambda_res_t_res_163224 = add64(index_primexp_154915, zp_lhs_163223);
                
                lifted_lambda_res_163129 = lifted_lambda_res_t_res_163224;
            } else {
                lifted_lambda_res_163129 = (int64_t) -1;
            }
            
            int64_t tmp_163133 = add64(index_primexp_154915, write_iv_171618);
            
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((double *) mem_172031.mem)[lifted_lambda_res_163129] = write_iv_171619;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172029.mem)[lifted_lambda_res_163129] = write_iv_171620;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172027.mem)[lifted_lambda_res_163129] = tmp_163133;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172556, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172557, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172558, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172019, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172022, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172025, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_172058, &mem_param_172019, "mem_param_172019") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172057, &mem_param_172022, "mem_param_172022") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172056, &mem_param_172025, "mem_param_172025") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172060, bytes_171977, "mem_172060")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172062, bytes_171977, "mem_172062")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172062.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172064, bytes_171977, "mem_172064")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172062, "mem_172062") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172064, "mem_172064") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &mem_172060, "mem_172060") != 0)
        return 1;
    prim_out_172503 = defunc_res_163230;
    if (memblock_set(ctx, &*mem_out_p_172811, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172812, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172813, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172814 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171914);
        free(mem_171916);
        free(mem_171918);
        free(mem_171920);
        free(mem_171922);
        free(mem_171924);
        free(mem_171926);
        free(mem_171970);
        free(mem_172002);
        free(mem_172004);
        if (memblock_unref(ctx, &mem_172064, "mem_172064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172062, "mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172060, "mem_172060") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172025, "mem_param_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172022, "mem_param_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172019, "mem_param_172019") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171904, "mem_171904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171872, "mem_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171870, "mem_171870") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171859, "mem_171859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171857, "mem_param_171857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171843, "mem_param_171843") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171887, "ext_mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171890, "ext_mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171896, "ext_mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_float(struct futhark_context *ctx, struct memblock *mem_out_p_172825, struct memblock *mem_out_p_172826, struct memblock *mem_out_p_172827, int64_t *out_prim_out_172828, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_124794, int64_t nS_124795, int64_t offset_R_124798, int64_t offset_S_124799, int64_t partitionSizze_124800, int64_t scatter_psizze_124801)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171914_cached_sizze_172829 = 0;
    unsigned char *mem_171914 = NULL;
    int64_t mem_171916_cached_sizze_172830 = 0;
    unsigned char *mem_171916 = NULL;
    int64_t mem_171918_cached_sizze_172831 = 0;
    unsigned char *mem_171918 = NULL;
    int64_t mem_171920_cached_sizze_172832 = 0;
    unsigned char *mem_171920 = NULL;
    int64_t mem_171922_cached_sizze_172833 = 0;
    unsigned char *mem_171922 = NULL;
    int64_t mem_171924_cached_sizze_172834 = 0;
    unsigned char *mem_171924 = NULL;
    int64_t mem_171926_cached_sizze_172835 = 0;
    unsigned char *mem_171926 = NULL;
    int64_t mem_171970_cached_sizze_172836 = 0;
    unsigned char *mem_171970 = NULL;
    int64_t mem_172002_cached_sizze_172837 = 0;
    unsigned char *mem_172002 = NULL;
    int64_t mem_172004_cached_sizze_172838 = 0;
    unsigned char *mem_172004 = NULL;
    struct memblock mem_172064;
    
    mem_172064.references = NULL;
    
    struct memblock mem_172062;
    
    mem_172062.references = NULL;
    
    struct memblock mem_172060;
    
    mem_172060.references = NULL;
    
    struct memblock mem_param_tmp_172558;
    
    mem_param_tmp_172558.references = NULL;
    
    struct memblock mem_param_tmp_172557;
    
    mem_param_tmp_172557.references = NULL;
    
    struct memblock mem_param_tmp_172556;
    
    mem_param_tmp_172556.references = NULL;
    
    struct memblock mem_172031;
    
    mem_172031.references = NULL;
    
    struct memblock mem_172029;
    
    mem_172029.references = NULL;
    
    struct memblock mem_172027;
    
    mem_172027.references = NULL;
    
    struct memblock mem_param_172025;
    
    mem_param_172025.references = NULL;
    
    struct memblock mem_param_172022;
    
    mem_param_172022.references = NULL;
    
    struct memblock mem_param_172019;
    
    mem_param_172019.references = NULL;
    
    struct memblock ext_mem_172056;
    
    ext_mem_172056.references = NULL;
    
    struct memblock ext_mem_172057;
    
    ext_mem_172057.references = NULL;
    
    struct memblock ext_mem_172058;
    
    ext_mem_172058.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171980;
    
    mem_171980.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_171906;
    
    mem_171906.references = NULL;
    
    struct memblock mem_171904;
    
    mem_171904.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_171872;
    
    mem_171872.references = NULL;
    
    struct memblock mem_171870;
    
    mem_171870.references = NULL;
    
    struct memblock mem_param_tmp_172530;
    
    mem_param_tmp_172530.references = NULL;
    
    struct memblock mem_171859;
    
    mem_171859.references = NULL;
    
    struct memblock mem_param_171857;
    
    mem_param_171857.references = NULL;
    
    struct memblock ext_mem_171868;
    
    ext_mem_171868.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_param_171843;
    
    mem_param_171843.references = NULL;
    
    struct memblock ext_mem_171854;
    
    ext_mem_171854.references = NULL;
    
    struct memblock ext_mem_171887;
    
    ext_mem_171887.references = NULL;
    
    struct memblock ext_mem_171890;
    
    ext_mem_171890.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock ext_mem_171896;
    
    ext_mem_171896.references = NULL;
    
    struct memblock mem_param_171840;
    
    mem_param_171840.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171901;
    
    ext_mem_171901.references = NULL;
    
    struct memblock ext_mem_171902;
    
    ext_mem_171902.references = NULL;
    
    struct memblock mem_171834;
    
    mem_171834.references = NULL;
    
    struct memblock mem_171832;
    
    mem_171832.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock ext_mem_171912;
    
    ext_mem_171912.references = NULL;
    
    struct memblock mem_171824;
    
    mem_171824.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t partitionSizze_154510 = sdiv64(partitionSizze_124800, (int64_t) 4);
    int64_t zm_lhs_154511 = add64(nR_124794, partitionSizze_154510);
    int64_t zs_lhs_154512 = sub64(zm_lhs_154511, (int64_t) 1);
    bool zzero_154513 = partitionSizze_154510 == (int64_t) 0;
    bool nonzzero_154514 = !zzero_154513;
    bool nonzzero_cert_154515;
    
    if (!nonzzero_154514) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_154516 = sdiv64(zs_lhs_154512, partitionSizze_154510);
    int64_t zm_lhs_154517 = add64(nS_124795, partitionSizze_154510);
    int64_t zs_lhs_154518 = sub64(zm_lhs_154517, (int64_t) 1);
    int64_t numIter_S_154519 = sdiv64(zs_lhs_154518, partitionSizze_154510);
    
    if (futrts_indicesWithIncrement_16363(ctx, &ext_mem_171820, tR_mem_171818, nR_124794, offset_R_124798) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * nR_124794;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < nR_124794; nest_i_172504++) {
        ((int64_t *) mem_171822.mem)[nest_i_172504] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171824, bytes_171821, "mem_171824")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < nR_124794; nest_i_172505++) {
        ((int64_t *) mem_171824.mem)[nest_i_172505] = (int64_t) 0;
    }
    
    bool loop_cond_154523 = slt64((int64_t) 0, numIter_R_154516);
    bool defunc_0_mergeJoin_res_154524;
    int64_t defunc_0_mergeJoin_res_154525;
    int64_t defunc_0_mergeJoin_res_154528;
    bool loop_while_154529;
    int64_t iter_154530;
    int64_t first_relevant_in_S_154533;
    
    if (memblock_set(ctx, &mem_param_171827, &mem_171824, "mem_171824") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_while_154529 = loop_cond_154523;
    iter_154530 = (int64_t) 0;
    first_relevant_in_S_154533 = (int64_t) 0;
    while (loop_while_154529) {
        int64_t tR_start_154534 = mul64(partitionSizze_154510, iter_154530);
        int64_t min_arg1_154535 = add64(partitionSizze_154510, tR_start_154534);
        int64_t min_res_154536 = smin64(nR_124794, min_arg1_154535);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 = sub64(min_res_154536, tR_start_154534);
        bool empty_slice_154538 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 == (int64_t) 0;
        int64_t m_154539 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, (int64_t) 1);
        int64_t i_p_m_t_s_154540 = add64(tR_start_154534, m_154539);
        bool zzero_leq_i_p_m_t_s_154541 = sle64((int64_t) 0, i_p_m_t_s_154540);
        bool i_p_m_t_s_leq_w_154542 = slt64(i_p_m_t_s_154540, nR_124794);
        bool zzero_lte_i_154543 = sle64((int64_t) 0, tR_start_154534);
        bool i_lte_j_154544 = sle64(tR_start_154534, min_res_154536);
        bool y_154545 = i_p_m_t_s_leq_w_154542 && zzero_lte_i_154543;
        bool y_154546 = zzero_leq_i_p_m_t_s_154541 && y_154545;
        bool forwards_ok_154547 = i_lte_j_154544 && y_154546;
        bool ok_or_empty_154548 = empty_slice_154538 || forwards_ok_154547;
        bool index_certs_154549;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171831 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537;
        bool cond_154553 = slt64(first_relevant_in_S_154533, numIter_S_154519);
        bool y_154554 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool loop_not_taken_154555 = !cond_154553;
        bool protect_assert_disj_154556 = y_154554 || loop_not_taken_154555;
        bool index_certs_154557;
        
        if (!protect_assert_disj_154556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154560 = sle64((int64_t) 0, m_154539);
        bool y_154561 = slt64(m_154539, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool bounds_check_154562 = x_154560 && y_154561;
        bool protect_assert_disj_154563 = loop_not_taken_154555 || bounds_check_154562;
        bool index_certs_154564;
        
        if (!protect_assert_disj_154563) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154795;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:205:99-102\n   #4  ftRelational.fut:196:3-205:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171832, bytes_171831, "mem_171832")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172513 = 0; nest_i_172513 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172513++) {
            ((int64_t *) mem_171832.mem)[nest_i_172513] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171834, bytes_171831, "mem_171834")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172514 = 0; nest_i_172514 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172514++) {
            ((int64_t *) mem_171834.mem)[nest_i_172514] = (int64_t) 0;
        }
        
        float gt_lhs_154558;
        
        if (cond_154553) {
            float x_163142 = ((float *) tR_mem_171818.mem)[tR_start_154534];
            
            gt_lhs_154558 = x_163142;
        } else {
            gt_lhs_154558 = 0.0F;
        }
        
        float lt_lhs_154565;
        
        if (cond_154553) {
            float x_163143 = ((float *) tR_mem_171818.mem)[i_p_m_t_s_154540];
            
            lt_lhs_154565 = x_163143;
        } else {
            lt_lhs_154565 = 0.0F;
        }
        
        int64_t ext_171900;
        int64_t ext_171899;
        int64_t ext_171898;
        int64_t ext_171897;
        bool loopres_154567;
        int64_t loopres_154568;
        int64_t loopres_154571;
        bool loop_while_154572;
        int64_t s_iter_154573;
        int64_t minRelevant_154576;
        int64_t ctx_param_ext_171835;
        int64_t ctx_param_ext_171836;
        int64_t ctx_param_ext_171838;
        int64_t ctx_param_ext_171839;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171840, &mem_171832, "mem_171832") != 0)
            return 1;
        ctx_param_ext_171835 = (int64_t) 0;
        ctx_param_ext_171836 = (int64_t) 1;
        ctx_param_ext_171838 = (int64_t) 0;
        ctx_param_ext_171839 = (int64_t) 1;
        loop_while_154572 = cond_154553;
        s_iter_154573 = first_relevant_in_S_154533;
        minRelevant_154576 = first_relevant_in_S_154533;
        while (loop_while_154572) {
            int64_t tS_start_154577 = mul64(partitionSizze_154510, s_iter_154573);
            int64_t min_arg1_154578 = add64(partitionSizze_154510, tS_start_154577);
            int64_t min_res_154579 = smin64(nS_124795, min_arg1_154578);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 = sub64(min_res_154579, tS_start_154577);
            bool empty_slice_154581 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 == (int64_t) 0;
            int64_t m_154582 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, (int64_t) 1);
            int64_t i_p_m_t_s_154583 = add64(tS_start_154577, m_154582);
            bool zzero_leq_i_p_m_t_s_154584 = sle64((int64_t) 0, i_p_m_t_s_154583);
            bool i_p_m_t_s_leq_w_154585 = slt64(i_p_m_t_s_154583, nS_124795);
            bool zzero_lte_i_154586 = sle64((int64_t) 0, tS_start_154577);
            bool i_lte_j_154587 = sle64(tS_start_154577, min_res_154579);
            bool y_154588 = i_p_m_t_s_leq_w_154585 && zzero_lte_i_154586;
            bool y_154589 = zzero_leq_i_p_m_t_s_154584 && y_154588;
            bool forwards_ok_154590 = i_lte_j_154587 && y_154589;
            bool ok_or_empty_154591 = empty_slice_154581 || forwards_ok_154590;
            bool index_certs_154592;
            
            if (!ok_or_empty_154591) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154577, ":", (long long) min_res_154579, "] out of bounds for array of shape [", (long long) nS_124795, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154593 = sle64((int64_t) 0, m_154582);
            bool y_154594 = slt64(m_154582, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool bounds_check_154595 = x_154593 && y_154594;
            bool index_certs_154596;
            
            if (!bounds_check_154595) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154599 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool index_certs_154600;
            
            if (!y_154599) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float gt_rhs_154597 = ((float *) tS_mem_171819.mem)[i_p_m_t_s_154583];
            bool defunc_0_gt_res_154598 = gt_rhs_154597 < gt_lhs_154558;
            float lt_rhs_154601 = ((float *) tS_mem_171819.mem)[tS_start_154577];
            bool defunc_0_lt_res_154602 = lt_lhs_154565 < lt_rhs_154601;
            bool thisStillRel_154603 = !defunc_0_lt_res_154602;
            int64_t ext_171889;
            
            if (defunc_0_lt_res_154602) {
                ext_171889 = ctx_param_ext_171835;
            } else {
                ext_171889 = (int64_t) 0;
            }
            
            int64_t ext_171888;
            
            if (defunc_0_lt_res_154602) {
                ext_171888 = ctx_param_ext_171836;
            } else {
                ext_171888 = (int64_t) 1;
            }
            
            int64_t ext_171886;
            
            if (defunc_0_lt_res_154602) {
                ext_171886 = ctx_param_ext_171838;
            } else {
                ext_171886 = (int64_t) 0;
            }
            
            int64_t ext_171885;
            
            if (defunc_0_lt_res_154602) {
                ext_171885 = ctx_param_ext_171839;
            } else {
                ext_171885 = (int64_t) 1;
            }
            
            int64_t ext_171895;
            
            if (defunc_0_gt_res_154598) {
                ext_171895 = ctx_param_ext_171835;
            } else {
                ext_171895 = ext_171889;
            }
            
            int64_t ext_171894;
            
            if (defunc_0_gt_res_154598) {
                ext_171894 = ctx_param_ext_171836;
            } else {
                ext_171894 = ext_171888;
            }
            
            int64_t ext_171892;
            
            if (defunc_0_gt_res_154598) {
                ext_171892 = ctx_param_ext_171838;
            } else {
                ext_171892 = ext_171886;
            }
            
            int64_t ext_171891;
            
            if (defunc_0_gt_res_154598) {
                ext_171891 = ctx_param_ext_171839;
            } else {
                ext_171891 = ext_171885;
            }
            
            int64_t loopres_154604;
            bool loopres_154607;
            int64_t loopres_154608;
            
            if (defunc_0_gt_res_154598) {
                int64_t tmp_163144 = add64((int64_t) 1, s_iter_154573);
                
                if (memblock_set(ctx, &ext_mem_171896, &mem_param_171837, "mem_param_171837") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &mem_param_171840, "mem_param_171840") != 0)
                    return 1;
                loopres_154604 = tmp_163144;
                loopres_154607 = 1;
                loopres_154608 = tmp_163144;
            } else {
                int64_t loopres_f_res_154610;
                bool loopres_f_res_154613;
                
                if (defunc_0_lt_res_154602) {
                    if (memblock_set(ctx, &ext_mem_171890, &mem_param_171837, "mem_param_171837") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_param_171840, "mem_param_171840") != 0)
                        return 1;
                    loopres_f_res_154610 = s_iter_154573;
                    loopres_f_res_154613 = thisStillRel_154603;
                } else {
                    bool index_certs_154614;
                    
                    if (!bounds_check_154562) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lt_lhs_154615 = ((float *) tR_mem_171818.mem)[i_p_m_t_s_154540];
                    bool defunc_0_lt_res_154616 = lt_lhs_154615 < gt_rhs_154597;
                    bool nextRel_154617 = !defunc_0_lt_res_154616;
                    int64_t find_joinTuples_arg3_154618 = add64(offset_S_124799, tS_start_154577);
                    double i64_res_154619 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                    double log2_res_154620 = futrts_log2_64(i64_res_154619);
                    double ceil_res_154621 = futrts_ceil64(log2_res_154620);
                    int64_t f64_res_154622 = fptosi_f64_i64(ceil_res_154621);
                    int64_t num_iter_154623 = add64((int64_t) 1, f64_res_154622);
                    int64_t bsearch_first_154625;
                    int64_t last_step_154628;
                    
                    if (memblock_set(ctx, &mem_param_171843, &mem_171834, "mem_171834") != 0)
                        return 1;
                    last_step_154628 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154626 = 0; i_154626 < num_iter_154623; i_154626++) {
                        int64_t zs_lhs_154629 = add64((int64_t) 1, last_step_154628);
                        int64_t this_step_154630 = sdiv64(zs_lhs_154629, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171845, bytes_171831, "mem_171845")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171547++) {
                            int64_t eta_p_162698 = ((int64_t *) mem_param_171843.mem)[i_171547];
                            int64_t slice_171796 = tR_start_154534 + i_171547;
                            float eta_p_162699 = ((float *) tR_mem_171818.mem)[slice_171796];
                            bool cond_162701 = sle64(eta_p_162698, (int64_t) 0);
                            float prev_elem_162702;
                            
                            if (cond_162701) {
                                bool index_certs_163146;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162702 = lt_rhs_154601;
                            } else {
                                int64_t tmp_162706 = sub64(eta_p_162698, (int64_t) 1);
                                bool x_162707 = sle64((int64_t) 0, tmp_162706);
                                bool y_162708 = slt64(tmp_162706, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162709 = x_162707 && y_162708;
                                bool index_certs_162710;
                                
                                if (!bounds_check_162709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162706, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162711 = tS_start_154577 + tmp_162706;
                                float prev_elem_f_res_162712 = ((float *) tS_mem_171819.mem)[slice_162711];
                                
                                prev_elem_162702 = prev_elem_f_res_162712;
                            }
                            
                            bool cond_162713 = slt64(eta_p_162698, (int64_t) 0);
                            float cur_elem_162714;
                            
                            if (cond_162713) {
                                bool index_certs_163149;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162714 = lt_rhs_154601;
                            } else {
                                bool x_162718 = sle64((int64_t) 0, eta_p_162698);
                                bool y_162719 = slt64(eta_p_162698, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162720 = x_162718 && y_162719;
                                bool index_certs_162721;
                                
                                if (!bounds_check_162720) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162698, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162722 = tS_start_154577 + eta_p_162698;
                                float cur_elem_f_res_162723 = ((float *) tS_mem_171819.mem)[slice_162722];
                                
                                cur_elem_162714 = cur_elem_f_res_162723;
                            }
                            
                            bool cond_162724 = sle64(m_154582, eta_p_162698);
                            float next_elem_162725;
                            
                            if (cond_162724) {
                                bool index_certs_163155;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162725 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162733 = add64((int64_t) 1, eta_p_162698);
                                bool x_162734 = sle64((int64_t) 0, tmp_162733);
                                bool y_162735 = slt64(tmp_162733, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162736 = x_162734 && y_162735;
                                bool index_certs_162737;
                                
                                if (!bounds_check_162736) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162733, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162738 = tS_start_154577 + tmp_162733;
                                float next_elem_f_res_162739 = ((float *) tS_mem_171819.mem)[slice_162738];
                                
                                next_elem_162725 = next_elem_f_res_162739;
                            }
                            
                            int64_t defunc_0_f_res_162744;
                            
                            if (cond_162713) {
                                defunc_0_f_res_162744 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162745 = eta_p_162699 == cur_elem_162714;
                                bool cond_162746 = eta_p_162698 == (int64_t) 0;
                                bool defunc_0_gt_res_162747 = prev_elem_162702 < eta_p_162699;
                                bool x_162748 = !cond_162746;
                                bool y_162749 = defunc_0_gt_res_162747 && x_162748;
                                bool cond_t_res_162750 = cond_162746 || y_162749;
                                bool x_162751 = defunc_0_eq_res_162745 && cond_t_res_162750;
                                int64_t defunc_0_f_res_f_res_162752;
                                
                                if (x_162751) {
                                    defunc_0_f_res_f_res_162752 = eta_p_162698;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162753;
                                    
                                    if (defunc_0_eq_res_162745) {
                                        int64_t max_arg1_163158 = sub64(eta_p_162698, this_step_154630);
                                        int64_t max_res_163159 = smax64((int64_t) 0, max_arg1_163158);
                                        
                                        defunc_0_f_res_f_res_f_res_162753 = max_res_163159;
                                    } else {
                                        bool defunc_0_gt_res_162756 = cur_elem_162714 < eta_p_162699;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162757;
                                        
                                        if (defunc_0_gt_res_162756) {
                                            bool cond_163161 = eta_p_162698 == m_154582;
                                            bool defunc_0_lt_res_163162 = eta_p_162699 < next_elem_162725;
                                            bool x_163163 = !cond_163161;
                                            bool y_163164 = defunc_0_lt_res_163162 && x_163163;
                                            bool cond_163165 = cond_163161 || y_163164;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                            
                                            if (cond_163165) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_163167 = add64(this_step_154630, eta_p_162698);
                                                int64_t min_res_163168 = smin64(m_154582, min_arg1_163167);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = min_res_163168;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                            
                                            if (cond_t_res_162750) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162768 = sub64(eta_p_162698, this_step_154630);
                                                int64_t max_res_162769 = smax64((int64_t) 0, max_arg1_162768);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = max_res_162769;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                        }
                                        defunc_0_f_res_f_res_f_res_162753 = defunc_0_f_res_f_res_f_res_f_res_162757;
                                    }
                                    defunc_0_f_res_f_res_162752 = defunc_0_f_res_f_res_f_res_162753;
                                }
                                defunc_0_f_res_162744 = defunc_0_f_res_f_res_162752;
                            }
                            ((int64_t *) mem_171845.mem)[i_171547] = defunc_0_f_res_162744;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171845, "mem_171845") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172528 = this_step_154630;
                        
                        if (memblock_set(ctx, &mem_param_171843, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                            return 1;
                        last_step_154628 = last_step_tmp_172528;
                    }
                    if (memblock_set(ctx, &ext_mem_171854, &mem_param_171843, "mem_param_171843") != 0)
                        return 1;
                    bsearch_first_154625 = last_step_154628;
                    
                    int64_t bsearch_last_154708;
                    int64_t last_step_154711;
                    
                    if (memblock_set(ctx, &mem_param_171857, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    last_step_154711 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154709 = 0; i_154709 < num_iter_154623; i_154709++) {
                        int64_t zs_lhs_154712 = add64((int64_t) 1, last_step_154711);
                        int64_t max_arg1_154713 = sdiv64(zs_lhs_154712, (int64_t) 2);
                        int64_t max_res_154714 = smax64((int64_t) 1, max_arg1_154713);
                        
                        if (memblock_alloc(ctx, &mem_171859, bytes_171831, "mem_171859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171551 = 0; i_171551 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171551++) {
                            int64_t eta_p_162821 = ((int64_t *) mem_param_171857.mem)[i_171551];
                            int64_t slice_171795 = tR_start_154534 + i_171551;
                            float eta_p_162822 = ((float *) tR_mem_171818.mem)[slice_171795];
                            bool cond_162824 = slt64(eta_p_162821, (int64_t) 0);
                            float cur_elem_162825;
                            
                            if (cond_162824) {
                                bool index_certs_163171;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162825 = lt_rhs_154601;
                            } else {
                                bool x_162829 = sle64((int64_t) 0, eta_p_162821);
                                bool y_162830 = slt64(eta_p_162821, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162831 = x_162829 && y_162830;
                                bool index_certs_162832;
                                
                                if (!bounds_check_162831) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162821, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162833 = tS_start_154577 + eta_p_162821;
                                float cur_elem_f_res_162834 = ((float *) tS_mem_171819.mem)[slice_162833];
                                
                                cur_elem_162825 = cur_elem_f_res_162834;
                            }
                            
                            bool cond_162835 = sle64(m_154582, eta_p_162821);
                            float next_elem_162836;
                            
                            if (cond_162835) {
                                bool index_certs_163177;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162836 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162844 = add64((int64_t) 1, eta_p_162821);
                                bool x_162845 = sle64((int64_t) 0, tmp_162844);
                                bool y_162846 = slt64(tmp_162844, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162847 = x_162845 && y_162846;
                                bool index_certs_162848;
                                
                                if (!bounds_check_162847) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162844, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162849 = tS_start_154577 + tmp_162844;
                                float next_elem_f_res_162850 = ((float *) tS_mem_171819.mem)[slice_162849];
                                
                                next_elem_162836 = next_elem_f_res_162850;
                            }
                            
                            int64_t defunc_0_f_res_162854;
                            
                            if (cond_162824) {
                                defunc_0_f_res_162854 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162855 = eta_p_162822 == cur_elem_162825;
                                bool cond_162857 = eta_p_162821 == m_154582;
                                bool defunc_0_gt_res_162858 = eta_p_162822 < next_elem_162836;
                                bool x_162859 = !cond_162857;
                                bool y_162860 = defunc_0_gt_res_162858 && x_162859;
                                bool cond_t_res_162861 = cond_162857 || y_162860;
                                bool x_162862 = defunc_0_eq_res_162855 && cond_t_res_162861;
                                int64_t defunc_0_f_res_f_res_162863;
                                
                                if (x_162862) {
                                    defunc_0_f_res_f_res_162863 = eta_p_162821;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162864;
                                    
                                    if (defunc_0_eq_res_162855) {
                                        int64_t min_arg1_163180 = add64(max_res_154714, eta_p_162821);
                                        int64_t min_res_163181 = smin64(m_154582, min_arg1_163180);
                                        
                                        defunc_0_f_res_f_res_f_res_162864 = min_res_163181;
                                    } else {
                                        bool defunc_0_gt_res_162867 = cur_elem_162825 < eta_p_162822;
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162868;
                                        
                                        if (defunc_0_gt_res_162867) {
                                            int64_t min_arg1_163182 = add64(max_res_154714, eta_p_162821);
                                            int64_t min_res_163183 = smin64(m_154582, min_arg1_163182);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = min_res_163183;
                                        } else {
                                            int64_t max_arg1_162871 = sub64(eta_p_162821, max_res_154714);
                                            int64_t max_res_162872 = smax64((int64_t) 0, max_arg1_162871);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = max_res_162872;
                                        }
                                        defunc_0_f_res_f_res_f_res_162864 = defunc_0_f_res_f_res_f_res_f_res_162868;
                                    }
                                    defunc_0_f_res_f_res_162863 = defunc_0_f_res_f_res_f_res_162864;
                                }
                                defunc_0_f_res_162854 = defunc_0_f_res_f_res_162863;
                            }
                            ((int64_t *) mem_171859.mem)[i_171551] = defunc_0_f_res_162854;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172530, &mem_171859, "mem_171859") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172532 = max_res_154714;
                        
                        if (memblock_set(ctx, &mem_param_171857, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
                            return 1;
                        last_step_154711 = last_step_tmp_172532;
                    }
                    if (memblock_set(ctx, &ext_mem_171868, &mem_param_171857, "mem_param_171857") != 0)
                        return 1;
                    bsearch_last_154708 = last_step_154711;
                    if (memblock_alloc(ctx, &mem_171870, bytes_171831, "mem_171870")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171872, bytes_171831, "mem_171872")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171557 = 0; i_171557 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171557++) {
                        int64_t eta_p_162677 = ((int64_t *) ext_mem_171854.mem)[i_171557];
                        int64_t eta_p_162678 = ((int64_t *) mem_param_171840.mem)[ctx_param_ext_171838 + i_171557 * ctx_param_ext_171839];
                        int64_t eta_p_162679 = ((int64_t *) ext_mem_171868.mem)[i_171557];
                        int64_t eta_p_162680 = ((int64_t *) mem_param_171837.mem)[ctx_param_ext_171835 + i_171557 * ctx_param_ext_171836];
                        bool cond_162682 = slt64(eta_p_162677, (int64_t) 0);
                        int64_t lifted_lambda_res_162683;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162683 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162684 = sub64(eta_p_162679, eta_p_162677);
                            int64_t lifted_lambda_res_f_res_162685 = add64((int64_t) 1, zp_lhs_162684);
                            
                            lifted_lambda_res_162683 = lifted_lambda_res_f_res_162685;
                        }
                        
                        int64_t defunc_0_f_res_162687 = add64(eta_p_162680, lifted_lambda_res_162683);
                        int64_t lifted_lambda_res_162690;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162690 = eta_p_162677;
                        } else {
                            int64_t lifted_lambda_res_f_res_162691 = add64(find_joinTuples_arg3_154618, eta_p_162677);
                            
                            lifted_lambda_res_162690 = lifted_lambda_res_f_res_162691;
                        }
                        
                        bool cond_162693 = slt64(eta_p_162678, (int64_t) 0);
                        int64_t lifted_lambda_res_162694;
                        
                        if (cond_162693) {
                            lifted_lambda_res_162694 = lifted_lambda_res_162690;
                        } else {
                            lifted_lambda_res_162694 = eta_p_162678;
                        }
                        ((int64_t *) mem_171870.mem)[i_171557] = lifted_lambda_res_162694;
                        ((int64_t *) mem_171872.mem)[i_171557] = defunc_0_f_res_162687;
                    }
                    if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
                        return 1;
                    
                    int64_t tmp_154791 = add64((int64_t) 1, s_iter_154573);
                    
                    if (memblock_set(ctx, &ext_mem_171890, &mem_171872, "mem_171872") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_171870, "mem_171870") != 0)
                        return 1;
                    loopres_f_res_154610 = tmp_154791;
                    loopres_f_res_154613 = nextRel_154617;
                }
                if (memblock_set(ctx, &ext_mem_171896, &ext_mem_171890, "ext_mem_171890") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &ext_mem_171887, "ext_mem_171887") != 0)
                    return 1;
                loopres_154604 = loopres_f_res_154610;
                loopres_154607 = loopres_f_res_154613;
                loopres_154608 = minRelevant_154576;
            }
            
            bool cond_154792 = slt64(loopres_154604, numIter_S_154519);
            bool x_154793 = loopres_154607 && cond_154792;
            
            if (memblock_set(ctx, &mem_param_tmp_172515, &ext_mem_171896, "ext_mem_171896") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_172517 = ext_171895;
            int64_t ctx_param_ext_tmp_172518 = ext_171894;
            int64_t ctx_param_ext_tmp_172519 = ext_171892;
            int64_t ctx_param_ext_tmp_172520 = ext_171891;
            bool loop_while_tmp_172521 = x_154793;
            int64_t s_iter_tmp_172522 = loopres_154604;
            int64_t minRelevant_tmp_172525 = loopres_154608;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171840, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            ctx_param_ext_171835 = ctx_param_ext_tmp_172517;
            ctx_param_ext_171836 = ctx_param_ext_tmp_172518;
            ctx_param_ext_171838 = ctx_param_ext_tmp_172519;
            ctx_param_ext_171839 = ctx_param_ext_tmp_172520;
            loop_while_154572 = loop_while_tmp_172521;
            s_iter_154573 = s_iter_tmp_172522;
            minRelevant_154576 = minRelevant_tmp_172525;
        }
        if (memblock_set(ctx, &ext_mem_171902, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171901, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        ext_171900 = ctx_param_ext_171835;
        ext_171899 = ctx_param_ext_171836;
        ext_171898 = ctx_param_ext_171838;
        ext_171897 = ctx_param_ext_171839;
        loopres_154567 = loop_while_154572;
        loopres_154568 = s_iter_154573;
        loopres_154571 = minRelevant_154576;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171904, bytes_171821, "mem_171904")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_124794});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171901.mem, ext_171898, (int64_t []) {ext_171897}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171906, bytes_171821, "mem_171906")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_124794});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171902.mem, ext_171900, (int64_t []) {ext_171899}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        
        int64_t tmp_154799 = add64((int64_t) 1, iter_154530);
        bool loop_cond_154800 = slt64(tmp_154799, numIter_R_154516);
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171904, "mem_171904") != 0)
            return 1;
        
        bool loop_while_tmp_172508 = loop_cond_154800;
        int64_t iter_tmp_172509 = tmp_154799;
        int64_t first_relevant_in_S_tmp_172512 = loopres_154571;
        
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_while_154529 = loop_while_tmp_172508;
        iter_154530 = iter_tmp_172509;
        first_relevant_in_S_154533 = first_relevant_in_S_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_171912, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171911, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    defunc_0_mergeJoin_res_154524 = loop_while_154529;
    defunc_0_mergeJoin_res_154525 = iter_154530;
    defunc_0_mergeJoin_res_154528 = first_relevant_in_S_154533;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
        return 1;
    if (mem_171914_cached_sizze_172829 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171914, &mem_171914_cached_sizze_172829, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171916_cached_sizze_172830 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171916, &mem_171916_cached_sizze_172830, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171917 = (int64_t) 4 * nR_124794;
    
    if (mem_171918_cached_sizze_172831 < bytes_171917) {
        err = lexical_realloc(ctx, &mem_171918, &mem_171918_cached_sizze_172831, bytes_171917);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171920_cached_sizze_172832 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171920, &mem_171920_cached_sizze_172832, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171922_cached_sizze_172833 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171922, &mem_171922_cached_sizze_172833, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171924_cached_sizze_172834 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171924, &mem_171924_cached_sizze_172834, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171926_cached_sizze_172835 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171926, &mem_171926_cached_sizze_172835, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171585;
    int64_t discard_171586;
    int64_t defunc_res_163230;
    int64_t scanacc_171567;
    int64_t scanacc_171568;
    int64_t redout_171571;
    
    scanacc_171567 = (int64_t) 0;
    scanacc_171568 = (int64_t) 0;
    redout_171571 = (int64_t) 0;
    for (int64_t i_171577 = 0; i_171577 < nR_124794; i_171577++) {
        int64_t zg_lhs_162623 = ((int64_t *) ext_mem_171912.mem)[i_171577];
        bool cond_162624 = slt64((int64_t) 0, zg_lhs_162623);
        int64_t lifted_lambda_res_162625;
        
        if (cond_162624) {
            lifted_lambda_res_162625 = i_171577;
        } else {
            lifted_lambda_res_162625 = (int64_t) -1;
        }
        
        bool cond_162627 = sle64((int64_t) 0, lifted_lambda_res_162625);
        bool cond_t_res_162628 = slt64(lifted_lambda_res_162625, nR_124794);
        bool x_162629 = cond_162627 && cond_t_res_162628;
        int64_t lifted_lambda_res_162630;
        
        if (x_162629) {
            bool index_certs_163187;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:205:99-102\n   #4  ftRelational.fut:196:3-205:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163188 = ((int64_t *) ext_mem_171912.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162630 = lifted_lambda_res_t_res_163188;
        } else {
            lifted_lambda_res_162630 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162634 = slt64((int64_t) 1, lifted_lambda_res_162630);
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(lifted_lambda_res_162634);
        float lifted_lambda_res_162647;
        int64_t lifted_lambda_res_162648;
        int64_t lifted_lambda_res_162649;
        
        if (x_162629) {
            bool index_certs_163189;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:205:99-102\n   #5  ftRelational.fut:196:3-205:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float lifted_lambda_res_t_res_163190 = ((float *) tR_mem_171818.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163191 = ((int64_t *) ext_mem_171820.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163192 = ((int64_t *) ext_mem_171911.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162647 = lifted_lambda_res_t_res_163190;
            lifted_lambda_res_162648 = lifted_lambda_res_t_res_163191;
            lifted_lambda_res_162649 = lifted_lambda_res_t_res_163192;
        } else {
            lifted_lambda_res_162647 = 0.0F;
            lifted_lambda_res_162648 = (int64_t) -1;
            lifted_lambda_res_162649 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154863 = add64(defunc_0_f_res_162635, scanacc_171567);
        int64_t lifted_lambda_res_154824 = add64(lifted_lambda_res_162630, scanacc_171568);
        int64_t zp_res_154844 = add64(lifted_lambda_res_162630, redout_171571);
        
        ((int64_t *) mem_171914)[i_171577] = defunc_0_op_res_154863;
        ((int64_t *) mem_171916)[i_171577] = lifted_lambda_res_154824;
        ((float *) mem_171918)[i_171577] = lifted_lambda_res_162647;
        ((int64_t *) mem_171920)[i_171577] = lifted_lambda_res_162648;
        ((int64_t *) mem_171922)[i_171577] = lifted_lambda_res_162649;
        ((int64_t *) mem_171924)[i_171577] = defunc_0_f_res_162635;
        ((int64_t *) mem_171926)[i_171577] = lifted_lambda_res_162630;
        
        int64_t scanacc_tmp_172536 = defunc_0_op_res_154863;
        int64_t scanacc_tmp_172537 = lifted_lambda_res_154824;
        int64_t redout_tmp_172540 = zp_res_154844;
        
        scanacc_171567 = scanacc_tmp_172536;
        scanacc_171568 = scanacc_tmp_172537;
        redout_171571 = redout_tmp_172540;
    }
    discard_171585 = scanacc_171567;
    discard_171586 = scanacc_171568;
    defunc_res_163230 = redout_171571;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
        return 1;
    
    int64_t bytes_171977 = (int64_t) 4 * defunc_res_163230;
    int64_t bytes_171979 = (int64_t) 8 * defunc_res_163230;
    bool cond_154864 = nR_124794 == (int64_t) 0;
    bool x_154865 = !cond_154864;
    int64_t tmp_154866 = sub64(nR_124794, (int64_t) 1);
    bool x_154867 = sle64((int64_t) 0, tmp_154866);
    bool y_154868 = slt64(tmp_154866, nR_124794);
    bool bounds_check_154869 = x_154867 && y_154868;
    bool protect_assert_disj_154870 = cond_154864 || bounds_check_154869;
    bool index_certs_154871;
    
    if (!protect_assert_disj_154870) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154866, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:205:99-102\n   #4  ftRelational.fut:196:3-205:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154872;
    
    if (x_154865) {
        int64_t x_163193 = ((int64_t *) mem_171914)[tmp_154866];
        
        m_f_res_154872 = x_163193;
    } else {
        m_f_res_154872 = (int64_t) 0;
    }
    
    int64_t m_154874;
    
    if (cond_154864) {
        m_154874 = (int64_t) 0;
    } else {
        m_154874 = m_f_res_154872;
    }
    
    bool cond_154897 = slt64((int64_t) 0, m_154874);
    int64_t m_154884 = sub64(m_154874, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154886 = slt64(m_154884, nR_124794);
    bool zzero_leq_i_p_m_t_s_154885 = sle64((int64_t) 0, m_154884);
    bool y_154888 = zzero_leq_i_p_m_t_s_154885 && i_p_m_t_s_leq_w_154886;
    bool i_lte_j_154887 = sle64((int64_t) 0, m_154874);
    bool forwards_ok_154889 = i_lte_j_154887 && y_154888;
    bool eq_x_zz_154881 = (int64_t) 0 == m_f_res_154872;
    bool p_and_eq_x_y_154882 = x_154865 && eq_x_zz_154881;
    bool empty_slice_154883 = cond_154864 || p_and_eq_x_y_154882;
    bool ok_or_empty_154890 = empty_slice_154883 || forwards_ok_154889;
    bool index_certs_154891;
    
    if (!ok_or_empty_154890) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154874, "] out of bounds for array of shape [", (long long) nR_124794, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:205:99-102\n   #4  ftRelational.fut:196:3-205:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172001 = (int64_t) 8 * m_154874;
    
    if (mem_172002_cached_sizze_172837 < bytes_172001) {
        err = lexical_realloc(ctx, &mem_172002, &mem_172002_cached_sizze_172837, bytes_172001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171926, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154874});
    
    int64_t max_mult_154898;
    
    if (cond_154897) {
        if (mem_172004_cached_sizze_172838 < bytes_171821) {
            err = lexical_realloc(ctx, &mem_172004, &mem_172004_cached_sizze_172838, bytes_171821);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171604 = 0; i_171604 < nR_124794; i_171604++) {
            int64_t eta_p_163199 = ((int64_t *) mem_171924)[i_171604];
            int64_t eta_p_163200 = ((int64_t *) mem_171914)[i_171604];
            bool cond_163201 = eta_p_163199 == (int64_t) 1;
            int64_t lifted_lambda_res_163202;
            
            if (cond_163201) {
                int64_t lifted_lambda_res_t_res_163203 = sub64(eta_p_163200, (int64_t) 1);
                
                lifted_lambda_res_163202 = lifted_lambda_res_t_res_163203;
            } else {
                lifted_lambda_res_163202 = (int64_t) -1;
            }
            ((int64_t *) mem_172004)[i_171604] = lifted_lambda_res_163202;
        }
        for (int64_t write_iter_171606 = 0; write_iter_171606 < nR_124794; write_iter_171606++) {
            int64_t write_iv_171608 = ((int64_t *) mem_172004)[write_iter_171606];
            int64_t write_iv_171609 = ((int64_t *) mem_171926)[write_iter_171606];
            
            if (sle64((int64_t) 0, write_iv_171608) && slt64(write_iv_171608, m_154874)) {
                ((int64_t *) mem_172002)[write_iv_171608] = write_iv_171609;
            }
        }
        
        int64_t defunc_0_reduce_res_163213;
        int64_t redout_171611 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171612 = 0; i_171612 < m_154874; i_171612++) {
            int64_t x_163214 = ((int64_t *) mem_172002)[i_171612];
            int64_t max_res_163217 = smax64(x_163214, redout_171611);
            int64_t redout_tmp_172548 = max_res_163217;
            
            redout_171611 = redout_tmp_172548;
        }
        defunc_0_reduce_res_163213 = redout_171611;
        max_mult_154898 = defunc_0_reduce_res_163213;
    } else {
        max_mult_154898 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154904 = slt64(max_mult_154898, (int64_t) 1);
    bool valid_154906 = !bounds_invalid_upwards_154904;
    bool range_valid_c_154907;
    
    if (!valid_154906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154898, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:205:99-102\n   #3  ftRelational.fut:196:3-205:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171970_cached_sizze_172836 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171970, &mem_171970_cached_sizze_172836, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171589 = 0; i_171589 < nR_124794; i_171589++) {
        int64_t eta_p_162530 = ((int64_t *) mem_171926)[i_171589];
        int64_t zv_lhs_162532 = add64((int64_t) -1, i_171589);
        int64_t tmp_162533 = smod64(zv_lhs_162532, nR_124794);
        int64_t lifted_lambda_res_162534 = ((int64_t *) mem_171916)[tmp_162533];
        bool cond_162536 = i_171589 == (int64_t) 0;
        int64_t lifted_lambda_res_162537;
        
        if (cond_162536) {
            lifted_lambda_res_162537 = (int64_t) 0;
        } else {
            lifted_lambda_res_162537 = lifted_lambda_res_162534;
        }
        
        bool cond_162539 = slt64((int64_t) 0, eta_p_162530);
        int64_t lifted_lambda_res_162540;
        
        if (cond_162539) {
            lifted_lambda_res_162540 = lifted_lambda_res_162537;
        } else {
            lifted_lambda_res_162540 = (int64_t) -1;
        }
        ((int64_t *) mem_171970)[i_171589] = lifted_lambda_res_162540;
    }
    if (memblock_alloc(ctx, &mem_171978, bytes_171977, "mem_171978")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172550 = 0; nest_i_172550 < defunc_res_163230; nest_i_172550++) {
        ((float *) mem_171978.mem)[nest_i_172550] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171980, bytes_171979, "mem_171980")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172551 = 0; nest_i_172551 < defunc_res_163230; nest_i_172551++) {
        ((int64_t *) mem_171980.mem)[nest_i_172551] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171982, bytes_171979, "mem_171982")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_163230; nest_i_172552++) {
        ((int64_t *) mem_171982.mem)[nest_i_172552] = (int64_t) -1;
    }
    for (int64_t write_iter_171591 = 0; write_iter_171591 < nR_124794; write_iter_171591++) {
        int64_t write_iv_171595 = ((int64_t *) mem_171970)[write_iter_171591];
        float write_iv_171596 = ((float *) mem_171918)[write_iter_171591];
        int64_t write_iv_171597 = ((int64_t *) mem_171920)[write_iter_171591];
        int64_t write_iv_171598 = ((int64_t *) mem_171922)[write_iter_171591];
        
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((float *) mem_171978.mem)[write_iv_171595] = write_iv_171596;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171980.mem)[write_iv_171595] = write_iv_171597;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171982.mem)[write_iv_171595] = write_iv_171598;
        }
    }
    
    int64_t distance_154905 = sub64(max_mult_154898, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_172019, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172022, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172025, &mem_171982, "mem_171982") != 0)
        return 1;
    for (int64_t i_154911 = 0; i_154911 < distance_154905; i_154911++) {
        int64_t index_primexp_154915 = add64((int64_t) 1, i_154911);
        
        if (memblock_alloc(ctx, &mem_172027, bytes_171979, "mem_172027")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172029, bytes_171979, "mem_172029")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172029.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172022.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172031, bytes_171977, "mem_172031")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_172031.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_172019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        for (int64_t write_iter_171613 = 0; write_iter_171613 < nR_124794; write_iter_171613++) {
            int64_t write_iv_171618 = ((int64_t *) mem_171922)[write_iter_171613];
            float write_iv_171619 = ((float *) mem_171918)[write_iter_171613];
            int64_t write_iv_171620 = ((int64_t *) mem_171920)[write_iter_171613];
            int64_t zg_lhs_163127 = ((int64_t *) mem_171926)[write_iter_171613];
            bool cond_163128 = slt64(index_primexp_154915, zg_lhs_163127);
            int64_t lifted_lambda_res_163129;
            
            if (cond_163128) {
                int64_t zp_lhs_163223 = ((int64_t *) mem_171970)[write_iter_171613];
                int64_t lifted_lambda_res_t_res_163224 = add64(index_primexp_154915, zp_lhs_163223);
                
                lifted_lambda_res_163129 = lifted_lambda_res_t_res_163224;
            } else {
                lifted_lambda_res_163129 = (int64_t) -1;
            }
            
            int64_t tmp_163133 = add64(index_primexp_154915, write_iv_171618);
            
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((float *) mem_172031.mem)[lifted_lambda_res_163129] = write_iv_171619;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172029.mem)[lifted_lambda_res_163129] = write_iv_171620;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172027.mem)[lifted_lambda_res_163129] = tmp_163133;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172556, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172557, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172558, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172019, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172022, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172025, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_172058, &mem_param_172019, "mem_param_172019") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172057, &mem_param_172022, "mem_param_172022") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172056, &mem_param_172025, "mem_param_172025") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172060, bytes_171977, "mem_172060")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_172060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172062, bytes_171979, "mem_172062")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172062.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172064, bytes_171979, "mem_172064")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172062, "mem_172062") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172064, "mem_172064") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &mem_172060, "mem_172060") != 0)
        return 1;
    prim_out_172503 = defunc_res_163230;
    if (memblock_set(ctx, &*mem_out_p_172825, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172826, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172827, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172828 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171914);
        free(mem_171916);
        free(mem_171918);
        free(mem_171920);
        free(mem_171922);
        free(mem_171924);
        free(mem_171926);
        free(mem_171970);
        free(mem_172002);
        free(mem_172004);
        if (memblock_unref(ctx, &mem_172064, "mem_172064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172062, "mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172060, "mem_172060") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172025, "mem_param_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172022, "mem_param_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172019, "mem_param_172019") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171904, "mem_171904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171872, "mem_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171870, "mem_171870") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171859, "mem_171859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171857, "mem_param_171857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171843, "mem_param_171843") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171887, "ext_mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171890, "ext_mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171896, "ext_mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_int(struct futhark_context *ctx, struct memblock *mem_out_p_172839, struct memblock *mem_out_p_172840, struct memblock *mem_out_p_172841, int64_t *out_prim_out_172842, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_119480, int64_t nS_119481, int64_t offset_R_119484, int64_t offset_S_119485, int64_t partitionSizze_119486, int64_t scatter_psizze_119487)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171914_cached_sizze_172843 = 0;
    unsigned char *mem_171914 = NULL;
    int64_t mem_171916_cached_sizze_172844 = 0;
    unsigned char *mem_171916 = NULL;
    int64_t mem_171918_cached_sizze_172845 = 0;
    unsigned char *mem_171918 = NULL;
    int64_t mem_171920_cached_sizze_172846 = 0;
    unsigned char *mem_171920 = NULL;
    int64_t mem_171922_cached_sizze_172847 = 0;
    unsigned char *mem_171922 = NULL;
    int64_t mem_171924_cached_sizze_172848 = 0;
    unsigned char *mem_171924 = NULL;
    int64_t mem_171926_cached_sizze_172849 = 0;
    unsigned char *mem_171926 = NULL;
    int64_t mem_171970_cached_sizze_172850 = 0;
    unsigned char *mem_171970 = NULL;
    int64_t mem_172002_cached_sizze_172851 = 0;
    unsigned char *mem_172002 = NULL;
    int64_t mem_172004_cached_sizze_172852 = 0;
    unsigned char *mem_172004 = NULL;
    struct memblock mem_172064;
    
    mem_172064.references = NULL;
    
    struct memblock mem_172062;
    
    mem_172062.references = NULL;
    
    struct memblock mem_172060;
    
    mem_172060.references = NULL;
    
    struct memblock mem_param_tmp_172558;
    
    mem_param_tmp_172558.references = NULL;
    
    struct memblock mem_param_tmp_172557;
    
    mem_param_tmp_172557.references = NULL;
    
    struct memblock mem_param_tmp_172556;
    
    mem_param_tmp_172556.references = NULL;
    
    struct memblock mem_172031;
    
    mem_172031.references = NULL;
    
    struct memblock mem_172029;
    
    mem_172029.references = NULL;
    
    struct memblock mem_172027;
    
    mem_172027.references = NULL;
    
    struct memblock mem_param_172025;
    
    mem_param_172025.references = NULL;
    
    struct memblock mem_param_172022;
    
    mem_param_172022.references = NULL;
    
    struct memblock mem_param_172019;
    
    mem_param_172019.references = NULL;
    
    struct memblock ext_mem_172056;
    
    ext_mem_172056.references = NULL;
    
    struct memblock ext_mem_172057;
    
    ext_mem_172057.references = NULL;
    
    struct memblock ext_mem_172058;
    
    ext_mem_172058.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171980;
    
    mem_171980.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_171906;
    
    mem_171906.references = NULL;
    
    struct memblock mem_171904;
    
    mem_171904.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_171872;
    
    mem_171872.references = NULL;
    
    struct memblock mem_171870;
    
    mem_171870.references = NULL;
    
    struct memblock mem_param_tmp_172530;
    
    mem_param_tmp_172530.references = NULL;
    
    struct memblock mem_171859;
    
    mem_171859.references = NULL;
    
    struct memblock mem_param_171857;
    
    mem_param_171857.references = NULL;
    
    struct memblock ext_mem_171868;
    
    ext_mem_171868.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_param_171843;
    
    mem_param_171843.references = NULL;
    
    struct memblock ext_mem_171854;
    
    ext_mem_171854.references = NULL;
    
    struct memblock ext_mem_171887;
    
    ext_mem_171887.references = NULL;
    
    struct memblock ext_mem_171890;
    
    ext_mem_171890.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock ext_mem_171896;
    
    ext_mem_171896.references = NULL;
    
    struct memblock mem_param_171840;
    
    mem_param_171840.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171901;
    
    ext_mem_171901.references = NULL;
    
    struct memblock ext_mem_171902;
    
    ext_mem_171902.references = NULL;
    
    struct memblock mem_171834;
    
    mem_171834.references = NULL;
    
    struct memblock mem_171832;
    
    mem_171832.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock ext_mem_171912;
    
    ext_mem_171912.references = NULL;
    
    struct memblock mem_171824;
    
    mem_171824.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t partitionSizze_154510 = sdiv64(partitionSizze_119486, (int64_t) 4);
    int64_t zm_lhs_154511 = add64(nR_119480, partitionSizze_154510);
    int64_t zs_lhs_154512 = sub64(zm_lhs_154511, (int64_t) 1);
    bool zzero_154513 = partitionSizze_154510 == (int64_t) 0;
    bool nonzzero_154514 = !zzero_154513;
    bool nonzzero_cert_154515;
    
    if (!nonzzero_154514) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_154516 = sdiv64(zs_lhs_154512, partitionSizze_154510);
    int64_t zm_lhs_154517 = add64(nS_119481, partitionSizze_154510);
    int64_t zs_lhs_154518 = sub64(zm_lhs_154517, (int64_t) 1);
    int64_t numIter_S_154519 = sdiv64(zs_lhs_154518, partitionSizze_154510);
    
    if (futrts_indicesWithIncrement_16319(ctx, &ext_mem_171820, tR_mem_171818, nR_119480, offset_R_119484) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * nR_119480;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < nR_119480; nest_i_172504++) {
        ((int64_t *) mem_171822.mem)[nest_i_172504] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171824, bytes_171821, "mem_171824")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < nR_119480; nest_i_172505++) {
        ((int64_t *) mem_171824.mem)[nest_i_172505] = (int64_t) 0;
    }
    
    bool loop_cond_154523 = slt64((int64_t) 0, numIter_R_154516);
    bool defunc_0_mergeJoin_res_154524;
    int64_t defunc_0_mergeJoin_res_154525;
    int64_t defunc_0_mergeJoin_res_154528;
    bool loop_while_154529;
    int64_t iter_154530;
    int64_t first_relevant_in_S_154533;
    
    if (memblock_set(ctx, &mem_param_171827, &mem_171824, "mem_171824") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_while_154529 = loop_cond_154523;
    iter_154530 = (int64_t) 0;
    first_relevant_in_S_154533 = (int64_t) 0;
    while (loop_while_154529) {
        int64_t tR_start_154534 = mul64(partitionSizze_154510, iter_154530);
        int64_t min_arg1_154535 = add64(partitionSizze_154510, tR_start_154534);
        int64_t min_res_154536 = smin64(nR_119480, min_arg1_154535);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 = sub64(min_res_154536, tR_start_154534);
        bool empty_slice_154538 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 == (int64_t) 0;
        int64_t m_154539 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, (int64_t) 1);
        int64_t i_p_m_t_s_154540 = add64(tR_start_154534, m_154539);
        bool zzero_leq_i_p_m_t_s_154541 = sle64((int64_t) 0, i_p_m_t_s_154540);
        bool i_p_m_t_s_leq_w_154542 = slt64(i_p_m_t_s_154540, nR_119480);
        bool zzero_lte_i_154543 = sle64((int64_t) 0, tR_start_154534);
        bool i_lte_j_154544 = sle64(tR_start_154534, min_res_154536);
        bool y_154545 = i_p_m_t_s_leq_w_154542 && zzero_lte_i_154543;
        bool y_154546 = zzero_leq_i_p_m_t_s_154541 && y_154545;
        bool forwards_ok_154547 = i_lte_j_154544 && y_154546;
        bool ok_or_empty_154548 = empty_slice_154538 || forwards_ok_154547;
        bool index_certs_154549;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171831 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537;
        bool cond_154553 = slt64(first_relevant_in_S_154533, numIter_S_154519);
        bool y_154554 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool loop_not_taken_154555 = !cond_154553;
        bool protect_assert_disj_154556 = y_154554 || loop_not_taken_154555;
        bool index_certs_154557;
        
        if (!protect_assert_disj_154556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154560 = sle64((int64_t) 0, m_154539);
        bool y_154561 = slt64(m_154539, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool bounds_check_154562 = x_154560 && y_154561;
        bool protect_assert_disj_154563 = loop_not_taken_154555 || bounds_check_154562;
        bool index_certs_154564;
        
        if (!protect_assert_disj_154563) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154795;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:183:99-102\n   #4  ftRelational.fut:174:3-183:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171832, bytes_171831, "mem_171832")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172513 = 0; nest_i_172513 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172513++) {
            ((int64_t *) mem_171832.mem)[nest_i_172513] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171834, bytes_171831, "mem_171834")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172514 = 0; nest_i_172514 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172514++) {
            ((int64_t *) mem_171834.mem)[nest_i_172514] = (int64_t) 0;
        }
        
        int32_t gt_lhs_154558;
        
        if (cond_154553) {
            int32_t x_163142 = ((int32_t *) tR_mem_171818.mem)[tR_start_154534];
            
            gt_lhs_154558 = x_163142;
        } else {
            gt_lhs_154558 = 0;
        }
        
        int32_t lt_lhs_154565;
        
        if (cond_154553) {
            int32_t x_163143 = ((int32_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
            
            lt_lhs_154565 = x_163143;
        } else {
            lt_lhs_154565 = 0;
        }
        
        int64_t ext_171900;
        int64_t ext_171899;
        int64_t ext_171898;
        int64_t ext_171897;
        bool loopres_154567;
        int64_t loopres_154568;
        int64_t loopres_154571;
        bool loop_while_154572;
        int64_t s_iter_154573;
        int64_t minRelevant_154576;
        int64_t ctx_param_ext_171835;
        int64_t ctx_param_ext_171836;
        int64_t ctx_param_ext_171838;
        int64_t ctx_param_ext_171839;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171840, &mem_171832, "mem_171832") != 0)
            return 1;
        ctx_param_ext_171835 = (int64_t) 0;
        ctx_param_ext_171836 = (int64_t) 1;
        ctx_param_ext_171838 = (int64_t) 0;
        ctx_param_ext_171839 = (int64_t) 1;
        loop_while_154572 = cond_154553;
        s_iter_154573 = first_relevant_in_S_154533;
        minRelevant_154576 = first_relevant_in_S_154533;
        while (loop_while_154572) {
            int64_t tS_start_154577 = mul64(partitionSizze_154510, s_iter_154573);
            int64_t min_arg1_154578 = add64(partitionSizze_154510, tS_start_154577);
            int64_t min_res_154579 = smin64(nS_119481, min_arg1_154578);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 = sub64(min_res_154579, tS_start_154577);
            bool empty_slice_154581 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 == (int64_t) 0;
            int64_t m_154582 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, (int64_t) 1);
            int64_t i_p_m_t_s_154583 = add64(tS_start_154577, m_154582);
            bool zzero_leq_i_p_m_t_s_154584 = sle64((int64_t) 0, i_p_m_t_s_154583);
            bool i_p_m_t_s_leq_w_154585 = slt64(i_p_m_t_s_154583, nS_119481);
            bool zzero_lte_i_154586 = sle64((int64_t) 0, tS_start_154577);
            bool i_lte_j_154587 = sle64(tS_start_154577, min_res_154579);
            bool y_154588 = i_p_m_t_s_leq_w_154585 && zzero_lte_i_154586;
            bool y_154589 = zzero_leq_i_p_m_t_s_154584 && y_154588;
            bool forwards_ok_154590 = i_lte_j_154587 && y_154589;
            bool ok_or_empty_154591 = empty_slice_154581 || forwards_ok_154590;
            bool index_certs_154592;
            
            if (!ok_or_empty_154591) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154577, ":", (long long) min_res_154579, "] out of bounds for array of shape [", (long long) nS_119481, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154593 = sle64((int64_t) 0, m_154582);
            bool y_154594 = slt64(m_154582, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool bounds_check_154595 = x_154593 && y_154594;
            bool index_certs_154596;
            
            if (!bounds_check_154595) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154599 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool index_certs_154600;
            
            if (!y_154599) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t gt_rhs_154597 = ((int32_t *) tS_mem_171819.mem)[i_p_m_t_s_154583];
            bool defunc_0_gt_res_154598 = slt32(gt_rhs_154597, gt_lhs_154558);
            int32_t lt_rhs_154601 = ((int32_t *) tS_mem_171819.mem)[tS_start_154577];
            bool defunc_0_lt_res_154602 = slt32(lt_lhs_154565, lt_rhs_154601);
            bool thisStillRel_154603 = !defunc_0_lt_res_154602;
            int64_t ext_171889;
            
            if (defunc_0_lt_res_154602) {
                ext_171889 = ctx_param_ext_171835;
            } else {
                ext_171889 = (int64_t) 0;
            }
            
            int64_t ext_171888;
            
            if (defunc_0_lt_res_154602) {
                ext_171888 = ctx_param_ext_171836;
            } else {
                ext_171888 = (int64_t) 1;
            }
            
            int64_t ext_171886;
            
            if (defunc_0_lt_res_154602) {
                ext_171886 = ctx_param_ext_171838;
            } else {
                ext_171886 = (int64_t) 0;
            }
            
            int64_t ext_171885;
            
            if (defunc_0_lt_res_154602) {
                ext_171885 = ctx_param_ext_171839;
            } else {
                ext_171885 = (int64_t) 1;
            }
            
            int64_t ext_171895;
            
            if (defunc_0_gt_res_154598) {
                ext_171895 = ctx_param_ext_171835;
            } else {
                ext_171895 = ext_171889;
            }
            
            int64_t ext_171894;
            
            if (defunc_0_gt_res_154598) {
                ext_171894 = ctx_param_ext_171836;
            } else {
                ext_171894 = ext_171888;
            }
            
            int64_t ext_171892;
            
            if (defunc_0_gt_res_154598) {
                ext_171892 = ctx_param_ext_171838;
            } else {
                ext_171892 = ext_171886;
            }
            
            int64_t ext_171891;
            
            if (defunc_0_gt_res_154598) {
                ext_171891 = ctx_param_ext_171839;
            } else {
                ext_171891 = ext_171885;
            }
            
            int64_t loopres_154604;
            bool loopres_154607;
            int64_t loopres_154608;
            
            if (defunc_0_gt_res_154598) {
                int64_t tmp_163144 = add64((int64_t) 1, s_iter_154573);
                
                if (memblock_set(ctx, &ext_mem_171896, &mem_param_171837, "mem_param_171837") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &mem_param_171840, "mem_param_171840") != 0)
                    return 1;
                loopres_154604 = tmp_163144;
                loopres_154607 = 1;
                loopres_154608 = tmp_163144;
            } else {
                int64_t loopres_f_res_154610;
                bool loopres_f_res_154613;
                
                if (defunc_0_lt_res_154602) {
                    if (memblock_set(ctx, &ext_mem_171890, &mem_param_171837, "mem_param_171837") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_param_171840, "mem_param_171840") != 0)
                        return 1;
                    loopres_f_res_154610 = s_iter_154573;
                    loopres_f_res_154613 = thisStillRel_154603;
                } else {
                    bool index_certs_154614;
                    
                    if (!bounds_check_154562) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lt_lhs_154615 = ((int32_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
                    bool defunc_0_lt_res_154616 = slt32(lt_lhs_154615, gt_rhs_154597);
                    bool nextRel_154617 = !defunc_0_lt_res_154616;
                    int64_t find_joinTuples_arg3_154618 = add64(offset_S_119485, tS_start_154577);
                    double i64_res_154619 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                    double log2_res_154620 = futrts_log2_64(i64_res_154619);
                    double ceil_res_154621 = futrts_ceil64(log2_res_154620);
                    int64_t f64_res_154622 = fptosi_f64_i64(ceil_res_154621);
                    int64_t num_iter_154623 = add64((int64_t) 1, f64_res_154622);
                    int64_t bsearch_first_154625;
                    int64_t last_step_154628;
                    
                    if (memblock_set(ctx, &mem_param_171843, &mem_171834, "mem_171834") != 0)
                        return 1;
                    last_step_154628 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154626 = 0; i_154626 < num_iter_154623; i_154626++) {
                        int64_t zs_lhs_154629 = add64((int64_t) 1, last_step_154628);
                        int64_t this_step_154630 = sdiv64(zs_lhs_154629, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171845, bytes_171831, "mem_171845")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171547++) {
                            int64_t eta_p_162698 = ((int64_t *) mem_param_171843.mem)[i_171547];
                            int64_t slice_171796 = tR_start_154534 + i_171547;
                            int32_t eta_p_162699 = ((int32_t *) tR_mem_171818.mem)[slice_171796];
                            bool cond_162701 = sle64(eta_p_162698, (int64_t) 0);
                            int32_t prev_elem_162702;
                            
                            if (cond_162701) {
                                bool index_certs_163146;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162702 = lt_rhs_154601;
                            } else {
                                int64_t tmp_162706 = sub64(eta_p_162698, (int64_t) 1);
                                bool x_162707 = sle64((int64_t) 0, tmp_162706);
                                bool y_162708 = slt64(tmp_162706, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162709 = x_162707 && y_162708;
                                bool index_certs_162710;
                                
                                if (!bounds_check_162709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162706, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162711 = tS_start_154577 + tmp_162706;
                                int32_t prev_elem_f_res_162712 = ((int32_t *) tS_mem_171819.mem)[slice_162711];
                                
                                prev_elem_162702 = prev_elem_f_res_162712;
                            }
                            
                            bool cond_162713 = slt64(eta_p_162698, (int64_t) 0);
                            int32_t cur_elem_162714;
                            
                            if (cond_162713) {
                                bool index_certs_163149;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162714 = lt_rhs_154601;
                            } else {
                                bool x_162718 = sle64((int64_t) 0, eta_p_162698);
                                bool y_162719 = slt64(eta_p_162698, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162720 = x_162718 && y_162719;
                                bool index_certs_162721;
                                
                                if (!bounds_check_162720) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162698, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162722 = tS_start_154577 + eta_p_162698;
                                int32_t cur_elem_f_res_162723 = ((int32_t *) tS_mem_171819.mem)[slice_162722];
                                
                                cur_elem_162714 = cur_elem_f_res_162723;
                            }
                            
                            bool cond_162724 = sle64(m_154582, eta_p_162698);
                            int32_t next_elem_162725;
                            
                            if (cond_162724) {
                                bool index_certs_163155;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162725 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162733 = add64((int64_t) 1, eta_p_162698);
                                bool x_162734 = sle64((int64_t) 0, tmp_162733);
                                bool y_162735 = slt64(tmp_162733, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162736 = x_162734 && y_162735;
                                bool index_certs_162737;
                                
                                if (!bounds_check_162736) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162733, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162738 = tS_start_154577 + tmp_162733;
                                int32_t next_elem_f_res_162739 = ((int32_t *) tS_mem_171819.mem)[slice_162738];
                                
                                next_elem_162725 = next_elem_f_res_162739;
                            }
                            
                            int64_t defunc_0_f_res_162744;
                            
                            if (cond_162713) {
                                defunc_0_f_res_162744 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162745 = eta_p_162699 == cur_elem_162714;
                                bool cond_162746 = eta_p_162698 == (int64_t) 0;
                                bool defunc_0_gt_res_162747 = slt32(prev_elem_162702, eta_p_162699);
                                bool x_162748 = !cond_162746;
                                bool y_162749 = defunc_0_gt_res_162747 && x_162748;
                                bool cond_t_res_162750 = cond_162746 || y_162749;
                                bool x_162751 = defunc_0_eq_res_162745 && cond_t_res_162750;
                                int64_t defunc_0_f_res_f_res_162752;
                                
                                if (x_162751) {
                                    defunc_0_f_res_f_res_162752 = eta_p_162698;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162753;
                                    
                                    if (defunc_0_eq_res_162745) {
                                        int64_t max_arg1_163158 = sub64(eta_p_162698, this_step_154630);
                                        int64_t max_res_163159 = smax64((int64_t) 0, max_arg1_163158);
                                        
                                        defunc_0_f_res_f_res_f_res_162753 = max_res_163159;
                                    } else {
                                        bool defunc_0_gt_res_162756 = slt32(cur_elem_162714, eta_p_162699);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162757;
                                        
                                        if (defunc_0_gt_res_162756) {
                                            bool cond_163161 = eta_p_162698 == m_154582;
                                            bool defunc_0_lt_res_163162 = slt32(eta_p_162699, next_elem_162725);
                                            bool x_163163 = !cond_163161;
                                            bool y_163164 = defunc_0_lt_res_163162 && x_163163;
                                            bool cond_163165 = cond_163161 || y_163164;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                            
                                            if (cond_163165) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_163167 = add64(this_step_154630, eta_p_162698);
                                                int64_t min_res_163168 = smin64(m_154582, min_arg1_163167);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = min_res_163168;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                            
                                            if (cond_t_res_162750) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162768 = sub64(eta_p_162698, this_step_154630);
                                                int64_t max_res_162769 = smax64((int64_t) 0, max_arg1_162768);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = max_res_162769;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                        }
                                        defunc_0_f_res_f_res_f_res_162753 = defunc_0_f_res_f_res_f_res_f_res_162757;
                                    }
                                    defunc_0_f_res_f_res_162752 = defunc_0_f_res_f_res_f_res_162753;
                                }
                                defunc_0_f_res_162744 = defunc_0_f_res_f_res_162752;
                            }
                            ((int64_t *) mem_171845.mem)[i_171547] = defunc_0_f_res_162744;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171845, "mem_171845") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172528 = this_step_154630;
                        
                        if (memblock_set(ctx, &mem_param_171843, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                            return 1;
                        last_step_154628 = last_step_tmp_172528;
                    }
                    if (memblock_set(ctx, &ext_mem_171854, &mem_param_171843, "mem_param_171843") != 0)
                        return 1;
                    bsearch_first_154625 = last_step_154628;
                    
                    int64_t bsearch_last_154708;
                    int64_t last_step_154711;
                    
                    if (memblock_set(ctx, &mem_param_171857, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    last_step_154711 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154709 = 0; i_154709 < num_iter_154623; i_154709++) {
                        int64_t zs_lhs_154712 = add64((int64_t) 1, last_step_154711);
                        int64_t max_arg1_154713 = sdiv64(zs_lhs_154712, (int64_t) 2);
                        int64_t max_res_154714 = smax64((int64_t) 1, max_arg1_154713);
                        
                        if (memblock_alloc(ctx, &mem_171859, bytes_171831, "mem_171859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171551 = 0; i_171551 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171551++) {
                            int64_t eta_p_162821 = ((int64_t *) mem_param_171857.mem)[i_171551];
                            int64_t slice_171795 = tR_start_154534 + i_171551;
                            int32_t eta_p_162822 = ((int32_t *) tR_mem_171818.mem)[slice_171795];
                            bool cond_162824 = slt64(eta_p_162821, (int64_t) 0);
                            int32_t cur_elem_162825;
                            
                            if (cond_162824) {
                                bool index_certs_163171;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162825 = lt_rhs_154601;
                            } else {
                                bool x_162829 = sle64((int64_t) 0, eta_p_162821);
                                bool y_162830 = slt64(eta_p_162821, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162831 = x_162829 && y_162830;
                                bool index_certs_162832;
                                
                                if (!bounds_check_162831) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162821, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162833 = tS_start_154577 + eta_p_162821;
                                int32_t cur_elem_f_res_162834 = ((int32_t *) tS_mem_171819.mem)[slice_162833];
                                
                                cur_elem_162825 = cur_elem_f_res_162834;
                            }
                            
                            bool cond_162835 = sle64(m_154582, eta_p_162821);
                            int32_t next_elem_162836;
                            
                            if (cond_162835) {
                                bool index_certs_163177;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162836 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162844 = add64((int64_t) 1, eta_p_162821);
                                bool x_162845 = sle64((int64_t) 0, tmp_162844);
                                bool y_162846 = slt64(tmp_162844, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162847 = x_162845 && y_162846;
                                bool index_certs_162848;
                                
                                if (!bounds_check_162847) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162844, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162849 = tS_start_154577 + tmp_162844;
                                int32_t next_elem_f_res_162850 = ((int32_t *) tS_mem_171819.mem)[slice_162849];
                                
                                next_elem_162836 = next_elem_f_res_162850;
                            }
                            
                            int64_t defunc_0_f_res_162854;
                            
                            if (cond_162824) {
                                defunc_0_f_res_162854 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162855 = eta_p_162822 == cur_elem_162825;
                                bool cond_162857 = eta_p_162821 == m_154582;
                                bool defunc_0_gt_res_162858 = slt32(eta_p_162822, next_elem_162836);
                                bool x_162859 = !cond_162857;
                                bool y_162860 = defunc_0_gt_res_162858 && x_162859;
                                bool cond_t_res_162861 = cond_162857 || y_162860;
                                bool x_162862 = defunc_0_eq_res_162855 && cond_t_res_162861;
                                int64_t defunc_0_f_res_f_res_162863;
                                
                                if (x_162862) {
                                    defunc_0_f_res_f_res_162863 = eta_p_162821;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162864;
                                    
                                    if (defunc_0_eq_res_162855) {
                                        int64_t min_arg1_163180 = add64(max_res_154714, eta_p_162821);
                                        int64_t min_res_163181 = smin64(m_154582, min_arg1_163180);
                                        
                                        defunc_0_f_res_f_res_f_res_162864 = min_res_163181;
                                    } else {
                                        bool defunc_0_gt_res_162867 = slt32(cur_elem_162825, eta_p_162822);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162868;
                                        
                                        if (defunc_0_gt_res_162867) {
                                            int64_t min_arg1_163182 = add64(max_res_154714, eta_p_162821);
                                            int64_t min_res_163183 = smin64(m_154582, min_arg1_163182);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = min_res_163183;
                                        } else {
                                            int64_t max_arg1_162871 = sub64(eta_p_162821, max_res_154714);
                                            int64_t max_res_162872 = smax64((int64_t) 0, max_arg1_162871);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = max_res_162872;
                                        }
                                        defunc_0_f_res_f_res_f_res_162864 = defunc_0_f_res_f_res_f_res_f_res_162868;
                                    }
                                    defunc_0_f_res_f_res_162863 = defunc_0_f_res_f_res_f_res_162864;
                                }
                                defunc_0_f_res_162854 = defunc_0_f_res_f_res_162863;
                            }
                            ((int64_t *) mem_171859.mem)[i_171551] = defunc_0_f_res_162854;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172530, &mem_171859, "mem_171859") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172532 = max_res_154714;
                        
                        if (memblock_set(ctx, &mem_param_171857, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
                            return 1;
                        last_step_154711 = last_step_tmp_172532;
                    }
                    if (memblock_set(ctx, &ext_mem_171868, &mem_param_171857, "mem_param_171857") != 0)
                        return 1;
                    bsearch_last_154708 = last_step_154711;
                    if (memblock_alloc(ctx, &mem_171870, bytes_171831, "mem_171870")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171872, bytes_171831, "mem_171872")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171557 = 0; i_171557 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171557++) {
                        int64_t eta_p_162677 = ((int64_t *) ext_mem_171854.mem)[i_171557];
                        int64_t eta_p_162678 = ((int64_t *) mem_param_171840.mem)[ctx_param_ext_171838 + i_171557 * ctx_param_ext_171839];
                        int64_t eta_p_162679 = ((int64_t *) ext_mem_171868.mem)[i_171557];
                        int64_t eta_p_162680 = ((int64_t *) mem_param_171837.mem)[ctx_param_ext_171835 + i_171557 * ctx_param_ext_171836];
                        bool cond_162682 = slt64(eta_p_162677, (int64_t) 0);
                        int64_t lifted_lambda_res_162683;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162683 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162684 = sub64(eta_p_162679, eta_p_162677);
                            int64_t lifted_lambda_res_f_res_162685 = add64((int64_t) 1, zp_lhs_162684);
                            
                            lifted_lambda_res_162683 = lifted_lambda_res_f_res_162685;
                        }
                        
                        int64_t defunc_0_f_res_162687 = add64(eta_p_162680, lifted_lambda_res_162683);
                        int64_t lifted_lambda_res_162690;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162690 = eta_p_162677;
                        } else {
                            int64_t lifted_lambda_res_f_res_162691 = add64(find_joinTuples_arg3_154618, eta_p_162677);
                            
                            lifted_lambda_res_162690 = lifted_lambda_res_f_res_162691;
                        }
                        
                        bool cond_162693 = slt64(eta_p_162678, (int64_t) 0);
                        int64_t lifted_lambda_res_162694;
                        
                        if (cond_162693) {
                            lifted_lambda_res_162694 = lifted_lambda_res_162690;
                        } else {
                            lifted_lambda_res_162694 = eta_p_162678;
                        }
                        ((int64_t *) mem_171870.mem)[i_171557] = lifted_lambda_res_162694;
                        ((int64_t *) mem_171872.mem)[i_171557] = defunc_0_f_res_162687;
                    }
                    if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
                        return 1;
                    
                    int64_t tmp_154791 = add64((int64_t) 1, s_iter_154573);
                    
                    if (memblock_set(ctx, &ext_mem_171890, &mem_171872, "mem_171872") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_171870, "mem_171870") != 0)
                        return 1;
                    loopres_f_res_154610 = tmp_154791;
                    loopres_f_res_154613 = nextRel_154617;
                }
                if (memblock_set(ctx, &ext_mem_171896, &ext_mem_171890, "ext_mem_171890") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &ext_mem_171887, "ext_mem_171887") != 0)
                    return 1;
                loopres_154604 = loopres_f_res_154610;
                loopres_154607 = loopres_f_res_154613;
                loopres_154608 = minRelevant_154576;
            }
            
            bool cond_154792 = slt64(loopres_154604, numIter_S_154519);
            bool x_154793 = loopres_154607 && cond_154792;
            
            if (memblock_set(ctx, &mem_param_tmp_172515, &ext_mem_171896, "ext_mem_171896") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_172517 = ext_171895;
            int64_t ctx_param_ext_tmp_172518 = ext_171894;
            int64_t ctx_param_ext_tmp_172519 = ext_171892;
            int64_t ctx_param_ext_tmp_172520 = ext_171891;
            bool loop_while_tmp_172521 = x_154793;
            int64_t s_iter_tmp_172522 = loopres_154604;
            int64_t minRelevant_tmp_172525 = loopres_154608;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171840, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            ctx_param_ext_171835 = ctx_param_ext_tmp_172517;
            ctx_param_ext_171836 = ctx_param_ext_tmp_172518;
            ctx_param_ext_171838 = ctx_param_ext_tmp_172519;
            ctx_param_ext_171839 = ctx_param_ext_tmp_172520;
            loop_while_154572 = loop_while_tmp_172521;
            s_iter_154573 = s_iter_tmp_172522;
            minRelevant_154576 = minRelevant_tmp_172525;
        }
        if (memblock_set(ctx, &ext_mem_171902, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171901, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        ext_171900 = ctx_param_ext_171835;
        ext_171899 = ctx_param_ext_171836;
        ext_171898 = ctx_param_ext_171838;
        ext_171897 = ctx_param_ext_171839;
        loopres_154567 = loop_while_154572;
        loopres_154568 = s_iter_154573;
        loopres_154571 = minRelevant_154576;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171904, bytes_171821, "mem_171904")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_119480});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171901.mem, ext_171898, (int64_t []) {ext_171897}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171906, bytes_171821, "mem_171906")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_119480});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171902.mem, ext_171900, (int64_t []) {ext_171899}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        
        int64_t tmp_154799 = add64((int64_t) 1, iter_154530);
        bool loop_cond_154800 = slt64(tmp_154799, numIter_R_154516);
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171904, "mem_171904") != 0)
            return 1;
        
        bool loop_while_tmp_172508 = loop_cond_154800;
        int64_t iter_tmp_172509 = tmp_154799;
        int64_t first_relevant_in_S_tmp_172512 = loopres_154571;
        
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_while_154529 = loop_while_tmp_172508;
        iter_154530 = iter_tmp_172509;
        first_relevant_in_S_154533 = first_relevant_in_S_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_171912, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171911, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    defunc_0_mergeJoin_res_154524 = loop_while_154529;
    defunc_0_mergeJoin_res_154525 = iter_154530;
    defunc_0_mergeJoin_res_154528 = first_relevant_in_S_154533;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
        return 1;
    if (mem_171914_cached_sizze_172843 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171914, &mem_171914_cached_sizze_172843, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171916_cached_sizze_172844 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171916, &mem_171916_cached_sizze_172844, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171917 = (int64_t) 4 * nR_119480;
    
    if (mem_171918_cached_sizze_172845 < bytes_171917) {
        err = lexical_realloc(ctx, &mem_171918, &mem_171918_cached_sizze_172845, bytes_171917);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171920_cached_sizze_172846 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171920, &mem_171920_cached_sizze_172846, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171922_cached_sizze_172847 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171922, &mem_171922_cached_sizze_172847, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171924_cached_sizze_172848 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171924, &mem_171924_cached_sizze_172848, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171926_cached_sizze_172849 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171926, &mem_171926_cached_sizze_172849, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171585;
    int64_t discard_171586;
    int64_t defunc_res_163230;
    int64_t scanacc_171567;
    int64_t scanacc_171568;
    int64_t redout_171571;
    
    scanacc_171567 = (int64_t) 0;
    scanacc_171568 = (int64_t) 0;
    redout_171571 = (int64_t) 0;
    for (int64_t i_171577 = 0; i_171577 < nR_119480; i_171577++) {
        int64_t zg_lhs_162623 = ((int64_t *) ext_mem_171912.mem)[i_171577];
        bool cond_162624 = slt64((int64_t) 0, zg_lhs_162623);
        int64_t lifted_lambda_res_162625;
        
        if (cond_162624) {
            lifted_lambda_res_162625 = i_171577;
        } else {
            lifted_lambda_res_162625 = (int64_t) -1;
        }
        
        bool cond_162627 = sle64((int64_t) 0, lifted_lambda_res_162625);
        bool cond_t_res_162628 = slt64(lifted_lambda_res_162625, nR_119480);
        bool x_162629 = cond_162627 && cond_t_res_162628;
        int64_t lifted_lambda_res_162630;
        
        if (x_162629) {
            bool index_certs_163187;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:183:99-102\n   #4  ftRelational.fut:174:3-183:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163188 = ((int64_t *) ext_mem_171912.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162630 = lifted_lambda_res_t_res_163188;
        } else {
            lifted_lambda_res_162630 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162634 = slt64((int64_t) 1, lifted_lambda_res_162630);
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(lifted_lambda_res_162634);
        int32_t lifted_lambda_res_162647;
        int64_t lifted_lambda_res_162648;
        int64_t lifted_lambda_res_162649;
        
        if (x_162629) {
            bool index_certs_163189;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:183:99-102\n   #5  ftRelational.fut:174:3-183:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t lifted_lambda_res_t_res_163190 = ((int32_t *) tR_mem_171818.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163191 = ((int64_t *) ext_mem_171820.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163192 = ((int64_t *) ext_mem_171911.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162647 = lifted_lambda_res_t_res_163190;
            lifted_lambda_res_162648 = lifted_lambda_res_t_res_163191;
            lifted_lambda_res_162649 = lifted_lambda_res_t_res_163192;
        } else {
            lifted_lambda_res_162647 = 0;
            lifted_lambda_res_162648 = (int64_t) -1;
            lifted_lambda_res_162649 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154863 = add64(defunc_0_f_res_162635, scanacc_171567);
        int64_t lifted_lambda_res_154824 = add64(lifted_lambda_res_162630, scanacc_171568);
        int64_t zp_res_154844 = add64(lifted_lambda_res_162630, redout_171571);
        
        ((int64_t *) mem_171914)[i_171577] = defunc_0_op_res_154863;
        ((int64_t *) mem_171916)[i_171577] = lifted_lambda_res_154824;
        ((int32_t *) mem_171918)[i_171577] = lifted_lambda_res_162647;
        ((int64_t *) mem_171920)[i_171577] = lifted_lambda_res_162648;
        ((int64_t *) mem_171922)[i_171577] = lifted_lambda_res_162649;
        ((int64_t *) mem_171924)[i_171577] = defunc_0_f_res_162635;
        ((int64_t *) mem_171926)[i_171577] = lifted_lambda_res_162630;
        
        int64_t scanacc_tmp_172536 = defunc_0_op_res_154863;
        int64_t scanacc_tmp_172537 = lifted_lambda_res_154824;
        int64_t redout_tmp_172540 = zp_res_154844;
        
        scanacc_171567 = scanacc_tmp_172536;
        scanacc_171568 = scanacc_tmp_172537;
        redout_171571 = redout_tmp_172540;
    }
    discard_171585 = scanacc_171567;
    discard_171586 = scanacc_171568;
    defunc_res_163230 = redout_171571;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
        return 1;
    
    int64_t bytes_171977 = (int64_t) 4 * defunc_res_163230;
    int64_t bytes_171979 = (int64_t) 8 * defunc_res_163230;
    bool cond_154864 = nR_119480 == (int64_t) 0;
    bool x_154865 = !cond_154864;
    int64_t tmp_154866 = sub64(nR_119480, (int64_t) 1);
    bool x_154867 = sle64((int64_t) 0, tmp_154866);
    bool y_154868 = slt64(tmp_154866, nR_119480);
    bool bounds_check_154869 = x_154867 && y_154868;
    bool protect_assert_disj_154870 = cond_154864 || bounds_check_154869;
    bool index_certs_154871;
    
    if (!protect_assert_disj_154870) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154866, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:183:99-102\n   #4  ftRelational.fut:174:3-183:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154872;
    
    if (x_154865) {
        int64_t x_163193 = ((int64_t *) mem_171914)[tmp_154866];
        
        m_f_res_154872 = x_163193;
    } else {
        m_f_res_154872 = (int64_t) 0;
    }
    
    int64_t m_154874;
    
    if (cond_154864) {
        m_154874 = (int64_t) 0;
    } else {
        m_154874 = m_f_res_154872;
    }
    
    bool cond_154897 = slt64((int64_t) 0, m_154874);
    int64_t m_154884 = sub64(m_154874, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154886 = slt64(m_154884, nR_119480);
    bool zzero_leq_i_p_m_t_s_154885 = sle64((int64_t) 0, m_154884);
    bool y_154888 = zzero_leq_i_p_m_t_s_154885 && i_p_m_t_s_leq_w_154886;
    bool i_lte_j_154887 = sle64((int64_t) 0, m_154874);
    bool forwards_ok_154889 = i_lte_j_154887 && y_154888;
    bool eq_x_zz_154881 = (int64_t) 0 == m_f_res_154872;
    bool p_and_eq_x_y_154882 = x_154865 && eq_x_zz_154881;
    bool empty_slice_154883 = cond_154864 || p_and_eq_x_y_154882;
    bool ok_or_empty_154890 = empty_slice_154883 || forwards_ok_154889;
    bool index_certs_154891;
    
    if (!ok_or_empty_154890) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154874, "] out of bounds for array of shape [", (long long) nR_119480, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:183:99-102\n   #4  ftRelational.fut:174:3-183:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172001 = (int64_t) 8 * m_154874;
    
    if (mem_172002_cached_sizze_172851 < bytes_172001) {
        err = lexical_realloc(ctx, &mem_172002, &mem_172002_cached_sizze_172851, bytes_172001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171926, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154874});
    
    int64_t max_mult_154898;
    
    if (cond_154897) {
        if (mem_172004_cached_sizze_172852 < bytes_171821) {
            err = lexical_realloc(ctx, &mem_172004, &mem_172004_cached_sizze_172852, bytes_171821);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171604 = 0; i_171604 < nR_119480; i_171604++) {
            int64_t eta_p_163199 = ((int64_t *) mem_171924)[i_171604];
            int64_t eta_p_163200 = ((int64_t *) mem_171914)[i_171604];
            bool cond_163201 = eta_p_163199 == (int64_t) 1;
            int64_t lifted_lambda_res_163202;
            
            if (cond_163201) {
                int64_t lifted_lambda_res_t_res_163203 = sub64(eta_p_163200, (int64_t) 1);
                
                lifted_lambda_res_163202 = lifted_lambda_res_t_res_163203;
            } else {
                lifted_lambda_res_163202 = (int64_t) -1;
            }
            ((int64_t *) mem_172004)[i_171604] = lifted_lambda_res_163202;
        }
        for (int64_t write_iter_171606 = 0; write_iter_171606 < nR_119480; write_iter_171606++) {
            int64_t write_iv_171608 = ((int64_t *) mem_172004)[write_iter_171606];
            int64_t write_iv_171609 = ((int64_t *) mem_171926)[write_iter_171606];
            
            if (sle64((int64_t) 0, write_iv_171608) && slt64(write_iv_171608, m_154874)) {
                ((int64_t *) mem_172002)[write_iv_171608] = write_iv_171609;
            }
        }
        
        int64_t defunc_0_reduce_res_163213;
        int64_t redout_171611 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171612 = 0; i_171612 < m_154874; i_171612++) {
            int64_t x_163214 = ((int64_t *) mem_172002)[i_171612];
            int64_t max_res_163217 = smax64(x_163214, redout_171611);
            int64_t redout_tmp_172548 = max_res_163217;
            
            redout_171611 = redout_tmp_172548;
        }
        defunc_0_reduce_res_163213 = redout_171611;
        max_mult_154898 = defunc_0_reduce_res_163213;
    } else {
        max_mult_154898 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154904 = slt64(max_mult_154898, (int64_t) 1);
    bool valid_154906 = !bounds_invalid_upwards_154904;
    bool range_valid_c_154907;
    
    if (!valid_154906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154898, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:183:99-102\n   #3  ftRelational.fut:174:3-183:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171970_cached_sizze_172850 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171970, &mem_171970_cached_sizze_172850, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171589 = 0; i_171589 < nR_119480; i_171589++) {
        int64_t eta_p_162530 = ((int64_t *) mem_171926)[i_171589];
        int64_t zv_lhs_162532 = add64((int64_t) -1, i_171589);
        int64_t tmp_162533 = smod64(zv_lhs_162532, nR_119480);
        int64_t lifted_lambda_res_162534 = ((int64_t *) mem_171916)[tmp_162533];
        bool cond_162536 = i_171589 == (int64_t) 0;
        int64_t lifted_lambda_res_162537;
        
        if (cond_162536) {
            lifted_lambda_res_162537 = (int64_t) 0;
        } else {
            lifted_lambda_res_162537 = lifted_lambda_res_162534;
        }
        
        bool cond_162539 = slt64((int64_t) 0, eta_p_162530);
        int64_t lifted_lambda_res_162540;
        
        if (cond_162539) {
            lifted_lambda_res_162540 = lifted_lambda_res_162537;
        } else {
            lifted_lambda_res_162540 = (int64_t) -1;
        }
        ((int64_t *) mem_171970)[i_171589] = lifted_lambda_res_162540;
    }
    if (memblock_alloc(ctx, &mem_171978, bytes_171977, "mem_171978")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172550 = 0; nest_i_172550 < defunc_res_163230; nest_i_172550++) {
        ((int32_t *) mem_171978.mem)[nest_i_172550] = 0;
    }
    if (memblock_alloc(ctx, &mem_171980, bytes_171979, "mem_171980")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172551 = 0; nest_i_172551 < defunc_res_163230; nest_i_172551++) {
        ((int64_t *) mem_171980.mem)[nest_i_172551] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171982, bytes_171979, "mem_171982")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_163230; nest_i_172552++) {
        ((int64_t *) mem_171982.mem)[nest_i_172552] = (int64_t) -1;
    }
    for (int64_t write_iter_171591 = 0; write_iter_171591 < nR_119480; write_iter_171591++) {
        int64_t write_iv_171595 = ((int64_t *) mem_171970)[write_iter_171591];
        int32_t write_iv_171596 = ((int32_t *) mem_171918)[write_iter_171591];
        int64_t write_iv_171597 = ((int64_t *) mem_171920)[write_iter_171591];
        int64_t write_iv_171598 = ((int64_t *) mem_171922)[write_iter_171591];
        
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int32_t *) mem_171978.mem)[write_iv_171595] = write_iv_171596;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171980.mem)[write_iv_171595] = write_iv_171597;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171982.mem)[write_iv_171595] = write_iv_171598;
        }
    }
    
    int64_t distance_154905 = sub64(max_mult_154898, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_172019, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172022, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172025, &mem_171982, "mem_171982") != 0)
        return 1;
    for (int64_t i_154911 = 0; i_154911 < distance_154905; i_154911++) {
        int64_t index_primexp_154915 = add64((int64_t) 1, i_154911);
        
        if (memblock_alloc(ctx, &mem_172027, bytes_171979, "mem_172027")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172029, bytes_171979, "mem_172029")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172029.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172022.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172031, bytes_171977, "mem_172031")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_172031.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_172019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        for (int64_t write_iter_171613 = 0; write_iter_171613 < nR_119480; write_iter_171613++) {
            int64_t write_iv_171618 = ((int64_t *) mem_171922)[write_iter_171613];
            int32_t write_iv_171619 = ((int32_t *) mem_171918)[write_iter_171613];
            int64_t write_iv_171620 = ((int64_t *) mem_171920)[write_iter_171613];
            int64_t zg_lhs_163127 = ((int64_t *) mem_171926)[write_iter_171613];
            bool cond_163128 = slt64(index_primexp_154915, zg_lhs_163127);
            int64_t lifted_lambda_res_163129;
            
            if (cond_163128) {
                int64_t zp_lhs_163223 = ((int64_t *) mem_171970)[write_iter_171613];
                int64_t lifted_lambda_res_t_res_163224 = add64(index_primexp_154915, zp_lhs_163223);
                
                lifted_lambda_res_163129 = lifted_lambda_res_t_res_163224;
            } else {
                lifted_lambda_res_163129 = (int64_t) -1;
            }
            
            int64_t tmp_163133 = add64(index_primexp_154915, write_iv_171618);
            
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int32_t *) mem_172031.mem)[lifted_lambda_res_163129] = write_iv_171619;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172029.mem)[lifted_lambda_res_163129] = write_iv_171620;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172027.mem)[lifted_lambda_res_163129] = tmp_163133;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172556, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172557, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172558, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172019, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172022, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172025, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_172058, &mem_param_172019, "mem_param_172019") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172057, &mem_param_172022, "mem_param_172022") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172056, &mem_param_172025, "mem_param_172025") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172060, bytes_171977, "mem_172060")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_172060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172062, bytes_171979, "mem_172062")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172062.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172064, bytes_171979, "mem_172064")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172062, "mem_172062") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172064, "mem_172064") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &mem_172060, "mem_172060") != 0)
        return 1;
    prim_out_172503 = defunc_res_163230;
    if (memblock_set(ctx, &*mem_out_p_172839, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172840, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172841, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172842 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171914);
        free(mem_171916);
        free(mem_171918);
        free(mem_171920);
        free(mem_171922);
        free(mem_171924);
        free(mem_171926);
        free(mem_171970);
        free(mem_172002);
        free(mem_172004);
        if (memblock_unref(ctx, &mem_172064, "mem_172064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172062, "mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172060, "mem_172060") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172025, "mem_param_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172022, "mem_param_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172019, "mem_param_172019") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171904, "mem_171904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171872, "mem_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171870, "mem_171870") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171859, "mem_171859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171857, "mem_param_171857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171843, "mem_param_171843") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171887, "ext_mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171890, "ext_mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171896, "ext_mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_long(struct futhark_context *ctx, struct memblock *mem_out_p_172853, struct memblock *mem_out_p_172854, struct memblock *mem_out_p_172855, int64_t *out_prim_out_172856, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_122131, int64_t nS_122132, int64_t offset_R_122135, int64_t offset_S_122136, int64_t partitionSizze_122137, int64_t scatter_psizze_122138)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171914_cached_sizze_172857 = 0;
    unsigned char *mem_171914 = NULL;
    int64_t mem_171916_cached_sizze_172858 = 0;
    unsigned char *mem_171916 = NULL;
    int64_t mem_171918_cached_sizze_172859 = 0;
    unsigned char *mem_171918 = NULL;
    int64_t mem_171920_cached_sizze_172860 = 0;
    unsigned char *mem_171920 = NULL;
    int64_t mem_171922_cached_sizze_172861 = 0;
    unsigned char *mem_171922 = NULL;
    int64_t mem_171924_cached_sizze_172862 = 0;
    unsigned char *mem_171924 = NULL;
    int64_t mem_171926_cached_sizze_172863 = 0;
    unsigned char *mem_171926 = NULL;
    int64_t mem_171970_cached_sizze_172864 = 0;
    unsigned char *mem_171970 = NULL;
    int64_t mem_172002_cached_sizze_172865 = 0;
    unsigned char *mem_172002 = NULL;
    int64_t mem_172004_cached_sizze_172866 = 0;
    unsigned char *mem_172004 = NULL;
    struct memblock mem_172064;
    
    mem_172064.references = NULL;
    
    struct memblock mem_172062;
    
    mem_172062.references = NULL;
    
    struct memblock mem_172060;
    
    mem_172060.references = NULL;
    
    struct memblock mem_param_tmp_172558;
    
    mem_param_tmp_172558.references = NULL;
    
    struct memblock mem_param_tmp_172557;
    
    mem_param_tmp_172557.references = NULL;
    
    struct memblock mem_param_tmp_172556;
    
    mem_param_tmp_172556.references = NULL;
    
    struct memblock mem_172031;
    
    mem_172031.references = NULL;
    
    struct memblock mem_172029;
    
    mem_172029.references = NULL;
    
    struct memblock mem_172027;
    
    mem_172027.references = NULL;
    
    struct memblock mem_param_172025;
    
    mem_param_172025.references = NULL;
    
    struct memblock mem_param_172022;
    
    mem_param_172022.references = NULL;
    
    struct memblock mem_param_172019;
    
    mem_param_172019.references = NULL;
    
    struct memblock ext_mem_172056;
    
    ext_mem_172056.references = NULL;
    
    struct memblock ext_mem_172057;
    
    ext_mem_172057.references = NULL;
    
    struct memblock ext_mem_172058;
    
    ext_mem_172058.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171980;
    
    mem_171980.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_171906;
    
    mem_171906.references = NULL;
    
    struct memblock mem_171904;
    
    mem_171904.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_171872;
    
    mem_171872.references = NULL;
    
    struct memblock mem_171870;
    
    mem_171870.references = NULL;
    
    struct memblock mem_param_tmp_172530;
    
    mem_param_tmp_172530.references = NULL;
    
    struct memblock mem_171859;
    
    mem_171859.references = NULL;
    
    struct memblock mem_param_171857;
    
    mem_param_171857.references = NULL;
    
    struct memblock ext_mem_171868;
    
    ext_mem_171868.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_param_171843;
    
    mem_param_171843.references = NULL;
    
    struct memblock ext_mem_171854;
    
    ext_mem_171854.references = NULL;
    
    struct memblock ext_mem_171887;
    
    ext_mem_171887.references = NULL;
    
    struct memblock ext_mem_171890;
    
    ext_mem_171890.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock ext_mem_171896;
    
    ext_mem_171896.references = NULL;
    
    struct memblock mem_param_171840;
    
    mem_param_171840.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171901;
    
    ext_mem_171901.references = NULL;
    
    struct memblock ext_mem_171902;
    
    ext_mem_171902.references = NULL;
    
    struct memblock mem_171834;
    
    mem_171834.references = NULL;
    
    struct memblock mem_171832;
    
    mem_171832.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock ext_mem_171912;
    
    ext_mem_171912.references = NULL;
    
    struct memblock mem_171824;
    
    mem_171824.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t partitionSizze_154510 = sdiv64(partitionSizze_122137, (int64_t) 8);
    int64_t zm_lhs_154511 = add64(nR_122131, partitionSizze_154510);
    int64_t zs_lhs_154512 = sub64(zm_lhs_154511, (int64_t) 1);
    bool zzero_154513 = partitionSizze_154510 == (int64_t) 0;
    bool nonzzero_154514 = !zzero_154513;
    bool nonzzero_cert_154515;
    
    if (!nonzzero_154514) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_154516 = sdiv64(zs_lhs_154512, partitionSizze_154510);
    int64_t zm_lhs_154517 = add64(nS_122132, partitionSizze_154510);
    int64_t zs_lhs_154518 = sub64(zm_lhs_154517, (int64_t) 1);
    int64_t numIter_S_154519 = sdiv64(zs_lhs_154518, partitionSizze_154510);
    
    if (futrts_indicesWithIncrement_16341(ctx, &ext_mem_171820, tR_mem_171818, nR_122131, offset_R_122135) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * nR_122131;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < nR_122131; nest_i_172504++) {
        ((int64_t *) mem_171822.mem)[nest_i_172504] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171824, bytes_171821, "mem_171824")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < nR_122131; nest_i_172505++) {
        ((int64_t *) mem_171824.mem)[nest_i_172505] = (int64_t) 0;
    }
    
    bool loop_cond_154523 = slt64((int64_t) 0, numIter_R_154516);
    bool defunc_0_mergeJoin_res_154524;
    int64_t defunc_0_mergeJoin_res_154525;
    int64_t defunc_0_mergeJoin_res_154528;
    bool loop_while_154529;
    int64_t iter_154530;
    int64_t first_relevant_in_S_154533;
    
    if (memblock_set(ctx, &mem_param_171827, &mem_171824, "mem_171824") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_while_154529 = loop_cond_154523;
    iter_154530 = (int64_t) 0;
    first_relevant_in_S_154533 = (int64_t) 0;
    while (loop_while_154529) {
        int64_t tR_start_154534 = mul64(partitionSizze_154510, iter_154530);
        int64_t min_arg1_154535 = add64(partitionSizze_154510, tR_start_154534);
        int64_t min_res_154536 = smin64(nR_122131, min_arg1_154535);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 = sub64(min_res_154536, tR_start_154534);
        bool empty_slice_154538 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 == (int64_t) 0;
        int64_t m_154539 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, (int64_t) 1);
        int64_t i_p_m_t_s_154540 = add64(tR_start_154534, m_154539);
        bool zzero_leq_i_p_m_t_s_154541 = sle64((int64_t) 0, i_p_m_t_s_154540);
        bool i_p_m_t_s_leq_w_154542 = slt64(i_p_m_t_s_154540, nR_122131);
        bool zzero_lte_i_154543 = sle64((int64_t) 0, tR_start_154534);
        bool i_lte_j_154544 = sle64(tR_start_154534, min_res_154536);
        bool y_154545 = i_p_m_t_s_leq_w_154542 && zzero_lte_i_154543;
        bool y_154546 = zzero_leq_i_p_m_t_s_154541 && y_154545;
        bool forwards_ok_154547 = i_lte_j_154544 && y_154546;
        bool ok_or_empty_154548 = empty_slice_154538 || forwards_ok_154547;
        bool index_certs_154549;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171831 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537;
        bool cond_154553 = slt64(first_relevant_in_S_154533, numIter_S_154519);
        bool y_154554 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool loop_not_taken_154555 = !cond_154553;
        bool protect_assert_disj_154556 = y_154554 || loop_not_taken_154555;
        bool index_certs_154557;
        
        if (!protect_assert_disj_154556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154560 = sle64((int64_t) 0, m_154539);
        bool y_154561 = slt64(m_154539, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool bounds_check_154562 = x_154560 && y_154561;
        bool protect_assert_disj_154563 = loop_not_taken_154555 || bounds_check_154562;
        bool index_certs_154564;
        
        if (!protect_assert_disj_154563) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154795;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:194:99-102\n   #4  ftRelational.fut:185:3-194:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171832, bytes_171831, "mem_171832")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172513 = 0; nest_i_172513 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172513++) {
            ((int64_t *) mem_171832.mem)[nest_i_172513] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171834, bytes_171831, "mem_171834")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172514 = 0; nest_i_172514 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172514++) {
            ((int64_t *) mem_171834.mem)[nest_i_172514] = (int64_t) 0;
        }
        
        int64_t gt_lhs_154558;
        
        if (cond_154553) {
            int64_t x_163142 = ((int64_t *) tR_mem_171818.mem)[tR_start_154534];
            
            gt_lhs_154558 = x_163142;
        } else {
            gt_lhs_154558 = (int64_t) 0;
        }
        
        int64_t lt_lhs_154565;
        
        if (cond_154553) {
            int64_t x_163143 = ((int64_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
            
            lt_lhs_154565 = x_163143;
        } else {
            lt_lhs_154565 = (int64_t) 0;
        }
        
        int64_t ext_171900;
        int64_t ext_171899;
        int64_t ext_171898;
        int64_t ext_171897;
        bool loopres_154567;
        int64_t loopres_154568;
        int64_t loopres_154571;
        bool loop_while_154572;
        int64_t s_iter_154573;
        int64_t minRelevant_154576;
        int64_t ctx_param_ext_171835;
        int64_t ctx_param_ext_171836;
        int64_t ctx_param_ext_171838;
        int64_t ctx_param_ext_171839;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171840, &mem_171832, "mem_171832") != 0)
            return 1;
        ctx_param_ext_171835 = (int64_t) 0;
        ctx_param_ext_171836 = (int64_t) 1;
        ctx_param_ext_171838 = (int64_t) 0;
        ctx_param_ext_171839 = (int64_t) 1;
        loop_while_154572 = cond_154553;
        s_iter_154573 = first_relevant_in_S_154533;
        minRelevant_154576 = first_relevant_in_S_154533;
        while (loop_while_154572) {
            int64_t tS_start_154577 = mul64(partitionSizze_154510, s_iter_154573);
            int64_t min_arg1_154578 = add64(partitionSizze_154510, tS_start_154577);
            int64_t min_res_154579 = smin64(nS_122132, min_arg1_154578);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 = sub64(min_res_154579, tS_start_154577);
            bool empty_slice_154581 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 == (int64_t) 0;
            int64_t m_154582 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, (int64_t) 1);
            int64_t i_p_m_t_s_154583 = add64(tS_start_154577, m_154582);
            bool zzero_leq_i_p_m_t_s_154584 = sle64((int64_t) 0, i_p_m_t_s_154583);
            bool i_p_m_t_s_leq_w_154585 = slt64(i_p_m_t_s_154583, nS_122132);
            bool zzero_lte_i_154586 = sle64((int64_t) 0, tS_start_154577);
            bool i_lte_j_154587 = sle64(tS_start_154577, min_res_154579);
            bool y_154588 = i_p_m_t_s_leq_w_154585 && zzero_lte_i_154586;
            bool y_154589 = zzero_leq_i_p_m_t_s_154584 && y_154588;
            bool forwards_ok_154590 = i_lte_j_154587 && y_154589;
            bool ok_or_empty_154591 = empty_slice_154581 || forwards_ok_154590;
            bool index_certs_154592;
            
            if (!ok_or_empty_154591) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154577, ":", (long long) min_res_154579, "] out of bounds for array of shape [", (long long) nS_122132, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154593 = sle64((int64_t) 0, m_154582);
            bool y_154594 = slt64(m_154582, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool bounds_check_154595 = x_154593 && y_154594;
            bool index_certs_154596;
            
            if (!bounds_check_154595) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154599 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool index_certs_154600;
            
            if (!y_154599) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t gt_rhs_154597 = ((int64_t *) tS_mem_171819.mem)[i_p_m_t_s_154583];
            bool defunc_0_gt_res_154598 = slt64(gt_rhs_154597, gt_lhs_154558);
            int64_t lt_rhs_154601 = ((int64_t *) tS_mem_171819.mem)[tS_start_154577];
            bool defunc_0_lt_res_154602 = slt64(lt_lhs_154565, lt_rhs_154601);
            bool thisStillRel_154603 = !defunc_0_lt_res_154602;
            int64_t ext_171889;
            
            if (defunc_0_lt_res_154602) {
                ext_171889 = ctx_param_ext_171835;
            } else {
                ext_171889 = (int64_t) 0;
            }
            
            int64_t ext_171888;
            
            if (defunc_0_lt_res_154602) {
                ext_171888 = ctx_param_ext_171836;
            } else {
                ext_171888 = (int64_t) 1;
            }
            
            int64_t ext_171886;
            
            if (defunc_0_lt_res_154602) {
                ext_171886 = ctx_param_ext_171838;
            } else {
                ext_171886 = (int64_t) 0;
            }
            
            int64_t ext_171885;
            
            if (defunc_0_lt_res_154602) {
                ext_171885 = ctx_param_ext_171839;
            } else {
                ext_171885 = (int64_t) 1;
            }
            
            int64_t ext_171895;
            
            if (defunc_0_gt_res_154598) {
                ext_171895 = ctx_param_ext_171835;
            } else {
                ext_171895 = ext_171889;
            }
            
            int64_t ext_171894;
            
            if (defunc_0_gt_res_154598) {
                ext_171894 = ctx_param_ext_171836;
            } else {
                ext_171894 = ext_171888;
            }
            
            int64_t ext_171892;
            
            if (defunc_0_gt_res_154598) {
                ext_171892 = ctx_param_ext_171838;
            } else {
                ext_171892 = ext_171886;
            }
            
            int64_t ext_171891;
            
            if (defunc_0_gt_res_154598) {
                ext_171891 = ctx_param_ext_171839;
            } else {
                ext_171891 = ext_171885;
            }
            
            int64_t loopres_154604;
            bool loopres_154607;
            int64_t loopres_154608;
            
            if (defunc_0_gt_res_154598) {
                int64_t tmp_163144 = add64((int64_t) 1, s_iter_154573);
                
                if (memblock_set(ctx, &ext_mem_171896, &mem_param_171837, "mem_param_171837") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &mem_param_171840, "mem_param_171840") != 0)
                    return 1;
                loopres_154604 = tmp_163144;
                loopres_154607 = 1;
                loopres_154608 = tmp_163144;
            } else {
                int64_t loopres_f_res_154610;
                bool loopres_f_res_154613;
                
                if (defunc_0_lt_res_154602) {
                    if (memblock_set(ctx, &ext_mem_171890, &mem_param_171837, "mem_param_171837") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_param_171840, "mem_param_171840") != 0)
                        return 1;
                    loopres_f_res_154610 = s_iter_154573;
                    loopres_f_res_154613 = thisStillRel_154603;
                } else {
                    bool index_certs_154614;
                    
                    if (!bounds_check_154562) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lt_lhs_154615 = ((int64_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
                    bool defunc_0_lt_res_154616 = slt64(lt_lhs_154615, gt_rhs_154597);
                    bool nextRel_154617 = !defunc_0_lt_res_154616;
                    int64_t find_joinTuples_arg3_154618 = add64(offset_S_122136, tS_start_154577);
                    double i64_res_154619 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                    double log2_res_154620 = futrts_log2_64(i64_res_154619);
                    double ceil_res_154621 = futrts_ceil64(log2_res_154620);
                    int64_t f64_res_154622 = fptosi_f64_i64(ceil_res_154621);
                    int64_t num_iter_154623 = add64((int64_t) 1, f64_res_154622);
                    int64_t bsearch_first_154625;
                    int64_t last_step_154628;
                    
                    if (memblock_set(ctx, &mem_param_171843, &mem_171834, "mem_171834") != 0)
                        return 1;
                    last_step_154628 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154626 = 0; i_154626 < num_iter_154623; i_154626++) {
                        int64_t zs_lhs_154629 = add64((int64_t) 1, last_step_154628);
                        int64_t this_step_154630 = sdiv64(zs_lhs_154629, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171845, bytes_171831, "mem_171845")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171547++) {
                            int64_t eta_p_162698 = ((int64_t *) mem_param_171843.mem)[i_171547];
                            int64_t slice_171796 = tR_start_154534 + i_171547;
                            int64_t eta_p_162699 = ((int64_t *) tR_mem_171818.mem)[slice_171796];
                            bool cond_162701 = sle64(eta_p_162698, (int64_t) 0);
                            int64_t prev_elem_162702;
                            
                            if (cond_162701) {
                                bool index_certs_163146;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162702 = lt_rhs_154601;
                            } else {
                                int64_t tmp_162706 = sub64(eta_p_162698, (int64_t) 1);
                                bool x_162707 = sle64((int64_t) 0, tmp_162706);
                                bool y_162708 = slt64(tmp_162706, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162709 = x_162707 && y_162708;
                                bool index_certs_162710;
                                
                                if (!bounds_check_162709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162706, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162711 = tS_start_154577 + tmp_162706;
                                int64_t prev_elem_f_res_162712 = ((int64_t *) tS_mem_171819.mem)[slice_162711];
                                
                                prev_elem_162702 = prev_elem_f_res_162712;
                            }
                            
                            bool cond_162713 = slt64(eta_p_162698, (int64_t) 0);
                            int64_t cur_elem_162714;
                            
                            if (cond_162713) {
                                bool index_certs_163149;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162714 = lt_rhs_154601;
                            } else {
                                bool x_162718 = sle64((int64_t) 0, eta_p_162698);
                                bool y_162719 = slt64(eta_p_162698, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162720 = x_162718 && y_162719;
                                bool index_certs_162721;
                                
                                if (!bounds_check_162720) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162698, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162722 = tS_start_154577 + eta_p_162698;
                                int64_t cur_elem_f_res_162723 = ((int64_t *) tS_mem_171819.mem)[slice_162722];
                                
                                cur_elem_162714 = cur_elem_f_res_162723;
                            }
                            
                            bool cond_162724 = sle64(m_154582, eta_p_162698);
                            int64_t next_elem_162725;
                            
                            if (cond_162724) {
                                bool index_certs_163155;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162725 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162733 = add64((int64_t) 1, eta_p_162698);
                                bool x_162734 = sle64((int64_t) 0, tmp_162733);
                                bool y_162735 = slt64(tmp_162733, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162736 = x_162734 && y_162735;
                                bool index_certs_162737;
                                
                                if (!bounds_check_162736) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162733, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162738 = tS_start_154577 + tmp_162733;
                                int64_t next_elem_f_res_162739 = ((int64_t *) tS_mem_171819.mem)[slice_162738];
                                
                                next_elem_162725 = next_elem_f_res_162739;
                            }
                            
                            int64_t defunc_0_f_res_162744;
                            
                            if (cond_162713) {
                                defunc_0_f_res_162744 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162745 = eta_p_162699 == cur_elem_162714;
                                bool cond_162746 = eta_p_162698 == (int64_t) 0;
                                bool defunc_0_gt_res_162747 = slt64(prev_elem_162702, eta_p_162699);
                                bool x_162748 = !cond_162746;
                                bool y_162749 = defunc_0_gt_res_162747 && x_162748;
                                bool cond_t_res_162750 = cond_162746 || y_162749;
                                bool x_162751 = defunc_0_eq_res_162745 && cond_t_res_162750;
                                int64_t defunc_0_f_res_f_res_162752;
                                
                                if (x_162751) {
                                    defunc_0_f_res_f_res_162752 = eta_p_162698;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162753;
                                    
                                    if (defunc_0_eq_res_162745) {
                                        int64_t max_arg1_163158 = sub64(eta_p_162698, this_step_154630);
                                        int64_t max_res_163159 = smax64((int64_t) 0, max_arg1_163158);
                                        
                                        defunc_0_f_res_f_res_f_res_162753 = max_res_163159;
                                    } else {
                                        bool defunc_0_gt_res_162756 = slt64(cur_elem_162714, eta_p_162699);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162757;
                                        
                                        if (defunc_0_gt_res_162756) {
                                            bool cond_163161 = eta_p_162698 == m_154582;
                                            bool defunc_0_lt_res_163162 = slt64(eta_p_162699, next_elem_162725);
                                            bool x_163163 = !cond_163161;
                                            bool y_163164 = defunc_0_lt_res_163162 && x_163163;
                                            bool cond_163165 = cond_163161 || y_163164;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                            
                                            if (cond_163165) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_163167 = add64(this_step_154630, eta_p_162698);
                                                int64_t min_res_163168 = smin64(m_154582, min_arg1_163167);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = min_res_163168;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                            
                                            if (cond_t_res_162750) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162768 = sub64(eta_p_162698, this_step_154630);
                                                int64_t max_res_162769 = smax64((int64_t) 0, max_arg1_162768);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = max_res_162769;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                        }
                                        defunc_0_f_res_f_res_f_res_162753 = defunc_0_f_res_f_res_f_res_f_res_162757;
                                    }
                                    defunc_0_f_res_f_res_162752 = defunc_0_f_res_f_res_f_res_162753;
                                }
                                defunc_0_f_res_162744 = defunc_0_f_res_f_res_162752;
                            }
                            ((int64_t *) mem_171845.mem)[i_171547] = defunc_0_f_res_162744;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171845, "mem_171845") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172528 = this_step_154630;
                        
                        if (memblock_set(ctx, &mem_param_171843, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                            return 1;
                        last_step_154628 = last_step_tmp_172528;
                    }
                    if (memblock_set(ctx, &ext_mem_171854, &mem_param_171843, "mem_param_171843") != 0)
                        return 1;
                    bsearch_first_154625 = last_step_154628;
                    
                    int64_t bsearch_last_154708;
                    int64_t last_step_154711;
                    
                    if (memblock_set(ctx, &mem_param_171857, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    last_step_154711 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154709 = 0; i_154709 < num_iter_154623; i_154709++) {
                        int64_t zs_lhs_154712 = add64((int64_t) 1, last_step_154711);
                        int64_t max_arg1_154713 = sdiv64(zs_lhs_154712, (int64_t) 2);
                        int64_t max_res_154714 = smax64((int64_t) 1, max_arg1_154713);
                        
                        if (memblock_alloc(ctx, &mem_171859, bytes_171831, "mem_171859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171551 = 0; i_171551 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171551++) {
                            int64_t eta_p_162821 = ((int64_t *) mem_param_171857.mem)[i_171551];
                            int64_t slice_171795 = tR_start_154534 + i_171551;
                            int64_t eta_p_162822 = ((int64_t *) tR_mem_171818.mem)[slice_171795];
                            bool cond_162824 = slt64(eta_p_162821, (int64_t) 0);
                            int64_t cur_elem_162825;
                            
                            if (cond_162824) {
                                bool index_certs_163171;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162825 = lt_rhs_154601;
                            } else {
                                bool x_162829 = sle64((int64_t) 0, eta_p_162821);
                                bool y_162830 = slt64(eta_p_162821, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162831 = x_162829 && y_162830;
                                bool index_certs_162832;
                                
                                if (!bounds_check_162831) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162821, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162833 = tS_start_154577 + eta_p_162821;
                                int64_t cur_elem_f_res_162834 = ((int64_t *) tS_mem_171819.mem)[slice_162833];
                                
                                cur_elem_162825 = cur_elem_f_res_162834;
                            }
                            
                            bool cond_162835 = sle64(m_154582, eta_p_162821);
                            int64_t next_elem_162836;
                            
                            if (cond_162835) {
                                bool index_certs_163177;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162836 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162844 = add64((int64_t) 1, eta_p_162821);
                                bool x_162845 = sle64((int64_t) 0, tmp_162844);
                                bool y_162846 = slt64(tmp_162844, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162847 = x_162845 && y_162846;
                                bool index_certs_162848;
                                
                                if (!bounds_check_162847) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162844, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162849 = tS_start_154577 + tmp_162844;
                                int64_t next_elem_f_res_162850 = ((int64_t *) tS_mem_171819.mem)[slice_162849];
                                
                                next_elem_162836 = next_elem_f_res_162850;
                            }
                            
                            int64_t defunc_0_f_res_162854;
                            
                            if (cond_162824) {
                                defunc_0_f_res_162854 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162855 = eta_p_162822 == cur_elem_162825;
                                bool cond_162857 = eta_p_162821 == m_154582;
                                bool defunc_0_gt_res_162858 = slt64(eta_p_162822, next_elem_162836);
                                bool x_162859 = !cond_162857;
                                bool y_162860 = defunc_0_gt_res_162858 && x_162859;
                                bool cond_t_res_162861 = cond_162857 || y_162860;
                                bool x_162862 = defunc_0_eq_res_162855 && cond_t_res_162861;
                                int64_t defunc_0_f_res_f_res_162863;
                                
                                if (x_162862) {
                                    defunc_0_f_res_f_res_162863 = eta_p_162821;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162864;
                                    
                                    if (defunc_0_eq_res_162855) {
                                        int64_t min_arg1_163180 = add64(max_res_154714, eta_p_162821);
                                        int64_t min_res_163181 = smin64(m_154582, min_arg1_163180);
                                        
                                        defunc_0_f_res_f_res_f_res_162864 = min_res_163181;
                                    } else {
                                        bool defunc_0_gt_res_162867 = slt64(cur_elem_162825, eta_p_162822);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162868;
                                        
                                        if (defunc_0_gt_res_162867) {
                                            int64_t min_arg1_163182 = add64(max_res_154714, eta_p_162821);
                                            int64_t min_res_163183 = smin64(m_154582, min_arg1_163182);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = min_res_163183;
                                        } else {
                                            int64_t max_arg1_162871 = sub64(eta_p_162821, max_res_154714);
                                            int64_t max_res_162872 = smax64((int64_t) 0, max_arg1_162871);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = max_res_162872;
                                        }
                                        defunc_0_f_res_f_res_f_res_162864 = defunc_0_f_res_f_res_f_res_f_res_162868;
                                    }
                                    defunc_0_f_res_f_res_162863 = defunc_0_f_res_f_res_f_res_162864;
                                }
                                defunc_0_f_res_162854 = defunc_0_f_res_f_res_162863;
                            }
                            ((int64_t *) mem_171859.mem)[i_171551] = defunc_0_f_res_162854;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172530, &mem_171859, "mem_171859") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172532 = max_res_154714;
                        
                        if (memblock_set(ctx, &mem_param_171857, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
                            return 1;
                        last_step_154711 = last_step_tmp_172532;
                    }
                    if (memblock_set(ctx, &ext_mem_171868, &mem_param_171857, "mem_param_171857") != 0)
                        return 1;
                    bsearch_last_154708 = last_step_154711;
                    if (memblock_alloc(ctx, &mem_171870, bytes_171831, "mem_171870")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171872, bytes_171831, "mem_171872")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171557 = 0; i_171557 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171557++) {
                        int64_t eta_p_162677 = ((int64_t *) ext_mem_171854.mem)[i_171557];
                        int64_t eta_p_162678 = ((int64_t *) mem_param_171840.mem)[ctx_param_ext_171838 + i_171557 * ctx_param_ext_171839];
                        int64_t eta_p_162679 = ((int64_t *) ext_mem_171868.mem)[i_171557];
                        int64_t eta_p_162680 = ((int64_t *) mem_param_171837.mem)[ctx_param_ext_171835 + i_171557 * ctx_param_ext_171836];
                        bool cond_162682 = slt64(eta_p_162677, (int64_t) 0);
                        int64_t lifted_lambda_res_162683;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162683 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162684 = sub64(eta_p_162679, eta_p_162677);
                            int64_t lifted_lambda_res_f_res_162685 = add64((int64_t) 1, zp_lhs_162684);
                            
                            lifted_lambda_res_162683 = lifted_lambda_res_f_res_162685;
                        }
                        
                        int64_t defunc_0_f_res_162687 = add64(eta_p_162680, lifted_lambda_res_162683);
                        int64_t lifted_lambda_res_162690;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162690 = eta_p_162677;
                        } else {
                            int64_t lifted_lambda_res_f_res_162691 = add64(find_joinTuples_arg3_154618, eta_p_162677);
                            
                            lifted_lambda_res_162690 = lifted_lambda_res_f_res_162691;
                        }
                        
                        bool cond_162693 = slt64(eta_p_162678, (int64_t) 0);
                        int64_t lifted_lambda_res_162694;
                        
                        if (cond_162693) {
                            lifted_lambda_res_162694 = lifted_lambda_res_162690;
                        } else {
                            lifted_lambda_res_162694 = eta_p_162678;
                        }
                        ((int64_t *) mem_171870.mem)[i_171557] = lifted_lambda_res_162694;
                        ((int64_t *) mem_171872.mem)[i_171557] = defunc_0_f_res_162687;
                    }
                    if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
                        return 1;
                    
                    int64_t tmp_154791 = add64((int64_t) 1, s_iter_154573);
                    
                    if (memblock_set(ctx, &ext_mem_171890, &mem_171872, "mem_171872") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_171870, "mem_171870") != 0)
                        return 1;
                    loopres_f_res_154610 = tmp_154791;
                    loopres_f_res_154613 = nextRel_154617;
                }
                if (memblock_set(ctx, &ext_mem_171896, &ext_mem_171890, "ext_mem_171890") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &ext_mem_171887, "ext_mem_171887") != 0)
                    return 1;
                loopres_154604 = loopres_f_res_154610;
                loopres_154607 = loopres_f_res_154613;
                loopres_154608 = minRelevant_154576;
            }
            
            bool cond_154792 = slt64(loopres_154604, numIter_S_154519);
            bool x_154793 = loopres_154607 && cond_154792;
            
            if (memblock_set(ctx, &mem_param_tmp_172515, &ext_mem_171896, "ext_mem_171896") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_172517 = ext_171895;
            int64_t ctx_param_ext_tmp_172518 = ext_171894;
            int64_t ctx_param_ext_tmp_172519 = ext_171892;
            int64_t ctx_param_ext_tmp_172520 = ext_171891;
            bool loop_while_tmp_172521 = x_154793;
            int64_t s_iter_tmp_172522 = loopres_154604;
            int64_t minRelevant_tmp_172525 = loopres_154608;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171840, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            ctx_param_ext_171835 = ctx_param_ext_tmp_172517;
            ctx_param_ext_171836 = ctx_param_ext_tmp_172518;
            ctx_param_ext_171838 = ctx_param_ext_tmp_172519;
            ctx_param_ext_171839 = ctx_param_ext_tmp_172520;
            loop_while_154572 = loop_while_tmp_172521;
            s_iter_154573 = s_iter_tmp_172522;
            minRelevant_154576 = minRelevant_tmp_172525;
        }
        if (memblock_set(ctx, &ext_mem_171902, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171901, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        ext_171900 = ctx_param_ext_171835;
        ext_171899 = ctx_param_ext_171836;
        ext_171898 = ctx_param_ext_171838;
        ext_171897 = ctx_param_ext_171839;
        loopres_154567 = loop_while_154572;
        loopres_154568 = s_iter_154573;
        loopres_154571 = minRelevant_154576;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171904, bytes_171821, "mem_171904")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_122131});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171901.mem, ext_171898, (int64_t []) {ext_171897}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171906, bytes_171821, "mem_171906")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_122131});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171902.mem, ext_171900, (int64_t []) {ext_171899}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        
        int64_t tmp_154799 = add64((int64_t) 1, iter_154530);
        bool loop_cond_154800 = slt64(tmp_154799, numIter_R_154516);
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171904, "mem_171904") != 0)
            return 1;
        
        bool loop_while_tmp_172508 = loop_cond_154800;
        int64_t iter_tmp_172509 = tmp_154799;
        int64_t first_relevant_in_S_tmp_172512 = loopres_154571;
        
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_while_154529 = loop_while_tmp_172508;
        iter_154530 = iter_tmp_172509;
        first_relevant_in_S_154533 = first_relevant_in_S_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_171912, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171911, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    defunc_0_mergeJoin_res_154524 = loop_while_154529;
    defunc_0_mergeJoin_res_154525 = iter_154530;
    defunc_0_mergeJoin_res_154528 = first_relevant_in_S_154533;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
        return 1;
    if (mem_171914_cached_sizze_172857 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171914, &mem_171914_cached_sizze_172857, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171916_cached_sizze_172858 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171916, &mem_171916_cached_sizze_172858, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171918_cached_sizze_172859 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171918, &mem_171918_cached_sizze_172859, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171920_cached_sizze_172860 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171920, &mem_171920_cached_sizze_172860, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171922_cached_sizze_172861 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171922, &mem_171922_cached_sizze_172861, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171924_cached_sizze_172862 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171924, &mem_171924_cached_sizze_172862, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171926_cached_sizze_172863 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171926, &mem_171926_cached_sizze_172863, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171585;
    int64_t discard_171586;
    int64_t defunc_res_163230;
    int64_t scanacc_171567;
    int64_t scanacc_171568;
    int64_t redout_171571;
    
    scanacc_171567 = (int64_t) 0;
    scanacc_171568 = (int64_t) 0;
    redout_171571 = (int64_t) 0;
    for (int64_t i_171577 = 0; i_171577 < nR_122131; i_171577++) {
        int64_t zg_lhs_162623 = ((int64_t *) ext_mem_171912.mem)[i_171577];
        bool cond_162624 = slt64((int64_t) 0, zg_lhs_162623);
        int64_t lifted_lambda_res_162625;
        
        if (cond_162624) {
            lifted_lambda_res_162625 = i_171577;
        } else {
            lifted_lambda_res_162625 = (int64_t) -1;
        }
        
        bool cond_162627 = sle64((int64_t) 0, lifted_lambda_res_162625);
        bool cond_t_res_162628 = slt64(lifted_lambda_res_162625, nR_122131);
        bool x_162629 = cond_162627 && cond_t_res_162628;
        int64_t lifted_lambda_res_162630;
        
        if (x_162629) {
            bool index_certs_163187;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:194:99-102\n   #4  ftRelational.fut:185:3-194:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163188 = ((int64_t *) ext_mem_171912.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162630 = lifted_lambda_res_t_res_163188;
        } else {
            lifted_lambda_res_162630 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162634 = slt64((int64_t) 1, lifted_lambda_res_162630);
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(lifted_lambda_res_162634);
        int64_t lifted_lambda_res_162647;
        int64_t lifted_lambda_res_162648;
        int64_t lifted_lambda_res_162649;
        
        if (x_162629) {
            bool index_certs_163189;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:194:99-102\n   #5  ftRelational.fut:185:3-194:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163190 = ((int64_t *) tR_mem_171818.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163191 = ((int64_t *) ext_mem_171820.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163192 = ((int64_t *) ext_mem_171911.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162647 = lifted_lambda_res_t_res_163190;
            lifted_lambda_res_162648 = lifted_lambda_res_t_res_163191;
            lifted_lambda_res_162649 = lifted_lambda_res_t_res_163192;
        } else {
            lifted_lambda_res_162647 = (int64_t) 0;
            lifted_lambda_res_162648 = (int64_t) -1;
            lifted_lambda_res_162649 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154863 = add64(defunc_0_f_res_162635, scanacc_171567);
        int64_t lifted_lambda_res_154824 = add64(lifted_lambda_res_162630, scanacc_171568);
        int64_t zp_res_154844 = add64(lifted_lambda_res_162630, redout_171571);
        
        ((int64_t *) mem_171914)[i_171577] = defunc_0_op_res_154863;
        ((int64_t *) mem_171916)[i_171577] = lifted_lambda_res_154824;
        ((int64_t *) mem_171918)[i_171577] = lifted_lambda_res_162647;
        ((int64_t *) mem_171920)[i_171577] = lifted_lambda_res_162648;
        ((int64_t *) mem_171922)[i_171577] = lifted_lambda_res_162649;
        ((int64_t *) mem_171924)[i_171577] = defunc_0_f_res_162635;
        ((int64_t *) mem_171926)[i_171577] = lifted_lambda_res_162630;
        
        int64_t scanacc_tmp_172536 = defunc_0_op_res_154863;
        int64_t scanacc_tmp_172537 = lifted_lambda_res_154824;
        int64_t redout_tmp_172540 = zp_res_154844;
        
        scanacc_171567 = scanacc_tmp_172536;
        scanacc_171568 = scanacc_tmp_172537;
        redout_171571 = redout_tmp_172540;
    }
    discard_171585 = scanacc_171567;
    discard_171586 = scanacc_171568;
    defunc_res_163230 = redout_171571;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
        return 1;
    
    int64_t bytes_171977 = (int64_t) 8 * defunc_res_163230;
    bool cond_154864 = nR_122131 == (int64_t) 0;
    bool x_154865 = !cond_154864;
    int64_t tmp_154866 = sub64(nR_122131, (int64_t) 1);
    bool x_154867 = sle64((int64_t) 0, tmp_154866);
    bool y_154868 = slt64(tmp_154866, nR_122131);
    bool bounds_check_154869 = x_154867 && y_154868;
    bool protect_assert_disj_154870 = cond_154864 || bounds_check_154869;
    bool index_certs_154871;
    
    if (!protect_assert_disj_154870) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154866, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:194:99-102\n   #4  ftRelational.fut:185:3-194:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154872;
    
    if (x_154865) {
        int64_t x_163193 = ((int64_t *) mem_171914)[tmp_154866];
        
        m_f_res_154872 = x_163193;
    } else {
        m_f_res_154872 = (int64_t) 0;
    }
    
    int64_t m_154874;
    
    if (cond_154864) {
        m_154874 = (int64_t) 0;
    } else {
        m_154874 = m_f_res_154872;
    }
    
    bool cond_154897 = slt64((int64_t) 0, m_154874);
    int64_t m_154884 = sub64(m_154874, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154886 = slt64(m_154884, nR_122131);
    bool zzero_leq_i_p_m_t_s_154885 = sle64((int64_t) 0, m_154884);
    bool y_154888 = zzero_leq_i_p_m_t_s_154885 && i_p_m_t_s_leq_w_154886;
    bool i_lte_j_154887 = sle64((int64_t) 0, m_154874);
    bool forwards_ok_154889 = i_lte_j_154887 && y_154888;
    bool eq_x_zz_154881 = (int64_t) 0 == m_f_res_154872;
    bool p_and_eq_x_y_154882 = x_154865 && eq_x_zz_154881;
    bool empty_slice_154883 = cond_154864 || p_and_eq_x_y_154882;
    bool ok_or_empty_154890 = empty_slice_154883 || forwards_ok_154889;
    bool index_certs_154891;
    
    if (!ok_or_empty_154890) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154874, "] out of bounds for array of shape [", (long long) nR_122131, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:194:99-102\n   #4  ftRelational.fut:185:3-194:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172001 = (int64_t) 8 * m_154874;
    
    if (mem_172002_cached_sizze_172865 < bytes_172001) {
        err = lexical_realloc(ctx, &mem_172002, &mem_172002_cached_sizze_172865, bytes_172001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171926, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154874});
    
    int64_t max_mult_154898;
    
    if (cond_154897) {
        if (mem_172004_cached_sizze_172866 < bytes_171821) {
            err = lexical_realloc(ctx, &mem_172004, &mem_172004_cached_sizze_172866, bytes_171821);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171604 = 0; i_171604 < nR_122131; i_171604++) {
            int64_t eta_p_163199 = ((int64_t *) mem_171924)[i_171604];
            int64_t eta_p_163200 = ((int64_t *) mem_171914)[i_171604];
            bool cond_163201 = eta_p_163199 == (int64_t) 1;
            int64_t lifted_lambda_res_163202;
            
            if (cond_163201) {
                int64_t lifted_lambda_res_t_res_163203 = sub64(eta_p_163200, (int64_t) 1);
                
                lifted_lambda_res_163202 = lifted_lambda_res_t_res_163203;
            } else {
                lifted_lambda_res_163202 = (int64_t) -1;
            }
            ((int64_t *) mem_172004)[i_171604] = lifted_lambda_res_163202;
        }
        for (int64_t write_iter_171606 = 0; write_iter_171606 < nR_122131; write_iter_171606++) {
            int64_t write_iv_171608 = ((int64_t *) mem_172004)[write_iter_171606];
            int64_t write_iv_171609 = ((int64_t *) mem_171926)[write_iter_171606];
            
            if (sle64((int64_t) 0, write_iv_171608) && slt64(write_iv_171608, m_154874)) {
                ((int64_t *) mem_172002)[write_iv_171608] = write_iv_171609;
            }
        }
        
        int64_t defunc_0_reduce_res_163213;
        int64_t redout_171611 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171612 = 0; i_171612 < m_154874; i_171612++) {
            int64_t x_163214 = ((int64_t *) mem_172002)[i_171612];
            int64_t max_res_163217 = smax64(x_163214, redout_171611);
            int64_t redout_tmp_172548 = max_res_163217;
            
            redout_171611 = redout_tmp_172548;
        }
        defunc_0_reduce_res_163213 = redout_171611;
        max_mult_154898 = defunc_0_reduce_res_163213;
    } else {
        max_mult_154898 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154904 = slt64(max_mult_154898, (int64_t) 1);
    bool valid_154906 = !bounds_invalid_upwards_154904;
    bool range_valid_c_154907;
    
    if (!valid_154906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154898, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:194:99-102\n   #3  ftRelational.fut:185:3-194:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171970_cached_sizze_172864 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171970, &mem_171970_cached_sizze_172864, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171589 = 0; i_171589 < nR_122131; i_171589++) {
        int64_t eta_p_162530 = ((int64_t *) mem_171926)[i_171589];
        int64_t zv_lhs_162532 = add64((int64_t) -1, i_171589);
        int64_t tmp_162533 = smod64(zv_lhs_162532, nR_122131);
        int64_t lifted_lambda_res_162534 = ((int64_t *) mem_171916)[tmp_162533];
        bool cond_162536 = i_171589 == (int64_t) 0;
        int64_t lifted_lambda_res_162537;
        
        if (cond_162536) {
            lifted_lambda_res_162537 = (int64_t) 0;
        } else {
            lifted_lambda_res_162537 = lifted_lambda_res_162534;
        }
        
        bool cond_162539 = slt64((int64_t) 0, eta_p_162530);
        int64_t lifted_lambda_res_162540;
        
        if (cond_162539) {
            lifted_lambda_res_162540 = lifted_lambda_res_162537;
        } else {
            lifted_lambda_res_162540 = (int64_t) -1;
        }
        ((int64_t *) mem_171970)[i_171589] = lifted_lambda_res_162540;
    }
    if (memblock_alloc(ctx, &mem_171978, bytes_171977, "mem_171978")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172550 = 0; nest_i_172550 < defunc_res_163230; nest_i_172550++) {
        ((int64_t *) mem_171978.mem)[nest_i_172550] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171980, bytes_171977, "mem_171980")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172551 = 0; nest_i_172551 < defunc_res_163230; nest_i_172551++) {
        ((int64_t *) mem_171980.mem)[nest_i_172551] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171982, bytes_171977, "mem_171982")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_163230; nest_i_172552++) {
        ((int64_t *) mem_171982.mem)[nest_i_172552] = (int64_t) -1;
    }
    for (int64_t write_iter_171591 = 0; write_iter_171591 < nR_122131; write_iter_171591++) {
        int64_t write_iv_171595 = ((int64_t *) mem_171970)[write_iter_171591];
        int64_t write_iv_171596 = ((int64_t *) mem_171918)[write_iter_171591];
        int64_t write_iv_171597 = ((int64_t *) mem_171920)[write_iter_171591];
        int64_t write_iv_171598 = ((int64_t *) mem_171922)[write_iter_171591];
        
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171978.mem)[write_iv_171595] = write_iv_171596;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171980.mem)[write_iv_171595] = write_iv_171597;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171982.mem)[write_iv_171595] = write_iv_171598;
        }
    }
    
    int64_t distance_154905 = sub64(max_mult_154898, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_172019, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172022, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172025, &mem_171982, "mem_171982") != 0)
        return 1;
    for (int64_t i_154911 = 0; i_154911 < distance_154905; i_154911++) {
        int64_t index_primexp_154915 = add64((int64_t) 1, i_154911);
        
        if (memblock_alloc(ctx, &mem_172027, bytes_171977, "mem_172027")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172029, bytes_171977, "mem_172029")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172029.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172022.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172031, bytes_171977, "mem_172031")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172031.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        for (int64_t write_iter_171613 = 0; write_iter_171613 < nR_122131; write_iter_171613++) {
            int64_t write_iv_171618 = ((int64_t *) mem_171922)[write_iter_171613];
            int64_t write_iv_171619 = ((int64_t *) mem_171918)[write_iter_171613];
            int64_t write_iv_171620 = ((int64_t *) mem_171920)[write_iter_171613];
            int64_t zg_lhs_163127 = ((int64_t *) mem_171926)[write_iter_171613];
            bool cond_163128 = slt64(index_primexp_154915, zg_lhs_163127);
            int64_t lifted_lambda_res_163129;
            
            if (cond_163128) {
                int64_t zp_lhs_163223 = ((int64_t *) mem_171970)[write_iter_171613];
                int64_t lifted_lambda_res_t_res_163224 = add64(index_primexp_154915, zp_lhs_163223);
                
                lifted_lambda_res_163129 = lifted_lambda_res_t_res_163224;
            } else {
                lifted_lambda_res_163129 = (int64_t) -1;
            }
            
            int64_t tmp_163133 = add64(index_primexp_154915, write_iv_171618);
            
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172031.mem)[lifted_lambda_res_163129] = write_iv_171619;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172029.mem)[lifted_lambda_res_163129] = write_iv_171620;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172027.mem)[lifted_lambda_res_163129] = tmp_163133;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172556, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172557, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172558, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172019, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172022, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172025, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_172058, &mem_param_172019, "mem_param_172019") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172057, &mem_param_172022, "mem_param_172022") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172056, &mem_param_172025, "mem_param_172025") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172060, bytes_171977, "mem_172060")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172062, bytes_171977, "mem_172062")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172062.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172064, bytes_171977, "mem_172064")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172062, "mem_172062") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172064, "mem_172064") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &mem_172060, "mem_172060") != 0)
        return 1;
    prim_out_172503 = defunc_res_163230;
    if (memblock_set(ctx, &*mem_out_p_172853, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172854, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172855, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172856 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171914);
        free(mem_171916);
        free(mem_171918);
        free(mem_171920);
        free(mem_171922);
        free(mem_171924);
        free(mem_171926);
        free(mem_171970);
        free(mem_172002);
        free(mem_172004);
        if (memblock_unref(ctx, &mem_172064, "mem_172064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172062, "mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172060, "mem_172060") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172025, "mem_param_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172022, "mem_param_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172019, "mem_param_172019") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171904, "mem_171904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171872, "mem_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171870, "mem_171870") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171859, "mem_171859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171857, "mem_param_171857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171843, "mem_param_171843") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171887, "ext_mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171890, "ext_mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171896, "ext_mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_inner_SMJ_short(struct futhark_context *ctx, struct memblock *mem_out_p_172867, struct memblock *mem_out_p_172868, struct memblock *mem_out_p_172869, int64_t *out_prim_out_172870, struct memblock tR_mem_171818, struct memblock tS_mem_171819, int64_t nR_116817, int64_t nS_116818, int64_t offset_R_116821, int64_t offset_S_116822, int64_t partitionSizze_116823, int64_t scatter_psizze_116824)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171914_cached_sizze_172871 = 0;
    unsigned char *mem_171914 = NULL;
    int64_t mem_171916_cached_sizze_172872 = 0;
    unsigned char *mem_171916 = NULL;
    int64_t mem_171918_cached_sizze_172873 = 0;
    unsigned char *mem_171918 = NULL;
    int64_t mem_171920_cached_sizze_172874 = 0;
    unsigned char *mem_171920 = NULL;
    int64_t mem_171922_cached_sizze_172875 = 0;
    unsigned char *mem_171922 = NULL;
    int64_t mem_171924_cached_sizze_172876 = 0;
    unsigned char *mem_171924 = NULL;
    int64_t mem_171926_cached_sizze_172877 = 0;
    unsigned char *mem_171926 = NULL;
    int64_t mem_171970_cached_sizze_172878 = 0;
    unsigned char *mem_171970 = NULL;
    int64_t mem_172002_cached_sizze_172879 = 0;
    unsigned char *mem_172002 = NULL;
    int64_t mem_172004_cached_sizze_172880 = 0;
    unsigned char *mem_172004 = NULL;
    struct memblock mem_172064;
    
    mem_172064.references = NULL;
    
    struct memblock mem_172062;
    
    mem_172062.references = NULL;
    
    struct memblock mem_172060;
    
    mem_172060.references = NULL;
    
    struct memblock mem_param_tmp_172558;
    
    mem_param_tmp_172558.references = NULL;
    
    struct memblock mem_param_tmp_172557;
    
    mem_param_tmp_172557.references = NULL;
    
    struct memblock mem_param_tmp_172556;
    
    mem_param_tmp_172556.references = NULL;
    
    struct memblock mem_172031;
    
    mem_172031.references = NULL;
    
    struct memblock mem_172029;
    
    mem_172029.references = NULL;
    
    struct memblock mem_172027;
    
    mem_172027.references = NULL;
    
    struct memblock mem_param_172025;
    
    mem_param_172025.references = NULL;
    
    struct memblock mem_param_172022;
    
    mem_param_172022.references = NULL;
    
    struct memblock mem_param_172019;
    
    mem_param_172019.references = NULL;
    
    struct memblock ext_mem_172056;
    
    ext_mem_172056.references = NULL;
    
    struct memblock ext_mem_172057;
    
    ext_mem_172057.references = NULL;
    
    struct memblock ext_mem_172058;
    
    ext_mem_172058.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock mem_171980;
    
    mem_171980.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_171906;
    
    mem_171906.references = NULL;
    
    struct memblock mem_171904;
    
    mem_171904.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_171872;
    
    mem_171872.references = NULL;
    
    struct memblock mem_171870;
    
    mem_171870.references = NULL;
    
    struct memblock mem_param_tmp_172530;
    
    mem_param_tmp_172530.references = NULL;
    
    struct memblock mem_171859;
    
    mem_171859.references = NULL;
    
    struct memblock mem_param_171857;
    
    mem_param_171857.references = NULL;
    
    struct memblock ext_mem_171868;
    
    ext_mem_171868.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_171845;
    
    mem_171845.references = NULL;
    
    struct memblock mem_param_171843;
    
    mem_param_171843.references = NULL;
    
    struct memblock ext_mem_171854;
    
    ext_mem_171854.references = NULL;
    
    struct memblock ext_mem_171887;
    
    ext_mem_171887.references = NULL;
    
    struct memblock ext_mem_171890;
    
    ext_mem_171890.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock ext_mem_171896;
    
    ext_mem_171896.references = NULL;
    
    struct memblock mem_param_171840;
    
    mem_param_171840.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171901;
    
    ext_mem_171901.references = NULL;
    
    struct memblock ext_mem_171902;
    
    ext_mem_171902.references = NULL;
    
    struct memblock mem_171834;
    
    mem_171834.references = NULL;
    
    struct memblock mem_171832;
    
    mem_171832.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock ext_mem_171911;
    
    ext_mem_171911.references = NULL;
    
    struct memblock ext_mem_171912;
    
    ext_mem_171912.references = NULL;
    
    struct memblock mem_171824;
    
    mem_171824.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock ext_mem_171820;
    
    ext_mem_171820.references = NULL;
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172503;
    int64_t partitionSizze_154510 = sdiv64(partitionSizze_116823, (int64_t) 2);
    int64_t zm_lhs_154511 = add64(nR_116817, partitionSizze_154510);
    int64_t zs_lhs_154512 = sub64(zm_lhs_154511, (int64_t) 1);
    bool zzero_154513 = partitionSizze_154510 == (int64_t) 0;
    bool nonzzero_154514 = !zzero_154513;
    bool nonzzero_cert_154515;
    
    if (!nonzzero_154514) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftSMJ.fut:282:45-59\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t numIter_R_154516 = sdiv64(zs_lhs_154512, partitionSizze_154510);
    int64_t zm_lhs_154517 = add64(nS_116818, partitionSizze_154510);
    int64_t zs_lhs_154518 = sub64(zm_lhs_154517, (int64_t) 1);
    int64_t numIter_S_154519 = sdiv64(zs_lhs_154518, partitionSizze_154510);
    
    if (futrts_indicesWithIncrement_16298(ctx, &ext_mem_171820, tR_mem_171818, nR_116817, offset_R_116821) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t bytes_171821 = (int64_t) 8 * nR_116817;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < nR_116817; nest_i_172504++) {
        ((int64_t *) mem_171822.mem)[nest_i_172504] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171824, bytes_171821, "mem_171824")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < nR_116817; nest_i_172505++) {
        ((int64_t *) mem_171824.mem)[nest_i_172505] = (int64_t) 0;
    }
    
    bool loop_cond_154523 = slt64((int64_t) 0, numIter_R_154516);
    bool defunc_0_mergeJoin_res_154524;
    int64_t defunc_0_mergeJoin_res_154525;
    int64_t defunc_0_mergeJoin_res_154528;
    bool loop_while_154529;
    int64_t iter_154530;
    int64_t first_relevant_in_S_154533;
    
    if (memblock_set(ctx, &mem_param_171827, &mem_171824, "mem_171824") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_while_154529 = loop_cond_154523;
    iter_154530 = (int64_t) 0;
    first_relevant_in_S_154533 = (int64_t) 0;
    while (loop_while_154529) {
        int64_t tR_start_154534 = mul64(partitionSizze_154510, iter_154530);
        int64_t min_arg1_154535 = add64(partitionSizze_154510, tR_start_154534);
        int64_t min_res_154536 = smin64(nR_116817, min_arg1_154535);
        int64_t dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 = sub64(min_res_154536, tR_start_154534);
        bool empty_slice_154538 = dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537 == (int64_t) 0;
        int64_t m_154539 = sub64(dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, (int64_t) 1);
        int64_t i_p_m_t_s_154540 = add64(tR_start_154534, m_154539);
        bool zzero_leq_i_p_m_t_s_154541 = sle64((int64_t) 0, i_p_m_t_s_154540);
        bool i_p_m_t_s_leq_w_154542 = slt64(i_p_m_t_s_154540, nR_116817);
        bool zzero_lte_i_154543 = sle64((int64_t) 0, tR_start_154534);
        bool i_lte_j_154544 = sle64(tR_start_154534, min_res_154536);
        bool y_154545 = i_p_m_t_s_leq_w_154542 && zzero_lte_i_154543;
        bool y_154546 = zzero_leq_i_p_m_t_s_154541 && y_154545;
        bool forwards_ok_154547 = i_lte_j_154544 && y_154546;
        bool ok_or_empty_154548 = empty_slice_154538 || forwards_ok_154547;
        bool index_certs_154549;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  ftSMJ.fut:289:19-38\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t bytes_171831 = (int64_t) 8 * dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537;
        bool cond_154553 = slt64(first_relevant_in_S_154533, numIter_S_154519);
        bool y_154554 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool loop_not_taken_154555 = !cond_154553;
        bool protect_assert_disj_154556 = y_154554 || loop_not_taken_154555;
        bool index_certs_154557;
        
        if (!protect_assert_disj_154556) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:304:28-36\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool x_154560 = sle64((int64_t) 0, m_154539);
        bool y_154561 = slt64(m_154539, dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537);
        bool bounds_check_154562 = x_154560 && y_154561;
        bool protect_assert_disj_154563 = loop_not_taken_154555 || bounds_check_154562;
        bool index_certs_154564;
        
        if (!protect_assert_disj_154563) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:305:30-49\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool index_certs_154795;
        
        if (!ok_or_empty_154548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tR_start_154534, ":", (long long) min_res_154536, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  ftSMJ.fut:198:17-65\n   #1  ftSMJ.fut:315:22-66\n   #2  ftSMJ.fut:386:95-97\n   #3  ftRelational.fut:172:99-102\n   #4  ftRelational.fut:163:3-172:102\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_alloc(ctx, &mem_171832, bytes_171831, "mem_171832")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172513 = 0; nest_i_172513 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172513++) {
            ((int64_t *) mem_171832.mem)[nest_i_172513] = (int64_t) -1;
        }
        if (memblock_alloc(ctx, &mem_171834, bytes_171831, "mem_171834")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t nest_i_172514 = 0; nest_i_172514 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; nest_i_172514++) {
            ((int64_t *) mem_171834.mem)[nest_i_172514] = (int64_t) 0;
        }
        
        int16_t gt_lhs_154558;
        
        if (cond_154553) {
            int16_t x_163142 = ((int16_t *) tR_mem_171818.mem)[tR_start_154534];
            
            gt_lhs_154558 = x_163142;
        } else {
            gt_lhs_154558 = (int16_t) 0;
        }
        
        int16_t lt_lhs_154565;
        
        if (cond_154553) {
            int16_t x_163143 = ((int16_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
            
            lt_lhs_154565 = x_163143;
        } else {
            lt_lhs_154565 = (int16_t) 0;
        }
        
        int64_t ext_171900;
        int64_t ext_171899;
        int64_t ext_171898;
        int64_t ext_171897;
        bool loopres_154567;
        int64_t loopres_154568;
        int64_t loopres_154571;
        bool loop_while_154572;
        int64_t s_iter_154573;
        int64_t minRelevant_154576;
        int64_t ctx_param_ext_171835;
        int64_t ctx_param_ext_171836;
        int64_t ctx_param_ext_171838;
        int64_t ctx_param_ext_171839;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171840, &mem_171832, "mem_171832") != 0)
            return 1;
        ctx_param_ext_171835 = (int64_t) 0;
        ctx_param_ext_171836 = (int64_t) 1;
        ctx_param_ext_171838 = (int64_t) 0;
        ctx_param_ext_171839 = (int64_t) 1;
        loop_while_154572 = cond_154553;
        s_iter_154573 = first_relevant_in_S_154533;
        minRelevant_154576 = first_relevant_in_S_154533;
        while (loop_while_154572) {
            int64_t tS_start_154577 = mul64(partitionSizze_154510, s_iter_154573);
            int64_t min_arg1_154578 = add64(partitionSizze_154510, tS_start_154577);
            int64_t min_res_154579 = smin64(nS_116818, min_arg1_154578);
            int64_t dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 = sub64(min_res_154579, tS_start_154577);
            bool empty_slice_154581 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580 == (int64_t) 0;
            int64_t m_154582 = sub64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, (int64_t) 1);
            int64_t i_p_m_t_s_154583 = add64(tS_start_154577, m_154582);
            bool zzero_leq_i_p_m_t_s_154584 = sle64((int64_t) 0, i_p_m_t_s_154583);
            bool i_p_m_t_s_leq_w_154585 = slt64(i_p_m_t_s_154583, nS_116818);
            bool zzero_lte_i_154586 = sle64((int64_t) 0, tS_start_154577);
            bool i_lte_j_154587 = sle64(tS_start_154577, min_res_154579);
            bool y_154588 = i_p_m_t_s_leq_w_154585 && zzero_lte_i_154586;
            bool y_154589 = zzero_leq_i_p_m_t_s_154584 && y_154588;
            bool forwards_ok_154590 = i_lte_j_154587 && y_154589;
            bool ok_or_empty_154591 = empty_slice_154581 || forwards_ok_154590;
            bool index_certs_154592;
            
            if (!ok_or_empty_154591) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tS_start_154577, ":", (long long) min_res_154579, "] out of bounds for array of shape [", (long long) nS_116818, "].", "-> #0  ftSMJ.fut:302:21-40\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool x_154593 = sle64((int64_t) 0, m_154582);
            bool y_154594 = slt64(m_154582, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool bounds_check_154595 = x_154593 && y_154594;
            bool index_certs_154596;
            
            if (!bounds_check_154595) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:304:42-61\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_154599 = slt64((int64_t) 0, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
            bool index_certs_154600;
            
            if (!y_154599) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:305:55-63\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t gt_rhs_154597 = ((int16_t *) tS_mem_171819.mem)[i_p_m_t_s_154583];
            bool defunc_0_gt_res_154598 = slt16(gt_rhs_154597, gt_lhs_154558);
            int16_t lt_rhs_154601 = ((int16_t *) tS_mem_171819.mem)[tS_start_154577];
            bool defunc_0_lt_res_154602 = slt16(lt_lhs_154565, lt_rhs_154601);
            bool thisStillRel_154603 = !defunc_0_lt_res_154602;
            int64_t ext_171889;
            
            if (defunc_0_lt_res_154602) {
                ext_171889 = ctx_param_ext_171835;
            } else {
                ext_171889 = (int64_t) 0;
            }
            
            int64_t ext_171888;
            
            if (defunc_0_lt_res_154602) {
                ext_171888 = ctx_param_ext_171836;
            } else {
                ext_171888 = (int64_t) 1;
            }
            
            int64_t ext_171886;
            
            if (defunc_0_lt_res_154602) {
                ext_171886 = ctx_param_ext_171838;
            } else {
                ext_171886 = (int64_t) 0;
            }
            
            int64_t ext_171885;
            
            if (defunc_0_lt_res_154602) {
                ext_171885 = ctx_param_ext_171839;
            } else {
                ext_171885 = (int64_t) 1;
            }
            
            int64_t ext_171895;
            
            if (defunc_0_gt_res_154598) {
                ext_171895 = ctx_param_ext_171835;
            } else {
                ext_171895 = ext_171889;
            }
            
            int64_t ext_171894;
            
            if (defunc_0_gt_res_154598) {
                ext_171894 = ctx_param_ext_171836;
            } else {
                ext_171894 = ext_171888;
            }
            
            int64_t ext_171892;
            
            if (defunc_0_gt_res_154598) {
                ext_171892 = ctx_param_ext_171838;
            } else {
                ext_171892 = ext_171886;
            }
            
            int64_t ext_171891;
            
            if (defunc_0_gt_res_154598) {
                ext_171891 = ctx_param_ext_171839;
            } else {
                ext_171891 = ext_171885;
            }
            
            int64_t loopres_154604;
            bool loopres_154607;
            int64_t loopres_154608;
            
            if (defunc_0_gt_res_154598) {
                int64_t tmp_163144 = add64((int64_t) 1, s_iter_154573);
                
                if (memblock_set(ctx, &ext_mem_171896, &mem_param_171837, "mem_param_171837") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &mem_param_171840, "mem_param_171840") != 0)
                    return 1;
                loopres_154604 = tmp_163144;
                loopres_154607 = 1;
                loopres_154608 = tmp_163144;
            } else {
                int64_t loopres_f_res_154610;
                bool loopres_f_res_154613;
                
                if (defunc_0_lt_res_154602) {
                    if (memblock_set(ctx, &ext_mem_171890, &mem_param_171837, "mem_param_171837") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_param_171840, "mem_param_171840") != 0)
                        return 1;
                    loopres_f_res_154610 = s_iter_154573;
                    loopres_f_res_154613 = thisStillRel_154603;
                } else {
                    bool index_certs_154614;
                    
                    if (!bounds_check_154562) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154539, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537, "].", "-> #0  ftSMJ.fut:309:27-46\n   #1  ftSMJ.fut:386:95-97\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lt_lhs_154615 = ((int16_t *) tR_mem_171818.mem)[i_p_m_t_s_154540];
                    bool defunc_0_lt_res_154616 = slt16(lt_lhs_154615, gt_rhs_154597);
                    bool nextRel_154617 = !defunc_0_lt_res_154616;
                    int64_t find_joinTuples_arg3_154618 = add64(offset_S_116822, tS_start_154577);
                    double i64_res_154619 = sitofp_i64_f64(dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                    double log2_res_154620 = futrts_log2_64(i64_res_154619);
                    double ceil_res_154621 = futrts_ceil64(log2_res_154620);
                    int64_t f64_res_154622 = fptosi_f64_i64(ceil_res_154621);
                    int64_t num_iter_154623 = add64((int64_t) 1, f64_res_154622);
                    int64_t bsearch_first_154625;
                    int64_t last_step_154628;
                    
                    if (memblock_set(ctx, &mem_param_171843, &mem_171834, "mem_171834") != 0)
                        return 1;
                    last_step_154628 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154626 = 0; i_154626 < num_iter_154623; i_154626++) {
                        int64_t zs_lhs_154629 = add64((int64_t) 1, last_step_154628);
                        int64_t this_step_154630 = sdiv64(zs_lhs_154629, (int64_t) 2);
                        
                        if (memblock_alloc(ctx, &mem_171845, bytes_171831, "mem_171845")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171547++) {
                            int64_t eta_p_162698 = ((int64_t *) mem_param_171843.mem)[i_171547];
                            int64_t slice_171796 = tR_start_154534 + i_171547;
                            int16_t eta_p_162699 = ((int16_t *) tR_mem_171818.mem)[slice_171796];
                            bool cond_162701 = sle64(eta_p_162698, (int64_t) 0);
                            int16_t prev_elem_162702;
                            
                            if (cond_162701) {
                                bool index_certs_163146;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                prev_elem_162702 = lt_rhs_154601;
                            } else {
                                int64_t tmp_162706 = sub64(eta_p_162698, (int64_t) 1);
                                bool x_162707 = sle64((int64_t) 0, tmp_162706);
                                bool y_162708 = slt64(tmp_162706, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162709 = x_162707 && y_162708;
                                bool index_certs_162710;
                                
                                if (!bounds_check_162709) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162706, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:219:53-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162711 = tS_start_154577 + tmp_162706;
                                int16_t prev_elem_f_res_162712 = ((int16_t *) tS_mem_171819.mem)[slice_162711];
                                
                                prev_elem_162702 = prev_elem_f_res_162712;
                            }
                            
                            bool cond_162713 = slt64(eta_p_162698, (int64_t) 0);
                            int16_t cur_elem_162714;
                            
                            if (cond_162713) {
                                bool index_certs_163149;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162714 = lt_rhs_154601;
                            } else {
                                bool x_162718 = sle64((int64_t) 0, eta_p_162698);
                                bool y_162719 = slt64(eta_p_162698, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162720 = x_162718 && y_162719;
                                bool index_certs_162721;
                                
                                if (!bounds_check_162720) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162698, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:220:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162722 = tS_start_154577 + eta_p_162698;
                                int16_t cur_elem_f_res_162723 = ((int16_t *) tS_mem_171819.mem)[slice_162722];
                                
                                cur_elem_162714 = cur_elem_f_res_162723;
                            }
                            
                            bool cond_162724 = sle64(m_154582, eta_p_162698);
                            int16_t next_elem_162725;
                            
                            if (cond_162724) {
                                bool index_certs_163155;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162725 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162733 = add64((int64_t) 1, eta_p_162698);
                                bool x_162734 = sle64((int64_t) 0, tmp_162733);
                                bool y_162735 = slt64(tmp_162733, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162736 = x_162734 && y_162735;
                                bool index_certs_162737;
                                
                                if (!bounds_check_162736) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162733, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:221:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:218:14-223:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162738 = tS_start_154577 + tmp_162733;
                                int16_t next_elem_f_res_162739 = ((int16_t *) tS_mem_171819.mem)[slice_162738];
                                
                                next_elem_162725 = next_elem_f_res_162739;
                            }
                            
                            int64_t defunc_0_f_res_162744;
                            
                            if (cond_162713) {
                                defunc_0_f_res_162744 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162745 = eta_p_162699 == cur_elem_162714;
                                bool cond_162746 = eta_p_162698 == (int64_t) 0;
                                bool defunc_0_gt_res_162747 = slt16(prev_elem_162702, eta_p_162699);
                                bool x_162748 = !cond_162746;
                                bool y_162749 = defunc_0_gt_res_162747 && x_162748;
                                bool cond_t_res_162750 = cond_162746 || y_162749;
                                bool x_162751 = defunc_0_eq_res_162745 && cond_t_res_162750;
                                int64_t defunc_0_f_res_f_res_162752;
                                
                                if (x_162751) {
                                    defunc_0_f_res_f_res_162752 = eta_p_162698;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162753;
                                    
                                    if (defunc_0_eq_res_162745) {
                                        int64_t max_arg1_163158 = sub64(eta_p_162698, this_step_154630);
                                        int64_t max_res_163159 = smax64((int64_t) 0, max_arg1_163158);
                                        
                                        defunc_0_f_res_f_res_f_res_162753 = max_res_163159;
                                    } else {
                                        bool defunc_0_gt_res_162756 = slt16(cur_elem_162714, eta_p_162699);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162757;
                                        
                                        if (defunc_0_gt_res_162756) {
                                            bool cond_163161 = eta_p_162698 == m_154582;
                                            bool defunc_0_lt_res_163162 = slt16(eta_p_162699, next_elem_162725);
                                            bool x_163163 = !cond_163161;
                                            bool y_163164 = defunc_0_lt_res_163162 && x_163163;
                                            bool cond_163165 = cond_163161 || y_163164;
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                            
                                            if (cond_163165) {
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = (int64_t) -1;
                                            } else {
                                                int64_t min_arg1_163167 = add64(this_step_154630, eta_p_162698);
                                                int64_t min_res_163168 = smin64(m_154582, min_arg1_163167);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_t_res_163166 = min_res_163168;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_t_res_163166;
                                        } else {
                                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                            
                                            if (cond_t_res_162750) {
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = (int64_t) -1;
                                            } else {
                                                int64_t max_arg1_162768 = sub64(eta_p_162698, this_step_154630);
                                                int64_t max_res_162769 = smax64((int64_t) 0, max_arg1_162768);
                                                
                                                defunc_0_f_res_f_res_f_res_f_res_f_res_162767 = max_res_162769;
                                            }
                                            defunc_0_f_res_f_res_f_res_f_res_162757 = defunc_0_f_res_f_res_f_res_f_res_f_res_162767;
                                        }
                                        defunc_0_f_res_f_res_f_res_162753 = defunc_0_f_res_f_res_f_res_f_res_162757;
                                    }
                                    defunc_0_f_res_f_res_162752 = defunc_0_f_res_f_res_f_res_162753;
                                }
                                defunc_0_f_res_162744 = defunc_0_f_res_f_res_162752;
                            }
                            ((int64_t *) mem_171845.mem)[i_171547] = defunc_0_f_res_162744;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171845, "mem_171845") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172528 = this_step_154630;
                        
                        if (memblock_set(ctx, &mem_param_171843, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                            return 1;
                        last_step_154628 = last_step_tmp_172528;
                    }
                    if (memblock_set(ctx, &ext_mem_171854, &mem_param_171843, "mem_param_171843") != 0)
                        return 1;
                    bsearch_first_154625 = last_step_154628;
                    
                    int64_t bsearch_last_154708;
                    int64_t last_step_154711;
                    
                    if (memblock_set(ctx, &mem_param_171857, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    last_step_154711 = dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580;
                    for (int64_t i_154709 = 0; i_154709 < num_iter_154623; i_154709++) {
                        int64_t zs_lhs_154712 = add64((int64_t) 1, last_step_154711);
                        int64_t max_arg1_154713 = sdiv64(zs_lhs_154712, (int64_t) 2);
                        int64_t max_res_154714 = smax64((int64_t) 1, max_arg1_154713);
                        
                        if (memblock_alloc(ctx, &mem_171859, bytes_171831, "mem_171859")) {
                            err = 1;
                            goto cleanup;
                        }
                        for (int64_t i_171551 = 0; i_171551 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171551++) {
                            int64_t eta_p_162821 = ((int64_t *) mem_param_171857.mem)[i_171551];
                            int64_t slice_171795 = tR_start_154534 + i_171551;
                            int16_t eta_p_162822 = ((int16_t *) tR_mem_171818.mem)[slice_171795];
                            bool cond_162824 = slt64(eta_p_162821, (int64_t) 0);
                            int16_t cur_elem_162825;
                            
                            if (cond_162824) {
                                bool index_certs_163171;
                                
                                if (!y_154599) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:40-45\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                cur_elem_162825 = lt_rhs_154601;
                            } else {
                                bool x_162829 = sle64((int64_t) 0, eta_p_162821);
                                bool y_162830 = slt64(eta_p_162821, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162831 = x_162829 && y_162830;
                                bool index_certs_162832;
                                
                                if (!bounds_check_162831) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162821, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:245:51-56\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162833 = tS_start_154577 + eta_p_162821;
                                int16_t cur_elem_f_res_162834 = ((int16_t *) tS_mem_171819.mem)[slice_162833];
                                
                                cur_elem_162825 = cur_elem_f_res_162834;
                            }
                            
                            bool cond_162835 = sle64(m_154582, eta_p_162821);
                            int16_t next_elem_162836;
                            
                            if (cond_162835) {
                                bool index_certs_163177;
                                
                                if (!bounds_check_154595) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) m_154582, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:47-55\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                next_elem_162836 = gt_rhs_154597;
                            } else {
                                int64_t tmp_162844 = add64((int64_t) 1, eta_p_162821);
                                bool x_162845 = sle64((int64_t) 0, tmp_162844);
                                bool y_162846 = slt64(tmp_162844, dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580);
                                bool bounds_check_162847 = x_162845 && y_162846;
                                bool index_certs_162848;
                                
                                if (!bounds_check_162847) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162844, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20UtS_endz20UtS_startz7dUzg_154580, "].", "-> #0  ftSMJ.fut:246:61-68\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:244:14-248:12\n   #3  ftSMJ.fut:386:95-97\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162849 = tS_start_154577 + tmp_162844;
                                int16_t next_elem_f_res_162850 = ((int16_t *) tS_mem_171819.mem)[slice_162849];
                                
                                next_elem_162836 = next_elem_f_res_162850;
                            }
                            
                            int64_t defunc_0_f_res_162854;
                            
                            if (cond_162824) {
                                defunc_0_f_res_162854 = (int64_t) -1;
                            } else {
                                bool defunc_0_eq_res_162855 = eta_p_162822 == cur_elem_162825;
                                bool cond_162857 = eta_p_162821 == m_154582;
                                bool defunc_0_gt_res_162858 = slt16(eta_p_162822, next_elem_162836);
                                bool x_162859 = !cond_162857;
                                bool y_162860 = defunc_0_gt_res_162858 && x_162859;
                                bool cond_t_res_162861 = cond_162857 || y_162860;
                                bool x_162862 = defunc_0_eq_res_162855 && cond_t_res_162861;
                                int64_t defunc_0_f_res_f_res_162863;
                                
                                if (x_162862) {
                                    defunc_0_f_res_f_res_162863 = eta_p_162821;
                                } else {
                                    int64_t defunc_0_f_res_f_res_f_res_162864;
                                    
                                    if (defunc_0_eq_res_162855) {
                                        int64_t min_arg1_163180 = add64(max_res_154714, eta_p_162821);
                                        int64_t min_res_163181 = smin64(m_154582, min_arg1_163180);
                                        
                                        defunc_0_f_res_f_res_f_res_162864 = min_res_163181;
                                    } else {
                                        bool defunc_0_gt_res_162867 = slt16(cur_elem_162825, eta_p_162822);
                                        int64_t defunc_0_f_res_f_res_f_res_f_res_162868;
                                        
                                        if (defunc_0_gt_res_162867) {
                                            int64_t min_arg1_163182 = add64(max_res_154714, eta_p_162821);
                                            int64_t min_res_163183 = smin64(m_154582, min_arg1_163182);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = min_res_163183;
                                        } else {
                                            int64_t max_arg1_162871 = sub64(eta_p_162821, max_res_154714);
                                            int64_t max_res_162872 = smax64((int64_t) 0, max_arg1_162871);
                                            
                                            defunc_0_f_res_f_res_f_res_f_res_162868 = max_res_162872;
                                        }
                                        defunc_0_f_res_f_res_f_res_162864 = defunc_0_f_res_f_res_f_res_f_res_162868;
                                    }
                                    defunc_0_f_res_f_res_162863 = defunc_0_f_res_f_res_f_res_162864;
                                }
                                defunc_0_f_res_162854 = defunc_0_f_res_f_res_162863;
                            }
                            ((int64_t *) mem_171859.mem)[i_171551] = defunc_0_f_res_162854;
                        }
                        if (memblock_set(ctx, &mem_param_tmp_172530, &mem_171859, "mem_171859") != 0)
                            return 1;
                        
                        int64_t last_step_tmp_172532 = max_res_154714;
                        
                        if (memblock_set(ctx, &mem_param_171857, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
                            return 1;
                        last_step_154711 = last_step_tmp_172532;
                    }
                    if (memblock_set(ctx, &ext_mem_171868, &mem_param_171857, "mem_param_171857") != 0)
                        return 1;
                    bsearch_last_154708 = last_step_154711;
                    if (memblock_alloc(ctx, &mem_171870, bytes_171831, "mem_171870")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (memblock_alloc(ctx, &mem_171872, bytes_171831, "mem_171872")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t i_171557 = 0; i_171557 < dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537; i_171557++) {
                        int64_t eta_p_162677 = ((int64_t *) ext_mem_171854.mem)[i_171557];
                        int64_t eta_p_162678 = ((int64_t *) mem_param_171840.mem)[ctx_param_ext_171838 + i_171557 * ctx_param_ext_171839];
                        int64_t eta_p_162679 = ((int64_t *) ext_mem_171868.mem)[i_171557];
                        int64_t eta_p_162680 = ((int64_t *) mem_param_171837.mem)[ctx_param_ext_171835 + i_171557 * ctx_param_ext_171836];
                        bool cond_162682 = slt64(eta_p_162677, (int64_t) 0);
                        int64_t lifted_lambda_res_162683;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162683 = (int64_t) 0;
                        } else {
                            int64_t zp_lhs_162684 = sub64(eta_p_162679, eta_p_162677);
                            int64_t lifted_lambda_res_f_res_162685 = add64((int64_t) 1, zp_lhs_162684);
                            
                            lifted_lambda_res_162683 = lifted_lambda_res_f_res_162685;
                        }
                        
                        int64_t defunc_0_f_res_162687 = add64(eta_p_162680, lifted_lambda_res_162683);
                        int64_t lifted_lambda_res_162690;
                        
                        if (cond_162682) {
                            lifted_lambda_res_162690 = eta_p_162677;
                        } else {
                            int64_t lifted_lambda_res_f_res_162691 = add64(find_joinTuples_arg3_154618, eta_p_162677);
                            
                            lifted_lambda_res_162690 = lifted_lambda_res_f_res_162691;
                        }
                        
                        bool cond_162693 = slt64(eta_p_162678, (int64_t) 0);
                        int64_t lifted_lambda_res_162694;
                        
                        if (cond_162693) {
                            lifted_lambda_res_162694 = lifted_lambda_res_162690;
                        } else {
                            lifted_lambda_res_162694 = eta_p_162678;
                        }
                        ((int64_t *) mem_171870.mem)[i_171557] = lifted_lambda_res_162694;
                        ((int64_t *) mem_171872.mem)[i_171557] = defunc_0_f_res_162687;
                    }
                    if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
                        return 1;
                    if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
                        return 1;
                    
                    int64_t tmp_154791 = add64((int64_t) 1, s_iter_154573);
                    
                    if (memblock_set(ctx, &ext_mem_171890, &mem_171872, "mem_171872") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171887, &mem_171870, "mem_171870") != 0)
                        return 1;
                    loopres_f_res_154610 = tmp_154791;
                    loopres_f_res_154613 = nextRel_154617;
                }
                if (memblock_set(ctx, &ext_mem_171896, &ext_mem_171890, "ext_mem_171890") != 0)
                    return 1;
                if (memblock_set(ctx, &ext_mem_171893, &ext_mem_171887, "ext_mem_171887") != 0)
                    return 1;
                loopres_154604 = loopres_f_res_154610;
                loopres_154607 = loopres_f_res_154613;
                loopres_154608 = minRelevant_154576;
            }
            
            bool cond_154792 = slt64(loopres_154604, numIter_S_154519);
            bool x_154793 = loopres_154607 && cond_154792;
            
            if (memblock_set(ctx, &mem_param_tmp_172515, &ext_mem_171896, "ext_mem_171896") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &ext_mem_171893, "ext_mem_171893") != 0)
                return 1;
            
            int64_t ctx_param_ext_tmp_172517 = ext_171895;
            int64_t ctx_param_ext_tmp_172518 = ext_171894;
            int64_t ctx_param_ext_tmp_172519 = ext_171892;
            int64_t ctx_param_ext_tmp_172520 = ext_171891;
            bool loop_while_tmp_172521 = x_154793;
            int64_t s_iter_tmp_172522 = loopres_154604;
            int64_t minRelevant_tmp_172525 = loopres_154608;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171840, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            ctx_param_ext_171835 = ctx_param_ext_tmp_172517;
            ctx_param_ext_171836 = ctx_param_ext_tmp_172518;
            ctx_param_ext_171838 = ctx_param_ext_tmp_172519;
            ctx_param_ext_171839 = ctx_param_ext_tmp_172520;
            loop_while_154572 = loop_while_tmp_172521;
            s_iter_154573 = s_iter_tmp_172522;
            minRelevant_154576 = minRelevant_tmp_172525;
        }
        if (memblock_set(ctx, &ext_mem_171902, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_171901, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        ext_171900 = ctx_param_ext_171835;
        ext_171899 = ctx_param_ext_171836;
        ext_171898 = ctx_param_ext_171838;
        ext_171897 = ctx_param_ext_171839;
        loopres_154567 = loop_while_154572;
        loopres_154568 = s_iter_154573;
        loopres_154571 = minRelevant_154576;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171904, bytes_171821, "mem_171904")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171830.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_116817});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171904.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171901.mem, ext_171898, (int64_t []) {ext_171897}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_alloc(ctx, &mem_171906, bytes_171821, "mem_171906")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {nR_116817});
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906.mem, tR_start_154534, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171902.mem, ext_171900, (int64_t []) {ext_171899}, (int64_t []) {dzlz7bUZLzmZRz20UtR_endz20UtR_startz7dUzg_154537});
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        
        int64_t tmp_154799 = add64((int64_t) 1, iter_154530);
        bool loop_cond_154800 = slt64(tmp_154799, numIter_R_154516);
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171904, "mem_171904") != 0)
            return 1;
        
        bool loop_while_tmp_172508 = loop_cond_154800;
        int64_t iter_tmp_172509 = tmp_154799;
        int64_t first_relevant_in_S_tmp_172512 = loopres_154571;
        
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_while_154529 = loop_while_tmp_172508;
        iter_154530 = iter_tmp_172509;
        first_relevant_in_S_154533 = first_relevant_in_S_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_171912, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171911, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    defunc_0_mergeJoin_res_154524 = loop_while_154529;
    defunc_0_mergeJoin_res_154525 = iter_154530;
    defunc_0_mergeJoin_res_154528 = first_relevant_in_S_154533;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
        return 1;
    if (mem_171914_cached_sizze_172871 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171914, &mem_171914_cached_sizze_172871, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171916_cached_sizze_172872 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171916, &mem_171916_cached_sizze_172872, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t bytes_171917 = (int64_t) 2 * nR_116817;
    
    if (mem_171918_cached_sizze_172873 < bytes_171917) {
        err = lexical_realloc(ctx, &mem_171918, &mem_171918_cached_sizze_172873, bytes_171917);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171920_cached_sizze_172874 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171920, &mem_171920_cached_sizze_172874, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171922_cached_sizze_172875 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171922, &mem_171922_cached_sizze_172875, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171924_cached_sizze_172876 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171924, &mem_171924_cached_sizze_172876, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171926_cached_sizze_172877 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171926, &mem_171926_cached_sizze_172877, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171585;
    int64_t discard_171586;
    int64_t defunc_res_163230;
    int64_t scanacc_171567;
    int64_t scanacc_171568;
    int64_t redout_171571;
    
    scanacc_171567 = (int64_t) 0;
    scanacc_171568 = (int64_t) 0;
    redout_171571 = (int64_t) 0;
    for (int64_t i_171577 = 0; i_171577 < nR_116817; i_171577++) {
        int64_t zg_lhs_162623 = ((int64_t *) ext_mem_171912.mem)[i_171577];
        bool cond_162624 = slt64((int64_t) 0, zg_lhs_162623);
        int64_t lifted_lambda_res_162625;
        
        if (cond_162624) {
            lifted_lambda_res_162625 = i_171577;
        } else {
            lifted_lambda_res_162625 = (int64_t) -1;
        }
        
        bool cond_162627 = sle64((int64_t) 0, lifted_lambda_res_162625);
        bool cond_t_res_162628 = slt64(lifted_lambda_res_162625, nR_116817);
        bool x_162629 = cond_162627 && cond_t_res_162628;
        int64_t lifted_lambda_res_162630;
        
        if (x_162629) {
            bool index_certs_163187;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftRelational.fut:172:99-102\n   #4  ftRelational.fut:163:3-172:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t lifted_lambda_res_t_res_163188 = ((int64_t *) ext_mem_171912.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162630 = lifted_lambda_res_t_res_163188;
        } else {
            lifted_lambda_res_162630 = (int64_t) 0;
        }
        
        bool lifted_lambda_res_162634 = slt64((int64_t) 1, lifted_lambda_res_162630);
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(lifted_lambda_res_162634);
        int16_t lifted_lambda_res_162647;
        int64_t lifted_lambda_res_162648;
        int64_t lifted_lambda_res_162649;
        
        if (x_162629) {
            bool index_certs_163189;
            
            if (!x_162629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) lifted_lambda_res_162625, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  ftbasics.fut:19:42-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:19:9-64\n   #3  ftSMJ.fut:386:9-387:59\n   #4  ftRelational.fut:172:99-102\n   #5  ftRelational.fut:163:3-172:102\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t lifted_lambda_res_t_res_163190 = ((int16_t *) tR_mem_171818.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163191 = ((int64_t *) ext_mem_171820.mem)[lifted_lambda_res_162625];
            int64_t lifted_lambda_res_t_res_163192 = ((int64_t *) ext_mem_171911.mem)[lifted_lambda_res_162625];
            
            lifted_lambda_res_162647 = lifted_lambda_res_t_res_163190;
            lifted_lambda_res_162648 = lifted_lambda_res_t_res_163191;
            lifted_lambda_res_162649 = lifted_lambda_res_t_res_163192;
        } else {
            lifted_lambda_res_162647 = (int16_t) 0;
            lifted_lambda_res_162648 = (int64_t) -1;
            lifted_lambda_res_162649 = (int64_t) -1;
        }
        
        int64_t defunc_0_op_res_154863 = add64(defunc_0_f_res_162635, scanacc_171567);
        int64_t lifted_lambda_res_154824 = add64(lifted_lambda_res_162630, scanacc_171568);
        int64_t zp_res_154844 = add64(lifted_lambda_res_162630, redout_171571);
        
        ((int64_t *) mem_171914)[i_171577] = defunc_0_op_res_154863;
        ((int64_t *) mem_171916)[i_171577] = lifted_lambda_res_154824;
        ((int16_t *) mem_171918)[i_171577] = lifted_lambda_res_162647;
        ((int64_t *) mem_171920)[i_171577] = lifted_lambda_res_162648;
        ((int64_t *) mem_171922)[i_171577] = lifted_lambda_res_162649;
        ((int64_t *) mem_171924)[i_171577] = defunc_0_f_res_162635;
        ((int64_t *) mem_171926)[i_171577] = lifted_lambda_res_162630;
        
        int64_t scanacc_tmp_172536 = defunc_0_op_res_154863;
        int64_t scanacc_tmp_172537 = lifted_lambda_res_154824;
        int64_t redout_tmp_172540 = zp_res_154844;
        
        scanacc_171567 = scanacc_tmp_172536;
        scanacc_171568 = scanacc_tmp_172537;
        redout_171571 = redout_tmp_172540;
    }
    discard_171585 = scanacc_171567;
    discard_171586 = scanacc_171568;
    defunc_res_163230 = redout_171571;
    if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
        return 1;
    
    int64_t bytes_171977 = (int64_t) 2 * defunc_res_163230;
    int64_t bytes_171979 = (int64_t) 8 * defunc_res_163230;
    bool cond_154864 = nR_116817 == (int64_t) 0;
    bool x_154865 = !cond_154864;
    int64_t tmp_154866 = sub64(nR_116817, (int64_t) 1);
    bool x_154867 = sle64((int64_t) 0, tmp_154866);
    bool y_154868 = slt64(tmp_154866, nR_116817);
    bool bounds_check_154869 = x_154867 && y_154868;
    bool protect_assert_disj_154870 = cond_154864 || bounds_check_154869;
    bool index_certs_154871;
    
    if (!protect_assert_disj_154870) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154866, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:172:99-102\n   #4  ftRelational.fut:163:3-172:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154872;
    
    if (x_154865) {
        int64_t x_163193 = ((int64_t *) mem_171914)[tmp_154866];
        
        m_f_res_154872 = x_163193;
    } else {
        m_f_res_154872 = (int64_t) 0;
    }
    
    int64_t m_154874;
    
    if (cond_154864) {
        m_154874 = (int64_t) 0;
    } else {
        m_154874 = m_f_res_154872;
    }
    
    bool cond_154897 = slt64((int64_t) 0, m_154874);
    int64_t m_154884 = sub64(m_154874, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154886 = slt64(m_154884, nR_116817);
    bool zzero_leq_i_p_m_t_s_154885 = sle64((int64_t) 0, m_154884);
    bool y_154888 = zzero_leq_i_p_m_t_s_154885 && i_p_m_t_s_leq_w_154886;
    bool i_lte_j_154887 = sle64((int64_t) 0, m_154874);
    bool forwards_ok_154889 = i_lte_j_154887 && y_154888;
    bool eq_x_zz_154881 = (int64_t) 0 == m_f_res_154872;
    bool p_and_eq_x_y_154882 = x_154865 && eq_x_zz_154881;
    bool empty_slice_154883 = cond_154864 || p_and_eq_x_y_154882;
    bool ok_or_empty_154890 = empty_slice_154883 || forwards_ok_154889;
    bool index_certs_154891;
    
    if (!ok_or_empty_154890) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154874, "] out of bounds for array of shape [", (long long) nR_116817, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:386:9-387:59\n   #3  ftRelational.fut:172:99-102\n   #4  ftRelational.fut:163:3-172:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172001 = (int64_t) 8 * m_154874;
    
    if (mem_172002_cached_sizze_172879 < bytes_172001) {
        err = lexical_realloc(ctx, &mem_172002, &mem_172002_cached_sizze_172879, bytes_172001);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171926, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154874});
    
    int64_t max_mult_154898;
    
    if (cond_154897) {
        if (mem_172004_cached_sizze_172880 < bytes_171821) {
            err = lexical_realloc(ctx, &mem_172004, &mem_172004_cached_sizze_172880, bytes_171821);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171604 = 0; i_171604 < nR_116817; i_171604++) {
            int64_t eta_p_163199 = ((int64_t *) mem_171924)[i_171604];
            int64_t eta_p_163200 = ((int64_t *) mem_171914)[i_171604];
            bool cond_163201 = eta_p_163199 == (int64_t) 1;
            int64_t lifted_lambda_res_163202;
            
            if (cond_163201) {
                int64_t lifted_lambda_res_t_res_163203 = sub64(eta_p_163200, (int64_t) 1);
                
                lifted_lambda_res_163202 = lifted_lambda_res_t_res_163203;
            } else {
                lifted_lambda_res_163202 = (int64_t) -1;
            }
            ((int64_t *) mem_172004)[i_171604] = lifted_lambda_res_163202;
        }
        for (int64_t write_iter_171606 = 0; write_iter_171606 < nR_116817; write_iter_171606++) {
            int64_t write_iv_171608 = ((int64_t *) mem_172004)[write_iter_171606];
            int64_t write_iv_171609 = ((int64_t *) mem_171926)[write_iter_171606];
            
            if (sle64((int64_t) 0, write_iv_171608) && slt64(write_iv_171608, m_154874)) {
                ((int64_t *) mem_172002)[write_iv_171608] = write_iv_171609;
            }
        }
        
        int64_t defunc_0_reduce_res_163213;
        int64_t redout_171611 = (int64_t) -9223372036854775808;
        
        for (int64_t i_171612 = 0; i_171612 < m_154874; i_171612++) {
            int64_t x_163214 = ((int64_t *) mem_172002)[i_171612];
            int64_t max_res_163217 = smax64(x_163214, redout_171611);
            int64_t redout_tmp_172548 = max_res_163217;
            
            redout_171611 = redout_tmp_172548;
        }
        defunc_0_reduce_res_163213 = redout_171611;
        max_mult_154898 = defunc_0_reduce_res_163213;
    } else {
        max_mult_154898 = (int64_t) 1;
    }
    
    bool bounds_invalid_upwards_154904 = slt64(max_mult_154898, (int64_t) 1);
    bool valid_154906 = !bounds_invalid_upwards_154904;
    bool range_valid_c_154907;
    
    if (!valid_154906) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) max_mult_154898, " is invalid.", "-> #0  ftSMJ.fut:360:18-30\n   #1  ftSMJ.fut:386:9-387:59\n   #2  ftRelational.fut:172:99-102\n   #3  ftRelational.fut:163:3-172:102\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (mem_171970_cached_sizze_172878 < bytes_171821) {
        err = lexical_realloc(ctx, &mem_171970, &mem_171970_cached_sizze_172878, bytes_171821);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171589 = 0; i_171589 < nR_116817; i_171589++) {
        int64_t eta_p_162530 = ((int64_t *) mem_171926)[i_171589];
        int64_t zv_lhs_162532 = add64((int64_t) -1, i_171589);
        int64_t tmp_162533 = smod64(zv_lhs_162532, nR_116817);
        int64_t lifted_lambda_res_162534 = ((int64_t *) mem_171916)[tmp_162533];
        bool cond_162536 = i_171589 == (int64_t) 0;
        int64_t lifted_lambda_res_162537;
        
        if (cond_162536) {
            lifted_lambda_res_162537 = (int64_t) 0;
        } else {
            lifted_lambda_res_162537 = lifted_lambda_res_162534;
        }
        
        bool cond_162539 = slt64((int64_t) 0, eta_p_162530);
        int64_t lifted_lambda_res_162540;
        
        if (cond_162539) {
            lifted_lambda_res_162540 = lifted_lambda_res_162537;
        } else {
            lifted_lambda_res_162540 = (int64_t) -1;
        }
        ((int64_t *) mem_171970)[i_171589] = lifted_lambda_res_162540;
    }
    if (memblock_alloc(ctx, &mem_171978, bytes_171977, "mem_171978")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172550 = 0; nest_i_172550 < defunc_res_163230; nest_i_172550++) {
        ((int16_t *) mem_171978.mem)[nest_i_172550] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171980, bytes_171979, "mem_171980")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172551 = 0; nest_i_172551 < defunc_res_163230; nest_i_172551++) {
        ((int64_t *) mem_171980.mem)[nest_i_172551] = (int64_t) -1;
    }
    if (memblock_alloc(ctx, &mem_171982, bytes_171979, "mem_171982")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172552 = 0; nest_i_172552 < defunc_res_163230; nest_i_172552++) {
        ((int64_t *) mem_171982.mem)[nest_i_172552] = (int64_t) -1;
    }
    for (int64_t write_iter_171591 = 0; write_iter_171591 < nR_116817; write_iter_171591++) {
        int64_t write_iv_171595 = ((int64_t *) mem_171970)[write_iter_171591];
        int16_t write_iv_171596 = ((int16_t *) mem_171918)[write_iter_171591];
        int64_t write_iv_171597 = ((int64_t *) mem_171920)[write_iter_171591];
        int64_t write_iv_171598 = ((int64_t *) mem_171922)[write_iter_171591];
        
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int16_t *) mem_171978.mem)[write_iv_171595] = write_iv_171596;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171980.mem)[write_iv_171595] = write_iv_171597;
        }
        if (sle64((int64_t) 0, write_iv_171595) && slt64(write_iv_171595, defunc_res_163230)) {
            ((int64_t *) mem_171982.mem)[write_iv_171595] = write_iv_171598;
        }
    }
    
    int64_t distance_154905 = sub64(max_mult_154898, (int64_t) 1);
    
    if (memblock_set(ctx, &mem_param_172019, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172022, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_172025, &mem_171982, "mem_171982") != 0)
        return 1;
    for (int64_t i_154911 = 0; i_154911 < distance_154905; i_154911++) {
        int64_t index_primexp_154915 = add64((int64_t) 1, i_154911);
        
        if (memblock_alloc(ctx, &mem_172027, bytes_171979, "mem_172027")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172027.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172025.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172029, bytes_171979, "mem_172029")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_172029.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_172022.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        if (memblock_alloc(ctx, &mem_172031, bytes_171977, "mem_172031")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_172031.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_172019.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
        for (int64_t write_iter_171613 = 0; write_iter_171613 < nR_116817; write_iter_171613++) {
            int64_t write_iv_171618 = ((int64_t *) mem_171922)[write_iter_171613];
            int16_t write_iv_171619 = ((int16_t *) mem_171918)[write_iter_171613];
            int64_t write_iv_171620 = ((int64_t *) mem_171920)[write_iter_171613];
            int64_t zg_lhs_163127 = ((int64_t *) mem_171926)[write_iter_171613];
            bool cond_163128 = slt64(index_primexp_154915, zg_lhs_163127);
            int64_t lifted_lambda_res_163129;
            
            if (cond_163128) {
                int64_t zp_lhs_163223 = ((int64_t *) mem_171970)[write_iter_171613];
                int64_t lifted_lambda_res_t_res_163224 = add64(index_primexp_154915, zp_lhs_163223);
                
                lifted_lambda_res_163129 = lifted_lambda_res_t_res_163224;
            } else {
                lifted_lambda_res_163129 = (int64_t) -1;
            }
            
            int64_t tmp_163133 = add64(index_primexp_154915, write_iv_171618);
            
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int16_t *) mem_172031.mem)[lifted_lambda_res_163129] = write_iv_171619;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172029.mem)[lifted_lambda_res_163129] = write_iv_171620;
            }
            if (sle64((int64_t) 0, lifted_lambda_res_163129) && slt64(lifted_lambda_res_163129, defunc_res_163230)) {
                ((int64_t *) mem_172027.mem)[lifted_lambda_res_163129] = tmp_163133;
            }
        }
        if (memblock_set(ctx, &mem_param_tmp_172556, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172557, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172558, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172019, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172022, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_172025, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_172058, &mem_param_172019, "mem_param_172019") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172057, &mem_param_172022, "mem_param_172022") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172056, &mem_param_172025, "mem_param_172025") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172060, bytes_171977, "mem_172060")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_172060.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_172058.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172062, bytes_171979, "mem_172062")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172062.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172057.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172064, bytes_171979, "mem_172064")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_172064.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172056.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {defunc_res_163230});
    if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172062, "mem_172062") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172064, "mem_172064") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172502, &mem_172060, "mem_172060") != 0)
        return 1;
    prim_out_172503 = defunc_res_163230;
    if (memblock_set(ctx, &*mem_out_p_172867, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172868, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172869, &mem_out_172502, "mem_out_172502") != 0)
        return 1;
    *out_prim_out_172870 = prim_out_172503;
    
  cleanup:
    {
        free(mem_171914);
        free(mem_171916);
        free(mem_171918);
        free(mem_171920);
        free(mem_171922);
        free(mem_171924);
        free(mem_171926);
        free(mem_171970);
        free(mem_172002);
        free(mem_172004);
        if (memblock_unref(ctx, &mem_172064, "mem_172064") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172062, "mem_172062") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172060, "mem_172060") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172558, "mem_param_tmp_172558") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172557, "mem_param_tmp_172557") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172556, "mem_param_tmp_172556") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172031, "mem_172031") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172029, "mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172027, "mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172025, "mem_param_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172022, "mem_param_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_172019, "mem_param_172019") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172056, "ext_mem_172056") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172057, "ext_mem_172057") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172058, "ext_mem_172058") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171980, "mem_171980") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171906, "mem_171906") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171904, "mem_171904") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171872, "mem_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171870, "mem_171870") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172530, "mem_param_tmp_172530") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171859, "mem_171859") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171857, "mem_param_171857") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171868, "ext_mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171845, "mem_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171843, "mem_param_171843") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171854, "ext_mem_171854") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171887, "ext_mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171890, "ext_mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171896, "ext_mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171840, "mem_param_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171901, "ext_mem_171901") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171902, "ext_mem_171902") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171834, "mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171832, "mem_171832") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171911, "ext_mem_171911") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171912, "ext_mem_171912") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171824, "mem_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171820, "ext_mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172502, "mem_out_172502") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_int_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172881, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149774, int64_t group_no_149775)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_162322 = slt64(group_no_149775, (int64_t) 0);
    bool valid_162323 = !bounds_invalid_upwards_162322;
    bool range_valid_c_162324;
    
    if (!valid_162323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149775, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:49-51\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:340:21-46\n   #4  ftRelational.fut:340:5-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171820 = (int64_t) 4 * group_no_149775;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_149775; nest_i_172501++) {
        ((int32_t *) mem_171821.mem)[nest_i_172501] = 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_149774; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int32_t pixel_171548 = ((int32_t *) eta_p_mem_171819.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(group_no_149775, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            int32_t read_hist_171553 = ((int32_t *) mem_171821.mem)[pixel_171547];
            int32_t zp_res_162329 = add32(pixel_171548, read_hist_171553);
            
            ((int32_t *) mem_171821.mem)[pixel_171547] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172881, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_int_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172882, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_149851, int64_t group_no_149852)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 4 * group_no_149852;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_149852; nest_i_172501++) {
        ((int32_t *) mem_171822.mem)[nest_i_172501] = 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_149851; iter_171545++) {
        int32_t pixel_171547 = ((int32_t *) eta_p_mem_171819.mem)[iter_171545];
        int32_t pixel_171548 = ((int32_t *) eta_p_mem_171820.mem)[iter_171545];
        int64_t pixel_171549 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int32_t zt_res_162518 = mul32(pixel_171547, pixel_171548);
        bool less_than_zzero_171550 = slt64(pixel_171549, (int64_t) 0);
        bool greater_than_sizze_171551 = sle64(group_no_149852, pixel_171549);
        bool outside_bounds_dim_171552 = less_than_zzero_171550 || greater_than_sizze_171551;
        
        if (!outside_bounds_dim_171552) {
            int32_t read_hist_171554 = ((int32_t *) mem_171822.mem)[pixel_171549];
            int32_t zp_res_162329 = add32(zt_res_162518, read_hist_171554);
            
            ((int32_t *) mem_171822.mem)[pixel_171549] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172882, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_long_sum(struct futhark_context *ctx, struct memblock *mem_out_p_172883, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149980, int64_t group_no_149981)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_162322 = slt64(group_no_149981, (int64_t) 0);
    bool valid_162323 = !bounds_invalid_upwards_162322;
    bool range_valid_c_162324;
    
    if (!valid_162323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149981, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:49-51\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:343:22-48\n   #4  ftRelational.fut:343:5-48\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171820 = (int64_t) 8 * group_no_149981;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_149981; nest_i_172501++) {
        ((int64_t *) mem_171821.mem)[nest_i_172501] = (int64_t) 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_149980; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int64_t pixel_171548 = ((int64_t *) eta_p_mem_171819.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(group_no_149981, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            int64_t read_hist_171553 = ((int64_t *) mem_171821.mem)[pixel_171547];
            int64_t zp_res_162329 = add64(pixel_171548, read_hist_171553);
            
            ((int64_t *) mem_171821.mem)[pixel_171547] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172883, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_long_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_172884, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_150047, int64_t group_no_150048)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 8 * group_no_150048;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_150048; nest_i_172501++) {
        ((int64_t *) mem_171822.mem)[nest_i_172501] = (int64_t) 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_150047; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171819.mem)[iter_171545];
        int64_t pixel_171548 = ((int64_t *) eta_p_mem_171820.mem)[iter_171545];
        int64_t pixel_171549 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int64_t zt_res_162518 = mul64(pixel_171547, pixel_171548);
        bool less_than_zzero_171550 = slt64(pixel_171549, (int64_t) 0);
        bool greater_than_sizze_171551 = sle64(group_no_150048, pixel_171549);
        bool outside_bounds_dim_171552 = less_than_zzero_171550 || greater_than_sizze_171551;
        
        if (!outside_bounds_dim_171552) {
            int64_t read_hist_171554 = ((int64_t *) mem_171822.mem)[pixel_171549];
            int64_t zp_res_162329 = add64(zt_res_162518, read_hist_171554);
            
            ((int64_t *) mem_171822.mem)[pixel_171549] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172884, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_max_idx(struct futhark_context *ctx, int64_t *out_prim_out_172885, struct memblock eta_p_mem_171818, int64_t nz2080U_80076)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_res_162514;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_80076; i_171546++) {
        int64_t x_153358 = ((int64_t *) eta_p_mem_171818.mem)[i_171546];
        int64_t max_res_153361 = smax64(x_153358, redout_171545);
        int64_t redout_tmp_172501 = max_res_153361;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172885 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_maximum_double(struct futhark_context *ctx, double *out_prim_out_172886, struct memblock eta_p_mem_171818, int64_t nz2080U_80058)
{
    (void) ctx;
    
    int err = 0;
    double prim_out_172500;
    double defunc_0_reduce_res_162514;
    double redout_171545 = -INFINITY;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_80058; i_171546++) {
        double x_153241 = ((double *) eta_p_mem_171818.mem)[i_171546];
        double max_res_153244 = fmax64(x_153241, redout_171545);
        double redout_tmp_172501 = max_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172886 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_maximum_float(struct futhark_context *ctx, float *out_prim_out_172887, struct memblock eta_p_mem_171818, int64_t nz2080U_79990)
{
    (void) ctx;
    
    int err = 0;
    float prim_out_172500;
    float defunc_0_reduce_res_162514;
    float redout_171545 = -INFINITY;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79990; i_171546++) {
        float x_153241 = ((float *) eta_p_mem_171818.mem)[i_171546];
        float max_res_153244 = fmax32(x_153241, redout_171545);
        float redout_tmp_172501 = max_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172887 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_maximum_int(struct futhark_context *ctx, int32_t *out_prim_out_172888, struct memblock eta_p_mem_171818, int64_t nz2080U_79851)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_172500;
    int32_t defunc_0_reduce_res_162514;
    int32_t redout_171545 = -2147483648;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79851; i_171546++) {
        int32_t x_153241 = ((int32_t *) eta_p_mem_171818.mem)[i_171546];
        int32_t max_res_153244 = smax32(x_153241, redout_171545);
        int32_t redout_tmp_172501 = max_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172888 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_maximum_long(struct futhark_context *ctx, int64_t *out_prim_out_172889, struct memblock eta_p_mem_171818, int64_t nz2080U_79922)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_res_162514;
    int64_t redout_171545 = (int64_t) -9223372036854775808;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79922; i_171546++) {
        int64_t x_153241 = ((int64_t *) eta_p_mem_171818.mem)[i_171546];
        int64_t max_res_153244 = smax64(x_153241, redout_171545);
        int64_t redout_tmp_172501 = max_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172889 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_maximum_short(struct futhark_context *ctx, int16_t *out_prim_out_172890, struct memblock eta_p_mem_171818, int64_t nz2080U_79780)
{
    (void) ctx;
    
    int err = 0;
    int16_t prim_out_172500;
    int16_t defunc_0_reduce_res_162514;
    int16_t redout_171545 = (int16_t) -32768;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79780; i_171546++) {
        int16_t x_153241 = ((int16_t *) eta_p_mem_171818.mem)[i_171546];
        int16_t max_res_153244 = smax16(x_153241, redout_171545);
        int16_t redout_tmp_172501 = max_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_172890 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_172891, struct memblock *mem_out_p_172892, struct memblock xs_mem_171818, int64_t n_113912, int64_t incr_113913)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172893 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172894 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172895 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172896 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172897 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172898 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172899 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172900 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172901 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172902 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_113912;
    bool cond_161783 = sle64(n_113912, (int64_t) 1);
    int64_t zs_lhs_161784 = sub64(n_113912, (int64_t) 1);
    int64_t zp_rhs_161785 = sdiv_safe64(zs_lhs_161784, (int64_t) 20);
    int64_t min_num_blocks_161786 = add64((int64_t) 1, zp_rhs_161785);
    bool loop_cond_161787 = slt64((int64_t) 1, min_num_blocks_161786);
    bool smallest_pow_2_geq_than_res_161788;
    int64_t smallest_pow_2_geq_than_res_161789;
    bool loop_while_161790;
    int64_t x_161791;
    
    loop_while_161790 = loop_cond_161787;
    x_161791 = (int64_t) 1;
    while (loop_while_161790) {
        int64_t loopres_161792 = mul64((int64_t) 2, x_161791);
        bool loop_cond_161793 = slt64(loopres_161792, min_num_blocks_161786);
        bool loop_while_tmp_172502 = loop_cond_161793;
        int64_t x_tmp_172503 = loopres_161792;
        
        loop_while_161790 = loop_while_tmp_172502;
        x_161791 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161788 = loop_while_161790;
    smallest_pow_2_geq_than_res_161789 = x_161791;
    
    bool zzero_161794 = smallest_pow_2_geq_than_res_161789 == (int64_t) 0;
    bool nonzzero_161795 = !zzero_161794;
    bool protect_assert_disj_161796 = cond_161783 || nonzzero_161795;
    bool nonzzero_cert_161797;
    
    if (!protect_assert_disj_161796) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:159:31-35\n   #5  ftRelational.fut:158:5-159:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161798 = sdiv_safe64(zs_lhs_161784, smallest_pow_2_geq_than_res_161789);
    int64_t block_sizze_161799 = add64((int64_t) 1, zp_rhs_161798);
    bool y_161805 = slt64((int64_t) 0, n_113912);
    bool protect_assert_disj_172415 = cond_161783 || y_161805;
    bool index_certs_161806;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_113912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:159:31-35\n   #5  ftRelational.fut:158:5-159:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161820 = slt64(smallest_pow_2_geq_than_res_161789, (int64_t) 0);
    bool valid_161821 = !bounds_invalid_upwards_161820;
    bool protect_assert_disj_172423 = cond_161783 || valid_161821;
    bool range_valid_c_161822;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161789, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:159:31-35\n   #6  ftRelational.fut:158:5-159:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161824 = slt64(block_sizze_161799, (int64_t) 0);
    bool valid_161825 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_172425 = cond_161783 || valid_161825;
    bool range_valid_c_161826;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161799, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161828 = sle64(block_sizze_161799, (int64_t) 1);
    int64_t tmp_161829 = sub64(block_sizze_161799, (int64_t) 2);
    bool bounds_invalid_upwards_161830 = slt64(tmp_161829, (int64_t) 0);
    bool valid_161832 = !bounds_invalid_upwards_161830;
    bool protect_assert_disj_161833 = cond_161828 || valid_161832;
    bool protect_assert_disj_172427 = cond_161783 || protect_assert_disj_161833;
    bool range_valid_c_161834;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161829, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_16384(ctx, &ext_mem_171819, xs_mem_171818, n_113912, incr_113913) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_113912; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161800 = smallest_pow_2_geq_than_res_161789 * block_sizze_161799;
    bool x_172410 = !cond_161783;
    int64_t greatest_divisor_leq_than_arg1_161803 = mul64((int64_t) 2, block_sizze_161799);
    int64_t merge_block_sizze_161804;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161803) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161804 = x_172412;
    } else {
        merge_block_sizze_161804 = (int64_t) 0;
    }
    
    double reduce_arg1_161807;
    
    if (x_172410) {
        double x_172416 = ((double *) xs_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161807 = x_172416;
    } else {
        reduce_arg1_161807 = 0.0;
    }
    
    double defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        double x_172418;
        int64_t x_172419;
        double redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161807;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_113912; i_171547++) {
            double x_161811 = ((double *) xs_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161817 = redout_171545 <= x_161811;
            double defunc_0_op_res_161818;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161818 = x_161811;
            } else {
                defunc_0_op_res_161818 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161819;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161819 = i_171547;
            } else {
                defunc_0_op_res_161819 = redout_171546;
            }
            
            double redout_tmp_172506 = defunc_0_op_res_161818;
            int64_t redout_tmp_172507 = defunc_0_op_res_161819;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0.0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161831 = add64((int64_t) 1, tmp_161829);
    int64_t binop_x_171822 = (int64_t) 8 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171823 = block_sizze_161799 * binop_x_171822;
    int64_t bytes_171836 = (int64_t) 8 * block_sizze_161799;
    bool loop_cond_161906 = slt64(block_sizze_161799, flat_dim_161800);
    bool zzero_161907 = merge_block_sizze_161804 == (int64_t) 0;
    bool nonzzero_161908 = !zzero_161907;
    
    if (cond_161783) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172893 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172893, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172894 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172894, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172895 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172895, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172896 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172896, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161789; i_171559++) {
            int64_t zp_lhs_161838 = mul64(block_sizze_161799, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161799; i_171552++) {
                int64_t k_161842 = add64(zp_lhs_161838, i_171552);
                bool cond_161843 = slt64(k_161842, n_113912);
                double lifted_lambda_res_161844;
                int64_t lifted_lambda_res_161845;
                
                if (cond_161843) {
                    bool x_162514 = sle64((int64_t) 0, k_161842);
                    bool bounds_check_162515 = cond_161843 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161842, "] out of bounds for array of shape [", (long long) n_113912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_162517 = ((double *) xs_mem_171818.mem)[k_161842];
                    
                    lifted_lambda_res_161844 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161845 = k_161842;
                } else {
                    lifted_lambda_res_161844 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161845 = defunc_0_reduce_res_162662;
                }
                ((double *) mem_171837)[i_171552] = lifted_lambda_res_161844;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161845;
            }
            if (!cond_161828) {
                for (int64_t i_161855 = 0; i_161855 < distance_161831; i_161855++) {
                    int64_t gt_arg1_161858 = add64((int64_t) 1, i_161855);
                    bool x_161859 = sle64((int64_t) 0, gt_arg1_161858);
                    bool y_161860 = slt64(gt_arg1_161858, block_sizze_161799);
                    bool bounds_check_161861 = x_161859 && y_161860;
                    bool index_certs_161862;
                    
                    if (!bounds_check_161861) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161858, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161864 = slt64(i_161855, block_sizze_161799);
                    bool index_certs_161865;
                    
                    if (!y_161864) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161855, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_161863 = ((double *) mem_171837)[gt_arg1_161858];
                    double gt_arg0_161866 = ((double *) mem_171837)[i_161855];
                    bool defunc_0_leq_res_161867 = gt_arg0_161866 <= gt_arg1_161863;
                    bool defunc_0_lifted_gt_res_161868 = !defunc_0_leq_res_161867;
                    bool s_161869;
                    int64_t s_161872;
                    bool loop_while_161873;
                    int64_t j_161876;
                    
                    loop_while_161873 = defunc_0_lifted_gt_res_161868;
                    j_161876 = i_161855;
                    while (loop_while_161873) {
                        bool x_161877 = sle64((int64_t) 0, j_161876);
                        bool y_161878 = slt64(j_161876, block_sizze_161799);
                        bool bounds_check_161879 = x_161877 && y_161878;
                        bool index_certs_161880;
                        
                        if (!bounds_check_161879) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161876, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161883 = add64((int64_t) 1, j_161876);
                        bool x_161884 = sle64((int64_t) 0, copy_arg0_161883);
                        bool y_161885 = slt64(copy_arg0_161883, block_sizze_161799);
                        bool bounds_check_161886 = x_161884 && y_161885;
                        bool index_certs_161887;
                        
                        if (!bounds_check_161886) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161883, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_161881 = ((double *) mem_171837)[j_161876];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171839)[j_161876];
                        double copy_arg0_161888 = ((double *) mem_171837)[copy_arg0_161883];
                        int64_t copy_arg0_161889 = ((int64_t *) mem_171839)[copy_arg0_161883];
                        
                        ((double *) mem_171837)[j_161876] = copy_arg0_161888;
                        ((int64_t *) mem_171839)[j_161876] = copy_arg0_161889;
                        ((double *) mem_171837)[copy_arg0_161883] = copy_arg0_161881;
                        ((int64_t *) mem_171839)[copy_arg0_161883] = copy_arg0_161882;
                        
                        int64_t tmp_161894 = sub64(j_161876, (int64_t) 1);
                        bool cond_161895 = sle64((int64_t) 0, tmp_161894);
                        bool loop_cond_161896;
                        
                        if (cond_161895) {
                            bool y_162519 = slt64(tmp_161894, block_sizze_161799);
                            bool bounds_check_162520 = cond_161895 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161894, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_162518 = ((double *) mem_171837)[j_161876];
                            double gt_arg0_162522 = ((double *) mem_171837)[tmp_161894];
                            bool defunc_0_leq_res_162523 = gt_arg0_162522 <= gt_arg1_162518;
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161896 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161896 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161896;
                        int64_t j_tmp_172517 = tmp_161894;
                        
                        loop_while_161873 = loop_while_tmp_172514;
                        j_161876 = j_tmp_172517;
                    }
                    s_161869 = loop_while_161873;
                    s_161872 = j_161876;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171824, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        if (memblock_alloc(ctx, &mem_171896, bytes_171823, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        
        int64_t data_161909;
        bool data_161910;
        int64_t data_161913;
        int64_t loop_dz2084Uz2082U_161914;
        bool loop_while_161915;
        int64_t stride_161918;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161914 = flat_dim_161800;
        loop_while_161915 = loop_cond_161906;
        stride_161918 = block_sizze_161799;
        while (loop_while_161915) {
            int64_t next_stride_161919 = mul64((int64_t) 2, stride_161918);
            bool zzero_161920 = next_stride_161919 == (int64_t) 0;
            bool nonzzero_161921 = !zzero_161920;
            bool nonzzero_cert_161922;
            
            if (!nonzzero_161921) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:159:31-35\n   #5  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161923 = sdiv64(flat_dim_161800, next_stride_161919);
            bool bounds_invalid_upwards_161924 = slt64(num_merges_161923, (int64_t) 0);
            bool valid_161925 = !bounds_invalid_upwards_161924;
            bool range_valid_c_161926;
            
            if (!valid_161925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161923, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:159:31-35\n   #6  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161928 = sub64(next_stride_161919, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161929 = sle64((int64_t) 0, m_161928);
            bool cond_161931 = slt64(next_stride_161919, (int64_t) 10);
            bool protect_assert_disj_161932 = nonzzero_161908 || cond_161931;
            bool nonzzero_cert_161933;
            
            if (!protect_assert_disj_161932) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161934 = smod_safe64(next_stride_161919, merge_block_sizze_161804);
            bool num_blocks_161935 = zeze_lhs_161934 == (int64_t) 0;
            bool protect_assert_disj_161936 = cond_161931 || num_blocks_161935;
            bool assert_c_161937;
            
            if (!protect_assert_disj_161936) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161939 = sdiv_safe64(next_stride_161919, merge_block_sizze_161804);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940 = add64((int64_t) 1, num_blocks_161939);
            int64_t j_m_i_161941 = sub64(next_stride_161919, stride_161918);
            int64_t flat_dim_161942 = merge_block_sizze_161804 * num_blocks_161939;
            bool bounds_invalid_upwards_161943 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, (int64_t) 0);
            bool empty_slice_161944 = j_m_i_161941 == (int64_t) 0;
            int64_t m_161945 = sub64(j_m_i_161941, (int64_t) 1);
            bool zzero_lte_i_161946 = sle64((int64_t) 0, stride_161918);
            bool i_lte_j_161947 = sle64(stride_161918, next_stride_161919);
            bool empty_slice_161948 = stride_161918 == (int64_t) 0;
            int64_t m_161949 = sub64(stride_161918, (int64_t) 1);
            bool bounds_invalid_upwards_161950 = slt64(num_blocks_161939, (int64_t) 0);
            bool cond_161951 = slt64((int64_t) 0, stride_161918);
            bool valid_161952 = !bounds_invalid_upwards_161943;
            int64_t i_p_m_t_s_161953 = add64(stride_161918, m_161945);
            bool zzero_leq_i_p_m_t_s_161954 = sle64((int64_t) 0, m_161949);
            bool i_p_m_t_s_leq_w_161955 = slt64(m_161949, next_stride_161919);
            bool valid_161956 = !bounds_invalid_upwards_161950;
            bool i_p_m_t_s_leq_w_161957 = slt64(m_161928, flat_dim_161942);
            bool y_161958 = slt64((int64_t) 0, j_m_i_161941);
            bool protect_assert_disj_161959 = cond_161931 || valid_161952;
            bool range_valid_c_161960;
            
            if (!protect_assert_disj_161959) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161961 = sle64((int64_t) 0, i_p_m_t_s_161953);
            bool i_p_m_t_s_leq_w_161962 = slt64(i_p_m_t_s_161953, next_stride_161919);
            bool y_161963 = zzero_leq_i_p_m_t_s_161954 && i_p_m_t_s_leq_w_161955;
            bool protect_assert_disj_161964 = cond_161931 || valid_161956;
            bool range_valid_c_161965;
            
            if (!protect_assert_disj_161964) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161939, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161966 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_161957;
            bool y_161967 = zzero_lte_i_161946 && i_p_m_t_s_leq_w_161962;
            bool forwards_ok_161968 = zzero_lte_i_161946 && y_161963;
            bool ok_or_empty_161969 = zzero_161920 || y_161966;
            bool protect_assert_disj_161970 = cond_161951 || y_161958;
            bool y_161971 = zzero_leq_i_p_m_t_s_161961 && y_161967;
            bool ok_or_empty_161972 = empty_slice_161948 || forwards_ok_161968;
            bool protect_assert_disj_161973 = cond_161931 || ok_or_empty_161969;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) flat_dim_161942, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161975 = !cond_161931;
            bool protect_assert_disj_161976 = protect_assert_disj_161970 || loop_not_taken_161975;
            bool index_certs_161977;
            
            if (!protect_assert_disj_161976) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161978 = i_lte_j_161947 && y_161971;
            bool protect_assert_disj_161979 = cond_161931 || ok_or_empty_161972;
            bool index_certs_161980;
            
            if (!protect_assert_disj_161979) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161981 = ok_or_empty_161972 || loop_not_taken_161975;
            bool index_certs_161982;
            
            if (!protect_assert_disj_161981) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161983 = empty_slice_161944 || forwards_ok_161978;
            bool protect_assert_disj_161984 = cond_161931 || ok_or_empty_161983;
            bool index_certs_161985;
            
            if (!protect_assert_disj_161984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161986 = loop_not_taken_161975 || ok_or_empty_161983;
            bool index_certs_161987;
            
            if (!protect_assert_disj_161986) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 8 * num_merges_161923;
            int64_t bytes_171905 = next_stride_161919 * binop_x_171904;
            bool i_lte_j_161930 = sle64((int64_t) 0, next_stride_161919);
            
            if (mem_171906_cached_sizze_172897 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172897, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172898 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172898, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940;
            int64_t binop_x_171934 = (int64_t) 8 * num_blocks_161939;
            int64_t bytes_171935 = merge_block_sizze_161804 * binop_x_171934;
            int64_t bytes_171980 = (int64_t) 16 * stride_161918;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161923; i_171580++) {
                int64_t start_161991 = mul64(next_stride_161919, i_171580);
                int64_t j_m_i_161992 = sub64(loop_dz2084Uz2082U_161914, start_161991);
                bool empty_slice_161993 = j_m_i_161992 == (int64_t) 0;
                int64_t m_161994 = sub64(j_m_i_161992, (int64_t) 1);
                int64_t i_p_m_t_s_161995 = add64(start_161991, m_161994);
                bool zzero_leq_i_p_m_t_s_161996 = sle64((int64_t) 0, i_p_m_t_s_161995);
                bool i_p_m_t_s_leq_w_161997 = slt64(i_p_m_t_s_161995, loop_dz2084Uz2082U_161914);
                bool zzero_lte_i_161998 = sle64((int64_t) 0, start_161991);
                bool i_lte_j_161999 = sle64(start_161991, loop_dz2084Uz2082U_161914);
                bool y_162000 = i_p_m_t_s_leq_w_161997 && zzero_lte_i_161998;
                bool y_162001 = zzero_leq_i_p_m_t_s_161996 && y_162000;
                bool forwards_ok_162002 = i_lte_j_161999 && y_162001;
                bool ok_or_empty_162003 = empty_slice_161993 || forwards_ok_162002;
                bool index_certs_162004;
                
                if (!ok_or_empty_162003) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161991, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161914, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_162005 = slt64(m_161928, j_m_i_161992);
                bool y_162006 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_162005;
                bool forwards_ok_162007 = i_lte_j_161930 && y_162006;
                bool ok_or_empty_162008 = zzero_161920 || forwards_ok_162007;
                bool index_certs_162009;
                
                if (!ok_or_empty_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) j_m_i_161992, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:159:31-35\n   #8  ftRelational.fut:158:5-159:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161931) {
                    double dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161951) {
                        double head_res_162552 = ((double *) mem_param_171900.mem)[start_161991];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161991];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161918 + start_161991;
                        double head_res_162555 = ((double *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161919; nest_i_172527++) {
                        ((double *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171980, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161919; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161919; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161941;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161918);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161941);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161918 + j_162566;
                                int64_t slice_162576 = start_161991 + slice_162575;
                                double leq_arg1_162577 = ((double *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161991 + i_162563;
                                double leq_arg0_162582 = ((double *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = leq_arg0_162582 <= leq_arg1_162577;
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        double loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161918);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161991 + i_162563;
                            double tmp_162593 = ((double *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161941);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:159:31-35\n   #9  ftRelational.fut:158:5-159:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161918 + j_162566;
                            int64_t slice_162600 = start_161991 + slice_162599;
                            double tmp_162601 = ((double *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((double *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172899 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172899, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172900 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172900, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940; i_171566++) {
                        int64_t split_count_arg3_162071 = mul64(merge_block_sizze_161804, i_171566);
                        int64_t defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162072, &defunc_0_split_count_res_162073, &defunc_0_split_count_res_162074, &defunc_0_split_count_res_162075, &defunc_0_split_count_res_162076, (int64_t) 0, stride_161918, (int64_t) 0, j_m_i_161941, split_count_arg3_162071) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162077 = slt64((int64_t) 0, defunc_0_split_count_res_162076);
                        bool defunc_0_split_count_res_162078;
                        int64_t defunc_0_split_count_res_162079;
                        int64_t defunc_0_split_count_res_162080;
                        int64_t defunc_0_split_count_res_162081;
                        int64_t defunc_0_split_count_res_162082;
                        int64_t defunc_0_split_count_res_162083;
                        bool loop_while_162084;
                        int64_t ss_162085;
                        int64_t ss_162086;
                        int64_t tt_162087;
                        int64_t tt_162088;
                        int64_t count_162089;
                        
                        loop_while_162084 = loop_cond_162077;
                        ss_162085 = defunc_0_split_count_res_162072;
                        ss_162086 = defunc_0_split_count_res_162073;
                        tt_162087 = defunc_0_split_count_res_162074;
                        tt_162088 = defunc_0_split_count_res_162075;
                        count_162089 = defunc_0_split_count_res_162076;
                        while (loop_while_162084) {
                            int64_t zlze_lhs_162090 = sub64(ss_162086, ss_162085);
                            bool cond_162091 = sle64(zlze_lhs_162090, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162092;
                            int64_t defunc_0_lifted_step_res_162093;
                            int64_t defunc_0_lifted_step_res_162094;
                            int64_t defunc_0_lifted_step_res_162095;
                            
                            if (cond_162091) {
                                int64_t tmp_162605 = add64(tt_162087, count_162089);
                                
                                defunc_0_lifted_step_res_162092 = ss_162085;
                                defunc_0_lifted_step_res_162093 = tmp_162605;
                                defunc_0_lifted_step_res_162094 = tt_162088;
                                defunc_0_lifted_step_res_162095 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162097 = sub64(tt_162088, tt_162087);
                                bool cond_162098 = sle64(zlze_lhs_162097, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162099;
                                int64_t defunc_0_lifted_step_res_f_res_162100;
                                int64_t defunc_0_lifted_step_res_f_res_162101;
                                int64_t defunc_0_lifted_step_res_f_res_162102;
                                
                                if (cond_162098) {
                                    int64_t tmp_162606 = add64(ss_162085, count_162089);
                                    
                                    defunc_0_lifted_step_res_f_res_162099 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162100 = tt_162087;
                                    defunc_0_lifted_step_res_f_res_162101 = tt_162088;
                                    defunc_0_lifted_step_res_f_res_162102 = (int64_t) 0;
                                } else {
                                    bool cond_162104 = count_162089 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162105;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162106;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162107;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162108;
                                    
                                    if (cond_162104) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162085);
                                        bool y_162609 = slt64(ss_162085, stride_161918);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162085, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:159:31-35\n   #13 ftRelational.fut:158:5-159:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162087);
                                        bool y_162615 = slt64(tt_162087, j_m_i_161941);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162087, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:159:31-35\n   #13 ftRelational.fut:158:5-159:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161991 + ss_162085;
                                        double leq_arg1_162613 = ((double *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161918 + tt_162087;
                                        int64_t slice_162619 = start_161991 + slice_162618;
                                        double leq_arg0_162620 = ((double *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = leq_arg0_162620 <= leq_arg1_162613;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162087);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162085;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162085);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162087;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = tt_162088;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = (int64_t) 0;
                                    } else {
                                        int64_t m_162127 = sdiv64(count_162089, (int64_t) 2);
                                        int64_t n_162128 = sub64(count_162089, m_162127);
                                        bool cond_162129 = n_162128 == (int64_t) 0;
                                        int64_t zgze_lhs_162130 = add64(ss_162085, m_162127);
                                        bool cond_f_res_162131 = sle64(ss_162086, zgze_lhs_162130);
                                        bool x_162132 = !cond_162129;
                                        bool y_162133 = cond_f_res_162131 && x_162132;
                                        bool cond_162134 = cond_162129 || y_162133;
                                        bool leq_y_x_162135;
                                        
                                        if (cond_162134) {
                                            leq_y_x_162135 = 1;
                                        } else {
                                            bool x_162136 = sle64((int64_t) 0, zgze_lhs_162130);
                                            bool y_162137 = slt64(zgze_lhs_162130, stride_161918);
                                            bool bounds_check_162138 = x_162136 && y_162137;
                                            bool index_certs_162139;
                                            
                                            if (!bounds_check_162138) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162130, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:159:31-35\n   #13 ftRelational.fut:158:5-159:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162142 = add64(tt_162087, n_162128);
                                            int64_t leq_arg0_162143 = sub64(zm_lhs_162142, (int64_t) 1);
                                            bool x_162144 = sle64((int64_t) 0, leq_arg0_162143);
                                            bool y_162145 = slt64(leq_arg0_162143, j_m_i_161941);
                                            bool bounds_check_162146 = x_162144 && y_162145;
                                            bool index_certs_162147;
                                            
                                            if (!bounds_check_162146) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162143, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:159:31-35\n   #13 ftRelational.fut:158:5-159:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162140 = start_161991 + zgze_lhs_162130;
                                            double leq_arg1_162141 = ((double *) mem_param_171900.mem)[slice_162140];
                                            int64_t slice_162148 = stride_161918 + leq_arg0_162143;
                                            int64_t slice_162149 = start_161991 + slice_162148;
                                            double leq_arg0_162150 = ((double *) mem_param_171900.mem)[slice_162149];
                                            bool defunc_0_leq_res_162151 = leq_arg0_162150 <= leq_arg1_162141;
                                            
                                            leq_y_x_162135 = defunc_0_leq_res_162151;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                        
                                        if (leq_y_x_162135) {
                                            int64_t tmp_162626 = add64(tt_162087, n_162128);
                                            int64_t tmp_162627 = sub64(count_162089, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tt_162088;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = tmp_162627;
                                        } else {
                                            int64_t tmp_162157 = add64(tt_162087, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tt_162087;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tmp_162157;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = count_162089;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = ss_162085;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                    }
                                    defunc_0_lifted_step_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_162105;
                                    defunc_0_lifted_step_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_162106;
                                    defunc_0_lifted_step_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_162107;
                                    defunc_0_lifted_step_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_162108;
                                }
                                defunc_0_lifted_step_res_162092 = defunc_0_lifted_step_res_f_res_162099;
                                defunc_0_lifted_step_res_162093 = defunc_0_lifted_step_res_f_res_162100;
                                defunc_0_lifted_step_res_162094 = defunc_0_lifted_step_res_f_res_162101;
                                defunc_0_lifted_step_res_162095 = defunc_0_lifted_step_res_f_res_162102;
                            }
                            
                            int64_t loopres_162158;
                            int64_t loopres_162159;
                            int64_t loopres_162160;
                            int64_t loopres_162161;
                            int64_t loopres_162162;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162158, &loopres_162159, &loopres_162160, &loopres_162161, &loopres_162162, defunc_0_lifted_step_res_162092, ss_162086, defunc_0_lifted_step_res_162093, defunc_0_lifted_step_res_162094, defunc_0_lifted_step_res_162095) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162163 = slt64((int64_t) 0, loopres_162162);
                            bool loop_while_tmp_172534 = loop_cond_162163;
                            int64_t ss_tmp_172535 = loopres_162158;
                            int64_t ss_tmp_172536 = loopres_162159;
                            int64_t tt_tmp_172537 = loopres_162160;
                            int64_t tt_tmp_172538 = loopres_162161;
                            int64_t count_tmp_172539 = loopres_162162;
                            
                            loop_while_162084 = loop_while_tmp_172534;
                            ss_162085 = ss_tmp_172535;
                            ss_162086 = ss_tmp_172536;
                            tt_162087 = tt_tmp_172537;
                            tt_162088 = tt_tmp_172538;
                            count_162089 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162078 = loop_while_162084;
                        defunc_0_split_count_res_162079 = ss_162085;
                        defunc_0_split_count_res_162080 = ss_162086;
                        defunc_0_split_count_res_162081 = tt_162087;
                        defunc_0_split_count_res_162082 = tt_162088;
                        defunc_0_split_count_res_162083 = count_162089;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162079;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162081;
                    }
                    if (mem_171936_cached_sizze_172901 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172901, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172902 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172902, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161939; i_171573++) {
                        bool y_162169 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool index_certs_162171;
                        
                        if (!y_162169) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162172 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162174 = add64((int64_t) 1, i_171573);
                        bool x_162175 = sle64((int64_t) 0, tmp_162174);
                        bool y_162176 = slt64(tmp_162174, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool bounds_check_162177 = x_162175 && y_162176;
                        bool index_certs_162178;
                        
                        if (!bounds_check_162177) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162174, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162179 = ((int64_t *) mem_171919)[tmp_162174];
                        int64_t defunc_0_f_res_162180 = ((int64_t *) mem_171921)[tmp_162174];
                        int64_t merge_sequential_arg2_162181 = add64(stride_161918, defunc_0_f_res_162173);
                        int64_t merge_sequential_arg2_162182 = add64(stride_161918, defunc_0_f_res_162180);
                        int64_t j_m_i_162183 = sub64(merge_sequential_arg2_162182, merge_sequential_arg2_162181);
                        bool empty_slice_162184 = j_m_i_162183 == (int64_t) 0;
                        int64_t m_162185 = sub64(j_m_i_162183, (int64_t) 1);
                        int64_t i_p_m_t_s_162186 = add64(merge_sequential_arg2_162181, m_162185);
                        bool zzero_leq_i_p_m_t_s_162187 = sle64((int64_t) 0, i_p_m_t_s_162186);
                        bool i_p_m_t_s_leq_w_162188 = slt64(i_p_m_t_s_162186, next_stride_161919);
                        bool zzero_lte_i_162189 = sle64((int64_t) 0, merge_sequential_arg2_162181);
                        bool i_lte_j_162190 = sle64(merge_sequential_arg2_162181, merge_sequential_arg2_162182);
                        bool y_162191 = i_p_m_t_s_leq_w_162188 && zzero_lte_i_162189;
                        bool y_162192 = zzero_leq_i_p_m_t_s_162187 && y_162191;
                        bool forwards_ok_162193 = i_lte_j_162190 && y_162192;
                        bool ok_or_empty_162194 = empty_slice_162184 || forwards_ok_162193;
                        bool index_certs_162195;
                        
                        if (!ok_or_empty_162194) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162181, ":", (long long) merge_sequential_arg2_162182, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162196 = sub64(defunc_0_f_res_162179, defunc_0_f_res_162172);
                        bool empty_slice_162197 = j_m_i_162196 == (int64_t) 0;
                        int64_t m_162198 = sub64(j_m_i_162196, (int64_t) 1);
                        int64_t i_p_m_t_s_162199 = add64(defunc_0_f_res_162172, m_162198);
                        bool zzero_leq_i_p_m_t_s_162200 = sle64((int64_t) 0, i_p_m_t_s_162199);
                        bool i_p_m_t_s_leq_w_162201 = slt64(i_p_m_t_s_162199, next_stride_161919);
                        bool zzero_lte_i_162202 = sle64((int64_t) 0, defunc_0_f_res_162172);
                        bool i_lte_j_162203 = sle64(defunc_0_f_res_162172, defunc_0_f_res_162179);
                        bool y_162204 = i_p_m_t_s_leq_w_162201 && zzero_lte_i_162202;
                        bool y_162205 = zzero_leq_i_p_m_t_s_162200 && y_162204;
                        bool forwards_ok_162206 = i_lte_j_162203 && y_162205;
                        bool ok_or_empty_162207 = empty_slice_162197 || forwards_ok_162206;
                        bool index_certs_162208;
                        
                        if (!ok_or_empty_162207) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162172, ":", (long long) defunc_0_f_res_162179, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:159:31-35\n   #10 ftRelational.fut:158:5-159:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162209 = slt64((int64_t) 0, j_m_i_162196);
                        double dummy_162210;
                        int64_t dummy_162211;
                        
                        if (cond_162209) {
                            bool index_certs_162628;
                            
                            if (!cond_162209) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:159:31-35\n   #12 ftRelational.fut:158:5-159:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161991 + defunc_0_f_res_162172;
                            double head_res_162630 = ((double *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162210 = head_res_162630;
                            dummy_162211 = head_res_162631;
                        } else {
                            bool y_162216 = slt64((int64_t) 0, j_m_i_162183);
                            bool index_certs_162217;
                            
                            if (!y_162216) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:159:31-35\n   #12 ftRelational.fut:158:5-159:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162218 = start_161991 + merge_sequential_arg2_162181;
                            double head_res_162219 = ((double *) mem_param_171900.mem)[slice_162218];
                            int64_t head_res_162220 = ((int64_t *) mem_param_171903.mem)[slice_162218];
                            
                            dummy_162210 = head_res_162219;
                            dummy_162211 = head_res_162220;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161804; nest_i_172542++) {
                            ((double *) mem_171936)[i_171573 * merge_block_sizze_161804 + nest_i_172542] = dummy_162210;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161804; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + nest_i_172543] = dummy_162211;
                        }
                        
                        int64_t data_162223;
                        int64_t i_162227 = (int64_t) 0;
                        
                        for (int64_t k_162226 = 0; k_162226 < merge_block_sizze_161804; k_162226++) {
                            int64_t j_162230 = sub64(k_162226, i_162227);
                            bool cond_162231 = j_162230 == j_m_i_162183;
                            bool cond_162232;
                            
                            if (cond_162231) {
                                cond_162232 = 1;
                            } else {
                                bool cond_162233 = slt64(i_162227, j_m_i_162196);
                                bool cond_f_res_162234;
                                
                                if (cond_162233) {
                                    bool x_162632 = sle64((int64_t) 0, j_162230);
                                    bool y_162633 = slt64(j_162230, j_m_i_162183);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162227);
                                    bool bounds_check_162640 = cond_162233 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162181 + j_162230;
                                    int64_t slice_162637 = start_161991 + slice_162636;
                                    double leq_arg1_162638 = ((double *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162172 + i_162227;
                                    int64_t slice_162643 = start_161991 + slice_162642;
                                    double leq_arg0_162644 = ((double *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = leq_arg0_162644 <= leq_arg1_162638;
                                    
                                    cond_f_res_162234 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162234 = 0;
                                }
                                cond_162232 = cond_f_res_162234;
                            }
                            
                            int64_t loopres_162249;
                            double loopres_162250;
                            int64_t loopres_162251;
                            
                            if (cond_162232) {
                                bool x_162647 = sle64((int64_t) 0, i_162227);
                                bool y_162648 = slt64(i_162227, j_m_i_162196);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162227);
                                int64_t slice_162651 = defunc_0_f_res_162172 + i_162227;
                                int64_t slice_162652 = start_161991 + slice_162651;
                                double tmp_162653 = ((double *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162249 = tmp_162646;
                                loopres_162250 = tmp_162653;
                                loopres_162251 = tmp_162654;
                            } else {
                                bool x_162261 = sle64((int64_t) 0, j_162230);
                                bool y_162262 = slt64(j_162230, j_m_i_162183);
                                bool bounds_check_162263 = x_162261 && y_162262;
                                bool index_certs_162264;
                                
                                if (!bounds_check_162263) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:159:31-35\n   #11 ftRelational.fut:158:5-159:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162265 = merge_sequential_arg2_162181 + j_162230;
                                int64_t slice_162266 = start_161991 + slice_162265;
                                double tmp_162267 = ((double *) mem_param_171900.mem)[slice_162266];
                                int64_t tmp_162268 = ((int64_t *) mem_param_171903.mem)[slice_162266];
                                
                                loopres_162249 = i_162227;
                                loopres_162250 = tmp_162267;
                                loopres_162251 = tmp_162268;
                            }
                            ((double *) mem_171936)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162250;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162251;
                            
                            int64_t i_tmp_172544 = loopres_162249;
                            
                            i_162227 = i_tmp_172544;
                        }
                        data_162223 = i_162227;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171935, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162275 = next_stride_161919 * num_merges_161923;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            if (memblock_alloc(ctx, &mem_172016, bytes_171905, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            
            bool loop_cond_162278 = slt64(next_stride_161919, flat_dim_161800);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162275;
            bool loop_while_tmp_172521 = loop_cond_162278;
            int64_t stride_tmp_172524 = next_stride_161919;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161914 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161915 = loop_while_tmp_172521;
            stride_161918 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161909 = loop_dz2084Uz2082U_161914;
        data_161910 = loop_while_161915;
        data_161913 = stride_161918;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162279 = n_113912 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162280 = sle64((int64_t) 0, zs_lhs_161784);
        bool i_p_m_t_s_leq_w_162281 = slt64(zs_lhs_161784, data_161909);
        bool y_162282 = zzero_leq_i_p_m_t_s_162280 && i_p_m_t_s_leq_w_162281;
        bool ok_or_empty_162283 = empty_slice_162279 || y_162282;
        bool index_certs_162284;
        
        if (!ok_or_empty_162283) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_113912, "] out of bounds for array of shape [", (long long) data_161909, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:159:31-35\n   #6  ftRelational.fut:158:5-159:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_171820, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_113912; i_171587++) {
        int64_t eta_p_162292 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162293 = sle64((int64_t) 0, eta_p_162292);
        bool y_162294 = slt64(eta_p_162292, n_113912);
        bool bounds_check_162295 = x_162293 && y_162294;
        bool index_certs_162296;
        
        if (!bounds_check_162295) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162292, "] out of bounds for array of shape [", (long long) n_113912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:159:31-35\n   #5  ftRelational.fut:158:5-159:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162297 = ((int64_t *) ext_mem_171819.mem)[eta_p_162292];
        double lifted_lambda_res_162298 = ((double *) xs_mem_171818.mem)[eta_p_162292];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162297;
        ((double *) mem_172030.mem)[i_171587] = lifted_lambda_res_162298;
    }
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172891, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172892, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_172903, struct memblock *mem_out_p_172904, struct memblock xs_mem_171818, int64_t n_111767, int64_t incr_111768)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172905 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172906 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172907 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172908 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172909 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172910 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172911 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172912 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172913 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172914 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_111767;
    bool cond_161783 = sle64(n_111767, (int64_t) 1);
    int64_t zs_lhs_161784 = sub64(n_111767, (int64_t) 1);
    int64_t zp_rhs_161785 = sdiv_safe64(zs_lhs_161784, (int64_t) 20);
    int64_t min_num_blocks_161786 = add64((int64_t) 1, zp_rhs_161785);
    bool loop_cond_161787 = slt64((int64_t) 1, min_num_blocks_161786);
    bool smallest_pow_2_geq_than_res_161788;
    int64_t smallest_pow_2_geq_than_res_161789;
    bool loop_while_161790;
    int64_t x_161791;
    
    loop_while_161790 = loop_cond_161787;
    x_161791 = (int64_t) 1;
    while (loop_while_161790) {
        int64_t loopres_161792 = mul64((int64_t) 2, x_161791);
        bool loop_cond_161793 = slt64(loopres_161792, min_num_blocks_161786);
        bool loop_while_tmp_172502 = loop_cond_161793;
        int64_t x_tmp_172503 = loopres_161792;
        
        loop_while_161790 = loop_while_tmp_172502;
        x_161791 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161788 = loop_while_161790;
    smallest_pow_2_geq_than_res_161789 = x_161791;
    
    bool zzero_161794 = smallest_pow_2_geq_than_res_161789 == (int64_t) 0;
    bool nonzzero_161795 = !zzero_161794;
    bool protect_assert_disj_161796 = cond_161783 || nonzzero_161795;
    bool nonzzero_cert_161797;
    
    if (!protect_assert_disj_161796) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:157:31-35\n   #5  ftRelational.fut:156:5-157:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161798 = sdiv_safe64(zs_lhs_161784, smallest_pow_2_geq_than_res_161789);
    int64_t block_sizze_161799 = add64((int64_t) 1, zp_rhs_161798);
    bool y_161805 = slt64((int64_t) 0, n_111767);
    bool protect_assert_disj_172415 = cond_161783 || y_161805;
    bool index_certs_161806;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_111767, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:157:31-35\n   #5  ftRelational.fut:156:5-157:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161820 = slt64(smallest_pow_2_geq_than_res_161789, (int64_t) 0);
    bool valid_161821 = !bounds_invalid_upwards_161820;
    bool protect_assert_disj_172423 = cond_161783 || valid_161821;
    bool range_valid_c_161822;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161789, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:157:31-35\n   #6  ftRelational.fut:156:5-157:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161824 = slt64(block_sizze_161799, (int64_t) 0);
    bool valid_161825 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_172425 = cond_161783 || valid_161825;
    bool range_valid_c_161826;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161799, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161828 = sle64(block_sizze_161799, (int64_t) 1);
    int64_t tmp_161829 = sub64(block_sizze_161799, (int64_t) 2);
    bool bounds_invalid_upwards_161830 = slt64(tmp_161829, (int64_t) 0);
    bool valid_161832 = !bounds_invalid_upwards_161830;
    bool protect_assert_disj_161833 = cond_161828 || valid_161832;
    bool protect_assert_disj_172427 = cond_161783 || protect_assert_disj_161833;
    bool range_valid_c_161834;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161829, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172029 = (int64_t) 4 * n_111767;
    
    if (futrts_indicesWithIncrement_16363(ctx, &ext_mem_171819, xs_mem_171818, n_111767, incr_111768) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_111767; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161800 = smallest_pow_2_geq_than_res_161789 * block_sizze_161799;
    bool x_172410 = !cond_161783;
    int64_t greatest_divisor_leq_than_arg1_161803 = mul64((int64_t) 2, block_sizze_161799);
    int64_t merge_block_sizze_161804;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161803) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161804 = x_172412;
    } else {
        merge_block_sizze_161804 = (int64_t) 0;
    }
    
    float reduce_arg1_161807;
    
    if (x_172410) {
        float x_172416 = ((float *) xs_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161807 = x_172416;
    } else {
        reduce_arg1_161807 = 0.0F;
    }
    
    float defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        float x_172418;
        int64_t x_172419;
        float redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161807;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_111767; i_171547++) {
            float x_161811 = ((float *) xs_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161817 = redout_171545 <= x_161811;
            float defunc_0_op_res_161818;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161818 = x_161811;
            } else {
                defunc_0_op_res_161818 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161819;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161819 = i_171547;
            } else {
                defunc_0_op_res_161819 = redout_171546;
            }
            
            float redout_tmp_172506 = defunc_0_op_res_161818;
            int64_t redout_tmp_172507 = defunc_0_op_res_161819;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0.0F;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161831 = add64((int64_t) 1, tmp_161829);
    int64_t binop_x_171822 = (int64_t) 4 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171823 = block_sizze_161799 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171826 = block_sizze_161799 * binop_x_171825;
    int64_t bytes_171836 = (int64_t) 4 * block_sizze_161799;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161799;
    bool loop_cond_161906 = slt64(block_sizze_161799, flat_dim_161800);
    bool zzero_161907 = merge_block_sizze_161804 == (int64_t) 0;
    bool nonzzero_161908 = !zzero_161907;
    
    if (cond_161783) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172905 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172905, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172906 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172906, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172907 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172907, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172908 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172908, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161789; i_171559++) {
            int64_t zp_lhs_161838 = mul64(block_sizze_161799, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161799; i_171552++) {
                int64_t k_161842 = add64(zp_lhs_161838, i_171552);
                bool cond_161843 = slt64(k_161842, n_111767);
                float lifted_lambda_res_161844;
                int64_t lifted_lambda_res_161845;
                
                if (cond_161843) {
                    bool x_162514 = sle64((int64_t) 0, k_161842);
                    bool bounds_check_162515 = cond_161843 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161842, "] out of bounds for array of shape [", (long long) n_111767, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_162517 = ((float *) xs_mem_171818.mem)[k_161842];
                    
                    lifted_lambda_res_161844 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161845 = k_161842;
                } else {
                    lifted_lambda_res_161844 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161845 = defunc_0_reduce_res_162662;
                }
                ((float *) mem_171837)[i_171552] = lifted_lambda_res_161844;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161845;
            }
            if (!cond_161828) {
                for (int64_t i_161855 = 0; i_161855 < distance_161831; i_161855++) {
                    int64_t gt_arg1_161858 = add64((int64_t) 1, i_161855);
                    bool x_161859 = sle64((int64_t) 0, gt_arg1_161858);
                    bool y_161860 = slt64(gt_arg1_161858, block_sizze_161799);
                    bool bounds_check_161861 = x_161859 && y_161860;
                    bool index_certs_161862;
                    
                    if (!bounds_check_161861) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161858, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161864 = slt64(i_161855, block_sizze_161799);
                    bool index_certs_161865;
                    
                    if (!y_161864) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161855, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_161863 = ((float *) mem_171837)[gt_arg1_161858];
                    float gt_arg0_161866 = ((float *) mem_171837)[i_161855];
                    bool defunc_0_leq_res_161867 = gt_arg0_161866 <= gt_arg1_161863;
                    bool defunc_0_lifted_gt_res_161868 = !defunc_0_leq_res_161867;
                    bool s_161869;
                    int64_t s_161872;
                    bool loop_while_161873;
                    int64_t j_161876;
                    
                    loop_while_161873 = defunc_0_lifted_gt_res_161868;
                    j_161876 = i_161855;
                    while (loop_while_161873) {
                        bool x_161877 = sle64((int64_t) 0, j_161876);
                        bool y_161878 = slt64(j_161876, block_sizze_161799);
                        bool bounds_check_161879 = x_161877 && y_161878;
                        bool index_certs_161880;
                        
                        if (!bounds_check_161879) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161876, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161883 = add64((int64_t) 1, j_161876);
                        bool x_161884 = sle64((int64_t) 0, copy_arg0_161883);
                        bool y_161885 = slt64(copy_arg0_161883, block_sizze_161799);
                        bool bounds_check_161886 = x_161884 && y_161885;
                        bool index_certs_161887;
                        
                        if (!bounds_check_161886) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161883, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_161881 = ((float *) mem_171837)[j_161876];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171839)[j_161876];
                        float copy_arg0_161888 = ((float *) mem_171837)[copy_arg0_161883];
                        int64_t copy_arg0_161889 = ((int64_t *) mem_171839)[copy_arg0_161883];
                        
                        ((float *) mem_171837)[j_161876] = copy_arg0_161888;
                        ((int64_t *) mem_171839)[j_161876] = copy_arg0_161889;
                        ((float *) mem_171837)[copy_arg0_161883] = copy_arg0_161881;
                        ((int64_t *) mem_171839)[copy_arg0_161883] = copy_arg0_161882;
                        
                        int64_t tmp_161894 = sub64(j_161876, (int64_t) 1);
                        bool cond_161895 = sle64((int64_t) 0, tmp_161894);
                        bool loop_cond_161896;
                        
                        if (cond_161895) {
                            bool y_162519 = slt64(tmp_161894, block_sizze_161799);
                            bool bounds_check_162520 = cond_161895 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161894, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_162518 = ((float *) mem_171837)[j_161876];
                            float gt_arg0_162522 = ((float *) mem_171837)[tmp_161894];
                            bool defunc_0_leq_res_162523 = gt_arg0_162522 <= gt_arg1_162518;
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161896 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161896 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161896;
                        int64_t j_tmp_172517 = tmp_161894;
                        
                        loop_while_161873 = loop_while_tmp_172514;
                        j_161876 = j_tmp_172517;
                    }
                    s_161869 = loop_while_161873;
                    s_161872 = j_161876;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171824, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint32_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        
        int64_t data_161909;
        bool data_161910;
        int64_t data_161913;
        int64_t loop_dz2084Uz2082U_161914;
        bool loop_while_161915;
        int64_t stride_161918;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161914 = flat_dim_161800;
        loop_while_161915 = loop_cond_161906;
        stride_161918 = block_sizze_161799;
        while (loop_while_161915) {
            int64_t next_stride_161919 = mul64((int64_t) 2, stride_161918);
            bool zzero_161920 = next_stride_161919 == (int64_t) 0;
            bool nonzzero_161921 = !zzero_161920;
            bool nonzzero_cert_161922;
            
            if (!nonzzero_161921) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:157:31-35\n   #5  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161923 = sdiv64(flat_dim_161800, next_stride_161919);
            bool bounds_invalid_upwards_161924 = slt64(num_merges_161923, (int64_t) 0);
            bool valid_161925 = !bounds_invalid_upwards_161924;
            bool range_valid_c_161926;
            
            if (!valid_161925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161923, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:157:31-35\n   #6  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161928 = sub64(next_stride_161919, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161929 = sle64((int64_t) 0, m_161928);
            bool cond_161931 = slt64(next_stride_161919, (int64_t) 10);
            bool protect_assert_disj_161932 = nonzzero_161908 || cond_161931;
            bool nonzzero_cert_161933;
            
            if (!protect_assert_disj_161932) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161934 = smod_safe64(next_stride_161919, merge_block_sizze_161804);
            bool num_blocks_161935 = zeze_lhs_161934 == (int64_t) 0;
            bool protect_assert_disj_161936 = cond_161931 || num_blocks_161935;
            bool assert_c_161937;
            
            if (!protect_assert_disj_161936) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161939 = sdiv_safe64(next_stride_161919, merge_block_sizze_161804);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940 = add64((int64_t) 1, num_blocks_161939);
            int64_t j_m_i_161941 = sub64(next_stride_161919, stride_161918);
            int64_t flat_dim_161942 = merge_block_sizze_161804 * num_blocks_161939;
            bool bounds_invalid_upwards_161943 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, (int64_t) 0);
            bool empty_slice_161944 = j_m_i_161941 == (int64_t) 0;
            int64_t m_161945 = sub64(j_m_i_161941, (int64_t) 1);
            bool zzero_lte_i_161946 = sle64((int64_t) 0, stride_161918);
            bool i_lte_j_161947 = sle64(stride_161918, next_stride_161919);
            bool empty_slice_161948 = stride_161918 == (int64_t) 0;
            int64_t m_161949 = sub64(stride_161918, (int64_t) 1);
            bool bounds_invalid_upwards_161950 = slt64(num_blocks_161939, (int64_t) 0);
            bool cond_161951 = slt64((int64_t) 0, stride_161918);
            bool valid_161952 = !bounds_invalid_upwards_161943;
            int64_t i_p_m_t_s_161953 = add64(stride_161918, m_161945);
            bool zzero_leq_i_p_m_t_s_161954 = sle64((int64_t) 0, m_161949);
            bool i_p_m_t_s_leq_w_161955 = slt64(m_161949, next_stride_161919);
            bool valid_161956 = !bounds_invalid_upwards_161950;
            bool i_p_m_t_s_leq_w_161957 = slt64(m_161928, flat_dim_161942);
            bool y_161958 = slt64((int64_t) 0, j_m_i_161941);
            bool protect_assert_disj_161959 = cond_161931 || valid_161952;
            bool range_valid_c_161960;
            
            if (!protect_assert_disj_161959) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161961 = sle64((int64_t) 0, i_p_m_t_s_161953);
            bool i_p_m_t_s_leq_w_161962 = slt64(i_p_m_t_s_161953, next_stride_161919);
            bool y_161963 = zzero_leq_i_p_m_t_s_161954 && i_p_m_t_s_leq_w_161955;
            bool protect_assert_disj_161964 = cond_161931 || valid_161956;
            bool range_valid_c_161965;
            
            if (!protect_assert_disj_161964) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161939, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161966 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_161957;
            bool y_161967 = zzero_lte_i_161946 && i_p_m_t_s_leq_w_161962;
            bool forwards_ok_161968 = zzero_lte_i_161946 && y_161963;
            bool ok_or_empty_161969 = zzero_161920 || y_161966;
            bool protect_assert_disj_161970 = cond_161951 || y_161958;
            bool y_161971 = zzero_leq_i_p_m_t_s_161961 && y_161967;
            bool ok_or_empty_161972 = empty_slice_161948 || forwards_ok_161968;
            bool protect_assert_disj_161973 = cond_161931 || ok_or_empty_161969;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) flat_dim_161942, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161975 = !cond_161931;
            bool protect_assert_disj_161976 = protect_assert_disj_161970 || loop_not_taken_161975;
            bool index_certs_161977;
            
            if (!protect_assert_disj_161976) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161978 = i_lte_j_161947 && y_161971;
            bool protect_assert_disj_161979 = cond_161931 || ok_or_empty_161972;
            bool index_certs_161980;
            
            if (!protect_assert_disj_161979) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161981 = ok_or_empty_161972 || loop_not_taken_161975;
            bool index_certs_161982;
            
            if (!protect_assert_disj_161981) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161983 = empty_slice_161944 || forwards_ok_161978;
            bool protect_assert_disj_161984 = cond_161931 || ok_or_empty_161983;
            bool index_certs_161985;
            
            if (!protect_assert_disj_161984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161986 = loop_not_taken_161975 || ok_or_empty_161983;
            bool index_certs_161987;
            
            if (!protect_assert_disj_161986) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 4 * num_merges_161923;
            int64_t bytes_171905 = next_stride_161919 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161923;
            int64_t bytes_171908 = next_stride_161919 * binop_x_171907;
            bool i_lte_j_161930 = sle64((int64_t) 0, next_stride_161919);
            
            if (mem_171906_cached_sizze_172909 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172909, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172910 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172910, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940;
            int64_t binop_x_171934 = (int64_t) 4 * num_blocks_161939;
            int64_t bytes_171935 = merge_block_sizze_161804 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161939;
            int64_t bytes_171938 = merge_block_sizze_161804 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 8 * stride_161918;
            int64_t bytes_171982 = (int64_t) 16 * stride_161918;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161923; i_171580++) {
                int64_t start_161991 = mul64(next_stride_161919, i_171580);
                int64_t j_m_i_161992 = sub64(loop_dz2084Uz2082U_161914, start_161991);
                bool empty_slice_161993 = j_m_i_161992 == (int64_t) 0;
                int64_t m_161994 = sub64(j_m_i_161992, (int64_t) 1);
                int64_t i_p_m_t_s_161995 = add64(start_161991, m_161994);
                bool zzero_leq_i_p_m_t_s_161996 = sle64((int64_t) 0, i_p_m_t_s_161995);
                bool i_p_m_t_s_leq_w_161997 = slt64(i_p_m_t_s_161995, loop_dz2084Uz2082U_161914);
                bool zzero_lte_i_161998 = sle64((int64_t) 0, start_161991);
                bool i_lte_j_161999 = sle64(start_161991, loop_dz2084Uz2082U_161914);
                bool y_162000 = i_p_m_t_s_leq_w_161997 && zzero_lte_i_161998;
                bool y_162001 = zzero_leq_i_p_m_t_s_161996 && y_162000;
                bool forwards_ok_162002 = i_lte_j_161999 && y_162001;
                bool ok_or_empty_162003 = empty_slice_161993 || forwards_ok_162002;
                bool index_certs_162004;
                
                if (!ok_or_empty_162003) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161991, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161914, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_162005 = slt64(m_161928, j_m_i_161992);
                bool y_162006 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_162005;
                bool forwards_ok_162007 = i_lte_j_161930 && y_162006;
                bool ok_or_empty_162008 = zzero_161920 || forwards_ok_162007;
                bool index_certs_162009;
                
                if (!ok_or_empty_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) j_m_i_161992, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:157:31-35\n   #8  ftRelational.fut:156:5-157:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161931) {
                    float dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161951) {
                        float head_res_162552 = ((float *) mem_param_171900.mem)[start_161991];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161991];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161918 + start_161991;
                        float head_res_162555 = ((float *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161919; nest_i_172527++) {
                        ((float *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161919; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161919; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161941;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161918);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161941);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161918 + j_162566;
                                int64_t slice_162576 = start_161991 + slice_162575;
                                float leq_arg1_162577 = ((float *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161991 + i_162563;
                                float leq_arg0_162582 = ((float *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = leq_arg0_162582 <= leq_arg1_162577;
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        float loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161918);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161991 + i_162563;
                            float tmp_162593 = ((float *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161941);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:157:31-35\n   #9  ftRelational.fut:156:5-157:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161918 + j_162566;
                            int64_t slice_162600 = start_161991 + slice_162599;
                            float tmp_162601 = ((float *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((float *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172911 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172911, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172912 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172912, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940; i_171566++) {
                        int64_t split_count_arg3_162071 = mul64(merge_block_sizze_161804, i_171566);
                        int64_t defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162072, &defunc_0_split_count_res_162073, &defunc_0_split_count_res_162074, &defunc_0_split_count_res_162075, &defunc_0_split_count_res_162076, (int64_t) 0, stride_161918, (int64_t) 0, j_m_i_161941, split_count_arg3_162071) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162077 = slt64((int64_t) 0, defunc_0_split_count_res_162076);
                        bool defunc_0_split_count_res_162078;
                        int64_t defunc_0_split_count_res_162079;
                        int64_t defunc_0_split_count_res_162080;
                        int64_t defunc_0_split_count_res_162081;
                        int64_t defunc_0_split_count_res_162082;
                        int64_t defunc_0_split_count_res_162083;
                        bool loop_while_162084;
                        int64_t ss_162085;
                        int64_t ss_162086;
                        int64_t tt_162087;
                        int64_t tt_162088;
                        int64_t count_162089;
                        
                        loop_while_162084 = loop_cond_162077;
                        ss_162085 = defunc_0_split_count_res_162072;
                        ss_162086 = defunc_0_split_count_res_162073;
                        tt_162087 = defunc_0_split_count_res_162074;
                        tt_162088 = defunc_0_split_count_res_162075;
                        count_162089 = defunc_0_split_count_res_162076;
                        while (loop_while_162084) {
                            int64_t zlze_lhs_162090 = sub64(ss_162086, ss_162085);
                            bool cond_162091 = sle64(zlze_lhs_162090, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162092;
                            int64_t defunc_0_lifted_step_res_162093;
                            int64_t defunc_0_lifted_step_res_162094;
                            int64_t defunc_0_lifted_step_res_162095;
                            
                            if (cond_162091) {
                                int64_t tmp_162605 = add64(tt_162087, count_162089);
                                
                                defunc_0_lifted_step_res_162092 = ss_162085;
                                defunc_0_lifted_step_res_162093 = tmp_162605;
                                defunc_0_lifted_step_res_162094 = tt_162088;
                                defunc_0_lifted_step_res_162095 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162097 = sub64(tt_162088, tt_162087);
                                bool cond_162098 = sle64(zlze_lhs_162097, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162099;
                                int64_t defunc_0_lifted_step_res_f_res_162100;
                                int64_t defunc_0_lifted_step_res_f_res_162101;
                                int64_t defunc_0_lifted_step_res_f_res_162102;
                                
                                if (cond_162098) {
                                    int64_t tmp_162606 = add64(ss_162085, count_162089);
                                    
                                    defunc_0_lifted_step_res_f_res_162099 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162100 = tt_162087;
                                    defunc_0_lifted_step_res_f_res_162101 = tt_162088;
                                    defunc_0_lifted_step_res_f_res_162102 = (int64_t) 0;
                                } else {
                                    bool cond_162104 = count_162089 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162105;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162106;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162107;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162108;
                                    
                                    if (cond_162104) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162085);
                                        bool y_162609 = slt64(ss_162085, stride_161918);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162085, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:157:31-35\n   #13 ftRelational.fut:156:5-157:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162087);
                                        bool y_162615 = slt64(tt_162087, j_m_i_161941);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162087, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:157:31-35\n   #13 ftRelational.fut:156:5-157:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161991 + ss_162085;
                                        float leq_arg1_162613 = ((float *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161918 + tt_162087;
                                        int64_t slice_162619 = start_161991 + slice_162618;
                                        float leq_arg0_162620 = ((float *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = leq_arg0_162620 <= leq_arg1_162613;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162087);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162085;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162085);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162087;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = tt_162088;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = (int64_t) 0;
                                    } else {
                                        int64_t m_162127 = sdiv64(count_162089, (int64_t) 2);
                                        int64_t n_162128 = sub64(count_162089, m_162127);
                                        bool cond_162129 = n_162128 == (int64_t) 0;
                                        int64_t zgze_lhs_162130 = add64(ss_162085, m_162127);
                                        bool cond_f_res_162131 = sle64(ss_162086, zgze_lhs_162130);
                                        bool x_162132 = !cond_162129;
                                        bool y_162133 = cond_f_res_162131 && x_162132;
                                        bool cond_162134 = cond_162129 || y_162133;
                                        bool leq_y_x_162135;
                                        
                                        if (cond_162134) {
                                            leq_y_x_162135 = 1;
                                        } else {
                                            bool x_162136 = sle64((int64_t) 0, zgze_lhs_162130);
                                            bool y_162137 = slt64(zgze_lhs_162130, stride_161918);
                                            bool bounds_check_162138 = x_162136 && y_162137;
                                            bool index_certs_162139;
                                            
                                            if (!bounds_check_162138) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162130, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:157:31-35\n   #13 ftRelational.fut:156:5-157:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162142 = add64(tt_162087, n_162128);
                                            int64_t leq_arg0_162143 = sub64(zm_lhs_162142, (int64_t) 1);
                                            bool x_162144 = sle64((int64_t) 0, leq_arg0_162143);
                                            bool y_162145 = slt64(leq_arg0_162143, j_m_i_161941);
                                            bool bounds_check_162146 = x_162144 && y_162145;
                                            bool index_certs_162147;
                                            
                                            if (!bounds_check_162146) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162143, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:157:31-35\n   #13 ftRelational.fut:156:5-157:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162140 = start_161991 + zgze_lhs_162130;
                                            float leq_arg1_162141 = ((float *) mem_param_171900.mem)[slice_162140];
                                            int64_t slice_162148 = stride_161918 + leq_arg0_162143;
                                            int64_t slice_162149 = start_161991 + slice_162148;
                                            float leq_arg0_162150 = ((float *) mem_param_171900.mem)[slice_162149];
                                            bool defunc_0_leq_res_162151 = leq_arg0_162150 <= leq_arg1_162141;
                                            
                                            leq_y_x_162135 = defunc_0_leq_res_162151;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                        
                                        if (leq_y_x_162135) {
                                            int64_t tmp_162626 = add64(tt_162087, n_162128);
                                            int64_t tmp_162627 = sub64(count_162089, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tt_162088;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = tmp_162627;
                                        } else {
                                            int64_t tmp_162157 = add64(tt_162087, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tt_162087;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tmp_162157;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = count_162089;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = ss_162085;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                    }
                                    defunc_0_lifted_step_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_162105;
                                    defunc_0_lifted_step_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_162106;
                                    defunc_0_lifted_step_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_162107;
                                    defunc_0_lifted_step_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_162108;
                                }
                                defunc_0_lifted_step_res_162092 = defunc_0_lifted_step_res_f_res_162099;
                                defunc_0_lifted_step_res_162093 = defunc_0_lifted_step_res_f_res_162100;
                                defunc_0_lifted_step_res_162094 = defunc_0_lifted_step_res_f_res_162101;
                                defunc_0_lifted_step_res_162095 = defunc_0_lifted_step_res_f_res_162102;
                            }
                            
                            int64_t loopres_162158;
                            int64_t loopres_162159;
                            int64_t loopres_162160;
                            int64_t loopres_162161;
                            int64_t loopres_162162;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162158, &loopres_162159, &loopres_162160, &loopres_162161, &loopres_162162, defunc_0_lifted_step_res_162092, ss_162086, defunc_0_lifted_step_res_162093, defunc_0_lifted_step_res_162094, defunc_0_lifted_step_res_162095) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162163 = slt64((int64_t) 0, loopres_162162);
                            bool loop_while_tmp_172534 = loop_cond_162163;
                            int64_t ss_tmp_172535 = loopres_162158;
                            int64_t ss_tmp_172536 = loopres_162159;
                            int64_t tt_tmp_172537 = loopres_162160;
                            int64_t tt_tmp_172538 = loopres_162161;
                            int64_t count_tmp_172539 = loopres_162162;
                            
                            loop_while_162084 = loop_while_tmp_172534;
                            ss_162085 = ss_tmp_172535;
                            ss_162086 = ss_tmp_172536;
                            tt_162087 = tt_tmp_172537;
                            tt_162088 = tt_tmp_172538;
                            count_162089 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162078 = loop_while_162084;
                        defunc_0_split_count_res_162079 = ss_162085;
                        defunc_0_split_count_res_162080 = ss_162086;
                        defunc_0_split_count_res_162081 = tt_162087;
                        defunc_0_split_count_res_162082 = tt_162088;
                        defunc_0_split_count_res_162083 = count_162089;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162079;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162081;
                    }
                    if (mem_171936_cached_sizze_172913 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172913, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172914 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172914, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161939; i_171573++) {
                        bool y_162169 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool index_certs_162171;
                        
                        if (!y_162169) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162172 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162174 = add64((int64_t) 1, i_171573);
                        bool x_162175 = sle64((int64_t) 0, tmp_162174);
                        bool y_162176 = slt64(tmp_162174, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool bounds_check_162177 = x_162175 && y_162176;
                        bool index_certs_162178;
                        
                        if (!bounds_check_162177) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162174, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162179 = ((int64_t *) mem_171919)[tmp_162174];
                        int64_t defunc_0_f_res_162180 = ((int64_t *) mem_171921)[tmp_162174];
                        int64_t merge_sequential_arg2_162181 = add64(stride_161918, defunc_0_f_res_162173);
                        int64_t merge_sequential_arg2_162182 = add64(stride_161918, defunc_0_f_res_162180);
                        int64_t j_m_i_162183 = sub64(merge_sequential_arg2_162182, merge_sequential_arg2_162181);
                        bool empty_slice_162184 = j_m_i_162183 == (int64_t) 0;
                        int64_t m_162185 = sub64(j_m_i_162183, (int64_t) 1);
                        int64_t i_p_m_t_s_162186 = add64(merge_sequential_arg2_162181, m_162185);
                        bool zzero_leq_i_p_m_t_s_162187 = sle64((int64_t) 0, i_p_m_t_s_162186);
                        bool i_p_m_t_s_leq_w_162188 = slt64(i_p_m_t_s_162186, next_stride_161919);
                        bool zzero_lte_i_162189 = sle64((int64_t) 0, merge_sequential_arg2_162181);
                        bool i_lte_j_162190 = sle64(merge_sequential_arg2_162181, merge_sequential_arg2_162182);
                        bool y_162191 = i_p_m_t_s_leq_w_162188 && zzero_lte_i_162189;
                        bool y_162192 = zzero_leq_i_p_m_t_s_162187 && y_162191;
                        bool forwards_ok_162193 = i_lte_j_162190 && y_162192;
                        bool ok_or_empty_162194 = empty_slice_162184 || forwards_ok_162193;
                        bool index_certs_162195;
                        
                        if (!ok_or_empty_162194) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162181, ":", (long long) merge_sequential_arg2_162182, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162196 = sub64(defunc_0_f_res_162179, defunc_0_f_res_162172);
                        bool empty_slice_162197 = j_m_i_162196 == (int64_t) 0;
                        int64_t m_162198 = sub64(j_m_i_162196, (int64_t) 1);
                        int64_t i_p_m_t_s_162199 = add64(defunc_0_f_res_162172, m_162198);
                        bool zzero_leq_i_p_m_t_s_162200 = sle64((int64_t) 0, i_p_m_t_s_162199);
                        bool i_p_m_t_s_leq_w_162201 = slt64(i_p_m_t_s_162199, next_stride_161919);
                        bool zzero_lte_i_162202 = sle64((int64_t) 0, defunc_0_f_res_162172);
                        bool i_lte_j_162203 = sle64(defunc_0_f_res_162172, defunc_0_f_res_162179);
                        bool y_162204 = i_p_m_t_s_leq_w_162201 && zzero_lte_i_162202;
                        bool y_162205 = zzero_leq_i_p_m_t_s_162200 && y_162204;
                        bool forwards_ok_162206 = i_lte_j_162203 && y_162205;
                        bool ok_or_empty_162207 = empty_slice_162197 || forwards_ok_162206;
                        bool index_certs_162208;
                        
                        if (!ok_or_empty_162207) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162172, ":", (long long) defunc_0_f_res_162179, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:157:31-35\n   #10 ftRelational.fut:156:5-157:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162209 = slt64((int64_t) 0, j_m_i_162196);
                        float dummy_162210;
                        int64_t dummy_162211;
                        
                        if (cond_162209) {
                            bool index_certs_162628;
                            
                            if (!cond_162209) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:157:31-35\n   #12 ftRelational.fut:156:5-157:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161991 + defunc_0_f_res_162172;
                            float head_res_162630 = ((float *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162210 = head_res_162630;
                            dummy_162211 = head_res_162631;
                        } else {
                            bool y_162216 = slt64((int64_t) 0, j_m_i_162183);
                            bool index_certs_162217;
                            
                            if (!y_162216) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:157:31-35\n   #12 ftRelational.fut:156:5-157:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162218 = start_161991 + merge_sequential_arg2_162181;
                            float head_res_162219 = ((float *) mem_param_171900.mem)[slice_162218];
                            int64_t head_res_162220 = ((int64_t *) mem_param_171903.mem)[slice_162218];
                            
                            dummy_162210 = head_res_162219;
                            dummy_162211 = head_res_162220;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161804; nest_i_172542++) {
                            ((float *) mem_171936)[i_171573 * merge_block_sizze_161804 + nest_i_172542] = dummy_162210;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161804; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + nest_i_172543] = dummy_162211;
                        }
                        
                        int64_t data_162223;
                        int64_t i_162227 = (int64_t) 0;
                        
                        for (int64_t k_162226 = 0; k_162226 < merge_block_sizze_161804; k_162226++) {
                            int64_t j_162230 = sub64(k_162226, i_162227);
                            bool cond_162231 = j_162230 == j_m_i_162183;
                            bool cond_162232;
                            
                            if (cond_162231) {
                                cond_162232 = 1;
                            } else {
                                bool cond_162233 = slt64(i_162227, j_m_i_162196);
                                bool cond_f_res_162234;
                                
                                if (cond_162233) {
                                    bool x_162632 = sle64((int64_t) 0, j_162230);
                                    bool y_162633 = slt64(j_162230, j_m_i_162183);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162227);
                                    bool bounds_check_162640 = cond_162233 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162181 + j_162230;
                                    int64_t slice_162637 = start_161991 + slice_162636;
                                    float leq_arg1_162638 = ((float *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162172 + i_162227;
                                    int64_t slice_162643 = start_161991 + slice_162642;
                                    float leq_arg0_162644 = ((float *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = leq_arg0_162644 <= leq_arg1_162638;
                                    
                                    cond_f_res_162234 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162234 = 0;
                                }
                                cond_162232 = cond_f_res_162234;
                            }
                            
                            int64_t loopres_162249;
                            float loopres_162250;
                            int64_t loopres_162251;
                            
                            if (cond_162232) {
                                bool x_162647 = sle64((int64_t) 0, i_162227);
                                bool y_162648 = slt64(i_162227, j_m_i_162196);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162227);
                                int64_t slice_162651 = defunc_0_f_res_162172 + i_162227;
                                int64_t slice_162652 = start_161991 + slice_162651;
                                float tmp_162653 = ((float *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162249 = tmp_162646;
                                loopres_162250 = tmp_162653;
                                loopres_162251 = tmp_162654;
                            } else {
                                bool x_162261 = sle64((int64_t) 0, j_162230);
                                bool y_162262 = slt64(j_162230, j_m_i_162183);
                                bool bounds_check_162263 = x_162261 && y_162262;
                                bool index_certs_162264;
                                
                                if (!bounds_check_162263) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:157:31-35\n   #11 ftRelational.fut:156:5-157:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162265 = merge_sequential_arg2_162181 + j_162230;
                                int64_t slice_162266 = start_161991 + slice_162265;
                                float tmp_162267 = ((float *) mem_param_171900.mem)[slice_162266];
                                int64_t tmp_162268 = ((int64_t *) mem_param_171903.mem)[slice_162266];
                                
                                loopres_162249 = i_162227;
                                loopres_162250 = tmp_162267;
                                loopres_162251 = tmp_162268;
                            }
                            ((float *) mem_171936)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162250;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162251;
                            
                            int64_t i_tmp_172544 = loopres_162249;
                            
                            i_162227 = i_tmp_172544;
                        }
                        data_162223 = i_162227;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint32_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171906, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162275 = next_stride_161919 * num_merges_161923;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint32_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            
            bool loop_cond_162278 = slt64(next_stride_161919, flat_dim_161800);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162275;
            bool loop_while_tmp_172521 = loop_cond_162278;
            int64_t stride_tmp_172524 = next_stride_161919;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161914 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161915 = loop_while_tmp_172521;
            stride_161918 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161909 = loop_dz2084Uz2082U_161914;
        data_161910 = loop_while_161915;
        data_161913 = stride_161918;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162279 = n_111767 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162280 = sle64((int64_t) 0, zs_lhs_161784);
        bool i_p_m_t_s_leq_w_162281 = slt64(zs_lhs_161784, data_161909);
        bool y_162282 = zzero_leq_i_p_m_t_s_162280 && i_p_m_t_s_leq_w_162281;
        bool ok_or_empty_162283 = empty_slice_162279 || y_162282;
        bool index_certs_162284;
        
        if (!ok_or_empty_162283) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_111767, "] out of bounds for array of shape [", (long long) data_161909, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:157:31-35\n   #6  ftRelational.fut:156:5-157:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_111767; i_171587++) {
        int64_t eta_p_162292 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162293 = sle64((int64_t) 0, eta_p_162292);
        bool y_162294 = slt64(eta_p_162292, n_111767);
        bool bounds_check_162295 = x_162293 && y_162294;
        bool index_certs_162296;
        
        if (!bounds_check_162295) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162292, "] out of bounds for array of shape [", (long long) n_111767, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:157:31-35\n   #5  ftRelational.fut:156:5-157:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162297 = ((int64_t *) ext_mem_171819.mem)[eta_p_162292];
        float lifted_lambda_res_162298 = ((float *) xs_mem_171818.mem)[eta_p_162292];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162297;
        ((float *) mem_172030.mem)[i_171587] = lifted_lambda_res_162298;
    }
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172903, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172904, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_172915, struct memblock *mem_out_p_172916, struct memblock xs_mem_171818, int64_t n_107481, int64_t incr_107482)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172917 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172918 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172919 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172920 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172921 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172922 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172923 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172924 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172925 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172926 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_107481;
    bool cond_161783 = sle64(n_107481, (int64_t) 1);
    int64_t zs_lhs_161784 = sub64(n_107481, (int64_t) 1);
    int64_t zp_rhs_161785 = sdiv_safe64(zs_lhs_161784, (int64_t) 20);
    int64_t min_num_blocks_161786 = add64((int64_t) 1, zp_rhs_161785);
    bool loop_cond_161787 = slt64((int64_t) 1, min_num_blocks_161786);
    bool smallest_pow_2_geq_than_res_161788;
    int64_t smallest_pow_2_geq_than_res_161789;
    bool loop_while_161790;
    int64_t x_161791;
    
    loop_while_161790 = loop_cond_161787;
    x_161791 = (int64_t) 1;
    while (loop_while_161790) {
        int64_t loopres_161792 = mul64((int64_t) 2, x_161791);
        bool loop_cond_161793 = slt64(loopres_161792, min_num_blocks_161786);
        bool loop_while_tmp_172502 = loop_cond_161793;
        int64_t x_tmp_172503 = loopres_161792;
        
        loop_while_161790 = loop_while_tmp_172502;
        x_161791 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161788 = loop_while_161790;
    smallest_pow_2_geq_than_res_161789 = x_161791;
    
    bool zzero_161794 = smallest_pow_2_geq_than_res_161789 == (int64_t) 0;
    bool nonzzero_161795 = !zzero_161794;
    bool protect_assert_disj_161796 = cond_161783 || nonzzero_161795;
    bool nonzzero_cert_161797;
    
    if (!protect_assert_disj_161796) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:153:31-35\n   #5  ftRelational.fut:152:5-153:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161798 = sdiv_safe64(zs_lhs_161784, smallest_pow_2_geq_than_res_161789);
    int64_t block_sizze_161799 = add64((int64_t) 1, zp_rhs_161798);
    bool y_161805 = slt64((int64_t) 0, n_107481);
    bool protect_assert_disj_172415 = cond_161783 || y_161805;
    bool index_certs_161806;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_107481, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:153:31-35\n   #5  ftRelational.fut:152:5-153:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161820 = slt64(smallest_pow_2_geq_than_res_161789, (int64_t) 0);
    bool valid_161821 = !bounds_invalid_upwards_161820;
    bool protect_assert_disj_172423 = cond_161783 || valid_161821;
    bool range_valid_c_161822;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161789, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:153:31-35\n   #6  ftRelational.fut:152:5-153:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161824 = slt64(block_sizze_161799, (int64_t) 0);
    bool valid_161825 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_172425 = cond_161783 || valid_161825;
    bool range_valid_c_161826;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161799, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161828 = sle64(block_sizze_161799, (int64_t) 1);
    int64_t tmp_161829 = sub64(block_sizze_161799, (int64_t) 2);
    bool bounds_invalid_upwards_161830 = slt64(tmp_161829, (int64_t) 0);
    bool valid_161832 = !bounds_invalid_upwards_161830;
    bool protect_assert_disj_161833 = cond_161828 || valid_161832;
    bool protect_assert_disj_172427 = cond_161783 || protect_assert_disj_161833;
    bool range_valid_c_161834;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161829, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172029 = (int64_t) 4 * n_107481;
    
    if (futrts_indicesWithIncrement_16319(ctx, &ext_mem_171819, xs_mem_171818, n_107481, incr_107482) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_107481; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161800 = smallest_pow_2_geq_than_res_161789 * block_sizze_161799;
    bool x_172410 = !cond_161783;
    int64_t greatest_divisor_leq_than_arg1_161803 = mul64((int64_t) 2, block_sizze_161799);
    int64_t merge_block_sizze_161804;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161803) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161804 = x_172412;
    } else {
        merge_block_sizze_161804 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_161807;
    
    if (x_172410) {
        int32_t x_172416 = ((int32_t *) xs_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161807 = x_172416;
    } else {
        reduce_arg1_161807 = 0;
    }
    
    int32_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int32_t x_172418;
        int64_t x_172419;
        int32_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161807;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_107481; i_171547++) {
            int32_t x_161811 = ((int32_t *) xs_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161817 = sle32(redout_171545, x_161811);
            int32_t defunc_0_op_res_161818;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161818 = x_161811;
            } else {
                defunc_0_op_res_161818 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161819;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161819 = i_171547;
            } else {
                defunc_0_op_res_161819 = redout_171546;
            }
            
            int32_t redout_tmp_172506 = defunc_0_op_res_161818;
            int64_t redout_tmp_172507 = defunc_0_op_res_161819;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161831 = add64((int64_t) 1, tmp_161829);
    int64_t binop_x_171822 = (int64_t) 4 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171823 = block_sizze_161799 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171826 = block_sizze_161799 * binop_x_171825;
    int64_t bytes_171836 = (int64_t) 4 * block_sizze_161799;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161799;
    bool loop_cond_161906 = slt64(block_sizze_161799, flat_dim_161800);
    bool zzero_161907 = merge_block_sizze_161804 == (int64_t) 0;
    bool nonzzero_161908 = !zzero_161907;
    
    if (cond_161783) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172917 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172917, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172918 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172918, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172919 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172919, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172920 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172920, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161789; i_171559++) {
            int64_t zp_lhs_161838 = mul64(block_sizze_161799, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161799; i_171552++) {
                int64_t k_161842 = add64(zp_lhs_161838, i_171552);
                bool cond_161843 = slt64(k_161842, n_107481);
                int32_t lifted_lambda_res_161844;
                int64_t lifted_lambda_res_161845;
                
                if (cond_161843) {
                    bool x_162514 = sle64((int64_t) 0, k_161842);
                    bool bounds_check_162515 = cond_161843 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161842, "] out of bounds for array of shape [", (long long) n_107481, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_162517 = ((int32_t *) xs_mem_171818.mem)[k_161842];
                    
                    lifted_lambda_res_161844 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161845 = k_161842;
                } else {
                    lifted_lambda_res_161844 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161845 = defunc_0_reduce_res_162662;
                }
                ((int32_t *) mem_171837)[i_171552] = lifted_lambda_res_161844;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161845;
            }
            if (!cond_161828) {
                for (int64_t i_161855 = 0; i_161855 < distance_161831; i_161855++) {
                    int64_t gt_arg1_161858 = add64((int64_t) 1, i_161855);
                    bool x_161859 = sle64((int64_t) 0, gt_arg1_161858);
                    bool y_161860 = slt64(gt_arg1_161858, block_sizze_161799);
                    bool bounds_check_161861 = x_161859 && y_161860;
                    bool index_certs_161862;
                    
                    if (!bounds_check_161861) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161858, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161864 = slt64(i_161855, block_sizze_161799);
                    bool index_certs_161865;
                    
                    if (!y_161864) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161855, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_161863 = ((int32_t *) mem_171837)[gt_arg1_161858];
                    int32_t gt_arg0_161866 = ((int32_t *) mem_171837)[i_161855];
                    bool defunc_0_leq_res_161867 = sle32(gt_arg0_161866, gt_arg1_161863);
                    bool defunc_0_lifted_gt_res_161868 = !defunc_0_leq_res_161867;
                    bool s_161869;
                    int64_t s_161872;
                    bool loop_while_161873;
                    int64_t j_161876;
                    
                    loop_while_161873 = defunc_0_lifted_gt_res_161868;
                    j_161876 = i_161855;
                    while (loop_while_161873) {
                        bool x_161877 = sle64((int64_t) 0, j_161876);
                        bool y_161878 = slt64(j_161876, block_sizze_161799);
                        bool bounds_check_161879 = x_161877 && y_161878;
                        bool index_certs_161880;
                        
                        if (!bounds_check_161879) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161876, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161883 = add64((int64_t) 1, j_161876);
                        bool x_161884 = sle64((int64_t) 0, copy_arg0_161883);
                        bool y_161885 = slt64(copy_arg0_161883, block_sizze_161799);
                        bool bounds_check_161886 = x_161884 && y_161885;
                        bool index_certs_161887;
                        
                        if (!bounds_check_161886) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161883, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_161881 = ((int32_t *) mem_171837)[j_161876];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171839)[j_161876];
                        int32_t copy_arg0_161888 = ((int32_t *) mem_171837)[copy_arg0_161883];
                        int64_t copy_arg0_161889 = ((int64_t *) mem_171839)[copy_arg0_161883];
                        
                        ((int32_t *) mem_171837)[j_161876] = copy_arg0_161888;
                        ((int64_t *) mem_171839)[j_161876] = copy_arg0_161889;
                        ((int32_t *) mem_171837)[copy_arg0_161883] = copy_arg0_161881;
                        ((int64_t *) mem_171839)[copy_arg0_161883] = copy_arg0_161882;
                        
                        int64_t tmp_161894 = sub64(j_161876, (int64_t) 1);
                        bool cond_161895 = sle64((int64_t) 0, tmp_161894);
                        bool loop_cond_161896;
                        
                        if (cond_161895) {
                            bool y_162519 = slt64(tmp_161894, block_sizze_161799);
                            bool bounds_check_162520 = cond_161895 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161894, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_162518 = ((int32_t *) mem_171837)[j_161876];
                            int32_t gt_arg0_162522 = ((int32_t *) mem_171837)[tmp_161894];
                            bool defunc_0_leq_res_162523 = sle32(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161896 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161896 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161896;
                        int64_t j_tmp_172517 = tmp_161894;
                        
                        loop_while_161873 = loop_while_tmp_172514;
                        j_161876 = j_tmp_172517;
                    }
                    s_161869 = loop_while_161873;
                    s_161872 = j_161876;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171824, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint32_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        
        int64_t data_161909;
        bool data_161910;
        int64_t data_161913;
        int64_t loop_dz2084Uz2082U_161914;
        bool loop_while_161915;
        int64_t stride_161918;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161914 = flat_dim_161800;
        loop_while_161915 = loop_cond_161906;
        stride_161918 = block_sizze_161799;
        while (loop_while_161915) {
            int64_t next_stride_161919 = mul64((int64_t) 2, stride_161918);
            bool zzero_161920 = next_stride_161919 == (int64_t) 0;
            bool nonzzero_161921 = !zzero_161920;
            bool nonzzero_cert_161922;
            
            if (!nonzzero_161921) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:153:31-35\n   #5  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161923 = sdiv64(flat_dim_161800, next_stride_161919);
            bool bounds_invalid_upwards_161924 = slt64(num_merges_161923, (int64_t) 0);
            bool valid_161925 = !bounds_invalid_upwards_161924;
            bool range_valid_c_161926;
            
            if (!valid_161925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161923, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:153:31-35\n   #6  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161928 = sub64(next_stride_161919, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161929 = sle64((int64_t) 0, m_161928);
            bool cond_161931 = slt64(next_stride_161919, (int64_t) 10);
            bool protect_assert_disj_161932 = nonzzero_161908 || cond_161931;
            bool nonzzero_cert_161933;
            
            if (!protect_assert_disj_161932) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161934 = smod_safe64(next_stride_161919, merge_block_sizze_161804);
            bool num_blocks_161935 = zeze_lhs_161934 == (int64_t) 0;
            bool protect_assert_disj_161936 = cond_161931 || num_blocks_161935;
            bool assert_c_161937;
            
            if (!protect_assert_disj_161936) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161939 = sdiv_safe64(next_stride_161919, merge_block_sizze_161804);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940 = add64((int64_t) 1, num_blocks_161939);
            int64_t j_m_i_161941 = sub64(next_stride_161919, stride_161918);
            int64_t flat_dim_161942 = merge_block_sizze_161804 * num_blocks_161939;
            bool bounds_invalid_upwards_161943 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, (int64_t) 0);
            bool empty_slice_161944 = j_m_i_161941 == (int64_t) 0;
            int64_t m_161945 = sub64(j_m_i_161941, (int64_t) 1);
            bool zzero_lte_i_161946 = sle64((int64_t) 0, stride_161918);
            bool i_lte_j_161947 = sle64(stride_161918, next_stride_161919);
            bool empty_slice_161948 = stride_161918 == (int64_t) 0;
            int64_t m_161949 = sub64(stride_161918, (int64_t) 1);
            bool bounds_invalid_upwards_161950 = slt64(num_blocks_161939, (int64_t) 0);
            bool cond_161951 = slt64((int64_t) 0, stride_161918);
            bool valid_161952 = !bounds_invalid_upwards_161943;
            int64_t i_p_m_t_s_161953 = add64(stride_161918, m_161945);
            bool zzero_leq_i_p_m_t_s_161954 = sle64((int64_t) 0, m_161949);
            bool i_p_m_t_s_leq_w_161955 = slt64(m_161949, next_stride_161919);
            bool valid_161956 = !bounds_invalid_upwards_161950;
            bool i_p_m_t_s_leq_w_161957 = slt64(m_161928, flat_dim_161942);
            bool y_161958 = slt64((int64_t) 0, j_m_i_161941);
            bool protect_assert_disj_161959 = cond_161931 || valid_161952;
            bool range_valid_c_161960;
            
            if (!protect_assert_disj_161959) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161961 = sle64((int64_t) 0, i_p_m_t_s_161953);
            bool i_p_m_t_s_leq_w_161962 = slt64(i_p_m_t_s_161953, next_stride_161919);
            bool y_161963 = zzero_leq_i_p_m_t_s_161954 && i_p_m_t_s_leq_w_161955;
            bool protect_assert_disj_161964 = cond_161931 || valid_161956;
            bool range_valid_c_161965;
            
            if (!protect_assert_disj_161964) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161939, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161966 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_161957;
            bool y_161967 = zzero_lte_i_161946 && i_p_m_t_s_leq_w_161962;
            bool forwards_ok_161968 = zzero_lte_i_161946 && y_161963;
            bool ok_or_empty_161969 = zzero_161920 || y_161966;
            bool protect_assert_disj_161970 = cond_161951 || y_161958;
            bool y_161971 = zzero_leq_i_p_m_t_s_161961 && y_161967;
            bool ok_or_empty_161972 = empty_slice_161948 || forwards_ok_161968;
            bool protect_assert_disj_161973 = cond_161931 || ok_or_empty_161969;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) flat_dim_161942, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161975 = !cond_161931;
            bool protect_assert_disj_161976 = protect_assert_disj_161970 || loop_not_taken_161975;
            bool index_certs_161977;
            
            if (!protect_assert_disj_161976) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161978 = i_lte_j_161947 && y_161971;
            bool protect_assert_disj_161979 = cond_161931 || ok_or_empty_161972;
            bool index_certs_161980;
            
            if (!protect_assert_disj_161979) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161981 = ok_or_empty_161972 || loop_not_taken_161975;
            bool index_certs_161982;
            
            if (!protect_assert_disj_161981) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161983 = empty_slice_161944 || forwards_ok_161978;
            bool protect_assert_disj_161984 = cond_161931 || ok_or_empty_161983;
            bool index_certs_161985;
            
            if (!protect_assert_disj_161984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161986 = loop_not_taken_161975 || ok_or_empty_161983;
            bool index_certs_161987;
            
            if (!protect_assert_disj_161986) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 4 * num_merges_161923;
            int64_t bytes_171905 = next_stride_161919 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161923;
            int64_t bytes_171908 = next_stride_161919 * binop_x_171907;
            bool i_lte_j_161930 = sle64((int64_t) 0, next_stride_161919);
            
            if (mem_171906_cached_sizze_172921 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172921, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172922 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172922, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940;
            int64_t binop_x_171934 = (int64_t) 4 * num_blocks_161939;
            int64_t bytes_171935 = merge_block_sizze_161804 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161939;
            int64_t bytes_171938 = merge_block_sizze_161804 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 8 * stride_161918;
            int64_t bytes_171982 = (int64_t) 16 * stride_161918;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161923; i_171580++) {
                int64_t start_161991 = mul64(next_stride_161919, i_171580);
                int64_t j_m_i_161992 = sub64(loop_dz2084Uz2082U_161914, start_161991);
                bool empty_slice_161993 = j_m_i_161992 == (int64_t) 0;
                int64_t m_161994 = sub64(j_m_i_161992, (int64_t) 1);
                int64_t i_p_m_t_s_161995 = add64(start_161991, m_161994);
                bool zzero_leq_i_p_m_t_s_161996 = sle64((int64_t) 0, i_p_m_t_s_161995);
                bool i_p_m_t_s_leq_w_161997 = slt64(i_p_m_t_s_161995, loop_dz2084Uz2082U_161914);
                bool zzero_lte_i_161998 = sle64((int64_t) 0, start_161991);
                bool i_lte_j_161999 = sle64(start_161991, loop_dz2084Uz2082U_161914);
                bool y_162000 = i_p_m_t_s_leq_w_161997 && zzero_lte_i_161998;
                bool y_162001 = zzero_leq_i_p_m_t_s_161996 && y_162000;
                bool forwards_ok_162002 = i_lte_j_161999 && y_162001;
                bool ok_or_empty_162003 = empty_slice_161993 || forwards_ok_162002;
                bool index_certs_162004;
                
                if (!ok_or_empty_162003) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161991, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161914, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_162005 = slt64(m_161928, j_m_i_161992);
                bool y_162006 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_162005;
                bool forwards_ok_162007 = i_lte_j_161930 && y_162006;
                bool ok_or_empty_162008 = zzero_161920 || forwards_ok_162007;
                bool index_certs_162009;
                
                if (!ok_or_empty_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) j_m_i_161992, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:153:31-35\n   #8  ftRelational.fut:152:5-153:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161931) {
                    int32_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161951) {
                        int32_t head_res_162552 = ((int32_t *) mem_param_171900.mem)[start_161991];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161991];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161918 + start_161991;
                        int32_t head_res_162555 = ((int32_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161919; nest_i_172527++) {
                        ((int32_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161919; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161919; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161941;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161918);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161941);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161918 + j_162566;
                                int64_t slice_162576 = start_161991 + slice_162575;
                                int32_t leq_arg1_162577 = ((int32_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161991 + i_162563;
                                int32_t leq_arg0_162582 = ((int32_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle32(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int32_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161918);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161991 + i_162563;
                            int32_t tmp_162593 = ((int32_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161941);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:153:31-35\n   #9  ftRelational.fut:152:5-153:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161918 + j_162566;
                            int64_t slice_162600 = start_161991 + slice_162599;
                            int32_t tmp_162601 = ((int32_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int32_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172923 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172923, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172924 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172924, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940; i_171566++) {
                        int64_t split_count_arg3_162071 = mul64(merge_block_sizze_161804, i_171566);
                        int64_t defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162072, &defunc_0_split_count_res_162073, &defunc_0_split_count_res_162074, &defunc_0_split_count_res_162075, &defunc_0_split_count_res_162076, (int64_t) 0, stride_161918, (int64_t) 0, j_m_i_161941, split_count_arg3_162071) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162077 = slt64((int64_t) 0, defunc_0_split_count_res_162076);
                        bool defunc_0_split_count_res_162078;
                        int64_t defunc_0_split_count_res_162079;
                        int64_t defunc_0_split_count_res_162080;
                        int64_t defunc_0_split_count_res_162081;
                        int64_t defunc_0_split_count_res_162082;
                        int64_t defunc_0_split_count_res_162083;
                        bool loop_while_162084;
                        int64_t ss_162085;
                        int64_t ss_162086;
                        int64_t tt_162087;
                        int64_t tt_162088;
                        int64_t count_162089;
                        
                        loop_while_162084 = loop_cond_162077;
                        ss_162085 = defunc_0_split_count_res_162072;
                        ss_162086 = defunc_0_split_count_res_162073;
                        tt_162087 = defunc_0_split_count_res_162074;
                        tt_162088 = defunc_0_split_count_res_162075;
                        count_162089 = defunc_0_split_count_res_162076;
                        while (loop_while_162084) {
                            int64_t zlze_lhs_162090 = sub64(ss_162086, ss_162085);
                            bool cond_162091 = sle64(zlze_lhs_162090, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162092;
                            int64_t defunc_0_lifted_step_res_162093;
                            int64_t defunc_0_lifted_step_res_162094;
                            int64_t defunc_0_lifted_step_res_162095;
                            
                            if (cond_162091) {
                                int64_t tmp_162605 = add64(tt_162087, count_162089);
                                
                                defunc_0_lifted_step_res_162092 = ss_162085;
                                defunc_0_lifted_step_res_162093 = tmp_162605;
                                defunc_0_lifted_step_res_162094 = tt_162088;
                                defunc_0_lifted_step_res_162095 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162097 = sub64(tt_162088, tt_162087);
                                bool cond_162098 = sle64(zlze_lhs_162097, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162099;
                                int64_t defunc_0_lifted_step_res_f_res_162100;
                                int64_t defunc_0_lifted_step_res_f_res_162101;
                                int64_t defunc_0_lifted_step_res_f_res_162102;
                                
                                if (cond_162098) {
                                    int64_t tmp_162606 = add64(ss_162085, count_162089);
                                    
                                    defunc_0_lifted_step_res_f_res_162099 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162100 = tt_162087;
                                    defunc_0_lifted_step_res_f_res_162101 = tt_162088;
                                    defunc_0_lifted_step_res_f_res_162102 = (int64_t) 0;
                                } else {
                                    bool cond_162104 = count_162089 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162105;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162106;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162107;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162108;
                                    
                                    if (cond_162104) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162085);
                                        bool y_162609 = slt64(ss_162085, stride_161918);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162085, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:153:31-35\n   #13 ftRelational.fut:152:5-153:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162087);
                                        bool y_162615 = slt64(tt_162087, j_m_i_161941);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162087, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:153:31-35\n   #13 ftRelational.fut:152:5-153:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161991 + ss_162085;
                                        int32_t leq_arg1_162613 = ((int32_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161918 + tt_162087;
                                        int64_t slice_162619 = start_161991 + slice_162618;
                                        int32_t leq_arg0_162620 = ((int32_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle32(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162087);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162085;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162085);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162087;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = tt_162088;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = (int64_t) 0;
                                    } else {
                                        int64_t m_162127 = sdiv64(count_162089, (int64_t) 2);
                                        int64_t n_162128 = sub64(count_162089, m_162127);
                                        bool cond_162129 = n_162128 == (int64_t) 0;
                                        int64_t zgze_lhs_162130 = add64(ss_162085, m_162127);
                                        bool cond_f_res_162131 = sle64(ss_162086, zgze_lhs_162130);
                                        bool x_162132 = !cond_162129;
                                        bool y_162133 = cond_f_res_162131 && x_162132;
                                        bool cond_162134 = cond_162129 || y_162133;
                                        bool leq_y_x_162135;
                                        
                                        if (cond_162134) {
                                            leq_y_x_162135 = 1;
                                        } else {
                                            bool x_162136 = sle64((int64_t) 0, zgze_lhs_162130);
                                            bool y_162137 = slt64(zgze_lhs_162130, stride_161918);
                                            bool bounds_check_162138 = x_162136 && y_162137;
                                            bool index_certs_162139;
                                            
                                            if (!bounds_check_162138) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162130, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:153:31-35\n   #13 ftRelational.fut:152:5-153:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162142 = add64(tt_162087, n_162128);
                                            int64_t leq_arg0_162143 = sub64(zm_lhs_162142, (int64_t) 1);
                                            bool x_162144 = sle64((int64_t) 0, leq_arg0_162143);
                                            bool y_162145 = slt64(leq_arg0_162143, j_m_i_161941);
                                            bool bounds_check_162146 = x_162144 && y_162145;
                                            bool index_certs_162147;
                                            
                                            if (!bounds_check_162146) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162143, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:153:31-35\n   #13 ftRelational.fut:152:5-153:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162140 = start_161991 + zgze_lhs_162130;
                                            int32_t leq_arg1_162141 = ((int32_t *) mem_param_171900.mem)[slice_162140];
                                            int64_t slice_162148 = stride_161918 + leq_arg0_162143;
                                            int64_t slice_162149 = start_161991 + slice_162148;
                                            int32_t leq_arg0_162150 = ((int32_t *) mem_param_171900.mem)[slice_162149];
                                            bool defunc_0_leq_res_162151 = sle32(leq_arg0_162150, leq_arg1_162141);
                                            
                                            leq_y_x_162135 = defunc_0_leq_res_162151;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                        
                                        if (leq_y_x_162135) {
                                            int64_t tmp_162626 = add64(tt_162087, n_162128);
                                            int64_t tmp_162627 = sub64(count_162089, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tt_162088;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = tmp_162627;
                                        } else {
                                            int64_t tmp_162157 = add64(tt_162087, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tt_162087;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tmp_162157;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = count_162089;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = ss_162085;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                    }
                                    defunc_0_lifted_step_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_162105;
                                    defunc_0_lifted_step_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_162106;
                                    defunc_0_lifted_step_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_162107;
                                    defunc_0_lifted_step_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_162108;
                                }
                                defunc_0_lifted_step_res_162092 = defunc_0_lifted_step_res_f_res_162099;
                                defunc_0_lifted_step_res_162093 = defunc_0_lifted_step_res_f_res_162100;
                                defunc_0_lifted_step_res_162094 = defunc_0_lifted_step_res_f_res_162101;
                                defunc_0_lifted_step_res_162095 = defunc_0_lifted_step_res_f_res_162102;
                            }
                            
                            int64_t loopres_162158;
                            int64_t loopres_162159;
                            int64_t loopres_162160;
                            int64_t loopres_162161;
                            int64_t loopres_162162;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162158, &loopres_162159, &loopres_162160, &loopres_162161, &loopres_162162, defunc_0_lifted_step_res_162092, ss_162086, defunc_0_lifted_step_res_162093, defunc_0_lifted_step_res_162094, defunc_0_lifted_step_res_162095) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162163 = slt64((int64_t) 0, loopres_162162);
                            bool loop_while_tmp_172534 = loop_cond_162163;
                            int64_t ss_tmp_172535 = loopres_162158;
                            int64_t ss_tmp_172536 = loopres_162159;
                            int64_t tt_tmp_172537 = loopres_162160;
                            int64_t tt_tmp_172538 = loopres_162161;
                            int64_t count_tmp_172539 = loopres_162162;
                            
                            loop_while_162084 = loop_while_tmp_172534;
                            ss_162085 = ss_tmp_172535;
                            ss_162086 = ss_tmp_172536;
                            tt_162087 = tt_tmp_172537;
                            tt_162088 = tt_tmp_172538;
                            count_162089 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162078 = loop_while_162084;
                        defunc_0_split_count_res_162079 = ss_162085;
                        defunc_0_split_count_res_162080 = ss_162086;
                        defunc_0_split_count_res_162081 = tt_162087;
                        defunc_0_split_count_res_162082 = tt_162088;
                        defunc_0_split_count_res_162083 = count_162089;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162079;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162081;
                    }
                    if (mem_171936_cached_sizze_172925 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172925, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172926 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172926, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161939; i_171573++) {
                        bool y_162169 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool index_certs_162171;
                        
                        if (!y_162169) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162172 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162174 = add64((int64_t) 1, i_171573);
                        bool x_162175 = sle64((int64_t) 0, tmp_162174);
                        bool y_162176 = slt64(tmp_162174, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool bounds_check_162177 = x_162175 && y_162176;
                        bool index_certs_162178;
                        
                        if (!bounds_check_162177) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162174, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162179 = ((int64_t *) mem_171919)[tmp_162174];
                        int64_t defunc_0_f_res_162180 = ((int64_t *) mem_171921)[tmp_162174];
                        int64_t merge_sequential_arg2_162181 = add64(stride_161918, defunc_0_f_res_162173);
                        int64_t merge_sequential_arg2_162182 = add64(stride_161918, defunc_0_f_res_162180);
                        int64_t j_m_i_162183 = sub64(merge_sequential_arg2_162182, merge_sequential_arg2_162181);
                        bool empty_slice_162184 = j_m_i_162183 == (int64_t) 0;
                        int64_t m_162185 = sub64(j_m_i_162183, (int64_t) 1);
                        int64_t i_p_m_t_s_162186 = add64(merge_sequential_arg2_162181, m_162185);
                        bool zzero_leq_i_p_m_t_s_162187 = sle64((int64_t) 0, i_p_m_t_s_162186);
                        bool i_p_m_t_s_leq_w_162188 = slt64(i_p_m_t_s_162186, next_stride_161919);
                        bool zzero_lte_i_162189 = sle64((int64_t) 0, merge_sequential_arg2_162181);
                        bool i_lte_j_162190 = sle64(merge_sequential_arg2_162181, merge_sequential_arg2_162182);
                        bool y_162191 = i_p_m_t_s_leq_w_162188 && zzero_lte_i_162189;
                        bool y_162192 = zzero_leq_i_p_m_t_s_162187 && y_162191;
                        bool forwards_ok_162193 = i_lte_j_162190 && y_162192;
                        bool ok_or_empty_162194 = empty_slice_162184 || forwards_ok_162193;
                        bool index_certs_162195;
                        
                        if (!ok_or_empty_162194) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162181, ":", (long long) merge_sequential_arg2_162182, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162196 = sub64(defunc_0_f_res_162179, defunc_0_f_res_162172);
                        bool empty_slice_162197 = j_m_i_162196 == (int64_t) 0;
                        int64_t m_162198 = sub64(j_m_i_162196, (int64_t) 1);
                        int64_t i_p_m_t_s_162199 = add64(defunc_0_f_res_162172, m_162198);
                        bool zzero_leq_i_p_m_t_s_162200 = sle64((int64_t) 0, i_p_m_t_s_162199);
                        bool i_p_m_t_s_leq_w_162201 = slt64(i_p_m_t_s_162199, next_stride_161919);
                        bool zzero_lte_i_162202 = sle64((int64_t) 0, defunc_0_f_res_162172);
                        bool i_lte_j_162203 = sle64(defunc_0_f_res_162172, defunc_0_f_res_162179);
                        bool y_162204 = i_p_m_t_s_leq_w_162201 && zzero_lte_i_162202;
                        bool y_162205 = zzero_leq_i_p_m_t_s_162200 && y_162204;
                        bool forwards_ok_162206 = i_lte_j_162203 && y_162205;
                        bool ok_or_empty_162207 = empty_slice_162197 || forwards_ok_162206;
                        bool index_certs_162208;
                        
                        if (!ok_or_empty_162207) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162172, ":", (long long) defunc_0_f_res_162179, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:153:31-35\n   #10 ftRelational.fut:152:5-153:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162209 = slt64((int64_t) 0, j_m_i_162196);
                        int32_t dummy_162210;
                        int64_t dummy_162211;
                        
                        if (cond_162209) {
                            bool index_certs_162628;
                            
                            if (!cond_162209) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:153:31-35\n   #12 ftRelational.fut:152:5-153:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161991 + defunc_0_f_res_162172;
                            int32_t head_res_162630 = ((int32_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162210 = head_res_162630;
                            dummy_162211 = head_res_162631;
                        } else {
                            bool y_162216 = slt64((int64_t) 0, j_m_i_162183);
                            bool index_certs_162217;
                            
                            if (!y_162216) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:153:31-35\n   #12 ftRelational.fut:152:5-153:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162218 = start_161991 + merge_sequential_arg2_162181;
                            int32_t head_res_162219 = ((int32_t *) mem_param_171900.mem)[slice_162218];
                            int64_t head_res_162220 = ((int64_t *) mem_param_171903.mem)[slice_162218];
                            
                            dummy_162210 = head_res_162219;
                            dummy_162211 = head_res_162220;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161804; nest_i_172542++) {
                            ((int32_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + nest_i_172542] = dummy_162210;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161804; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + nest_i_172543] = dummy_162211;
                        }
                        
                        int64_t data_162223;
                        int64_t i_162227 = (int64_t) 0;
                        
                        for (int64_t k_162226 = 0; k_162226 < merge_block_sizze_161804; k_162226++) {
                            int64_t j_162230 = sub64(k_162226, i_162227);
                            bool cond_162231 = j_162230 == j_m_i_162183;
                            bool cond_162232;
                            
                            if (cond_162231) {
                                cond_162232 = 1;
                            } else {
                                bool cond_162233 = slt64(i_162227, j_m_i_162196);
                                bool cond_f_res_162234;
                                
                                if (cond_162233) {
                                    bool x_162632 = sle64((int64_t) 0, j_162230);
                                    bool y_162633 = slt64(j_162230, j_m_i_162183);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162227);
                                    bool bounds_check_162640 = cond_162233 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162181 + j_162230;
                                    int64_t slice_162637 = start_161991 + slice_162636;
                                    int32_t leq_arg1_162638 = ((int32_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162172 + i_162227;
                                    int64_t slice_162643 = start_161991 + slice_162642;
                                    int32_t leq_arg0_162644 = ((int32_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle32(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162234 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162234 = 0;
                                }
                                cond_162232 = cond_f_res_162234;
                            }
                            
                            int64_t loopres_162249;
                            int32_t loopres_162250;
                            int64_t loopres_162251;
                            
                            if (cond_162232) {
                                bool x_162647 = sle64((int64_t) 0, i_162227);
                                bool y_162648 = slt64(i_162227, j_m_i_162196);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162227);
                                int64_t slice_162651 = defunc_0_f_res_162172 + i_162227;
                                int64_t slice_162652 = start_161991 + slice_162651;
                                int32_t tmp_162653 = ((int32_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162249 = tmp_162646;
                                loopres_162250 = tmp_162653;
                                loopres_162251 = tmp_162654;
                            } else {
                                bool x_162261 = sle64((int64_t) 0, j_162230);
                                bool y_162262 = slt64(j_162230, j_m_i_162183);
                                bool bounds_check_162263 = x_162261 && y_162262;
                                bool index_certs_162264;
                                
                                if (!bounds_check_162263) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:153:31-35\n   #11 ftRelational.fut:152:5-153:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162265 = merge_sequential_arg2_162181 + j_162230;
                                int64_t slice_162266 = start_161991 + slice_162265;
                                int32_t tmp_162267 = ((int32_t *) mem_param_171900.mem)[slice_162266];
                                int64_t tmp_162268 = ((int64_t *) mem_param_171903.mem)[slice_162266];
                                
                                loopres_162249 = i_162227;
                                loopres_162250 = tmp_162267;
                                loopres_162251 = tmp_162268;
                            }
                            ((int32_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162250;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162251;
                            
                            int64_t i_tmp_172544 = loopres_162249;
                            
                            i_162227 = i_tmp_172544;
                        }
                        data_162223 = i_162227;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint32_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171906, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162275 = next_stride_161919 * num_merges_161923;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint32_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            
            bool loop_cond_162278 = slt64(next_stride_161919, flat_dim_161800);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162275;
            bool loop_while_tmp_172521 = loop_cond_162278;
            int64_t stride_tmp_172524 = next_stride_161919;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161914 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161915 = loop_while_tmp_172521;
            stride_161918 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161909 = loop_dz2084Uz2082U_161914;
        data_161910 = loop_while_161915;
        data_161913 = stride_161918;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162279 = n_107481 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162280 = sle64((int64_t) 0, zs_lhs_161784);
        bool i_p_m_t_s_leq_w_162281 = slt64(zs_lhs_161784, data_161909);
        bool y_162282 = zzero_leq_i_p_m_t_s_162280 && i_p_m_t_s_leq_w_162281;
        bool ok_or_empty_162283 = empty_slice_162279 || y_162282;
        bool index_certs_162284;
        
        if (!ok_or_empty_162283) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_107481, "] out of bounds for array of shape [", (long long) data_161909, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:153:31-35\n   #6  ftRelational.fut:152:5-153:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_107481; i_171587++) {
        int64_t eta_p_162292 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162293 = sle64((int64_t) 0, eta_p_162292);
        bool y_162294 = slt64(eta_p_162292, n_107481);
        bool bounds_check_162295 = x_162293 && y_162294;
        bool index_certs_162296;
        
        if (!bounds_check_162295) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162292, "] out of bounds for array of shape [", (long long) n_107481, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:153:31-35\n   #5  ftRelational.fut:152:5-153:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162297 = ((int64_t *) ext_mem_171819.mem)[eta_p_162292];
        int32_t lifted_lambda_res_162298 = ((int32_t *) xs_mem_171818.mem)[eta_p_162292];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162297;
        ((int32_t *) mem_172030.mem)[i_171587] = lifted_lambda_res_162298;
    }
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172915, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172916, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_172927, struct memblock *mem_out_p_172928, struct memblock xs_mem_171818, int64_t n_109622, int64_t incr_109623)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172929 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172930 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172931 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172932 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172933 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172934 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172935 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172936 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172937 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172938 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_109622;
    bool cond_161783 = sle64(n_109622, (int64_t) 1);
    int64_t zs_lhs_161784 = sub64(n_109622, (int64_t) 1);
    int64_t zp_rhs_161785 = sdiv_safe64(zs_lhs_161784, (int64_t) 20);
    int64_t min_num_blocks_161786 = add64((int64_t) 1, zp_rhs_161785);
    bool loop_cond_161787 = slt64((int64_t) 1, min_num_blocks_161786);
    bool smallest_pow_2_geq_than_res_161788;
    int64_t smallest_pow_2_geq_than_res_161789;
    bool loop_while_161790;
    int64_t x_161791;
    
    loop_while_161790 = loop_cond_161787;
    x_161791 = (int64_t) 1;
    while (loop_while_161790) {
        int64_t loopres_161792 = mul64((int64_t) 2, x_161791);
        bool loop_cond_161793 = slt64(loopres_161792, min_num_blocks_161786);
        bool loop_while_tmp_172502 = loop_cond_161793;
        int64_t x_tmp_172503 = loopres_161792;
        
        loop_while_161790 = loop_while_tmp_172502;
        x_161791 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161788 = loop_while_161790;
    smallest_pow_2_geq_than_res_161789 = x_161791;
    
    bool zzero_161794 = smallest_pow_2_geq_than_res_161789 == (int64_t) 0;
    bool nonzzero_161795 = !zzero_161794;
    bool protect_assert_disj_161796 = cond_161783 || nonzzero_161795;
    bool nonzzero_cert_161797;
    
    if (!protect_assert_disj_161796) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:155:31-35\n   #5  ftRelational.fut:154:5-155:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161798 = sdiv_safe64(zs_lhs_161784, smallest_pow_2_geq_than_res_161789);
    int64_t block_sizze_161799 = add64((int64_t) 1, zp_rhs_161798);
    bool y_161805 = slt64((int64_t) 0, n_109622);
    bool protect_assert_disj_172415 = cond_161783 || y_161805;
    bool index_certs_161806;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_109622, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:155:31-35\n   #5  ftRelational.fut:154:5-155:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161820 = slt64(smallest_pow_2_geq_than_res_161789, (int64_t) 0);
    bool valid_161821 = !bounds_invalid_upwards_161820;
    bool protect_assert_disj_172423 = cond_161783 || valid_161821;
    bool range_valid_c_161822;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161789, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:155:31-35\n   #6  ftRelational.fut:154:5-155:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161824 = slt64(block_sizze_161799, (int64_t) 0);
    bool valid_161825 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_172425 = cond_161783 || valid_161825;
    bool range_valid_c_161826;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161799, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161828 = sle64(block_sizze_161799, (int64_t) 1);
    int64_t tmp_161829 = sub64(block_sizze_161799, (int64_t) 2);
    bool bounds_invalid_upwards_161830 = slt64(tmp_161829, (int64_t) 0);
    bool valid_161832 = !bounds_invalid_upwards_161830;
    bool protect_assert_disj_161833 = cond_161828 || valid_161832;
    bool protect_assert_disj_172427 = cond_161783 || protect_assert_disj_161833;
    bool range_valid_c_161834;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161829, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    if (futrts_indicesWithIncrement_16341(ctx, &ext_mem_171819, xs_mem_171818, n_109622, incr_109623) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_109622; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161800 = smallest_pow_2_geq_than_res_161789 * block_sizze_161799;
    bool x_172410 = !cond_161783;
    int64_t greatest_divisor_leq_than_arg1_161803 = mul64((int64_t) 2, block_sizze_161799);
    int64_t merge_block_sizze_161804;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161803) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161804 = x_172412;
    } else {
        merge_block_sizze_161804 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_161807;
    
    if (x_172410) {
        int64_t x_172416 = ((int64_t *) xs_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161807 = x_172416;
    } else {
        reduce_arg1_161807 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int64_t x_172418;
        int64_t x_172419;
        int64_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161807;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_109622; i_171547++) {
            int64_t x_161811 = ((int64_t *) xs_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161817 = sle64(redout_171545, x_161811);
            int64_t defunc_0_op_res_161818;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161818 = x_161811;
            } else {
                defunc_0_op_res_161818 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161819;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161819 = i_171547;
            } else {
                defunc_0_op_res_161819 = redout_171546;
            }
            
            int64_t redout_tmp_172506 = defunc_0_op_res_161818;
            int64_t redout_tmp_172507 = defunc_0_op_res_161819;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = (int64_t) 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161831 = add64((int64_t) 1, tmp_161829);
    int64_t binop_x_171822 = (int64_t) 8 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171823 = block_sizze_161799 * binop_x_171822;
    int64_t bytes_171836 = (int64_t) 8 * block_sizze_161799;
    bool loop_cond_161906 = slt64(block_sizze_161799, flat_dim_161800);
    bool zzero_161907 = merge_block_sizze_161804 == (int64_t) 0;
    bool nonzzero_161908 = !zzero_161907;
    
    if (cond_161783) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172929 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172929, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172930 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172930, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172931 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172931, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172932 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172932, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161789; i_171559++) {
            int64_t zp_lhs_161838 = mul64(block_sizze_161799, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161799; i_171552++) {
                int64_t k_161842 = add64(zp_lhs_161838, i_171552);
                bool cond_161843 = slt64(k_161842, n_109622);
                int64_t lifted_lambda_res_161844;
                int64_t lifted_lambda_res_161845;
                
                if (cond_161843) {
                    bool x_162514 = sle64((int64_t) 0, k_161842);
                    bool bounds_check_162515 = cond_161843 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161842, "] out of bounds for array of shape [", (long long) n_109622, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_162517 = ((int64_t *) xs_mem_171818.mem)[k_161842];
                    
                    lifted_lambda_res_161844 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161845 = k_161842;
                } else {
                    lifted_lambda_res_161844 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161845 = defunc_0_reduce_res_162662;
                }
                ((int64_t *) mem_171837)[i_171552] = lifted_lambda_res_161844;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161845;
            }
            if (!cond_161828) {
                for (int64_t i_161855 = 0; i_161855 < distance_161831; i_161855++) {
                    int64_t gt_arg1_161858 = add64((int64_t) 1, i_161855);
                    bool x_161859 = sle64((int64_t) 0, gt_arg1_161858);
                    bool y_161860 = slt64(gt_arg1_161858, block_sizze_161799);
                    bool bounds_check_161861 = x_161859 && y_161860;
                    bool index_certs_161862;
                    
                    if (!bounds_check_161861) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161858, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161864 = slt64(i_161855, block_sizze_161799);
                    bool index_certs_161865;
                    
                    if (!y_161864) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161855, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_161863 = ((int64_t *) mem_171837)[gt_arg1_161858];
                    int64_t gt_arg0_161866 = ((int64_t *) mem_171837)[i_161855];
                    bool defunc_0_leq_res_161867 = sle64(gt_arg0_161866, gt_arg1_161863);
                    bool defunc_0_lifted_gt_res_161868 = !defunc_0_leq_res_161867;
                    bool s_161869;
                    int64_t s_161872;
                    bool loop_while_161873;
                    int64_t j_161876;
                    
                    loop_while_161873 = defunc_0_lifted_gt_res_161868;
                    j_161876 = i_161855;
                    while (loop_while_161873) {
                        bool x_161877 = sle64((int64_t) 0, j_161876);
                        bool y_161878 = slt64(j_161876, block_sizze_161799);
                        bool bounds_check_161879 = x_161877 && y_161878;
                        bool index_certs_161880;
                        
                        if (!bounds_check_161879) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161876, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161883 = add64((int64_t) 1, j_161876);
                        bool x_161884 = sle64((int64_t) 0, copy_arg0_161883);
                        bool y_161885 = slt64(copy_arg0_161883, block_sizze_161799);
                        bool bounds_check_161886 = x_161884 && y_161885;
                        bool index_certs_161887;
                        
                        if (!bounds_check_161886) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161883, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161881 = ((int64_t *) mem_171837)[j_161876];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171839)[j_161876];
                        int64_t copy_arg0_161888 = ((int64_t *) mem_171837)[copy_arg0_161883];
                        int64_t copy_arg0_161889 = ((int64_t *) mem_171839)[copy_arg0_161883];
                        
                        ((int64_t *) mem_171837)[j_161876] = copy_arg0_161888;
                        ((int64_t *) mem_171839)[j_161876] = copy_arg0_161889;
                        ((int64_t *) mem_171837)[copy_arg0_161883] = copy_arg0_161881;
                        ((int64_t *) mem_171839)[copy_arg0_161883] = copy_arg0_161882;
                        
                        int64_t tmp_161894 = sub64(j_161876, (int64_t) 1);
                        bool cond_161895 = sle64((int64_t) 0, tmp_161894);
                        bool loop_cond_161896;
                        
                        if (cond_161895) {
                            bool y_162519 = slt64(tmp_161894, block_sizze_161799);
                            bool bounds_check_162520 = cond_161895 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161894, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_162518 = ((int64_t *) mem_171837)[j_161876];
                            int64_t gt_arg0_162522 = ((int64_t *) mem_171837)[tmp_161894];
                            bool defunc_0_leq_res_162523 = sle64(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161896 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161896 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161896;
                        int64_t j_tmp_172517 = tmp_161894;
                        
                        loop_while_161873 = loop_while_tmp_172514;
                        j_161876 = j_tmp_172517;
                    }
                    s_161869 = loop_while_161873;
                    s_161872 = j_161876;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171824, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        if (memblock_alloc(ctx, &mem_171896, bytes_171823, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        
        int64_t data_161909;
        bool data_161910;
        int64_t data_161913;
        int64_t loop_dz2084Uz2082U_161914;
        bool loop_while_161915;
        int64_t stride_161918;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161914 = flat_dim_161800;
        loop_while_161915 = loop_cond_161906;
        stride_161918 = block_sizze_161799;
        while (loop_while_161915) {
            int64_t next_stride_161919 = mul64((int64_t) 2, stride_161918);
            bool zzero_161920 = next_stride_161919 == (int64_t) 0;
            bool nonzzero_161921 = !zzero_161920;
            bool nonzzero_cert_161922;
            
            if (!nonzzero_161921) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:155:31-35\n   #5  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161923 = sdiv64(flat_dim_161800, next_stride_161919);
            bool bounds_invalid_upwards_161924 = slt64(num_merges_161923, (int64_t) 0);
            bool valid_161925 = !bounds_invalid_upwards_161924;
            bool range_valid_c_161926;
            
            if (!valid_161925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161923, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:155:31-35\n   #6  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161928 = sub64(next_stride_161919, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161929 = sle64((int64_t) 0, m_161928);
            bool cond_161931 = slt64(next_stride_161919, (int64_t) 10);
            bool protect_assert_disj_161932 = nonzzero_161908 || cond_161931;
            bool nonzzero_cert_161933;
            
            if (!protect_assert_disj_161932) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161934 = smod_safe64(next_stride_161919, merge_block_sizze_161804);
            bool num_blocks_161935 = zeze_lhs_161934 == (int64_t) 0;
            bool protect_assert_disj_161936 = cond_161931 || num_blocks_161935;
            bool assert_c_161937;
            
            if (!protect_assert_disj_161936) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161939 = sdiv_safe64(next_stride_161919, merge_block_sizze_161804);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940 = add64((int64_t) 1, num_blocks_161939);
            int64_t j_m_i_161941 = sub64(next_stride_161919, stride_161918);
            int64_t flat_dim_161942 = merge_block_sizze_161804 * num_blocks_161939;
            bool bounds_invalid_upwards_161943 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, (int64_t) 0);
            bool empty_slice_161944 = j_m_i_161941 == (int64_t) 0;
            int64_t m_161945 = sub64(j_m_i_161941, (int64_t) 1);
            bool zzero_lte_i_161946 = sle64((int64_t) 0, stride_161918);
            bool i_lte_j_161947 = sle64(stride_161918, next_stride_161919);
            bool empty_slice_161948 = stride_161918 == (int64_t) 0;
            int64_t m_161949 = sub64(stride_161918, (int64_t) 1);
            bool bounds_invalid_upwards_161950 = slt64(num_blocks_161939, (int64_t) 0);
            bool cond_161951 = slt64((int64_t) 0, stride_161918);
            bool valid_161952 = !bounds_invalid_upwards_161943;
            int64_t i_p_m_t_s_161953 = add64(stride_161918, m_161945);
            bool zzero_leq_i_p_m_t_s_161954 = sle64((int64_t) 0, m_161949);
            bool i_p_m_t_s_leq_w_161955 = slt64(m_161949, next_stride_161919);
            bool valid_161956 = !bounds_invalid_upwards_161950;
            bool i_p_m_t_s_leq_w_161957 = slt64(m_161928, flat_dim_161942);
            bool y_161958 = slt64((int64_t) 0, j_m_i_161941);
            bool protect_assert_disj_161959 = cond_161931 || valid_161952;
            bool range_valid_c_161960;
            
            if (!protect_assert_disj_161959) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161961 = sle64((int64_t) 0, i_p_m_t_s_161953);
            bool i_p_m_t_s_leq_w_161962 = slt64(i_p_m_t_s_161953, next_stride_161919);
            bool y_161963 = zzero_leq_i_p_m_t_s_161954 && i_p_m_t_s_leq_w_161955;
            bool protect_assert_disj_161964 = cond_161931 || valid_161956;
            bool range_valid_c_161965;
            
            if (!protect_assert_disj_161964) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161939, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161966 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_161957;
            bool y_161967 = zzero_lte_i_161946 && i_p_m_t_s_leq_w_161962;
            bool forwards_ok_161968 = zzero_lte_i_161946 && y_161963;
            bool ok_or_empty_161969 = zzero_161920 || y_161966;
            bool protect_assert_disj_161970 = cond_161951 || y_161958;
            bool y_161971 = zzero_leq_i_p_m_t_s_161961 && y_161967;
            bool ok_or_empty_161972 = empty_slice_161948 || forwards_ok_161968;
            bool protect_assert_disj_161973 = cond_161931 || ok_or_empty_161969;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) flat_dim_161942, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161975 = !cond_161931;
            bool protect_assert_disj_161976 = protect_assert_disj_161970 || loop_not_taken_161975;
            bool index_certs_161977;
            
            if (!protect_assert_disj_161976) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161978 = i_lte_j_161947 && y_161971;
            bool protect_assert_disj_161979 = cond_161931 || ok_or_empty_161972;
            bool index_certs_161980;
            
            if (!protect_assert_disj_161979) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161981 = ok_or_empty_161972 || loop_not_taken_161975;
            bool index_certs_161982;
            
            if (!protect_assert_disj_161981) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161983 = empty_slice_161944 || forwards_ok_161978;
            bool protect_assert_disj_161984 = cond_161931 || ok_or_empty_161983;
            bool index_certs_161985;
            
            if (!protect_assert_disj_161984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161986 = loop_not_taken_161975 || ok_or_empty_161983;
            bool index_certs_161987;
            
            if (!protect_assert_disj_161986) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 8 * num_merges_161923;
            int64_t bytes_171905 = next_stride_161919 * binop_x_171904;
            bool i_lte_j_161930 = sle64((int64_t) 0, next_stride_161919);
            
            if (mem_171906_cached_sizze_172933 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172933, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172934 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172934, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940;
            int64_t binop_x_171934 = (int64_t) 8 * num_blocks_161939;
            int64_t bytes_171935 = merge_block_sizze_161804 * binop_x_171934;
            int64_t bytes_171980 = (int64_t) 16 * stride_161918;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161923; i_171580++) {
                int64_t start_161991 = mul64(next_stride_161919, i_171580);
                int64_t j_m_i_161992 = sub64(loop_dz2084Uz2082U_161914, start_161991);
                bool empty_slice_161993 = j_m_i_161992 == (int64_t) 0;
                int64_t m_161994 = sub64(j_m_i_161992, (int64_t) 1);
                int64_t i_p_m_t_s_161995 = add64(start_161991, m_161994);
                bool zzero_leq_i_p_m_t_s_161996 = sle64((int64_t) 0, i_p_m_t_s_161995);
                bool i_p_m_t_s_leq_w_161997 = slt64(i_p_m_t_s_161995, loop_dz2084Uz2082U_161914);
                bool zzero_lte_i_161998 = sle64((int64_t) 0, start_161991);
                bool i_lte_j_161999 = sle64(start_161991, loop_dz2084Uz2082U_161914);
                bool y_162000 = i_p_m_t_s_leq_w_161997 && zzero_lte_i_161998;
                bool y_162001 = zzero_leq_i_p_m_t_s_161996 && y_162000;
                bool forwards_ok_162002 = i_lte_j_161999 && y_162001;
                bool ok_or_empty_162003 = empty_slice_161993 || forwards_ok_162002;
                bool index_certs_162004;
                
                if (!ok_or_empty_162003) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161991, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161914, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_162005 = slt64(m_161928, j_m_i_161992);
                bool y_162006 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_162005;
                bool forwards_ok_162007 = i_lte_j_161930 && y_162006;
                bool ok_or_empty_162008 = zzero_161920 || forwards_ok_162007;
                bool index_certs_162009;
                
                if (!ok_or_empty_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) j_m_i_161992, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:155:31-35\n   #8  ftRelational.fut:154:5-155:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161931) {
                    int64_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161951) {
                        int64_t head_res_162552 = ((int64_t *) mem_param_171900.mem)[start_161991];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161991];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161918 + start_161991;
                        int64_t head_res_162555 = ((int64_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161919; nest_i_172527++) {
                        ((int64_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171980, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161919; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161919; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161941;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161918);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161941);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161918 + j_162566;
                                int64_t slice_162576 = start_161991 + slice_162575;
                                int64_t leq_arg1_162577 = ((int64_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161991 + i_162563;
                                int64_t leq_arg0_162582 = ((int64_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle64(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int64_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161918);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161991 + i_162563;
                            int64_t tmp_162593 = ((int64_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161941);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:155:31-35\n   #9  ftRelational.fut:154:5-155:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161918 + j_162566;
                            int64_t slice_162600 = start_161991 + slice_162599;
                            int64_t tmp_162601 = ((int64_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int64_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172935 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172935, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172936 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172936, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940; i_171566++) {
                        int64_t split_count_arg3_162071 = mul64(merge_block_sizze_161804, i_171566);
                        int64_t defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162072, &defunc_0_split_count_res_162073, &defunc_0_split_count_res_162074, &defunc_0_split_count_res_162075, &defunc_0_split_count_res_162076, (int64_t) 0, stride_161918, (int64_t) 0, j_m_i_161941, split_count_arg3_162071) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162077 = slt64((int64_t) 0, defunc_0_split_count_res_162076);
                        bool defunc_0_split_count_res_162078;
                        int64_t defunc_0_split_count_res_162079;
                        int64_t defunc_0_split_count_res_162080;
                        int64_t defunc_0_split_count_res_162081;
                        int64_t defunc_0_split_count_res_162082;
                        int64_t defunc_0_split_count_res_162083;
                        bool loop_while_162084;
                        int64_t ss_162085;
                        int64_t ss_162086;
                        int64_t tt_162087;
                        int64_t tt_162088;
                        int64_t count_162089;
                        
                        loop_while_162084 = loop_cond_162077;
                        ss_162085 = defunc_0_split_count_res_162072;
                        ss_162086 = defunc_0_split_count_res_162073;
                        tt_162087 = defunc_0_split_count_res_162074;
                        tt_162088 = defunc_0_split_count_res_162075;
                        count_162089 = defunc_0_split_count_res_162076;
                        while (loop_while_162084) {
                            int64_t zlze_lhs_162090 = sub64(ss_162086, ss_162085);
                            bool cond_162091 = sle64(zlze_lhs_162090, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162092;
                            int64_t defunc_0_lifted_step_res_162093;
                            int64_t defunc_0_lifted_step_res_162094;
                            int64_t defunc_0_lifted_step_res_162095;
                            
                            if (cond_162091) {
                                int64_t tmp_162605 = add64(tt_162087, count_162089);
                                
                                defunc_0_lifted_step_res_162092 = ss_162085;
                                defunc_0_lifted_step_res_162093 = tmp_162605;
                                defunc_0_lifted_step_res_162094 = tt_162088;
                                defunc_0_lifted_step_res_162095 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162097 = sub64(tt_162088, tt_162087);
                                bool cond_162098 = sle64(zlze_lhs_162097, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162099;
                                int64_t defunc_0_lifted_step_res_f_res_162100;
                                int64_t defunc_0_lifted_step_res_f_res_162101;
                                int64_t defunc_0_lifted_step_res_f_res_162102;
                                
                                if (cond_162098) {
                                    int64_t tmp_162606 = add64(ss_162085, count_162089);
                                    
                                    defunc_0_lifted_step_res_f_res_162099 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162100 = tt_162087;
                                    defunc_0_lifted_step_res_f_res_162101 = tt_162088;
                                    defunc_0_lifted_step_res_f_res_162102 = (int64_t) 0;
                                } else {
                                    bool cond_162104 = count_162089 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162105;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162106;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162107;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162108;
                                    
                                    if (cond_162104) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162085);
                                        bool y_162609 = slt64(ss_162085, stride_161918);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162085, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:155:31-35\n   #13 ftRelational.fut:154:5-155:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162087);
                                        bool y_162615 = slt64(tt_162087, j_m_i_161941);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162087, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:155:31-35\n   #13 ftRelational.fut:154:5-155:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161991 + ss_162085;
                                        int64_t leq_arg1_162613 = ((int64_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161918 + tt_162087;
                                        int64_t slice_162619 = start_161991 + slice_162618;
                                        int64_t leq_arg0_162620 = ((int64_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle64(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162087);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162085;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162085);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162087;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = tt_162088;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = (int64_t) 0;
                                    } else {
                                        int64_t m_162127 = sdiv64(count_162089, (int64_t) 2);
                                        int64_t n_162128 = sub64(count_162089, m_162127);
                                        bool cond_162129 = n_162128 == (int64_t) 0;
                                        int64_t zgze_lhs_162130 = add64(ss_162085, m_162127);
                                        bool cond_f_res_162131 = sle64(ss_162086, zgze_lhs_162130);
                                        bool x_162132 = !cond_162129;
                                        bool y_162133 = cond_f_res_162131 && x_162132;
                                        bool cond_162134 = cond_162129 || y_162133;
                                        bool leq_y_x_162135;
                                        
                                        if (cond_162134) {
                                            leq_y_x_162135 = 1;
                                        } else {
                                            bool x_162136 = sle64((int64_t) 0, zgze_lhs_162130);
                                            bool y_162137 = slt64(zgze_lhs_162130, stride_161918);
                                            bool bounds_check_162138 = x_162136 && y_162137;
                                            bool index_certs_162139;
                                            
                                            if (!bounds_check_162138) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162130, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:155:31-35\n   #13 ftRelational.fut:154:5-155:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162142 = add64(tt_162087, n_162128);
                                            int64_t leq_arg0_162143 = sub64(zm_lhs_162142, (int64_t) 1);
                                            bool x_162144 = sle64((int64_t) 0, leq_arg0_162143);
                                            bool y_162145 = slt64(leq_arg0_162143, j_m_i_161941);
                                            bool bounds_check_162146 = x_162144 && y_162145;
                                            bool index_certs_162147;
                                            
                                            if (!bounds_check_162146) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162143, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:155:31-35\n   #13 ftRelational.fut:154:5-155:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162140 = start_161991 + zgze_lhs_162130;
                                            int64_t leq_arg1_162141 = ((int64_t *) mem_param_171900.mem)[slice_162140];
                                            int64_t slice_162148 = stride_161918 + leq_arg0_162143;
                                            int64_t slice_162149 = start_161991 + slice_162148;
                                            int64_t leq_arg0_162150 = ((int64_t *) mem_param_171900.mem)[slice_162149];
                                            bool defunc_0_leq_res_162151 = sle64(leq_arg0_162150, leq_arg1_162141);
                                            
                                            leq_y_x_162135 = defunc_0_leq_res_162151;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                        
                                        if (leq_y_x_162135) {
                                            int64_t tmp_162626 = add64(tt_162087, n_162128);
                                            int64_t tmp_162627 = sub64(count_162089, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tt_162088;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = tmp_162627;
                                        } else {
                                            int64_t tmp_162157 = add64(tt_162087, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tt_162087;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tmp_162157;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = count_162089;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = ss_162085;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                    }
                                    defunc_0_lifted_step_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_162105;
                                    defunc_0_lifted_step_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_162106;
                                    defunc_0_lifted_step_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_162107;
                                    defunc_0_lifted_step_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_162108;
                                }
                                defunc_0_lifted_step_res_162092 = defunc_0_lifted_step_res_f_res_162099;
                                defunc_0_lifted_step_res_162093 = defunc_0_lifted_step_res_f_res_162100;
                                defunc_0_lifted_step_res_162094 = defunc_0_lifted_step_res_f_res_162101;
                                defunc_0_lifted_step_res_162095 = defunc_0_lifted_step_res_f_res_162102;
                            }
                            
                            int64_t loopres_162158;
                            int64_t loopres_162159;
                            int64_t loopres_162160;
                            int64_t loopres_162161;
                            int64_t loopres_162162;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162158, &loopres_162159, &loopres_162160, &loopres_162161, &loopres_162162, defunc_0_lifted_step_res_162092, ss_162086, defunc_0_lifted_step_res_162093, defunc_0_lifted_step_res_162094, defunc_0_lifted_step_res_162095) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162163 = slt64((int64_t) 0, loopres_162162);
                            bool loop_while_tmp_172534 = loop_cond_162163;
                            int64_t ss_tmp_172535 = loopres_162158;
                            int64_t ss_tmp_172536 = loopres_162159;
                            int64_t tt_tmp_172537 = loopres_162160;
                            int64_t tt_tmp_172538 = loopres_162161;
                            int64_t count_tmp_172539 = loopres_162162;
                            
                            loop_while_162084 = loop_while_tmp_172534;
                            ss_162085 = ss_tmp_172535;
                            ss_162086 = ss_tmp_172536;
                            tt_162087 = tt_tmp_172537;
                            tt_162088 = tt_tmp_172538;
                            count_162089 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162078 = loop_while_162084;
                        defunc_0_split_count_res_162079 = ss_162085;
                        defunc_0_split_count_res_162080 = ss_162086;
                        defunc_0_split_count_res_162081 = tt_162087;
                        defunc_0_split_count_res_162082 = tt_162088;
                        defunc_0_split_count_res_162083 = count_162089;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162079;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162081;
                    }
                    if (mem_171936_cached_sizze_172937 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172937, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172938 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172938, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161939; i_171573++) {
                        bool y_162169 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool index_certs_162171;
                        
                        if (!y_162169) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162172 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162174 = add64((int64_t) 1, i_171573);
                        bool x_162175 = sle64((int64_t) 0, tmp_162174);
                        bool y_162176 = slt64(tmp_162174, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool bounds_check_162177 = x_162175 && y_162176;
                        bool index_certs_162178;
                        
                        if (!bounds_check_162177) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162174, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162179 = ((int64_t *) mem_171919)[tmp_162174];
                        int64_t defunc_0_f_res_162180 = ((int64_t *) mem_171921)[tmp_162174];
                        int64_t merge_sequential_arg2_162181 = add64(stride_161918, defunc_0_f_res_162173);
                        int64_t merge_sequential_arg2_162182 = add64(stride_161918, defunc_0_f_res_162180);
                        int64_t j_m_i_162183 = sub64(merge_sequential_arg2_162182, merge_sequential_arg2_162181);
                        bool empty_slice_162184 = j_m_i_162183 == (int64_t) 0;
                        int64_t m_162185 = sub64(j_m_i_162183, (int64_t) 1);
                        int64_t i_p_m_t_s_162186 = add64(merge_sequential_arg2_162181, m_162185);
                        bool zzero_leq_i_p_m_t_s_162187 = sle64((int64_t) 0, i_p_m_t_s_162186);
                        bool i_p_m_t_s_leq_w_162188 = slt64(i_p_m_t_s_162186, next_stride_161919);
                        bool zzero_lte_i_162189 = sle64((int64_t) 0, merge_sequential_arg2_162181);
                        bool i_lte_j_162190 = sle64(merge_sequential_arg2_162181, merge_sequential_arg2_162182);
                        bool y_162191 = i_p_m_t_s_leq_w_162188 && zzero_lte_i_162189;
                        bool y_162192 = zzero_leq_i_p_m_t_s_162187 && y_162191;
                        bool forwards_ok_162193 = i_lte_j_162190 && y_162192;
                        bool ok_or_empty_162194 = empty_slice_162184 || forwards_ok_162193;
                        bool index_certs_162195;
                        
                        if (!ok_or_empty_162194) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162181, ":", (long long) merge_sequential_arg2_162182, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162196 = sub64(defunc_0_f_res_162179, defunc_0_f_res_162172);
                        bool empty_slice_162197 = j_m_i_162196 == (int64_t) 0;
                        int64_t m_162198 = sub64(j_m_i_162196, (int64_t) 1);
                        int64_t i_p_m_t_s_162199 = add64(defunc_0_f_res_162172, m_162198);
                        bool zzero_leq_i_p_m_t_s_162200 = sle64((int64_t) 0, i_p_m_t_s_162199);
                        bool i_p_m_t_s_leq_w_162201 = slt64(i_p_m_t_s_162199, next_stride_161919);
                        bool zzero_lte_i_162202 = sle64((int64_t) 0, defunc_0_f_res_162172);
                        bool i_lte_j_162203 = sle64(defunc_0_f_res_162172, defunc_0_f_res_162179);
                        bool y_162204 = i_p_m_t_s_leq_w_162201 && zzero_lte_i_162202;
                        bool y_162205 = zzero_leq_i_p_m_t_s_162200 && y_162204;
                        bool forwards_ok_162206 = i_lte_j_162203 && y_162205;
                        bool ok_or_empty_162207 = empty_slice_162197 || forwards_ok_162206;
                        bool index_certs_162208;
                        
                        if (!ok_or_empty_162207) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162172, ":", (long long) defunc_0_f_res_162179, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:155:31-35\n   #10 ftRelational.fut:154:5-155:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162209 = slt64((int64_t) 0, j_m_i_162196);
                        int64_t dummy_162210;
                        int64_t dummy_162211;
                        
                        if (cond_162209) {
                            bool index_certs_162628;
                            
                            if (!cond_162209) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:155:31-35\n   #12 ftRelational.fut:154:5-155:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161991 + defunc_0_f_res_162172;
                            int64_t head_res_162630 = ((int64_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162210 = head_res_162630;
                            dummy_162211 = head_res_162631;
                        } else {
                            bool y_162216 = slt64((int64_t) 0, j_m_i_162183);
                            bool index_certs_162217;
                            
                            if (!y_162216) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:155:31-35\n   #12 ftRelational.fut:154:5-155:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162218 = start_161991 + merge_sequential_arg2_162181;
                            int64_t head_res_162219 = ((int64_t *) mem_param_171900.mem)[slice_162218];
                            int64_t head_res_162220 = ((int64_t *) mem_param_171903.mem)[slice_162218];
                            
                            dummy_162210 = head_res_162219;
                            dummy_162211 = head_res_162220;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161804; nest_i_172542++) {
                            ((int64_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + nest_i_172542] = dummy_162210;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161804; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + nest_i_172543] = dummy_162211;
                        }
                        
                        int64_t data_162223;
                        int64_t i_162227 = (int64_t) 0;
                        
                        for (int64_t k_162226 = 0; k_162226 < merge_block_sizze_161804; k_162226++) {
                            int64_t j_162230 = sub64(k_162226, i_162227);
                            bool cond_162231 = j_162230 == j_m_i_162183;
                            bool cond_162232;
                            
                            if (cond_162231) {
                                cond_162232 = 1;
                            } else {
                                bool cond_162233 = slt64(i_162227, j_m_i_162196);
                                bool cond_f_res_162234;
                                
                                if (cond_162233) {
                                    bool x_162632 = sle64((int64_t) 0, j_162230);
                                    bool y_162633 = slt64(j_162230, j_m_i_162183);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162227);
                                    bool bounds_check_162640 = cond_162233 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162181 + j_162230;
                                    int64_t slice_162637 = start_161991 + slice_162636;
                                    int64_t leq_arg1_162638 = ((int64_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162172 + i_162227;
                                    int64_t slice_162643 = start_161991 + slice_162642;
                                    int64_t leq_arg0_162644 = ((int64_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle64(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162234 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162234 = 0;
                                }
                                cond_162232 = cond_f_res_162234;
                            }
                            
                            int64_t loopres_162249;
                            int64_t loopres_162250;
                            int64_t loopres_162251;
                            
                            if (cond_162232) {
                                bool x_162647 = sle64((int64_t) 0, i_162227);
                                bool y_162648 = slt64(i_162227, j_m_i_162196);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162227);
                                int64_t slice_162651 = defunc_0_f_res_162172 + i_162227;
                                int64_t slice_162652 = start_161991 + slice_162651;
                                int64_t tmp_162653 = ((int64_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162249 = tmp_162646;
                                loopres_162250 = tmp_162653;
                                loopres_162251 = tmp_162654;
                            } else {
                                bool x_162261 = sle64((int64_t) 0, j_162230);
                                bool y_162262 = slt64(j_162230, j_m_i_162183);
                                bool bounds_check_162263 = x_162261 && y_162262;
                                bool index_certs_162264;
                                
                                if (!bounds_check_162263) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:155:31-35\n   #11 ftRelational.fut:154:5-155:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162265 = merge_sequential_arg2_162181 + j_162230;
                                int64_t slice_162266 = start_161991 + slice_162265;
                                int64_t tmp_162267 = ((int64_t *) mem_param_171900.mem)[slice_162266];
                                int64_t tmp_162268 = ((int64_t *) mem_param_171903.mem)[slice_162266];
                                
                                loopres_162249 = i_162227;
                                loopres_162250 = tmp_162267;
                                loopres_162251 = tmp_162268;
                            }
                            ((int64_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162250;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162251;
                            
                            int64_t i_tmp_172544 = loopres_162249;
                            
                            i_162227 = i_tmp_172544;
                        }
                        data_162223 = i_162227;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171935, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162275 = next_stride_161919 * num_merges_161923;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            if (memblock_alloc(ctx, &mem_172016, bytes_171905, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            
            bool loop_cond_162278 = slt64(next_stride_161919, flat_dim_161800);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162275;
            bool loop_while_tmp_172521 = loop_cond_162278;
            int64_t stride_tmp_172524 = next_stride_161919;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161914 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161915 = loop_while_tmp_172521;
            stride_161918 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161909 = loop_dz2084Uz2082U_161914;
        data_161910 = loop_while_161915;
        data_161913 = stride_161918;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162279 = n_109622 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162280 = sle64((int64_t) 0, zs_lhs_161784);
        bool i_p_m_t_s_leq_w_162281 = slt64(zs_lhs_161784, data_161909);
        bool y_162282 = zzero_leq_i_p_m_t_s_162280 && i_p_m_t_s_leq_w_162281;
        bool ok_or_empty_162283 = empty_slice_162279 || y_162282;
        bool index_certs_162284;
        
        if (!ok_or_empty_162283) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_109622, "] out of bounds for array of shape [", (long long) data_161909, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:155:31-35\n   #6  ftRelational.fut:154:5-155:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_171820, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_109622; i_171587++) {
        int64_t eta_p_162292 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162293 = sle64((int64_t) 0, eta_p_162292);
        bool y_162294 = slt64(eta_p_162292, n_109622);
        bool bounds_check_162295 = x_162293 && y_162294;
        bool index_certs_162296;
        
        if (!bounds_check_162295) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162292, "] out of bounds for array of shape [", (long long) n_109622, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:155:31-35\n   #5  ftRelational.fut:154:5-155:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162297 = ((int64_t *) ext_mem_171819.mem)[eta_p_162292];
        int64_t lifted_lambda_res_162298 = ((int64_t *) xs_mem_171818.mem)[eta_p_162292];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162297;
        ((int64_t *) mem_172030.mem)[i_171587] = lifted_lambda_res_162298;
    }
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172927, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172928, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_172939, struct memblock *mem_out_p_172940, struct memblock xs_mem_171818, int64_t n_105336, int64_t incr_105337)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172941 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172942 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172943 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172944 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172945 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172946 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172947 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172948 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172949 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172950 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_105336;
    bool cond_161783 = sle64(n_105336, (int64_t) 1);
    int64_t zs_lhs_161784 = sub64(n_105336, (int64_t) 1);
    int64_t zp_rhs_161785 = sdiv_safe64(zs_lhs_161784, (int64_t) 20);
    int64_t min_num_blocks_161786 = add64((int64_t) 1, zp_rhs_161785);
    bool loop_cond_161787 = slt64((int64_t) 1, min_num_blocks_161786);
    bool smallest_pow_2_geq_than_res_161788;
    int64_t smallest_pow_2_geq_than_res_161789;
    bool loop_while_161790;
    int64_t x_161791;
    
    loop_while_161790 = loop_cond_161787;
    x_161791 = (int64_t) 1;
    while (loop_while_161790) {
        int64_t loopres_161792 = mul64((int64_t) 2, x_161791);
        bool loop_cond_161793 = slt64(loopres_161792, min_num_blocks_161786);
        bool loop_while_tmp_172502 = loop_cond_161793;
        int64_t x_tmp_172503 = loopres_161792;
        
        loop_while_161790 = loop_while_tmp_172502;
        x_161791 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161788 = loop_while_161790;
    smallest_pow_2_geq_than_res_161789 = x_161791;
    
    bool zzero_161794 = smallest_pow_2_geq_than_res_161789 == (int64_t) 0;
    bool nonzzero_161795 = !zzero_161794;
    bool protect_assert_disj_161796 = cond_161783 || nonzzero_161795;
    bool nonzzero_cert_161797;
    
    if (!protect_assert_disj_161796) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:151:31-35\n   #5  ftRelational.fut:150:5-151:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161798 = sdiv_safe64(zs_lhs_161784, smallest_pow_2_geq_than_res_161789);
    int64_t block_sizze_161799 = add64((int64_t) 1, zp_rhs_161798);
    bool y_161805 = slt64((int64_t) 0, n_105336);
    bool protect_assert_disj_172415 = cond_161783 || y_161805;
    bool index_certs_161806;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_105336, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:151:31-35\n   #5  ftRelational.fut:150:5-151:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161820 = slt64(smallest_pow_2_geq_than_res_161789, (int64_t) 0);
    bool valid_161821 = !bounds_invalid_upwards_161820;
    bool protect_assert_disj_172423 = cond_161783 || valid_161821;
    bool range_valid_c_161822;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161789, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:151:31-35\n   #6  ftRelational.fut:150:5-151:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161824 = slt64(block_sizze_161799, (int64_t) 0);
    bool valid_161825 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_172425 = cond_161783 || valid_161825;
    bool range_valid_c_161826;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161799, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161828 = sle64(block_sizze_161799, (int64_t) 1);
    int64_t tmp_161829 = sub64(block_sizze_161799, (int64_t) 2);
    bool bounds_invalid_upwards_161830 = slt64(tmp_161829, (int64_t) 0);
    bool valid_161832 = !bounds_invalid_upwards_161830;
    bool protect_assert_disj_161833 = cond_161828 || valid_161832;
    bool protect_assert_disj_172427 = cond_161783 || protect_assert_disj_161833;
    bool range_valid_c_161834;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161829, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172029 = (int64_t) 2 * n_105336;
    
    if (futrts_indicesWithIncrement_16298(ctx, &ext_mem_171819, xs_mem_171818, n_105336, incr_105337) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_105336; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161800 = smallest_pow_2_geq_than_res_161789 * block_sizze_161799;
    bool x_172410 = !cond_161783;
    int64_t greatest_divisor_leq_than_arg1_161803 = mul64((int64_t) 2, block_sizze_161799);
    int64_t merge_block_sizze_161804;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161803) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161804 = x_172412;
    } else {
        merge_block_sizze_161804 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_161807;
    
    if (x_172410) {
        int16_t x_172416 = ((int16_t *) xs_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161807 = x_172416;
    } else {
        reduce_arg1_161807 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int16_t x_172418;
        int64_t x_172419;
        int16_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161807;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_105336; i_171547++) {
            int16_t x_161811 = ((int16_t *) xs_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161817 = sle16(redout_171545, x_161811);
            int16_t defunc_0_op_res_161818;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161818 = x_161811;
            } else {
                defunc_0_op_res_161818 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161819;
            
            if (defunc_0_leq_res_161817) {
                defunc_0_op_res_161819 = i_171547;
            } else {
                defunc_0_op_res_161819 = redout_171546;
            }
            
            int16_t redout_tmp_172506 = defunc_0_op_res_161818;
            int64_t redout_tmp_172507 = defunc_0_op_res_161819;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = (int16_t) 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161831 = add64((int64_t) 1, tmp_161829);
    int64_t binop_x_171822 = (int64_t) 2 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171823 = block_sizze_161799 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161789;
    int64_t bytes_171826 = block_sizze_161799 * binop_x_171825;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161799;
    bool loop_cond_161906 = slt64(block_sizze_161799, flat_dim_161800);
    bool zzero_161907 = merge_block_sizze_161804 == (int64_t) 0;
    bool nonzzero_161908 = !zzero_161907;
    
    if (cond_161783) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172941 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172941, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172942 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172942, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172943 < greatest_divisor_leq_than_arg1_161803) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172943, greatest_divisor_leq_than_arg1_161803);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172944 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172944, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161789; i_171559++) {
            int64_t zp_lhs_161838 = mul64(block_sizze_161799, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161799; i_171552++) {
                int64_t k_161842 = add64(zp_lhs_161838, i_171552);
                bool cond_161843 = slt64(k_161842, n_105336);
                int16_t lifted_lambda_res_161844;
                int64_t lifted_lambda_res_161845;
                
                if (cond_161843) {
                    bool x_162514 = sle64((int64_t) 0, k_161842);
                    bool bounds_check_162515 = cond_161843 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161842, "] out of bounds for array of shape [", (long long) n_105336, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_162517 = ((int16_t *) xs_mem_171818.mem)[k_161842];
                    
                    lifted_lambda_res_161844 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161845 = k_161842;
                } else {
                    lifted_lambda_res_161844 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161845 = defunc_0_reduce_res_162662;
                }
                ((int16_t *) mem_171837)[i_171552] = lifted_lambda_res_161844;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161845;
            }
            if (!cond_161828) {
                for (int64_t i_161855 = 0; i_161855 < distance_161831; i_161855++) {
                    int64_t gt_arg1_161858 = add64((int64_t) 1, i_161855);
                    bool x_161859 = sle64((int64_t) 0, gt_arg1_161858);
                    bool y_161860 = slt64(gt_arg1_161858, block_sizze_161799);
                    bool bounds_check_161861 = x_161859 && y_161860;
                    bool index_certs_161862;
                    
                    if (!bounds_check_161861) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161858, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161864 = slt64(i_161855, block_sizze_161799);
                    bool index_certs_161865;
                    
                    if (!y_161864) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161855, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_161863 = ((int16_t *) mem_171837)[gt_arg1_161858];
                    int16_t gt_arg0_161866 = ((int16_t *) mem_171837)[i_161855];
                    bool defunc_0_leq_res_161867 = sle16(gt_arg0_161866, gt_arg1_161863);
                    bool defunc_0_lifted_gt_res_161868 = !defunc_0_leq_res_161867;
                    bool s_161869;
                    int64_t s_161872;
                    bool loop_while_161873;
                    int64_t j_161876;
                    
                    loop_while_161873 = defunc_0_lifted_gt_res_161868;
                    j_161876 = i_161855;
                    while (loop_while_161873) {
                        bool x_161877 = sle64((int64_t) 0, j_161876);
                        bool y_161878 = slt64(j_161876, block_sizze_161799);
                        bool bounds_check_161879 = x_161877 && y_161878;
                        bool index_certs_161880;
                        
                        if (!bounds_check_161879) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161876, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161883 = add64((int64_t) 1, j_161876);
                        bool x_161884 = sle64((int64_t) 0, copy_arg0_161883);
                        bool y_161885 = slt64(copy_arg0_161883, block_sizze_161799);
                        bool bounds_check_161886 = x_161884 && y_161885;
                        bool index_certs_161887;
                        
                        if (!bounds_check_161886) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161883, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_161881 = ((int16_t *) mem_171837)[j_161876];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171839)[j_161876];
                        int16_t copy_arg0_161888 = ((int16_t *) mem_171837)[copy_arg0_161883];
                        int64_t copy_arg0_161889 = ((int64_t *) mem_171839)[copy_arg0_161883];
                        
                        ((int16_t *) mem_171837)[j_161876] = copy_arg0_161888;
                        ((int64_t *) mem_171839)[j_161876] = copy_arg0_161889;
                        ((int16_t *) mem_171837)[copy_arg0_161883] = copy_arg0_161881;
                        ((int64_t *) mem_171839)[copy_arg0_161883] = copy_arg0_161882;
                        
                        int64_t tmp_161894 = sub64(j_161876, (int64_t) 1);
                        bool cond_161895 = sle64((int64_t) 0, tmp_161894);
                        bool loop_cond_161896;
                        
                        if (cond_161895) {
                            bool y_162519 = slt64(tmp_161894, block_sizze_161799);
                            bool bounds_check_162520 = cond_161895 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161894, "] out of bounds for array of shape [", (long long) block_sizze_161799, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_162518 = ((int16_t *) mem_171837)[j_161876];
                            int16_t gt_arg0_162522 = ((int16_t *) mem_171837)[tmp_161894];
                            bool defunc_0_leq_res_162523 = sle16(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161896 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161896 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161896;
                        int64_t j_tmp_172517 = tmp_161894;
                        
                        loop_while_161873 = loop_while_tmp_172514;
                        j_161876 = j_tmp_172517;
                    }
                    s_161869 = loop_while_161873;
                    s_161872 = j_161876;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171824, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161799, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161799});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint16_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161799, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161789, block_sizze_161799});
        
        int64_t data_161909;
        bool data_161910;
        int64_t data_161913;
        int64_t loop_dz2084Uz2082U_161914;
        bool loop_while_161915;
        int64_t stride_161918;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161914 = flat_dim_161800;
        loop_while_161915 = loop_cond_161906;
        stride_161918 = block_sizze_161799;
        while (loop_while_161915) {
            int64_t next_stride_161919 = mul64((int64_t) 2, stride_161918);
            bool zzero_161920 = next_stride_161919 == (int64_t) 0;
            bool nonzzero_161921 = !zzero_161920;
            bool nonzzero_cert_161922;
            
            if (!nonzzero_161921) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:151:31-35\n   #5  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161923 = sdiv64(flat_dim_161800, next_stride_161919);
            bool bounds_invalid_upwards_161924 = slt64(num_merges_161923, (int64_t) 0);
            bool valid_161925 = !bounds_invalid_upwards_161924;
            bool range_valid_c_161926;
            
            if (!valid_161925) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161923, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:151:31-35\n   #6  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161928 = sub64(next_stride_161919, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161929 = sle64((int64_t) 0, m_161928);
            bool cond_161931 = slt64(next_stride_161919, (int64_t) 10);
            bool protect_assert_disj_161932 = nonzzero_161908 || cond_161931;
            bool nonzzero_cert_161933;
            
            if (!protect_assert_disj_161932) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161934 = smod_safe64(next_stride_161919, merge_block_sizze_161804);
            bool num_blocks_161935 = zeze_lhs_161934 == (int64_t) 0;
            bool protect_assert_disj_161936 = cond_161931 || num_blocks_161935;
            bool assert_c_161937;
            
            if (!protect_assert_disj_161936) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161939 = sdiv_safe64(next_stride_161919, merge_block_sizze_161804);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940 = add64((int64_t) 1, num_blocks_161939);
            int64_t j_m_i_161941 = sub64(next_stride_161919, stride_161918);
            int64_t flat_dim_161942 = merge_block_sizze_161804 * num_blocks_161939;
            bool bounds_invalid_upwards_161943 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, (int64_t) 0);
            bool empty_slice_161944 = j_m_i_161941 == (int64_t) 0;
            int64_t m_161945 = sub64(j_m_i_161941, (int64_t) 1);
            bool zzero_lte_i_161946 = sle64((int64_t) 0, stride_161918);
            bool i_lte_j_161947 = sle64(stride_161918, next_stride_161919);
            bool empty_slice_161948 = stride_161918 == (int64_t) 0;
            int64_t m_161949 = sub64(stride_161918, (int64_t) 1);
            bool bounds_invalid_upwards_161950 = slt64(num_blocks_161939, (int64_t) 0);
            bool cond_161951 = slt64((int64_t) 0, stride_161918);
            bool valid_161952 = !bounds_invalid_upwards_161943;
            int64_t i_p_m_t_s_161953 = add64(stride_161918, m_161945);
            bool zzero_leq_i_p_m_t_s_161954 = sle64((int64_t) 0, m_161949);
            bool i_p_m_t_s_leq_w_161955 = slt64(m_161949, next_stride_161919);
            bool valid_161956 = !bounds_invalid_upwards_161950;
            bool i_p_m_t_s_leq_w_161957 = slt64(m_161928, flat_dim_161942);
            bool y_161958 = slt64((int64_t) 0, j_m_i_161941);
            bool protect_assert_disj_161959 = cond_161931 || valid_161952;
            bool range_valid_c_161960;
            
            if (!protect_assert_disj_161959) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161961 = sle64((int64_t) 0, i_p_m_t_s_161953);
            bool i_p_m_t_s_leq_w_161962 = slt64(i_p_m_t_s_161953, next_stride_161919);
            bool y_161963 = zzero_leq_i_p_m_t_s_161954 && i_p_m_t_s_leq_w_161955;
            bool protect_assert_disj_161964 = cond_161931 || valid_161956;
            bool range_valid_c_161965;
            
            if (!protect_assert_disj_161964) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161939, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161966 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_161957;
            bool y_161967 = zzero_lte_i_161946 && i_p_m_t_s_leq_w_161962;
            bool forwards_ok_161968 = zzero_lte_i_161946 && y_161963;
            bool ok_or_empty_161969 = zzero_161920 || y_161966;
            bool protect_assert_disj_161970 = cond_161951 || y_161958;
            bool y_161971 = zzero_leq_i_p_m_t_s_161961 && y_161967;
            bool ok_or_empty_161972 = empty_slice_161948 || forwards_ok_161968;
            bool protect_assert_disj_161973 = cond_161931 || ok_or_empty_161969;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) flat_dim_161942, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161975 = !cond_161931;
            bool protect_assert_disj_161976 = protect_assert_disj_161970 || loop_not_taken_161975;
            bool index_certs_161977;
            
            if (!protect_assert_disj_161976) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161978 = i_lte_j_161947 && y_161971;
            bool protect_assert_disj_161979 = cond_161931 || ok_or_empty_161972;
            bool index_certs_161980;
            
            if (!protect_assert_disj_161979) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161981 = ok_or_empty_161972 || loop_not_taken_161975;
            bool index_certs_161982;
            
            if (!protect_assert_disj_161981) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161918, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161983 = empty_slice_161944 || forwards_ok_161978;
            bool protect_assert_disj_161984 = cond_161931 || ok_or_empty_161983;
            bool index_certs_161985;
            
            if (!protect_assert_disj_161984) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161986 = loop_not_taken_161975 || ok_or_empty_161983;
            bool index_certs_161987;
            
            if (!protect_assert_disj_161986) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161918, ":] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 2 * num_merges_161923;
            int64_t bytes_171905 = next_stride_161919 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161923;
            int64_t bytes_171908 = next_stride_161919 * binop_x_171907;
            bool i_lte_j_161930 = sle64((int64_t) 0, next_stride_161919);
            
            if (mem_171906_cached_sizze_172945 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172945, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172946 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172946, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940;
            int64_t binop_x_171934 = (int64_t) 2 * num_blocks_161939;
            int64_t bytes_171935 = merge_block_sizze_161804 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161939;
            int64_t bytes_171938 = merge_block_sizze_161804 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 4 * stride_161918;
            int64_t bytes_171982 = (int64_t) 16 * stride_161918;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161923; i_171580++) {
                int64_t start_161991 = mul64(next_stride_161919, i_171580);
                int64_t j_m_i_161992 = sub64(loop_dz2084Uz2082U_161914, start_161991);
                bool empty_slice_161993 = j_m_i_161992 == (int64_t) 0;
                int64_t m_161994 = sub64(j_m_i_161992, (int64_t) 1);
                int64_t i_p_m_t_s_161995 = add64(start_161991, m_161994);
                bool zzero_leq_i_p_m_t_s_161996 = sle64((int64_t) 0, i_p_m_t_s_161995);
                bool i_p_m_t_s_leq_w_161997 = slt64(i_p_m_t_s_161995, loop_dz2084Uz2082U_161914);
                bool zzero_lte_i_161998 = sle64((int64_t) 0, start_161991);
                bool i_lte_j_161999 = sle64(start_161991, loop_dz2084Uz2082U_161914);
                bool y_162000 = i_p_m_t_s_leq_w_161997 && zzero_lte_i_161998;
                bool y_162001 = zzero_leq_i_p_m_t_s_161996 && y_162000;
                bool forwards_ok_162002 = i_lte_j_161999 && y_162001;
                bool ok_or_empty_162003 = empty_slice_161993 || forwards_ok_162002;
                bool index_certs_162004;
                
                if (!ok_or_empty_162003) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161991, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161914, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_162005 = slt64(m_161928, j_m_i_161992);
                bool y_162006 = zzero_leq_i_p_m_t_s_161929 && i_p_m_t_s_leq_w_162005;
                bool forwards_ok_162007 = i_lte_j_161930 && y_162006;
                bool ok_or_empty_162008 = zzero_161920 || forwards_ok_162007;
                bool index_certs_162009;
                
                if (!ok_or_empty_162008) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161919, "] out of bounds for array of shape [", (long long) j_m_i_161992, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:151:62-65\n   #7  ftRelational.fut:151:31-35\n   #8  ftRelational.fut:150:5-151:35\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161931) {
                    int16_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161951) {
                        int16_t head_res_162552 = ((int16_t *) mem_param_171900.mem)[start_161991];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161991];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161918 + start_161991;
                        int16_t head_res_162555 = ((int16_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161919; nest_i_172527++) {
                        ((int16_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161919; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161919; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161941;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161918);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161941);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161918 + j_162566;
                                int64_t slice_162576 = start_161991 + slice_162575;
                                int16_t leq_arg1_162577 = ((int16_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161991 + i_162563;
                                int16_t leq_arg0_162582 = ((int16_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle16(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int16_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161918);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161991 + i_162563;
                            int16_t tmp_162593 = ((int16_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161941);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:151:62-65\n   #8  ftRelational.fut:151:31-35\n   #9  ftRelational.fut:150:5-151:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161918 + j_162566;
                            int64_t slice_162600 = start_161991 + slice_162599;
                            int16_t tmp_162601 = ((int16_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int16_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172947 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172947, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172948 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172948, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940; i_171566++) {
                        int64_t split_count_arg3_162071 = mul64(merge_block_sizze_161804, i_171566);
                        int64_t defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162072, &defunc_0_split_count_res_162073, &defunc_0_split_count_res_162074, &defunc_0_split_count_res_162075, &defunc_0_split_count_res_162076, (int64_t) 0, stride_161918, (int64_t) 0, j_m_i_161941, split_count_arg3_162071) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162077 = slt64((int64_t) 0, defunc_0_split_count_res_162076);
                        bool defunc_0_split_count_res_162078;
                        int64_t defunc_0_split_count_res_162079;
                        int64_t defunc_0_split_count_res_162080;
                        int64_t defunc_0_split_count_res_162081;
                        int64_t defunc_0_split_count_res_162082;
                        int64_t defunc_0_split_count_res_162083;
                        bool loop_while_162084;
                        int64_t ss_162085;
                        int64_t ss_162086;
                        int64_t tt_162087;
                        int64_t tt_162088;
                        int64_t count_162089;
                        
                        loop_while_162084 = loop_cond_162077;
                        ss_162085 = defunc_0_split_count_res_162072;
                        ss_162086 = defunc_0_split_count_res_162073;
                        tt_162087 = defunc_0_split_count_res_162074;
                        tt_162088 = defunc_0_split_count_res_162075;
                        count_162089 = defunc_0_split_count_res_162076;
                        while (loop_while_162084) {
                            int64_t zlze_lhs_162090 = sub64(ss_162086, ss_162085);
                            bool cond_162091 = sle64(zlze_lhs_162090, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162092;
                            int64_t defunc_0_lifted_step_res_162093;
                            int64_t defunc_0_lifted_step_res_162094;
                            int64_t defunc_0_lifted_step_res_162095;
                            
                            if (cond_162091) {
                                int64_t tmp_162605 = add64(tt_162087, count_162089);
                                
                                defunc_0_lifted_step_res_162092 = ss_162085;
                                defunc_0_lifted_step_res_162093 = tmp_162605;
                                defunc_0_lifted_step_res_162094 = tt_162088;
                                defunc_0_lifted_step_res_162095 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162097 = sub64(tt_162088, tt_162087);
                                bool cond_162098 = sle64(zlze_lhs_162097, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162099;
                                int64_t defunc_0_lifted_step_res_f_res_162100;
                                int64_t defunc_0_lifted_step_res_f_res_162101;
                                int64_t defunc_0_lifted_step_res_f_res_162102;
                                
                                if (cond_162098) {
                                    int64_t tmp_162606 = add64(ss_162085, count_162089);
                                    
                                    defunc_0_lifted_step_res_f_res_162099 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162100 = tt_162087;
                                    defunc_0_lifted_step_res_f_res_162101 = tt_162088;
                                    defunc_0_lifted_step_res_f_res_162102 = (int64_t) 0;
                                } else {
                                    bool cond_162104 = count_162089 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162105;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162106;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162107;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162108;
                                    
                                    if (cond_162104) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162085);
                                        bool y_162609 = slt64(ss_162085, stride_161918);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162085, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:151:31-35\n   #13 ftRelational.fut:150:5-151:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162087);
                                        bool y_162615 = slt64(tt_162087, j_m_i_161941);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162087, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:151:31-35\n   #13 ftRelational.fut:150:5-151:35\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161991 + ss_162085;
                                        int16_t leq_arg1_162613 = ((int16_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161918 + tt_162087;
                                        int64_t slice_162619 = start_161991 + slice_162618;
                                        int16_t leq_arg0_162620 = ((int16_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle16(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162087);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162085;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162085);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162087;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = tt_162088;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = (int64_t) 0;
                                    } else {
                                        int64_t m_162127 = sdiv64(count_162089, (int64_t) 2);
                                        int64_t n_162128 = sub64(count_162089, m_162127);
                                        bool cond_162129 = n_162128 == (int64_t) 0;
                                        int64_t zgze_lhs_162130 = add64(ss_162085, m_162127);
                                        bool cond_f_res_162131 = sle64(ss_162086, zgze_lhs_162130);
                                        bool x_162132 = !cond_162129;
                                        bool y_162133 = cond_f_res_162131 && x_162132;
                                        bool cond_162134 = cond_162129 || y_162133;
                                        bool leq_y_x_162135;
                                        
                                        if (cond_162134) {
                                            leq_y_x_162135 = 1;
                                        } else {
                                            bool x_162136 = sle64((int64_t) 0, zgze_lhs_162130);
                                            bool y_162137 = slt64(zgze_lhs_162130, stride_161918);
                                            bool bounds_check_162138 = x_162136 && y_162137;
                                            bool index_certs_162139;
                                            
                                            if (!bounds_check_162138) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162130, "] out of bounds for array of shape [", (long long) stride_161918, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:151:31-35\n   #13 ftRelational.fut:150:5-151:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162142 = add64(tt_162087, n_162128);
                                            int64_t leq_arg0_162143 = sub64(zm_lhs_162142, (int64_t) 1);
                                            bool x_162144 = sle64((int64_t) 0, leq_arg0_162143);
                                            bool y_162145 = slt64(leq_arg0_162143, j_m_i_161941);
                                            bool bounds_check_162146 = x_162144 && y_162145;
                                            bool index_certs_162147;
                                            
                                            if (!bounds_check_162146) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162143, "] out of bounds for array of shape [", (long long) j_m_i_161941, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:151:62-65\n   #12 ftRelational.fut:151:31-35\n   #13 ftRelational.fut:150:5-151:35\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162140 = start_161991 + zgze_lhs_162130;
                                            int16_t leq_arg1_162141 = ((int16_t *) mem_param_171900.mem)[slice_162140];
                                            int64_t slice_162148 = stride_161918 + leq_arg0_162143;
                                            int64_t slice_162149 = start_161991 + slice_162148;
                                            int16_t leq_arg0_162150 = ((int16_t *) mem_param_171900.mem)[slice_162149];
                                            bool defunc_0_leq_res_162151 = sle16(leq_arg0_162150, leq_arg1_162141);
                                            
                                            leq_y_x_162135 = defunc_0_leq_res_162151;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                        
                                        if (leq_y_x_162135) {
                                            int64_t tmp_162626 = add64(tt_162087, n_162128);
                                            int64_t tmp_162627 = sub64(count_162089, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tt_162088;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = tmp_162627;
                                        } else {
                                            int64_t tmp_162157 = add64(tt_162087, n_162128);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162152 = tt_162087;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162153 = tmp_162157;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162154 = count_162089;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162105 = ss_162085;
                                        defunc_0_lifted_step_res_f_res_f_res_162106 = defunc_0_lifted_step_res_f_res_f_res_f_res_162152;
                                        defunc_0_lifted_step_res_f_res_f_res_162107 = defunc_0_lifted_step_res_f_res_f_res_f_res_162153;
                                        defunc_0_lifted_step_res_f_res_f_res_162108 = defunc_0_lifted_step_res_f_res_f_res_f_res_162154;
                                    }
                                    defunc_0_lifted_step_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_162105;
                                    defunc_0_lifted_step_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_162106;
                                    defunc_0_lifted_step_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_162107;
                                    defunc_0_lifted_step_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_162108;
                                }
                                defunc_0_lifted_step_res_162092 = defunc_0_lifted_step_res_f_res_162099;
                                defunc_0_lifted_step_res_162093 = defunc_0_lifted_step_res_f_res_162100;
                                defunc_0_lifted_step_res_162094 = defunc_0_lifted_step_res_f_res_162101;
                                defunc_0_lifted_step_res_162095 = defunc_0_lifted_step_res_f_res_162102;
                            }
                            
                            int64_t loopres_162158;
                            int64_t loopres_162159;
                            int64_t loopres_162160;
                            int64_t loopres_162161;
                            int64_t loopres_162162;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162158, &loopres_162159, &loopres_162160, &loopres_162161, &loopres_162162, defunc_0_lifted_step_res_162092, ss_162086, defunc_0_lifted_step_res_162093, defunc_0_lifted_step_res_162094, defunc_0_lifted_step_res_162095) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162163 = slt64((int64_t) 0, loopres_162162);
                            bool loop_while_tmp_172534 = loop_cond_162163;
                            int64_t ss_tmp_172535 = loopres_162158;
                            int64_t ss_tmp_172536 = loopres_162159;
                            int64_t tt_tmp_172537 = loopres_162160;
                            int64_t tt_tmp_172538 = loopres_162161;
                            int64_t count_tmp_172539 = loopres_162162;
                            
                            loop_while_162084 = loop_while_tmp_172534;
                            ss_162085 = ss_tmp_172535;
                            ss_162086 = ss_tmp_172536;
                            tt_162087 = tt_tmp_172537;
                            tt_162088 = tt_tmp_172538;
                            count_162089 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162078 = loop_while_162084;
                        defunc_0_split_count_res_162079 = ss_162085;
                        defunc_0_split_count_res_162080 = ss_162086;
                        defunc_0_split_count_res_162081 = tt_162087;
                        defunc_0_split_count_res_162082 = tt_162088;
                        defunc_0_split_count_res_162083 = count_162089;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162079;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162081;
                    }
                    if (mem_171936_cached_sizze_172949 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172949, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172950 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172950, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161939; i_171573++) {
                        bool y_162169 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool index_certs_162171;
                        
                        if (!y_162169) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162172 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162174 = add64((int64_t) 1, i_171573);
                        bool x_162175 = sle64((int64_t) 0, tmp_162174);
                        bool y_162176 = slt64(tmp_162174, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940);
                        bool bounds_check_162177 = x_162175 && y_162176;
                        bool index_certs_162178;
                        
                        if (!bounds_check_162177) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162174, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161940, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162179 = ((int64_t *) mem_171919)[tmp_162174];
                        int64_t defunc_0_f_res_162180 = ((int64_t *) mem_171921)[tmp_162174];
                        int64_t merge_sequential_arg2_162181 = add64(stride_161918, defunc_0_f_res_162173);
                        int64_t merge_sequential_arg2_162182 = add64(stride_161918, defunc_0_f_res_162180);
                        int64_t j_m_i_162183 = sub64(merge_sequential_arg2_162182, merge_sequential_arg2_162181);
                        bool empty_slice_162184 = j_m_i_162183 == (int64_t) 0;
                        int64_t m_162185 = sub64(j_m_i_162183, (int64_t) 1);
                        int64_t i_p_m_t_s_162186 = add64(merge_sequential_arg2_162181, m_162185);
                        bool zzero_leq_i_p_m_t_s_162187 = sle64((int64_t) 0, i_p_m_t_s_162186);
                        bool i_p_m_t_s_leq_w_162188 = slt64(i_p_m_t_s_162186, next_stride_161919);
                        bool zzero_lte_i_162189 = sle64((int64_t) 0, merge_sequential_arg2_162181);
                        bool i_lte_j_162190 = sle64(merge_sequential_arg2_162181, merge_sequential_arg2_162182);
                        bool y_162191 = i_p_m_t_s_leq_w_162188 && zzero_lte_i_162189;
                        bool y_162192 = zzero_leq_i_p_m_t_s_162187 && y_162191;
                        bool forwards_ok_162193 = i_lte_j_162190 && y_162192;
                        bool ok_or_empty_162194 = empty_slice_162184 || forwards_ok_162193;
                        bool index_certs_162195;
                        
                        if (!ok_or_empty_162194) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162181, ":", (long long) merge_sequential_arg2_162182, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162196 = sub64(defunc_0_f_res_162179, defunc_0_f_res_162172);
                        bool empty_slice_162197 = j_m_i_162196 == (int64_t) 0;
                        int64_t m_162198 = sub64(j_m_i_162196, (int64_t) 1);
                        int64_t i_p_m_t_s_162199 = add64(defunc_0_f_res_162172, m_162198);
                        bool zzero_leq_i_p_m_t_s_162200 = sle64((int64_t) 0, i_p_m_t_s_162199);
                        bool i_p_m_t_s_leq_w_162201 = slt64(i_p_m_t_s_162199, next_stride_161919);
                        bool zzero_lte_i_162202 = sle64((int64_t) 0, defunc_0_f_res_162172);
                        bool i_lte_j_162203 = sle64(defunc_0_f_res_162172, defunc_0_f_res_162179);
                        bool y_162204 = i_p_m_t_s_leq_w_162201 && zzero_lte_i_162202;
                        bool y_162205 = zzero_leq_i_p_m_t_s_162200 && y_162204;
                        bool forwards_ok_162206 = i_lte_j_162203 && y_162205;
                        bool ok_or_empty_162207 = empty_slice_162197 || forwards_ok_162206;
                        bool index_certs_162208;
                        
                        if (!ok_or_empty_162207) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162172, ":", (long long) defunc_0_f_res_162179, "] out of bounds for array of shape [", (long long) next_stride_161919, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:151:62-65\n   #9  ftRelational.fut:151:31-35\n   #10 ftRelational.fut:150:5-151:35\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162209 = slt64((int64_t) 0, j_m_i_162196);
                        int16_t dummy_162210;
                        int64_t dummy_162211;
                        
                        if (cond_162209) {
                            bool index_certs_162628;
                            
                            if (!cond_162209) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:151:31-35\n   #12 ftRelational.fut:150:5-151:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161991 + defunc_0_f_res_162172;
                            int16_t head_res_162630 = ((int16_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162210 = head_res_162630;
                            dummy_162211 = head_res_162631;
                        } else {
                            bool y_162216 = slt64((int64_t) 0, j_m_i_162183);
                            bool index_certs_162217;
                            
                            if (!y_162216) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:151:62-65\n   #11 ftRelational.fut:151:31-35\n   #12 ftRelational.fut:150:5-151:35\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162218 = start_161991 + merge_sequential_arg2_162181;
                            int16_t head_res_162219 = ((int16_t *) mem_param_171900.mem)[slice_162218];
                            int64_t head_res_162220 = ((int64_t *) mem_param_171903.mem)[slice_162218];
                            
                            dummy_162210 = head_res_162219;
                            dummy_162211 = head_res_162220;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161804; nest_i_172542++) {
                            ((int16_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + nest_i_172542] = dummy_162210;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161804; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + nest_i_172543] = dummy_162211;
                        }
                        
                        int64_t data_162223;
                        int64_t i_162227 = (int64_t) 0;
                        
                        for (int64_t k_162226 = 0; k_162226 < merge_block_sizze_161804; k_162226++) {
                            int64_t j_162230 = sub64(k_162226, i_162227);
                            bool cond_162231 = j_162230 == j_m_i_162183;
                            bool cond_162232;
                            
                            if (cond_162231) {
                                cond_162232 = 1;
                            } else {
                                bool cond_162233 = slt64(i_162227, j_m_i_162196);
                                bool cond_f_res_162234;
                                
                                if (cond_162233) {
                                    bool x_162632 = sle64((int64_t) 0, j_162230);
                                    bool y_162633 = slt64(j_162230, j_m_i_162183);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162227);
                                    bool bounds_check_162640 = cond_162233 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162181 + j_162230;
                                    int64_t slice_162637 = start_161991 + slice_162636;
                                    int16_t leq_arg1_162638 = ((int16_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162172 + i_162227;
                                    int64_t slice_162643 = start_161991 + slice_162642;
                                    int16_t leq_arg0_162644 = ((int16_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle16(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162234 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162234 = 0;
                                }
                                cond_162232 = cond_f_res_162234;
                            }
                            
                            int64_t loopres_162249;
                            int16_t loopres_162250;
                            int64_t loopres_162251;
                            
                            if (cond_162232) {
                                bool x_162647 = sle64((int64_t) 0, i_162227);
                                bool y_162648 = slt64(i_162227, j_m_i_162196);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162227, "] out of bounds for array of shape [", (long long) j_m_i_162196, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162227);
                                int64_t slice_162651 = defunc_0_f_res_162172 + i_162227;
                                int64_t slice_162652 = start_161991 + slice_162651;
                                int16_t tmp_162653 = ((int16_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162249 = tmp_162646;
                                loopres_162250 = tmp_162653;
                                loopres_162251 = tmp_162654;
                            } else {
                                bool x_162261 = sle64((int64_t) 0, j_162230);
                                bool y_162262 = slt64(j_162230, j_m_i_162183);
                                bool bounds_check_162263 = x_162261 && y_162262;
                                bool index_certs_162264;
                                
                                if (!bounds_check_162263) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162230, "] out of bounds for array of shape [", (long long) j_m_i_162183, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:151:62-65\n   #10 ftRelational.fut:151:31-35\n   #11 ftRelational.fut:150:5-151:35\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162265 = merge_sequential_arg2_162181 + j_162230;
                                int64_t slice_162266 = start_161991 + slice_162265;
                                int16_t tmp_162267 = ((int16_t *) mem_param_171900.mem)[slice_162266];
                                int64_t tmp_162268 = ((int64_t *) mem_param_171903.mem)[slice_162266];
                                
                                loopres_162249 = i_162227;
                                loopres_162250 = tmp_162267;
                                loopres_162251 = tmp_162268;
                            }
                            ((int16_t *) mem_171936)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162250;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161804 + k_162226] = loopres_162251;
                            
                            int64_t i_tmp_172544 = loopres_162249;
                            
                            i_162227 = i_tmp_172544;
                        }
                        data_162223 = i_162227;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint16_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161804, (int64_t) 1}, (int64_t []) {num_blocks_161939, merge_block_sizze_161804});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_171906, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161919, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161919});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162275 = next_stride_161919 * num_merges_161923;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint16_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161919, (int64_t) 1}, (int64_t []) {num_merges_161923, next_stride_161919});
            
            bool loop_cond_162278 = slt64(next_stride_161919, flat_dim_161800);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162275;
            bool loop_while_tmp_172521 = loop_cond_162278;
            int64_t stride_tmp_172524 = next_stride_161919;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161914 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161915 = loop_while_tmp_172521;
            stride_161918 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161909 = loop_dz2084Uz2082U_161914;
        data_161910 = loop_while_161915;
        data_161913 = stride_161918;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162279 = n_105336 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162280 = sle64((int64_t) 0, zs_lhs_161784);
        bool i_p_m_t_s_leq_w_162281 = slt64(zs_lhs_161784, data_161909);
        bool y_162282 = zzero_leq_i_p_m_t_s_162280 && i_p_m_t_s_leq_w_162281;
        bool ok_or_empty_162283 = empty_slice_162279 || y_162282;
        bool index_certs_162284;
        
        if (!ok_or_empty_162283) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_105336, "] out of bounds for array of shape [", (long long) data_161909, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:151:62-65\n   #5  ftRelational.fut:151:31-35\n   #6  ftRelational.fut:150:5-151:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_105336; i_171587++) {
        int64_t eta_p_162292 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162293 = sle64((int64_t) 0, eta_p_162292);
        bool y_162294 = slt64(eta_p_162292, n_105336);
        bool bounds_check_162295 = x_162293 && y_162294;
        bool index_certs_162296;
        
        if (!bounds_check_162295) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162292, "] out of bounds for array of shape [", (long long) n_105336, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:151:62-65\n   #4  ftRelational.fut:151:31-35\n   #5  ftRelational.fut:150:5-151:35\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162297 = ((int64_t *) ext_mem_171819.mem)[eta_p_162292];
        int16_t lifted_lambda_res_162298 = ((int16_t *) xs_mem_171818.mem)[eta_p_162292];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162297;
        ((int16_t *) mem_172030.mem)[i_171587] = lifted_lambda_res_162298;
    }
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172939, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172940, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_172951, struct memblock *mem_out_p_172952, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_98843, int64_t b_98844)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172953 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172954 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172955 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172956 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172957 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172958 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172959 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172960 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172961 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172962 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_98843;
    bool cond_161777 = sle64(n_98843, (int64_t) 1);
    int64_t zs_lhs_161778 = sub64(n_98843, (int64_t) 1);
    int64_t zp_rhs_161779 = sdiv_safe64(zs_lhs_161778, (int64_t) 20);
    int64_t min_num_blocks_161780 = add64((int64_t) 1, zp_rhs_161779);
    bool loop_cond_161781 = slt64((int64_t) 1, min_num_blocks_161780);
    bool smallest_pow_2_geq_than_res_161782;
    int64_t smallest_pow_2_geq_than_res_161783;
    bool loop_while_161784;
    int64_t x_161785;
    
    loop_while_161784 = loop_cond_161781;
    x_161785 = (int64_t) 1;
    while (loop_while_161784) {
        int64_t loopres_161786 = mul64((int64_t) 2, x_161785);
        bool loop_cond_161787 = slt64(loopres_161786, min_num_blocks_161780);
        bool loop_while_tmp_172502 = loop_cond_161787;
        int64_t x_tmp_172503 = loopres_161786;
        
        loop_while_161784 = loop_while_tmp_172502;
        x_161785 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161782 = loop_while_161784;
    smallest_pow_2_geq_than_res_161783 = x_161785;
    
    bool zzero_161788 = smallest_pow_2_geq_than_res_161783 == (int64_t) 0;
    bool nonzzero_161789 = !zzero_161788;
    bool protect_assert_disj_161790 = cond_161777 || nonzzero_161789;
    bool nonzzero_cert_161791;
    
    if (!protect_assert_disj_161790) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:133:32-36\n   #5  ftRelational.fut:130:5-133:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161792 = sdiv_safe64(zs_lhs_161778, smallest_pow_2_geq_than_res_161783);
    int64_t block_sizze_161793 = add64((int64_t) 1, zp_rhs_161792);
    bool y_161799 = slt64((int64_t) 0, n_98843);
    bool protect_assert_disj_172415 = cond_161777 || y_161799;
    bool index_certs_161800;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_98843, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:133:32-36\n   #5  ftRelational.fut:130:5-133:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161814 = slt64(smallest_pow_2_geq_than_res_161783, (int64_t) 0);
    bool valid_161815 = !bounds_invalid_upwards_161814;
    bool protect_assert_disj_172423 = cond_161777 || valid_161815;
    bool range_valid_c_161816;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161783, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:133:32-36\n   #6  ftRelational.fut:130:5-133:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161818 = slt64(block_sizze_161793, (int64_t) 0);
    bool valid_161819 = !bounds_invalid_upwards_161818;
    bool protect_assert_disj_172425 = cond_161777 || valid_161819;
    bool range_valid_c_161820;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161793, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161822 = sle64(block_sizze_161793, (int64_t) 1);
    int64_t tmp_161823 = sub64(block_sizze_161793, (int64_t) 2);
    bool bounds_invalid_upwards_161824 = slt64(tmp_161823, (int64_t) 0);
    bool valid_161826 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_161827 = cond_161822 || valid_161826;
    bool protect_assert_disj_172427 = cond_161777 || protect_assert_disj_161827;
    bool range_valid_c_161828;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161823, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172029 = n_98843 * b_98844;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_98843; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161794 = smallest_pow_2_geq_than_res_161783 * block_sizze_161793;
    bool x_172410 = !cond_161777;
    int64_t greatest_divisor_leq_than_arg1_161797 = mul64((int64_t) 2, block_sizze_161793);
    int64_t merge_block_sizze_161798;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161797) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161798 = x_172412;
    } else {
        merge_block_sizze_161798 = (int64_t) 0;
    }
    
    double reduce_arg1_161801;
    
    if (x_172410) {
        double x_172416 = ((double *) k_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161801 = x_172416;
    } else {
        reduce_arg1_161801 = 0.0;
    }
    
    double defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        double x_172418;
        int64_t x_172419;
        double redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161801;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_98843; i_171547++) {
            double x_161805 = ((double *) k_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161811 = redout_171545 <= x_161805;
            double defunc_0_op_res_161812;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161812 = x_161805;
            } else {
                defunc_0_op_res_161812 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161813;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161813 = i_171547;
            } else {
                defunc_0_op_res_161813 = redout_171546;
            }
            
            double redout_tmp_172506 = defunc_0_op_res_161812;
            int64_t redout_tmp_172507 = defunc_0_op_res_161813;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0.0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161825 = add64((int64_t) 1, tmp_161823);
    int64_t binop_x_171822 = (int64_t) 8 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171823 = block_sizze_161793 * binop_x_171822;
    int64_t bytes_171836 = (int64_t) 8 * block_sizze_161793;
    bool loop_cond_161900 = slt64(block_sizze_161793, flat_dim_161794);
    bool zzero_161901 = merge_block_sizze_161798 == (int64_t) 0;
    bool nonzzero_161902 = !zzero_161901;
    
    if (cond_161777) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172953 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172953, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172954 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172954, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172955 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172955, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172956 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172956, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161783; i_171559++) {
            int64_t zp_lhs_161832 = mul64(block_sizze_161793, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161793; i_171552++) {
                int64_t k_161836 = add64(zp_lhs_161832, i_171552);
                bool cond_161837 = slt64(k_161836, n_98843);
                double lifted_lambda_res_161838;
                int64_t lifted_lambda_res_161839;
                
                if (cond_161837) {
                    bool x_162514 = sle64((int64_t) 0, k_161836);
                    bool bounds_check_162515 = cond_161837 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161836, "] out of bounds for array of shape [", (long long) n_98843, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double lifted_lambda_res_t_res_162517 = ((double *) k_mem_171818.mem)[k_161836];
                    
                    lifted_lambda_res_161838 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161839 = k_161836;
                } else {
                    lifted_lambda_res_161838 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161839 = defunc_0_reduce_res_162662;
                }
                ((double *) mem_171837)[i_171552] = lifted_lambda_res_161838;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161839;
            }
            if (!cond_161822) {
                for (int64_t i_161849 = 0; i_161849 < distance_161825; i_161849++) {
                    int64_t gt_arg1_161852 = add64((int64_t) 1, i_161849);
                    bool x_161853 = sle64((int64_t) 0, gt_arg1_161852);
                    bool y_161854 = slt64(gt_arg1_161852, block_sizze_161793);
                    bool bounds_check_161855 = x_161853 && y_161854;
                    bool index_certs_161856;
                    
                    if (!bounds_check_161855) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161852, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161858 = slt64(i_161849, block_sizze_161793);
                    bool index_certs_161859;
                    
                    if (!y_161858) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161849, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    double gt_arg1_161857 = ((double *) mem_171837)[gt_arg1_161852];
                    double gt_arg0_161860 = ((double *) mem_171837)[i_161849];
                    bool defunc_0_leq_res_161861 = gt_arg0_161860 <= gt_arg1_161857;
                    bool defunc_0_lifted_gt_res_161862 = !defunc_0_leq_res_161861;
                    bool s_161863;
                    int64_t s_161866;
                    bool loop_while_161867;
                    int64_t j_161870;
                    
                    loop_while_161867 = defunc_0_lifted_gt_res_161862;
                    j_161870 = i_161849;
                    while (loop_while_161867) {
                        bool x_161871 = sle64((int64_t) 0, j_161870);
                        bool y_161872 = slt64(j_161870, block_sizze_161793);
                        bool bounds_check_161873 = x_161871 && y_161872;
                        bool index_certs_161874;
                        
                        if (!bounds_check_161873) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161870, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161877 = add64((int64_t) 1, j_161870);
                        bool x_161878 = sle64((int64_t) 0, copy_arg0_161877);
                        bool y_161879 = slt64(copy_arg0_161877, block_sizze_161793);
                        bool bounds_check_161880 = x_161878 && y_161879;
                        bool index_certs_161881;
                        
                        if (!bounds_check_161880) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161877, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        double copy_arg0_161875 = ((double *) mem_171837)[j_161870];
                        int64_t copy_arg0_161876 = ((int64_t *) mem_171839)[j_161870];
                        double copy_arg0_161882 = ((double *) mem_171837)[copy_arg0_161877];
                        int64_t copy_arg0_161883 = ((int64_t *) mem_171839)[copy_arg0_161877];
                        
                        ((double *) mem_171837)[j_161870] = copy_arg0_161882;
                        ((int64_t *) mem_171839)[j_161870] = copy_arg0_161883;
                        ((double *) mem_171837)[copy_arg0_161877] = copy_arg0_161875;
                        ((int64_t *) mem_171839)[copy_arg0_161877] = copy_arg0_161876;
                        
                        int64_t tmp_161888 = sub64(j_161870, (int64_t) 1);
                        bool cond_161889 = sle64((int64_t) 0, tmp_161888);
                        bool loop_cond_161890;
                        
                        if (cond_161889) {
                            bool y_162519 = slt64(tmp_161888, block_sizze_161793);
                            bool bounds_check_162520 = cond_161889 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161888, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            double gt_arg1_162518 = ((double *) mem_171837)[j_161870];
                            double gt_arg0_162522 = ((double *) mem_171837)[tmp_161888];
                            bool defunc_0_leq_res_162523 = gt_arg0_162522 <= gt_arg1_162518;
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161890 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161890 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161890;
                        int64_t j_tmp_172517 = tmp_161888;
                        
                        loop_while_161867 = loop_while_tmp_172514;
                        j_161870 = j_tmp_172517;
                    }
                    s_161863 = loop_while_161867;
                    s_161866 = j_161870;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171824, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        if (memblock_alloc(ctx, &mem_171896, bytes_171823, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        
        int64_t data_161903;
        bool data_161904;
        int64_t data_161907;
        int64_t loop_dz2084Uz2082U_161908;
        bool loop_while_161909;
        int64_t stride_161912;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161908 = flat_dim_161794;
        loop_while_161909 = loop_cond_161900;
        stride_161912 = block_sizze_161793;
        while (loop_while_161909) {
            int64_t next_stride_161913 = mul64((int64_t) 2, stride_161912);
            bool zzero_161914 = next_stride_161913 == (int64_t) 0;
            bool nonzzero_161915 = !zzero_161914;
            bool nonzzero_cert_161916;
            
            if (!nonzzero_161915) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:133:32-36\n   #5  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161917 = sdiv64(flat_dim_161794, next_stride_161913);
            bool bounds_invalid_upwards_161918 = slt64(num_merges_161917, (int64_t) 0);
            bool valid_161919 = !bounds_invalid_upwards_161918;
            bool range_valid_c_161920;
            
            if (!valid_161919) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161917, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:133:32-36\n   #6  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161922 = sub64(next_stride_161913, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161923 = sle64((int64_t) 0, m_161922);
            bool cond_161925 = slt64(next_stride_161913, (int64_t) 10);
            bool protect_assert_disj_161926 = nonzzero_161902 || cond_161925;
            bool nonzzero_cert_161927;
            
            if (!protect_assert_disj_161926) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161928 = smod_safe64(next_stride_161913, merge_block_sizze_161798);
            bool num_blocks_161929 = zeze_lhs_161928 == (int64_t) 0;
            bool protect_assert_disj_161930 = cond_161925 || num_blocks_161929;
            bool assert_c_161931;
            
            if (!protect_assert_disj_161930) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161933 = sdiv_safe64(next_stride_161913, merge_block_sizze_161798);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934 = add64((int64_t) 1, num_blocks_161933);
            int64_t j_m_i_161935 = sub64(next_stride_161913, stride_161912);
            int64_t flat_dim_161936 = merge_block_sizze_161798 * num_blocks_161933;
            bool bounds_invalid_upwards_161937 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, (int64_t) 0);
            bool empty_slice_161938 = j_m_i_161935 == (int64_t) 0;
            int64_t m_161939 = sub64(j_m_i_161935, (int64_t) 1);
            bool zzero_lte_i_161940 = sle64((int64_t) 0, stride_161912);
            bool i_lte_j_161941 = sle64(stride_161912, next_stride_161913);
            bool empty_slice_161942 = stride_161912 == (int64_t) 0;
            int64_t m_161943 = sub64(stride_161912, (int64_t) 1);
            bool bounds_invalid_upwards_161944 = slt64(num_blocks_161933, (int64_t) 0);
            bool cond_161945 = slt64((int64_t) 0, stride_161912);
            bool valid_161946 = !bounds_invalid_upwards_161937;
            int64_t i_p_m_t_s_161947 = add64(stride_161912, m_161939);
            bool zzero_leq_i_p_m_t_s_161948 = sle64((int64_t) 0, m_161943);
            bool i_p_m_t_s_leq_w_161949 = slt64(m_161943, next_stride_161913);
            bool valid_161950 = !bounds_invalid_upwards_161944;
            bool i_p_m_t_s_leq_w_161951 = slt64(m_161922, flat_dim_161936);
            bool y_161952 = slt64((int64_t) 0, j_m_i_161935);
            bool protect_assert_disj_161953 = cond_161925 || valid_161946;
            bool range_valid_c_161954;
            
            if (!protect_assert_disj_161953) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161955 = sle64((int64_t) 0, i_p_m_t_s_161947);
            bool i_p_m_t_s_leq_w_161956 = slt64(i_p_m_t_s_161947, next_stride_161913);
            bool y_161957 = zzero_leq_i_p_m_t_s_161948 && i_p_m_t_s_leq_w_161949;
            bool protect_assert_disj_161958 = cond_161925 || valid_161950;
            bool range_valid_c_161959;
            
            if (!protect_assert_disj_161958) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161960 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161951;
            bool y_161961 = zzero_lte_i_161940 && i_p_m_t_s_leq_w_161956;
            bool forwards_ok_161962 = zzero_lte_i_161940 && y_161957;
            bool ok_or_empty_161963 = zzero_161914 || y_161960;
            bool protect_assert_disj_161964 = cond_161945 || y_161952;
            bool y_161965 = zzero_leq_i_p_m_t_s_161955 && y_161961;
            bool ok_or_empty_161966 = empty_slice_161942 || forwards_ok_161962;
            bool protect_assert_disj_161967 = cond_161925 || ok_or_empty_161963;
            bool index_certs_161968;
            
            if (!protect_assert_disj_161967) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) flat_dim_161936, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161969 = !cond_161925;
            bool protect_assert_disj_161970 = protect_assert_disj_161964 || loop_not_taken_161969;
            bool index_certs_161971;
            
            if (!protect_assert_disj_161970) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161972 = i_lte_j_161941 && y_161965;
            bool protect_assert_disj_161973 = cond_161925 || ok_or_empty_161966;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161975 = ok_or_empty_161966 || loop_not_taken_161969;
            bool index_certs_161976;
            
            if (!protect_assert_disj_161975) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161977 = empty_slice_161938 || forwards_ok_161972;
            bool protect_assert_disj_161978 = cond_161925 || ok_or_empty_161977;
            bool index_certs_161979;
            
            if (!protect_assert_disj_161978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161980 = loop_not_taken_161969 || ok_or_empty_161977;
            bool index_certs_161981;
            
            if (!protect_assert_disj_161980) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 8 * num_merges_161917;
            int64_t bytes_171905 = next_stride_161913 * binop_x_171904;
            bool i_lte_j_161924 = sle64((int64_t) 0, next_stride_161913);
            
            if (mem_171906_cached_sizze_172957 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172957, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172958 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172958, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934;
            int64_t binop_x_171934 = (int64_t) 8 * num_blocks_161933;
            int64_t bytes_171935 = merge_block_sizze_161798 * binop_x_171934;
            int64_t bytes_171980 = (int64_t) 16 * stride_161912;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161917; i_171580++) {
                int64_t start_161985 = mul64(next_stride_161913, i_171580);
                int64_t j_m_i_161986 = sub64(loop_dz2084Uz2082U_161908, start_161985);
                bool empty_slice_161987 = j_m_i_161986 == (int64_t) 0;
                int64_t m_161988 = sub64(j_m_i_161986, (int64_t) 1);
                int64_t i_p_m_t_s_161989 = add64(start_161985, m_161988);
                bool zzero_leq_i_p_m_t_s_161990 = sle64((int64_t) 0, i_p_m_t_s_161989);
                bool i_p_m_t_s_leq_w_161991 = slt64(i_p_m_t_s_161989, loop_dz2084Uz2082U_161908);
                bool zzero_lte_i_161992 = sle64((int64_t) 0, start_161985);
                bool i_lte_j_161993 = sle64(start_161985, loop_dz2084Uz2082U_161908);
                bool y_161994 = i_p_m_t_s_leq_w_161991 && zzero_lte_i_161992;
                bool y_161995 = zzero_leq_i_p_m_t_s_161990 && y_161994;
                bool forwards_ok_161996 = i_lte_j_161993 && y_161995;
                bool ok_or_empty_161997 = empty_slice_161987 || forwards_ok_161996;
                bool index_certs_161998;
                
                if (!ok_or_empty_161997) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161985, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161908, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161999 = slt64(m_161922, j_m_i_161986);
                bool y_162000 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161999;
                bool forwards_ok_162001 = i_lte_j_161924 && y_162000;
                bool ok_or_empty_162002 = zzero_161914 || forwards_ok_162001;
                bool index_certs_162003;
                
                if (!ok_or_empty_162002) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) j_m_i_161986, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:133:32-36\n   #8  ftRelational.fut:130:5-133:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161925) {
                    double dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161945) {
                        double head_res_162552 = ((double *) mem_param_171900.mem)[start_161985];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161985];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161912 + start_161985;
                        double head_res_162555 = ((double *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161913; nest_i_172527++) {
                        ((double *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171980, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161913; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161913; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161935;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161912);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161935);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161912 + j_162566;
                                int64_t slice_162576 = start_161985 + slice_162575;
                                double leq_arg1_162577 = ((double *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161985 + i_162563;
                                double leq_arg0_162582 = ((double *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = leq_arg0_162582 <= leq_arg1_162577;
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        double loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161912);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161985 + i_162563;
                            double tmp_162593 = ((double *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161935);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:133:32-36\n   #9  ftRelational.fut:130:5-133:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161912 + j_162566;
                            int64_t slice_162600 = start_161985 + slice_162599;
                            double tmp_162601 = ((double *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((double *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172959 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172959, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172960 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172960, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934; i_171566++) {
                        int64_t split_count_arg3_162065 = mul64(merge_block_sizze_161798, i_171566);
                        int64_t defunc_0_split_count_res_162066;
                        int64_t defunc_0_split_count_res_162067;
                        int64_t defunc_0_split_count_res_162068;
                        int64_t defunc_0_split_count_res_162069;
                        int64_t defunc_0_split_count_res_162070;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162066, &defunc_0_split_count_res_162067, &defunc_0_split_count_res_162068, &defunc_0_split_count_res_162069, &defunc_0_split_count_res_162070, (int64_t) 0, stride_161912, (int64_t) 0, j_m_i_161935, split_count_arg3_162065) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162071 = slt64((int64_t) 0, defunc_0_split_count_res_162070);
                        bool defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        int64_t defunc_0_split_count_res_162077;
                        bool loop_while_162078;
                        int64_t ss_162079;
                        int64_t ss_162080;
                        int64_t tt_162081;
                        int64_t tt_162082;
                        int64_t count_162083;
                        
                        loop_while_162078 = loop_cond_162071;
                        ss_162079 = defunc_0_split_count_res_162066;
                        ss_162080 = defunc_0_split_count_res_162067;
                        tt_162081 = defunc_0_split_count_res_162068;
                        tt_162082 = defunc_0_split_count_res_162069;
                        count_162083 = defunc_0_split_count_res_162070;
                        while (loop_while_162078) {
                            int64_t zlze_lhs_162084 = sub64(ss_162080, ss_162079);
                            bool cond_162085 = sle64(zlze_lhs_162084, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162086;
                            int64_t defunc_0_lifted_step_res_162087;
                            int64_t defunc_0_lifted_step_res_162088;
                            int64_t defunc_0_lifted_step_res_162089;
                            
                            if (cond_162085) {
                                int64_t tmp_162605 = add64(tt_162081, count_162083);
                                
                                defunc_0_lifted_step_res_162086 = ss_162079;
                                defunc_0_lifted_step_res_162087 = tmp_162605;
                                defunc_0_lifted_step_res_162088 = tt_162082;
                                defunc_0_lifted_step_res_162089 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162091 = sub64(tt_162082, tt_162081);
                                bool cond_162092 = sle64(zlze_lhs_162091, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162093;
                                int64_t defunc_0_lifted_step_res_f_res_162094;
                                int64_t defunc_0_lifted_step_res_f_res_162095;
                                int64_t defunc_0_lifted_step_res_f_res_162096;
                                
                                if (cond_162092) {
                                    int64_t tmp_162606 = add64(ss_162079, count_162083);
                                    
                                    defunc_0_lifted_step_res_f_res_162093 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162094 = tt_162081;
                                    defunc_0_lifted_step_res_f_res_162095 = tt_162082;
                                    defunc_0_lifted_step_res_f_res_162096 = (int64_t) 0;
                                } else {
                                    bool cond_162098 = count_162083 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162099;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162100;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162101;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162102;
                                    
                                    if (cond_162098) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162079);
                                        bool y_162609 = slt64(ss_162079, stride_161912);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162079, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:133:32-36\n   #13 ftRelational.fut:130:5-133:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162081);
                                        bool y_162615 = slt64(tt_162081, j_m_i_161935);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162081, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:133:32-36\n   #13 ftRelational.fut:130:5-133:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161985 + ss_162079;
                                        double leq_arg1_162613 = ((double *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161912 + tt_162081;
                                        int64_t slice_162619 = start_161985 + slice_162618;
                                        double leq_arg0_162620 = ((double *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = leq_arg0_162620 <= leq_arg1_162613;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162081);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162079;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162079);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162081;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = tt_162082;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = (int64_t) 0;
                                    } else {
                                        int64_t m_162121 = sdiv64(count_162083, (int64_t) 2);
                                        int64_t n_162122 = sub64(count_162083, m_162121);
                                        bool cond_162123 = n_162122 == (int64_t) 0;
                                        int64_t zgze_lhs_162124 = add64(ss_162079, m_162121);
                                        bool cond_f_res_162125 = sle64(ss_162080, zgze_lhs_162124);
                                        bool x_162126 = !cond_162123;
                                        bool y_162127 = cond_f_res_162125 && x_162126;
                                        bool cond_162128 = cond_162123 || y_162127;
                                        bool leq_y_x_162129;
                                        
                                        if (cond_162128) {
                                            leq_y_x_162129 = 1;
                                        } else {
                                            bool x_162130 = sle64((int64_t) 0, zgze_lhs_162124);
                                            bool y_162131 = slt64(zgze_lhs_162124, stride_161912);
                                            bool bounds_check_162132 = x_162130 && y_162131;
                                            bool index_certs_162133;
                                            
                                            if (!bounds_check_162132) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162124, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:133:32-36\n   #13 ftRelational.fut:130:5-133:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162136 = add64(tt_162081, n_162122);
                                            int64_t leq_arg0_162137 = sub64(zm_lhs_162136, (int64_t) 1);
                                            bool x_162138 = sle64((int64_t) 0, leq_arg0_162137);
                                            bool y_162139 = slt64(leq_arg0_162137, j_m_i_161935);
                                            bool bounds_check_162140 = x_162138 && y_162139;
                                            bool index_certs_162141;
                                            
                                            if (!bounds_check_162140) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162137, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:133:32-36\n   #13 ftRelational.fut:130:5-133:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162134 = start_161985 + zgze_lhs_162124;
                                            double leq_arg1_162135 = ((double *) mem_param_171900.mem)[slice_162134];
                                            int64_t slice_162142 = stride_161912 + leq_arg0_162137;
                                            int64_t slice_162143 = start_161985 + slice_162142;
                                            double leq_arg0_162144 = ((double *) mem_param_171900.mem)[slice_162143];
                                            bool defunc_0_leq_res_162145 = leq_arg0_162144 <= leq_arg1_162135;
                                            
                                            leq_y_x_162129 = defunc_0_leq_res_162145;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                        
                                        if (leq_y_x_162129) {
                                            int64_t tmp_162626 = add64(tt_162081, n_162122);
                                            int64_t tmp_162627 = sub64(count_162083, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tt_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = tmp_162627;
                                        } else {
                                            int64_t tmp_162151 = add64(tt_162081, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tt_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tmp_162151;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = count_162083;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = ss_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                    }
                                    defunc_0_lifted_step_res_f_res_162093 = defunc_0_lifted_step_res_f_res_f_res_162099;
                                    defunc_0_lifted_step_res_f_res_162094 = defunc_0_lifted_step_res_f_res_f_res_162100;
                                    defunc_0_lifted_step_res_f_res_162095 = defunc_0_lifted_step_res_f_res_f_res_162101;
                                    defunc_0_lifted_step_res_f_res_162096 = defunc_0_lifted_step_res_f_res_f_res_162102;
                                }
                                defunc_0_lifted_step_res_162086 = defunc_0_lifted_step_res_f_res_162093;
                                defunc_0_lifted_step_res_162087 = defunc_0_lifted_step_res_f_res_162094;
                                defunc_0_lifted_step_res_162088 = defunc_0_lifted_step_res_f_res_162095;
                                defunc_0_lifted_step_res_162089 = defunc_0_lifted_step_res_f_res_162096;
                            }
                            
                            int64_t loopres_162152;
                            int64_t loopres_162153;
                            int64_t loopres_162154;
                            int64_t loopres_162155;
                            int64_t loopres_162156;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162152, &loopres_162153, &loopres_162154, &loopres_162155, &loopres_162156, defunc_0_lifted_step_res_162086, ss_162080, defunc_0_lifted_step_res_162087, defunc_0_lifted_step_res_162088, defunc_0_lifted_step_res_162089) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162157 = slt64((int64_t) 0, loopres_162156);
                            bool loop_while_tmp_172534 = loop_cond_162157;
                            int64_t ss_tmp_172535 = loopres_162152;
                            int64_t ss_tmp_172536 = loopres_162153;
                            int64_t tt_tmp_172537 = loopres_162154;
                            int64_t tt_tmp_172538 = loopres_162155;
                            int64_t count_tmp_172539 = loopres_162156;
                            
                            loop_while_162078 = loop_while_tmp_172534;
                            ss_162079 = ss_tmp_172535;
                            ss_162080 = ss_tmp_172536;
                            tt_162081 = tt_tmp_172537;
                            tt_162082 = tt_tmp_172538;
                            count_162083 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162072 = loop_while_162078;
                        defunc_0_split_count_res_162073 = ss_162079;
                        defunc_0_split_count_res_162074 = ss_162080;
                        defunc_0_split_count_res_162075 = tt_162081;
                        defunc_0_split_count_res_162076 = tt_162082;
                        defunc_0_split_count_res_162077 = count_162083;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162073;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162075;
                    }
                    if (mem_171936_cached_sizze_172961 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172961, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172962 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172962, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161933; i_171573++) {
                        bool y_162163 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool index_certs_162165;
                        
                        if (!y_162163) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162166 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162167 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162168 = add64((int64_t) 1, i_171573);
                        bool x_162169 = sle64((int64_t) 0, tmp_162168);
                        bool y_162170 = slt64(tmp_162168, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool bounds_check_162171 = x_162169 && y_162170;
                        bool index_certs_162172;
                        
                        if (!bounds_check_162171) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162168, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171919)[tmp_162168];
                        int64_t defunc_0_f_res_162174 = ((int64_t *) mem_171921)[tmp_162168];
                        int64_t merge_sequential_arg2_162175 = add64(stride_161912, defunc_0_f_res_162167);
                        int64_t merge_sequential_arg2_162176 = add64(stride_161912, defunc_0_f_res_162174);
                        int64_t j_m_i_162177 = sub64(merge_sequential_arg2_162176, merge_sequential_arg2_162175);
                        bool empty_slice_162178 = j_m_i_162177 == (int64_t) 0;
                        int64_t m_162179 = sub64(j_m_i_162177, (int64_t) 1);
                        int64_t i_p_m_t_s_162180 = add64(merge_sequential_arg2_162175, m_162179);
                        bool zzero_leq_i_p_m_t_s_162181 = sle64((int64_t) 0, i_p_m_t_s_162180);
                        bool i_p_m_t_s_leq_w_162182 = slt64(i_p_m_t_s_162180, next_stride_161913);
                        bool zzero_lte_i_162183 = sle64((int64_t) 0, merge_sequential_arg2_162175);
                        bool i_lte_j_162184 = sle64(merge_sequential_arg2_162175, merge_sequential_arg2_162176);
                        bool y_162185 = i_p_m_t_s_leq_w_162182 && zzero_lte_i_162183;
                        bool y_162186 = zzero_leq_i_p_m_t_s_162181 && y_162185;
                        bool forwards_ok_162187 = i_lte_j_162184 && y_162186;
                        bool ok_or_empty_162188 = empty_slice_162178 || forwards_ok_162187;
                        bool index_certs_162189;
                        
                        if (!ok_or_empty_162188) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162175, ":", (long long) merge_sequential_arg2_162176, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162190 = sub64(defunc_0_f_res_162173, defunc_0_f_res_162166);
                        bool empty_slice_162191 = j_m_i_162190 == (int64_t) 0;
                        int64_t m_162192 = sub64(j_m_i_162190, (int64_t) 1);
                        int64_t i_p_m_t_s_162193 = add64(defunc_0_f_res_162166, m_162192);
                        bool zzero_leq_i_p_m_t_s_162194 = sle64((int64_t) 0, i_p_m_t_s_162193);
                        bool i_p_m_t_s_leq_w_162195 = slt64(i_p_m_t_s_162193, next_stride_161913);
                        bool zzero_lte_i_162196 = sle64((int64_t) 0, defunc_0_f_res_162166);
                        bool i_lte_j_162197 = sle64(defunc_0_f_res_162166, defunc_0_f_res_162173);
                        bool y_162198 = i_p_m_t_s_leq_w_162195 && zzero_lte_i_162196;
                        bool y_162199 = zzero_leq_i_p_m_t_s_162194 && y_162198;
                        bool forwards_ok_162200 = i_lte_j_162197 && y_162199;
                        bool ok_or_empty_162201 = empty_slice_162191 || forwards_ok_162200;
                        bool index_certs_162202;
                        
                        if (!ok_or_empty_162201) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162166, ":", (long long) defunc_0_f_res_162173, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:133:32-36\n   #10 ftRelational.fut:130:5-133:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162203 = slt64((int64_t) 0, j_m_i_162190);
                        double dummy_162204;
                        int64_t dummy_162205;
                        
                        if (cond_162203) {
                            bool index_certs_162628;
                            
                            if (!cond_162203) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:133:32-36\n   #12 ftRelational.fut:130:5-133:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161985 + defunc_0_f_res_162166;
                            double head_res_162630 = ((double *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162204 = head_res_162630;
                            dummy_162205 = head_res_162631;
                        } else {
                            bool y_162210 = slt64((int64_t) 0, j_m_i_162177);
                            bool index_certs_162211;
                            
                            if (!y_162210) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:133:32-36\n   #12 ftRelational.fut:130:5-133:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162212 = start_161985 + merge_sequential_arg2_162175;
                            double head_res_162213 = ((double *) mem_param_171900.mem)[slice_162212];
                            int64_t head_res_162214 = ((int64_t *) mem_param_171903.mem)[slice_162212];
                            
                            dummy_162204 = head_res_162213;
                            dummy_162205 = head_res_162214;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161798; nest_i_172542++) {
                            ((double *) mem_171936)[i_171573 * merge_block_sizze_161798 + nest_i_172542] = dummy_162204;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161798; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + nest_i_172543] = dummy_162205;
                        }
                        
                        int64_t data_162217;
                        int64_t i_162221 = (int64_t) 0;
                        
                        for (int64_t k_162220 = 0; k_162220 < merge_block_sizze_161798; k_162220++) {
                            int64_t j_162224 = sub64(k_162220, i_162221);
                            bool cond_162225 = j_162224 == j_m_i_162177;
                            bool cond_162226;
                            
                            if (cond_162225) {
                                cond_162226 = 1;
                            } else {
                                bool cond_162227 = slt64(i_162221, j_m_i_162190);
                                bool cond_f_res_162228;
                                
                                if (cond_162227) {
                                    bool x_162632 = sle64((int64_t) 0, j_162224);
                                    bool y_162633 = slt64(j_162224, j_m_i_162177);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162221);
                                    bool bounds_check_162640 = cond_162227 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162175 + j_162224;
                                    int64_t slice_162637 = start_161985 + slice_162636;
                                    double leq_arg1_162638 = ((double *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162166 + i_162221;
                                    int64_t slice_162643 = start_161985 + slice_162642;
                                    double leq_arg0_162644 = ((double *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = leq_arg0_162644 <= leq_arg1_162638;
                                    
                                    cond_f_res_162228 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162228 = 0;
                                }
                                cond_162226 = cond_f_res_162228;
                            }
                            
                            int64_t loopres_162243;
                            double loopres_162244;
                            int64_t loopres_162245;
                            
                            if (cond_162226) {
                                bool x_162647 = sle64((int64_t) 0, i_162221);
                                bool y_162648 = slt64(i_162221, j_m_i_162190);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162221);
                                int64_t slice_162651 = defunc_0_f_res_162166 + i_162221;
                                int64_t slice_162652 = start_161985 + slice_162651;
                                double tmp_162653 = ((double *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162243 = tmp_162646;
                                loopres_162244 = tmp_162653;
                                loopres_162245 = tmp_162654;
                            } else {
                                bool x_162255 = sle64((int64_t) 0, j_162224);
                                bool y_162256 = slt64(j_162224, j_m_i_162177);
                                bool bounds_check_162257 = x_162255 && y_162256;
                                bool index_certs_162258;
                                
                                if (!bounds_check_162257) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:133:32-36\n   #11 ftRelational.fut:130:5-133:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162259 = merge_sequential_arg2_162175 + j_162224;
                                int64_t slice_162260 = start_161985 + slice_162259;
                                double tmp_162261 = ((double *) mem_param_171900.mem)[slice_162260];
                                int64_t tmp_162262 = ((int64_t *) mem_param_171903.mem)[slice_162260];
                                
                                loopres_162243 = i_162221;
                                loopres_162244 = tmp_162261;
                                loopres_162245 = tmp_162262;
                            }
                            ((double *) mem_171936)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162244;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162245;
                            
                            int64_t i_tmp_172544 = loopres_162243;
                            
                            i_162221 = i_tmp_172544;
                        }
                        data_162217 = i_162221;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171935, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162269 = next_stride_161913 * num_merges_161917;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            if (memblock_alloc(ctx, &mem_172016, bytes_171905, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            
            bool loop_cond_162272 = slt64(next_stride_161913, flat_dim_161794);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162269;
            bool loop_while_tmp_172521 = loop_cond_162272;
            int64_t stride_tmp_172524 = next_stride_161913;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161908 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161909 = loop_while_tmp_172521;
            stride_161912 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161903 = loop_dz2084Uz2082U_161908;
        data_161904 = loop_while_161909;
        data_161907 = stride_161912;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162273 = n_98843 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162274 = sle64((int64_t) 0, zs_lhs_161778);
        bool i_p_m_t_s_leq_w_162275 = slt64(zs_lhs_161778, data_161903);
        bool y_162276 = zzero_leq_i_p_m_t_s_162274 && i_p_m_t_s_leq_w_162275;
        bool ok_or_empty_162277 = empty_slice_162273 || y_162276;
        bool index_certs_162278;
        
        if (!ok_or_empty_162277) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_98843, "] out of bounds for array of shape [", (long long) data_161903, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:133:32-36\n   #6  ftRelational.fut:130:5-133:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_98843; i_171587++) {
        int64_t eta_p_162286 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162287 = sle64((int64_t) 0, eta_p_162286);
        bool y_162288 = slt64(eta_p_162286, n_98843);
        bool bounds_check_162289 = x_162287 && y_162288;
        bool index_certs_162290;
        
        if (!bounds_check_162289) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162286, "] out of bounds for array of shape [", (long long) n_98843, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:133:32-36\n   #5  ftRelational.fut:130:5-133:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        double lifted_lambda_res_162291 = ((double *) k_mem_171818.mem)[eta_p_162286];
        
        ((double *) mem_172028.mem)[i_171587] = lifted_lambda_res_162291;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_172030.mem, i_171587 * b_98844, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171819.mem, eta_p_162286 * b_98844, (int64_t []) {(int64_t) 1}, (int64_t []) {b_98844});
    }
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172951, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172952, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_172963, struct memblock *mem_out_p_172964, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_96478, int64_t b_96479)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172965 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172966 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172967 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172968 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172969 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172970 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172971 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172972 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172973 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172974 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_96478;
    bool cond_161777 = sle64(n_96478, (int64_t) 1);
    int64_t zs_lhs_161778 = sub64(n_96478, (int64_t) 1);
    int64_t zp_rhs_161779 = sdiv_safe64(zs_lhs_161778, (int64_t) 20);
    int64_t min_num_blocks_161780 = add64((int64_t) 1, zp_rhs_161779);
    bool loop_cond_161781 = slt64((int64_t) 1, min_num_blocks_161780);
    bool smallest_pow_2_geq_than_res_161782;
    int64_t smallest_pow_2_geq_than_res_161783;
    bool loop_while_161784;
    int64_t x_161785;
    
    loop_while_161784 = loop_cond_161781;
    x_161785 = (int64_t) 1;
    while (loop_while_161784) {
        int64_t loopres_161786 = mul64((int64_t) 2, x_161785);
        bool loop_cond_161787 = slt64(loopres_161786, min_num_blocks_161780);
        bool loop_while_tmp_172502 = loop_cond_161787;
        int64_t x_tmp_172503 = loopres_161786;
        
        loop_while_161784 = loop_while_tmp_172502;
        x_161785 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161782 = loop_while_161784;
    smallest_pow_2_geq_than_res_161783 = x_161785;
    
    bool zzero_161788 = smallest_pow_2_geq_than_res_161783 == (int64_t) 0;
    bool nonzzero_161789 = !zzero_161788;
    bool protect_assert_disj_161790 = cond_161777 || nonzzero_161789;
    bool nonzzero_cert_161791;
    
    if (!protect_assert_disj_161790) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:129:32-36\n   #5  ftRelational.fut:126:5-129:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161792 = sdiv_safe64(zs_lhs_161778, smallest_pow_2_geq_than_res_161783);
    int64_t block_sizze_161793 = add64((int64_t) 1, zp_rhs_161792);
    bool y_161799 = slt64((int64_t) 0, n_96478);
    bool protect_assert_disj_172415 = cond_161777 || y_161799;
    bool index_certs_161800;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_96478, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:129:32-36\n   #5  ftRelational.fut:126:5-129:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161814 = slt64(smallest_pow_2_geq_than_res_161783, (int64_t) 0);
    bool valid_161815 = !bounds_invalid_upwards_161814;
    bool protect_assert_disj_172423 = cond_161777 || valid_161815;
    bool range_valid_c_161816;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161783, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:129:32-36\n   #6  ftRelational.fut:126:5-129:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161818 = slt64(block_sizze_161793, (int64_t) 0);
    bool valid_161819 = !bounds_invalid_upwards_161818;
    bool protect_assert_disj_172425 = cond_161777 || valid_161819;
    bool range_valid_c_161820;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161793, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161822 = sle64(block_sizze_161793, (int64_t) 1);
    int64_t tmp_161823 = sub64(block_sizze_161793, (int64_t) 2);
    bool bounds_invalid_upwards_161824 = slt64(tmp_161823, (int64_t) 0);
    bool valid_161826 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_161827 = cond_161822 || valid_161826;
    bool protect_assert_disj_172427 = cond_161777 || protect_assert_disj_161827;
    bool range_valid_c_161828;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161823, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172027 = (int64_t) 4 * n_96478;
    int64_t bytes_172029 = n_96478 * b_96479;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_96478; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161794 = smallest_pow_2_geq_than_res_161783 * block_sizze_161793;
    bool x_172410 = !cond_161777;
    int64_t greatest_divisor_leq_than_arg1_161797 = mul64((int64_t) 2, block_sizze_161793);
    int64_t merge_block_sizze_161798;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161797) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161798 = x_172412;
    } else {
        merge_block_sizze_161798 = (int64_t) 0;
    }
    
    float reduce_arg1_161801;
    
    if (x_172410) {
        float x_172416 = ((float *) k_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161801 = x_172416;
    } else {
        reduce_arg1_161801 = 0.0F;
    }
    
    float defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        float x_172418;
        int64_t x_172419;
        float redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161801;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_96478; i_171547++) {
            float x_161805 = ((float *) k_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161811 = redout_171545 <= x_161805;
            float defunc_0_op_res_161812;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161812 = x_161805;
            } else {
                defunc_0_op_res_161812 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161813;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161813 = i_171547;
            } else {
                defunc_0_op_res_161813 = redout_171546;
            }
            
            float redout_tmp_172506 = defunc_0_op_res_161812;
            int64_t redout_tmp_172507 = defunc_0_op_res_161813;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0.0F;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161825 = add64((int64_t) 1, tmp_161823);
    int64_t binop_x_171822 = (int64_t) 4 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171823 = block_sizze_161793 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171826 = block_sizze_161793 * binop_x_171825;
    int64_t bytes_171836 = (int64_t) 4 * block_sizze_161793;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161793;
    bool loop_cond_161900 = slt64(block_sizze_161793, flat_dim_161794);
    bool zzero_161901 = merge_block_sizze_161798 == (int64_t) 0;
    bool nonzzero_161902 = !zzero_161901;
    
    if (cond_161777) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172965 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172965, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172966 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172966, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172967 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172967, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172968 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172968, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161783; i_171559++) {
            int64_t zp_lhs_161832 = mul64(block_sizze_161793, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161793; i_171552++) {
                int64_t k_161836 = add64(zp_lhs_161832, i_171552);
                bool cond_161837 = slt64(k_161836, n_96478);
                float lifted_lambda_res_161838;
                int64_t lifted_lambda_res_161839;
                
                if (cond_161837) {
                    bool x_162514 = sle64((int64_t) 0, k_161836);
                    bool bounds_check_162515 = cond_161837 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161836, "] out of bounds for array of shape [", (long long) n_96478, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float lifted_lambda_res_t_res_162517 = ((float *) k_mem_171818.mem)[k_161836];
                    
                    lifted_lambda_res_161838 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161839 = k_161836;
                } else {
                    lifted_lambda_res_161838 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161839 = defunc_0_reduce_res_162662;
                }
                ((float *) mem_171837)[i_171552] = lifted_lambda_res_161838;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161839;
            }
            if (!cond_161822) {
                for (int64_t i_161849 = 0; i_161849 < distance_161825; i_161849++) {
                    int64_t gt_arg1_161852 = add64((int64_t) 1, i_161849);
                    bool x_161853 = sle64((int64_t) 0, gt_arg1_161852);
                    bool y_161854 = slt64(gt_arg1_161852, block_sizze_161793);
                    bool bounds_check_161855 = x_161853 && y_161854;
                    bool index_certs_161856;
                    
                    if (!bounds_check_161855) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161852, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161858 = slt64(i_161849, block_sizze_161793);
                    bool index_certs_161859;
                    
                    if (!y_161858) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161849, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    float gt_arg1_161857 = ((float *) mem_171837)[gt_arg1_161852];
                    float gt_arg0_161860 = ((float *) mem_171837)[i_161849];
                    bool defunc_0_leq_res_161861 = gt_arg0_161860 <= gt_arg1_161857;
                    bool defunc_0_lifted_gt_res_161862 = !defunc_0_leq_res_161861;
                    bool s_161863;
                    int64_t s_161866;
                    bool loop_while_161867;
                    int64_t j_161870;
                    
                    loop_while_161867 = defunc_0_lifted_gt_res_161862;
                    j_161870 = i_161849;
                    while (loop_while_161867) {
                        bool x_161871 = sle64((int64_t) 0, j_161870);
                        bool y_161872 = slt64(j_161870, block_sizze_161793);
                        bool bounds_check_161873 = x_161871 && y_161872;
                        bool index_certs_161874;
                        
                        if (!bounds_check_161873) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161870, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161877 = add64((int64_t) 1, j_161870);
                        bool x_161878 = sle64((int64_t) 0, copy_arg0_161877);
                        bool y_161879 = slt64(copy_arg0_161877, block_sizze_161793);
                        bool bounds_check_161880 = x_161878 && y_161879;
                        bool index_certs_161881;
                        
                        if (!bounds_check_161880) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161877, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        float copy_arg0_161875 = ((float *) mem_171837)[j_161870];
                        int64_t copy_arg0_161876 = ((int64_t *) mem_171839)[j_161870];
                        float copy_arg0_161882 = ((float *) mem_171837)[copy_arg0_161877];
                        int64_t copy_arg0_161883 = ((int64_t *) mem_171839)[copy_arg0_161877];
                        
                        ((float *) mem_171837)[j_161870] = copy_arg0_161882;
                        ((int64_t *) mem_171839)[j_161870] = copy_arg0_161883;
                        ((float *) mem_171837)[copy_arg0_161877] = copy_arg0_161875;
                        ((int64_t *) mem_171839)[copy_arg0_161877] = copy_arg0_161876;
                        
                        int64_t tmp_161888 = sub64(j_161870, (int64_t) 1);
                        bool cond_161889 = sle64((int64_t) 0, tmp_161888);
                        bool loop_cond_161890;
                        
                        if (cond_161889) {
                            bool y_162519 = slt64(tmp_161888, block_sizze_161793);
                            bool bounds_check_162520 = cond_161889 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161888, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            float gt_arg1_162518 = ((float *) mem_171837)[j_161870];
                            float gt_arg0_162522 = ((float *) mem_171837)[tmp_161888];
                            bool defunc_0_leq_res_162523 = gt_arg0_162522 <= gt_arg1_162518;
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161890 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161890 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161890;
                        int64_t j_tmp_172517 = tmp_161888;
                        
                        loop_while_161867 = loop_while_tmp_172514;
                        j_161870 = j_tmp_172517;
                    }
                    s_161863 = loop_while_161867;
                    s_161866 = j_161870;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171824, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint32_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        
        int64_t data_161903;
        bool data_161904;
        int64_t data_161907;
        int64_t loop_dz2084Uz2082U_161908;
        bool loop_while_161909;
        int64_t stride_161912;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161908 = flat_dim_161794;
        loop_while_161909 = loop_cond_161900;
        stride_161912 = block_sizze_161793;
        while (loop_while_161909) {
            int64_t next_stride_161913 = mul64((int64_t) 2, stride_161912);
            bool zzero_161914 = next_stride_161913 == (int64_t) 0;
            bool nonzzero_161915 = !zzero_161914;
            bool nonzzero_cert_161916;
            
            if (!nonzzero_161915) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:129:32-36\n   #5  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161917 = sdiv64(flat_dim_161794, next_stride_161913);
            bool bounds_invalid_upwards_161918 = slt64(num_merges_161917, (int64_t) 0);
            bool valid_161919 = !bounds_invalid_upwards_161918;
            bool range_valid_c_161920;
            
            if (!valid_161919) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161917, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:129:32-36\n   #6  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161922 = sub64(next_stride_161913, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161923 = sle64((int64_t) 0, m_161922);
            bool cond_161925 = slt64(next_stride_161913, (int64_t) 10);
            bool protect_assert_disj_161926 = nonzzero_161902 || cond_161925;
            bool nonzzero_cert_161927;
            
            if (!protect_assert_disj_161926) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161928 = smod_safe64(next_stride_161913, merge_block_sizze_161798);
            bool num_blocks_161929 = zeze_lhs_161928 == (int64_t) 0;
            bool protect_assert_disj_161930 = cond_161925 || num_blocks_161929;
            bool assert_c_161931;
            
            if (!protect_assert_disj_161930) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161933 = sdiv_safe64(next_stride_161913, merge_block_sizze_161798);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934 = add64((int64_t) 1, num_blocks_161933);
            int64_t j_m_i_161935 = sub64(next_stride_161913, stride_161912);
            int64_t flat_dim_161936 = merge_block_sizze_161798 * num_blocks_161933;
            bool bounds_invalid_upwards_161937 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, (int64_t) 0);
            bool empty_slice_161938 = j_m_i_161935 == (int64_t) 0;
            int64_t m_161939 = sub64(j_m_i_161935, (int64_t) 1);
            bool zzero_lte_i_161940 = sle64((int64_t) 0, stride_161912);
            bool i_lte_j_161941 = sle64(stride_161912, next_stride_161913);
            bool empty_slice_161942 = stride_161912 == (int64_t) 0;
            int64_t m_161943 = sub64(stride_161912, (int64_t) 1);
            bool bounds_invalid_upwards_161944 = slt64(num_blocks_161933, (int64_t) 0);
            bool cond_161945 = slt64((int64_t) 0, stride_161912);
            bool valid_161946 = !bounds_invalid_upwards_161937;
            int64_t i_p_m_t_s_161947 = add64(stride_161912, m_161939);
            bool zzero_leq_i_p_m_t_s_161948 = sle64((int64_t) 0, m_161943);
            bool i_p_m_t_s_leq_w_161949 = slt64(m_161943, next_stride_161913);
            bool valid_161950 = !bounds_invalid_upwards_161944;
            bool i_p_m_t_s_leq_w_161951 = slt64(m_161922, flat_dim_161936);
            bool y_161952 = slt64((int64_t) 0, j_m_i_161935);
            bool protect_assert_disj_161953 = cond_161925 || valid_161946;
            bool range_valid_c_161954;
            
            if (!protect_assert_disj_161953) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161955 = sle64((int64_t) 0, i_p_m_t_s_161947);
            bool i_p_m_t_s_leq_w_161956 = slt64(i_p_m_t_s_161947, next_stride_161913);
            bool y_161957 = zzero_leq_i_p_m_t_s_161948 && i_p_m_t_s_leq_w_161949;
            bool protect_assert_disj_161958 = cond_161925 || valid_161950;
            bool range_valid_c_161959;
            
            if (!protect_assert_disj_161958) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161960 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161951;
            bool y_161961 = zzero_lte_i_161940 && i_p_m_t_s_leq_w_161956;
            bool forwards_ok_161962 = zzero_lte_i_161940 && y_161957;
            bool ok_or_empty_161963 = zzero_161914 || y_161960;
            bool protect_assert_disj_161964 = cond_161945 || y_161952;
            bool y_161965 = zzero_leq_i_p_m_t_s_161955 && y_161961;
            bool ok_or_empty_161966 = empty_slice_161942 || forwards_ok_161962;
            bool protect_assert_disj_161967 = cond_161925 || ok_or_empty_161963;
            bool index_certs_161968;
            
            if (!protect_assert_disj_161967) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) flat_dim_161936, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161969 = !cond_161925;
            bool protect_assert_disj_161970 = protect_assert_disj_161964 || loop_not_taken_161969;
            bool index_certs_161971;
            
            if (!protect_assert_disj_161970) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161972 = i_lte_j_161941 && y_161965;
            bool protect_assert_disj_161973 = cond_161925 || ok_or_empty_161966;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161975 = ok_or_empty_161966 || loop_not_taken_161969;
            bool index_certs_161976;
            
            if (!protect_assert_disj_161975) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161977 = empty_slice_161938 || forwards_ok_161972;
            bool protect_assert_disj_161978 = cond_161925 || ok_or_empty_161977;
            bool index_certs_161979;
            
            if (!protect_assert_disj_161978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161980 = loop_not_taken_161969 || ok_or_empty_161977;
            bool index_certs_161981;
            
            if (!protect_assert_disj_161980) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 4 * num_merges_161917;
            int64_t bytes_171905 = next_stride_161913 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161917;
            int64_t bytes_171908 = next_stride_161913 * binop_x_171907;
            bool i_lte_j_161924 = sle64((int64_t) 0, next_stride_161913);
            
            if (mem_171906_cached_sizze_172969 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172969, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172970 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172970, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934;
            int64_t binop_x_171934 = (int64_t) 4 * num_blocks_161933;
            int64_t bytes_171935 = merge_block_sizze_161798 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161933;
            int64_t bytes_171938 = merge_block_sizze_161798 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 8 * stride_161912;
            int64_t bytes_171982 = (int64_t) 16 * stride_161912;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161917; i_171580++) {
                int64_t start_161985 = mul64(next_stride_161913, i_171580);
                int64_t j_m_i_161986 = sub64(loop_dz2084Uz2082U_161908, start_161985);
                bool empty_slice_161987 = j_m_i_161986 == (int64_t) 0;
                int64_t m_161988 = sub64(j_m_i_161986, (int64_t) 1);
                int64_t i_p_m_t_s_161989 = add64(start_161985, m_161988);
                bool zzero_leq_i_p_m_t_s_161990 = sle64((int64_t) 0, i_p_m_t_s_161989);
                bool i_p_m_t_s_leq_w_161991 = slt64(i_p_m_t_s_161989, loop_dz2084Uz2082U_161908);
                bool zzero_lte_i_161992 = sle64((int64_t) 0, start_161985);
                bool i_lte_j_161993 = sle64(start_161985, loop_dz2084Uz2082U_161908);
                bool y_161994 = i_p_m_t_s_leq_w_161991 && zzero_lte_i_161992;
                bool y_161995 = zzero_leq_i_p_m_t_s_161990 && y_161994;
                bool forwards_ok_161996 = i_lte_j_161993 && y_161995;
                bool ok_or_empty_161997 = empty_slice_161987 || forwards_ok_161996;
                bool index_certs_161998;
                
                if (!ok_or_empty_161997) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161985, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161908, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161999 = slt64(m_161922, j_m_i_161986);
                bool y_162000 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161999;
                bool forwards_ok_162001 = i_lte_j_161924 && y_162000;
                bool ok_or_empty_162002 = zzero_161914 || forwards_ok_162001;
                bool index_certs_162003;
                
                if (!ok_or_empty_162002) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) j_m_i_161986, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:129:32-36\n   #8  ftRelational.fut:126:5-129:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161925) {
                    float dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161945) {
                        float head_res_162552 = ((float *) mem_param_171900.mem)[start_161985];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161985];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161912 + start_161985;
                        float head_res_162555 = ((float *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161913; nest_i_172527++) {
                        ((float *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161913; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161913; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161935;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161912);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161935);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161912 + j_162566;
                                int64_t slice_162576 = start_161985 + slice_162575;
                                float leq_arg1_162577 = ((float *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161985 + i_162563;
                                float leq_arg0_162582 = ((float *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = leq_arg0_162582 <= leq_arg1_162577;
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        float loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161912);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161985 + i_162563;
                            float tmp_162593 = ((float *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161935);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:129:32-36\n   #9  ftRelational.fut:126:5-129:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161912 + j_162566;
                            int64_t slice_162600 = start_161985 + slice_162599;
                            float tmp_162601 = ((float *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((float *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172971 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172971, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172972 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172972, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934; i_171566++) {
                        int64_t split_count_arg3_162065 = mul64(merge_block_sizze_161798, i_171566);
                        int64_t defunc_0_split_count_res_162066;
                        int64_t defunc_0_split_count_res_162067;
                        int64_t defunc_0_split_count_res_162068;
                        int64_t defunc_0_split_count_res_162069;
                        int64_t defunc_0_split_count_res_162070;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162066, &defunc_0_split_count_res_162067, &defunc_0_split_count_res_162068, &defunc_0_split_count_res_162069, &defunc_0_split_count_res_162070, (int64_t) 0, stride_161912, (int64_t) 0, j_m_i_161935, split_count_arg3_162065) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162071 = slt64((int64_t) 0, defunc_0_split_count_res_162070);
                        bool defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        int64_t defunc_0_split_count_res_162077;
                        bool loop_while_162078;
                        int64_t ss_162079;
                        int64_t ss_162080;
                        int64_t tt_162081;
                        int64_t tt_162082;
                        int64_t count_162083;
                        
                        loop_while_162078 = loop_cond_162071;
                        ss_162079 = defunc_0_split_count_res_162066;
                        ss_162080 = defunc_0_split_count_res_162067;
                        tt_162081 = defunc_0_split_count_res_162068;
                        tt_162082 = defunc_0_split_count_res_162069;
                        count_162083 = defunc_0_split_count_res_162070;
                        while (loop_while_162078) {
                            int64_t zlze_lhs_162084 = sub64(ss_162080, ss_162079);
                            bool cond_162085 = sle64(zlze_lhs_162084, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162086;
                            int64_t defunc_0_lifted_step_res_162087;
                            int64_t defunc_0_lifted_step_res_162088;
                            int64_t defunc_0_lifted_step_res_162089;
                            
                            if (cond_162085) {
                                int64_t tmp_162605 = add64(tt_162081, count_162083);
                                
                                defunc_0_lifted_step_res_162086 = ss_162079;
                                defunc_0_lifted_step_res_162087 = tmp_162605;
                                defunc_0_lifted_step_res_162088 = tt_162082;
                                defunc_0_lifted_step_res_162089 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162091 = sub64(tt_162082, tt_162081);
                                bool cond_162092 = sle64(zlze_lhs_162091, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162093;
                                int64_t defunc_0_lifted_step_res_f_res_162094;
                                int64_t defunc_0_lifted_step_res_f_res_162095;
                                int64_t defunc_0_lifted_step_res_f_res_162096;
                                
                                if (cond_162092) {
                                    int64_t tmp_162606 = add64(ss_162079, count_162083);
                                    
                                    defunc_0_lifted_step_res_f_res_162093 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162094 = tt_162081;
                                    defunc_0_lifted_step_res_f_res_162095 = tt_162082;
                                    defunc_0_lifted_step_res_f_res_162096 = (int64_t) 0;
                                } else {
                                    bool cond_162098 = count_162083 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162099;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162100;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162101;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162102;
                                    
                                    if (cond_162098) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162079);
                                        bool y_162609 = slt64(ss_162079, stride_161912);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162079, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:129:32-36\n   #13 ftRelational.fut:126:5-129:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162081);
                                        bool y_162615 = slt64(tt_162081, j_m_i_161935);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162081, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:129:32-36\n   #13 ftRelational.fut:126:5-129:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161985 + ss_162079;
                                        float leq_arg1_162613 = ((float *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161912 + tt_162081;
                                        int64_t slice_162619 = start_161985 + slice_162618;
                                        float leq_arg0_162620 = ((float *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = leq_arg0_162620 <= leq_arg1_162613;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162081);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162079;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162079);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162081;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = tt_162082;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = (int64_t) 0;
                                    } else {
                                        int64_t m_162121 = sdiv64(count_162083, (int64_t) 2);
                                        int64_t n_162122 = sub64(count_162083, m_162121);
                                        bool cond_162123 = n_162122 == (int64_t) 0;
                                        int64_t zgze_lhs_162124 = add64(ss_162079, m_162121);
                                        bool cond_f_res_162125 = sle64(ss_162080, zgze_lhs_162124);
                                        bool x_162126 = !cond_162123;
                                        bool y_162127 = cond_f_res_162125 && x_162126;
                                        bool cond_162128 = cond_162123 || y_162127;
                                        bool leq_y_x_162129;
                                        
                                        if (cond_162128) {
                                            leq_y_x_162129 = 1;
                                        } else {
                                            bool x_162130 = sle64((int64_t) 0, zgze_lhs_162124);
                                            bool y_162131 = slt64(zgze_lhs_162124, stride_161912);
                                            bool bounds_check_162132 = x_162130 && y_162131;
                                            bool index_certs_162133;
                                            
                                            if (!bounds_check_162132) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162124, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:129:32-36\n   #13 ftRelational.fut:126:5-129:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162136 = add64(tt_162081, n_162122);
                                            int64_t leq_arg0_162137 = sub64(zm_lhs_162136, (int64_t) 1);
                                            bool x_162138 = sle64((int64_t) 0, leq_arg0_162137);
                                            bool y_162139 = slt64(leq_arg0_162137, j_m_i_161935);
                                            bool bounds_check_162140 = x_162138 && y_162139;
                                            bool index_certs_162141;
                                            
                                            if (!bounds_check_162140) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162137, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:129:32-36\n   #13 ftRelational.fut:126:5-129:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162134 = start_161985 + zgze_lhs_162124;
                                            float leq_arg1_162135 = ((float *) mem_param_171900.mem)[slice_162134];
                                            int64_t slice_162142 = stride_161912 + leq_arg0_162137;
                                            int64_t slice_162143 = start_161985 + slice_162142;
                                            float leq_arg0_162144 = ((float *) mem_param_171900.mem)[slice_162143];
                                            bool defunc_0_leq_res_162145 = leq_arg0_162144 <= leq_arg1_162135;
                                            
                                            leq_y_x_162129 = defunc_0_leq_res_162145;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                        
                                        if (leq_y_x_162129) {
                                            int64_t tmp_162626 = add64(tt_162081, n_162122);
                                            int64_t tmp_162627 = sub64(count_162083, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tt_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = tmp_162627;
                                        } else {
                                            int64_t tmp_162151 = add64(tt_162081, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tt_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tmp_162151;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = count_162083;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = ss_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                    }
                                    defunc_0_lifted_step_res_f_res_162093 = defunc_0_lifted_step_res_f_res_f_res_162099;
                                    defunc_0_lifted_step_res_f_res_162094 = defunc_0_lifted_step_res_f_res_f_res_162100;
                                    defunc_0_lifted_step_res_f_res_162095 = defunc_0_lifted_step_res_f_res_f_res_162101;
                                    defunc_0_lifted_step_res_f_res_162096 = defunc_0_lifted_step_res_f_res_f_res_162102;
                                }
                                defunc_0_lifted_step_res_162086 = defunc_0_lifted_step_res_f_res_162093;
                                defunc_0_lifted_step_res_162087 = defunc_0_lifted_step_res_f_res_162094;
                                defunc_0_lifted_step_res_162088 = defunc_0_lifted_step_res_f_res_162095;
                                defunc_0_lifted_step_res_162089 = defunc_0_lifted_step_res_f_res_162096;
                            }
                            
                            int64_t loopres_162152;
                            int64_t loopres_162153;
                            int64_t loopres_162154;
                            int64_t loopres_162155;
                            int64_t loopres_162156;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162152, &loopres_162153, &loopres_162154, &loopres_162155, &loopres_162156, defunc_0_lifted_step_res_162086, ss_162080, defunc_0_lifted_step_res_162087, defunc_0_lifted_step_res_162088, defunc_0_lifted_step_res_162089) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162157 = slt64((int64_t) 0, loopres_162156);
                            bool loop_while_tmp_172534 = loop_cond_162157;
                            int64_t ss_tmp_172535 = loopres_162152;
                            int64_t ss_tmp_172536 = loopres_162153;
                            int64_t tt_tmp_172537 = loopres_162154;
                            int64_t tt_tmp_172538 = loopres_162155;
                            int64_t count_tmp_172539 = loopres_162156;
                            
                            loop_while_162078 = loop_while_tmp_172534;
                            ss_162079 = ss_tmp_172535;
                            ss_162080 = ss_tmp_172536;
                            tt_162081 = tt_tmp_172537;
                            tt_162082 = tt_tmp_172538;
                            count_162083 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162072 = loop_while_162078;
                        defunc_0_split_count_res_162073 = ss_162079;
                        defunc_0_split_count_res_162074 = ss_162080;
                        defunc_0_split_count_res_162075 = tt_162081;
                        defunc_0_split_count_res_162076 = tt_162082;
                        defunc_0_split_count_res_162077 = count_162083;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162073;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162075;
                    }
                    if (mem_171936_cached_sizze_172973 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172973, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172974 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172974, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161933; i_171573++) {
                        bool y_162163 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool index_certs_162165;
                        
                        if (!y_162163) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162166 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162167 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162168 = add64((int64_t) 1, i_171573);
                        bool x_162169 = sle64((int64_t) 0, tmp_162168);
                        bool y_162170 = slt64(tmp_162168, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool bounds_check_162171 = x_162169 && y_162170;
                        bool index_certs_162172;
                        
                        if (!bounds_check_162171) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162168, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171919)[tmp_162168];
                        int64_t defunc_0_f_res_162174 = ((int64_t *) mem_171921)[tmp_162168];
                        int64_t merge_sequential_arg2_162175 = add64(stride_161912, defunc_0_f_res_162167);
                        int64_t merge_sequential_arg2_162176 = add64(stride_161912, defunc_0_f_res_162174);
                        int64_t j_m_i_162177 = sub64(merge_sequential_arg2_162176, merge_sequential_arg2_162175);
                        bool empty_slice_162178 = j_m_i_162177 == (int64_t) 0;
                        int64_t m_162179 = sub64(j_m_i_162177, (int64_t) 1);
                        int64_t i_p_m_t_s_162180 = add64(merge_sequential_arg2_162175, m_162179);
                        bool zzero_leq_i_p_m_t_s_162181 = sle64((int64_t) 0, i_p_m_t_s_162180);
                        bool i_p_m_t_s_leq_w_162182 = slt64(i_p_m_t_s_162180, next_stride_161913);
                        bool zzero_lte_i_162183 = sle64((int64_t) 0, merge_sequential_arg2_162175);
                        bool i_lte_j_162184 = sle64(merge_sequential_arg2_162175, merge_sequential_arg2_162176);
                        bool y_162185 = i_p_m_t_s_leq_w_162182 && zzero_lte_i_162183;
                        bool y_162186 = zzero_leq_i_p_m_t_s_162181 && y_162185;
                        bool forwards_ok_162187 = i_lte_j_162184 && y_162186;
                        bool ok_or_empty_162188 = empty_slice_162178 || forwards_ok_162187;
                        bool index_certs_162189;
                        
                        if (!ok_or_empty_162188) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162175, ":", (long long) merge_sequential_arg2_162176, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162190 = sub64(defunc_0_f_res_162173, defunc_0_f_res_162166);
                        bool empty_slice_162191 = j_m_i_162190 == (int64_t) 0;
                        int64_t m_162192 = sub64(j_m_i_162190, (int64_t) 1);
                        int64_t i_p_m_t_s_162193 = add64(defunc_0_f_res_162166, m_162192);
                        bool zzero_leq_i_p_m_t_s_162194 = sle64((int64_t) 0, i_p_m_t_s_162193);
                        bool i_p_m_t_s_leq_w_162195 = slt64(i_p_m_t_s_162193, next_stride_161913);
                        bool zzero_lte_i_162196 = sle64((int64_t) 0, defunc_0_f_res_162166);
                        bool i_lte_j_162197 = sle64(defunc_0_f_res_162166, defunc_0_f_res_162173);
                        bool y_162198 = i_p_m_t_s_leq_w_162195 && zzero_lte_i_162196;
                        bool y_162199 = zzero_leq_i_p_m_t_s_162194 && y_162198;
                        bool forwards_ok_162200 = i_lte_j_162197 && y_162199;
                        bool ok_or_empty_162201 = empty_slice_162191 || forwards_ok_162200;
                        bool index_certs_162202;
                        
                        if (!ok_or_empty_162201) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162166, ":", (long long) defunc_0_f_res_162173, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:129:32-36\n   #10 ftRelational.fut:126:5-129:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162203 = slt64((int64_t) 0, j_m_i_162190);
                        float dummy_162204;
                        int64_t dummy_162205;
                        
                        if (cond_162203) {
                            bool index_certs_162628;
                            
                            if (!cond_162203) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:129:32-36\n   #12 ftRelational.fut:126:5-129:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161985 + defunc_0_f_res_162166;
                            float head_res_162630 = ((float *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162204 = head_res_162630;
                            dummy_162205 = head_res_162631;
                        } else {
                            bool y_162210 = slt64((int64_t) 0, j_m_i_162177);
                            bool index_certs_162211;
                            
                            if (!y_162210) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:129:32-36\n   #12 ftRelational.fut:126:5-129:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162212 = start_161985 + merge_sequential_arg2_162175;
                            float head_res_162213 = ((float *) mem_param_171900.mem)[slice_162212];
                            int64_t head_res_162214 = ((int64_t *) mem_param_171903.mem)[slice_162212];
                            
                            dummy_162204 = head_res_162213;
                            dummy_162205 = head_res_162214;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161798; nest_i_172542++) {
                            ((float *) mem_171936)[i_171573 * merge_block_sizze_161798 + nest_i_172542] = dummy_162204;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161798; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + nest_i_172543] = dummy_162205;
                        }
                        
                        int64_t data_162217;
                        int64_t i_162221 = (int64_t) 0;
                        
                        for (int64_t k_162220 = 0; k_162220 < merge_block_sizze_161798; k_162220++) {
                            int64_t j_162224 = sub64(k_162220, i_162221);
                            bool cond_162225 = j_162224 == j_m_i_162177;
                            bool cond_162226;
                            
                            if (cond_162225) {
                                cond_162226 = 1;
                            } else {
                                bool cond_162227 = slt64(i_162221, j_m_i_162190);
                                bool cond_f_res_162228;
                                
                                if (cond_162227) {
                                    bool x_162632 = sle64((int64_t) 0, j_162224);
                                    bool y_162633 = slt64(j_162224, j_m_i_162177);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162221);
                                    bool bounds_check_162640 = cond_162227 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162175 + j_162224;
                                    int64_t slice_162637 = start_161985 + slice_162636;
                                    float leq_arg1_162638 = ((float *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162166 + i_162221;
                                    int64_t slice_162643 = start_161985 + slice_162642;
                                    float leq_arg0_162644 = ((float *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = leq_arg0_162644 <= leq_arg1_162638;
                                    
                                    cond_f_res_162228 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162228 = 0;
                                }
                                cond_162226 = cond_f_res_162228;
                            }
                            
                            int64_t loopres_162243;
                            float loopres_162244;
                            int64_t loopres_162245;
                            
                            if (cond_162226) {
                                bool x_162647 = sle64((int64_t) 0, i_162221);
                                bool y_162648 = slt64(i_162221, j_m_i_162190);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162221);
                                int64_t slice_162651 = defunc_0_f_res_162166 + i_162221;
                                int64_t slice_162652 = start_161985 + slice_162651;
                                float tmp_162653 = ((float *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162243 = tmp_162646;
                                loopres_162244 = tmp_162653;
                                loopres_162245 = tmp_162654;
                            } else {
                                bool x_162255 = sle64((int64_t) 0, j_162224);
                                bool y_162256 = slt64(j_162224, j_m_i_162177);
                                bool bounds_check_162257 = x_162255 && y_162256;
                                bool index_certs_162258;
                                
                                if (!bounds_check_162257) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:129:32-36\n   #11 ftRelational.fut:126:5-129:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162259 = merge_sequential_arg2_162175 + j_162224;
                                int64_t slice_162260 = start_161985 + slice_162259;
                                float tmp_162261 = ((float *) mem_param_171900.mem)[slice_162260];
                                int64_t tmp_162262 = ((int64_t *) mem_param_171903.mem)[slice_162260];
                                
                                loopres_162243 = i_162221;
                                loopres_162244 = tmp_162261;
                                loopres_162245 = tmp_162262;
                            }
                            ((float *) mem_171936)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162244;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162245;
                            
                            int64_t i_tmp_172544 = loopres_162243;
                            
                            i_162221 = i_tmp_172544;
                        }
                        data_162217 = i_162221;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint32_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171906, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162269 = next_stride_161913 * num_merges_161917;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint32_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            
            bool loop_cond_162272 = slt64(next_stride_161913, flat_dim_161794);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162269;
            bool loop_while_tmp_172521 = loop_cond_162272;
            int64_t stride_tmp_172524 = next_stride_161913;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161908 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161909 = loop_while_tmp_172521;
            stride_161912 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161903 = loop_dz2084Uz2082U_161908;
        data_161904 = loop_while_161909;
        data_161907 = stride_161912;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162273 = n_96478 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162274 = sle64((int64_t) 0, zs_lhs_161778);
        bool i_p_m_t_s_leq_w_162275 = slt64(zs_lhs_161778, data_161903);
        bool y_162276 = zzero_leq_i_p_m_t_s_162274 && i_p_m_t_s_leq_w_162275;
        bool ok_or_empty_162277 = empty_slice_162273 || y_162276;
        bool index_certs_162278;
        
        if (!ok_or_empty_162277) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_96478, "] out of bounds for array of shape [", (long long) data_161903, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:129:32-36\n   #6  ftRelational.fut:126:5-129:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_172027, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_96478; i_171587++) {
        int64_t eta_p_162286 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162287 = sle64((int64_t) 0, eta_p_162286);
        bool y_162288 = slt64(eta_p_162286, n_96478);
        bool bounds_check_162289 = x_162287 && y_162288;
        bool index_certs_162290;
        
        if (!bounds_check_162289) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162286, "] out of bounds for array of shape [", (long long) n_96478, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:129:32-36\n   #5  ftRelational.fut:126:5-129:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        float lifted_lambda_res_162291 = ((float *) k_mem_171818.mem)[eta_p_162286];
        
        ((float *) mem_172028.mem)[i_171587] = lifted_lambda_res_162291;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_172030.mem, i_171587 * b_96479, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171819.mem, eta_p_162286 * b_96479, (int64_t []) {(int64_t) 1}, (int64_t []) {b_96479});
    }
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172963, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172964, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_172975, struct memblock *mem_out_p_172976, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_91754, int64_t b_91755)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172977 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172978 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172979 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172980 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172981 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172982 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172983 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172984 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172985 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172986 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_91754;
    bool cond_161777 = sle64(n_91754, (int64_t) 1);
    int64_t zs_lhs_161778 = sub64(n_91754, (int64_t) 1);
    int64_t zp_rhs_161779 = sdiv_safe64(zs_lhs_161778, (int64_t) 20);
    int64_t min_num_blocks_161780 = add64((int64_t) 1, zp_rhs_161779);
    bool loop_cond_161781 = slt64((int64_t) 1, min_num_blocks_161780);
    bool smallest_pow_2_geq_than_res_161782;
    int64_t smallest_pow_2_geq_than_res_161783;
    bool loop_while_161784;
    int64_t x_161785;
    
    loop_while_161784 = loop_cond_161781;
    x_161785 = (int64_t) 1;
    while (loop_while_161784) {
        int64_t loopres_161786 = mul64((int64_t) 2, x_161785);
        bool loop_cond_161787 = slt64(loopres_161786, min_num_blocks_161780);
        bool loop_while_tmp_172502 = loop_cond_161787;
        int64_t x_tmp_172503 = loopres_161786;
        
        loop_while_161784 = loop_while_tmp_172502;
        x_161785 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161782 = loop_while_161784;
    smallest_pow_2_geq_than_res_161783 = x_161785;
    
    bool zzero_161788 = smallest_pow_2_geq_than_res_161783 == (int64_t) 0;
    bool nonzzero_161789 = !zzero_161788;
    bool protect_assert_disj_161790 = cond_161777 || nonzzero_161789;
    bool nonzzero_cert_161791;
    
    if (!protect_assert_disj_161790) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:121:32-36\n   #5  ftRelational.fut:118:5-121:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161792 = sdiv_safe64(zs_lhs_161778, smallest_pow_2_geq_than_res_161783);
    int64_t block_sizze_161793 = add64((int64_t) 1, zp_rhs_161792);
    bool y_161799 = slt64((int64_t) 0, n_91754);
    bool protect_assert_disj_172415 = cond_161777 || y_161799;
    bool index_certs_161800;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_91754, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:121:32-36\n   #5  ftRelational.fut:118:5-121:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161814 = slt64(smallest_pow_2_geq_than_res_161783, (int64_t) 0);
    bool valid_161815 = !bounds_invalid_upwards_161814;
    bool protect_assert_disj_172423 = cond_161777 || valid_161815;
    bool range_valid_c_161816;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161783, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:121:32-36\n   #6  ftRelational.fut:118:5-121:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161818 = slt64(block_sizze_161793, (int64_t) 0);
    bool valid_161819 = !bounds_invalid_upwards_161818;
    bool protect_assert_disj_172425 = cond_161777 || valid_161819;
    bool range_valid_c_161820;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161793, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161822 = sle64(block_sizze_161793, (int64_t) 1);
    int64_t tmp_161823 = sub64(block_sizze_161793, (int64_t) 2);
    bool bounds_invalid_upwards_161824 = slt64(tmp_161823, (int64_t) 0);
    bool valid_161826 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_161827 = cond_161822 || valid_161826;
    bool protect_assert_disj_172427 = cond_161777 || protect_assert_disj_161827;
    bool range_valid_c_161828;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161823, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172027 = (int64_t) 4 * n_91754;
    int64_t bytes_172029 = n_91754 * b_91755;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_91754; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161794 = smallest_pow_2_geq_than_res_161783 * block_sizze_161793;
    bool x_172410 = !cond_161777;
    int64_t greatest_divisor_leq_than_arg1_161797 = mul64((int64_t) 2, block_sizze_161793);
    int64_t merge_block_sizze_161798;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161797) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161798 = x_172412;
    } else {
        merge_block_sizze_161798 = (int64_t) 0;
    }
    
    int32_t reduce_arg1_161801;
    
    if (x_172410) {
        int32_t x_172416 = ((int32_t *) k_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161801 = x_172416;
    } else {
        reduce_arg1_161801 = 0;
    }
    
    int32_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int32_t x_172418;
        int64_t x_172419;
        int32_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161801;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_91754; i_171547++) {
            int32_t x_161805 = ((int32_t *) k_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161811 = sle32(redout_171545, x_161805);
            int32_t defunc_0_op_res_161812;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161812 = x_161805;
            } else {
                defunc_0_op_res_161812 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161813;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161813 = i_171547;
            } else {
                defunc_0_op_res_161813 = redout_171546;
            }
            
            int32_t redout_tmp_172506 = defunc_0_op_res_161812;
            int64_t redout_tmp_172507 = defunc_0_op_res_161813;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161825 = add64((int64_t) 1, tmp_161823);
    int64_t binop_x_171822 = (int64_t) 4 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171823 = block_sizze_161793 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171826 = block_sizze_161793 * binop_x_171825;
    int64_t bytes_171836 = (int64_t) 4 * block_sizze_161793;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161793;
    bool loop_cond_161900 = slt64(block_sizze_161793, flat_dim_161794);
    bool zzero_161901 = merge_block_sizze_161798 == (int64_t) 0;
    bool nonzzero_161902 = !zzero_161901;
    
    if (cond_161777) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172977 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172977, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172978 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172978, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172979 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172979, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172980 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172980, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161783; i_171559++) {
            int64_t zp_lhs_161832 = mul64(block_sizze_161793, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161793; i_171552++) {
                int64_t k_161836 = add64(zp_lhs_161832, i_171552);
                bool cond_161837 = slt64(k_161836, n_91754);
                int32_t lifted_lambda_res_161838;
                int64_t lifted_lambda_res_161839;
                
                if (cond_161837) {
                    bool x_162514 = sle64((int64_t) 0, k_161836);
                    bool bounds_check_162515 = cond_161837 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161836, "] out of bounds for array of shape [", (long long) n_91754, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t lifted_lambda_res_t_res_162517 = ((int32_t *) k_mem_171818.mem)[k_161836];
                    
                    lifted_lambda_res_161838 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161839 = k_161836;
                } else {
                    lifted_lambda_res_161838 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161839 = defunc_0_reduce_res_162662;
                }
                ((int32_t *) mem_171837)[i_171552] = lifted_lambda_res_161838;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161839;
            }
            if (!cond_161822) {
                for (int64_t i_161849 = 0; i_161849 < distance_161825; i_161849++) {
                    int64_t gt_arg1_161852 = add64((int64_t) 1, i_161849);
                    bool x_161853 = sle64((int64_t) 0, gt_arg1_161852);
                    bool y_161854 = slt64(gt_arg1_161852, block_sizze_161793);
                    bool bounds_check_161855 = x_161853 && y_161854;
                    bool index_certs_161856;
                    
                    if (!bounds_check_161855) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161852, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161858 = slt64(i_161849, block_sizze_161793);
                    bool index_certs_161859;
                    
                    if (!y_161858) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161849, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int32_t gt_arg1_161857 = ((int32_t *) mem_171837)[gt_arg1_161852];
                    int32_t gt_arg0_161860 = ((int32_t *) mem_171837)[i_161849];
                    bool defunc_0_leq_res_161861 = sle32(gt_arg0_161860, gt_arg1_161857);
                    bool defunc_0_lifted_gt_res_161862 = !defunc_0_leq_res_161861;
                    bool s_161863;
                    int64_t s_161866;
                    bool loop_while_161867;
                    int64_t j_161870;
                    
                    loop_while_161867 = defunc_0_lifted_gt_res_161862;
                    j_161870 = i_161849;
                    while (loop_while_161867) {
                        bool x_161871 = sle64((int64_t) 0, j_161870);
                        bool y_161872 = slt64(j_161870, block_sizze_161793);
                        bool bounds_check_161873 = x_161871 && y_161872;
                        bool index_certs_161874;
                        
                        if (!bounds_check_161873) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161870, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161877 = add64((int64_t) 1, j_161870);
                        bool x_161878 = sle64((int64_t) 0, copy_arg0_161877);
                        bool y_161879 = slt64(copy_arg0_161877, block_sizze_161793);
                        bool bounds_check_161880 = x_161878 && y_161879;
                        bool index_certs_161881;
                        
                        if (!bounds_check_161880) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161877, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t copy_arg0_161875 = ((int32_t *) mem_171837)[j_161870];
                        int64_t copy_arg0_161876 = ((int64_t *) mem_171839)[j_161870];
                        int32_t copy_arg0_161882 = ((int32_t *) mem_171837)[copy_arg0_161877];
                        int64_t copy_arg0_161883 = ((int64_t *) mem_171839)[copy_arg0_161877];
                        
                        ((int32_t *) mem_171837)[j_161870] = copy_arg0_161882;
                        ((int64_t *) mem_171839)[j_161870] = copy_arg0_161883;
                        ((int32_t *) mem_171837)[copy_arg0_161877] = copy_arg0_161875;
                        ((int64_t *) mem_171839)[copy_arg0_161877] = copy_arg0_161876;
                        
                        int64_t tmp_161888 = sub64(j_161870, (int64_t) 1);
                        bool cond_161889 = sle64((int64_t) 0, tmp_161888);
                        bool loop_cond_161890;
                        
                        if (cond_161889) {
                            bool y_162519 = slt64(tmp_161888, block_sizze_161793);
                            bool bounds_check_162520 = cond_161889 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161888, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int32_t gt_arg1_162518 = ((int32_t *) mem_171837)[j_161870];
                            int32_t gt_arg0_162522 = ((int32_t *) mem_171837)[tmp_161888];
                            bool defunc_0_leq_res_162523 = sle32(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161890 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161890 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161890;
                        int64_t j_tmp_172517 = tmp_161888;
                        
                        loop_while_161867 = loop_while_tmp_172514;
                        j_161870 = j_tmp_172517;
                    }
                    s_161863 = loop_while_161867;
                    s_161866 = j_161870;
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171824, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 2, (uint32_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint32_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        
        int64_t data_161903;
        bool data_161904;
        int64_t data_161907;
        int64_t loop_dz2084Uz2082U_161908;
        bool loop_while_161909;
        int64_t stride_161912;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161908 = flat_dim_161794;
        loop_while_161909 = loop_cond_161900;
        stride_161912 = block_sizze_161793;
        while (loop_while_161909) {
            int64_t next_stride_161913 = mul64((int64_t) 2, stride_161912);
            bool zzero_161914 = next_stride_161913 == (int64_t) 0;
            bool nonzzero_161915 = !zzero_161914;
            bool nonzzero_cert_161916;
            
            if (!nonzzero_161915) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:121:32-36\n   #5  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161917 = sdiv64(flat_dim_161794, next_stride_161913);
            bool bounds_invalid_upwards_161918 = slt64(num_merges_161917, (int64_t) 0);
            bool valid_161919 = !bounds_invalid_upwards_161918;
            bool range_valid_c_161920;
            
            if (!valid_161919) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161917, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:121:32-36\n   #6  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161922 = sub64(next_stride_161913, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161923 = sle64((int64_t) 0, m_161922);
            bool cond_161925 = slt64(next_stride_161913, (int64_t) 10);
            bool protect_assert_disj_161926 = nonzzero_161902 || cond_161925;
            bool nonzzero_cert_161927;
            
            if (!protect_assert_disj_161926) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161928 = smod_safe64(next_stride_161913, merge_block_sizze_161798);
            bool num_blocks_161929 = zeze_lhs_161928 == (int64_t) 0;
            bool protect_assert_disj_161930 = cond_161925 || num_blocks_161929;
            bool assert_c_161931;
            
            if (!protect_assert_disj_161930) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161933 = sdiv_safe64(next_stride_161913, merge_block_sizze_161798);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934 = add64((int64_t) 1, num_blocks_161933);
            int64_t j_m_i_161935 = sub64(next_stride_161913, stride_161912);
            int64_t flat_dim_161936 = merge_block_sizze_161798 * num_blocks_161933;
            bool bounds_invalid_upwards_161937 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, (int64_t) 0);
            bool empty_slice_161938 = j_m_i_161935 == (int64_t) 0;
            int64_t m_161939 = sub64(j_m_i_161935, (int64_t) 1);
            bool zzero_lte_i_161940 = sle64((int64_t) 0, stride_161912);
            bool i_lte_j_161941 = sle64(stride_161912, next_stride_161913);
            bool empty_slice_161942 = stride_161912 == (int64_t) 0;
            int64_t m_161943 = sub64(stride_161912, (int64_t) 1);
            bool bounds_invalid_upwards_161944 = slt64(num_blocks_161933, (int64_t) 0);
            bool cond_161945 = slt64((int64_t) 0, stride_161912);
            bool valid_161946 = !bounds_invalid_upwards_161937;
            int64_t i_p_m_t_s_161947 = add64(stride_161912, m_161939);
            bool zzero_leq_i_p_m_t_s_161948 = sle64((int64_t) 0, m_161943);
            bool i_p_m_t_s_leq_w_161949 = slt64(m_161943, next_stride_161913);
            bool valid_161950 = !bounds_invalid_upwards_161944;
            bool i_p_m_t_s_leq_w_161951 = slt64(m_161922, flat_dim_161936);
            bool y_161952 = slt64((int64_t) 0, j_m_i_161935);
            bool protect_assert_disj_161953 = cond_161925 || valid_161946;
            bool range_valid_c_161954;
            
            if (!protect_assert_disj_161953) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161955 = sle64((int64_t) 0, i_p_m_t_s_161947);
            bool i_p_m_t_s_leq_w_161956 = slt64(i_p_m_t_s_161947, next_stride_161913);
            bool y_161957 = zzero_leq_i_p_m_t_s_161948 && i_p_m_t_s_leq_w_161949;
            bool protect_assert_disj_161958 = cond_161925 || valid_161950;
            bool range_valid_c_161959;
            
            if (!protect_assert_disj_161958) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161960 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161951;
            bool y_161961 = zzero_lte_i_161940 && i_p_m_t_s_leq_w_161956;
            bool forwards_ok_161962 = zzero_lte_i_161940 && y_161957;
            bool ok_or_empty_161963 = zzero_161914 || y_161960;
            bool protect_assert_disj_161964 = cond_161945 || y_161952;
            bool y_161965 = zzero_leq_i_p_m_t_s_161955 && y_161961;
            bool ok_or_empty_161966 = empty_slice_161942 || forwards_ok_161962;
            bool protect_assert_disj_161967 = cond_161925 || ok_or_empty_161963;
            bool index_certs_161968;
            
            if (!protect_assert_disj_161967) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) flat_dim_161936, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161969 = !cond_161925;
            bool protect_assert_disj_161970 = protect_assert_disj_161964 || loop_not_taken_161969;
            bool index_certs_161971;
            
            if (!protect_assert_disj_161970) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161972 = i_lte_j_161941 && y_161965;
            bool protect_assert_disj_161973 = cond_161925 || ok_or_empty_161966;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161975 = ok_or_empty_161966 || loop_not_taken_161969;
            bool index_certs_161976;
            
            if (!protect_assert_disj_161975) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161977 = empty_slice_161938 || forwards_ok_161972;
            bool protect_assert_disj_161978 = cond_161925 || ok_or_empty_161977;
            bool index_certs_161979;
            
            if (!protect_assert_disj_161978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161980 = loop_not_taken_161969 || ok_or_empty_161977;
            bool index_certs_161981;
            
            if (!protect_assert_disj_161980) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 4 * num_merges_161917;
            int64_t bytes_171905 = next_stride_161913 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161917;
            int64_t bytes_171908 = next_stride_161913 * binop_x_171907;
            bool i_lte_j_161924 = sle64((int64_t) 0, next_stride_161913);
            
            if (mem_171906_cached_sizze_172981 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172981, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172982 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172982, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934;
            int64_t binop_x_171934 = (int64_t) 4 * num_blocks_161933;
            int64_t bytes_171935 = merge_block_sizze_161798 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161933;
            int64_t bytes_171938 = merge_block_sizze_161798 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 8 * stride_161912;
            int64_t bytes_171982 = (int64_t) 16 * stride_161912;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161917; i_171580++) {
                int64_t start_161985 = mul64(next_stride_161913, i_171580);
                int64_t j_m_i_161986 = sub64(loop_dz2084Uz2082U_161908, start_161985);
                bool empty_slice_161987 = j_m_i_161986 == (int64_t) 0;
                int64_t m_161988 = sub64(j_m_i_161986, (int64_t) 1);
                int64_t i_p_m_t_s_161989 = add64(start_161985, m_161988);
                bool zzero_leq_i_p_m_t_s_161990 = sle64((int64_t) 0, i_p_m_t_s_161989);
                bool i_p_m_t_s_leq_w_161991 = slt64(i_p_m_t_s_161989, loop_dz2084Uz2082U_161908);
                bool zzero_lte_i_161992 = sle64((int64_t) 0, start_161985);
                bool i_lte_j_161993 = sle64(start_161985, loop_dz2084Uz2082U_161908);
                bool y_161994 = i_p_m_t_s_leq_w_161991 && zzero_lte_i_161992;
                bool y_161995 = zzero_leq_i_p_m_t_s_161990 && y_161994;
                bool forwards_ok_161996 = i_lte_j_161993 && y_161995;
                bool ok_or_empty_161997 = empty_slice_161987 || forwards_ok_161996;
                bool index_certs_161998;
                
                if (!ok_or_empty_161997) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161985, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161908, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161999 = slt64(m_161922, j_m_i_161986);
                bool y_162000 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161999;
                bool forwards_ok_162001 = i_lte_j_161924 && y_162000;
                bool ok_or_empty_162002 = zzero_161914 || forwards_ok_162001;
                bool index_certs_162003;
                
                if (!ok_or_empty_162002) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) j_m_i_161986, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:121:32-36\n   #8  ftRelational.fut:118:5-121:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161925) {
                    int32_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161945) {
                        int32_t head_res_162552 = ((int32_t *) mem_param_171900.mem)[start_161985];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161985];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161912 + start_161985;
                        int32_t head_res_162555 = ((int32_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161913; nest_i_172527++) {
                        ((int32_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161913; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161913; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161935;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161912);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161935);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161912 + j_162566;
                                int64_t slice_162576 = start_161985 + slice_162575;
                                int32_t leq_arg1_162577 = ((int32_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161985 + i_162563;
                                int32_t leq_arg0_162582 = ((int32_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle32(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int32_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161912);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161985 + i_162563;
                            int32_t tmp_162593 = ((int32_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161935);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:121:32-36\n   #9  ftRelational.fut:118:5-121:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161912 + j_162566;
                            int64_t slice_162600 = start_161985 + slice_162599;
                            int32_t tmp_162601 = ((int32_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int32_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172983 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172983, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172984 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172984, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934; i_171566++) {
                        int64_t split_count_arg3_162065 = mul64(merge_block_sizze_161798, i_171566);
                        int64_t defunc_0_split_count_res_162066;
                        int64_t defunc_0_split_count_res_162067;
                        int64_t defunc_0_split_count_res_162068;
                        int64_t defunc_0_split_count_res_162069;
                        int64_t defunc_0_split_count_res_162070;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162066, &defunc_0_split_count_res_162067, &defunc_0_split_count_res_162068, &defunc_0_split_count_res_162069, &defunc_0_split_count_res_162070, (int64_t) 0, stride_161912, (int64_t) 0, j_m_i_161935, split_count_arg3_162065) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162071 = slt64((int64_t) 0, defunc_0_split_count_res_162070);
                        bool defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        int64_t defunc_0_split_count_res_162077;
                        bool loop_while_162078;
                        int64_t ss_162079;
                        int64_t ss_162080;
                        int64_t tt_162081;
                        int64_t tt_162082;
                        int64_t count_162083;
                        
                        loop_while_162078 = loop_cond_162071;
                        ss_162079 = defunc_0_split_count_res_162066;
                        ss_162080 = defunc_0_split_count_res_162067;
                        tt_162081 = defunc_0_split_count_res_162068;
                        tt_162082 = defunc_0_split_count_res_162069;
                        count_162083 = defunc_0_split_count_res_162070;
                        while (loop_while_162078) {
                            int64_t zlze_lhs_162084 = sub64(ss_162080, ss_162079);
                            bool cond_162085 = sle64(zlze_lhs_162084, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162086;
                            int64_t defunc_0_lifted_step_res_162087;
                            int64_t defunc_0_lifted_step_res_162088;
                            int64_t defunc_0_lifted_step_res_162089;
                            
                            if (cond_162085) {
                                int64_t tmp_162605 = add64(tt_162081, count_162083);
                                
                                defunc_0_lifted_step_res_162086 = ss_162079;
                                defunc_0_lifted_step_res_162087 = tmp_162605;
                                defunc_0_lifted_step_res_162088 = tt_162082;
                                defunc_0_lifted_step_res_162089 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162091 = sub64(tt_162082, tt_162081);
                                bool cond_162092 = sle64(zlze_lhs_162091, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162093;
                                int64_t defunc_0_lifted_step_res_f_res_162094;
                                int64_t defunc_0_lifted_step_res_f_res_162095;
                                int64_t defunc_0_lifted_step_res_f_res_162096;
                                
                                if (cond_162092) {
                                    int64_t tmp_162606 = add64(ss_162079, count_162083);
                                    
                                    defunc_0_lifted_step_res_f_res_162093 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162094 = tt_162081;
                                    defunc_0_lifted_step_res_f_res_162095 = tt_162082;
                                    defunc_0_lifted_step_res_f_res_162096 = (int64_t) 0;
                                } else {
                                    bool cond_162098 = count_162083 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162099;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162100;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162101;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162102;
                                    
                                    if (cond_162098) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162079);
                                        bool y_162609 = slt64(ss_162079, stride_161912);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162079, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:121:32-36\n   #13 ftRelational.fut:118:5-121:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162081);
                                        bool y_162615 = slt64(tt_162081, j_m_i_161935);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162081, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:121:32-36\n   #13 ftRelational.fut:118:5-121:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161985 + ss_162079;
                                        int32_t leq_arg1_162613 = ((int32_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161912 + tt_162081;
                                        int64_t slice_162619 = start_161985 + slice_162618;
                                        int32_t leq_arg0_162620 = ((int32_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle32(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162081);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162079;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162079);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162081;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = tt_162082;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = (int64_t) 0;
                                    } else {
                                        int64_t m_162121 = sdiv64(count_162083, (int64_t) 2);
                                        int64_t n_162122 = sub64(count_162083, m_162121);
                                        bool cond_162123 = n_162122 == (int64_t) 0;
                                        int64_t zgze_lhs_162124 = add64(ss_162079, m_162121);
                                        bool cond_f_res_162125 = sle64(ss_162080, zgze_lhs_162124);
                                        bool x_162126 = !cond_162123;
                                        bool y_162127 = cond_f_res_162125 && x_162126;
                                        bool cond_162128 = cond_162123 || y_162127;
                                        bool leq_y_x_162129;
                                        
                                        if (cond_162128) {
                                            leq_y_x_162129 = 1;
                                        } else {
                                            bool x_162130 = sle64((int64_t) 0, zgze_lhs_162124);
                                            bool y_162131 = slt64(zgze_lhs_162124, stride_161912);
                                            bool bounds_check_162132 = x_162130 && y_162131;
                                            bool index_certs_162133;
                                            
                                            if (!bounds_check_162132) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162124, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:121:32-36\n   #13 ftRelational.fut:118:5-121:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162136 = add64(tt_162081, n_162122);
                                            int64_t leq_arg0_162137 = sub64(zm_lhs_162136, (int64_t) 1);
                                            bool x_162138 = sle64((int64_t) 0, leq_arg0_162137);
                                            bool y_162139 = slt64(leq_arg0_162137, j_m_i_161935);
                                            bool bounds_check_162140 = x_162138 && y_162139;
                                            bool index_certs_162141;
                                            
                                            if (!bounds_check_162140) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162137, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:121:32-36\n   #13 ftRelational.fut:118:5-121:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162134 = start_161985 + zgze_lhs_162124;
                                            int32_t leq_arg1_162135 = ((int32_t *) mem_param_171900.mem)[slice_162134];
                                            int64_t slice_162142 = stride_161912 + leq_arg0_162137;
                                            int64_t slice_162143 = start_161985 + slice_162142;
                                            int32_t leq_arg0_162144 = ((int32_t *) mem_param_171900.mem)[slice_162143];
                                            bool defunc_0_leq_res_162145 = sle32(leq_arg0_162144, leq_arg1_162135);
                                            
                                            leq_y_x_162129 = defunc_0_leq_res_162145;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                        
                                        if (leq_y_x_162129) {
                                            int64_t tmp_162626 = add64(tt_162081, n_162122);
                                            int64_t tmp_162627 = sub64(count_162083, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tt_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = tmp_162627;
                                        } else {
                                            int64_t tmp_162151 = add64(tt_162081, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tt_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tmp_162151;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = count_162083;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = ss_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                    }
                                    defunc_0_lifted_step_res_f_res_162093 = defunc_0_lifted_step_res_f_res_f_res_162099;
                                    defunc_0_lifted_step_res_f_res_162094 = defunc_0_lifted_step_res_f_res_f_res_162100;
                                    defunc_0_lifted_step_res_f_res_162095 = defunc_0_lifted_step_res_f_res_f_res_162101;
                                    defunc_0_lifted_step_res_f_res_162096 = defunc_0_lifted_step_res_f_res_f_res_162102;
                                }
                                defunc_0_lifted_step_res_162086 = defunc_0_lifted_step_res_f_res_162093;
                                defunc_0_lifted_step_res_162087 = defunc_0_lifted_step_res_f_res_162094;
                                defunc_0_lifted_step_res_162088 = defunc_0_lifted_step_res_f_res_162095;
                                defunc_0_lifted_step_res_162089 = defunc_0_lifted_step_res_f_res_162096;
                            }
                            
                            int64_t loopres_162152;
                            int64_t loopres_162153;
                            int64_t loopres_162154;
                            int64_t loopres_162155;
                            int64_t loopres_162156;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162152, &loopres_162153, &loopres_162154, &loopres_162155, &loopres_162156, defunc_0_lifted_step_res_162086, ss_162080, defunc_0_lifted_step_res_162087, defunc_0_lifted_step_res_162088, defunc_0_lifted_step_res_162089) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162157 = slt64((int64_t) 0, loopres_162156);
                            bool loop_while_tmp_172534 = loop_cond_162157;
                            int64_t ss_tmp_172535 = loopres_162152;
                            int64_t ss_tmp_172536 = loopres_162153;
                            int64_t tt_tmp_172537 = loopres_162154;
                            int64_t tt_tmp_172538 = loopres_162155;
                            int64_t count_tmp_172539 = loopres_162156;
                            
                            loop_while_162078 = loop_while_tmp_172534;
                            ss_162079 = ss_tmp_172535;
                            ss_162080 = ss_tmp_172536;
                            tt_162081 = tt_tmp_172537;
                            tt_162082 = tt_tmp_172538;
                            count_162083 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162072 = loop_while_162078;
                        defunc_0_split_count_res_162073 = ss_162079;
                        defunc_0_split_count_res_162074 = ss_162080;
                        defunc_0_split_count_res_162075 = tt_162081;
                        defunc_0_split_count_res_162076 = tt_162082;
                        defunc_0_split_count_res_162077 = count_162083;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162073;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162075;
                    }
                    if (mem_171936_cached_sizze_172985 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172985, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172986 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172986, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161933; i_171573++) {
                        bool y_162163 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool index_certs_162165;
                        
                        if (!y_162163) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162166 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162167 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162168 = add64((int64_t) 1, i_171573);
                        bool x_162169 = sle64((int64_t) 0, tmp_162168);
                        bool y_162170 = slt64(tmp_162168, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool bounds_check_162171 = x_162169 && y_162170;
                        bool index_certs_162172;
                        
                        if (!bounds_check_162171) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162168, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171919)[tmp_162168];
                        int64_t defunc_0_f_res_162174 = ((int64_t *) mem_171921)[tmp_162168];
                        int64_t merge_sequential_arg2_162175 = add64(stride_161912, defunc_0_f_res_162167);
                        int64_t merge_sequential_arg2_162176 = add64(stride_161912, defunc_0_f_res_162174);
                        int64_t j_m_i_162177 = sub64(merge_sequential_arg2_162176, merge_sequential_arg2_162175);
                        bool empty_slice_162178 = j_m_i_162177 == (int64_t) 0;
                        int64_t m_162179 = sub64(j_m_i_162177, (int64_t) 1);
                        int64_t i_p_m_t_s_162180 = add64(merge_sequential_arg2_162175, m_162179);
                        bool zzero_leq_i_p_m_t_s_162181 = sle64((int64_t) 0, i_p_m_t_s_162180);
                        bool i_p_m_t_s_leq_w_162182 = slt64(i_p_m_t_s_162180, next_stride_161913);
                        bool zzero_lte_i_162183 = sle64((int64_t) 0, merge_sequential_arg2_162175);
                        bool i_lte_j_162184 = sle64(merge_sequential_arg2_162175, merge_sequential_arg2_162176);
                        bool y_162185 = i_p_m_t_s_leq_w_162182 && zzero_lte_i_162183;
                        bool y_162186 = zzero_leq_i_p_m_t_s_162181 && y_162185;
                        bool forwards_ok_162187 = i_lte_j_162184 && y_162186;
                        bool ok_or_empty_162188 = empty_slice_162178 || forwards_ok_162187;
                        bool index_certs_162189;
                        
                        if (!ok_or_empty_162188) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162175, ":", (long long) merge_sequential_arg2_162176, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162190 = sub64(defunc_0_f_res_162173, defunc_0_f_res_162166);
                        bool empty_slice_162191 = j_m_i_162190 == (int64_t) 0;
                        int64_t m_162192 = sub64(j_m_i_162190, (int64_t) 1);
                        int64_t i_p_m_t_s_162193 = add64(defunc_0_f_res_162166, m_162192);
                        bool zzero_leq_i_p_m_t_s_162194 = sle64((int64_t) 0, i_p_m_t_s_162193);
                        bool i_p_m_t_s_leq_w_162195 = slt64(i_p_m_t_s_162193, next_stride_161913);
                        bool zzero_lte_i_162196 = sle64((int64_t) 0, defunc_0_f_res_162166);
                        bool i_lte_j_162197 = sle64(defunc_0_f_res_162166, defunc_0_f_res_162173);
                        bool y_162198 = i_p_m_t_s_leq_w_162195 && zzero_lte_i_162196;
                        bool y_162199 = zzero_leq_i_p_m_t_s_162194 && y_162198;
                        bool forwards_ok_162200 = i_lte_j_162197 && y_162199;
                        bool ok_or_empty_162201 = empty_slice_162191 || forwards_ok_162200;
                        bool index_certs_162202;
                        
                        if (!ok_or_empty_162201) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162166, ":", (long long) defunc_0_f_res_162173, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:121:32-36\n   #10 ftRelational.fut:118:5-121:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162203 = slt64((int64_t) 0, j_m_i_162190);
                        int32_t dummy_162204;
                        int64_t dummy_162205;
                        
                        if (cond_162203) {
                            bool index_certs_162628;
                            
                            if (!cond_162203) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:121:32-36\n   #12 ftRelational.fut:118:5-121:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161985 + defunc_0_f_res_162166;
                            int32_t head_res_162630 = ((int32_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162204 = head_res_162630;
                            dummy_162205 = head_res_162631;
                        } else {
                            bool y_162210 = slt64((int64_t) 0, j_m_i_162177);
                            bool index_certs_162211;
                            
                            if (!y_162210) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:121:32-36\n   #12 ftRelational.fut:118:5-121:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162212 = start_161985 + merge_sequential_arg2_162175;
                            int32_t head_res_162213 = ((int32_t *) mem_param_171900.mem)[slice_162212];
                            int64_t head_res_162214 = ((int64_t *) mem_param_171903.mem)[slice_162212];
                            
                            dummy_162204 = head_res_162213;
                            dummy_162205 = head_res_162214;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161798; nest_i_172542++) {
                            ((int32_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + nest_i_172542] = dummy_162204;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161798; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + nest_i_172543] = dummy_162205;
                        }
                        
                        int64_t data_162217;
                        int64_t i_162221 = (int64_t) 0;
                        
                        for (int64_t k_162220 = 0; k_162220 < merge_block_sizze_161798; k_162220++) {
                            int64_t j_162224 = sub64(k_162220, i_162221);
                            bool cond_162225 = j_162224 == j_m_i_162177;
                            bool cond_162226;
                            
                            if (cond_162225) {
                                cond_162226 = 1;
                            } else {
                                bool cond_162227 = slt64(i_162221, j_m_i_162190);
                                bool cond_f_res_162228;
                                
                                if (cond_162227) {
                                    bool x_162632 = sle64((int64_t) 0, j_162224);
                                    bool y_162633 = slt64(j_162224, j_m_i_162177);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162221);
                                    bool bounds_check_162640 = cond_162227 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162175 + j_162224;
                                    int64_t slice_162637 = start_161985 + slice_162636;
                                    int32_t leq_arg1_162638 = ((int32_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162166 + i_162221;
                                    int64_t slice_162643 = start_161985 + slice_162642;
                                    int32_t leq_arg0_162644 = ((int32_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle32(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162228 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162228 = 0;
                                }
                                cond_162226 = cond_f_res_162228;
                            }
                            
                            int64_t loopres_162243;
                            int32_t loopres_162244;
                            int64_t loopres_162245;
                            
                            if (cond_162226) {
                                bool x_162647 = sle64((int64_t) 0, i_162221);
                                bool y_162648 = slt64(i_162221, j_m_i_162190);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162221);
                                int64_t slice_162651 = defunc_0_f_res_162166 + i_162221;
                                int64_t slice_162652 = start_161985 + slice_162651;
                                int32_t tmp_162653 = ((int32_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162243 = tmp_162646;
                                loopres_162244 = tmp_162653;
                                loopres_162245 = tmp_162654;
                            } else {
                                bool x_162255 = sle64((int64_t) 0, j_162224);
                                bool y_162256 = slt64(j_162224, j_m_i_162177);
                                bool bounds_check_162257 = x_162255 && y_162256;
                                bool index_certs_162258;
                                
                                if (!bounds_check_162257) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:121:32-36\n   #11 ftRelational.fut:118:5-121:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162259 = merge_sequential_arg2_162175 + j_162224;
                                int64_t slice_162260 = start_161985 + slice_162259;
                                int32_t tmp_162261 = ((int32_t *) mem_param_171900.mem)[slice_162260];
                                int64_t tmp_162262 = ((int64_t *) mem_param_171903.mem)[slice_162260];
                                
                                loopres_162243 = i_162221;
                                loopres_162244 = tmp_162261;
                                loopres_162245 = tmp_162262;
                            }
                            ((int32_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162244;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162245;
                            
                            int64_t i_tmp_172544 = loopres_162243;
                            
                            i_162221 = i_tmp_172544;
                        }
                        data_162217 = i_162221;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_4b(ctx, 2, (uint32_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint32_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_4b(ctx, 1, (uint32_t *) mem_171906, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162269 = next_stride_161913 * num_merges_161917;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_4b(ctx, 2, (uint32_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint32_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            
            bool loop_cond_162272 = slt64(next_stride_161913, flat_dim_161794);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162269;
            bool loop_while_tmp_172521 = loop_cond_162272;
            int64_t stride_tmp_172524 = next_stride_161913;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161908 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161909 = loop_while_tmp_172521;
            stride_161912 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161903 = loop_dz2084Uz2082U_161908;
        data_161904 = loop_while_161909;
        data_161907 = stride_161912;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162273 = n_91754 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162274 = sle64((int64_t) 0, zs_lhs_161778);
        bool i_p_m_t_s_leq_w_162275 = slt64(zs_lhs_161778, data_161903);
        bool y_162276 = zzero_leq_i_p_m_t_s_162274 && i_p_m_t_s_leq_w_162275;
        bool ok_or_empty_162277 = empty_slice_162273 || y_162276;
        bool index_certs_162278;
        
        if (!ok_or_empty_162277) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_91754, "] out of bounds for array of shape [", (long long) data_161903, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:121:32-36\n   #6  ftRelational.fut:118:5-121:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_172027, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_91754; i_171587++) {
        int64_t eta_p_162286 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162287 = sle64((int64_t) 0, eta_p_162286);
        bool y_162288 = slt64(eta_p_162286, n_91754);
        bool bounds_check_162289 = x_162287 && y_162288;
        bool index_certs_162290;
        
        if (!bounds_check_162289) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162286, "] out of bounds for array of shape [", (long long) n_91754, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:121:32-36\n   #5  ftRelational.fut:118:5-121:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t lifted_lambda_res_162291 = ((int32_t *) k_mem_171818.mem)[eta_p_162286];
        
        ((int32_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162291;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_172030.mem, i_171587 * b_91755, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171819.mem, eta_p_162286 * b_91755, (int64_t []) {(int64_t) 1}, (int64_t []) {b_91755});
    }
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172975, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172976, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_172987, struct memblock *mem_out_p_172988, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_94113, int64_t b_94114)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_172989 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_172990 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_172991 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_172992 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_172993 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_172994 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_172995 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_172996 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_172997 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_172998 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_94113;
    bool cond_161777 = sle64(n_94113, (int64_t) 1);
    int64_t zs_lhs_161778 = sub64(n_94113, (int64_t) 1);
    int64_t zp_rhs_161779 = sdiv_safe64(zs_lhs_161778, (int64_t) 20);
    int64_t min_num_blocks_161780 = add64((int64_t) 1, zp_rhs_161779);
    bool loop_cond_161781 = slt64((int64_t) 1, min_num_blocks_161780);
    bool smallest_pow_2_geq_than_res_161782;
    int64_t smallest_pow_2_geq_than_res_161783;
    bool loop_while_161784;
    int64_t x_161785;
    
    loop_while_161784 = loop_cond_161781;
    x_161785 = (int64_t) 1;
    while (loop_while_161784) {
        int64_t loopres_161786 = mul64((int64_t) 2, x_161785);
        bool loop_cond_161787 = slt64(loopres_161786, min_num_blocks_161780);
        bool loop_while_tmp_172502 = loop_cond_161787;
        int64_t x_tmp_172503 = loopres_161786;
        
        loop_while_161784 = loop_while_tmp_172502;
        x_161785 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161782 = loop_while_161784;
    smallest_pow_2_geq_than_res_161783 = x_161785;
    
    bool zzero_161788 = smallest_pow_2_geq_than_res_161783 == (int64_t) 0;
    bool nonzzero_161789 = !zzero_161788;
    bool protect_assert_disj_161790 = cond_161777 || nonzzero_161789;
    bool nonzzero_cert_161791;
    
    if (!protect_assert_disj_161790) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:125:32-36\n   #5  ftRelational.fut:122:5-125:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161792 = sdiv_safe64(zs_lhs_161778, smallest_pow_2_geq_than_res_161783);
    int64_t block_sizze_161793 = add64((int64_t) 1, zp_rhs_161792);
    bool y_161799 = slt64((int64_t) 0, n_94113);
    bool protect_assert_disj_172415 = cond_161777 || y_161799;
    bool index_certs_161800;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_94113, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:125:32-36\n   #5  ftRelational.fut:122:5-125:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161814 = slt64(smallest_pow_2_geq_than_res_161783, (int64_t) 0);
    bool valid_161815 = !bounds_invalid_upwards_161814;
    bool protect_assert_disj_172423 = cond_161777 || valid_161815;
    bool range_valid_c_161816;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161783, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:125:32-36\n   #6  ftRelational.fut:122:5-125:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161818 = slt64(block_sizze_161793, (int64_t) 0);
    bool valid_161819 = !bounds_invalid_upwards_161818;
    bool protect_assert_disj_172425 = cond_161777 || valid_161819;
    bool range_valid_c_161820;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161793, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161822 = sle64(block_sizze_161793, (int64_t) 1);
    int64_t tmp_161823 = sub64(block_sizze_161793, (int64_t) 2);
    bool bounds_invalid_upwards_161824 = slt64(tmp_161823, (int64_t) 0);
    bool valid_161826 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_161827 = cond_161822 || valid_161826;
    bool protect_assert_disj_172427 = cond_161777 || protect_assert_disj_161827;
    bool range_valid_c_161828;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161823, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172029 = n_94113 * b_94114;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_94113; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161794 = smallest_pow_2_geq_than_res_161783 * block_sizze_161793;
    bool x_172410 = !cond_161777;
    int64_t greatest_divisor_leq_than_arg1_161797 = mul64((int64_t) 2, block_sizze_161793);
    int64_t merge_block_sizze_161798;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161797) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161798 = x_172412;
    } else {
        merge_block_sizze_161798 = (int64_t) 0;
    }
    
    int64_t reduce_arg1_161801;
    
    if (x_172410) {
        int64_t x_172416 = ((int64_t *) k_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161801 = x_172416;
    } else {
        reduce_arg1_161801 = (int64_t) 0;
    }
    
    int64_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int64_t x_172418;
        int64_t x_172419;
        int64_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161801;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_94113; i_171547++) {
            int64_t x_161805 = ((int64_t *) k_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161811 = sle64(redout_171545, x_161805);
            int64_t defunc_0_op_res_161812;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161812 = x_161805;
            } else {
                defunc_0_op_res_161812 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161813;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161813 = i_171547;
            } else {
                defunc_0_op_res_161813 = redout_171546;
            }
            
            int64_t redout_tmp_172506 = defunc_0_op_res_161812;
            int64_t redout_tmp_172507 = defunc_0_op_res_161813;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = (int64_t) 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161825 = add64((int64_t) 1, tmp_161823);
    int64_t binop_x_171822 = (int64_t) 8 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171823 = block_sizze_161793 * binop_x_171822;
    int64_t bytes_171836 = (int64_t) 8 * block_sizze_161793;
    bool loop_cond_161900 = slt64(block_sizze_161793, flat_dim_161794);
    bool zzero_161901 = merge_block_sizze_161798 == (int64_t) 0;
    bool nonzzero_161902 = !zzero_161901;
    
    if (cond_161777) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_172989 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_172989, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_172990 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_172990, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_172991 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_172991, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_172992 < bytes_171836) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_172992, bytes_171836);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161783; i_171559++) {
            int64_t zp_lhs_161832 = mul64(block_sizze_161793, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161793; i_171552++) {
                int64_t k_161836 = add64(zp_lhs_161832, i_171552);
                bool cond_161837 = slt64(k_161836, n_94113);
                int64_t lifted_lambda_res_161838;
                int64_t lifted_lambda_res_161839;
                
                if (cond_161837) {
                    bool x_162514 = sle64((int64_t) 0, k_161836);
                    bool bounds_check_162515 = cond_161837 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161836, "] out of bounds for array of shape [", (long long) n_94113, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t lifted_lambda_res_t_res_162517 = ((int64_t *) k_mem_171818.mem)[k_161836];
                    
                    lifted_lambda_res_161838 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161839 = k_161836;
                } else {
                    lifted_lambda_res_161838 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161839 = defunc_0_reduce_res_162662;
                }
                ((int64_t *) mem_171837)[i_171552] = lifted_lambda_res_161838;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161839;
            }
            if (!cond_161822) {
                for (int64_t i_161849 = 0; i_161849 < distance_161825; i_161849++) {
                    int64_t gt_arg1_161852 = add64((int64_t) 1, i_161849);
                    bool x_161853 = sle64((int64_t) 0, gt_arg1_161852);
                    bool y_161854 = slt64(gt_arg1_161852, block_sizze_161793);
                    bool bounds_check_161855 = x_161853 && y_161854;
                    bool index_certs_161856;
                    
                    if (!bounds_check_161855) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161852, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161858 = slt64(i_161849, block_sizze_161793);
                    bool index_certs_161859;
                    
                    if (!y_161858) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161849, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t gt_arg1_161857 = ((int64_t *) mem_171837)[gt_arg1_161852];
                    int64_t gt_arg0_161860 = ((int64_t *) mem_171837)[i_161849];
                    bool defunc_0_leq_res_161861 = sle64(gt_arg0_161860, gt_arg1_161857);
                    bool defunc_0_lifted_gt_res_161862 = !defunc_0_leq_res_161861;
                    bool s_161863;
                    int64_t s_161866;
                    bool loop_while_161867;
                    int64_t j_161870;
                    
                    loop_while_161867 = defunc_0_lifted_gt_res_161862;
                    j_161870 = i_161849;
                    while (loop_while_161867) {
                        bool x_161871 = sle64((int64_t) 0, j_161870);
                        bool y_161872 = slt64(j_161870, block_sizze_161793);
                        bool bounds_check_161873 = x_161871 && y_161872;
                        bool index_certs_161874;
                        
                        if (!bounds_check_161873) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161870, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161877 = add64((int64_t) 1, j_161870);
                        bool x_161878 = sle64((int64_t) 0, copy_arg0_161877);
                        bool y_161879 = slt64(copy_arg0_161877, block_sizze_161793);
                        bool bounds_check_161880 = x_161878 && y_161879;
                        bool index_certs_161881;
                        
                        if (!bounds_check_161880) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161877, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161875 = ((int64_t *) mem_171837)[j_161870];
                        int64_t copy_arg0_161876 = ((int64_t *) mem_171839)[j_161870];
                        int64_t copy_arg0_161882 = ((int64_t *) mem_171837)[copy_arg0_161877];
                        int64_t copy_arg0_161883 = ((int64_t *) mem_171839)[copy_arg0_161877];
                        
                        ((int64_t *) mem_171837)[j_161870] = copy_arg0_161882;
                        ((int64_t *) mem_171839)[j_161870] = copy_arg0_161883;
                        ((int64_t *) mem_171837)[copy_arg0_161877] = copy_arg0_161875;
                        ((int64_t *) mem_171839)[copy_arg0_161877] = copy_arg0_161876;
                        
                        int64_t tmp_161888 = sub64(j_161870, (int64_t) 1);
                        bool cond_161889 = sle64((int64_t) 0, tmp_161888);
                        bool loop_cond_161890;
                        
                        if (cond_161889) {
                            bool y_162519 = slt64(tmp_161888, block_sizze_161793);
                            bool bounds_check_162520 = cond_161889 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161888, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t gt_arg1_162518 = ((int64_t *) mem_171837)[j_161870];
                            int64_t gt_arg0_162522 = ((int64_t *) mem_171837)[tmp_161888];
                            bool defunc_0_leq_res_162523 = sle64(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161890 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161890 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161890;
                        int64_t j_tmp_172517 = tmp_161888;
                        
                        loop_while_161867 = loop_while_tmp_172514;
                        j_161870 = j_tmp_172517;
                    }
                    s_161863 = loop_while_161867;
                    s_161866 = j_161870;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171824, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        if (memblock_alloc(ctx, &mem_171896, bytes_171823, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        
        int64_t data_161903;
        bool data_161904;
        int64_t data_161907;
        int64_t loop_dz2084Uz2082U_161908;
        bool loop_while_161909;
        int64_t stride_161912;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161908 = flat_dim_161794;
        loop_while_161909 = loop_cond_161900;
        stride_161912 = block_sizze_161793;
        while (loop_while_161909) {
            int64_t next_stride_161913 = mul64((int64_t) 2, stride_161912);
            bool zzero_161914 = next_stride_161913 == (int64_t) 0;
            bool nonzzero_161915 = !zzero_161914;
            bool nonzzero_cert_161916;
            
            if (!nonzzero_161915) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:125:32-36\n   #5  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161917 = sdiv64(flat_dim_161794, next_stride_161913);
            bool bounds_invalid_upwards_161918 = slt64(num_merges_161917, (int64_t) 0);
            bool valid_161919 = !bounds_invalid_upwards_161918;
            bool range_valid_c_161920;
            
            if (!valid_161919) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161917, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:125:32-36\n   #6  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161922 = sub64(next_stride_161913, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161923 = sle64((int64_t) 0, m_161922);
            bool cond_161925 = slt64(next_stride_161913, (int64_t) 10);
            bool protect_assert_disj_161926 = nonzzero_161902 || cond_161925;
            bool nonzzero_cert_161927;
            
            if (!protect_assert_disj_161926) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161928 = smod_safe64(next_stride_161913, merge_block_sizze_161798);
            bool num_blocks_161929 = zeze_lhs_161928 == (int64_t) 0;
            bool protect_assert_disj_161930 = cond_161925 || num_blocks_161929;
            bool assert_c_161931;
            
            if (!protect_assert_disj_161930) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161933 = sdiv_safe64(next_stride_161913, merge_block_sizze_161798);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934 = add64((int64_t) 1, num_blocks_161933);
            int64_t j_m_i_161935 = sub64(next_stride_161913, stride_161912);
            int64_t flat_dim_161936 = merge_block_sizze_161798 * num_blocks_161933;
            bool bounds_invalid_upwards_161937 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, (int64_t) 0);
            bool empty_slice_161938 = j_m_i_161935 == (int64_t) 0;
            int64_t m_161939 = sub64(j_m_i_161935, (int64_t) 1);
            bool zzero_lte_i_161940 = sle64((int64_t) 0, stride_161912);
            bool i_lte_j_161941 = sle64(stride_161912, next_stride_161913);
            bool empty_slice_161942 = stride_161912 == (int64_t) 0;
            int64_t m_161943 = sub64(stride_161912, (int64_t) 1);
            bool bounds_invalid_upwards_161944 = slt64(num_blocks_161933, (int64_t) 0);
            bool cond_161945 = slt64((int64_t) 0, stride_161912);
            bool valid_161946 = !bounds_invalid_upwards_161937;
            int64_t i_p_m_t_s_161947 = add64(stride_161912, m_161939);
            bool zzero_leq_i_p_m_t_s_161948 = sle64((int64_t) 0, m_161943);
            bool i_p_m_t_s_leq_w_161949 = slt64(m_161943, next_stride_161913);
            bool valid_161950 = !bounds_invalid_upwards_161944;
            bool i_p_m_t_s_leq_w_161951 = slt64(m_161922, flat_dim_161936);
            bool y_161952 = slt64((int64_t) 0, j_m_i_161935);
            bool protect_assert_disj_161953 = cond_161925 || valid_161946;
            bool range_valid_c_161954;
            
            if (!protect_assert_disj_161953) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161955 = sle64((int64_t) 0, i_p_m_t_s_161947);
            bool i_p_m_t_s_leq_w_161956 = slt64(i_p_m_t_s_161947, next_stride_161913);
            bool y_161957 = zzero_leq_i_p_m_t_s_161948 && i_p_m_t_s_leq_w_161949;
            bool protect_assert_disj_161958 = cond_161925 || valid_161950;
            bool range_valid_c_161959;
            
            if (!protect_assert_disj_161958) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161960 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161951;
            bool y_161961 = zzero_lte_i_161940 && i_p_m_t_s_leq_w_161956;
            bool forwards_ok_161962 = zzero_lte_i_161940 && y_161957;
            bool ok_or_empty_161963 = zzero_161914 || y_161960;
            bool protect_assert_disj_161964 = cond_161945 || y_161952;
            bool y_161965 = zzero_leq_i_p_m_t_s_161955 && y_161961;
            bool ok_or_empty_161966 = empty_slice_161942 || forwards_ok_161962;
            bool protect_assert_disj_161967 = cond_161925 || ok_or_empty_161963;
            bool index_certs_161968;
            
            if (!protect_assert_disj_161967) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) flat_dim_161936, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161969 = !cond_161925;
            bool protect_assert_disj_161970 = protect_assert_disj_161964 || loop_not_taken_161969;
            bool index_certs_161971;
            
            if (!protect_assert_disj_161970) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161972 = i_lte_j_161941 && y_161965;
            bool protect_assert_disj_161973 = cond_161925 || ok_or_empty_161966;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161975 = ok_or_empty_161966 || loop_not_taken_161969;
            bool index_certs_161976;
            
            if (!protect_assert_disj_161975) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161977 = empty_slice_161938 || forwards_ok_161972;
            bool protect_assert_disj_161978 = cond_161925 || ok_or_empty_161977;
            bool index_certs_161979;
            
            if (!protect_assert_disj_161978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161980 = loop_not_taken_161969 || ok_or_empty_161977;
            bool index_certs_161981;
            
            if (!protect_assert_disj_161980) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 8 * num_merges_161917;
            int64_t bytes_171905 = next_stride_161913 * binop_x_171904;
            bool i_lte_j_161924 = sle64((int64_t) 0, next_stride_161913);
            
            if (mem_171906_cached_sizze_172993 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_172993, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_172994 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_172994, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934;
            int64_t binop_x_171934 = (int64_t) 8 * num_blocks_161933;
            int64_t bytes_171935 = merge_block_sizze_161798 * binop_x_171934;
            int64_t bytes_171980 = (int64_t) 16 * stride_161912;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161917; i_171580++) {
                int64_t start_161985 = mul64(next_stride_161913, i_171580);
                int64_t j_m_i_161986 = sub64(loop_dz2084Uz2082U_161908, start_161985);
                bool empty_slice_161987 = j_m_i_161986 == (int64_t) 0;
                int64_t m_161988 = sub64(j_m_i_161986, (int64_t) 1);
                int64_t i_p_m_t_s_161989 = add64(start_161985, m_161988);
                bool zzero_leq_i_p_m_t_s_161990 = sle64((int64_t) 0, i_p_m_t_s_161989);
                bool i_p_m_t_s_leq_w_161991 = slt64(i_p_m_t_s_161989, loop_dz2084Uz2082U_161908);
                bool zzero_lte_i_161992 = sle64((int64_t) 0, start_161985);
                bool i_lte_j_161993 = sle64(start_161985, loop_dz2084Uz2082U_161908);
                bool y_161994 = i_p_m_t_s_leq_w_161991 && zzero_lte_i_161992;
                bool y_161995 = zzero_leq_i_p_m_t_s_161990 && y_161994;
                bool forwards_ok_161996 = i_lte_j_161993 && y_161995;
                bool ok_or_empty_161997 = empty_slice_161987 || forwards_ok_161996;
                bool index_certs_161998;
                
                if (!ok_or_empty_161997) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161985, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161908, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161999 = slt64(m_161922, j_m_i_161986);
                bool y_162000 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161999;
                bool forwards_ok_162001 = i_lte_j_161924 && y_162000;
                bool ok_or_empty_162002 = zzero_161914 || forwards_ok_162001;
                bool index_certs_162003;
                
                if (!ok_or_empty_162002) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) j_m_i_161986, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:125:32-36\n   #8  ftRelational.fut:122:5-125:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161925) {
                    int64_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161945) {
                        int64_t head_res_162552 = ((int64_t *) mem_param_171900.mem)[start_161985];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161985];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161912 + start_161985;
                        int64_t head_res_162555 = ((int64_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161913; nest_i_172527++) {
                        ((int64_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171980, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161913; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161913; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161935;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161912);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161935);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161912 + j_162566;
                                int64_t slice_162576 = start_161985 + slice_162575;
                                int64_t leq_arg1_162577 = ((int64_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161985 + i_162563;
                                int64_t leq_arg0_162582 = ((int64_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle64(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int64_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161912);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161985 + i_162563;
                            int64_t tmp_162593 = ((int64_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161935);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:125:32-36\n   #9  ftRelational.fut:122:5-125:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161912 + j_162566;
                            int64_t slice_162600 = start_161985 + slice_162599;
                            int64_t tmp_162601 = ((int64_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int64_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_172995 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_172995, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_172996 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_172996, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934; i_171566++) {
                        int64_t split_count_arg3_162065 = mul64(merge_block_sizze_161798, i_171566);
                        int64_t defunc_0_split_count_res_162066;
                        int64_t defunc_0_split_count_res_162067;
                        int64_t defunc_0_split_count_res_162068;
                        int64_t defunc_0_split_count_res_162069;
                        int64_t defunc_0_split_count_res_162070;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162066, &defunc_0_split_count_res_162067, &defunc_0_split_count_res_162068, &defunc_0_split_count_res_162069, &defunc_0_split_count_res_162070, (int64_t) 0, stride_161912, (int64_t) 0, j_m_i_161935, split_count_arg3_162065) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162071 = slt64((int64_t) 0, defunc_0_split_count_res_162070);
                        bool defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        int64_t defunc_0_split_count_res_162077;
                        bool loop_while_162078;
                        int64_t ss_162079;
                        int64_t ss_162080;
                        int64_t tt_162081;
                        int64_t tt_162082;
                        int64_t count_162083;
                        
                        loop_while_162078 = loop_cond_162071;
                        ss_162079 = defunc_0_split_count_res_162066;
                        ss_162080 = defunc_0_split_count_res_162067;
                        tt_162081 = defunc_0_split_count_res_162068;
                        tt_162082 = defunc_0_split_count_res_162069;
                        count_162083 = defunc_0_split_count_res_162070;
                        while (loop_while_162078) {
                            int64_t zlze_lhs_162084 = sub64(ss_162080, ss_162079);
                            bool cond_162085 = sle64(zlze_lhs_162084, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162086;
                            int64_t defunc_0_lifted_step_res_162087;
                            int64_t defunc_0_lifted_step_res_162088;
                            int64_t defunc_0_lifted_step_res_162089;
                            
                            if (cond_162085) {
                                int64_t tmp_162605 = add64(tt_162081, count_162083);
                                
                                defunc_0_lifted_step_res_162086 = ss_162079;
                                defunc_0_lifted_step_res_162087 = tmp_162605;
                                defunc_0_lifted_step_res_162088 = tt_162082;
                                defunc_0_lifted_step_res_162089 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162091 = sub64(tt_162082, tt_162081);
                                bool cond_162092 = sle64(zlze_lhs_162091, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162093;
                                int64_t defunc_0_lifted_step_res_f_res_162094;
                                int64_t defunc_0_lifted_step_res_f_res_162095;
                                int64_t defunc_0_lifted_step_res_f_res_162096;
                                
                                if (cond_162092) {
                                    int64_t tmp_162606 = add64(ss_162079, count_162083);
                                    
                                    defunc_0_lifted_step_res_f_res_162093 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162094 = tt_162081;
                                    defunc_0_lifted_step_res_f_res_162095 = tt_162082;
                                    defunc_0_lifted_step_res_f_res_162096 = (int64_t) 0;
                                } else {
                                    bool cond_162098 = count_162083 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162099;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162100;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162101;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162102;
                                    
                                    if (cond_162098) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162079);
                                        bool y_162609 = slt64(ss_162079, stride_161912);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162079, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:125:32-36\n   #13 ftRelational.fut:122:5-125:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162081);
                                        bool y_162615 = slt64(tt_162081, j_m_i_161935);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162081, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:125:32-36\n   #13 ftRelational.fut:122:5-125:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161985 + ss_162079;
                                        int64_t leq_arg1_162613 = ((int64_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161912 + tt_162081;
                                        int64_t slice_162619 = start_161985 + slice_162618;
                                        int64_t leq_arg0_162620 = ((int64_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle64(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162081);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162079;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162079);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162081;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = tt_162082;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = (int64_t) 0;
                                    } else {
                                        int64_t m_162121 = sdiv64(count_162083, (int64_t) 2);
                                        int64_t n_162122 = sub64(count_162083, m_162121);
                                        bool cond_162123 = n_162122 == (int64_t) 0;
                                        int64_t zgze_lhs_162124 = add64(ss_162079, m_162121);
                                        bool cond_f_res_162125 = sle64(ss_162080, zgze_lhs_162124);
                                        bool x_162126 = !cond_162123;
                                        bool y_162127 = cond_f_res_162125 && x_162126;
                                        bool cond_162128 = cond_162123 || y_162127;
                                        bool leq_y_x_162129;
                                        
                                        if (cond_162128) {
                                            leq_y_x_162129 = 1;
                                        } else {
                                            bool x_162130 = sle64((int64_t) 0, zgze_lhs_162124);
                                            bool y_162131 = slt64(zgze_lhs_162124, stride_161912);
                                            bool bounds_check_162132 = x_162130 && y_162131;
                                            bool index_certs_162133;
                                            
                                            if (!bounds_check_162132) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162124, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:125:32-36\n   #13 ftRelational.fut:122:5-125:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162136 = add64(tt_162081, n_162122);
                                            int64_t leq_arg0_162137 = sub64(zm_lhs_162136, (int64_t) 1);
                                            bool x_162138 = sle64((int64_t) 0, leq_arg0_162137);
                                            bool y_162139 = slt64(leq_arg0_162137, j_m_i_161935);
                                            bool bounds_check_162140 = x_162138 && y_162139;
                                            bool index_certs_162141;
                                            
                                            if (!bounds_check_162140) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162137, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:125:32-36\n   #13 ftRelational.fut:122:5-125:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162134 = start_161985 + zgze_lhs_162124;
                                            int64_t leq_arg1_162135 = ((int64_t *) mem_param_171900.mem)[slice_162134];
                                            int64_t slice_162142 = stride_161912 + leq_arg0_162137;
                                            int64_t slice_162143 = start_161985 + slice_162142;
                                            int64_t leq_arg0_162144 = ((int64_t *) mem_param_171900.mem)[slice_162143];
                                            bool defunc_0_leq_res_162145 = sle64(leq_arg0_162144, leq_arg1_162135);
                                            
                                            leq_y_x_162129 = defunc_0_leq_res_162145;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                        
                                        if (leq_y_x_162129) {
                                            int64_t tmp_162626 = add64(tt_162081, n_162122);
                                            int64_t tmp_162627 = sub64(count_162083, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tt_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = tmp_162627;
                                        } else {
                                            int64_t tmp_162151 = add64(tt_162081, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tt_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tmp_162151;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = count_162083;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = ss_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                    }
                                    defunc_0_lifted_step_res_f_res_162093 = defunc_0_lifted_step_res_f_res_f_res_162099;
                                    defunc_0_lifted_step_res_f_res_162094 = defunc_0_lifted_step_res_f_res_f_res_162100;
                                    defunc_0_lifted_step_res_f_res_162095 = defunc_0_lifted_step_res_f_res_f_res_162101;
                                    defunc_0_lifted_step_res_f_res_162096 = defunc_0_lifted_step_res_f_res_f_res_162102;
                                }
                                defunc_0_lifted_step_res_162086 = defunc_0_lifted_step_res_f_res_162093;
                                defunc_0_lifted_step_res_162087 = defunc_0_lifted_step_res_f_res_162094;
                                defunc_0_lifted_step_res_162088 = defunc_0_lifted_step_res_f_res_162095;
                                defunc_0_lifted_step_res_162089 = defunc_0_lifted_step_res_f_res_162096;
                            }
                            
                            int64_t loopres_162152;
                            int64_t loopres_162153;
                            int64_t loopres_162154;
                            int64_t loopres_162155;
                            int64_t loopres_162156;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162152, &loopres_162153, &loopres_162154, &loopres_162155, &loopres_162156, defunc_0_lifted_step_res_162086, ss_162080, defunc_0_lifted_step_res_162087, defunc_0_lifted_step_res_162088, defunc_0_lifted_step_res_162089) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162157 = slt64((int64_t) 0, loopres_162156);
                            bool loop_while_tmp_172534 = loop_cond_162157;
                            int64_t ss_tmp_172535 = loopres_162152;
                            int64_t ss_tmp_172536 = loopres_162153;
                            int64_t tt_tmp_172537 = loopres_162154;
                            int64_t tt_tmp_172538 = loopres_162155;
                            int64_t count_tmp_172539 = loopres_162156;
                            
                            loop_while_162078 = loop_while_tmp_172534;
                            ss_162079 = ss_tmp_172535;
                            ss_162080 = ss_tmp_172536;
                            tt_162081 = tt_tmp_172537;
                            tt_162082 = tt_tmp_172538;
                            count_162083 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162072 = loop_while_162078;
                        defunc_0_split_count_res_162073 = ss_162079;
                        defunc_0_split_count_res_162074 = ss_162080;
                        defunc_0_split_count_res_162075 = tt_162081;
                        defunc_0_split_count_res_162076 = tt_162082;
                        defunc_0_split_count_res_162077 = count_162083;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162073;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162075;
                    }
                    if (mem_171936_cached_sizze_172997 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_172997, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_172998 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_172998, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161933; i_171573++) {
                        bool y_162163 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool index_certs_162165;
                        
                        if (!y_162163) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162166 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162167 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162168 = add64((int64_t) 1, i_171573);
                        bool x_162169 = sle64((int64_t) 0, tmp_162168);
                        bool y_162170 = slt64(tmp_162168, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool bounds_check_162171 = x_162169 && y_162170;
                        bool index_certs_162172;
                        
                        if (!bounds_check_162171) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162168, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171919)[tmp_162168];
                        int64_t defunc_0_f_res_162174 = ((int64_t *) mem_171921)[tmp_162168];
                        int64_t merge_sequential_arg2_162175 = add64(stride_161912, defunc_0_f_res_162167);
                        int64_t merge_sequential_arg2_162176 = add64(stride_161912, defunc_0_f_res_162174);
                        int64_t j_m_i_162177 = sub64(merge_sequential_arg2_162176, merge_sequential_arg2_162175);
                        bool empty_slice_162178 = j_m_i_162177 == (int64_t) 0;
                        int64_t m_162179 = sub64(j_m_i_162177, (int64_t) 1);
                        int64_t i_p_m_t_s_162180 = add64(merge_sequential_arg2_162175, m_162179);
                        bool zzero_leq_i_p_m_t_s_162181 = sle64((int64_t) 0, i_p_m_t_s_162180);
                        bool i_p_m_t_s_leq_w_162182 = slt64(i_p_m_t_s_162180, next_stride_161913);
                        bool zzero_lte_i_162183 = sle64((int64_t) 0, merge_sequential_arg2_162175);
                        bool i_lte_j_162184 = sle64(merge_sequential_arg2_162175, merge_sequential_arg2_162176);
                        bool y_162185 = i_p_m_t_s_leq_w_162182 && zzero_lte_i_162183;
                        bool y_162186 = zzero_leq_i_p_m_t_s_162181 && y_162185;
                        bool forwards_ok_162187 = i_lte_j_162184 && y_162186;
                        bool ok_or_empty_162188 = empty_slice_162178 || forwards_ok_162187;
                        bool index_certs_162189;
                        
                        if (!ok_or_empty_162188) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162175, ":", (long long) merge_sequential_arg2_162176, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162190 = sub64(defunc_0_f_res_162173, defunc_0_f_res_162166);
                        bool empty_slice_162191 = j_m_i_162190 == (int64_t) 0;
                        int64_t m_162192 = sub64(j_m_i_162190, (int64_t) 1);
                        int64_t i_p_m_t_s_162193 = add64(defunc_0_f_res_162166, m_162192);
                        bool zzero_leq_i_p_m_t_s_162194 = sle64((int64_t) 0, i_p_m_t_s_162193);
                        bool i_p_m_t_s_leq_w_162195 = slt64(i_p_m_t_s_162193, next_stride_161913);
                        bool zzero_lte_i_162196 = sle64((int64_t) 0, defunc_0_f_res_162166);
                        bool i_lte_j_162197 = sle64(defunc_0_f_res_162166, defunc_0_f_res_162173);
                        bool y_162198 = i_p_m_t_s_leq_w_162195 && zzero_lte_i_162196;
                        bool y_162199 = zzero_leq_i_p_m_t_s_162194 && y_162198;
                        bool forwards_ok_162200 = i_lte_j_162197 && y_162199;
                        bool ok_or_empty_162201 = empty_slice_162191 || forwards_ok_162200;
                        bool index_certs_162202;
                        
                        if (!ok_or_empty_162201) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162166, ":", (long long) defunc_0_f_res_162173, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:125:32-36\n   #10 ftRelational.fut:122:5-125:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162203 = slt64((int64_t) 0, j_m_i_162190);
                        int64_t dummy_162204;
                        int64_t dummy_162205;
                        
                        if (cond_162203) {
                            bool index_certs_162628;
                            
                            if (!cond_162203) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:125:32-36\n   #12 ftRelational.fut:122:5-125:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161985 + defunc_0_f_res_162166;
                            int64_t head_res_162630 = ((int64_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162204 = head_res_162630;
                            dummy_162205 = head_res_162631;
                        } else {
                            bool y_162210 = slt64((int64_t) 0, j_m_i_162177);
                            bool index_certs_162211;
                            
                            if (!y_162210) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:125:32-36\n   #12 ftRelational.fut:122:5-125:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162212 = start_161985 + merge_sequential_arg2_162175;
                            int64_t head_res_162213 = ((int64_t *) mem_param_171900.mem)[slice_162212];
                            int64_t head_res_162214 = ((int64_t *) mem_param_171903.mem)[slice_162212];
                            
                            dummy_162204 = head_res_162213;
                            dummy_162205 = head_res_162214;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161798; nest_i_172542++) {
                            ((int64_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + nest_i_172542] = dummy_162204;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161798; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + nest_i_172543] = dummy_162205;
                        }
                        
                        int64_t data_162217;
                        int64_t i_162221 = (int64_t) 0;
                        
                        for (int64_t k_162220 = 0; k_162220 < merge_block_sizze_161798; k_162220++) {
                            int64_t j_162224 = sub64(k_162220, i_162221);
                            bool cond_162225 = j_162224 == j_m_i_162177;
                            bool cond_162226;
                            
                            if (cond_162225) {
                                cond_162226 = 1;
                            } else {
                                bool cond_162227 = slt64(i_162221, j_m_i_162190);
                                bool cond_f_res_162228;
                                
                                if (cond_162227) {
                                    bool x_162632 = sle64((int64_t) 0, j_162224);
                                    bool y_162633 = slt64(j_162224, j_m_i_162177);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162221);
                                    bool bounds_check_162640 = cond_162227 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162175 + j_162224;
                                    int64_t slice_162637 = start_161985 + slice_162636;
                                    int64_t leq_arg1_162638 = ((int64_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162166 + i_162221;
                                    int64_t slice_162643 = start_161985 + slice_162642;
                                    int64_t leq_arg0_162644 = ((int64_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle64(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162228 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162228 = 0;
                                }
                                cond_162226 = cond_f_res_162228;
                            }
                            
                            int64_t loopres_162243;
                            int64_t loopres_162244;
                            int64_t loopres_162245;
                            
                            if (cond_162226) {
                                bool x_162647 = sle64((int64_t) 0, i_162221);
                                bool y_162648 = slt64(i_162221, j_m_i_162190);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162221);
                                int64_t slice_162651 = defunc_0_f_res_162166 + i_162221;
                                int64_t slice_162652 = start_161985 + slice_162651;
                                int64_t tmp_162653 = ((int64_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162243 = tmp_162646;
                                loopres_162244 = tmp_162653;
                                loopres_162245 = tmp_162654;
                            } else {
                                bool x_162255 = sle64((int64_t) 0, j_162224);
                                bool y_162256 = slt64(j_162224, j_m_i_162177);
                                bool bounds_check_162257 = x_162255 && y_162256;
                                bool index_certs_162258;
                                
                                if (!bounds_check_162257) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:125:32-36\n   #11 ftRelational.fut:122:5-125:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162259 = merge_sequential_arg2_162175 + j_162224;
                                int64_t slice_162260 = start_161985 + slice_162259;
                                int64_t tmp_162261 = ((int64_t *) mem_param_171900.mem)[slice_162260];
                                int64_t tmp_162262 = ((int64_t *) mem_param_171903.mem)[slice_162260];
                                
                                loopres_162243 = i_162221;
                                loopres_162244 = tmp_162261;
                                loopres_162245 = tmp_162262;
                            }
                            ((int64_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162244;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162245;
                            
                            int64_t i_tmp_172544 = loopres_162243;
                            
                            i_162221 = i_tmp_172544;
                        }
                        data_162217 = i_162221;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171935, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171906, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162269 = next_stride_161913 * num_merges_161917;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            if (memblock_alloc(ctx, &mem_172016, bytes_171905, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            
            bool loop_cond_162272 = slt64(next_stride_161913, flat_dim_161794);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162269;
            bool loop_while_tmp_172521 = loop_cond_162272;
            int64_t stride_tmp_172524 = next_stride_161913;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161908 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161909 = loop_while_tmp_172521;
            stride_161912 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161903 = loop_dz2084Uz2082U_161908;
        data_161904 = loop_while_161909;
        data_161907 = stride_161912;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162273 = n_94113 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162274 = sle64((int64_t) 0, zs_lhs_161778);
        bool i_p_m_t_s_leq_w_162275 = slt64(zs_lhs_161778, data_161903);
        bool y_162276 = zzero_leq_i_p_m_t_s_162274 && i_p_m_t_s_leq_w_162275;
        bool ok_or_empty_162277 = empty_slice_162273 || y_162276;
        bool index_certs_162278;
        
        if (!ok_or_empty_162277) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_94113, "] out of bounds for array of shape [", (long long) data_161903, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:125:32-36\n   #6  ftRelational.fut:122:5-125:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_171820, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_94113; i_171587++) {
        int64_t eta_p_162286 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162287 = sle64((int64_t) 0, eta_p_162286);
        bool y_162288 = slt64(eta_p_162286, n_94113);
        bool bounds_check_162289 = x_162287 && y_162288;
        bool index_certs_162290;
        
        if (!bounds_check_162289) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162286, "] out of bounds for array of shape [", (long long) n_94113, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:125:32-36\n   #5  ftRelational.fut:122:5-125:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t lifted_lambda_res_162291 = ((int64_t *) k_mem_171818.mem)[eta_p_162286];
        
        ((int64_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162291;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_172030.mem, i_171587 * b_94114, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171819.mem, eta_p_162286 * b_94114, (int64_t []) {(int64_t) 1}, (int64_t []) {b_94114});
    }
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172987, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172988, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_mergeSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_172999, struct memblock *mem_out_p_173000, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_89389, int64_t b_89390)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171824_cached_sizze_173001 = 0;
    unsigned char *mem_171824 = NULL;
    int64_t mem_171827_cached_sizze_173002 = 0;
    unsigned char *mem_171827 = NULL;
    int64_t mem_171837_cached_sizze_173003 = 0;
    unsigned char *mem_171837 = NULL;
    int64_t mem_171839_cached_sizze_173004 = 0;
    unsigned char *mem_171839 = NULL;
    int64_t mem_171906_cached_sizze_173005 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171909_cached_sizze_173006 = 0;
    unsigned char *mem_171909 = NULL;
    int64_t mem_171919_cached_sizze_173007 = 0;
    unsigned char *mem_171919 = NULL;
    int64_t mem_171921_cached_sizze_173008 = 0;
    unsigned char *mem_171921 = NULL;
    int64_t mem_171936_cached_sizze_173009 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171939_cached_sizze_173010 = 0;
    unsigned char *mem_171939 = NULL;
    struct memblock mem_172030;
    
    mem_172030.references = NULL;
    
    struct memblock mem_172028;
    
    mem_172028.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_172016;
    
    mem_172016.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_171978;
    
    mem_171978.references = NULL;
    
    struct memblock mem_171974;
    
    mem_171974.references = NULL;
    
    struct memblock mem_171983;
    
    mem_171983.references = NULL;
    
    struct memblock mem_171981;
    
    mem_171981.references = NULL;
    
    struct memblock ext_mem_171998;
    
    ext_mem_171998.references = NULL;
    
    struct memblock ext_mem_172001;
    
    ext_mem_172001.references = NULL;
    
    struct memblock mem_param_171903;
    
    mem_param_171903.references = NULL;
    
    struct memblock mem_param_171900;
    
    mem_param_171900.references = NULL;
    
    struct memblock ext_mem_172022;
    
    ext_mem_172022.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock mem_171896;
    
    mem_171896.references = NULL;
    
    struct memblock mem_171892;
    
    mem_171892.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_89389;
    bool cond_161777 = sle64(n_89389, (int64_t) 1);
    int64_t zs_lhs_161778 = sub64(n_89389, (int64_t) 1);
    int64_t zp_rhs_161779 = sdiv_safe64(zs_lhs_161778, (int64_t) 20);
    int64_t min_num_blocks_161780 = add64((int64_t) 1, zp_rhs_161779);
    bool loop_cond_161781 = slt64((int64_t) 1, min_num_blocks_161780);
    bool smallest_pow_2_geq_than_res_161782;
    int64_t smallest_pow_2_geq_than_res_161783;
    bool loop_while_161784;
    int64_t x_161785;
    
    loop_while_161784 = loop_cond_161781;
    x_161785 = (int64_t) 1;
    while (loop_while_161784) {
        int64_t loopres_161786 = mul64((int64_t) 2, x_161785);
        bool loop_cond_161787 = slt64(loopres_161786, min_num_blocks_161780);
        bool loop_while_tmp_172502 = loop_cond_161787;
        int64_t x_tmp_172503 = loopres_161786;
        
        loop_while_161784 = loop_while_tmp_172502;
        x_161785 = x_tmp_172503;
    }
    smallest_pow_2_geq_than_res_161782 = loop_while_161784;
    smallest_pow_2_geq_than_res_161783 = x_161785;
    
    bool zzero_161788 = smallest_pow_2_geq_than_res_161783 == (int64_t) 0;
    bool nonzzero_161789 = !zzero_161788;
    bool protect_assert_disj_161790 = cond_161777 || nonzzero_161789;
    bool nonzzero_cert_161791;
    
    if (!protect_assert_disj_161790) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:234:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:117:32-36\n   #5  ftRelational.fut:114:5-117:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zp_rhs_161792 = sdiv_safe64(zs_lhs_161778, smallest_pow_2_geq_than_res_161783);
    int64_t block_sizze_161793 = add64((int64_t) 1, zp_rhs_161792);
    bool y_161799 = slt64((int64_t) 0, n_89389);
    bool protect_assert_disj_172415 = cond_161777 || y_161799;
    bool index_certs_161800;
    
    if (!protect_assert_disj_172415) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) n_89389, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:240:60-64\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:117:32-36\n   #5  ftRelational.fut:114:5-117:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161814 = slt64(smallest_pow_2_geq_than_res_161783, (int64_t) 0);
    bool valid_161815 = !bounds_invalid_upwards_161814;
    bool protect_assert_disj_172423 = cond_161777 || valid_161815;
    bool range_valid_c_161816;
    
    if (!protect_assert_disj_172423) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) smallest_pow_2_geq_than_res_161783, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:117:32-36\n   #6  ftRelational.fut:114:5-117:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool bounds_invalid_upwards_161818 = slt64(block_sizze_161793, (int64_t) 0);
    bool valid_161819 = !bounds_invalid_upwards_161818;
    bool protect_assert_disj_172425 = cond_161777 || valid_161819;
    bool range_valid_c_161820;
    
    if (!protect_assert_disj_172425) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) block_sizze_161793, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_161822 = sle64(block_sizze_161793, (int64_t) 1);
    int64_t tmp_161823 = sub64(block_sizze_161793, (int64_t) 2);
    bool bounds_invalid_upwards_161824 = slt64(tmp_161823, (int64_t) 0);
    bool valid_161826 = !bounds_invalid_upwards_161824;
    bool protect_assert_disj_161827 = cond_161822 || valid_161826;
    bool protect_assert_disj_172427 = cond_161777 || protect_assert_disj_161827;
    bool range_valid_c_161828;
    
    if (!protect_assert_disj_172427) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_161823, " is invalid.", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:166:19-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_172027 = (int64_t) 2 * n_89389;
    int64_t bytes_172029 = n_89389 * b_89390;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172504 = 0; i_172504 < n_89389; i_172504++) {
        int64_t x_172505 = (int64_t) 0 + i_172504 * (int64_t) 1;
        
        ((int64_t *) mem_171821.mem)[i_172504] = x_172505;
    }
    
    int64_t flat_dim_161794 = smallest_pow_2_geq_than_res_161783 * block_sizze_161793;
    bool x_172410 = !cond_161777;
    int64_t greatest_divisor_leq_than_arg1_161797 = mul64((int64_t) 2, block_sizze_161793);
    int64_t merge_block_sizze_161798;
    
    if (x_172410) {
        int64_t x_172412;
        
        if (futrts_greatest_divisor_leq_than_5312(ctx, &x_172412, (int64_t) 8, greatest_divisor_leq_than_arg1_161797) != 0) {
            err = 1;
            goto cleanup;
        }
        merge_block_sizze_161798 = x_172412;
    } else {
        merge_block_sizze_161798 = (int64_t) 0;
    }
    
    int16_t reduce_arg1_161801;
    
    if (x_172410) {
        int16_t x_172416 = ((int16_t *) k_mem_171818.mem)[(int64_t) 0];
        
        reduce_arg1_161801 = x_172416;
    } else {
        reduce_arg1_161801 = (int16_t) 0;
    }
    
    int16_t defunc_0_reduce_res_162661;
    int64_t defunc_0_reduce_res_162662;
    
    if (x_172410) {
        int16_t x_172418;
        int64_t x_172419;
        int16_t redout_171545;
        int64_t redout_171546;
        
        redout_171545 = reduce_arg1_161801;
        redout_171546 = (int64_t) 0;
        for (int64_t i_171547 = 0; i_171547 < n_89389; i_171547++) {
            int16_t x_161805 = ((int16_t *) k_mem_171818.mem)[i_171547];
            bool defunc_0_leq_res_161811 = sle16(redout_171545, x_161805);
            int16_t defunc_0_op_res_161812;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161812 = x_161805;
            } else {
                defunc_0_op_res_161812 = redout_171545;
            }
            
            int64_t defunc_0_op_res_161813;
            
            if (defunc_0_leq_res_161811) {
                defunc_0_op_res_161813 = i_171547;
            } else {
                defunc_0_op_res_161813 = redout_171546;
            }
            
            int16_t redout_tmp_172506 = defunc_0_op_res_161812;
            int64_t redout_tmp_172507 = defunc_0_op_res_161813;
            
            redout_171545 = redout_tmp_172506;
            redout_171546 = redout_tmp_172507;
        }
        x_172418 = redout_171545;
        x_172419 = redout_171546;
        defunc_0_reduce_res_162661 = x_172418;
        defunc_0_reduce_res_162662 = x_172419;
    } else {
        defunc_0_reduce_res_162661 = (int16_t) 0;
        defunc_0_reduce_res_162662 = (int64_t) 0;
    }
    
    int64_t distance_161825 = add64((int64_t) 1, tmp_161823);
    int64_t binop_x_171822 = (int64_t) 2 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171823 = block_sizze_161793 * binop_x_171822;
    int64_t binop_x_171825 = (int64_t) 8 * smallest_pow_2_geq_than_res_161783;
    int64_t bytes_171826 = block_sizze_161793 * binop_x_171825;
    int64_t bytes_171838 = (int64_t) 8 * block_sizze_161793;
    bool loop_cond_161900 = slt64(block_sizze_161793, flat_dim_161794);
    bool zzero_161901 = merge_block_sizze_161798 == (int64_t) 0;
    bool nonzzero_161902 = !zzero_161901;
    
    if (cond_161777) {
        if (memblock_set(ctx, &ext_mem_172026, &mem_171821, "mem_171821") != 0)
            return 1;
    } else {
        if (mem_171824_cached_sizze_173001 < bytes_171823) {
            err = lexical_realloc(ctx, &mem_171824, &mem_171824_cached_sizze_173001, bytes_171823);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171827_cached_sizze_173002 < bytes_171826) {
            err = lexical_realloc(ctx, &mem_171827, &mem_171827_cached_sizze_173002, bytes_171826);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171837_cached_sizze_173003 < greatest_divisor_leq_than_arg1_161797) {
            err = lexical_realloc(ctx, &mem_171837, &mem_171837_cached_sizze_173003, greatest_divisor_leq_than_arg1_161797);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        if (mem_171839_cached_sizze_173004 < bytes_171838) {
            err = lexical_realloc(ctx, &mem_171839, &mem_171839_cached_sizze_173004, bytes_171838);
            if (err != FUTHARK_SUCCESS)
                goto cleanup;
        }
        for (int64_t i_171559 = 0; i_171559 < smallest_pow_2_geq_than_res_161783; i_171559++) {
            int64_t zp_lhs_161832 = mul64(block_sizze_161793, i_171559);
            
            for (int64_t i_171552 = 0; i_171552 < block_sizze_161793; i_171552++) {
                int64_t k_161836 = add64(zp_lhs_161832, i_171552);
                bool cond_161837 = slt64(k_161836, n_89389);
                int16_t lifted_lambda_res_161838;
                int64_t lifted_lambda_res_161839;
                
                if (cond_161837) {
                    bool x_162514 = sle64((int64_t) 0, k_161836);
                    bool bounds_check_162515 = cond_161837 && x_162514;
                    bool index_certs_162516;
                    
                    if (!bounds_check_162515) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) k_161836, "] out of bounds for array of shape [", (long long) n_89389, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:246:26-30\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t lifted_lambda_res_t_res_162517 = ((int16_t *) k_mem_171818.mem)[k_161836];
                    
                    lifted_lambda_res_161838 = lifted_lambda_res_t_res_162517;
                    lifted_lambda_res_161839 = k_161836;
                } else {
                    lifted_lambda_res_161838 = defunc_0_reduce_res_162661;
                    lifted_lambda_res_161839 = defunc_0_reduce_res_162662;
                }
                ((int16_t *) mem_171837)[i_171552] = lifted_lambda_res_161838;
                ((int64_t *) mem_171839)[i_171552] = lifted_lambda_res_161839;
            }
            if (!cond_161822) {
                for (int64_t i_161849 = 0; i_161849 < distance_161825; i_161849++) {
                    int64_t gt_arg1_161852 = add64((int64_t) 1, i_161849);
                    bool x_161853 = sle64((int64_t) 0, gt_arg1_161852);
                    bool y_161854 = slt64(gt_arg1_161852, block_sizze_161793);
                    bool bounds_check_161855 = x_161853 && y_161854;
                    bool index_certs_161856;
                    
                    if (!bounds_check_161855) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) gt_arg1_161852, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:31-37\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    bool y_161858 = slt64(i_161849, block_sizze_161793);
                    bool index_certs_161859;
                    
                    if (!y_161858) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_161849, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int16_t gt_arg1_161857 = ((int16_t *) mem_171837)[gt_arg1_161852];
                    int16_t gt_arg0_161860 = ((int16_t *) mem_171837)[i_161849];
                    bool defunc_0_leq_res_161861 = sle16(gt_arg0_161860, gt_arg1_161857);
                    bool defunc_0_lifted_gt_res_161862 = !defunc_0_leq_res_161861;
                    bool s_161863;
                    int64_t s_161866;
                    bool loop_while_161867;
                    int64_t j_161870;
                    
                    loop_while_161867 = defunc_0_lifted_gt_res_161862;
                    j_161870 = i_161849;
                    while (loop_while_161867) {
                        bool x_161871 = sle64((int64_t) 0, j_161870);
                        bool y_161872 = slt64(j_161870, block_sizze_161793);
                        bool bounds_check_161873 = x_161871 && y_161872;
                        bool index_certs_161874;
                        
                        if (!bounds_check_161873) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_161870, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:170:24-28\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t copy_arg0_161877 = add64((int64_t) 1, j_161870);
                        bool x_161878 = sle64((int64_t) 0, copy_arg0_161877);
                        bool y_161879 = slt64(copy_arg0_161877, block_sizze_161793);
                        bool bounds_check_161880 = x_161878 && y_161879;
                        bool index_certs_161881;
                        
                        if (!bounds_check_161880) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) copy_arg0_161877, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:171:35-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int16_t copy_arg0_161875 = ((int16_t *) mem_171837)[j_161870];
                        int64_t copy_arg0_161876 = ((int64_t *) mem_171839)[j_161870];
                        int16_t copy_arg0_161882 = ((int16_t *) mem_171837)[copy_arg0_161877];
                        int64_t copy_arg0_161883 = ((int64_t *) mem_171839)[copy_arg0_161877];
                        
                        ((int16_t *) mem_171837)[j_161870] = copy_arg0_161882;
                        ((int64_t *) mem_171839)[j_161870] = copy_arg0_161883;
                        ((int16_t *) mem_171837)[copy_arg0_161877] = copy_arg0_161875;
                        ((int64_t *) mem_171839)[copy_arg0_161877] = copy_arg0_161876;
                        
                        int64_t tmp_161888 = sub64(j_161870, (int64_t) 1);
                        bool cond_161889 = sle64((int64_t) 0, tmp_161888);
                        bool loop_cond_161890;
                        
                        if (cond_161889) {
                            bool y_162519 = slt64(tmp_161888, block_sizze_161793);
                            bool bounds_check_162520 = cond_161889 && y_162519;
                            bool index_certs_162521;
                            
                            if (!bounds_check_162520) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_161888, "] out of bounds for array of shape [", (long long) block_sizze_161793, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:169:26-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:248:32-37\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int16_t gt_arg1_162518 = ((int16_t *) mem_171837)[j_161870];
                            int16_t gt_arg0_162522 = ((int16_t *) mem_171837)[tmp_161888];
                            bool defunc_0_leq_res_162523 = sle16(gt_arg0_162522, gt_arg1_162518);
                            bool defunc_0_lifted_gt_res_162524 = !defunc_0_leq_res_162523;
                            
                            loop_cond_161890 = defunc_0_lifted_gt_res_162524;
                        } else {
                            loop_cond_161890 = 0;
                        }
                        
                        bool loop_while_tmp_172514 = loop_cond_161890;
                        int64_t j_tmp_172517 = tmp_161888;
                        
                        loop_while_161867 = loop_while_tmp_172514;
                        j_161870 = j_tmp_172517;
                    }
                    s_161863 = loop_while_161867;
                    s_161866 = j_161870;
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171824, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171837, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171827, i_171559 * block_sizze_161793, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171839, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {block_sizze_161793});
        }
        if (memblock_alloc(ctx, &mem_171892, bytes_171823, "mem_171892")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 2, (uint16_t *) mem_171892.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint16_t *) mem_171824, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        if (memblock_alloc(ctx, &mem_171896, bytes_171826, "mem_171896")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 2, (uint64_t *) mem_171896.mem, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (uint64_t *) mem_171827, (int64_t) 0, (int64_t []) {block_sizze_161793, (int64_t) 1}, (int64_t []) {smallest_pow_2_geq_than_res_161783, block_sizze_161793});
        
        int64_t data_161903;
        bool data_161904;
        int64_t data_161907;
        int64_t loop_dz2084Uz2082U_161908;
        bool loop_while_161909;
        int64_t stride_161912;
        
        if (memblock_set(ctx, &mem_param_171900, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171903, &mem_171896, "mem_171896") != 0)
            return 1;
        loop_dz2084Uz2082U_161908 = flat_dim_161794;
        loop_while_161909 = loop_cond_161900;
        stride_161912 = block_sizze_161793;
        while (loop_while_161909) {
            int64_t next_stride_161913 = mul64((int64_t) 2, stride_161912);
            bool zzero_161914 = next_stride_161913 == (int64_t) 0;
            bool nonzzero_161915 = !zzero_161914;
            bool nonzzero_cert_161916;
            
            if (!nonzzero_161915) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:254:33-46\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #2  /prelude/functional.fut:9:44-45\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:117:32-36\n   #5  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_merges_161917 = sdiv64(flat_dim_161794, next_stride_161913);
            bool bounds_invalid_upwards_161918 = slt64(num_merges_161917, (int64_t) 0);
            bool valid_161919 = !bounds_invalid_upwards_161918;
            bool range_valid_c_161920;
            
            if (!valid_161919) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_merges_161917, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:117:32-36\n   #6  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_161922 = sub64(next_stride_161913, (int64_t) 1);
            bool zzero_leq_i_p_m_t_s_161923 = sle64((int64_t) 0, m_161922);
            bool cond_161925 = slt64(next_stride_161913, (int64_t) 10);
            bool protect_assert_disj_161926 = nonzzero_161902 || cond_161925;
            bool nonzzero_cert_161927;
            
            if (!protect_assert_disj_161926) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:30-42\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t zeze_lhs_161928 = smod_safe64(next_stride_161913, merge_block_sizze_161798);
            bool num_blocks_161929 = zeze_lhs_161928 == (int64_t) 0;
            bool protect_assert_disj_161930 = cond_161925 || num_blocks_161929;
            bool assert_c_161931;
            
            if (!protect_assert_disj_161930) {
                set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (n % block_size == 0)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:147:20-65\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t num_blocks_161933 = sdiv_safe64(next_stride_161913, merge_block_sizze_161798);
            int64_t dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934 = add64((int64_t) 1, num_blocks_161933);
            int64_t j_m_i_161935 = sub64(next_stride_161913, stride_161912);
            int64_t flat_dim_161936 = merge_block_sizze_161798 * num_blocks_161933;
            bool bounds_invalid_upwards_161937 = slt64(dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, (int64_t) 0);
            bool empty_slice_161938 = j_m_i_161935 == (int64_t) 0;
            int64_t m_161939 = sub64(j_m_i_161935, (int64_t) 1);
            bool zzero_lte_i_161940 = sle64((int64_t) 0, stride_161912);
            bool i_lte_j_161941 = sle64(stride_161912, next_stride_161913);
            bool empty_slice_161942 = stride_161912 == (int64_t) 0;
            int64_t m_161943 = sub64(stride_161912, (int64_t) 1);
            bool bounds_invalid_upwards_161944 = slt64(num_blocks_161933, (int64_t) 0);
            bool cond_161945 = slt64((int64_t) 0, stride_161912);
            bool valid_161946 = !bounds_invalid_upwards_161937;
            int64_t i_p_m_t_s_161947 = add64(stride_161912, m_161939);
            bool zzero_leq_i_p_m_t_s_161948 = sle64((int64_t) 0, m_161943);
            bool i_p_m_t_s_leq_w_161949 = slt64(m_161943, next_stride_161913);
            bool valid_161950 = !bounds_invalid_upwards_161944;
            bool i_p_m_t_s_leq_w_161951 = slt64(m_161922, flat_dim_161936);
            bool y_161952 = slt64((int64_t) 0, j_m_i_161935);
            bool protect_assert_disj_161953 = cond_161925 || valid_161946;
            bool range_valid_c_161954;
            
            if (!protect_assert_disj_161953) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool zzero_leq_i_p_m_t_s_161955 = sle64((int64_t) 0, i_p_m_t_s_161947);
            bool i_p_m_t_s_leq_w_161956 = slt64(i_p_m_t_s_161947, next_stride_161913);
            bool y_161957 = zzero_leq_i_p_m_t_s_161948 && i_p_m_t_s_leq_w_161949;
            bool protect_assert_disj_161958 = cond_161925 || valid_161950;
            bool range_valid_c_161959;
            
            if (!protect_assert_disj_161958) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) num_blocks_161933, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  /prelude/array.fut:241:11-17\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool y_161960 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161951;
            bool y_161961 = zzero_lte_i_161940 && i_p_m_t_s_leq_w_161956;
            bool forwards_ok_161962 = zzero_lte_i_161940 && y_161957;
            bool ok_or_empty_161963 = zzero_161914 || y_161960;
            bool protect_assert_disj_161964 = cond_161945 || y_161952;
            bool y_161965 = zzero_leq_i_p_m_t_s_161955 && y_161961;
            bool ok_or_empty_161966 = empty_slice_161942 || forwards_ok_161962;
            bool protect_assert_disj_161967 = cond_161925 || ok_or_empty_161963;
            bool index_certs_161968;
            
            if (!protect_assert_disj_161967) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) flat_dim_161936, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:155:3-46\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool loop_not_taken_161969 = !cond_161925;
            bool protect_assert_disj_161970 = protect_assert_disj_161964 || loop_not_taken_161969;
            bool index_certs_161971;
            
            if (!protect_assert_disj_161970) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool forwards_ok_161972 = i_lte_j_161941 && y_161965;
            bool protect_assert_disj_161973 = cond_161925 || ok_or_empty_161966;
            bool index_certs_161974;
            
            if (!protect_assert_disj_161973) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:52-59\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161975 = ok_or_empty_161966 || loop_not_taken_161969;
            bool index_certs_161976;
            
            if (!protect_assert_disj_161975) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) stride_161912, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:26-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool ok_or_empty_161977 = empty_slice_161938 || forwards_ok_161972;
            bool protect_assert_disj_161978 = cond_161925 || ok_or_empty_161977;
            bool index_certs_161979;
            
            if (!protect_assert_disj_161978) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:149:60-67\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            bool protect_assert_disj_161980 = loop_not_taken_161969 || ok_or_empty_161977;
            bool index_certs_161981;
            
            if (!protect_assert_disj_161980) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) stride_161912, ":] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:145:34-41\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_x_171904 = (int64_t) 2 * num_merges_161917;
            int64_t bytes_171905 = next_stride_161913 * binop_x_171904;
            int64_t binop_x_171907 = (int64_t) 8 * num_merges_161917;
            int64_t bytes_171908 = next_stride_161913 * binop_x_171907;
            bool i_lte_j_161924 = sle64((int64_t) 0, next_stride_161913);
            
            if (mem_171906_cached_sizze_173005 < bytes_171905) {
                err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_173005, bytes_171905);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171909_cached_sizze_173006 < bytes_171908) {
                err = lexical_realloc(ctx, &mem_171909, &mem_171909_cached_sizze_173006, bytes_171908);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t bytes_171918 = (int64_t) 8 * dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934;
            int64_t binop_x_171934 = (int64_t) 2 * num_blocks_161933;
            int64_t bytes_171935 = merge_block_sizze_161798 * binop_x_171934;
            int64_t binop_x_171937 = (int64_t) 8 * num_blocks_161933;
            int64_t bytes_171938 = merge_block_sizze_161798 * binop_x_171937;
            int64_t bytes_171980 = (int64_t) 4 * stride_161912;
            int64_t bytes_171982 = (int64_t) 16 * stride_161912;
            
            for (int64_t i_171580 = 0; i_171580 < num_merges_161917; i_171580++) {
                int64_t start_161985 = mul64(next_stride_161913, i_171580);
                int64_t j_m_i_161986 = sub64(loop_dz2084Uz2082U_161908, start_161985);
                bool empty_slice_161987 = j_m_i_161986 == (int64_t) 0;
                int64_t m_161988 = sub64(j_m_i_161986, (int64_t) 1);
                int64_t i_p_m_t_s_161989 = add64(start_161985, m_161988);
                bool zzero_leq_i_p_m_t_s_161990 = sle64((int64_t) 0, i_p_m_t_s_161989);
                bool i_p_m_t_s_leq_w_161991 = slt64(i_p_m_t_s_161989, loop_dz2084Uz2082U_161908);
                bool zzero_lte_i_161992 = sle64((int64_t) 0, start_161985);
                bool i_lte_j_161993 = sle64(start_161985, loop_dz2084Uz2082U_161908);
                bool y_161994 = i_p_m_t_s_leq_w_161991 && zzero_lte_i_161992;
                bool y_161995 = zzero_leq_i_p_m_t_s_161990 && y_161994;
                bool forwards_ok_161996 = i_lte_j_161993 && y_161995;
                bool ok_or_empty_161997 = empty_slice_161987 || forwards_ok_161996;
                bool index_certs_161998;
                
                if (!ok_or_empty_161997) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) start_161985, ":] out of bounds for array of shape [", (long long) loop_dz2084Uz2082U_161908, "].", "-> #0  /prelude/array.fut:52:49-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:41-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                bool i_p_m_t_s_leq_w_161999 = slt64(m_161922, j_m_i_161986);
                bool y_162000 = zzero_leq_i_p_m_t_s_161923 && i_p_m_t_s_leq_w_161999;
                bool forwards_ok_162001 = i_lte_j_161924 && y_162000;
                bool ok_or_empty_162002 = zzero_161914 || forwards_ok_162001;
                bool index_certs_162003;
                
                if (!ok_or_empty_162002) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) next_stride_161913, "] out of bounds for array of shape [", (long long) j_m_i_161986, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:258:23-56\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #5  /prelude/functional.fut:9:44-45\n   #6  ftSMJ.fut:104:60-63\n   #7  ftRelational.fut:117:32-36\n   #8  ftRelational.fut:114:5-117:36\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                if (cond_161925) {
                    int16_t dummy_162550;
                    int64_t dummy_162551;
                    
                    if (cond_161945) {
                        int16_t head_res_162552 = ((int16_t *) mem_param_171900.mem)[start_161985];
                        int64_t head_res_162553 = ((int64_t *) mem_param_171903.mem)[start_161985];
                        
                        dummy_162550 = head_res_162552;
                        dummy_162551 = head_res_162553;
                    } else {
                        int64_t slice_162554 = stride_161912 + start_161985;
                        int16_t head_res_162555 = ((int16_t *) mem_param_171900.mem)[slice_162554];
                        int64_t head_res_162556 = ((int64_t *) mem_param_171903.mem)[slice_162554];
                        
                        dummy_162550 = head_res_162555;
                        dummy_162551 = head_res_162556;
                    }
                    if (memblock_alloc(ctx, &mem_171981, bytes_171980, "mem_171981")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172527 = 0; nest_i_172527 < next_stride_161913; nest_i_172527++) {
                        ((int16_t *) mem_171981.mem)[nest_i_172527] = dummy_162550;
                    }
                    if (memblock_alloc(ctx, &mem_171983, bytes_171982, "mem_171983")) {
                        err = 1;
                        goto cleanup;
                    }
                    for (int64_t nest_i_172528 = 0; nest_i_172528 < next_stride_161913; nest_i_172528++) {
                        ((int64_t *) mem_171983.mem)[nest_i_172528] = dummy_162551;
                    }
                    
                    int64_t data_162559;
                    int64_t i_162563 = (int64_t) 0;
                    
                    for (int64_t k_162562 = 0; k_162562 < next_stride_161913; k_162562++) {
                        int64_t j_162566 = sub64(k_162562, i_162563);
                        bool cond_162567 = j_162566 == j_m_i_161935;
                        bool cond_162568;
                        
                        if (cond_162567) {
                            cond_162568 = 1;
                        } else {
                            bool cond_162569 = slt64(i_162563, stride_161912);
                            bool cond_f_res_162570;
                            
                            if (cond_162569) {
                                bool x_162571 = sle64((int64_t) 0, j_162566);
                                bool y_162572 = slt64(j_162566, j_m_i_161935);
                                bool bounds_check_162573 = x_162571 && y_162572;
                                bool index_certs_162574;
                                
                                if (!bounds_check_162573) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                bool x_162578 = sle64((int64_t) 0, i_162563);
                                bool bounds_check_162579 = cond_162569 && x_162578;
                                bool index_certs_162580;
                                
                                if (!bounds_check_162579) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162575 = stride_161912 + j_162566;
                                int64_t slice_162576 = start_161985 + slice_162575;
                                int16_t leq_arg1_162577 = ((int16_t *) mem_param_171900.mem)[slice_162576];
                                int64_t slice_162581 = start_161985 + i_162563;
                                int16_t leq_arg0_162582 = ((int16_t *) mem_param_171900.mem)[slice_162581];
                                bool defunc_0_leq_res_162583 = sle16(leq_arg0_162582, leq_arg1_162577);
                                
                                cond_f_res_162570 = defunc_0_leq_res_162583;
                            } else {
                                cond_f_res_162570 = 0;
                            }
                            cond_162568 = cond_f_res_162570;
                        }
                        
                        int64_t loopres_162584;
                        int16_t loopres_162585;
                        int64_t loopres_162586;
                        
                        if (cond_162568) {
                            bool x_162588 = sle64((int64_t) 0, i_162563);
                            bool y_162589 = slt64(i_162563, stride_161912);
                            bool bounds_check_162590 = x_162588 && y_162589;
                            bool index_certs_162591;
                            
                            if (!bounds_check_162590) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162563, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t tmp_162587 = add64((int64_t) 1, i_162563);
                            int64_t slice_162592 = start_161985 + i_162563;
                            int16_t tmp_162593 = ((int16_t *) mem_param_171900.mem)[slice_162592];
                            int64_t tmp_162594 = ((int64_t *) mem_param_171903.mem)[slice_162592];
                            
                            loopres_162584 = tmp_162587;
                            loopres_162585 = tmp_162593;
                            loopres_162586 = tmp_162594;
                        } else {
                            bool x_162595 = sle64((int64_t) 0, j_162566);
                            bool y_162596 = slt64(j_162566, j_m_i_161935);
                            bool bounds_check_162597 = x_162595 && y_162596;
                            bool index_certs_162598;
                            
                            if (!bounds_check_162597) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162566, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:145:42-43\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #6  /prelude/functional.fut:9:44-45\n   #7  ftSMJ.fut:104:60-63\n   #8  ftRelational.fut:117:32-36\n   #9  ftRelational.fut:114:5-117:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162599 = stride_161912 + j_162566;
                            int64_t slice_162600 = start_161985 + slice_162599;
                            int16_t tmp_162601 = ((int16_t *) mem_param_171900.mem)[slice_162600];
                            int64_t tmp_162602 = ((int64_t *) mem_param_171903.mem)[slice_162600];
                            
                            loopres_162584 = i_162563;
                            loopres_162585 = tmp_162601;
                            loopres_162586 = tmp_162602;
                        }
                        ((int16_t *) mem_171981.mem)[k_162562] = loopres_162585;
                        ((int64_t *) mem_171983.mem)[k_162562] = loopres_162586;
                        
                        int64_t i_tmp_172529 = loopres_162584;
                        
                        i_162563 = i_tmp_172529;
                    }
                    data_162559 = i_162563;
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171981, "mem_171981") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171983, "mem_171983") != 0)
                        return 1;
                } else {
                    if (mem_171919_cached_sizze_173007 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171919, &mem_171919_cached_sizze_173007, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171921_cached_sizze_173008 < bytes_171918) {
                        err = lexical_realloc(ctx, &mem_171921, &mem_171921_cached_sizze_173008, bytes_171918);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171566 = 0; i_171566 < dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934; i_171566++) {
                        int64_t split_count_arg3_162065 = mul64(merge_block_sizze_161798, i_171566);
                        int64_t defunc_0_split_count_res_162066;
                        int64_t defunc_0_split_count_res_162067;
                        int64_t defunc_0_split_count_res_162068;
                        int64_t defunc_0_split_count_res_162069;
                        int64_t defunc_0_split_count_res_162070;
                        
                        if (futrts_lifted_normalizze_15243(ctx, &defunc_0_split_count_res_162066, &defunc_0_split_count_res_162067, &defunc_0_split_count_res_162068, &defunc_0_split_count_res_162069, &defunc_0_split_count_res_162070, (int64_t) 0, stride_161912, (int64_t) 0, j_m_i_161935, split_count_arg3_162065) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        bool loop_cond_162071 = slt64((int64_t) 0, defunc_0_split_count_res_162070);
                        bool defunc_0_split_count_res_162072;
                        int64_t defunc_0_split_count_res_162073;
                        int64_t defunc_0_split_count_res_162074;
                        int64_t defunc_0_split_count_res_162075;
                        int64_t defunc_0_split_count_res_162076;
                        int64_t defunc_0_split_count_res_162077;
                        bool loop_while_162078;
                        int64_t ss_162079;
                        int64_t ss_162080;
                        int64_t tt_162081;
                        int64_t tt_162082;
                        int64_t count_162083;
                        
                        loop_while_162078 = loop_cond_162071;
                        ss_162079 = defunc_0_split_count_res_162066;
                        ss_162080 = defunc_0_split_count_res_162067;
                        tt_162081 = defunc_0_split_count_res_162068;
                        tt_162082 = defunc_0_split_count_res_162069;
                        count_162083 = defunc_0_split_count_res_162070;
                        while (loop_while_162078) {
                            int64_t zlze_lhs_162084 = sub64(ss_162080, ss_162079);
                            bool cond_162085 = sle64(zlze_lhs_162084, (int64_t) 0);
                            int64_t defunc_0_lifted_step_res_162086;
                            int64_t defunc_0_lifted_step_res_162087;
                            int64_t defunc_0_lifted_step_res_162088;
                            int64_t defunc_0_lifted_step_res_162089;
                            
                            if (cond_162085) {
                                int64_t tmp_162605 = add64(tt_162081, count_162083);
                                
                                defunc_0_lifted_step_res_162086 = ss_162079;
                                defunc_0_lifted_step_res_162087 = tmp_162605;
                                defunc_0_lifted_step_res_162088 = tt_162082;
                                defunc_0_lifted_step_res_162089 = (int64_t) 0;
                            } else {
                                int64_t zlze_lhs_162091 = sub64(tt_162082, tt_162081);
                                bool cond_162092 = sle64(zlze_lhs_162091, (int64_t) 0);
                                int64_t defunc_0_lifted_step_res_f_res_162093;
                                int64_t defunc_0_lifted_step_res_f_res_162094;
                                int64_t defunc_0_lifted_step_res_f_res_162095;
                                int64_t defunc_0_lifted_step_res_f_res_162096;
                                
                                if (cond_162092) {
                                    int64_t tmp_162606 = add64(ss_162079, count_162083);
                                    
                                    defunc_0_lifted_step_res_f_res_162093 = tmp_162606;
                                    defunc_0_lifted_step_res_f_res_162094 = tt_162081;
                                    defunc_0_lifted_step_res_f_res_162095 = tt_162082;
                                    defunc_0_lifted_step_res_f_res_162096 = (int64_t) 0;
                                } else {
                                    bool cond_162098 = count_162083 == (int64_t) 1;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162099;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162100;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162101;
                                    int64_t defunc_0_lifted_step_res_f_res_f_res_162102;
                                    
                                    if (cond_162098) {
                                        bool x_162608 = sle64((int64_t) 0, ss_162079);
                                        bool y_162609 = slt64(ss_162079, stride_161912);
                                        bool bounds_check_162610 = x_162608 && y_162609;
                                        bool index_certs_162611;
                                        
                                        if (!bounds_check_162610) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) ss_162079, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:21-27\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:117:32-36\n   #13 ftRelational.fut:114:5-117:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        bool x_162614 = sle64((int64_t) 0, tt_162081);
                                        bool y_162615 = slt64(tt_162081, j_m_i_161935);
                                        bool bounds_check_162616 = x_162614 && y_162615;
                                        bool index_certs_162617;
                                        
                                        if (!bounds_check_162616) {
                                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tt_162081, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:53:14-20\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:117:32-36\n   #13 ftRelational.fut:114:5-117:36\n"));
                                            err = FUTHARK_PROGRAM_ERROR;
                                            goto cleanup;
                                        }
                                        
                                        int64_t slice_162612 = start_161985 + ss_162079;
                                        int16_t leq_arg1_162613 = ((int16_t *) mem_param_171900.mem)[slice_162612];
                                        int64_t slice_162618 = stride_161912 + tt_162081;
                                        int64_t slice_162619 = start_161985 + slice_162618;
                                        int16_t leq_arg0_162620 = ((int16_t *) mem_param_171900.mem)[slice_162619];
                                        bool defunc_0_leq_res_162621 = sle16(leq_arg0_162620, leq_arg1_162613);
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        
                                        if (defunc_0_leq_res_162621) {
                                            int64_t tmp_162624 = add64((int64_t) 1, tt_162081);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = ss_162079;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tmp_162624;
                                        } else {
                                            int64_t tmp_162625 = add64((int64_t) 1, ss_162079);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162622 = tmp_162625;
                                            defunc_0_lifted_step_res_f_res_f_res_t_res_162623 = tt_162081;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = defunc_0_lifted_step_res_f_res_f_res_t_res_162622;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_t_res_162623;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = tt_162082;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = (int64_t) 0;
                                    } else {
                                        int64_t m_162121 = sdiv64(count_162083, (int64_t) 2);
                                        int64_t n_162122 = sub64(count_162083, m_162121);
                                        bool cond_162123 = n_162122 == (int64_t) 0;
                                        int64_t zgze_lhs_162124 = add64(ss_162079, m_162121);
                                        bool cond_f_res_162125 = sle64(ss_162080, zgze_lhs_162124);
                                        bool x_162126 = !cond_162123;
                                        bool y_162127 = cond_f_res_162125 && x_162126;
                                        bool cond_162128 = cond_162123 || y_162127;
                                        bool leq_y_x_162129;
                                        
                                        if (cond_162128) {
                                            leq_y_x_162129 = 1;
                                        } else {
                                            bool x_162130 = sle64((int64_t) 0, zgze_lhs_162124);
                                            bool y_162131 = slt64(zgze_lhs_162124, stride_161912);
                                            bool bounds_check_162132 = x_162130 && y_162131;
                                            bool index_certs_162133;
                                            
                                            if (!bounds_check_162132) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_lhs_162124, "] out of bounds for array of shape [", (long long) stride_161912, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:22-30\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:117:32-36\n   #13 ftRelational.fut:114:5-117:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t zm_lhs_162136 = add64(tt_162081, n_162122);
                                            int64_t leq_arg0_162137 = sub64(zm_lhs_162136, (int64_t) 1);
                                            bool x_162138 = sle64((int64_t) 0, leq_arg0_162137);
                                            bool y_162139 = slt64(leq_arg0_162137, j_m_i_161935);
                                            bool bounds_check_162140 = x_162138 && y_162139;
                                            bool index_certs_162141;
                                            
                                            if (!bounds_check_162140) {
                                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) leq_arg0_162137, "] out of bounds for array of shape [", (long long) j_m_i_161935, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:73:11-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:83:23-38\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:149:71-83\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:149:30-84\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #7  /prelude/soacs.fut:59:9-11\n   #8  /prelude/array.fut:241:11-17\n   #9  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #10 /prelude/functional.fut:9:44-45\n   #11 ftSMJ.fut:104:60-63\n   #12 ftRelational.fut:117:32-36\n   #13 ftRelational.fut:114:5-117:36\n"));
                                                err = FUTHARK_PROGRAM_ERROR;
                                                goto cleanup;
                                            }
                                            
                                            int64_t slice_162134 = start_161985 + zgze_lhs_162124;
                                            int16_t leq_arg1_162135 = ((int16_t *) mem_param_171900.mem)[slice_162134];
                                            int64_t slice_162142 = stride_161912 + leq_arg0_162137;
                                            int64_t slice_162143 = start_161985 + slice_162142;
                                            int16_t leq_arg0_162144 = ((int16_t *) mem_param_171900.mem)[slice_162143];
                                            bool defunc_0_leq_res_162145 = sle16(leq_arg0_162144, leq_arg1_162135);
                                            
                                            leq_y_x_162129 = defunc_0_leq_res_162145;
                                        }
                                        
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        int64_t defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                        
                                        if (leq_y_x_162129) {
                                            int64_t tmp_162626 = add64(tt_162081, n_162122);
                                            int64_t tmp_162627 = sub64(count_162083, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tmp_162626;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tt_162082;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = tmp_162627;
                                        } else {
                                            int64_t tmp_162151 = add64(tt_162081, n_162122);
                                            
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162146 = tt_162081;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162147 = tmp_162151;
                                            defunc_0_lifted_step_res_f_res_f_res_f_res_162148 = count_162083;
                                        }
                                        defunc_0_lifted_step_res_f_res_f_res_162099 = ss_162079;
                                        defunc_0_lifted_step_res_f_res_f_res_162100 = defunc_0_lifted_step_res_f_res_f_res_f_res_162146;
                                        defunc_0_lifted_step_res_f_res_f_res_162101 = defunc_0_lifted_step_res_f_res_f_res_f_res_162147;
                                        defunc_0_lifted_step_res_f_res_f_res_162102 = defunc_0_lifted_step_res_f_res_f_res_f_res_162148;
                                    }
                                    defunc_0_lifted_step_res_f_res_162093 = defunc_0_lifted_step_res_f_res_f_res_162099;
                                    defunc_0_lifted_step_res_f_res_162094 = defunc_0_lifted_step_res_f_res_f_res_162100;
                                    defunc_0_lifted_step_res_f_res_162095 = defunc_0_lifted_step_res_f_res_f_res_162101;
                                    defunc_0_lifted_step_res_f_res_162096 = defunc_0_lifted_step_res_f_res_f_res_162102;
                                }
                                defunc_0_lifted_step_res_162086 = defunc_0_lifted_step_res_f_res_162093;
                                defunc_0_lifted_step_res_162087 = defunc_0_lifted_step_res_f_res_162094;
                                defunc_0_lifted_step_res_162088 = defunc_0_lifted_step_res_f_res_162095;
                                defunc_0_lifted_step_res_162089 = defunc_0_lifted_step_res_f_res_162096;
                            }
                            
                            int64_t loopres_162152;
                            int64_t loopres_162153;
                            int64_t loopres_162154;
                            int64_t loopres_162155;
                            int64_t loopres_162156;
                            
                            if (futrts_lifted_normalizze_15243(ctx, &loopres_162152, &loopres_162153, &loopres_162154, &loopres_162155, &loopres_162156, defunc_0_lifted_step_res_162086, ss_162080, defunc_0_lifted_step_res_162087, defunc_0_lifted_step_res_162088, defunc_0_lifted_step_res_162089) != 0) {
                                err = 1;
                                goto cleanup;
                            }
                            
                            bool loop_cond_162157 = slt64((int64_t) 0, loopres_162156);
                            bool loop_while_tmp_172534 = loop_cond_162157;
                            int64_t ss_tmp_172535 = loopres_162152;
                            int64_t ss_tmp_172536 = loopres_162153;
                            int64_t tt_tmp_172537 = loopres_162154;
                            int64_t tt_tmp_172538 = loopres_162155;
                            int64_t count_tmp_172539 = loopres_162156;
                            
                            loop_while_162078 = loop_while_tmp_172534;
                            ss_162079 = ss_tmp_172535;
                            ss_162080 = ss_tmp_172536;
                            tt_162081 = tt_tmp_172537;
                            tt_162082 = tt_tmp_172538;
                            count_162083 = count_tmp_172539;
                        }
                        defunc_0_split_count_res_162072 = loop_while_162078;
                        defunc_0_split_count_res_162073 = ss_162079;
                        defunc_0_split_count_res_162074 = ss_162080;
                        defunc_0_split_count_res_162075 = tt_162081;
                        defunc_0_split_count_res_162076 = tt_162082;
                        defunc_0_split_count_res_162077 = count_162083;
                        ((int64_t *) mem_171919)[i_171566] = defunc_0_split_count_res_162073;
                        ((int64_t *) mem_171921)[i_171566] = defunc_0_split_count_res_162075;
                    }
                    if (mem_171936_cached_sizze_173009 < bytes_171935) {
                        err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_173009, bytes_171935);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    if (mem_171939_cached_sizze_173010 < bytes_171938) {
                        err = lexical_realloc(ctx, &mem_171939, &mem_171939_cached_sizze_173010, bytes_171938);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    for (int64_t i_171573 = 0; i_171573 < num_blocks_161933; i_171573++) {
                        bool y_162163 = slt64(i_171573, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool index_certs_162165;
                        
                        if (!y_162163) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171573, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:151:22-34\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162166 = ((int64_t *) mem_171919)[i_171573];
                        int64_t defunc_0_f_res_162167 = ((int64_t *) mem_171921)[i_171573];
                        int64_t tmp_162168 = add64((int64_t) 1, i_171573);
                        bool x_162169 = sle64((int64_t) 0, tmp_162168);
                        bool y_162170 = slt64(tmp_162168, dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934);
                        bool bounds_check_162171 = x_162169 && y_162170;
                        bool index_certs_162172;
                        
                        if (!bounds_check_162171) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162168, "] out of bounds for array of shape [", (long long) dzlz7bUZLzpZRz20U1z20Unum_blocksz7dUzg_161934, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:152:22-36\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t defunc_0_f_res_162173 = ((int64_t *) mem_171919)[tmp_162168];
                        int64_t defunc_0_f_res_162174 = ((int64_t *) mem_171921)[tmp_162168];
                        int64_t merge_sequential_arg2_162175 = add64(stride_161912, defunc_0_f_res_162167);
                        int64_t merge_sequential_arg2_162176 = add64(stride_161912, defunc_0_f_res_162174);
                        int64_t j_m_i_162177 = sub64(merge_sequential_arg2_162176, merge_sequential_arg2_162175);
                        bool empty_slice_162178 = j_m_i_162177 == (int64_t) 0;
                        int64_t m_162179 = sub64(j_m_i_162177, (int64_t) 1);
                        int64_t i_p_m_t_s_162180 = add64(merge_sequential_arg2_162175, m_162179);
                        bool zzero_leq_i_p_m_t_s_162181 = sle64((int64_t) 0, i_p_m_t_s_162180);
                        bool i_p_m_t_s_leq_w_162182 = slt64(i_p_m_t_s_162180, next_stride_161913);
                        bool zzero_lte_i_162183 = sle64((int64_t) 0, merge_sequential_arg2_162175);
                        bool i_lte_j_162184 = sle64(merge_sequential_arg2_162175, merge_sequential_arg2_162176);
                        bool y_162185 = i_p_m_t_s_leq_w_162182 && zzero_lte_i_162183;
                        bool y_162186 = zzero_leq_i_p_m_t_s_162181 && y_162185;
                        bool forwards_ok_162187 = i_lte_j_162184 && y_162186;
                        bool ok_or_empty_162188 = empty_slice_162178 || forwards_ok_162187;
                        bool index_certs_162189;
                        
                        if (!ok_or_empty_162188) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) merge_sequential_arg2_162175, ":", (long long) merge_sequential_arg2_162176, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:40-58\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int64_t j_m_i_162190 = sub64(defunc_0_f_res_162173, defunc_0_f_res_162166);
                        bool empty_slice_162191 = j_m_i_162190 == (int64_t) 0;
                        int64_t m_162192 = sub64(j_m_i_162190, (int64_t) 1);
                        int64_t i_p_m_t_s_162193 = add64(defunc_0_f_res_162166, m_162192);
                        bool zzero_leq_i_p_m_t_s_162194 = sle64((int64_t) 0, i_p_m_t_s_162193);
                        bool i_p_m_t_s_leq_w_162195 = slt64(i_p_m_t_s_162193, next_stride_161913);
                        bool zzero_lte_i_162196 = sle64((int64_t) 0, defunc_0_f_res_162166);
                        bool i_lte_j_162197 = sle64(defunc_0_f_res_162166, defunc_0_f_res_162173);
                        bool y_162198 = i_p_m_t_s_leq_w_162195 && zzero_lte_i_162196;
                        bool y_162199 = zzero_leq_i_p_m_t_s_162194 && y_162198;
                        bool forwards_ok_162200 = i_lte_j_162197 && y_162199;
                        bool ok_or_empty_162201 = empty_slice_162191 || forwards_ok_162200;
                        bool index_certs_162202;
                        
                        if (!ok_or_empty_162201) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) defunc_0_f_res_162166, ":", (long long) defunc_0_f_res_162173, "] out of bounds for array of shape [", (long long) next_stride_161913, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:153:29-39\n   #1  /prelude/soacs.fut:59:9-11\n   #2  /prelude/array.fut:241:11-17\n   #3  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #4  /prelude/soacs.fut:59:9-11\n   #5  /prelude/array.fut:241:11-17\n   #6  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #7  /prelude/functional.fut:9:44-45\n   #8  ftSMJ.fut:104:60-63\n   #9  ftRelational.fut:117:32-36\n   #10 ftRelational.fut:114:5-117:36\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        bool cond_162203 = slt64((int64_t) 0, j_m_i_162190);
                        int16_t dummy_162204;
                        int64_t dummy_162205;
                        
                        if (cond_162203) {
                            bool index_certs_162628;
                            
                            if (!cond_162203) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:36-42\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:117:32-36\n   #12 ftRelational.fut:114:5-117:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162629 = start_161985 + defunc_0_f_res_162166;
                            int16_t head_res_162630 = ((int16_t *) mem_param_171900.mem)[slice_162629];
                            int64_t head_res_162631 = ((int64_t *) mem_param_171903.mem)[slice_162629];
                            
                            dummy_162204 = head_res_162630;
                            dummy_162205 = head_res_162631;
                        } else {
                            bool y_162210 = slt64((int64_t) 0, j_m_i_162177);
                            bool index_certs_162211;
                            
                            if (!y_162210) {
                                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  /prelude/array.fut:22:29-33\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:100:48-54\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #3  /prelude/soacs.fut:59:9-11\n   #4  /prelude/array.fut:241:11-17\n   #5  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #6  /prelude/soacs.fut:59:9-11\n   #7  /prelude/array.fut:241:11-17\n   #8  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #9  /prelude/functional.fut:9:44-45\n   #10 ftSMJ.fut:104:60-63\n   #11 ftRelational.fut:117:32-36\n   #12 ftRelational.fut:114:5-117:36\n"));
                                err = FUTHARK_PROGRAM_ERROR;
                                goto cleanup;
                            }
                            
                            int64_t slice_162212 = start_161985 + merge_sequential_arg2_162175;
                            int16_t head_res_162213 = ((int16_t *) mem_param_171900.mem)[slice_162212];
                            int64_t head_res_162214 = ((int64_t *) mem_param_171903.mem)[slice_162212];
                            
                            dummy_162204 = head_res_162213;
                            dummy_162205 = head_res_162214;
                        }
                        for (int64_t nest_i_172542 = 0; nest_i_172542 < merge_block_sizze_161798; nest_i_172542++) {
                            ((int16_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + nest_i_172542] = dummy_162204;
                        }
                        for (int64_t nest_i_172543 = 0; nest_i_172543 < merge_block_sizze_161798; nest_i_172543++) {
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + nest_i_172543] = dummy_162205;
                        }
                        
                        int64_t data_162217;
                        int64_t i_162221 = (int64_t) 0;
                        
                        for (int64_t k_162220 = 0; k_162220 < merge_block_sizze_161798; k_162220++) {
                            int64_t j_162224 = sub64(k_162220, i_162221);
                            bool cond_162225 = j_162224 == j_m_i_162177;
                            bool cond_162226;
                            
                            if (cond_162225) {
                                cond_162226 = 1;
                            } else {
                                bool cond_162227 = slt64(i_162221, j_m_i_162190);
                                bool cond_f_res_162228;
                                
                                if (cond_162227) {
                                    bool x_162632 = sle64((int64_t) 0, j_162224);
                                    bool y_162633 = slt64(j_162224, j_m_i_162177);
                                    bool bounds_check_162634 = x_162632 && y_162633;
                                    bool index_certs_162635;
                                    
                                    if (!bounds_check_162634) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:55-59\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    bool x_162639 = sle64((int64_t) 0, i_162221);
                                    bool bounds_check_162640 = cond_162227 && x_162639;
                                    bool index_certs_162641;
                                    
                                    if (!bounds_check_162640) {
                                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:105:50-54\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                                        err = FUTHARK_PROGRAM_ERROR;
                                        goto cleanup;
                                    }
                                    
                                    int64_t slice_162636 = merge_sequential_arg2_162175 + j_162224;
                                    int64_t slice_162637 = start_161985 + slice_162636;
                                    int16_t leq_arg1_162638 = ((int16_t *) mem_param_171900.mem)[slice_162637];
                                    int64_t slice_162642 = defunc_0_f_res_162166 + i_162221;
                                    int64_t slice_162643 = start_161985 + slice_162642;
                                    int16_t leq_arg0_162644 = ((int16_t *) mem_param_171900.mem)[slice_162643];
                                    bool defunc_0_leq_res_162645 = sle16(leq_arg0_162644, leq_arg1_162638);
                                    
                                    cond_f_res_162228 = defunc_0_leq_res_162645;
                                } else {
                                    cond_f_res_162228 = 0;
                                }
                                cond_162226 = cond_f_res_162228;
                            }
                            
                            int64_t loopres_162243;
                            int16_t loopres_162244;
                            int64_t loopres_162245;
                            
                            if (cond_162226) {
                                bool x_162647 = sle64((int64_t) 0, i_162221);
                                bool y_162648 = slt64(i_162221, j_m_i_162190);
                                bool bounds_check_162649 = x_162647 && y_162648;
                                bool index_certs_162650;
                                
                                if (!bounds_check_162649) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_162221, "] out of bounds for array of shape [", (long long) j_m_i_162190, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:106:17-21\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t tmp_162646 = add64((int64_t) 1, i_162221);
                                int64_t slice_162651 = defunc_0_f_res_162166 + i_162221;
                                int64_t slice_162652 = start_161985 + slice_162651;
                                int16_t tmp_162653 = ((int16_t *) mem_param_171900.mem)[slice_162652];
                                int64_t tmp_162654 = ((int64_t *) mem_param_171903.mem)[slice_162652];
                                
                                loopres_162243 = tmp_162646;
                                loopres_162244 = tmp_162653;
                                loopres_162245 = tmp_162654;
                            } else {
                                bool x_162255 = sle64((int64_t) 0, j_162224);
                                bool y_162256 = slt64(j_162224, j_m_i_162177);
                                bool bounds_check_162257 = x_162255 && y_162256;
                                bool index_certs_162258;
                                
                                if (!bounds_check_162257) {
                                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) j_162224, "] out of bounds for array of shape [", (long long) j_m_i_162177, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:108:15-19\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:153:59-69\n   #2  /prelude/soacs.fut:59:9-11\n   #3  /prelude/array.fut:241:11-17\n   #4  lib/github.com/diku-dk/sorts/merge_sort.fut:260:43-59\n   #5  /prelude/soacs.fut:59:9-11\n   #6  /prelude/array.fut:241:11-17\n   #7  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #8  /prelude/functional.fut:9:44-45\n   #9  ftSMJ.fut:104:60-63\n   #10 ftRelational.fut:117:32-36\n   #11 ftRelational.fut:114:5-117:36\n"));
                                    err = FUTHARK_PROGRAM_ERROR;
                                    goto cleanup;
                                }
                                
                                int64_t slice_162259 = merge_sequential_arg2_162175 + j_162224;
                                int64_t slice_162260 = start_161985 + slice_162259;
                                int16_t tmp_162261 = ((int16_t *) mem_param_171900.mem)[slice_162260];
                                int64_t tmp_162262 = ((int64_t *) mem_param_171903.mem)[slice_162260];
                                
                                loopres_162243 = i_162221;
                                loopres_162244 = tmp_162261;
                                loopres_162245 = tmp_162262;
                            }
                            ((int16_t *) mem_171936)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162244;
                            ((int64_t *) mem_171939)[i_171573 * merge_block_sizze_161798 + k_162220] = loopres_162245;
                            
                            int64_t i_tmp_172544 = loopres_162243;
                            
                            i_162221 = i_tmp_172544;
                        }
                        data_162217 = i_162221;
                    }
                    if (memblock_alloc(ctx, &mem_171974, bytes_171935, "mem_171974")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_2b(ctx, 2, (uint16_t *) mem_171974.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint16_t *) mem_171936, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_alloc(ctx, &mem_171978, bytes_171938, "mem_171978")) {
                        err = 1;
                        goto cleanup;
                    }
                    lmad_copy_8b(ctx, 2, (uint64_t *) mem_171978.mem, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (uint64_t *) mem_171939, (int64_t) 0, (int64_t []) {merge_block_sizze_161798, (int64_t) 1}, (int64_t []) {num_blocks_161933, merge_block_sizze_161798});
                    if (memblock_set(ctx, &ext_mem_172001, &mem_171974, "mem_171974") != 0)
                        return 1;
                    if (memblock_set(ctx, &ext_mem_171998, &mem_171978, "mem_171978") != 0)
                        return 1;
                }
                lmad_copy_2b(ctx, 1, (uint16_t *) mem_171906, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_172001.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
                    return 1;
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171909, i_171580 * next_stride_161913, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171998.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {next_stride_161913});
                if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
                    return 1;
            }
            
            int64_t flat_dim_162269 = next_stride_161913 * num_merges_161917;
            
            if (memblock_alloc(ctx, &mem_172012, bytes_171905, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_2b(ctx, 2, (uint16_t *) mem_172012.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint16_t *) mem_171906, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            if (memblock_alloc(ctx, &mem_172016, bytes_171908, "mem_172016")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 2, (uint64_t *) mem_172016.mem, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (uint64_t *) mem_171909, (int64_t) 0, (int64_t []) {next_stride_161913, (int64_t) 1}, (int64_t []) {num_merges_161917, next_stride_161913});
            
            bool loop_cond_162272 = slt64(next_stride_161913, flat_dim_161794);
            
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_172016, "mem_172016") != 0)
                return 1;
            
            int64_t loop_dz2084Uz2082U_tmp_172520 = flat_dim_162269;
            bool loop_while_tmp_172521 = loop_cond_162272;
            int64_t stride_tmp_172524 = next_stride_161913;
            
            if (memblock_set(ctx, &mem_param_171900, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171903, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            loop_dz2084Uz2082U_161908 = loop_dz2084Uz2082U_tmp_172520;
            loop_while_161909 = loop_while_tmp_172521;
            stride_161912 = stride_tmp_172524;
        }
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172022, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        data_161903 = loop_dz2084Uz2082U_161908;
        data_161904 = loop_while_161909;
        data_161907 = stride_161912;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        
        bool empty_slice_162273 = n_89389 == (int64_t) 0;
        bool zzero_leq_i_p_m_t_s_162274 = sle64((int64_t) 0, zs_lhs_161778);
        bool i_p_m_t_s_leq_w_162275 = slt64(zs_lhs_161778, data_161903);
        bool y_162276 = zzero_leq_i_p_m_t_s_162274 && i_p_m_t_s_leq_w_162275;
        bool ok_or_empty_162277 = empty_slice_162273 || y_162276;
        bool index_certs_162278;
        
        if (!ok_or_empty_162277) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, ":", (long long) n_89389, "] out of bounds for array of shape [", (long long) data_161903, "].", "-> #0  /prelude/array.fut:46:45-51\n   #1  lib/github.com/diku-dk/sorts/merge_sort.fut:265:3-14\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:272:74-75\n   #3  /prelude/functional.fut:9:44-45\n   #4  ftSMJ.fut:104:60-63\n   #5  ftRelational.fut:117:32-36\n   #6  ftRelational.fut:114:5-117:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        if (memblock_set(ctx, &ext_mem_172026, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
    }
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_172028, bytes_172027, "mem_172028")) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_172030, bytes_172029, "mem_172030")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171587 = 0; i_171587 < n_89389; i_171587++) {
        int64_t eta_p_162286 = ((int64_t *) ext_mem_172026.mem)[i_171587];
        bool x_162287 = sle64((int64_t) 0, eta_p_162286);
        bool y_162288 = slt64(eta_p_162286, n_89389);
        bool bounds_check_162289 = x_162287 && y_162288;
        bool index_certs_162290;
        
        if (!bounds_check_162289) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162286, "] out of bounds for array of shape [", (long long) n_89389, "].", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:277:24-28\n   #1  /prelude/functional.fut:9:44-45\n   #2  lib/github.com/diku-dk/sorts/merge_sort.fut:277:8-29\n   #3  ftSMJ.fut:104:60-63\n   #4  ftRelational.fut:117:32-36\n   #5  ftRelational.fut:114:5-117:36\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int16_t lifted_lambda_res_162291 = ((int16_t *) k_mem_171818.mem)[eta_p_162286];
        
        ((int16_t *) mem_172028.mem)[i_171587] = lifted_lambda_res_162291;
        lmad_copy_1b(ctx, 1, (uint8_t *) mem_172030.mem, i_171587 * b_89390, (int64_t []) {(int64_t) 1}, (uint8_t *) pL_mem_171819.mem, eta_p_162286 * b_89390, (int64_t []) {(int64_t) 1}, (int64_t []) {b_89390});
    }
    if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_172028, "mem_172028") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_172030, "mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_172999, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173000, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171824);
        free(mem_171827);
        free(mem_171837);
        free(mem_171839);
        free(mem_171906);
        free(mem_171909);
        free(mem_171919);
        free(mem_171921);
        free(mem_171936);
        free(mem_171939);
        if (memblock_unref(ctx, &mem_172030, "mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172028, "mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172016, "mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171978, "mem_171978") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171974, "mem_171974") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171983, "mem_171983") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171981, "mem_171981") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171998, "ext_mem_171998") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172001, "ext_mem_172001") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171903, "mem_param_171903") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171900, "mem_param_171900") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172022, "ext_mem_172022") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171896, "mem_171896") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171892, "mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_min_idx(struct futhark_context *ctx, int64_t *out_prim_out_173011, struct memblock eta_p_mem_171818, int64_t nz2080U_80067)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_res_162514;
    int64_t redout_171545 = (int64_t) 9223372036854775807;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_80067; i_171546++) {
        int64_t x_153358 = ((int64_t *) eta_p_mem_171818.mem)[i_171546];
        int64_t min_res_153361 = smin64(x_153358, redout_171545);
        int64_t redout_tmp_172501 = min_res_153361;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173011 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_minimum_double(struct futhark_context *ctx, double *out_prim_out_173012, struct memblock eta_p_mem_171818, int64_t nz2080U_80024)
{
    (void) ctx;
    
    int err = 0;
    double prim_out_172500;
    double defunc_0_reduce_res_162514;
    double redout_171545 = INFINITY;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_80024; i_171546++) {
        double x_153241 = ((double *) eta_p_mem_171818.mem)[i_171546];
        double min_res_153244 = fmin64(x_153241, redout_171545);
        double redout_tmp_172501 = min_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173012 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_minimum_float(struct futhark_context *ctx, float *out_prim_out_173013, struct memblock eta_p_mem_171818, int64_t nz2080U_79956)
{
    (void) ctx;
    
    int err = 0;
    float prim_out_172500;
    float defunc_0_reduce_res_162514;
    float redout_171545 = INFINITY;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79956; i_171546++) {
        float x_153241 = ((float *) eta_p_mem_171818.mem)[i_171546];
        float min_res_153244 = fmin32(x_153241, redout_171545);
        float redout_tmp_172501 = min_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173013 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_minimum_int(struct futhark_context *ctx, int32_t *out_prim_out_173014, struct memblock eta_p_mem_171818, int64_t nz2080U_79814)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_172500;
    int32_t defunc_0_reduce_res_162514;
    int32_t redout_171545 = 2147483647;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79814; i_171546++) {
        int32_t x_153241 = ((int32_t *) eta_p_mem_171818.mem)[i_171546];
        int32_t min_res_153244 = smin32(x_153241, redout_171545);
        int32_t redout_tmp_172501 = min_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173014 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_minimum_long(struct futhark_context *ctx, int64_t *out_prim_out_173015, struct memblock eta_p_mem_171818, int64_t nz2080U_79885)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t defunc_0_reduce_res_162514;
    int64_t redout_171545 = (int64_t) 9223372036854775807;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79885; i_171546++) {
        int64_t x_153241 = ((int64_t *) eta_p_mem_171818.mem)[i_171546];
        int64_t min_res_153244 = smin64(x_153241, redout_171545);
        int64_t redout_tmp_172501 = min_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173015 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_minimum_short(struct futhark_context *ctx, int16_t *out_prim_out_173016, struct memblock eta_p_mem_171818, int64_t nz2080U_79743)
{
    (void) ctx;
    
    int err = 0;
    int16_t prim_out_172500;
    int16_t defunc_0_reduce_res_162514;
    int16_t redout_171545 = (int16_t) 32767;
    
    for (int64_t i_171546 = 0; i_171546 < nz2080U_79743; i_171546++) {
        int16_t x_153241 = ((int16_t *) eta_p_mem_171818.mem)[i_171546];
        int16_t min_res_153244 = smin16(x_153241, redout_171545);
        int16_t redout_tmp_172501 = min_res_153244;
        
        redout_171545 = redout_tmp_172501;
    }
    defunc_0_reduce_res_162514 = redout_171545;
    prim_out_172500 = defunc_0_reduce_res_162514;
    *out_prim_out_173016 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_double(struct futhark_context *ctx, struct memblock *mem_out_p_173017, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_81338, int64_t incr_81339, int64_t block_sizze_81340)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_173018 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_81338;
    
    if (mem_171821_cached_sizze_173018 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_173018, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < n_81338; i_171547++) {
        int64_t eta_p_153529 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153530 = sub64(eta_p_153529, incr_81339);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153530;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171820, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_81338; nest_i_172502++) {
        ((double *) mem_171829.mem)[nest_i_172502] = 0.0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_81338});
    if (futrts_partitioned_gather_over_array_15667(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, n_81338, n_81338, 64, block_sizze_81340) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173017, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_float(struct futhark_context *ctx, struct memblock *mem_out_p_173019, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_81086, int64_t incr_81087, int64_t block_sizze_81088)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_173020 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_81086;
    int64_t bytes_171828 = (int64_t) 4 * n_81086;
    
    if (mem_171821_cached_sizze_173020 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_173020, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < n_81086; i_171547++) {
        int64_t eta_p_153529 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153530 = sub64(eta_p_153529, incr_81087);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153530;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_81086; nest_i_172502++) {
        ((float *) mem_171829.mem)[nest_i_172502] = 0.0F;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_81086});
    if (futrts_partitioned_gather_over_array_15655(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, n_81086, n_81086, 32, block_sizze_81088) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173019, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_int(struct futhark_context *ctx, struct memblock *mem_out_p_173021, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80582, int64_t incr_80583, int64_t block_sizze_80584)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_173022 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_80582;
    int64_t bytes_171828 = (int64_t) 4 * n_80582;
    
    if (mem_171821_cached_sizze_173022 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_173022, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < n_80582; i_171547++) {
        int64_t eta_p_153529 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153530 = sub64(eta_p_153529, incr_80583);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153530;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_80582; nest_i_172502++) {
        ((int32_t *) mem_171829.mem)[nest_i_172502] = 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80582});
    if (futrts_partitioned_gather_over_array_15632(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, n_80582, n_80582, 32, block_sizze_80584) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173021, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_long(struct futhark_context *ctx, struct memblock *mem_out_p_173023, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80834, int64_t incr_80835, int64_t block_sizze_80836)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_173024 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_80834;
    
    if (mem_171821_cached_sizze_173024 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_173024, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < n_80834; i_171547++) {
        int64_t eta_p_153529 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153530 = sub64(eta_p_153529, incr_80835);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153530;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171820, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_80834; nest_i_172502++) {
        ((int64_t *) mem_171829.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80834});
    if (futrts_partitioned_gather_over_array_15643(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, n_80834, n_80834, 64, block_sizze_80836) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173023, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_orderByIndices_short(struct futhark_context *ctx, struct memblock *mem_out_p_173025, struct memblock is_mem_171818, struct memblock ys_mem_171819, int64_t n_80330, int64_t incr_80331, int64_t block_sizze_80332)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171821_cached_sizze_173026 = 0;
    unsigned char *mem_171821 = NULL;
    struct memblock ext_mem_171833;
    
    ext_mem_171833.references = NULL;
    
    struct memblock mem_171831;
    
    mem_171831.references = NULL;
    
    struct memblock mem_171829;
    
    mem_171829.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_80330;
    int64_t bytes_171828 = (int64_t) 2 * n_80330;
    
    if (mem_171821_cached_sizze_173026 < bytes_171820) {
        err = lexical_realloc(ctx, &mem_171821, &mem_171821_cached_sizze_173026, bytes_171820);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_171547 = 0; i_171547 < n_80330; i_171547++) {
        int64_t eta_p_153529 = ((int64_t *) is_mem_171818.mem)[i_171547];
        int64_t lifted_lambda_res_153530 = sub64(eta_p_153529, incr_80331);
        
        ((int64_t *) mem_171821)[i_171547] = lifted_lambda_res_153530;
    }
    if (memblock_alloc(ctx, &mem_171829, bytes_171828, "mem_171829")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_80330; nest_i_172502++) {
        ((int16_t *) mem_171829.mem)[nest_i_172502] = (int16_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171831, bytes_171820, "mem_171831")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171831.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171821, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_80330});
    if (futrts_partitioned_gather_over_array_15620(ctx, &ext_mem_171833, mem_171829, ys_mem_171819, mem_171831, n_80330, n_80330, 16, block_sizze_80332) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171833, "ext_mem_171833") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173025, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171821);
        if (memblock_unref(ctx, &ext_mem_171833, "ext_mem_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171831, "mem_171831") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171829, "mem_171829") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct memblock *mem_out_p_173027, struct memblock *mem_out_p_173028, struct memblock xs_mem_171818, struct memblock pL_mem_171819, int64_t n_130036, int64_t b_130037, int64_t pL_b_130038, int16_t block_sizze_130039, int64_t gather_psizze_130040, int32_t radix_sizze_130041, int64_t sizze_thresh_130044, int32_t max_depth_130045, int32_t bit_step_130046)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171865_cached_sizze_173029 = 0;
    unsigned char *mem_171865 = NULL;
    int64_t mem_171899_cached_sizze_173030 = 0;
    unsigned char *mem_171899 = NULL;
    int64_t mem_171901_cached_sizze_173031 = 0;
    unsigned char *mem_171901 = NULL;
    int64_t mem_171910_cached_sizze_173032 = 0;
    unsigned char *mem_171910 = NULL;
    int64_t mem_171911_cached_sizze_173033 = 0;
    unsigned char *mem_171911 = NULL;
    int64_t mem_171942_cached_sizze_173034 = 0;
    unsigned char *mem_171942 = NULL;
    int64_t mem_171944_cached_sizze_173035 = 0;
    unsigned char *mem_171944 = NULL;
    int64_t mem_171946_cached_sizze_173036 = 0;
    unsigned char *mem_171946 = NULL;
    int64_t mem_171948_cached_sizze_173037 = 0;
    unsigned char *mem_171948 = NULL;
    int64_t mem_171974_cached_sizze_173038 = 0;
    unsigned char *mem_171974 = NULL;
    int64_t mem_171976_cached_sizze_173039 = 0;
    unsigned char *mem_171976 = NULL;
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_param_tmp_172505;
    
    mem_param_tmp_172505.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_param_tmp_172517;
    
    mem_param_tmp_172517.references = NULL;
    
    struct memblock mem_param_tmp_172516;
    
    mem_param_tmp_172516.references = NULL;
    
    struct memblock mem_param_tmp_172515;
    
    mem_param_tmp_172515.references = NULL;
    
    struct memblock mem_172012;
    
    mem_172012.references = NULL;
    
    struct memblock mem_172010;
    
    mem_172010.references = NULL;
    
    struct memblock mem_171992;
    
    mem_171992.references = NULL;
    
    struct memblock mem_171990;
    
    mem_171990.references = NULL;
    
    struct memblock ext_mem_171939;
    
    ext_mem_171939.references = NULL;
    
    struct memblock ext_mem_171940;
    
    ext_mem_171940.references = NULL;
    
    struct memblock mem_171937;
    
    mem_171937.references = NULL;
    
    struct memblock mem_param_tmp_172526;
    
    mem_param_tmp_172526.references = NULL;
    
    struct memblock mem_param_tmp_172525;
    
    mem_param_tmp_172525.references = NULL;
    
    struct memblock mem_171889;
    
    mem_171889.references = NULL;
    
    struct memblock mem_171887;
    
    mem_171887.references = NULL;
    
    struct memblock mem_param_tmp_172533;
    
    mem_param_tmp_172533.references = NULL;
    
    struct memblock mem_171876;
    
    mem_171876.references = NULL;
    
    struct memblock mem_param_171874;
    
    mem_param_171874.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock mem_param_171860;
    
    mem_param_171860.references = NULL;
    
    struct memblock mem_param_171856;
    
    mem_param_171856.references = NULL;
    
    struct memblock ext_mem_171934;
    
    ext_mem_171934.references = NULL;
    
    struct memblock ext_mem_171935;
    
    ext_mem_171935.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_param_171850;
    
    mem_param_171850.references = NULL;
    
    struct memblock mem_param_171846;
    
    mem_param_171846.references = NULL;
    
    struct memblock mem_param_171842;
    
    mem_param_171842.references = NULL;
    
    struct memblock mem_param_171839;
    
    mem_param_171839.references = NULL;
    
    struct memblock ext_mem_172023;
    
    ext_mem_172023.references = NULL;
    
    struct memblock ext_mem_172024;
    
    ext_mem_172024.references = NULL;
    
    struct memblock ext_mem_172025;
    
    ext_mem_172025.references = NULL;
    
    struct memblock ext_mem_172026;
    
    ext_mem_172026.references = NULL;
    
    struct memblock mem_param_171836;
    
    mem_param_171836.references = NULL;
    
    struct memblock mem_param_171833;
    
    mem_param_171833.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171826;
    
    mem_param_171826.references = NULL;
    
    struct memblock ext_mem_172037;
    
    ext_mem_172037.references = NULL;
    
    struct memblock ext_mem_172038;
    
    ext_mem_172038.references = NULL;
    
    struct memblock ext_mem_172039;
    
    ext_mem_172039.references = NULL;
    
    struct memblock ext_mem_172040;
    
    ext_mem_172040.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    if (memblock_alloc(ctx, &mem_171820, (int64_t) 8, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < (int64_t) 1; nest_i_172502++) {
        ((int64_t *) mem_171820.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171821, (int64_t) 8, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172503 = 0; nest_i_172503 < (int64_t) 1; nest_i_172503++) {
        ((int64_t *) mem_171821.mem)[nest_i_172503] = n_130036;
    }
    
    bool loop_cond_t_res_154948 = slt32(0, max_depth_130045);
    
    if (memblock_alloc(ctx, &mem_171822, (int64_t) 0, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_154999 = sext_i64_i32(b_130037);
    int32_t zm_lhs_155000 = mul32(8, i64_res_154999);
    int32_t min_arg1_155001 = sub32(zm_lhs_155000, 1);
    int32_t s_sign_155008 = (bit_step_130046 > 0 ? 1 : 0) - (bit_step_130046 < 0 ? 1 : 0);
    int64_t s_sign_155009 = sext_i32_i64(s_sign_155008);
    bool downwards_155012 = s_sign_155008 == -1;
    bool x_155016 = !downwards_155012;
    int64_t subtracted_step_155025 = sext_i32_i64(bit_step_130046);
    int64_t pos_step_155026 = mul64(s_sign_155009, subtracted_step_155025);
    int32_t zm_lhs_155030 = add32(8, zm_lhs_155000);
    int32_t zs_lhs_155031 = sub32(zm_lhs_155030, 1);
    int32_t i32_arg0_155032 = sdiv32(zs_lhs_155031, 8);
    int64_t i32_res_155033 = sext_i32_i64(i32_arg0_155032);
    bool zzero_155034 = i32_res_155033 == (int64_t) 0;
    bool nonzzero_155035 = !zzero_155034;
    int64_t bytes_171989 = n_130036 * b_130037;
    int64_t bytes_171991 = n_130036 * pL_b_130038;
    
    if (mem_171910_cached_sizze_173032 < b_130037) {
        err = lexical_realloc(ctx, &mem_171910, &mem_171910_cached_sizze_173032, b_130037);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171911_cached_sizze_173033 < pL_b_130038) {
        err = lexical_realloc(ctx, &mem_171911, &mem_171911_cached_sizze_173033, pL_b_130038);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_154950;
    bool partition_and_deepen_res_154951;
    int32_t partition_and_deepen_res_154952;
    int64_t loop_dz2087U_154957;
    bool loop_while_154958;
    int32_t p_154959;
    
    if (memblock_set(ctx, &mem_param_171826, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171833, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171836, &mem_171821, "mem_171821") != 0)
        return 1;
    loop_dz2087U_154957 = (int64_t) 1;
    loop_while_154958 = loop_cond_t_res_154948;
    p_154959 = 0;
    while (loop_while_154958) {
        bool loop_nonempty_162311 = slt64((int64_t) 0, loop_dz2087U_154957);
        int32_t newDepth_154995 = add32(1, p_154959);
        int32_t new_i_154996 = mul32(radix_sizze_130041, p_154959);
        int32_t zm_lhs_154997 = mul32(radix_sizze_130041, newDepth_154995);
        int32_t new_j_154998 = sub32(zm_lhs_154997, 1);
        int32_t min_res_155002 = smin32(new_j_154998, min_arg1_155001);
        int32_t tmp_155003 = add32(bit_step_130046, new_i_154996);
        int64_t i_155004 = sext_i32_i64(new_i_154996);
        int64_t j__155005 = sext_i32_i64(min_res_155002);
        int64_t tmp_155006 = sext_i32_i64(tmp_155003);
        bool step_zzero_155007 = new_i_154996 == tmp_155003;
        bool bounds_invalid_downwards_155010 = slt32(new_i_154996, min_res_155002);
        bool bounds_invalid_upwards_155011 = slt32(min_res_155002, new_i_154996);
        int32_t distance_downwards_exclusive_155013 = sub32(new_i_154996, min_res_155002);
        int32_t distance_upwards_exclusive_155014 = sub32(min_res_155002, new_i_154996);
        bool x_155015 = bounds_invalid_downwards_155010 && downwards_155012;
        bool y_155017 = bounds_invalid_upwards_155011 && x_155016;
        bool bounds_invalid_155018 = x_155015 || y_155017;
        int32_t distance_exclusive_155019;
        
        if (downwards_155012) {
            distance_exclusive_155019 = distance_downwards_exclusive_155013;
        } else {
            distance_exclusive_155019 = distance_upwards_exclusive_155014;
        }
        
        int64_t distance_exclusive_155020 = sext_i32_i64(distance_exclusive_155019);
        int64_t distance_155021 = add64((int64_t) 1, distance_exclusive_155020);
        bool range_invalid_155022 = step_zzero_155007 || bounds_invalid_155018;
        bool valid_155023 = !range_invalid_155022;
        bool loop_not_taken_162312 = !loop_nonempty_162311;
        bool protect_assert_disj_162313 = valid_155023 || loop_not_taken_162312;
        bool range_valid_c_155024;
        
        if (!protect_assert_disj_162313) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_155004, "..", (long long) tmp_155006, "...", (long long) j__155005, " is invalid.", "-> #0  ftHashJoin.fut:224:17-39\n   #1  ftHashJoin.fut:267:22-273:15\n   #2  ftRelational.fut:232:7-99\n   #3  ftRelational.fut:221:3-233:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_155027 = sdiv_up_safe64(distance_155021, pos_step_155026);
        bool loop_nonempty_155028 = slt64((int64_t) 0, num_elems_155027);
        bool loop_not_taken_155036 = !loop_nonempty_155028;
        bool protect_assert_disj_155037 = nonzzero_155035 || loop_not_taken_155036;
        bool protect_assert_disj_162315 = protect_assert_disj_155037 || loop_not_taken_162312;
        bool nonzzero_cert_155038;
        
        if (!protect_assert_disj_162315) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:221:3-233:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155039 = sdiv_safe64(gather_psizze_130040, i32_res_155033);
        bool zzero_155042 = psizze__155039 == (int64_t) 0;
        bool nonzzero_155043 = !zzero_155042;
        bool protect_assert_disj_155044 = loop_not_taken_155036 || nonzzero_155043;
        bool protect_assert_disj_162317 = protect_assert_disj_155044 || loop_not_taken_162312;
        bool nonzzero_cert_155045;
        
        if (!protect_assert_disj_162317) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:221:3-233:32\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_154964;
        int64_t loop_dz2081Uz2089U_154970;
        
        if (memblock_set(ctx, &mem_param_171839, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171842, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171846, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171850, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        loop_dz2081Uz2089U_154970 = (int64_t) 0;
        for (int64_t i_154969 = 0; i_154969 < loop_dz2087U_154957; i_154969++) {
            int64_t bounds_154975 = ((int64_t *) mem_param_171833.mem)[i_154969];
            int64_t bounds_154976 = ((int64_t *) mem_param_171836.mem)[i_154969];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977 = sub64(bounds_154976, bounds_154975);
            bool empty_slice_154978 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977 == (int64_t) 0;
            int64_t m_154979 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, (int64_t) 1);
            int64_t i_p_m_t_s_154980 = add64(bounds_154975, m_154979);
            bool zzero_leq_i_p_m_t_s_154981 = sle64((int64_t) 0, i_p_m_t_s_154980);
            bool i_p_m_t_s_leq_w_154982 = slt64(i_p_m_t_s_154980, n_130036);
            bool zzero_lte_i_154983 = sle64((int64_t) 0, bounds_154975);
            bool i_lte_j_154984 = sle64(bounds_154975, bounds_154976);
            bool y_154985 = i_p_m_t_s_leq_w_154982 && zzero_lte_i_154983;
            bool y_154986 = zzero_leq_i_p_m_t_s_154981 && y_154985;
            bool forwards_ok_154987 = i_lte_j_154984 && y_154986;
            bool ok_or_empty_154988 = empty_slice_154978 || forwards_ok_154987;
            bool index_certs_154989;
            
            if (!ok_or_empty_154988) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_154975, ":", (long long) bounds_154976, "] out of bounds for array of shape [", (long long) n_130036, "].", "-> #0  ftHashJoin.fut:301:23-49\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:221:3-233:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171851 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977;
            
            if (memblock_alloc(ctx, &mem_171852, bytes_171851, "mem_171852")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172524 = 0; nest_i_172524 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977; nest_i_172524++) {
                ((int64_t *) mem_171852.mem)[nest_i_172524] = (int64_t) 0;
            }
            
            int64_t zm_lhs_155040 = add64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, psizze__155039);
            int64_t zs_lhs_155041 = sub64(zm_lhs_155040, (int64_t) 1);
            int64_t max_iter_155046 = sdiv_safe64(zs_lhs_155041, psizze__155039);
            bool bounds_invalid_upwards_155047 = slt64(max_iter_155046, (int64_t) 0);
            bool valid_155048 = !bounds_invalid_upwards_155047;
            bool protect_assert_disj_155049 = loop_not_taken_155036 || valid_155048;
            bool range_valid_c_155050;
            
            if (!protect_assert_disj_155049) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155046, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftHashJoin.fut:211:85-88\n   #3  ftHashJoin.fut:225:8-73\n   #4  ftHashJoin.fut:267:22-273:15\n   #5  ftRelational.fut:232:7-99\n   #6  ftRelational.fut:221:3-233:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_y_171861 = b_130037 * bounds_154975;
            int64_t binop_y_171863 = pL_b_130038 * bounds_154975;
            int64_t bytes_171886 = b_130037 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977;
            int64_t bytes_171888 = pL_b_130038 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977;
            
            if (mem_171865_cached_sizze_173029 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977) {
                err = lexical_realloc(ctx, &mem_171865, &mem_171865_cached_sizze_173029, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_171933;
            int64_t ext_171930;
            int64_t ctx_param_ext_171853;
            int64_t ctx_param_ext_171857;
            
            if (memblock_set(ctx, &mem_param_171856, &mem_param_171850, "mem_param_171850") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171860, &mem_param_171846, "mem_param_171846") != 0)
                return 1;
            ctx_param_ext_171853 = binop_y_171861;
            ctx_param_ext_171857 = binop_y_171863;
            for (int64_t i_155053 = 0; i_155053 < num_elems_155027; i_155053++) {
                int32_t binop_x_155056 = sext_i64_i32(i_155053);
                int32_t binop_x_155057 = mul32(bit_step_130046, binop_x_155056);
                int32_t index_primexp_155058 = add32(new_i_154996, binop_x_155057);
                int32_t zm_lhs_155059 = add32(bit_step_130046, index_primexp_155058);
                int32_t min_arg1_155060 = sub32(zm_lhs_155059, 1);
                int32_t min_res_155061 = smin32(min_res_155002, min_arg1_155060);
                int32_t zp_lhs_155062 = sub32(min_res_155061, index_primexp_155058);
                int32_t ij_bits_155063 = add32(1, zp_lhs_155062);
                int32_t up_to_155064 = shl32(1, ij_bits_155063);
                int64_t tmp_155065 = sext_i32_i64(zp_lhs_155062);
                bool bounds_invalid_upwards_155066 = slt32(zp_lhs_155062, 0);
                bool valid_155068 = !bounds_invalid_upwards_155066;
                bool range_valid_c_155069;
                
                if (!valid_155068) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155065, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:211:85-88\n   #3  ftHashJoin.fut:225:8-73\n   #4  ftHashJoin.fut:267:22-273:15\n   #5  ftRelational.fut:232:7-99\n   #6  ftRelational.fut:221:3-233:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_155079 = sext_i32_i64(up_to_155064);
                bool bounds_invalid_upwards_155080 = slt32(up_to_155064, 0);
                bool valid_155081 = !bounds_invalid_upwards_155080;
                bool range_valid_c_155082;
                
                if (!valid_155081) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_155079, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:221:3-233:32\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_155067 = add64((int64_t) 1, tmp_155065);
                
                for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977; i_171547++) {
                    int8_t defunc_0_f_res_155072;
                    int8_t y_155074 = (int8_t) 0;
                    
                    for (int64_t i_155073 = 0; i_155073 < distance_155067; i_155073++) {
                        int32_t binop_x_155075 = sext_i64_i32(i_155073);
                        int32_t get_bit_arg0_155076 = add32(index_primexp_155058, binop_x_155075);
                        int32_t zm_rhs_162484 = sdiv32(get_bit_arg0_155076, 8);
                        int32_t zm_lhs_162485 = sub32(i64_res_154999, zm_rhs_162484);
                        int32_t whichByte_162486 = sub32(zm_lhs_162485, 1);
                        int64_t whichByte_162488 = sext_i32_i64(whichByte_162486);
                        bool x_162489 = sle64((int64_t) 0, whichByte_162488);
                        bool y_162490 = slt64(whichByte_162488, b_130037);
                        bool bounds_check_162491 = x_162489 && y_162490;
                        bool index_certs_162492;
                        
                        if (!bounds_check_162491) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_162488, "] out of bounds for array of shape [", (long long) b_130037, "].", "-> #0  ftHashJoin.fut:19:8-20\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:221:3-233:32\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_162487 = smod32(get_bit_arg0_155076, 8);
                        int8_t zbzg_lhs_162493 = ((int8_t *) mem_param_171856.mem)[ctx_param_ext_171853 + (i_171547 * b_130037 + whichByte_162488)];
                        int8_t unsign_arg0_162494 = zext_i32_i8(whichBit_162487);
                        int8_t unsign_arg0_162495 = ashr8(zbzg_lhs_162493, unsign_arg0_162494);
                        int8_t unsign_arg0_162496 = (int8_t) 1 & unsign_arg0_162495;
                        int32_t to_i32_res_162497 = zext_i8_i32(unsign_arg0_162496);
                        int8_t loopres_155078;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_155078, binop_x_155075, y_155074, to_i32_res_162497) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_172532 = loopres_155078;
                        
                        y_155074 = y_tmp_172532;
                    }
                    defunc_0_f_res_155072 = y_155074;
                    ((int8_t *) mem_171865)[i_171547] = defunc_0_f_res_155072;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_155083;
                int64_t offs_155086;
                
                if (memblock_set(ctx, &mem_param_171874, &mem_171852, "mem_171852") != 0)
                    return 1;
                offs_155086 = (int64_t) 0;
                for (int64_t i_155085 = 0; i_155085 < up_to_155079; i_155085++) {
                    int32_t binop_x_155088 = sext_i64_i32(i_155085);
                    int8_t index_primexp_155089 = zext_i32_i8(binop_x_155088);
                    
                    if (memblock_alloc(ctx, &mem_171876, bytes_171851, "mem_171876")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_162918;
                    int64_t defunc_0_reduce_res_162919;
                    int64_t inpacc_162748;
                    int64_t inpacc_162749;
                    
                    inpacc_162748 = (int64_t) 0;
                    inpacc_162749 = (int64_t) 0;
                    for (int64_t i_171565 = 0; i_171565 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977; i_171565++) {
                        int8_t eta_p_171796 = ((int8_t *) mem_171865)[i_171565];
                        bool lifted_lambda_res_171797 = eta_p_171796 == index_primexp_155089;
                        int64_t bool_res_171798 = btoi_bool_i64(lifted_lambda_res_171797);
                        int64_t eta_p_171811 = ((int64_t *) mem_param_171874.mem)[i_171565];
                        int64_t defunc_0_op_res_171812 = add64(inpacc_162748, bool_res_171798);
                        int64_t zm_lhs_171813 = add64(offs_155086, defunc_0_op_res_171812);
                        int64_t lifted_lambda_res_171814 = sub64(zm_lhs_171813, (int64_t) 1);
                        int64_t defunc_0_f_res_171815 = mul64(bool_res_171798, lifted_lambda_res_171814);
                        int64_t defunc_0_f_res_171816 = add64(eta_p_171811, defunc_0_f_res_171815);
                        int64_t defunc_0_op_res_162797 = add64(inpacc_162749, bool_res_171798);
                        
                        ((int64_t *) mem_171876.mem)[i_171565] = defunc_0_f_res_171816;
                        
                        int64_t inpacc_tmp_172536 = defunc_0_op_res_171812;
                        int64_t inpacc_tmp_172537 = defunc_0_op_res_162797;
                        
                        inpacc_162748 = inpacc_tmp_172536;
                        inpacc_162749 = inpacc_tmp_172537;
                    }
                    inpacc_162918 = inpacc_162748;
                    defunc_0_reduce_res_162919 = inpacc_162749;
                    
                    int64_t tmp_155114 = add64(offs_155086, defunc_0_reduce_res_162919);
                    
                    if (memblock_set(ctx, &mem_param_tmp_172533, &mem_171876, "mem_171876") != 0)
                        return 1;
                    
                    int64_t offs_tmp_172534 = tmp_155114;
                    
                    if (memblock_set(ctx, &mem_param_171874, &mem_param_tmp_172533, "mem_param_tmp_172533") != 0)
                        return 1;
                    offs_155086 = offs_tmp_172534;
                }
                if (memblock_set(ctx, &ext_mem_171885, &mem_param_171874, "mem_param_171874") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_155083 = offs_155086;
                if (memblock_alloc(ctx, &mem_171887, bytes_171886, "mem_171887")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171887.mem, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) mem_param_171856.mem, ctx_param_ext_171853, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, b_130037});
                if (memblock_alloc(ctx, &mem_171889, bytes_171888, "mem_171889")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171889.mem, (int64_t) 0, (int64_t []) {pL_b_130038, (int64_t) 1}, (uint8_t *) mem_param_171860.mem, ctx_param_ext_171857, (int64_t []) {pL_b_130038, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, pL_b_130038});
                for (int64_t i_155123 = 0; i_155123 < max_iter_155046; i_155123++) {
                    int64_t inf_155126 = mul64(psizze__155039, i_155123);
                    int64_t min_arg1_155127 = add64(psizze__155039, inf_155126);
                    int64_t min_res_155128 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, min_arg1_155127);
                    bool zzero_lte_i_155138 = sle64((int64_t) 0, inf_155126);
                    int64_t j_m_i_155132 = sub64(min_res_155128, inf_155126);
                    int64_t m_155134 = sub64(j_m_i_155132, (int64_t) 1);
                    int64_t i_p_m_t_s_155135 = add64(inf_155126, m_155134);
                    bool i_p_m_t_s_leq_w_155137 = slt64(i_p_m_t_s_155135, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977);
                    bool y_155140 = i_p_m_t_s_leq_w_155137 && zzero_lte_i_155138;
                    bool zzero_leq_i_p_m_t_s_155136 = sle64((int64_t) 0, i_p_m_t_s_155135);
                    bool y_155141 = zzero_leq_i_p_m_t_s_155136 && y_155140;
                    bool i_lte_j_155139 = sle64(inf_155126, min_res_155128);
                    bool forwards_ok_155142 = i_lte_j_155139 && y_155141;
                    bool empty_slice_155133 = j_m_i_155132 == (int64_t) 0;
                    bool ok_or_empty_155143 = empty_slice_155133 || forwards_ok_155142;
                    bool index_certs_155144;
                    
                    if (!ok_or_empty_155143) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155126, ":", (long long) min_res_155128, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:232:7-99\n   #5  ftRelational.fut:221:3-233:32\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_171898 = pL_b_130038 * j_m_i_155132;
                    int64_t bytes_171900 = b_130037 * j_m_i_155132;
                    
                    if (mem_171899_cached_sizze_173030 < bytes_171898) {
                        err = lexical_realloc(ctx, &mem_171899, &mem_171899_cached_sizze_173030, bytes_171898);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171899, (int64_t) 0, (int64_t []) {pL_b_130038, (int64_t) 1}, (uint8_t *) mem_171889.mem, (int64_t) 0 + pL_b_130038 * inf_155126, (int64_t []) {pL_b_130038, (int64_t) 1}, (int64_t []) {j_m_i_155132, pL_b_130038});
                    if (mem_171901_cached_sizze_173031 < bytes_171900) {
                        err = lexical_realloc(ctx, &mem_171901, &mem_171901_cached_sizze_173031, bytes_171900);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171901, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) mem_171887.mem, (int64_t) 0 + b_130037 * inf_155126, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {j_m_i_155132, b_130037});
                    for (int64_t write_iter_171567 = 0; write_iter_171567 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977; write_iter_171567++) {
                        int64_t write_iv_171570 = ((int64_t *) ext_mem_171885.mem)[write_iter_171567];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171910, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171856.mem, ctx_param_ext_171853 + write_iter_171567 * b_130037, (int64_t []) {(int64_t) 1}, (int64_t []) {b_130037});
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171911, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171860.mem, ctx_param_ext_171857 + write_iter_171567 * pL_b_130038, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_130038});
                        
                        int64_t lifted_lambda_res_162840 = sub64(write_iv_171570, inf_155126);
                        
                        if ((sle64((int64_t) 0, lifted_lambda_res_162840) && slt64(lifted_lambda_res_162840, j_m_i_155132)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_130037 - (int64_t) 1, b_130037))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171901, lifted_lambda_res_162840 * b_130037, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171910, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_130037});
                        }
                        if ((sle64((int64_t) 0, lifted_lambda_res_162840) && slt64(lifted_lambda_res_162840, j_m_i_155132)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(pL_b_130038 - (int64_t) 1, pL_b_130038))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171899, lifted_lambda_res_162840 * pL_b_130038, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171911, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {pL_b_130038});
                        }
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171887.mem, b_130037 * inf_155126, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) mem_171901, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {j_m_i_155132, b_130037});
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171889.mem, pL_b_130038 * inf_155126, (int64_t []) {pL_b_130038, (int64_t) 1}, (uint8_t *) mem_171899, (int64_t) 0, (int64_t []) {pL_b_130038, (int64_t) 1}, (int64_t []) {j_m_i_155132, pL_b_130038});
                }
                if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172525, &mem_171887, "mem_171887") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172526, &mem_171889, "mem_171889") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_172527 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_172528 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_171856, &mem_param_tmp_172525, "mem_param_tmp_172525") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171860, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
                    return 1;
                ctx_param_ext_171853 = ctx_param_ext_tmp_172527;
                ctx_param_ext_171857 = ctx_param_ext_tmp_172528;
            }
            if (memblock_set(ctx, &ext_mem_171935, &mem_param_171856, "mem_param_171856") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171934, &mem_param_171860, "mem_param_171860") != 0)
                return 1;
            ext_171933 = ctx_param_ext_171853;
            ext_171930 = ctx_param_ext_171857;
            if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171937, bytes_171886, "mem_171937")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171937.mem, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) ext_mem_171935.mem, ext_171933, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, b_130037});
            
            int64_t deepen_step_res_155156;
            int64_t deepen_step_res_155157;
            int32_t deepen_step_res_155160;
            
            if (futrts_getPartitionBounds_16885(ctx, &ext_mem_171940, &ext_mem_171939, &deepen_step_res_155156, &deepen_step_res_155157, &deepen_step_res_155160, mem_171937, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, b_130037, newDepth_154995, new_i_154996, new_j_154998) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171937, "mem_171937") != 0)
                return 1;
            
            int64_t zl_rhs_162327 = sub64(deepen_step_res_155156, (int64_t) 1);
            int64_t bytes_171941 = (int64_t) 8 * deepen_step_res_155156;
            
            if (mem_171942_cached_sizze_173034 < bytes_171941) {
                err = lexical_realloc(ctx, &mem_171942, &mem_171942_cached_sizze_173034, bytes_171941);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171944_cached_sizze_173035 < bytes_171941) {
                err = lexical_realloc(ctx, &mem_171944, &mem_171944_cached_sizze_173035, bytes_171941);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171946_cached_sizze_173036 < bytes_171941) {
                err = lexical_realloc(ctx, &mem_171946, &mem_171946_cached_sizze_173036, bytes_171941);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171948_cached_sizze_173037 < bytes_171941) {
                err = lexical_realloc(ctx, &mem_171948, &mem_171948_cached_sizze_173037, bytes_171941);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171589;
            int64_t scanacc_171579 = (int64_t) 0;
            
            for (int64_t i_171584 = 0; i_171584 < deepen_step_res_155156; i_171584++) {
                int64_t tmp_162537 = ((int64_t *) ext_mem_171940.mem)[i_171584];
                bool cond_162538 = slt64(i_171584, zl_rhs_162327);
                int64_t tmp_162539;
                
                if (cond_162538) {
                    int64_t tmp_162924 = add64((int64_t) 1, i_171584);
                    bool x_162925 = sle64((int64_t) 0, tmp_162924);
                    bool y_162926 = slt64(tmp_162924, deepen_step_res_155156);
                    bool bounds_check_162927 = x_162925 && y_162926;
                    bool index_certs_162928;
                    
                    if (!bounds_check_162927) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162924, "] out of bounds for array of shape [", (long long) deepen_step_res_155156, "].", "-> #0  ftHashJoin.fut:277:69-83\n   #1  ftRelational.fut:232:7-99\n   #2  ftRelational.fut:221:3-233:32\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_162929 = ((int64_t *) ext_mem_171940.mem)[tmp_162924];
                    
                    tmp_162539 = tmp_t_res_162929;
                } else {
                    tmp_162539 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977;
                }
                
                int64_t zg_lhs_162548 = sub64(tmp_162539, tmp_162537);
                bool lifted_lambda_res_162549 = slt64(sizze_thresh_130044, zg_lhs_162548);
                int64_t defunc_0_f_res_162550 = btoi_bool_i64(lifted_lambda_res_162549);
                int64_t defunc_0_op_res_155177 = add64(defunc_0_f_res_162550, scanacc_171579);
                
                ((int64_t *) mem_171942)[i_171584] = defunc_0_op_res_155177;
                ((int64_t *) mem_171944)[i_171584] = defunc_0_f_res_162550;
                ((int64_t *) mem_171946)[i_171584] = tmp_162537;
                ((int64_t *) mem_171948)[i_171584] = tmp_162539;
                
                int64_t scanacc_tmp_172543 = defunc_0_op_res_155177;
                
                scanacc_171579 = scanacc_tmp_172543;
            }
            discard_171589 = scanacc_171579;
            if (memblock_unref(ctx, &ext_mem_171940, "ext_mem_171940") != 0)
                return 1;
            
            bool cond_155178 = deepen_step_res_155156 == (int64_t) 0;
            bool x_155179 = !cond_155178;
            bool x_155181 = sle64((int64_t) 0, zl_rhs_162327);
            bool y_155182 = slt64(zl_rhs_162327, deepen_step_res_155156);
            bool bounds_check_155183 = x_155181 && y_155182;
            bool protect_assert_disj_155184 = cond_155178 || bounds_check_155183;
            bool index_certs_155185;
            
            if (!protect_assert_disj_155184) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_162327, "] out of bounds for array of shape [", (long long) deepen_step_res_155156, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:278:10-51\n   #3  ftRelational.fut:232:7-99\n   #4  ftRelational.fut:221:3-233:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_155186;
            
            if (x_155179) {
                int64_t x_162930 = ((int64_t *) mem_171942)[zl_rhs_162327];
                
                m_f_res_155186 = x_162930;
            } else {
                m_f_res_155186 = (int64_t) 0;
            }
            
            int64_t m_155188;
            
            if (cond_155178) {
                m_155188 = (int64_t) 0;
            } else {
                m_155188 = m_f_res_155186;
            }
            
            int64_t m_155198 = sub64(m_155188, (int64_t) 1);
            bool i_p_m_t_s_leq_w_155200 = slt64(m_155198, deepen_step_res_155156);
            bool zzero_leq_i_p_m_t_s_155199 = sle64((int64_t) 0, m_155198);
            bool y_155202 = zzero_leq_i_p_m_t_s_155199 && i_p_m_t_s_leq_w_155200;
            bool i_lte_j_155201 = sle64((int64_t) 0, m_155188);
            bool forwards_ok_155203 = i_lte_j_155201 && y_155202;
            bool eq_x_zz_155195 = (int64_t) 0 == m_f_res_155186;
            bool p_and_eq_x_y_155196 = x_155179 && eq_x_zz_155195;
            bool empty_slice_155197 = cond_155178 || p_and_eq_x_y_155196;
            bool ok_or_empty_155204 = empty_slice_155197 || forwards_ok_155203;
            bool index_certs_155205;
            
            if (!ok_or_empty_155204) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_155188, "] out of bounds for array of shape [", (long long) deepen_step_res_155156, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:278:10-51\n   #3  ftRelational.fut:232:7-99\n   #4  ftRelational.fut:221:3-233:32\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171973 = (int64_t) 8 * m_155188;
            int64_t conc_tmp_155227 = loop_dz2081Uz2089U_154970 + m_155188;
            int64_t bytes_172009 = (int64_t) 8 * conc_tmp_155227;
            
            if (mem_171974_cached_sizze_173038 < bytes_171973) {
                err = lexical_realloc(ctx, &mem_171974, &mem_171974_cached_sizze_173038, bytes_171973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171974, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171948, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155188});
            if (mem_171976_cached_sizze_173039 < bytes_171973) {
                err = lexical_realloc(ctx, &mem_171976, &mem_171976_cached_sizze_173039, bytes_171973);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171976, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171946, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155188});
            for (int64_t write_iter_171590 = 0; write_iter_171590 < deepen_step_res_155156; write_iter_171590++) {
                int64_t write_iv_171593 = ((int64_t *) mem_171944)[write_iter_171590];
                int64_t write_iv_171594 = ((int64_t *) mem_171942)[write_iter_171590];
                int64_t write_iv_171595 = ((int64_t *) mem_171946)[write_iter_171590];
                int64_t write_iv_171596 = ((int64_t *) mem_171948)[write_iter_171590];
                bool cond_162519 = write_iv_171593 == (int64_t) 1;
                int64_t lifted_lambda_res_162520;
                
                if (cond_162519) {
                    int64_t lifted_lambda_res_t_res_162931 = sub64(write_iv_171594, (int64_t) 1);
                    
                    lifted_lambda_res_162520 = lifted_lambda_res_t_res_162931;
                } else {
                    lifted_lambda_res_162520 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162520) && slt64(lifted_lambda_res_162520, m_155188)) {
                    ((int64_t *) mem_171976)[lifted_lambda_res_162520] = write_iv_171595;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162520) && slt64(lifted_lambda_res_162520, m_155188)) {
                    ((int64_t *) mem_171974)[lifted_lambda_res_162520] = write_iv_171596;
                }
            }
            if (memblock_alloc(ctx, &mem_171990, bytes_171989, "mem_171990")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171990.mem, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) mem_param_171850.mem, (int64_t) 0, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {n_130036, b_130037});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171990.mem, b_130037 * bounds_154975, (int64_t []) {b_130037, (int64_t) 1}, (uint8_t *) ext_mem_171935.mem, ext_171933, (int64_t []) {b_130037, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, b_130037});
            if (memblock_unref(ctx, &ext_mem_171935, "ext_mem_171935") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171992, bytes_171991, "mem_171992")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171992.mem, (int64_t) 0, (int64_t []) {pL_b_130038, (int64_t) 1}, (uint8_t *) mem_param_171846.mem, (int64_t) 0, (int64_t []) {pL_b_130038, (int64_t) 1}, (int64_t []) {n_130036, pL_b_130038});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171992.mem, pL_b_130038 * bounds_154975, (int64_t []) {pL_b_130038, (int64_t) 1}, (uint8_t *) ext_mem_171934.mem, ext_171930, (int64_t []) {pL_b_130038, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154977, pL_b_130038});
            if (memblock_unref(ctx, &ext_mem_171934, "ext_mem_171934") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_172010, bytes_172009, "mem_172010")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_172012, bytes_172009, "mem_172012")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171603 = 0; i_171603 < m_155188; i_171603++) {
                int64_t eta_p_155223 = ((int64_t *) mem_171976)[i_171603];
                int64_t eta_p_155224 = ((int64_t *) mem_171974)[i_171603];
                int64_t tmp_155225 = add64(bounds_154975, eta_p_155223);
                int64_t tmp_155226 = add64(bounds_154975, eta_p_155224);
                
                ((int64_t *) mem_172010.mem)[loop_dz2081Uz2089U_154970 + i_171603] = tmp_155225;
                ((int64_t *) mem_172012.mem)[loop_dz2081Uz2089U_154970 + i_171603] = tmp_155226;
            }
            
            int64_t tmp_offs_172552 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172010.mem, tmp_offs_172552, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171839.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154970});
            tmp_offs_172552 += loop_dz2081Uz2089U_154970;
            if (!(tmp_offs_172552 == loop_dz2081Uz2089U_154970)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172010.mem, tmp_offs_172552, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172010.mem, loop_dz2081Uz2089U_154970, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155188});
            }
            tmp_offs_172552 += m_155188;
            
            int64_t tmp_offs_172553 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172012.mem, tmp_offs_172553, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171842.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154970});
            tmp_offs_172553 += loop_dz2081Uz2089U_154970;
            if (!(tmp_offs_172553 == loop_dz2081Uz2089U_154970)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172012.mem, tmp_offs_172553, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172012.mem, loop_dz2081Uz2089U_154970, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155188});
            }
            tmp_offs_172553 += m_155188;
            if (memblock_set(ctx, &mem_param_tmp_172515, &mem_172010, "mem_172010") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172516, &mem_172012, "mem_172012") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172517, &mem_171992, "mem_171992") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_171990, "mem_171990") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_172519 = conc_tmp_155227;
            
            if (memblock_set(ctx, &mem_param_171839, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171842, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171846, &mem_param_tmp_172517, "mem_param_tmp_172517") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171850, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            loop_dz2081Uz2089U_154970 = loop_dz2081Uz2089U_tmp_172519;
        }
        if (memblock_set(ctx, &ext_mem_172026, &mem_param_171839, "mem_param_171839") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172025, &mem_param_171842, "mem_param_171842") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172024, &mem_param_171846, "mem_param_171846") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172023, &mem_param_171850, "mem_param_171850") != 0)
            return 1;
        loopres_154964 = loop_dz2081Uz2089U_154970;
        
        bool cond_155231 = slt64((int64_t) 0, loopres_154964);
        bool loop_cond_t_res_155232 = slt32(newDepth_154995, max_depth_130045);
        bool x_155233 = cond_155231 && loop_cond_t_res_155232;
        
        if (memblock_set(ctx, &mem_param_tmp_172504, &ext_mem_172024, "ext_mem_172024") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172505, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172506, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &ext_mem_172025, "ext_mem_172025") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_172508 = loopres_154964;
        bool loop_while_tmp_172509 = x_155233;
        int32_t p_tmp_172510 = newDepth_154995;
        
        if (memblock_set(ctx, &mem_param_171826, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172505, "mem_param_tmp_172505") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171833, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171836, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        loop_dz2087U_154957 = loop_dz2087U_tmp_172508;
        loop_while_154958 = loop_while_tmp_172509;
        p_154959 = p_tmp_172510;
    }
    if (memblock_set(ctx, &ext_mem_172040, &mem_param_171826, "mem_param_171826") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172039, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172038, &mem_param_171833, "mem_param_171833") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172037, &mem_param_171836, "mem_param_171836") != 0)
        return 1;
    partition_and_deepen_res_154950 = loop_dz2087U_154957;
    partition_and_deepen_res_154951 = loop_while_154958;
    partition_and_deepen_res_154952 = p_154959;
    if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_172039, "ext_mem_172039") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_172040, "ext_mem_172040") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173027, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173028, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171865);
        free(mem_171899);
        free(mem_171901);
        free(mem_171910);
        free(mem_171911);
        free(mem_171942);
        free(mem_171944);
        free(mem_171946);
        free(mem_171948);
        free(mem_171974);
        free(mem_171976);
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172505, "mem_param_tmp_172505") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172517, "mem_param_tmp_172517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172516, "mem_param_tmp_172516") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172515, "mem_param_tmp_172515") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172012, "mem_172012") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172010, "mem_172010") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171992, "mem_171992") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171990, "mem_171990") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171939, "ext_mem_171939") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171940, "ext_mem_171940") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171937, "mem_171937") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172526, "mem_param_tmp_172526") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172525, "mem_param_tmp_172525") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171889, "mem_171889") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171887, "mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172533, "mem_param_tmp_172533") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171876, "mem_171876") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171874, "mem_param_171874") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171860, "mem_param_171860") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171856, "mem_param_171856") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171934, "ext_mem_171934") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171935, "ext_mem_171935") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171850, "mem_param_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171846, "mem_param_171846") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171842, "mem_param_171842") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171839, "mem_param_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172023, "ext_mem_172023") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172024, "ext_mem_172024") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172025, "ext_mem_172025") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172026, "ext_mem_172026") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171836, "mem_param_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171833, "mem_param_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172037, "ext_mem_172037") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172038, "ext_mem_172038") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172039, "ext_mem_172039") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172040, "ext_mem_172040") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct memblock *mem_out_p_173040, struct memblock *mem_out_p_173041, struct memblock xs_mem_171818, int64_t n_131406, int64_t b_131407, int16_t block_sizze_131408, int64_t gather_psizze_131409, int32_t radix_sizze_131410, int64_t offset_131412, int64_t sizze_thresh_131413, int32_t max_depth_131414, int32_t bit_step_131415)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171863_cached_sizze_173042 = 0;
    unsigned char *mem_171863 = NULL;
    int64_t mem_171896_cached_sizze_173043 = 0;
    unsigned char *mem_171896 = NULL;
    int64_t mem_171898_cached_sizze_173044 = 0;
    unsigned char *mem_171898 = NULL;
    int64_t mem_171906_cached_sizze_173045 = 0;
    unsigned char *mem_171906 = NULL;
    int64_t mem_171934_cached_sizze_173046 = 0;
    unsigned char *mem_171934 = NULL;
    int64_t mem_171936_cached_sizze_173047 = 0;
    unsigned char *mem_171936 = NULL;
    int64_t mem_171938_cached_sizze_173048 = 0;
    unsigned char *mem_171938 = NULL;
    int64_t mem_171940_cached_sizze_173049 = 0;
    unsigned char *mem_171940 = NULL;
    int64_t mem_171966_cached_sizze_173050 = 0;
    unsigned char *mem_171966 = NULL;
    int64_t mem_171968_cached_sizze_173051 = 0;
    unsigned char *mem_171968 = NULL;
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_param_tmp_172508;
    
    mem_param_tmp_172508.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_param_tmp_172506;
    
    mem_param_tmp_172506.references = NULL;
    
    struct memblock mem_param_tmp_172520;
    
    mem_param_tmp_172520.references = NULL;
    
    struct memblock mem_param_tmp_172519;
    
    mem_param_tmp_172519.references = NULL;
    
    struct memblock mem_param_tmp_172518;
    
    mem_param_tmp_172518.references = NULL;
    
    struct memblock mem_param_tmp_172517;
    
    mem_param_tmp_172517.references = NULL;
    
    struct memblock mem_172004;
    
    mem_172004.references = NULL;
    
    struct memblock mem_172002;
    
    mem_172002.references = NULL;
    
    struct memblock mem_171984;
    
    mem_171984.references = NULL;
    
    struct memblock mem_171982;
    
    mem_171982.references = NULL;
    
    struct memblock ext_mem_171931;
    
    ext_mem_171931.references = NULL;
    
    struct memblock ext_mem_171932;
    
    ext_mem_171932.references = NULL;
    
    struct memblock mem_171929;
    
    mem_171929.references = NULL;
    
    struct memblock mem_param_tmp_172528;
    
    mem_param_tmp_172528.references = NULL;
    
    struct memblock mem_param_tmp_172527;
    
    mem_param_tmp_172527.references = NULL;
    
    struct memblock mem_171887;
    
    mem_171887.references = NULL;
    
    struct memblock mem_171885;
    
    mem_171885.references = NULL;
    
    struct memblock mem_param_tmp_172535;
    
    mem_param_tmp_172535.references = NULL;
    
    struct memblock mem_171874;
    
    mem_171874.references = NULL;
    
    struct memblock mem_param_171872;
    
    mem_param_171872.references = NULL;
    
    struct memblock ext_mem_171883;
    
    ext_mem_171883.references = NULL;
    
    struct memblock mem_param_171858;
    
    mem_param_171858.references = NULL;
    
    struct memblock mem_param_171855;
    
    mem_param_171855.references = NULL;
    
    struct memblock ext_mem_171926;
    
    ext_mem_171926.references = NULL;
    
    struct memblock ext_mem_171927;
    
    ext_mem_171927.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_171849;
    
    mem_param_171849.references = NULL;
    
    struct memblock mem_param_171845;
    
    mem_param_171845.references = NULL;
    
    struct memblock mem_param_171842;
    
    mem_param_171842.references = NULL;
    
    struct memblock mem_param_171839;
    
    mem_param_171839.references = NULL;
    
    struct memblock ext_mem_172014;
    
    ext_mem_172014.references = NULL;
    
    struct memblock ext_mem_172015;
    
    ext_mem_172015.references = NULL;
    
    struct memblock ext_mem_172016;
    
    ext_mem_172016.references = NULL;
    
    struct memblock ext_mem_172017;
    
    ext_mem_172017.references = NULL;
    
    struct memblock mem_param_171836;
    
    mem_param_171836.references = NULL;
    
    struct memblock mem_param_171833;
    
    mem_param_171833.references = NULL;
    
    struct memblock mem_param_171830;
    
    mem_param_171830.references = NULL;
    
    struct memblock mem_param_171826;
    
    mem_param_171826.references = NULL;
    
    struct memblock ext_mem_172027;
    
    ext_mem_172027.references = NULL;
    
    struct memblock ext_mem_172028;
    
    ext_mem_172028.references = NULL;
    
    struct memblock ext_mem_172029;
    
    ext_mem_172029.references = NULL;
    
    struct memblock ext_mem_172030;
    
    ext_mem_172030.references = NULL;
    
    struct memblock mem_171823;
    
    mem_171823.references = NULL;
    
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t is_154945 = add64(n_131406, offset_131412);
    bool bounds_invalid_upwards_154946 = slt64(is_154945, offset_131412);
    bool valid_154947 = !bounds_invalid_upwards_154946;
    bool range_valid_c_154948;
    
    if (!valid_154947) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) offset_131412, "..<", (long long) is_154945, " is invalid.", "-> #0  ftRelational.fut:245:15-34\n   #1  ftRelational.fut:235:3-248:33\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_131406;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172502 = 0; i_172502 < n_131406; i_172502++) {
        int64_t x_172503 = offset_131412 + i_172502 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172502] = x_172503;
    }
    if (memblock_alloc(ctx, &mem_171821, (int64_t) 8, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172504 = 0; nest_i_172504 < (int64_t) 1; nest_i_172504++) {
        ((int64_t *) mem_171821.mem)[nest_i_172504] = (int64_t) 0;
    }
    if (memblock_alloc(ctx, &mem_171822, (int64_t) 8, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172505 = 0; nest_i_172505 < (int64_t) 1; nest_i_172505++) {
        ((int64_t *) mem_171822.mem)[nest_i_172505] = n_131406;
    }
    
    bool loop_cond_t_res_154952 = slt32(0, max_depth_131414);
    
    if (memblock_alloc(ctx, &mem_171823, (int64_t) 0, "mem_171823")) {
        err = 1;
        goto cleanup;
    }
    
    int32_t i64_res_155003 = sext_i64_i32(b_131407);
    int32_t zm_lhs_155004 = mul32(8, i64_res_155003);
    int32_t min_arg1_155005 = sub32(zm_lhs_155004, 1);
    int32_t s_sign_155012 = (bit_step_131415 > 0 ? 1 : 0) - (bit_step_131415 < 0 ? 1 : 0);
    int64_t s_sign_155013 = sext_i32_i64(s_sign_155012);
    bool downwards_155016 = s_sign_155012 == -1;
    bool x_155020 = !downwards_155016;
    int64_t subtracted_step_155029 = sext_i32_i64(bit_step_131415);
    int64_t pos_step_155030 = mul64(s_sign_155013, subtracted_step_155029);
    int32_t zm_lhs_155034 = add32(8, zm_lhs_155004);
    int32_t zs_lhs_155035 = sub32(zm_lhs_155034, 1);
    int32_t i32_arg0_155036 = sdiv32(zs_lhs_155035, 8);
    int64_t i32_res_155037 = sext_i32_i64(i32_arg0_155036);
    bool zzero_155038 = i32_res_155037 == (int64_t) 0;
    bool nonzzero_155039 = !zzero_155038;
    int64_t bytes_171981 = n_131406 * b_131407;
    
    if (mem_171906_cached_sizze_173045 < b_131407) {
        err = lexical_realloc(ctx, &mem_171906, &mem_171906_cached_sizze_173045, b_131407);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t partition_and_deepen_res_154954;
    bool partition_and_deepen_res_154955;
    int32_t partition_and_deepen_res_154956;
    int64_t loop_dz2087U_154961;
    bool loop_while_154962;
    int32_t p_154963;
    
    if (memblock_set(ctx, &mem_param_171826, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171830, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171833, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171836, &mem_171822, "mem_171822") != 0)
        return 1;
    loop_dz2087U_154961 = (int64_t) 1;
    loop_while_154962 = loop_cond_t_res_154952;
    p_154963 = 0;
    while (loop_while_154962) {
        bool loop_nonempty_162311 = slt64((int64_t) 0, loop_dz2087U_154961);
        int32_t newDepth_154999 = add32(1, p_154963);
        int32_t new_i_155000 = mul32(radix_sizze_131410, p_154963);
        int32_t zm_lhs_155001 = mul32(radix_sizze_131410, newDepth_154999);
        int32_t new_j_155002 = sub32(zm_lhs_155001, 1);
        int32_t min_res_155006 = smin32(new_j_155002, min_arg1_155005);
        int32_t tmp_155007 = add32(bit_step_131415, new_i_155000);
        int64_t i_155008 = sext_i32_i64(new_i_155000);
        int64_t j__155009 = sext_i32_i64(min_res_155006);
        int64_t tmp_155010 = sext_i32_i64(tmp_155007);
        bool step_zzero_155011 = new_i_155000 == tmp_155007;
        bool bounds_invalid_downwards_155014 = slt32(new_i_155000, min_res_155006);
        bool bounds_invalid_upwards_155015 = slt32(min_res_155006, new_i_155000);
        int32_t distance_downwards_exclusive_155017 = sub32(new_i_155000, min_res_155006);
        int32_t distance_upwards_exclusive_155018 = sub32(min_res_155006, new_i_155000);
        bool x_155019 = bounds_invalid_downwards_155014 && downwards_155016;
        bool y_155021 = bounds_invalid_upwards_155015 && x_155020;
        bool bounds_invalid_155022 = x_155019 || y_155021;
        int32_t distance_exclusive_155023;
        
        if (downwards_155016) {
            distance_exclusive_155023 = distance_downwards_exclusive_155017;
        } else {
            distance_exclusive_155023 = distance_upwards_exclusive_155018;
        }
        
        int64_t distance_exclusive_155024 = sext_i32_i64(distance_exclusive_155023);
        int64_t distance_155025 = add64((int64_t) 1, distance_exclusive_155024);
        bool range_invalid_155026 = step_zzero_155011 || bounds_invalid_155022;
        bool valid_155027 = !range_invalid_155026;
        bool loop_not_taken_162312 = !loop_nonempty_162311;
        bool protect_assert_disj_162313 = valid_155027 || loop_not_taken_162312;
        bool range_valid_c_155028;
        
        if (!protect_assert_disj_162313) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) i_155008, "..", (long long) tmp_155010, "...", (long long) j__155009, " is invalid.", "-> #0  ftHashJoin.fut:224:17-39\n   #1  ftHashJoin.fut:267:22-273:15\n   #2  ftRelational.fut:247:7-99\n   #3  ftRelational.fut:235:3-248:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t num_elems_155031 = sdiv_up_safe64(distance_155025, pos_step_155030);
        bool loop_nonempty_155032 = slt64((int64_t) 0, num_elems_155031);
        bool loop_not_taken_155040 = !loop_nonempty_155032;
        bool protect_assert_disj_155041 = nonzzero_155039 || loop_not_taken_155040;
        bool protect_assert_disj_162315 = protect_assert_disj_155041 || loop_not_taken_162312;
        bool nonzzero_cert_155042;
        
        if (!protect_assert_disj_162315) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:247:7-99\n   #5  ftRelational.fut:235:3-248:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155043 = sdiv_safe64(gather_psizze_131409, i32_res_155037);
        bool zzero_155046 = psizze__155043 == (int64_t) 0;
        bool nonzzero_155047 = !zzero_155046;
        bool protect_assert_disj_155048 = loop_not_taken_155040 || nonzzero_155047;
        bool protect_assert_disj_162317 = protect_assert_disj_155048 || loop_not_taken_162312;
        bool nonzzero_cert_155049;
        
        if (!protect_assert_disj_162317) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:247:7-99\n   #5  ftRelational.fut:235:3-248:33\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t loopres_154968;
        int64_t loop_dz2081Uz2089U_154974;
        
        if (memblock_set(ctx, &mem_param_171839, &mem_171823, "mem_171823") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171842, &mem_171823, "mem_171823") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171845, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171849, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        loop_dz2081Uz2089U_154974 = (int64_t) 0;
        for (int64_t i_154973 = 0; i_154973 < loop_dz2087U_154961; i_154973++) {
            int64_t bounds_154979 = ((int64_t *) mem_param_171833.mem)[i_154973];
            int64_t bounds_154980 = ((int64_t *) mem_param_171836.mem)[i_154973];
            int64_t dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981 = sub64(bounds_154980, bounds_154979);
            bool empty_slice_154982 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981 == (int64_t) 0;
            int64_t m_154983 = sub64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, (int64_t) 1);
            int64_t i_p_m_t_s_154984 = add64(bounds_154979, m_154983);
            bool zzero_leq_i_p_m_t_s_154985 = sle64((int64_t) 0, i_p_m_t_s_154984);
            bool i_p_m_t_s_leq_w_154986 = slt64(i_p_m_t_s_154984, n_131406);
            bool zzero_lte_i_154987 = sle64((int64_t) 0, bounds_154979);
            bool i_lte_j_154988 = sle64(bounds_154979, bounds_154980);
            bool y_154989 = i_p_m_t_s_leq_w_154986 && zzero_lte_i_154987;
            bool y_154990 = zzero_leq_i_p_m_t_s_154985 && y_154989;
            bool forwards_ok_154991 = i_lte_j_154988 && y_154990;
            bool ok_or_empty_154992 = empty_slice_154982 || forwards_ok_154991;
            bool index_certs_154993;
            
            if (!ok_or_empty_154992) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) bounds_154979, ":", (long long) bounds_154980, "] out of bounds for array of shape [", (long long) n_131406, "].", "-> #0  ftHashJoin.fut:301:23-49\n   #1  ftRelational.fut:247:7-99\n   #2  ftRelational.fut:235:3-248:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171850 = (int64_t) 8 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981;
            
            if (memblock_alloc(ctx, &mem_171851, bytes_171850, "mem_171851")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t nest_i_172526 = 0; nest_i_172526 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981; nest_i_172526++) {
                ((int64_t *) mem_171851.mem)[nest_i_172526] = (int64_t) 0;
            }
            
            int64_t zm_lhs_155044 = add64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, psizze__155043);
            int64_t zs_lhs_155045 = sub64(zm_lhs_155044, (int64_t) 1);
            int64_t max_iter_155050 = sdiv_safe64(zs_lhs_155045, psizze__155043);
            bool bounds_invalid_upwards_155051 = slt64(max_iter_155050, (int64_t) 0);
            bool valid_155052 = !bounds_invalid_upwards_155051;
            bool protect_assert_disj_155053 = loop_not_taken_155040 || valid_155052;
            bool range_valid_c_155054;
            
            if (!protect_assert_disj_155053) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155050, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftHashJoin.fut:211:85-88\n   #3  ftHashJoin.fut:225:8-73\n   #4  ftHashJoin.fut:267:22-273:15\n   #5  ftRelational.fut:247:7-99\n   #6  ftRelational.fut:235:3-248:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t binop_y_171859 = b_131407 * bounds_154979;
            int64_t bytes_171884 = b_131407 * dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981;
            
            if (mem_171863_cached_sizze_173042 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981) {
                err = lexical_realloc(ctx, &mem_171863, &mem_171863_cached_sizze_173042, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t ext_171925;
            int64_t ext_171922;
            int64_t ctx_param_ext_171852;
            int64_t ctx_param_ext_171856;
            
            if (memblock_set(ctx, &mem_param_171855, &mem_param_171849, "mem_param_171849") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171858, &mem_param_171845, "mem_param_171845") != 0)
                return 1;
            ctx_param_ext_171852 = binop_y_171859;
            ctx_param_ext_171856 = bounds_154979;
            for (int64_t i_155057 = 0; i_155057 < num_elems_155031; i_155057++) {
                int32_t binop_x_155060 = sext_i64_i32(i_155057);
                int32_t binop_x_155061 = mul32(bit_step_131415, binop_x_155060);
                int32_t index_primexp_155062 = add32(new_i_155000, binop_x_155061);
                int32_t zm_lhs_155063 = add32(bit_step_131415, index_primexp_155062);
                int32_t min_arg1_155064 = sub32(zm_lhs_155063, 1);
                int32_t min_res_155065 = smin32(min_res_155006, min_arg1_155064);
                int32_t zp_lhs_155066 = sub32(min_res_155065, index_primexp_155062);
                int32_t ij_bits_155067 = add32(1, zp_lhs_155066);
                int32_t up_to_155068 = shl32(1, ij_bits_155067);
                int64_t tmp_155069 = sext_i32_i64(zp_lhs_155066);
                bool bounds_invalid_upwards_155070 = slt32(zp_lhs_155066, 0);
                bool valid_155072 = !bounds_invalid_upwards_155070;
                bool range_valid_c_155073;
                
                if (!valid_155072) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_155069, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:211:85-88\n   #3  ftHashJoin.fut:225:8-73\n   #4  ftHashJoin.fut:267:22-273:15\n   #5  ftRelational.fut:247:7-99\n   #6  ftRelational.fut:235:3-248:33\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t up_to_155083 = sext_i32_i64(up_to_155068);
                bool bounds_invalid_upwards_155084 = slt32(up_to_155068, 0);
                bool valid_155085 = !bounds_invalid_upwards_155084;
                bool range_valid_c_155086;
                
                if (!valid_155085) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_155083, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:247:7-99\n   #5  ftRelational.fut:235:3-248:33\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t distance_155071 = add64((int64_t) 1, tmp_155069);
                
                for (int64_t i_171547 = 0; i_171547 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981; i_171547++) {
                    int8_t defunc_0_f_res_155076;
                    int8_t y_155078 = (int8_t) 0;
                    
                    for (int64_t i_155077 = 0; i_155077 < distance_155071; i_155077++) {
                        int32_t binop_x_155079 = sext_i64_i32(i_155077);
                        int32_t get_bit_arg0_155080 = add32(index_primexp_155062, binop_x_155079);
                        int32_t zm_rhs_162484 = sdiv32(get_bit_arg0_155080, 8);
                        int32_t zm_lhs_162485 = sub32(i64_res_155003, zm_rhs_162484);
                        int32_t whichByte_162486 = sub32(zm_lhs_162485, 1);
                        int64_t whichByte_162488 = sext_i32_i64(whichByte_162486);
                        bool x_162489 = sle64((int64_t) 0, whichByte_162488);
                        bool y_162490 = slt64(whichByte_162488, b_131407);
                        bool bounds_check_162491 = x_162489 && y_162490;
                        bool index_certs_162492;
                        
                        if (!bounds_check_162491) {
                            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) whichByte_162488, "] out of bounds for array of shape [", (long long) b_131407, "].", "-> #0  ftHashJoin.fut:19:8-20\n   #1  ftRelational.fut:247:7-99\n   #2  ftRelational.fut:235:3-248:33\n"));
                            err = FUTHARK_PROGRAM_ERROR;
                            goto cleanup;
                        }
                        
                        int32_t whichBit_162487 = smod32(get_bit_arg0_155080, 8);
                        int8_t zbzg_lhs_162493 = ((int8_t *) mem_param_171855.mem)[ctx_param_ext_171852 + (i_171547 * b_131407 + whichByte_162488)];
                        int8_t unsign_arg0_162494 = zext_i32_i8(whichBit_162487);
                        int8_t unsign_arg0_162495 = ashr8(zbzg_lhs_162493, unsign_arg0_162494);
                        int8_t unsign_arg0_162496 = (int8_t) 1 & unsign_arg0_162495;
                        int32_t to_i32_res_162497 = zext_i8_i32(unsign_arg0_162496);
                        int8_t loopres_155082;
                        
                        if (futrts_set_bit_2464(ctx, &loopres_155082, binop_x_155079, y_155078, to_i32_res_162497) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        int8_t y_tmp_172534 = loopres_155082;
                        
                        y_155078 = y_tmp_172534;
                    }
                    defunc_0_f_res_155076 = y_155078;
                    ((int8_t *) mem_171863)[i_171547] = defunc_0_f_res_155076;
                }
                
                int64_t defunc_0_radix_sort_multistep_res_155087;
                int64_t offs_155090;
                
                if (memblock_set(ctx, &mem_param_171872, &mem_171851, "mem_171851") != 0)
                    return 1;
                offs_155090 = (int64_t) 0;
                for (int64_t i_155089 = 0; i_155089 < up_to_155083; i_155089++) {
                    int32_t binop_x_155092 = sext_i64_i32(i_155089);
                    int8_t index_primexp_155093 = zext_i32_i8(binop_x_155092);
                    
                    if (memblock_alloc(ctx, &mem_171874, bytes_171850, "mem_171874")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    int64_t inpacc_162918;
                    int64_t defunc_0_reduce_res_162919;
                    int64_t inpacc_162748;
                    int64_t inpacc_162749;
                    
                    inpacc_162748 = (int64_t) 0;
                    inpacc_162749 = (int64_t) 0;
                    for (int64_t i_171565 = 0; i_171565 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981; i_171565++) {
                        int8_t eta_p_171796 = ((int8_t *) mem_171863)[i_171565];
                        bool lifted_lambda_res_171797 = eta_p_171796 == index_primexp_155093;
                        int64_t bool_res_171798 = btoi_bool_i64(lifted_lambda_res_171797);
                        int64_t eta_p_171811 = ((int64_t *) mem_param_171872.mem)[i_171565];
                        int64_t defunc_0_op_res_171812 = add64(inpacc_162748, bool_res_171798);
                        int64_t zm_lhs_171813 = add64(offs_155090, defunc_0_op_res_171812);
                        int64_t lifted_lambda_res_171814 = sub64(zm_lhs_171813, (int64_t) 1);
                        int64_t defunc_0_f_res_171815 = mul64(bool_res_171798, lifted_lambda_res_171814);
                        int64_t defunc_0_f_res_171816 = add64(eta_p_171811, defunc_0_f_res_171815);
                        int64_t defunc_0_op_res_162797 = add64(inpacc_162749, bool_res_171798);
                        
                        ((int64_t *) mem_171874.mem)[i_171565] = defunc_0_f_res_171816;
                        
                        int64_t inpacc_tmp_172538 = defunc_0_op_res_171812;
                        int64_t inpacc_tmp_172539 = defunc_0_op_res_162797;
                        
                        inpacc_162748 = inpacc_tmp_172538;
                        inpacc_162749 = inpacc_tmp_172539;
                    }
                    inpacc_162918 = inpacc_162748;
                    defunc_0_reduce_res_162919 = inpacc_162749;
                    
                    int64_t tmp_155118 = add64(offs_155090, defunc_0_reduce_res_162919);
                    
                    if (memblock_set(ctx, &mem_param_tmp_172535, &mem_171874, "mem_171874") != 0)
                        return 1;
                    
                    int64_t offs_tmp_172536 = tmp_155118;
                    
                    if (memblock_set(ctx, &mem_param_171872, &mem_param_tmp_172535, "mem_param_tmp_172535") != 0)
                        return 1;
                    offs_155090 = offs_tmp_172536;
                }
                if (memblock_set(ctx, &ext_mem_171883, &mem_param_171872, "mem_param_171872") != 0)
                    return 1;
                defunc_0_radix_sort_multistep_res_155087 = offs_155090;
                if (memblock_alloc(ctx, &mem_171885, bytes_171884, "mem_171885")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_1b(ctx, 2, (uint8_t *) mem_171885.mem, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) mem_param_171855.mem, ctx_param_ext_171852, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, b_131407});
                if (memblock_alloc(ctx, &mem_171887, bytes_171850, "mem_171887")) {
                    err = 1;
                    goto cleanup;
                }
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_171887.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171858.mem, ctx_param_ext_171856, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981});
                for (int64_t i_155127 = 0; i_155127 < max_iter_155050; i_155127++) {
                    int64_t inf_155130 = mul64(psizze__155043, i_155127);
                    int64_t min_arg1_155131 = add64(psizze__155043, inf_155130);
                    int64_t min_res_155132 = smin64(dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, min_arg1_155131);
                    bool zzero_lte_i_155142 = sle64((int64_t) 0, inf_155130);
                    int64_t j_m_i_155136 = sub64(min_res_155132, inf_155130);
                    int64_t m_155138 = sub64(j_m_i_155136, (int64_t) 1);
                    int64_t i_p_m_t_s_155139 = add64(inf_155130, m_155138);
                    bool i_p_m_t_s_leq_w_155141 = slt64(i_p_m_t_s_155139, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981);
                    bool y_155144 = i_p_m_t_s_leq_w_155141 && zzero_lte_i_155142;
                    bool zzero_leq_i_p_m_t_s_155140 = sle64((int64_t) 0, i_p_m_t_s_155139);
                    bool y_155145 = zzero_leq_i_p_m_t_s_155140 && y_155144;
                    bool i_lte_j_155143 = sle64(inf_155130, min_res_155132);
                    bool forwards_ok_155146 = i_lte_j_155143 && y_155145;
                    bool empty_slice_155137 = j_m_i_155136 == (int64_t) 0;
                    bool ok_or_empty_155147 = empty_slice_155137 || forwards_ok_155146;
                    bool index_certs_155148;
                    
                    if (!ok_or_empty_155147) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155130, ":", (long long) min_res_155132, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftHashJoin.fut:211:85-88\n   #2  ftHashJoin.fut:225:8-73\n   #3  ftHashJoin.fut:267:22-273:15\n   #4  ftRelational.fut:247:7-99\n   #5  ftRelational.fut:235:3-248:33\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t bytes_171895 = (int64_t) 8 * j_m_i_155136;
                    int64_t bytes_171897 = b_131407 * j_m_i_155136;
                    
                    if (mem_171896_cached_sizze_173043 < bytes_171895) {
                        err = lexical_realloc(ctx, &mem_171896, &mem_171896_cached_sizze_173043, bytes_171895);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171896, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171887.mem, (int64_t) 0 + (int64_t) 1 * inf_155130, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155136});
                    if (mem_171898_cached_sizze_173044 < bytes_171897) {
                        err = lexical_realloc(ctx, &mem_171898, &mem_171898_cached_sizze_173044, bytes_171897);
                        if (err != FUTHARK_SUCCESS)
                            goto cleanup;
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171898, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) mem_171885.mem, (int64_t) 0 + b_131407 * inf_155130, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {j_m_i_155136, b_131407});
                    for (int64_t write_iter_171567 = 0; write_iter_171567 < dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981; write_iter_171567++) {
                        int64_t write_iv_171570 = ((int64_t *) ext_mem_171883.mem)[write_iter_171567];
                        int64_t write_iv_171572 = ((int64_t *) mem_param_171858.mem)[ctx_param_ext_171856 + write_iter_171567];
                        
                        lmad_copy_1b(ctx, 1, (uint8_t *) mem_171906, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171855.mem, ctx_param_ext_171852 + write_iter_171567 * b_131407, (int64_t []) {(int64_t) 1}, (int64_t []) {b_131407});
                        
                        int64_t lifted_lambda_res_162840 = sub64(write_iv_171570, inf_155130);
                        
                        if ((sle64((int64_t) 0, lifted_lambda_res_162840) && slt64(lifted_lambda_res_162840, j_m_i_155136)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_131407 - (int64_t) 1, b_131407))) {
                            lmad_copy_1b(ctx, 1, (uint8_t *) mem_171898, lifted_lambda_res_162840 * b_131407, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171906, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_131407});
                        }
                        if (sle64((int64_t) 0, lifted_lambda_res_162840) && slt64(lifted_lambda_res_162840, j_m_i_155136)) {
                            ((int64_t *) mem_171896)[lifted_lambda_res_162840] = write_iv_171572;
                        }
                    }
                    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171885.mem, b_131407 * inf_155130, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) mem_171898, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {j_m_i_155136, b_131407});
                    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171887.mem, inf_155130, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171896, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155136});
                }
                if (memblock_unref(ctx, &ext_mem_171883, "ext_mem_171883") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172527, &mem_171885, "mem_171885") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_tmp_172528, &mem_171887, "mem_171887") != 0)
                    return 1;
                
                int64_t ctx_param_ext_tmp_172529 = (int64_t) 0;
                int64_t ctx_param_ext_tmp_172530 = (int64_t) 0;
                
                if (memblock_set(ctx, &mem_param_171855, &mem_param_tmp_172527, "mem_param_tmp_172527") != 0)
                    return 1;
                if (memblock_set(ctx, &mem_param_171858, &mem_param_tmp_172528, "mem_param_tmp_172528") != 0)
                    return 1;
                ctx_param_ext_171852 = ctx_param_ext_tmp_172529;
                ctx_param_ext_171856 = ctx_param_ext_tmp_172530;
            }
            if (memblock_set(ctx, &ext_mem_171927, &mem_param_171855, "mem_param_171855") != 0)
                return 1;
            if (memblock_set(ctx, &ext_mem_171926, &mem_param_171858, "mem_param_171858") != 0)
                return 1;
            ext_171925 = ctx_param_ext_171852;
            ext_171922 = ctx_param_ext_171856;
            if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171929, bytes_171884, "mem_171929")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171929.mem, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) ext_mem_171927.mem, ext_171925, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, b_131407});
            
            int64_t deepen_step_res_155160;
            int64_t deepen_step_res_155161;
            int32_t deepen_step_res_155164;
            
            if (futrts_getPartitionBounds_16885(ctx, &ext_mem_171932, &ext_mem_171931, &deepen_step_res_155160, &deepen_step_res_155161, &deepen_step_res_155164, mem_171929, dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, b_131407, newDepth_154999, new_i_155000, new_j_155002) != 0) {
                err = 1;
                goto cleanup;
            }
            if (memblock_unref(ctx, &mem_171929, "mem_171929") != 0)
                return 1;
            
            int64_t zl_rhs_162327 = sub64(deepen_step_res_155160, (int64_t) 1);
            int64_t bytes_171933 = (int64_t) 8 * deepen_step_res_155160;
            
            if (mem_171934_cached_sizze_173046 < bytes_171933) {
                err = lexical_realloc(ctx, &mem_171934, &mem_171934_cached_sizze_173046, bytes_171933);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171936_cached_sizze_173047 < bytes_171933) {
                err = lexical_realloc(ctx, &mem_171936, &mem_171936_cached_sizze_173047, bytes_171933);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171938_cached_sizze_173048 < bytes_171933) {
                err = lexical_realloc(ctx, &mem_171938, &mem_171938_cached_sizze_173048, bytes_171933);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            if (mem_171940_cached_sizze_173049 < bytes_171933) {
                err = lexical_realloc(ctx, &mem_171940, &mem_171940_cached_sizze_173049, bytes_171933);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            
            int64_t discard_171589;
            int64_t scanacc_171579 = (int64_t) 0;
            
            for (int64_t i_171584 = 0; i_171584 < deepen_step_res_155160; i_171584++) {
                int64_t tmp_162537 = ((int64_t *) ext_mem_171932.mem)[i_171584];
                bool cond_162538 = slt64(i_171584, zl_rhs_162327);
                int64_t tmp_162539;
                
                if (cond_162538) {
                    int64_t tmp_162924 = add64((int64_t) 1, i_171584);
                    bool x_162925 = sle64((int64_t) 0, tmp_162924);
                    bool y_162926 = slt64(tmp_162924, deepen_step_res_155160);
                    bool bounds_check_162927 = x_162925 && y_162926;
                    bool index_certs_162928;
                    
                    if (!bounds_check_162927) {
                        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162924, "] out of bounds for array of shape [", (long long) deepen_step_res_155160, "].", "-> #0  ftHashJoin.fut:277:69-83\n   #1  ftRelational.fut:247:7-99\n   #2  ftRelational.fut:235:3-248:33\n"));
                        err = FUTHARK_PROGRAM_ERROR;
                        goto cleanup;
                    }
                    
                    int64_t tmp_t_res_162929 = ((int64_t *) ext_mem_171932.mem)[tmp_162924];
                    
                    tmp_162539 = tmp_t_res_162929;
                } else {
                    tmp_162539 = dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981;
                }
                
                int64_t zg_lhs_162548 = sub64(tmp_162539, tmp_162537);
                bool lifted_lambda_res_162549 = slt64(sizze_thresh_131413, zg_lhs_162548);
                int64_t defunc_0_f_res_162550 = btoi_bool_i64(lifted_lambda_res_162549);
                int64_t defunc_0_op_res_155181 = add64(defunc_0_f_res_162550, scanacc_171579);
                
                ((int64_t *) mem_171934)[i_171584] = defunc_0_op_res_155181;
                ((int64_t *) mem_171936)[i_171584] = defunc_0_f_res_162550;
                ((int64_t *) mem_171938)[i_171584] = tmp_162537;
                ((int64_t *) mem_171940)[i_171584] = tmp_162539;
                
                int64_t scanacc_tmp_172545 = defunc_0_op_res_155181;
                
                scanacc_171579 = scanacc_tmp_172545;
            }
            discard_171589 = scanacc_171579;
            if (memblock_unref(ctx, &ext_mem_171932, "ext_mem_171932") != 0)
                return 1;
            
            bool cond_155182 = deepen_step_res_155160 == (int64_t) 0;
            bool x_155183 = !cond_155182;
            bool x_155185 = sle64((int64_t) 0, zl_rhs_162327);
            bool y_155186 = slt64(zl_rhs_162327, deepen_step_res_155160);
            bool bounds_check_155187 = x_155185 && y_155186;
            bool protect_assert_disj_155188 = cond_155182 || bounds_check_155187;
            bool index_certs_155189;
            
            if (!protect_assert_disj_155188) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zl_rhs_162327, "] out of bounds for array of shape [", (long long) deepen_step_res_155160, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:278:10-51\n   #3  ftRelational.fut:247:7-99\n   #4  ftRelational.fut:235:3-248:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t m_f_res_155190;
            
            if (x_155183) {
                int64_t x_162930 = ((int64_t *) mem_171934)[zl_rhs_162327];
                
                m_f_res_155190 = x_162930;
            } else {
                m_f_res_155190 = (int64_t) 0;
            }
            
            int64_t m_155192;
            
            if (cond_155182) {
                m_155192 = (int64_t) 0;
            } else {
                m_155192 = m_f_res_155190;
            }
            
            int64_t m_155202 = sub64(m_155192, (int64_t) 1);
            bool i_p_m_t_s_leq_w_155204 = slt64(m_155202, deepen_step_res_155160);
            bool zzero_leq_i_p_m_t_s_155203 = sle64((int64_t) 0, m_155202);
            bool y_155206 = zzero_leq_i_p_m_t_s_155203 && i_p_m_t_s_leq_w_155204;
            bool i_lte_j_155205 = sle64((int64_t) 0, m_155192);
            bool forwards_ok_155207 = i_lte_j_155205 && y_155206;
            bool eq_x_zz_155199 = (int64_t) 0 == m_f_res_155190;
            bool p_and_eq_x_y_155200 = x_155183 && eq_x_zz_155199;
            bool empty_slice_155201 = cond_155182 || p_and_eq_x_y_155200;
            bool ok_or_empty_155208 = empty_slice_155201 || forwards_ok_155207;
            bool index_certs_155209;
            
            if (!ok_or_empty_155208) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_155192, "] out of bounds for array of shape [", (long long) deepen_step_res_155160, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:278:10-51\n   #3  ftRelational.fut:247:7-99\n   #4  ftRelational.fut:235:3-248:33\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171965 = (int64_t) 8 * m_155192;
            int64_t conc_tmp_155231 = loop_dz2081Uz2089U_154974 + m_155192;
            int64_t bytes_172001 = (int64_t) 8 * conc_tmp_155231;
            
            if (mem_171966_cached_sizze_173050 < bytes_171965) {
                err = lexical_realloc(ctx, &mem_171966, &mem_171966_cached_sizze_173050, bytes_171965);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171966, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171940, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155192});
            if (mem_171968_cached_sizze_173051 < bytes_171965) {
                err = lexical_realloc(ctx, &mem_171968, &mem_171968_cached_sizze_173051, bytes_171965);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171968, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171938, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155192});
            for (int64_t write_iter_171590 = 0; write_iter_171590 < deepen_step_res_155160; write_iter_171590++) {
                int64_t write_iv_171593 = ((int64_t *) mem_171936)[write_iter_171590];
                int64_t write_iv_171594 = ((int64_t *) mem_171934)[write_iter_171590];
                int64_t write_iv_171595 = ((int64_t *) mem_171938)[write_iter_171590];
                int64_t write_iv_171596 = ((int64_t *) mem_171940)[write_iter_171590];
                bool cond_162519 = write_iv_171593 == (int64_t) 1;
                int64_t lifted_lambda_res_162520;
                
                if (cond_162519) {
                    int64_t lifted_lambda_res_t_res_162931 = sub64(write_iv_171594, (int64_t) 1);
                    
                    lifted_lambda_res_162520 = lifted_lambda_res_t_res_162931;
                } else {
                    lifted_lambda_res_162520 = (int64_t) -1;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162520) && slt64(lifted_lambda_res_162520, m_155192)) {
                    ((int64_t *) mem_171968)[lifted_lambda_res_162520] = write_iv_171595;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162520) && slt64(lifted_lambda_res_162520, m_155192)) {
                    ((int64_t *) mem_171966)[lifted_lambda_res_162520] = write_iv_171596;
                }
            }
            if (memblock_alloc(ctx, &mem_171982, bytes_171981, "mem_171982")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171982.mem, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) mem_param_171849.mem, (int64_t) 0, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {n_131406, b_131407});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171982.mem, b_131407 * bounds_154979, (int64_t []) {b_131407, (int64_t) 1}, (uint8_t *) ext_mem_171927.mem, ext_171925, (int64_t []) {b_131407, (int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981, b_131407});
            if (memblock_unref(ctx, &ext_mem_171927, "ext_mem_171927") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_171984, bytes_171819, "mem_171984")) {
                err = 1;
                goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171984.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171845.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_131406});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171984.mem, bounds_154979, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171926.mem, ext_171922, (int64_t []) {(int64_t) 1}, (int64_t []) {dzlz7bUZLzmZRz20Uboundszi1z20Uboundszi0z7dUzg_154981});
            if (memblock_unref(ctx, &ext_mem_171926, "ext_mem_171926") != 0)
                return 1;
            if (memblock_alloc(ctx, &mem_172002, bytes_172001, "mem_172002")) {
                err = 1;
                goto cleanup;
            }
            if (memblock_alloc(ctx, &mem_172004, bytes_172001, "mem_172004")) {
                err = 1;
                goto cleanup;
            }
            for (int64_t i_171603 = 0; i_171603 < m_155192; i_171603++) {
                int64_t eta_p_155227 = ((int64_t *) mem_171968)[i_171603];
                int64_t eta_p_155228 = ((int64_t *) mem_171966)[i_171603];
                int64_t tmp_155229 = add64(bounds_154979, eta_p_155227);
                int64_t tmp_155230 = add64(bounds_154979, eta_p_155228);
                
                ((int64_t *) mem_172002.mem)[loop_dz2081Uz2089U_154974 + i_171603] = tmp_155229;
                ((int64_t *) mem_172004.mem)[loop_dz2081Uz2089U_154974 + i_171603] = tmp_155230;
            }
            
            int64_t tmp_offs_172554 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002.mem, tmp_offs_172554, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171839.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154974});
            tmp_offs_172554 += loop_dz2081Uz2089U_154974;
            if (!(tmp_offs_172554 == loop_dz2081Uz2089U_154974)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172002.mem, tmp_offs_172554, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172002.mem, loop_dz2081Uz2089U_154974, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155192});
            }
            tmp_offs_172554 += m_155192;
            
            int64_t tmp_offs_172555 = (int64_t) 0;
            
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_172004.mem, tmp_offs_172555, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171842.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {loop_dz2081Uz2089U_154974});
            tmp_offs_172555 += loop_dz2081Uz2089U_154974;
            if (!(tmp_offs_172555 == loop_dz2081Uz2089U_154974)) {
                lmad_copy_8b(ctx, 1, (uint64_t *) mem_172004.mem, tmp_offs_172555, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_172004.mem, loop_dz2081Uz2089U_154974, (int64_t []) {(int64_t) 1}, (int64_t []) {m_155192});
            }
            tmp_offs_172555 += m_155192;
            if (memblock_set(ctx, &mem_param_tmp_172517, &mem_172002, "mem_172002") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172518, &mem_172004, "mem_172004") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172519, &mem_171984, "mem_171984") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_tmp_172520, &mem_171982, "mem_171982") != 0)
                return 1;
            
            int64_t loop_dz2081Uz2089U_tmp_172521 = conc_tmp_155231;
            
            if (memblock_set(ctx, &mem_param_171839, &mem_param_tmp_172517, "mem_param_tmp_172517") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171842, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171845, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
                return 1;
            if (memblock_set(ctx, &mem_param_171849, &mem_param_tmp_172520, "mem_param_tmp_172520") != 0)
                return 1;
            loop_dz2081Uz2089U_154974 = loop_dz2081Uz2089U_tmp_172521;
        }
        if (memblock_set(ctx, &ext_mem_172017, &mem_param_171839, "mem_param_171839") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172016, &mem_param_171842, "mem_param_171842") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172015, &mem_param_171845, "mem_param_171845") != 0)
            return 1;
        if (memblock_set(ctx, &ext_mem_172014, &mem_param_171849, "mem_param_171849") != 0)
            return 1;
        loopres_154968 = loop_dz2081Uz2089U_154974;
        
        bool cond_155235 = slt64((int64_t) 0, loopres_154968);
        bool loop_cond_t_res_155236 = slt32(newDepth_154999, max_depth_131414);
        bool x_155237 = cond_155235 && loop_cond_t_res_155236;
        
        if (memblock_set(ctx, &mem_param_tmp_172506, &ext_mem_172015, "ext_mem_172015") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172507, &ext_mem_172014, "ext_mem_172014") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172508, &ext_mem_172017, "ext_mem_172017") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172509, &ext_mem_172016, "ext_mem_172016") != 0)
            return 1;
        
        int64_t loop_dz2087U_tmp_172510 = loopres_154968;
        bool loop_while_tmp_172511 = x_155237;
        int32_t p_tmp_172512 = newDepth_154999;
        
        if (memblock_set(ctx, &mem_param_171826, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171830, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171833, &mem_param_tmp_172508, "mem_param_tmp_172508") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171836, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        loop_dz2087U_154961 = loop_dz2087U_tmp_172510;
        loop_while_154962 = loop_while_tmp_172511;
        p_154963 = p_tmp_172512;
    }
    if (memblock_set(ctx, &ext_mem_172030, &mem_param_171826, "mem_param_171826") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172029, &mem_param_171830, "mem_param_171830") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172028, &mem_param_171833, "mem_param_171833") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_172027, &mem_param_171836, "mem_param_171836") != 0)
        return 1;
    partition_and_deepen_res_154954 = loop_dz2087U_154961;
    partition_and_deepen_res_154955 = loop_while_154962;
    partition_and_deepen_res_154956 = p_154963;
    if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171823, "mem_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_172030, "ext_mem_172030") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_172029, "ext_mem_172029") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173040, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173041, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171863);
        free(mem_171896);
        free(mem_171898);
        free(mem_171906);
        free(mem_171934);
        free(mem_171936);
        free(mem_171938);
        free(mem_171940);
        free(mem_171966);
        free(mem_171968);
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172508, "mem_param_tmp_172508") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172506, "mem_param_tmp_172506") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172520, "mem_param_tmp_172520") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172519, "mem_param_tmp_172519") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172518, "mem_param_tmp_172518") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172517, "mem_param_tmp_172517") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172004, "mem_172004") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_172002, "mem_172002") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171984, "mem_171984") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171982, "mem_171982") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171931, "ext_mem_171931") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171932, "ext_mem_171932") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171929, "mem_171929") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172528, "mem_param_tmp_172528") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172527, "mem_param_tmp_172527") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171887, "mem_171887") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171885, "mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172535, "mem_param_tmp_172535") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171874, "mem_171874") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171872, "mem_param_171872") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171883, "ext_mem_171883") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171858, "mem_param_171858") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171855, "mem_param_171855") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171926, "ext_mem_171926") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171927, "ext_mem_171927") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171849, "mem_param_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171845, "mem_param_171845") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171842, "mem_param_171842") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171839, "mem_param_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172014, "ext_mem_172014") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172015, "ext_mem_172015") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172016, "ext_mem_172016") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172017, "ext_mem_172017") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171836, "mem_param_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171833, "mem_param_171833") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171830, "mem_param_171830") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171826, "mem_param_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172027, "ext_mem_172027") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172028, "ext_mem_172028") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172029, "ext_mem_172029") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_172030, "ext_mem_172030") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171823, "mem_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_double(struct futhark_context *ctx, struct memblock *mem_out_p_173052, struct memblock *mem_out_p_173053, struct memblock xs_mem_171818, int64_t n_103190, int64_t incr_103191, int64_t block_sizze_103192)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_173054 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171860_cached_sizze_173055 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_173056 = 0;
    unsigned char *mem_171862 = NULL;
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_171888;
    
    mem_171888.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171839;
    
    mem_171839.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171848;
    
    ext_mem_171848.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock ext_mem_171886;
    
    ext_mem_171886.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_103190;
    
    if (futrts_indicesWithIncrement_16384(ctx, &ext_mem_171819, xs_mem_171818, n_103190, incr_103191) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_103190; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171828_cached_sizze_173054 < n_103190) {
        err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_173054, n_103190);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171827, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    for (int64_t i_156513 = 0; i_156513 < (int64_t) 32; i_156513++) {
        int32_t binop_x_156516 = sext_i64_i32(i_156513);
        int32_t binop_x_156517 = mul32(2, binop_x_156516);
        int32_t zm_lhs_156518 = add32(2, binop_x_156517);
        int32_t min_arg1_156519 = sub32(zm_lhs_156518, 1);
        int32_t min_res_156520 = smin32(64, min_arg1_156519);
        int32_t zp_lhs_156521 = sub32(64, binop_x_156517);
        int32_t ij_bits_156522 = add32(1, zp_lhs_156521);
        int32_t up_to_156523 = shl32(1, ij_bits_156522);
        int64_t tmp_156524 = sext_i32_i64(zp_lhs_156521);
        bool bounds_invalid_upwards_156525 = slt32(zp_lhs_156521, 0);
        bool valid_156527 = !bounds_invalid_upwards_156525;
        bool range_valid_c_156528;
        
        if (!valid_156527) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_156524, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:148:71-82\n   #6  ftRelational.fut:147:5-148:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156552 = sext_i32_i64(up_to_156523);
        bool bounds_invalid_upwards_156553 = slt32(up_to_156523, 0);
        bool valid_156554 = !bounds_invalid_upwards_156553;
        bool range_valid_c_156555;
        
        if (!valid_156554) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156552, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:148:71-82\n   #5  ftRelational.fut:147:5-148:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156594 = add32(8, min_res_156520);
        int32_t zs_lhs_156595 = sub32(zm_lhs_156594, 1);
        int32_t i32_arg0_156596 = sdiv32(zs_lhs_156595, 8);
        int64_t i32_res_156597 = sext_i32_i64(i32_arg0_156596);
        bool zzero_156598 = i32_res_156597 == (int64_t) 0;
        bool nonzzero_156599 = !zzero_156598;
        bool nonzzero_cert_156600;
        
        if (!nonzzero_156599) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:148:71-82\n   #5  ftRelational.fut:147:5-148:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156601 = sdiv64(block_sizze_103192, i32_res_156597);
        int64_t zm_lhs_156602 = add64(n_103190, psizze__156601);
        int64_t zs_lhs_156603 = sub64(zm_lhs_156602, (int64_t) 1);
        bool zzero_156604 = psizze__156601 == (int64_t) 0;
        bool nonzzero_156605 = !zzero_156604;
        bool nonzzero_cert_156606;
        
        if (!nonzzero_156605) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:148:71-82\n   #5  ftRelational.fut:147:5-148:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156607 = sdiv64(zs_lhs_156603, psizze__156601);
        bool bounds_invalid_upwards_156608 = slt64(max_iter_156607, (int64_t) 0);
        bool valid_156609 = !bounds_invalid_upwards_156608;
        bool range_valid_c_156610;
        
        if (!valid_156609) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156607, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:148:71-82\n   #6  ftRelational.fut:147:5-148:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_156526 = add64((int64_t) 1, tmp_156524);
        
        for (int64_t i_171547 = 0; i_171547 < n_103190; i_171547++) {
            double eta_p_156530 = ((double *) mem_param_171827.mem)[i_171547];
            int64_t i64_arg0_156531 = futrts_to_bits64(eta_p_156530);
            int64_t unsign_arg0_156532 = ashr64(i64_arg0_156531, (int64_t) 63);
            int64_t unsign_arg0_156533 = (int64_t) 1 & unsign_arg0_156532;
            int32_t to_i32_res_156534 = zext_i64_i32(unsign_arg0_156533);
            bool cond_156535 = to_i32_res_156534 == 1;
            bool x_156536 = !cond_156535;
            int8_t defunc_0_f_res_156537;
            int8_t y_156539 = (int8_t) 0;
            
            for (int64_t i_156538 = 0; i_156538 < distance_156526; i_156538++) {
                int32_t binop_x_156540 = sext_i64_i32(i_156538);
                int32_t get_bit_arg0_156541 = add32(binop_x_156517, binop_x_156540);
                int64_t unsign_arg0_156542 = zext_i32_i64(get_bit_arg0_156541);
                int64_t unsign_arg0_156543 = ashr64(i64_arg0_156531, unsign_arg0_156542);
                int64_t unsign_arg0_156544 = (int64_t) 1 & unsign_arg0_156543;
                int32_t to_i32_res_156545 = zext_i64_i32(unsign_arg0_156544);
                bool cond_f_res_156546 = get_bit_arg0_156541 == 63;
                bool y_156547 = x_156536 && cond_f_res_156546;
                bool cond_156548 = cond_156535 || y_156547;
                int32_t defunc_0_get_bit_res_156549;
                
                if (cond_156548) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ to_i32_res_156545;
                    
                    defunc_0_get_bit_res_156549 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_156549 = to_i32_res_156545;
                }
                
                int8_t loopres_156551;
                
                if (futrts_set_bit_2464(ctx, &loopres_156551, binop_x_156540, y_156539, defunc_0_get_bit_res_156549) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_156551;
                
                y_156539 = y_tmp_172508;
            }
            defunc_0_f_res_156537 = y_156539;
            ((int8_t *) mem_171828)[i_171547] = defunc_0_f_res_156537;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156556;
        int64_t offs_156559;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_156559 = (int64_t) 0;
        for (int64_t i_156558 = 0; i_156558 < up_to_156552; i_156558++) {
            int32_t binop_x_156561 = sext_i64_i32(i_156558);
            int8_t index_primexp_156562 = zext_i32_i8(binop_x_156561);
            
            if (memblock_alloc(ctx, &mem_171839, bytes_171820, "mem_171839")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_103190; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171828)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_156562;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171837.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_156559, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171839.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_156587 = add64(offs_156559, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171839, "mem_171839") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_156587;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_156559 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171848, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156556 = offs_156559;
        if (memblock_alloc(ctx, &mem_171850, bytes_171820, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_103190});
        if (memblock_alloc(ctx, &mem_171852, bytes_171820, "mem_171852")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171852.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_103190});
        for (int64_t i_156613 = 0; i_156613 < max_iter_156607; i_156613++) {
            int64_t inf_156616 = mul64(psizze__156601, i_156613);
            int64_t min_arg1_156617 = add64(psizze__156601, inf_156616);
            int64_t min_res_156618 = smin64(n_103190, min_arg1_156617);
            bool zzero_lte_i_156628 = sle64((int64_t) 0, inf_156616);
            int64_t j_m_i_156622 = sub64(min_res_156618, inf_156616);
            int64_t m_156624 = sub64(j_m_i_156622, (int64_t) 1);
            int64_t i_p_m_t_s_156625 = add64(inf_156616, m_156624);
            bool i_p_m_t_s_leq_w_156627 = slt64(i_p_m_t_s_156625, n_103190);
            bool y_156630 = i_p_m_t_s_leq_w_156627 && zzero_lte_i_156628;
            bool zzero_leq_i_p_m_t_s_156626 = sle64((int64_t) 0, i_p_m_t_s_156625);
            bool y_156631 = zzero_leq_i_p_m_t_s_156626 && y_156630;
            bool i_lte_j_156629 = sle64(inf_156616, min_res_156618);
            bool forwards_ok_156632 = i_lte_j_156629 && y_156631;
            bool empty_slice_156623 = j_m_i_156622 == (int64_t) 0;
            bool ok_or_empty_156633 = empty_slice_156623 || forwards_ok_156632;
            bool index_certs_156634;
            
            if (!ok_or_empty_156633) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156616, ":", (long long) min_res_156618, "] out of bounds for array of shape [", (long long) n_103190, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:148:71-82\n   #5  ftRelational.fut:147:5-148:83\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171859 = (int64_t) 8 * j_m_i_156622;
            
            if (mem_171860_cached_sizze_173055 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_173055, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171852.mem, (int64_t) 0 + (int64_t) 1 * inf_156616, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156622});
            if (mem_171862_cached_sizze_173056 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173056, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171850.mem, (int64_t) 0 + (int64_t) 1 * inf_156616, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156622});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_103190; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171848.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                double write_iv_171572 = ((double *) mem_param_171827.mem)[write_iter_171567];
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_156616);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156622)) {
                    ((int64_t *) mem_171862)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156622)) {
                    ((double *) mem_171860)[lifted_lambda_res_162803] = write_iv_171572;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, inf_156616, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156622});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171852.mem, inf_156616, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156622});
        }
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171886, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171885, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171888, bytes_171820, "mem_171888")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_103190});
    if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171890, bytes_171820, "mem_171890")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_103190});
    if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171888, "mem_171888") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171890, "mem_171890") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173052, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173053, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171860);
        free(mem_171862);
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171888, "mem_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171839, "mem_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_float(struct futhark_context *ctx, struct memblock *mem_out_p_173057, struct memblock *mem_out_p_173058, struct memblock xs_mem_171818, int64_t n_102308, int64_t incr_102309, int64_t block_sizze_102310)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_173059 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171860_cached_sizze_173060 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_173061 = 0;
    unsigned char *mem_171862 = NULL;
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_171888;
    
    mem_171888.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171839;
    
    mem_171839.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171848;
    
    ext_mem_171848.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock ext_mem_171886;
    
    ext_mem_171886.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_102308;
    int64_t bytes_171889 = (int64_t) 4 * n_102308;
    
    if (futrts_indicesWithIncrement_16363(ctx, &ext_mem_171819, xs_mem_171818, n_102308, incr_102309) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_102308; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171828_cached_sizze_173059 < n_102308) {
        err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_173059, n_102308);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171827, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    for (int64_t i_156512 = 0; i_156512 < (int64_t) 16; i_156512++) {
        int32_t binop_x_156515 = sext_i64_i32(i_156512);
        int32_t binop_x_156516 = mul32(2, binop_x_156515);
        int32_t zm_lhs_156517 = add32(2, binop_x_156516);
        int32_t min_arg1_156518 = sub32(zm_lhs_156517, 1);
        int32_t min_res_156519 = smin32(32, min_arg1_156518);
        int32_t zp_lhs_156520 = sub32(32, binop_x_156516);
        int32_t ij_bits_156521 = add32(1, zp_lhs_156520);
        int32_t up_to_156522 = shl32(1, ij_bits_156521);
        int64_t tmp_156523 = sext_i32_i64(zp_lhs_156520);
        bool bounds_invalid_upwards_156524 = slt32(zp_lhs_156520, 0);
        bool valid_156526 = !bounds_invalid_upwards_156524;
        bool range_valid_c_156527;
        
        if (!valid_156526) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_156523, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:146:71-82\n   #6  ftRelational.fut:145:5-146:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156548 = sext_i32_i64(up_to_156522);
        bool bounds_invalid_upwards_156549 = slt32(up_to_156522, 0);
        bool valid_156550 = !bounds_invalid_upwards_156549;
        bool range_valid_c_156551;
        
        if (!valid_156550) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156548, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:146:71-82\n   #5  ftRelational.fut:145:5-146:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156590 = add32(8, min_res_156519);
        int32_t zs_lhs_156591 = sub32(zm_lhs_156590, 1);
        int32_t i32_arg0_156592 = sdiv32(zs_lhs_156591, 8);
        int64_t i32_res_156593 = sext_i32_i64(i32_arg0_156592);
        bool zzero_156594 = i32_res_156593 == (int64_t) 0;
        bool nonzzero_156595 = !zzero_156594;
        bool nonzzero_cert_156596;
        
        if (!nonzzero_156595) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:146:71-82\n   #5  ftRelational.fut:145:5-146:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156597 = sdiv64(block_sizze_102310, i32_res_156593);
        int64_t zm_lhs_156598 = add64(n_102308, psizze__156597);
        int64_t zs_lhs_156599 = sub64(zm_lhs_156598, (int64_t) 1);
        bool zzero_156600 = psizze__156597 == (int64_t) 0;
        bool nonzzero_156601 = !zzero_156600;
        bool nonzzero_cert_156602;
        
        if (!nonzzero_156601) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:146:71-82\n   #5  ftRelational.fut:145:5-146:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156603 = sdiv64(zs_lhs_156599, psizze__156597);
        bool bounds_invalid_upwards_156604 = slt64(max_iter_156603, (int64_t) 0);
        bool valid_156605 = !bounds_invalid_upwards_156604;
        bool range_valid_c_156606;
        
        if (!valid_156605) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156603, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:142:90-93\n   #5  ftRelational.fut:146:71-82\n   #6  ftRelational.fut:145:5-146:83\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_156525 = add64((int64_t) 1, tmp_156523);
        
        for (int64_t i_171547 = 0; i_171547 < n_102308; i_171547++) {
            float eta_p_156529 = ((float *) mem_param_171827.mem)[i_171547];
            int32_t i32_arg0_156530 = futrts_to_bits32(eta_p_156529);
            int32_t unsign_arg0_156531 = ashr32(i32_arg0_156530, 31);
            int32_t unsign_arg0_156532 = 1 & unsign_arg0_156531;
            bool cond_156533 = unsign_arg0_156532 == 1;
            bool x_156534 = !cond_156533;
            int8_t defunc_0_f_res_156535;
            int8_t y_156537 = (int8_t) 0;
            
            for (int64_t i_156536 = 0; i_156536 < distance_156525; i_156536++) {
                int32_t binop_x_156538 = sext_i64_i32(i_156536);
                int32_t get_bit_arg0_156539 = add32(binop_x_156516, binop_x_156538);
                int32_t unsign_arg0_156540 = ashr32(i32_arg0_156530, get_bit_arg0_156539);
                int32_t unsign_arg0_156541 = 1 & unsign_arg0_156540;
                bool cond_f_res_156542 = get_bit_arg0_156539 == 31;
                bool y_156543 = x_156534 && cond_f_res_156542;
                bool cond_156544 = cond_156533 || y_156543;
                int32_t defunc_0_get_bit_res_156545;
                
                if (cond_156544) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ unsign_arg0_156541;
                    
                    defunc_0_get_bit_res_156545 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_156545 = unsign_arg0_156541;
                }
                
                int8_t loopres_156547;
                
                if (futrts_set_bit_2464(ctx, &loopres_156547, binop_x_156538, y_156537, defunc_0_get_bit_res_156545) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_156547;
                
                y_156537 = y_tmp_172508;
            }
            defunc_0_f_res_156535 = y_156537;
            ((int8_t *) mem_171828)[i_171547] = defunc_0_f_res_156535;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156552;
        int64_t offs_156555;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_156555 = (int64_t) 0;
        for (int64_t i_156554 = 0; i_156554 < up_to_156548; i_156554++) {
            int32_t binop_x_156557 = sext_i64_i32(i_156554);
            int8_t index_primexp_156558 = zext_i32_i8(binop_x_156557);
            
            if (memblock_alloc(ctx, &mem_171839, bytes_171820, "mem_171839")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_102308; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171828)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_156558;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171837.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_156555, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171839.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_156583 = add64(offs_156555, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171839, "mem_171839") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_156583;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_156555 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171848, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156552 = offs_156555;
        if (memblock_alloc(ctx, &mem_171850, bytes_171820, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102308});
        if (memblock_alloc(ctx, &mem_171852, bytes_171889, "mem_171852")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171852.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102308});
        for (int64_t i_156609 = 0; i_156609 < max_iter_156603; i_156609++) {
            int64_t inf_156612 = mul64(psizze__156597, i_156609);
            int64_t min_arg1_156613 = add64(psizze__156597, inf_156612);
            int64_t min_res_156614 = smin64(n_102308, min_arg1_156613);
            bool zzero_lte_i_156624 = sle64((int64_t) 0, inf_156612);
            int64_t j_m_i_156618 = sub64(min_res_156614, inf_156612);
            int64_t m_156620 = sub64(j_m_i_156618, (int64_t) 1);
            int64_t i_p_m_t_s_156621 = add64(inf_156612, m_156620);
            bool i_p_m_t_s_leq_w_156623 = slt64(i_p_m_t_s_156621, n_102308);
            bool y_156626 = i_p_m_t_s_leq_w_156623 && zzero_lte_i_156624;
            bool zzero_leq_i_p_m_t_s_156622 = sle64((int64_t) 0, i_p_m_t_s_156621);
            bool y_156627 = zzero_leq_i_p_m_t_s_156622 && y_156626;
            bool i_lte_j_156625 = sle64(inf_156612, min_res_156614);
            bool forwards_ok_156628 = i_lte_j_156625 && y_156627;
            bool empty_slice_156619 = j_m_i_156618 == (int64_t) 0;
            bool ok_or_empty_156629 = empty_slice_156619 || forwards_ok_156628;
            bool index_certs_156630;
            
            if (!ok_or_empty_156629) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156612, ":", (long long) min_res_156614, "] out of bounds for array of shape [", (long long) n_102308, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:142:90-93\n   #4  ftRelational.fut:146:71-82\n   #5  ftRelational.fut:145:5-146:83\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171859 = (int64_t) 4 * j_m_i_156618;
            int64_t bytes_171861 = (int64_t) 8 * j_m_i_156618;
            
            if (mem_171860_cached_sizze_173060 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_173060, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171852.mem, (int64_t) 0 + (int64_t) 1 * inf_156612, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156618});
            if (mem_171862_cached_sizze_173061 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173061, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171850.mem, (int64_t) 0 + (int64_t) 1 * inf_156612, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156618});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_102308; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171848.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                float write_iv_171572 = ((float *) mem_param_171827.mem)[write_iter_171567];
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_156612);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156618)) {
                    ((int64_t *) mem_171862)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156618)) {
                    ((float *) mem_171860)[lifted_lambda_res_162803] = write_iv_171572;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, inf_156612, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156618});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171852.mem, inf_156612, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156618});
        }
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171886, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171885, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171888, bytes_171820, "mem_171888")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102308});
    if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171890, bytes_171889, "mem_171890")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_102308});
    if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171888, "mem_171888") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171890, "mem_171890") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173057, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173058, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171860);
        free(mem_171862);
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171888, "mem_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171839, "mem_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_int(struct futhark_context *ctx, struct memblock *mem_out_p_173062, struct memblock *mem_out_p_173063, struct memblock xs_mem_171818, int64_t n_100565, int64_t incr_100566, int64_t block_sizze_100567)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_173064 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171860_cached_sizze_173065 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_173066 = 0;
    unsigned char *mem_171862 = NULL;
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_171888;
    
    mem_171888.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171839;
    
    mem_171839.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171848;
    
    ext_mem_171848.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock ext_mem_171886;
    
    ext_mem_171886.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_100565;
    int64_t bytes_171889 = (int64_t) 4 * n_100565;
    
    if (futrts_indicesWithIncrement_16319(ctx, &ext_mem_171819, xs_mem_171818, n_100565, incr_100566) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_100565; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171828_cached_sizze_173064 < n_100565) {
        err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_173064, n_100565);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171827, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    for (int64_t i_154965 = 0; i_154965 < (int64_t) 16; i_154965++) {
        int32_t binop_x_154968 = sext_i64_i32(i_154965);
        int32_t binop_x_154969 = mul32(2, binop_x_154968);
        int32_t zm_lhs_154970 = add32(2, binop_x_154969);
        int32_t min_arg1_154971 = sub32(zm_lhs_154970, 1);
        int32_t min_res_154972 = smin32(32, min_arg1_154971);
        int32_t zp_lhs_154973 = sub32(32, binop_x_154969);
        int32_t ij_bits_154974 = add32(1, zp_lhs_154973);
        int32_t up_to_154975 = shl32(1, ij_bits_154974);
        int64_t tmp_154976 = sext_i32_i64(zp_lhs_154973);
        bool bounds_invalid_upwards_154977 = slt32(zp_lhs_154973, 0);
        bool valid_154979 = !bounds_invalid_upwards_154977;
        bool range_valid_c_154980;
        
        if (!valid_154979) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154976, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:142:74-85\n   #6  ftRelational.fut:141:5-142:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154993 = sext_i32_i64(up_to_154975);
        bool bounds_invalid_upwards_154994 = slt32(up_to_154975, 0);
        bool valid_154995 = !bounds_invalid_upwards_154994;
        bool range_valid_c_154996;
        
        if (!valid_154995) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154993, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:142:74-85\n   #5  ftRelational.fut:141:5-142:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155035 = add32(8, min_res_154972);
        int32_t zs_lhs_155036 = sub32(zm_lhs_155035, 1);
        int32_t i32_arg0_155037 = sdiv32(zs_lhs_155036, 8);
        int64_t i32_res_155038 = sext_i32_i64(i32_arg0_155037);
        bool zzero_155039 = i32_res_155038 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:142:74-85\n   #5  ftRelational.fut:141:5-142:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155042 = sdiv64(block_sizze_100567, i32_res_155038);
        int64_t zm_lhs_155043 = add64(n_100565, psizze__155042);
        int64_t zs_lhs_155044 = sub64(zm_lhs_155043, (int64_t) 1);
        bool zzero_155045 = psizze__155042 == (int64_t) 0;
        bool nonzzero_155046 = !zzero_155045;
        bool nonzzero_cert_155047;
        
        if (!nonzzero_155046) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:142:74-85\n   #5  ftRelational.fut:141:5-142:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155048 = sdiv64(zs_lhs_155044, psizze__155042);
        bool bounds_invalid_upwards_155049 = slt64(max_iter_155048, (int64_t) 0);
        bool valid_155050 = !bounds_invalid_upwards_155049;
        bool range_valid_c_155051;
        
        if (!valid_155050) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155048, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:142:74-85\n   #6  ftRelational.fut:141:5-142:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154978 = add64((int64_t) 1, tmp_154976);
        
        for (int64_t i_171547 = 0; i_171547 < n_100565; i_171547++) {
            int32_t eta_p_154982 = ((int32_t *) mem_param_171827.mem)[i_171547];
            int8_t defunc_0_f_res_154983;
            int8_t y_154985 = (int8_t) 0;
            
            for (int64_t i_154984 = 0; i_154984 < distance_154978; i_154984++) {
                int32_t binop_x_154986 = sext_i64_i32(i_154984);
                int32_t get_bit_arg0_154987 = add32(binop_x_154969, binop_x_154986);
                int32_t zgzg_res_162320 = ashr32(eta_p_154982, get_bit_arg0_154987);
                int32_t za_res_162321 = 1 & zgzg_res_162320;
                bool cond_154989 = get_bit_arg0_154987 == 31;
                int32_t defunc_0_get_bit_res_154990;
                
                if (cond_154989) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ za_res_162321;
                    
                    defunc_0_get_bit_res_154990 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154990 = za_res_162321;
                }
                
                int8_t loopres_154992;
                
                if (futrts_set_bit_2464(ctx, &loopres_154992, binop_x_154986, y_154985, defunc_0_get_bit_res_154990) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154992;
                
                y_154985 = y_tmp_172508;
            }
            defunc_0_f_res_154983 = y_154985;
            ((int8_t *) mem_171828)[i_171547] = defunc_0_f_res_154983;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154997;
        int64_t offs_155000;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_155000 = (int64_t) 0;
        for (int64_t i_154999 = 0; i_154999 < up_to_154993; i_154999++) {
            int32_t binop_x_155002 = sext_i64_i32(i_154999);
            int8_t index_primexp_155003 = zext_i32_i8(binop_x_155002);
            
            if (memblock_alloc(ctx, &mem_171839, bytes_171820, "mem_171839")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_100565; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171828)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_155003;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171837.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_155000, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171839.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155028 = add64(offs_155000, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171839, "mem_171839") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155028;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_155000 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171848, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154997 = offs_155000;
        if (memblock_alloc(ctx, &mem_171850, bytes_171820, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100565});
        if (memblock_alloc(ctx, &mem_171852, bytes_171889, "mem_171852")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171852.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100565});
        for (int64_t i_155054 = 0; i_155054 < max_iter_155048; i_155054++) {
            int64_t inf_155057 = mul64(psizze__155042, i_155054);
            int64_t min_arg1_155058 = add64(psizze__155042, inf_155057);
            int64_t min_res_155059 = smin64(n_100565, min_arg1_155058);
            bool zzero_lte_i_155069 = sle64((int64_t) 0, inf_155057);
            int64_t j_m_i_155063 = sub64(min_res_155059, inf_155057);
            int64_t m_155065 = sub64(j_m_i_155063, (int64_t) 1);
            int64_t i_p_m_t_s_155066 = add64(inf_155057, m_155065);
            bool i_p_m_t_s_leq_w_155068 = slt64(i_p_m_t_s_155066, n_100565);
            bool y_155071 = i_p_m_t_s_leq_w_155068 && zzero_lte_i_155069;
            bool zzero_leq_i_p_m_t_s_155067 = sle64((int64_t) 0, i_p_m_t_s_155066);
            bool y_155072 = zzero_leq_i_p_m_t_s_155067 && y_155071;
            bool i_lte_j_155070 = sle64(inf_155057, min_res_155059);
            bool forwards_ok_155073 = i_lte_j_155070 && y_155072;
            bool empty_slice_155064 = j_m_i_155063 == (int64_t) 0;
            bool ok_or_empty_155074 = empty_slice_155064 || forwards_ok_155073;
            bool index_certs_155075;
            
            if (!ok_or_empty_155074) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155057, ":", (long long) min_res_155059, "] out of bounds for array of shape [", (long long) n_100565, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:142:74-85\n   #5  ftRelational.fut:141:5-142:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171859 = (int64_t) 4 * j_m_i_155063;
            int64_t bytes_171861 = (int64_t) 8 * j_m_i_155063;
            
            if (mem_171860_cached_sizze_173065 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_173065, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171852.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            if (mem_171862_cached_sizze_173066 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173066, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171850.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_100565; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171848.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                int32_t write_iv_171572 = ((int32_t *) mem_param_171827.mem)[write_iter_171567];
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155057);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int64_t *) mem_171862)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int32_t *) mem_171860)[lifted_lambda_res_162803] = write_iv_171572;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171852.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
        }
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171886, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171885, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171888, bytes_171820, "mem_171888")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100565});
    if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171890, bytes_171889, "mem_171890")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_100565});
    if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171888, "mem_171888") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171890, "mem_171890") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173062, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173063, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171860);
        free(mem_171862);
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171888, "mem_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171839, "mem_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_long(struct futhark_context *ctx, struct memblock *mem_out_p_173067, struct memblock *mem_out_p_173068, struct memblock xs_mem_171818, int64_t n_101426, int64_t incr_101427, int64_t block_sizze_101428)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_173069 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171860_cached_sizze_173070 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_173071 = 0;
    unsigned char *mem_171862 = NULL;
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_171888;
    
    mem_171888.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171839;
    
    mem_171839.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171848;
    
    ext_mem_171848.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock ext_mem_171886;
    
    ext_mem_171886.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_101426;
    
    if (futrts_indicesWithIncrement_16341(ctx, &ext_mem_171819, xs_mem_171818, n_101426, incr_101427) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_101426; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171828_cached_sizze_173069 < n_101426) {
        err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_173069, n_101426);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171827, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    for (int64_t i_154965 = 0; i_154965 < (int64_t) 32; i_154965++) {
        int32_t binop_x_154968 = sext_i64_i32(i_154965);
        int32_t binop_x_154969 = mul32(2, binop_x_154968);
        int32_t zm_lhs_154970 = add32(2, binop_x_154969);
        int32_t min_arg1_154971 = sub32(zm_lhs_154970, 1);
        int32_t min_res_154972 = smin32(64, min_arg1_154971);
        int32_t zp_lhs_154973 = sub32(64, binop_x_154969);
        int32_t ij_bits_154974 = add32(1, zp_lhs_154973);
        int32_t up_to_154975 = shl32(1, ij_bits_154974);
        int64_t tmp_154976 = sext_i32_i64(zp_lhs_154973);
        bool bounds_invalid_upwards_154977 = slt32(zp_lhs_154973, 0);
        bool valid_154979 = !bounds_invalid_upwards_154977;
        bool range_valid_c_154980;
        
        if (!valid_154979) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154976, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:144:74-85\n   #6  ftRelational.fut:143:5-144:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154993 = sext_i32_i64(up_to_154975);
        bool bounds_invalid_upwards_154994 = slt32(up_to_154975, 0);
        bool valid_154995 = !bounds_invalid_upwards_154994;
        bool range_valid_c_154996;
        
        if (!valid_154995) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154993, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:144:74-85\n   #5  ftRelational.fut:143:5-144:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155035 = add32(8, min_res_154972);
        int32_t zs_lhs_155036 = sub32(zm_lhs_155035, 1);
        int32_t i32_arg0_155037 = sdiv32(zs_lhs_155036, 8);
        int64_t i32_res_155038 = sext_i32_i64(i32_arg0_155037);
        bool zzero_155039 = i32_res_155038 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:144:74-85\n   #5  ftRelational.fut:143:5-144:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155042 = sdiv64(block_sizze_101428, i32_res_155038);
        int64_t zm_lhs_155043 = add64(n_101426, psizze__155042);
        int64_t zs_lhs_155044 = sub64(zm_lhs_155043, (int64_t) 1);
        bool zzero_155045 = psizze__155042 == (int64_t) 0;
        bool nonzzero_155046 = !zzero_155045;
        bool nonzzero_cert_155047;
        
        if (!nonzzero_155046) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:144:74-85\n   #5  ftRelational.fut:143:5-144:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155048 = sdiv64(zs_lhs_155044, psizze__155042);
        bool bounds_invalid_upwards_155049 = slt64(max_iter_155048, (int64_t) 0);
        bool valid_155050 = !bounds_invalid_upwards_155049;
        bool range_valid_c_155051;
        
        if (!valid_155050) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155048, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:144:74-85\n   #6  ftRelational.fut:143:5-144:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154978 = add64((int64_t) 1, tmp_154976);
        
        for (int64_t i_171547 = 0; i_171547 < n_101426; i_171547++) {
            int64_t eta_p_154982 = ((int64_t *) mem_param_171827.mem)[i_171547];
            int8_t defunc_0_f_res_154983;
            int8_t y_154985 = (int8_t) 0;
            
            for (int64_t i_154984 = 0; i_154984 < distance_154978; i_154984++) {
                int32_t binop_x_154986 = sext_i64_i32(i_154984);
                int32_t get_bit_arg0_154987 = add32(binop_x_154969, binop_x_154986);
                int32_t defunc_0_get_bit_res_154988;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_154988, get_bit_arg0_154987, eta_p_154982) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154989 = get_bit_arg0_154987 == 63;
                int32_t defunc_0_get_bit_res_154990;
                
                if (cond_154989) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ defunc_0_get_bit_res_154988;
                    
                    defunc_0_get_bit_res_154990 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154990 = defunc_0_get_bit_res_154988;
                }
                
                int8_t loopres_154992;
                
                if (futrts_set_bit_2464(ctx, &loopres_154992, binop_x_154986, y_154985, defunc_0_get_bit_res_154990) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154992;
                
                y_154985 = y_tmp_172508;
            }
            defunc_0_f_res_154983 = y_154985;
            ((int8_t *) mem_171828)[i_171547] = defunc_0_f_res_154983;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154997;
        int64_t offs_155000;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_155000 = (int64_t) 0;
        for (int64_t i_154999 = 0; i_154999 < up_to_154993; i_154999++) {
            int32_t binop_x_155002 = sext_i64_i32(i_154999);
            int8_t index_primexp_155003 = zext_i32_i8(binop_x_155002);
            
            if (memblock_alloc(ctx, &mem_171839, bytes_171820, "mem_171839")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_101426; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171828)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_155003;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171837.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_155000, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171839.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155028 = add64(offs_155000, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171839, "mem_171839") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155028;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_155000 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171848, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154997 = offs_155000;
        if (memblock_alloc(ctx, &mem_171850, bytes_171820, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101426});
        if (memblock_alloc(ctx, &mem_171852, bytes_171820, "mem_171852")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171852.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101426});
        for (int64_t i_155054 = 0; i_155054 < max_iter_155048; i_155054++) {
            int64_t inf_155057 = mul64(psizze__155042, i_155054);
            int64_t min_arg1_155058 = add64(psizze__155042, inf_155057);
            int64_t min_res_155059 = smin64(n_101426, min_arg1_155058);
            bool zzero_lte_i_155069 = sle64((int64_t) 0, inf_155057);
            int64_t j_m_i_155063 = sub64(min_res_155059, inf_155057);
            int64_t m_155065 = sub64(j_m_i_155063, (int64_t) 1);
            int64_t i_p_m_t_s_155066 = add64(inf_155057, m_155065);
            bool i_p_m_t_s_leq_w_155068 = slt64(i_p_m_t_s_155066, n_101426);
            bool y_155071 = i_p_m_t_s_leq_w_155068 && zzero_lte_i_155069;
            bool zzero_leq_i_p_m_t_s_155067 = sle64((int64_t) 0, i_p_m_t_s_155066);
            bool y_155072 = zzero_leq_i_p_m_t_s_155067 && y_155071;
            bool i_lte_j_155070 = sle64(inf_155057, min_res_155059);
            bool forwards_ok_155073 = i_lte_j_155070 && y_155072;
            bool empty_slice_155064 = j_m_i_155063 == (int64_t) 0;
            bool ok_or_empty_155074 = empty_slice_155064 || forwards_ok_155073;
            bool index_certs_155075;
            
            if (!ok_or_empty_155074) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155057, ":", (long long) min_res_155059, "] out of bounds for array of shape [", (long long) n_101426, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:144:74-85\n   #5  ftRelational.fut:143:5-144:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171859 = (int64_t) 8 * j_m_i_155063;
            
            if (mem_171860_cached_sizze_173070 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_173070, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171852.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            if (mem_171862_cached_sizze_173071 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173071, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171850.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_101426; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171848.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                int64_t write_iv_171572 = ((int64_t *) mem_param_171827.mem)[write_iter_171567];
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155057);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int64_t *) mem_171862)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int64_t *) mem_171860)[lifted_lambda_res_162803] = write_iv_171572;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171852.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
        }
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171886, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171885, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171888, bytes_171820, "mem_171888")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101426});
    if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171890, bytes_171820, "mem_171890")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_101426});
    if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171888, "mem_171888") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171890, "mem_171890") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173067, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173068, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171860);
        free(mem_171862);
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171888, "mem_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171839, "mem_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortColumn_short(struct futhark_context *ctx, struct memblock *mem_out_p_173072, struct memblock *mem_out_p_173073, struct memblock xs_mem_171818, int64_t n_99704, int64_t incr_99705, int64_t block_sizze_99706)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171828_cached_sizze_173074 = 0;
    unsigned char *mem_171828 = NULL;
    int64_t mem_171860_cached_sizze_173075 = 0;
    unsigned char *mem_171860 = NULL;
    int64_t mem_171862_cached_sizze_173076 = 0;
    unsigned char *mem_171862 = NULL;
    struct memblock mem_171890;
    
    mem_171890.references = NULL;
    
    struct memblock mem_171888;
    
    mem_171888.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171852;
    
    mem_171852.references = NULL;
    
    struct memblock mem_171850;
    
    mem_171850.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171839;
    
    mem_171839.references = NULL;
    
    struct memblock mem_param_171837;
    
    mem_param_171837.references = NULL;
    
    struct memblock ext_mem_171848;
    
    ext_mem_171848.references = NULL;
    
    struct memblock mem_param_171827;
    
    mem_param_171827.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171885;
    
    ext_mem_171885.references = NULL;
    
    struct memblock ext_mem_171886;
    
    ext_mem_171886.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock ext_mem_171819;
    
    ext_mem_171819.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_99704;
    int64_t bytes_171889 = (int64_t) 2 * n_99704;
    
    if (futrts_indicesWithIncrement_16298(ctx, &ext_mem_171819, xs_mem_171818, n_99704, incr_99705) != 0) {
        err = 1;
        goto cleanup;
    }
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_99704; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171828_cached_sizze_173074 < n_99704) {
        err = lexical_realloc(ctx, &mem_171828, &mem_171828_cached_sizze_173074, n_99704);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171827, &xs_mem_171818, "xs_mem_171818") != 0)
        return 1;
    for (int64_t i_154965 = 0; i_154965 < (int64_t) 8; i_154965++) {
        int32_t binop_x_154968 = sext_i64_i32(i_154965);
        int32_t binop_x_154969 = mul32(2, binop_x_154968);
        int32_t zm_lhs_154970 = add32(2, binop_x_154969);
        int32_t min_arg1_154971 = sub32(zm_lhs_154970, 1);
        int32_t min_res_154972 = smin32(16, min_arg1_154971);
        int32_t zp_lhs_154973 = sub32(16, binop_x_154969);
        int32_t ij_bits_154974 = add32(1, zp_lhs_154973);
        int32_t up_to_154975 = shl32(1, ij_bits_154974);
        int64_t tmp_154976 = sext_i32_i64(zp_lhs_154973);
        bool bounds_invalid_upwards_154977 = slt32(zp_lhs_154973, 0);
        bool valid_154979 = !bounds_invalid_upwards_154977;
        bool range_valid_c_154980;
        
        if (!valid_154979) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154976, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:140:74-85\n   #6  ftRelational.fut:139:5-140:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154993 = sext_i32_i64(up_to_154975);
        bool bounds_invalid_upwards_154994 = slt32(up_to_154975, 0);
        bool valid_154995 = !bounds_invalid_upwards_154994;
        bool range_valid_c_154996;
        
        if (!valid_154995) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154993, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:140:74-85\n   #5  ftRelational.fut:139:5-140:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155035 = add32(8, min_res_154972);
        int32_t zs_lhs_155036 = sub32(zm_lhs_155035, 1);
        int32_t i32_arg0_155037 = sdiv32(zs_lhs_155036, 8);
        int64_t i32_res_155038 = sext_i32_i64(i32_arg0_155037);
        bool zzero_155039 = i32_res_155038 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:140:74-85\n   #5  ftRelational.fut:139:5-140:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155042 = sdiv64(block_sizze_99706, i32_res_155038);
        int64_t zm_lhs_155043 = add64(n_99704, psizze__155042);
        int64_t zs_lhs_155044 = sub64(zm_lhs_155043, (int64_t) 1);
        bool zzero_155045 = psizze__155042 == (int64_t) 0;
        bool nonzzero_155046 = !zzero_155045;
        bool nonzzero_cert_155047;
        
        if (!nonzzero_155046) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:140:74-85\n   #5  ftRelational.fut:139:5-140:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155048 = sdiv64(zs_lhs_155044, psizze__155042);
        bool bounds_invalid_upwards_155049 = slt64(max_iter_155048, (int64_t) 0);
        bool valid_155050 = !bounds_invalid_upwards_155049;
        bool range_valid_c_155051;
        
        if (!valid_155050) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155048, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:131:88-91\n   #5  ftRelational.fut:140:74-85\n   #6  ftRelational.fut:139:5-140:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154978 = add64((int64_t) 1, tmp_154976);
        
        for (int64_t i_171547 = 0; i_171547 < n_99704; i_171547++) {
            int16_t eta_p_154982 = ((int16_t *) mem_param_171827.mem)[i_171547];
            int8_t defunc_0_f_res_154983;
            int8_t y_154985 = (int8_t) 0;
            
            for (int64_t i_154984 = 0; i_154984 < distance_154978; i_154984++) {
                int32_t binop_x_154986 = sext_i64_i32(i_154984);
                int32_t get_bit_arg0_154987 = add32(binop_x_154969, binop_x_154986);
                int32_t defunc_0_get_bit_res_154988;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_154988, get_bit_arg0_154987, eta_p_154982) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154989 = get_bit_arg0_154987 == 15;
                int32_t defunc_0_get_bit_res_154990;
                
                if (cond_154989) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ defunc_0_get_bit_res_154988;
                    
                    defunc_0_get_bit_res_154990 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154990 = defunc_0_get_bit_res_154988;
                }
                
                int8_t loopres_154992;
                
                if (futrts_set_bit_2464(ctx, &loopres_154992, binop_x_154986, y_154985, defunc_0_get_bit_res_154990) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154992;
                
                y_154985 = y_tmp_172508;
            }
            defunc_0_f_res_154983 = y_154985;
            ((int8_t *) mem_171828)[i_171547] = defunc_0_f_res_154983;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154997;
        int64_t offs_155000;
        
        if (memblock_set(ctx, &mem_param_171837, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_155000 = (int64_t) 0;
        for (int64_t i_154999 = 0; i_154999 < up_to_154993; i_154999++) {
            int32_t binop_x_155002 = sext_i64_i32(i_154999);
            int8_t index_primexp_155003 = zext_i32_i8(binop_x_155002);
            
            if (memblock_alloc(ctx, &mem_171839, bytes_171820, "mem_171839")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_99704; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171828)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_155003;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171837.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_155000, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171839.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155028 = add64(offs_155000, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171839, "mem_171839") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155028;
            
            if (memblock_set(ctx, &mem_param_171837, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_155000 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171848, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154997 = offs_155000;
        if (memblock_alloc(ctx, &mem_171850, bytes_171820, "mem_171850")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99704});
        if (memblock_alloc(ctx, &mem_171852, bytes_171889, "mem_171852")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_171852.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_171827.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99704});
        for (int64_t i_155054 = 0; i_155054 < max_iter_155048; i_155054++) {
            int64_t inf_155057 = mul64(psizze__155042, i_155054);
            int64_t min_arg1_155058 = add64(psizze__155042, inf_155057);
            int64_t min_res_155059 = smin64(n_99704, min_arg1_155058);
            bool zzero_lte_i_155069 = sle64((int64_t) 0, inf_155057);
            int64_t j_m_i_155063 = sub64(min_res_155059, inf_155057);
            int64_t m_155065 = sub64(j_m_i_155063, (int64_t) 1);
            int64_t i_p_m_t_s_155066 = add64(inf_155057, m_155065);
            bool i_p_m_t_s_leq_w_155068 = slt64(i_p_m_t_s_155066, n_99704);
            bool y_155071 = i_p_m_t_s_leq_w_155068 && zzero_lte_i_155069;
            bool zzero_leq_i_p_m_t_s_155067 = sle64((int64_t) 0, i_p_m_t_s_155066);
            bool y_155072 = zzero_leq_i_p_m_t_s_155067 && y_155071;
            bool i_lte_j_155070 = sle64(inf_155057, min_res_155059);
            bool forwards_ok_155073 = i_lte_j_155070 && y_155072;
            bool empty_slice_155064 = j_m_i_155063 == (int64_t) 0;
            bool ok_or_empty_155074 = empty_slice_155064 || forwards_ok_155073;
            bool index_certs_155075;
            
            if (!ok_or_empty_155074) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155057, ":", (long long) min_res_155059, "] out of bounds for array of shape [", (long long) n_99704, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:131:88-91\n   #4  ftRelational.fut:140:74-85\n   #5  ftRelational.fut:139:5-140:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171859 = (int64_t) 2 * j_m_i_155063;
            int64_t bytes_171861 = (int64_t) 8 * j_m_i_155063;
            
            if (mem_171860_cached_sizze_173075 < bytes_171859) {
                err = lexical_realloc(ctx, &mem_171860, &mem_171860_cached_sizze_173075, bytes_171859);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171852.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            if (mem_171862_cached_sizze_173076 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173076, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171850.mem, (int64_t) 0 + (int64_t) 1 * inf_155057, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_99704; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171848.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                int16_t write_iv_171572 = ((int16_t *) mem_param_171827.mem)[write_iter_171567];
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155057);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int64_t *) mem_171862)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155063)) {
                    ((int16_t *) mem_171860)[lifted_lambda_res_162803] = write_iv_171572;
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171850.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171862, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171852.mem, inf_155057, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171860, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155063});
        }
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171827, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171886, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171885, &mem_param_171827, "mem_param_171827") != 0)
        return 1;
    if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171888, bytes_171820, "mem_171888")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171888.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171886.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99704});
    if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171890, bytes_171889, "mem_171890")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_171890.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171885.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_99704});
    if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171888, "mem_171888") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171890, "mem_171890") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173072, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173073, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171828);
        free(mem_171860);
        free(mem_171862);
        if (memblock_unref(ctx, &mem_171890, "mem_171890") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171888, "mem_171888") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171852, "mem_171852") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171850, "mem_171850") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171839, "mem_171839") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171837, "mem_param_171837") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171848, "ext_mem_171848") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171827, "mem_param_171827") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171885, "ext_mem_171885") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171886, "ext_mem_171886") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171819, "ext_mem_171819") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_double(struct futhark_context *ctx, struct memblock *mem_out_p_173077, struct memblock *mem_out_p_173078, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_86918, int64_t b_86919, int64_t block_sizze_86920)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171829_cached_sizze_173079 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171862_cached_sizze_173080 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_173081 = 0;
    unsigned char *mem_171864 = NULL;
    int64_t mem_171872_cached_sizze_173082 = 0;
    unsigned char *mem_171872 = NULL;
    struct memblock mem_171897;
    
    mem_171897.references = NULL;
    
    struct memblock mem_171895;
    
    mem_171895.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171853;
    
    mem_171853.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_171828;
    
    mem_param_171828.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_86918;
    int64_t bytes_171896 = n_86918 * b_86919;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_86918; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171829_cached_sizze_173079 < n_86918) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173079, n_86918);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171872_cached_sizze_173082 < b_86919) {
        err = lexical_realloc(ctx, &mem_171872, &mem_171872_cached_sizze_173082, b_86919);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &k_mem_171818, "k_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171828, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    for (int64_t i_156507 = 0; i_156507 < (int64_t) 32; i_156507++) {
        int32_t binop_x_156510 = sext_i64_i32(i_156507);
        int32_t binop_x_156511 = mul32(2, binop_x_156510);
        int32_t zm_lhs_156512 = add32(2, binop_x_156511);
        int32_t min_arg1_156513 = sub32(zm_lhs_156512, 1);
        int32_t min_res_156514 = smin32(64, min_arg1_156513);
        int32_t zp_lhs_156515 = sub32(64, binop_x_156511);
        int32_t ij_bits_156516 = add32(1, zp_lhs_156515);
        int32_t up_to_156517 = shl32(1, ij_bits_156516);
        int64_t tmp_156518 = sext_i32_i64(zp_lhs_156515);
        bool bounds_invalid_upwards_156519 = slt32(zp_lhs_156515, 0);
        bool valid_156521 = !bounds_invalid_upwards_156519;
        bool range_valid_c_156522;
        
        if (!valid_156521) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_156518, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:112:74-85\n   #6  ftRelational.fut:108:5-112:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156546 = sext_i32_i64(up_to_156517);
        bool bounds_invalid_upwards_156547 = slt32(up_to_156517, 0);
        bool valid_156548 = !bounds_invalid_upwards_156547;
        bool range_valid_c_156549;
        
        if (!valid_156548) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156546, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:112:74-85\n   #5  ftRelational.fut:108:5-112:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156588 = add32(8, min_res_156514);
        int32_t zs_lhs_156589 = sub32(zm_lhs_156588, 1);
        int32_t i32_arg0_156590 = sdiv32(zs_lhs_156589, 8);
        int64_t i32_res_156591 = sext_i32_i64(i32_arg0_156590);
        bool zzero_156592 = i32_res_156591 == (int64_t) 0;
        bool nonzzero_156593 = !zzero_156592;
        bool nonzzero_cert_156594;
        
        if (!nonzzero_156593) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:112:74-85\n   #5  ftRelational.fut:108:5-112:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156595 = sdiv64(block_sizze_86920, i32_res_156591);
        int64_t zm_lhs_156596 = add64(n_86918, psizze__156595);
        int64_t zs_lhs_156597 = sub64(zm_lhs_156596, (int64_t) 1);
        bool zzero_156598 = psizze__156595 == (int64_t) 0;
        bool nonzzero_156599 = !zzero_156598;
        bool nonzzero_cert_156600;
        
        if (!nonzzero_156599) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:112:74-85\n   #5  ftRelational.fut:108:5-112:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156601 = sdiv64(zs_lhs_156597, psizze__156595);
        bool bounds_invalid_upwards_156602 = slt64(max_iter_156601, (int64_t) 0);
        bool valid_156603 = !bounds_invalid_upwards_156602;
        bool range_valid_c_156604;
        
        if (!valid_156603) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156601, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:112:74-85\n   #6  ftRelational.fut:108:5-112:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_156520 = add64((int64_t) 1, tmp_156518);
        
        for (int64_t i_171547 = 0; i_171547 < n_86918; i_171547++) {
            double eta_p_156524 = ((double *) mem_param_171824.mem)[i_171547];
            int64_t i64_arg0_156525 = futrts_to_bits64(eta_p_156524);
            int64_t unsign_arg0_156526 = ashr64(i64_arg0_156525, (int64_t) 63);
            int64_t unsign_arg0_156527 = (int64_t) 1 & unsign_arg0_156526;
            int32_t to_i32_res_156528 = zext_i64_i32(unsign_arg0_156527);
            bool cond_156529 = to_i32_res_156528 == 1;
            bool x_156530 = !cond_156529;
            int8_t defunc_0_f_res_156531;
            int8_t y_156533 = (int8_t) 0;
            
            for (int64_t i_156532 = 0; i_156532 < distance_156520; i_156532++) {
                int32_t binop_x_156534 = sext_i64_i32(i_156532);
                int32_t get_bit_arg0_156535 = add32(binop_x_156511, binop_x_156534);
                int64_t unsign_arg0_156536 = zext_i32_i64(get_bit_arg0_156535);
                int64_t unsign_arg0_156537 = ashr64(i64_arg0_156525, unsign_arg0_156536);
                int64_t unsign_arg0_156538 = (int64_t) 1 & unsign_arg0_156537;
                int32_t to_i32_res_156539 = zext_i64_i32(unsign_arg0_156538);
                bool cond_f_res_156540 = get_bit_arg0_156535 == 63;
                bool y_156541 = x_156530 && cond_f_res_156540;
                bool cond_156542 = cond_156529 || y_156541;
                int32_t defunc_0_get_bit_res_156543;
                
                if (cond_156542) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ to_i32_res_156539;
                    
                    defunc_0_get_bit_res_156543 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_156543 = to_i32_res_156539;
                }
                
                int8_t loopres_156545;
                
                if (futrts_set_bit_2464(ctx, &loopres_156545, binop_x_156534, y_156533, defunc_0_get_bit_res_156543) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_156545;
                
                y_156533 = y_tmp_172508;
            }
            defunc_0_f_res_156531 = y_156533;
            ((int8_t *) mem_171829)[i_171547] = defunc_0_f_res_156531;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156550;
        int64_t offs_156553;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_156553 = (int64_t) 0;
        for (int64_t i_156552 = 0; i_156552 < up_to_156546; i_156552++) {
            int32_t binop_x_156555 = sext_i64_i32(i_156552);
            int8_t index_primexp_156556 = zext_i32_i8(binop_x_156555);
            
            if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_86918; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171829)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_156556;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171838.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_156553, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171840.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_156581 = add64(offs_156553, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171840, "mem_171840") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_156581;
            
            if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_156553 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156550 = offs_156553;
        if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171851.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86918});
        if (memblock_alloc(ctx, &mem_171853, bytes_171896, "mem_171853")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (int64_t []) {n_86918, b_86919});
        for (int64_t i_156607 = 0; i_156607 < max_iter_156601; i_156607++) {
            int64_t inf_156610 = mul64(psizze__156595, i_156607);
            int64_t min_arg1_156611 = add64(psizze__156595, inf_156610);
            int64_t min_res_156612 = smin64(n_86918, min_arg1_156611);
            bool zzero_lte_i_156622 = sle64((int64_t) 0, inf_156610);
            int64_t j_m_i_156616 = sub64(min_res_156612, inf_156610);
            int64_t m_156618 = sub64(j_m_i_156616, (int64_t) 1);
            int64_t i_p_m_t_s_156619 = add64(inf_156610, m_156618);
            bool i_p_m_t_s_leq_w_156621 = slt64(i_p_m_t_s_156619, n_86918);
            bool y_156624 = i_p_m_t_s_leq_w_156621 && zzero_lte_i_156622;
            bool zzero_leq_i_p_m_t_s_156620 = sle64((int64_t) 0, i_p_m_t_s_156619);
            bool y_156625 = zzero_leq_i_p_m_t_s_156620 && y_156624;
            bool i_lte_j_156623 = sle64(inf_156610, min_res_156612);
            bool forwards_ok_156626 = i_lte_j_156623 && y_156625;
            bool empty_slice_156617 = j_m_i_156616 == (int64_t) 0;
            bool ok_or_empty_156627 = empty_slice_156617 || forwards_ok_156626;
            bool index_certs_156628;
            
            if (!ok_or_empty_156627) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156610, ":", (long long) min_res_156612, "] out of bounds for array of shape [", (long long) n_86918, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:112:74-85\n   #5  ftRelational.fut:108:5-112:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171861 = b_86919 * j_m_i_156616;
            int64_t bytes_171863 = (int64_t) 8 * j_m_i_156616;
            
            if (mem_171862_cached_sizze_173080 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173080, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (uint8_t *) mem_171853.mem, (int64_t) 0 + b_86919 * inf_156610, (int64_t []) {b_86919, (int64_t) 1}, (int64_t []) {j_m_i_156616, b_86919});
            if (mem_171864_cached_sizze_173081 < bytes_171863) {
                err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_173081, bytes_171863);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171851.mem, (int64_t) 0 + (int64_t) 1 * inf_156610, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156616});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_86918; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171849.mem)[write_iter_171567];
                double write_iv_171571 = ((double *) mem_param_171824.mem)[write_iter_171567];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0 + write_iter_171567 * b_86919, (int64_t []) {(int64_t) 1}, (int64_t []) {b_86919});
                
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_156610);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156616)) {
                    ((double *) mem_171864)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156616)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_86919 - (int64_t) 1, b_86919))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171862, lifted_lambda_res_162803 * b_86919, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_86919});
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171851.mem, inf_156610, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156616});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, b_86919 * inf_156610, (int64_t []) {b_86919, (int64_t) 1}, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (int64_t []) {j_m_i_156616, b_86919});
        }
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171828, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171893, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171892, &mem_param_171828, "mem_param_171828") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171895, bytes_171820, "mem_171895")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_86918});
    if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171897, bytes_171896, "mem_171897")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171897.mem, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (uint8_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {b_86919, (int64_t) 1}, (int64_t []) {n_86918, b_86919});
    if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171895, "mem_171895") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171897, "mem_171897") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173077, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173078, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171829);
        free(mem_171862);
        free(mem_171864);
        free(mem_171872);
        if (memblock_unref(ctx, &mem_171897, "mem_171897") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171895, "mem_171895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171828, "mem_param_171828") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_float(struct futhark_context *ctx, struct memblock *mem_out_p_173083, struct memblock *mem_out_p_173084, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_85975, int64_t b_85976, int64_t block_sizze_85977)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171829_cached_sizze_173085 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171862_cached_sizze_173086 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_173087 = 0;
    unsigned char *mem_171864 = NULL;
    int64_t mem_171872_cached_sizze_173088 = 0;
    unsigned char *mem_171872 = NULL;
    struct memblock mem_171897;
    
    mem_171897.references = NULL;
    
    struct memblock mem_171895;
    
    mem_171895.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171853;
    
    mem_171853.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_171828;
    
    mem_param_171828.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_85975;
    int64_t bytes_171894 = (int64_t) 4 * n_85975;
    int64_t bytes_171896 = n_85975 * b_85976;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_85975; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171829_cached_sizze_173085 < n_85975) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173085, n_85975);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171872_cached_sizze_173088 < b_85976) {
        err = lexical_realloc(ctx, &mem_171872, &mem_171872_cached_sizze_173088, b_85976);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &k_mem_171818, "k_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171828, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    for (int64_t i_156506 = 0; i_156506 < (int64_t) 16; i_156506++) {
        int32_t binop_x_156509 = sext_i64_i32(i_156506);
        int32_t binop_x_156510 = mul32(2, binop_x_156509);
        int32_t zm_lhs_156511 = add32(2, binop_x_156510);
        int32_t min_arg1_156512 = sub32(zm_lhs_156511, 1);
        int32_t min_res_156513 = smin32(32, min_arg1_156512);
        int32_t zp_lhs_156514 = sub32(32, binop_x_156510);
        int32_t ij_bits_156515 = add32(1, zp_lhs_156514);
        int32_t up_to_156516 = shl32(1, ij_bits_156515);
        int64_t tmp_156517 = sext_i32_i64(zp_lhs_156514);
        bool bounds_invalid_upwards_156518 = slt32(zp_lhs_156514, 0);
        bool valid_156520 = !bounds_invalid_upwards_156518;
        bool range_valid_c_156521;
        
        if (!valid_156520) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_156517, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:107:74-85\n   #6  ftRelational.fut:103:5-107:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_156542 = sext_i32_i64(up_to_156516);
        bool bounds_invalid_upwards_156543 = slt32(up_to_156516, 0);
        bool valid_156544 = !bounds_invalid_upwards_156543;
        bool range_valid_c_156545;
        
        if (!valid_156544) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_156542, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:107:74-85\n   #5  ftRelational.fut:103:5-107:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_156584 = add32(8, min_res_156513);
        int32_t zs_lhs_156585 = sub32(zm_lhs_156584, 1);
        int32_t i32_arg0_156586 = sdiv32(zs_lhs_156585, 8);
        int64_t i32_res_156587 = sext_i32_i64(i32_arg0_156586);
        bool zzero_156588 = i32_res_156587 == (int64_t) 0;
        bool nonzzero_156589 = !zzero_156588;
        bool nonzzero_cert_156590;
        
        if (!nonzzero_156589) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:107:74-85\n   #5  ftRelational.fut:103:5-107:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__156591 = sdiv64(block_sizze_85977, i32_res_156587);
        int64_t zm_lhs_156592 = add64(n_85975, psizze__156591);
        int64_t zs_lhs_156593 = sub64(zm_lhs_156592, (int64_t) 1);
        bool zzero_156594 = psizze__156591 == (int64_t) 0;
        bool nonzzero_156595 = !zzero_156594;
        bool nonzzero_cert_156596;
        
        if (!nonzzero_156595) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:107:74-85\n   #5  ftRelational.fut:103:5-107:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_156597 = sdiv64(zs_lhs_156593, psizze__156591);
        bool bounds_invalid_upwards_156598 = slt64(max_iter_156597, (int64_t) 0);
        bool valid_156599 = !bounds_invalid_upwards_156598;
        bool range_valid_c_156600;
        
        if (!valid_156599) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_156597, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:53:60-62\n   #4  ftSMJ.fut:96:90-93\n   #5  ftRelational.fut:107:74-85\n   #6  ftRelational.fut:103:5-107:86\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_156519 = add64((int64_t) 1, tmp_156517);
        
        for (int64_t i_171547 = 0; i_171547 < n_85975; i_171547++) {
            float eta_p_156523 = ((float *) mem_param_171824.mem)[i_171547];
            int32_t i32_arg0_156524 = futrts_to_bits32(eta_p_156523);
            int32_t unsign_arg0_156525 = ashr32(i32_arg0_156524, 31);
            int32_t unsign_arg0_156526 = 1 & unsign_arg0_156525;
            bool cond_156527 = unsign_arg0_156526 == 1;
            bool x_156528 = !cond_156527;
            int8_t defunc_0_f_res_156529;
            int8_t y_156531 = (int8_t) 0;
            
            for (int64_t i_156530 = 0; i_156530 < distance_156519; i_156530++) {
                int32_t binop_x_156532 = sext_i64_i32(i_156530);
                int32_t get_bit_arg0_156533 = add32(binop_x_156510, binop_x_156532);
                int32_t unsign_arg0_156534 = ashr32(i32_arg0_156524, get_bit_arg0_156533);
                int32_t unsign_arg0_156535 = 1 & unsign_arg0_156534;
                bool cond_f_res_156536 = get_bit_arg0_156533 == 31;
                bool y_156537 = x_156528 && cond_f_res_156536;
                bool cond_156538 = cond_156527 || y_156537;
                int32_t defunc_0_get_bit_res_156539;
                
                if (cond_156538) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ unsign_arg0_156535;
                    
                    defunc_0_get_bit_res_156539 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_156539 = unsign_arg0_156535;
                }
                
                int8_t loopres_156541;
                
                if (futrts_set_bit_2464(ctx, &loopres_156541, binop_x_156532, y_156531, defunc_0_get_bit_res_156539) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_156541;
                
                y_156531 = y_tmp_172508;
            }
            defunc_0_f_res_156529 = y_156531;
            ((int8_t *) mem_171829)[i_171547] = defunc_0_f_res_156529;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_156546;
        int64_t offs_156549;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_156549 = (int64_t) 0;
        for (int64_t i_156548 = 0; i_156548 < up_to_156542; i_156548++) {
            int32_t binop_x_156551 = sext_i64_i32(i_156548);
            int8_t index_primexp_156552 = zext_i32_i8(binop_x_156551);
            
            if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_85975; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171829)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_156552;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171838.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_156549, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171840.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_156577 = add64(offs_156549, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171840, "mem_171840") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_156577;
            
            if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_156549 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_156546 = offs_156549;
        if (memblock_alloc(ctx, &mem_171851, bytes_171894, "mem_171851")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171851.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85975});
        if (memblock_alloc(ctx, &mem_171853, bytes_171896, "mem_171853")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (int64_t []) {n_85975, b_85976});
        for (int64_t i_156603 = 0; i_156603 < max_iter_156597; i_156603++) {
            int64_t inf_156606 = mul64(psizze__156591, i_156603);
            int64_t min_arg1_156607 = add64(psizze__156591, inf_156606);
            int64_t min_res_156608 = smin64(n_85975, min_arg1_156607);
            bool zzero_lte_i_156618 = sle64((int64_t) 0, inf_156606);
            int64_t j_m_i_156612 = sub64(min_res_156608, inf_156606);
            int64_t m_156614 = sub64(j_m_i_156612, (int64_t) 1);
            int64_t i_p_m_t_s_156615 = add64(inf_156606, m_156614);
            bool i_p_m_t_s_leq_w_156617 = slt64(i_p_m_t_s_156615, n_85975);
            bool y_156620 = i_p_m_t_s_leq_w_156617 && zzero_lte_i_156618;
            bool zzero_leq_i_p_m_t_s_156616 = sle64((int64_t) 0, i_p_m_t_s_156615);
            bool y_156621 = zzero_leq_i_p_m_t_s_156616 && y_156620;
            bool i_lte_j_156619 = sle64(inf_156606, min_res_156608);
            bool forwards_ok_156622 = i_lte_j_156619 && y_156621;
            bool empty_slice_156613 = j_m_i_156612 == (int64_t) 0;
            bool ok_or_empty_156623 = empty_slice_156613 || forwards_ok_156622;
            bool index_certs_156624;
            
            if (!ok_or_empty_156623) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_156606, ":", (long long) min_res_156608, "] out of bounds for array of shape [", (long long) n_85975, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:53:60-62\n   #3  ftSMJ.fut:96:90-93\n   #4  ftRelational.fut:107:74-85\n   #5  ftRelational.fut:103:5-107:86\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171861 = b_85976 * j_m_i_156612;
            int64_t bytes_171863 = (int64_t) 4 * j_m_i_156612;
            
            if (mem_171862_cached_sizze_173086 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173086, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (uint8_t *) mem_171853.mem, (int64_t) 0 + b_85976 * inf_156606, (int64_t []) {b_85976, (int64_t) 1}, (int64_t []) {j_m_i_156612, b_85976});
            if (mem_171864_cached_sizze_173087 < bytes_171863) {
                err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_173087, bytes_171863);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171851.mem, (int64_t) 0 + (int64_t) 1 * inf_156606, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156612});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_85975; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171849.mem)[write_iter_171567];
                float write_iv_171571 = ((float *) mem_param_171824.mem)[write_iter_171567];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0 + write_iter_171567 * b_85976, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85976});
                
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_156606);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156612)) {
                    ((float *) mem_171864)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_156612)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_85976 - (int64_t) 1, b_85976))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171862, lifted_lambda_res_162803 * b_85976, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85976});
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171851.mem, inf_156606, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_156612});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, b_85976 * inf_156606, (int64_t []) {b_85976, (int64_t) 1}, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (int64_t []) {j_m_i_156612, b_85976});
        }
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171828, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171893, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171892, &mem_param_171828, "mem_param_171828") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171895, bytes_171894, "mem_171895")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85975});
    if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171897, bytes_171896, "mem_171897")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171897.mem, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (uint8_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {b_85976, (int64_t) 1}, (int64_t []) {n_85975, b_85976});
    if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171895, "mem_171895") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171897, "mem_171897") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173083, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173084, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171829);
        free(mem_171862);
        free(mem_171864);
        free(mem_171872);
        if (memblock_unref(ctx, &mem_171897, "mem_171897") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171895, "mem_171895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171828, "mem_param_171828") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_int(struct futhark_context *ctx, struct memblock *mem_out_p_173089, struct memblock *mem_out_p_173090, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_84157, int64_t b_84158, int64_t block_sizze_84159)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171829_cached_sizze_173091 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171862_cached_sizze_173092 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_173093 = 0;
    unsigned char *mem_171864 = NULL;
    int64_t mem_171872_cached_sizze_173094 = 0;
    unsigned char *mem_171872 = NULL;
    struct memblock mem_171897;
    
    mem_171897.references = NULL;
    
    struct memblock mem_171895;
    
    mem_171895.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171853;
    
    mem_171853.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_171828;
    
    mem_param_171828.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_84157;
    int64_t bytes_171894 = (int64_t) 4 * n_84157;
    int64_t bytes_171896 = n_84157 * b_84158;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_84157; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171829_cached_sizze_173091 < n_84157) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173091, n_84157);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171872_cached_sizze_173094 < b_84158) {
        err = lexical_realloc(ctx, &mem_171872, &mem_171872_cached_sizze_173094, b_84158);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &k_mem_171818, "k_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171828, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    for (int64_t i_154959 = 0; i_154959 < (int64_t) 16; i_154959++) {
        int32_t binop_x_154962 = sext_i64_i32(i_154959);
        int32_t binop_x_154963 = mul32(2, binop_x_154962);
        int32_t zm_lhs_154964 = add32(2, binop_x_154963);
        int32_t min_arg1_154965 = sub32(zm_lhs_154964, 1);
        int32_t min_res_154966 = smin32(32, min_arg1_154965);
        int32_t zp_lhs_154967 = sub32(32, binop_x_154963);
        int32_t ij_bits_154968 = add32(1, zp_lhs_154967);
        int32_t up_to_154969 = shl32(1, ij_bits_154968);
        int64_t tmp_154970 = sext_i32_i64(zp_lhs_154967);
        bool bounds_invalid_upwards_154971 = slt32(zp_lhs_154967, 0);
        bool valid_154973 = !bounds_invalid_upwards_154971;
        bool range_valid_c_154974;
        
        if (!valid_154973) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154970, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:97:77-88\n   #6  ftRelational.fut:93:5-97:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154987 = sext_i32_i64(up_to_154969);
        bool bounds_invalid_upwards_154988 = slt32(up_to_154969, 0);
        bool valid_154989 = !bounds_invalid_upwards_154988;
        bool range_valid_c_154990;
        
        if (!valid_154989) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154987, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:97:77-88\n   #5  ftRelational.fut:93:5-97:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155029 = add32(8, min_res_154966);
        int32_t zs_lhs_155030 = sub32(zm_lhs_155029, 1);
        int32_t i32_arg0_155031 = sdiv32(zs_lhs_155030, 8);
        int64_t i32_res_155032 = sext_i32_i64(i32_arg0_155031);
        bool zzero_155033 = i32_res_155032 == (int64_t) 0;
        bool nonzzero_155034 = !zzero_155033;
        bool nonzzero_cert_155035;
        
        if (!nonzzero_155034) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:97:77-88\n   #5  ftRelational.fut:93:5-97:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155036 = sdiv64(block_sizze_84159, i32_res_155032);
        int64_t zm_lhs_155037 = add64(n_84157, psizze__155036);
        int64_t zs_lhs_155038 = sub64(zm_lhs_155037, (int64_t) 1);
        bool zzero_155039 = psizze__155036 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:97:77-88\n   #5  ftRelational.fut:93:5-97:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155042 = sdiv64(zs_lhs_155038, psizze__155036);
        bool bounds_invalid_upwards_155043 = slt64(max_iter_155042, (int64_t) 0);
        bool valid_155044 = !bounds_invalid_upwards_155043;
        bool range_valid_c_155045;
        
        if (!valid_155044) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155042, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:97:77-88\n   #6  ftRelational.fut:93:5-97:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154972 = add64((int64_t) 1, tmp_154970);
        
        for (int64_t i_171547 = 0; i_171547 < n_84157; i_171547++) {
            int32_t eta_p_154976 = ((int32_t *) mem_param_171824.mem)[i_171547];
            int8_t defunc_0_f_res_154977;
            int8_t y_154979 = (int8_t) 0;
            
            for (int64_t i_154978 = 0; i_154978 < distance_154972; i_154978++) {
                int32_t binop_x_154980 = sext_i64_i32(i_154978);
                int32_t get_bit_arg0_154981 = add32(binop_x_154963, binop_x_154980);
                int32_t zgzg_res_162320 = ashr32(eta_p_154976, get_bit_arg0_154981);
                int32_t za_res_162321 = 1 & zgzg_res_162320;
                bool cond_154983 = get_bit_arg0_154981 == 31;
                int32_t defunc_0_get_bit_res_154984;
                
                if (cond_154983) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ za_res_162321;
                    
                    defunc_0_get_bit_res_154984 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154984 = za_res_162321;
                }
                
                int8_t loopres_154986;
                
                if (futrts_set_bit_2464(ctx, &loopres_154986, binop_x_154980, y_154979, defunc_0_get_bit_res_154984) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154986;
                
                y_154979 = y_tmp_172508;
            }
            defunc_0_f_res_154977 = y_154979;
            ((int8_t *) mem_171829)[i_171547] = defunc_0_f_res_154977;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154991;
        int64_t offs_154994;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_154994 = (int64_t) 0;
        for (int64_t i_154993 = 0; i_154993 < up_to_154987; i_154993++) {
            int32_t binop_x_154996 = sext_i64_i32(i_154993);
            int8_t index_primexp_154997 = zext_i32_i8(binop_x_154996);
            
            if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_84157; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171829)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_154997;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171838.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_154994, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171840.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155022 = add64(offs_154994, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171840, "mem_171840") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155022;
            
            if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_154994 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154991 = offs_154994;
        if (memblock_alloc(ctx, &mem_171851, bytes_171894, "mem_171851")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_4b(ctx, 1, (uint32_t *) mem_171851.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84157});
        if (memblock_alloc(ctx, &mem_171853, bytes_171896, "mem_171853")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (int64_t []) {n_84157, b_84158});
        for (int64_t i_155048 = 0; i_155048 < max_iter_155042; i_155048++) {
            int64_t inf_155051 = mul64(psizze__155036, i_155048);
            int64_t min_arg1_155052 = add64(psizze__155036, inf_155051);
            int64_t min_res_155053 = smin64(n_84157, min_arg1_155052);
            bool zzero_lte_i_155063 = sle64((int64_t) 0, inf_155051);
            int64_t j_m_i_155057 = sub64(min_res_155053, inf_155051);
            int64_t m_155059 = sub64(j_m_i_155057, (int64_t) 1);
            int64_t i_p_m_t_s_155060 = add64(inf_155051, m_155059);
            bool i_p_m_t_s_leq_w_155062 = slt64(i_p_m_t_s_155060, n_84157);
            bool y_155065 = i_p_m_t_s_leq_w_155062 && zzero_lte_i_155063;
            bool zzero_leq_i_p_m_t_s_155061 = sle64((int64_t) 0, i_p_m_t_s_155060);
            bool y_155066 = zzero_leq_i_p_m_t_s_155061 && y_155065;
            bool i_lte_j_155064 = sle64(inf_155051, min_res_155053);
            bool forwards_ok_155067 = i_lte_j_155064 && y_155066;
            bool empty_slice_155058 = j_m_i_155057 == (int64_t) 0;
            bool ok_or_empty_155068 = empty_slice_155058 || forwards_ok_155067;
            bool index_certs_155069;
            
            if (!ok_or_empty_155068) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155051, ":", (long long) min_res_155053, "] out of bounds for array of shape [", (long long) n_84157, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:97:77-88\n   #5  ftRelational.fut:93:5-97:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171861 = b_84158 * j_m_i_155057;
            int64_t bytes_171863 = (int64_t) 4 * j_m_i_155057;
            
            if (mem_171862_cached_sizze_173092 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173092, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (uint8_t *) mem_171853.mem, (int64_t) 0 + b_84158 * inf_155051, (int64_t []) {b_84158, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_84158});
            if (mem_171864_cached_sizze_173093 < bytes_171863) {
                err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_173093, bytes_171863);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171851.mem, (int64_t) 0 + (int64_t) 1 * inf_155051, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_84157; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171849.mem)[write_iter_171567];
                int32_t write_iv_171571 = ((int32_t *) mem_param_171824.mem)[write_iter_171567];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0 + write_iter_171567 * b_84158, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84158});
                
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155051);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) {
                    ((int32_t *) mem_171864)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_84158 - (int64_t) 1, b_84158))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171862, lifted_lambda_res_162803 * b_84158, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_84158});
                }
            }
            lmad_copy_4b(ctx, 1, (uint32_t *) mem_171851.mem, inf_155051, (int64_t []) {(int64_t) 1}, (uint32_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, b_84158 * inf_155051, (int64_t []) {b_84158, (int64_t) 1}, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_84158});
        }
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171828, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171893, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171892, &mem_param_171828, "mem_param_171828") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171895, bytes_171894, "mem_171895")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_4b(ctx, 1, (uint32_t *) mem_171895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint32_t *) ext_mem_171893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_84157});
    if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171897, bytes_171896, "mem_171897")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171897.mem, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (uint8_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {b_84158, (int64_t) 1}, (int64_t []) {n_84157, b_84158});
    if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171895, "mem_171895") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171897, "mem_171897") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173089, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173090, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171829);
        free(mem_171862);
        free(mem_171864);
        free(mem_171872);
        if (memblock_unref(ctx, &mem_171897, "mem_171897") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171895, "mem_171895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171828, "mem_param_171828") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_long(struct futhark_context *ctx, struct memblock *mem_out_p_173095, struct memblock *mem_out_p_173096, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_85036, int64_t b_85037, int64_t block_sizze_85038)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171829_cached_sizze_173097 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171862_cached_sizze_173098 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_173099 = 0;
    unsigned char *mem_171864 = NULL;
    int64_t mem_171872_cached_sizze_173100 = 0;
    unsigned char *mem_171872 = NULL;
    struct memblock mem_171897;
    
    mem_171897.references = NULL;
    
    struct memblock mem_171895;
    
    mem_171895.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171853;
    
    mem_171853.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_171828;
    
    mem_param_171828.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_85036;
    int64_t bytes_171896 = n_85036 * b_85037;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_85036; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171829_cached_sizze_173097 < n_85036) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173097, n_85036);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171872_cached_sizze_173100 < b_85037) {
        err = lexical_realloc(ctx, &mem_171872, &mem_171872_cached_sizze_173100, b_85037);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &k_mem_171818, "k_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171828, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    for (int64_t i_154959 = 0; i_154959 < (int64_t) 32; i_154959++) {
        int32_t binop_x_154962 = sext_i64_i32(i_154959);
        int32_t binop_x_154963 = mul32(2, binop_x_154962);
        int32_t zm_lhs_154964 = add32(2, binop_x_154963);
        int32_t min_arg1_154965 = sub32(zm_lhs_154964, 1);
        int32_t min_res_154966 = smin32(64, min_arg1_154965);
        int32_t zp_lhs_154967 = sub32(64, binop_x_154963);
        int32_t ij_bits_154968 = add32(1, zp_lhs_154967);
        int32_t up_to_154969 = shl32(1, ij_bits_154968);
        int64_t tmp_154970 = sext_i32_i64(zp_lhs_154967);
        bool bounds_invalid_upwards_154971 = slt32(zp_lhs_154967, 0);
        bool valid_154973 = !bounds_invalid_upwards_154971;
        bool range_valid_c_154974;
        
        if (!valid_154973) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154970, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:102:77-88\n   #6  ftRelational.fut:98:5-102:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154987 = sext_i32_i64(up_to_154969);
        bool bounds_invalid_upwards_154988 = slt32(up_to_154969, 0);
        bool valid_154989 = !bounds_invalid_upwards_154988;
        bool range_valid_c_154990;
        
        if (!valid_154989) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154987, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:102:77-88\n   #5  ftRelational.fut:98:5-102:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155029 = add32(8, min_res_154966);
        int32_t zs_lhs_155030 = sub32(zm_lhs_155029, 1);
        int32_t i32_arg0_155031 = sdiv32(zs_lhs_155030, 8);
        int64_t i32_res_155032 = sext_i32_i64(i32_arg0_155031);
        bool zzero_155033 = i32_res_155032 == (int64_t) 0;
        bool nonzzero_155034 = !zzero_155033;
        bool nonzzero_cert_155035;
        
        if (!nonzzero_155034) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:102:77-88\n   #5  ftRelational.fut:98:5-102:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155036 = sdiv64(block_sizze_85038, i32_res_155032);
        int64_t zm_lhs_155037 = add64(n_85036, psizze__155036);
        int64_t zs_lhs_155038 = sub64(zm_lhs_155037, (int64_t) 1);
        bool zzero_155039 = psizze__155036 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:102:77-88\n   #5  ftRelational.fut:98:5-102:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155042 = sdiv64(zs_lhs_155038, psizze__155036);
        bool bounds_invalid_upwards_155043 = slt64(max_iter_155042, (int64_t) 0);
        bool valid_155044 = !bounds_invalid_upwards_155043;
        bool range_valid_c_155045;
        
        if (!valid_155044) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155042, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:102:77-88\n   #6  ftRelational.fut:98:5-102:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154972 = add64((int64_t) 1, tmp_154970);
        
        for (int64_t i_171547 = 0; i_171547 < n_85036; i_171547++) {
            int64_t eta_p_154976 = ((int64_t *) mem_param_171824.mem)[i_171547];
            int8_t defunc_0_f_res_154977;
            int8_t y_154979 = (int8_t) 0;
            
            for (int64_t i_154978 = 0; i_154978 < distance_154972; i_154978++) {
                int32_t binop_x_154980 = sext_i64_i32(i_154978);
                int32_t get_bit_arg0_154981 = add32(binop_x_154963, binop_x_154980);
                int32_t defunc_0_get_bit_res_154982;
                
                if (futrts_get_bit_2253(ctx, &defunc_0_get_bit_res_154982, get_bit_arg0_154981, eta_p_154976) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154983 = get_bit_arg0_154981 == 63;
                int32_t defunc_0_get_bit_res_154984;
                
                if (cond_154983) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ defunc_0_get_bit_res_154982;
                    
                    defunc_0_get_bit_res_154984 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154984 = defunc_0_get_bit_res_154982;
                }
                
                int8_t loopres_154986;
                
                if (futrts_set_bit_2464(ctx, &loopres_154986, binop_x_154980, y_154979, defunc_0_get_bit_res_154984) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154986;
                
                y_154979 = y_tmp_172508;
            }
            defunc_0_f_res_154977 = y_154979;
            ((int8_t *) mem_171829)[i_171547] = defunc_0_f_res_154977;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154991;
        int64_t offs_154994;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_154994 = (int64_t) 0;
        for (int64_t i_154993 = 0; i_154993 < up_to_154987; i_154993++) {
            int32_t binop_x_154996 = sext_i64_i32(i_154993);
            int8_t index_primexp_154997 = zext_i32_i8(binop_x_154996);
            
            if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_85036; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171829)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_154997;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171838.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_154994, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171840.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155022 = add64(offs_154994, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171840, "mem_171840") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155022;
            
            if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_154994 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154991 = offs_154994;
        if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171851.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85036});
        if (memblock_alloc(ctx, &mem_171853, bytes_171896, "mem_171853")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (int64_t []) {n_85036, b_85037});
        for (int64_t i_155048 = 0; i_155048 < max_iter_155042; i_155048++) {
            int64_t inf_155051 = mul64(psizze__155036, i_155048);
            int64_t min_arg1_155052 = add64(psizze__155036, inf_155051);
            int64_t min_res_155053 = smin64(n_85036, min_arg1_155052);
            bool zzero_lte_i_155063 = sle64((int64_t) 0, inf_155051);
            int64_t j_m_i_155057 = sub64(min_res_155053, inf_155051);
            int64_t m_155059 = sub64(j_m_i_155057, (int64_t) 1);
            int64_t i_p_m_t_s_155060 = add64(inf_155051, m_155059);
            bool i_p_m_t_s_leq_w_155062 = slt64(i_p_m_t_s_155060, n_85036);
            bool y_155065 = i_p_m_t_s_leq_w_155062 && zzero_lte_i_155063;
            bool zzero_leq_i_p_m_t_s_155061 = sle64((int64_t) 0, i_p_m_t_s_155060);
            bool y_155066 = zzero_leq_i_p_m_t_s_155061 && y_155065;
            bool i_lte_j_155064 = sle64(inf_155051, min_res_155053);
            bool forwards_ok_155067 = i_lte_j_155064 && y_155066;
            bool empty_slice_155058 = j_m_i_155057 == (int64_t) 0;
            bool ok_or_empty_155068 = empty_slice_155058 || forwards_ok_155067;
            bool index_certs_155069;
            
            if (!ok_or_empty_155068) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155051, ":", (long long) min_res_155053, "] out of bounds for array of shape [", (long long) n_85036, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:102:77-88\n   #5  ftRelational.fut:98:5-102:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171861 = b_85037 * j_m_i_155057;
            int64_t bytes_171863 = (int64_t) 8 * j_m_i_155057;
            
            if (mem_171862_cached_sizze_173098 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173098, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (uint8_t *) mem_171853.mem, (int64_t) 0 + b_85037 * inf_155051, (int64_t []) {b_85037, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_85037});
            if (mem_171864_cached_sizze_173099 < bytes_171863) {
                err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_173099, bytes_171863);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171851.mem, (int64_t) 0 + (int64_t) 1 * inf_155051, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_85036; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171849.mem)[write_iter_171567];
                int64_t write_iv_171571 = ((int64_t *) mem_param_171824.mem)[write_iter_171567];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0 + write_iter_171567 * b_85037, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85037});
                
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155051);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) {
                    ((int64_t *) mem_171864)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_85037 - (int64_t) 1, b_85037))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171862, lifted_lambda_res_162803 * b_85037, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_85037});
                }
            }
            lmad_copy_8b(ctx, 1, (uint64_t *) mem_171851.mem, inf_155051, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, b_85037 * inf_155051, (int64_t []) {b_85037, (int64_t) 1}, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_85037});
        }
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171828, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171893, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171892, &mem_param_171828, "mem_param_171828") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171895, bytes_171820, "mem_171895")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint64_t *) ext_mem_171893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_85036});
    if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171897, bytes_171896, "mem_171897")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171897.mem, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (uint8_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {b_85037, (int64_t) 1}, (int64_t []) {n_85036, b_85037});
    if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171895, "mem_171895") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171897, "mem_171897") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173095, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173096, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171829);
        free(mem_171862);
        free(mem_171864);
        free(mem_171872);
        if (memblock_unref(ctx, &mem_171897, "mem_171897") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171895, "mem_171895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171828, "mem_param_171828") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_radixSortRelation_short(struct futhark_context *ctx, struct memblock *mem_out_p_173101, struct memblock *mem_out_p_173102, struct memblock k_mem_171818, struct memblock pL_mem_171819, int64_t n_83270, int64_t b_83271, int64_t block_sizze_83272)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171829_cached_sizze_173103 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171862_cached_sizze_173104 = 0;
    unsigned char *mem_171862 = NULL;
    int64_t mem_171864_cached_sizze_173105 = 0;
    unsigned char *mem_171864 = NULL;
    int64_t mem_171872_cached_sizze_173106 = 0;
    unsigned char *mem_171872 = NULL;
    struct memblock mem_171897;
    
    mem_171897.references = NULL;
    
    struct memblock mem_171895;
    
    mem_171895.references = NULL;
    
    struct memblock mem_param_tmp_172504;
    
    mem_param_tmp_172504.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171853;
    
    mem_171853.references = NULL;
    
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172509;
    
    mem_param_tmp_172509.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_171828;
    
    mem_param_171828.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171892;
    
    ext_mem_171892.references = NULL;
    
    struct memblock ext_mem_171893;
    
    ext_mem_171893.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * n_83270;
    int64_t bytes_171894 = (int64_t) 2 * n_83270;
    int64_t bytes_171896 = n_83270 * b_83271;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < n_83270; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    if (mem_171829_cached_sizze_173103 < n_83270) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173103, n_83270);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171872_cached_sizze_173106 < b_83271) {
        err = lexical_realloc(ctx, &mem_171872, &mem_171872_cached_sizze_173106, b_83271);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (memblock_set(ctx, &mem_param_171824, &k_mem_171818, "k_mem_171818") != 0)
        return 1;
    if (memblock_set(ctx, &mem_param_171828, &pL_mem_171819, "pL_mem_171819") != 0)
        return 1;
    for (int64_t i_154959 = 0; i_154959 < (int64_t) 8; i_154959++) {
        int32_t binop_x_154962 = sext_i64_i32(i_154959);
        int32_t binop_x_154963 = mul32(2, binop_x_154962);
        int32_t zm_lhs_154964 = add32(2, binop_x_154963);
        int32_t min_arg1_154965 = sub32(zm_lhs_154964, 1);
        int32_t min_res_154966 = smin32(16, min_arg1_154965);
        int32_t zp_lhs_154967 = sub32(16, binop_x_154963);
        int32_t ij_bits_154968 = add32(1, zp_lhs_154967);
        int32_t up_to_154969 = shl32(1, ij_bits_154968);
        int64_t tmp_154970 = sext_i32_i64(zp_lhs_154967);
        bool bounds_invalid_upwards_154971 = slt32(zp_lhs_154967, 0);
        bool valid_154973 = !bounds_invalid_upwards_154971;
        bool range_valid_c_154974;
        
        if (!valid_154973) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "...", (long long) tmp_154970, " is invalid.", "-> #0  ftbasics.fut:162:17-26\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:92:77-88\n   #6  ftRelational.fut:88:5-92:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t up_to_154987 = sext_i32_i64(up_to_154969);
        bool bounds_invalid_upwards_154988 = slt32(up_to_154969, 0);
        bool valid_154989 = !bounds_invalid_upwards_154988;
        bool range_valid_c_154990;
        
        if (!valid_154989) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..<", (long long) up_to_154987, " is invalid.", "-> #0  ftbasics.fut:184:21-30\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:92:77-88\n   #5  ftRelational.fut:88:5-92:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int32_t zm_lhs_155029 = add32(8, min_res_154966);
        int32_t zs_lhs_155030 = sub32(zm_lhs_155029, 1);
        int32_t i32_arg0_155031 = sdiv32(zs_lhs_155030, 8);
        int64_t i32_res_155032 = sext_i32_i64(i32_arg0_155031);
        bool zzero_155033 = i32_res_155032 == (int64_t) 0;
        bool nonzzero_155034 = !zzero_155033;
        bool nonzzero_cert_155035;
        
        if (!nonzzero_155034) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:55:22-69\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:92:77-88\n   #5  ftRelational.fut:88:5-92:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t psizze__155036 = sdiv64(block_sizze_83272, i32_res_155032);
        int64_t zm_lhs_155037 = add64(n_83270, psizze__155036);
        int64_t zs_lhs_155038 = sub64(zm_lhs_155037, (int64_t) 1);
        bool zzero_155039 = psizze__155036 == (int64_t) 0;
        bool nonzzero_155040 = !zzero_155039;
        bool nonzzero_cert_155041;
        
        if (!nonzzero_155040) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:56:32-40\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:92:77-88\n   #5  ftRelational.fut:88:5-92:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t max_iter_155042 = sdiv64(zs_lhs_155038, psizze__155036);
        bool bounds_invalid_upwards_155043 = slt64(max_iter_155042, (int64_t) 0);
        bool valid_155044 = !bounds_invalid_upwards_155043;
        bool range_valid_c_155045;
        
        if (!valid_155044) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_155042, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:57:33-46\n   #2  ftSMJ.fut:18:97-99\n   #3  ftSMJ.fut:32:60-62\n   #4  ftSMJ.fut:86:88-91\n   #5  ftRelational.fut:92:77-88\n   #6  ftRelational.fut:88:5-92:89\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t distance_154972 = add64((int64_t) 1, tmp_154970);
        
        for (int64_t i_171547 = 0; i_171547 < n_83270; i_171547++) {
            int16_t eta_p_154976 = ((int16_t *) mem_param_171824.mem)[i_171547];
            int8_t defunc_0_f_res_154977;
            int8_t y_154979 = (int8_t) 0;
            
            for (int64_t i_154978 = 0; i_154978 < distance_154972; i_154978++) {
                int32_t binop_x_154980 = sext_i64_i32(i_154978);
                int32_t get_bit_arg0_154981 = add32(binop_x_154963, binop_x_154980);
                int32_t defunc_0_get_bit_res_154982;
                
                if (futrts_get_bit_1844(ctx, &defunc_0_get_bit_res_154982, get_bit_arg0_154981, eta_p_154976) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                bool cond_154983 = get_bit_arg0_154981 == 15;
                int32_t defunc_0_get_bit_res_154984;
                
                if (cond_154983) {
                    int32_t defunc_0_get_bit_res_t_res_162818 = 1 ^ defunc_0_get_bit_res_154982;
                    
                    defunc_0_get_bit_res_154984 = defunc_0_get_bit_res_t_res_162818;
                } else {
                    defunc_0_get_bit_res_154984 = defunc_0_get_bit_res_154982;
                }
                
                int8_t loopres_154986;
                
                if (futrts_set_bit_2464(ctx, &loopres_154986, binop_x_154980, y_154979, defunc_0_get_bit_res_154984) != 0) {
                    err = 1;
                    goto cleanup;
                }
                
                int8_t y_tmp_172508 = loopres_154986;
                
                y_154979 = y_tmp_172508;
            }
            defunc_0_f_res_154977 = y_154979;
            ((int8_t *) mem_171829)[i_171547] = defunc_0_f_res_154977;
        }
        
        int64_t defunc_0_radix_sort_multistep_res_154991;
        int64_t offs_154994;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_171821, "mem_171821") != 0)
            return 1;
        offs_154994 = (int64_t) 0;
        for (int64_t i_154993 = 0; i_154993 < up_to_154987; i_154993++) {
            int32_t binop_x_154996 = sext_i64_i32(i_154993);
            int8_t index_primexp_154997 = zext_i32_i8(binop_x_154996);
            
            if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t inpacc_162823;
            int64_t defunc_0_reduce_res_162824;
            int64_t inpacc_162711;
            int64_t inpacc_162712;
            
            inpacc_162711 = (int64_t) 0;
            inpacc_162712 = (int64_t) 0;
            for (int64_t i_171565 = 0; i_171565 < n_83270; i_171565++) {
                int8_t eta_p_171794 = ((int8_t *) mem_171829)[i_171565];
                bool lifted_lambda_res_171795 = eta_p_171794 == index_primexp_154997;
                int64_t bool_res_171796 = btoi_bool_i64(lifted_lambda_res_171795);
                int64_t eta_p_171809 = ((int64_t *) mem_param_171838.mem)[i_171565];
                int64_t defunc_0_op_res_171810 = add64(inpacc_162711, bool_res_171796);
                int64_t zm_lhs_171811 = add64(offs_154994, defunc_0_op_res_171810);
                int64_t lifted_lambda_res_171812 = sub64(zm_lhs_171811, (int64_t) 1);
                int64_t defunc_0_f_res_171813 = mul64(bool_res_171796, lifted_lambda_res_171812);
                int64_t defunc_0_f_res_171814 = add64(eta_p_171809, defunc_0_f_res_171813);
                int64_t defunc_0_op_res_162760 = add64(inpacc_162712, bool_res_171796);
                
                ((int64_t *) mem_171840.mem)[i_171565] = defunc_0_f_res_171814;
                
                int64_t inpacc_tmp_172512 = defunc_0_op_res_171810;
                int64_t inpacc_tmp_172513 = defunc_0_op_res_162760;
                
                inpacc_162711 = inpacc_tmp_172512;
                inpacc_162712 = inpacc_tmp_172513;
            }
            inpacc_162823 = inpacc_162711;
            defunc_0_reduce_res_162824 = inpacc_162712;
            
            int64_t tmp_155022 = add64(offs_154994, defunc_0_reduce_res_162824);
            
            if (memblock_set(ctx, &mem_param_tmp_172509, &mem_171840, "mem_171840") != 0)
                return 1;
            
            int64_t offs_tmp_172510 = tmp_155022;
            
            if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
                return 1;
            offs_154994 = offs_tmp_172510;
        }
        if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        defunc_0_radix_sort_multistep_res_154991 = offs_154994;
        if (memblock_alloc(ctx, &mem_171851, bytes_171894, "mem_171851")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_2b(ctx, 1, (uint16_t *) mem_171851.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_param_171824.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83270});
        if (memblock_alloc(ctx, &mem_171853, bytes_171896, "mem_171853")) {
            err = 1;
            goto cleanup;
        }
        lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (int64_t []) {n_83270, b_83271});
        for (int64_t i_155048 = 0; i_155048 < max_iter_155042; i_155048++) {
            int64_t inf_155051 = mul64(psizze__155036, i_155048);
            int64_t min_arg1_155052 = add64(psizze__155036, inf_155051);
            int64_t min_res_155053 = smin64(n_83270, min_arg1_155052);
            bool zzero_lte_i_155063 = sle64((int64_t) 0, inf_155051);
            int64_t j_m_i_155057 = sub64(min_res_155053, inf_155051);
            int64_t m_155059 = sub64(j_m_i_155057, (int64_t) 1);
            int64_t i_p_m_t_s_155060 = add64(inf_155051, m_155059);
            bool i_p_m_t_s_leq_w_155062 = slt64(i_p_m_t_s_155060, n_83270);
            bool y_155065 = i_p_m_t_s_leq_w_155062 && zzero_lte_i_155063;
            bool zzero_leq_i_p_m_t_s_155061 = sle64((int64_t) 0, i_p_m_t_s_155060);
            bool y_155066 = zzero_leq_i_p_m_t_s_155061 && y_155065;
            bool i_lte_j_155064 = sle64(inf_155051, min_res_155053);
            bool forwards_ok_155067 = i_lte_j_155064 && y_155066;
            bool empty_slice_155058 = j_m_i_155057 == (int64_t) 0;
            bool ok_or_empty_155068 = empty_slice_155058 || forwards_ok_155067;
            bool index_certs_155069;
            
            if (!ok_or_empty_155068) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) inf_155051, ":", (long long) min_res_155053, "] out of bounds for array of shape [", (long long) n_83270, "].", "-> #0  ftbasics.fut:61:44-57\n   #1  ftSMJ.fut:18:97-99\n   #2  ftSMJ.fut:32:60-62\n   #3  ftSMJ.fut:86:88-91\n   #4  ftRelational.fut:92:77-88\n   #5  ftRelational.fut:88:5-92:89\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t bytes_171861 = b_83271 * j_m_i_155057;
            int64_t bytes_171863 = (int64_t) 2 * j_m_i_155057;
            
            if (mem_171862_cached_sizze_173104 < bytes_171861) {
                err = lexical_realloc(ctx, &mem_171862, &mem_171862_cached_sizze_173104, bytes_171861);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (uint8_t *) mem_171853.mem, (int64_t) 0 + b_83271 * inf_155051, (int64_t []) {b_83271, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_83271});
            if (mem_171864_cached_sizze_173105 < bytes_171863) {
                err = lexical_realloc(ctx, &mem_171864, &mem_171864_cached_sizze_173105, bytes_171863);
                if (err != FUTHARK_SUCCESS)
                    goto cleanup;
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171851.mem, (int64_t) 0 + (int64_t) 1 * inf_155051, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            for (int64_t write_iter_171567 = 0; write_iter_171567 < n_83270; write_iter_171567++) {
                int64_t write_iv_171570 = ((int64_t *) ext_mem_171849.mem)[write_iter_171567];
                int16_t write_iv_171571 = ((int16_t *) mem_param_171824.mem)[write_iter_171567];
                
                lmad_copy_1b(ctx, 1, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_param_171828.mem, (int64_t) 0 + write_iter_171567 * b_83271, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83271});
                
                int64_t lifted_lambda_res_162803 = sub64(write_iv_171570, inf_155051);
                
                if (sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) {
                    ((int16_t *) mem_171864)[lifted_lambda_res_162803] = write_iv_171571;
                }
                if ((sle64((int64_t) 0, lifted_lambda_res_162803) && slt64(lifted_lambda_res_162803, j_m_i_155057)) && (sle64((int64_t) 0, (int64_t) 0) && slt64(b_83271 - (int64_t) 1, b_83271))) {
                    lmad_copy_1b(ctx, 1, (uint8_t *) mem_171862, lifted_lambda_res_162803 * b_83271, (int64_t []) {(int64_t) 1}, (uint8_t *) mem_171872, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {b_83271});
                }
            }
            lmad_copy_2b(ctx, 1, (uint16_t *) mem_171851.mem, inf_155051, (int64_t []) {(int64_t) 1}, (uint16_t *) mem_171864, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {j_m_i_155057});
            lmad_copy_1b(ctx, 2, (uint8_t *) mem_171853.mem, b_83271 * inf_155051, (int64_t []) {b_83271, (int64_t) 1}, (uint8_t *) mem_171862, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (int64_t []) {j_m_i_155057, b_83271});
        }
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_tmp_172504, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171828, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171893, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    if (memblock_set(ctx, &ext_mem_171892, &mem_param_171828, "mem_param_171828") != 0)
        return 1;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171895, bytes_171894, "mem_171895")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_2b(ctx, 1, (uint16_t *) mem_171895.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (uint16_t *) ext_mem_171893.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {n_83270});
    if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
        return 1;
    if (memblock_alloc(ctx, &mem_171897, bytes_171896, "mem_171897")) {
        err = 1;
        goto cleanup;
    }
    lmad_copy_1b(ctx, 2, (uint8_t *) mem_171897.mem, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (uint8_t *) ext_mem_171892.mem, (int64_t) 0, (int64_t []) {b_83271, (int64_t) 1}, (int64_t []) {n_83270, b_83271});
    if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171895, "mem_171895") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171897, "mem_171897") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173101, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173102, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        free(mem_171829);
        free(mem_171862);
        free(mem_171864);
        free(mem_171872);
        if (memblock_unref(ctx, &mem_171897, "mem_171897") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171895, "mem_171895") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172504, "mem_param_tmp_172504") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171853, "mem_171853") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172509, "mem_param_tmp_172509") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171828, "mem_param_171828") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171892, "ext_mem_171892") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171893, "ext_mem_171893") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_short_sum(struct futhark_context *ctx, struct memblock *mem_out_p_173107, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, int64_t nz2080U_149566, int64_t group_no_149567)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    bool bounds_invalid_upwards_162322 = slt64(group_no_149567, (int64_t) 0);
    bool valid_162323 = !bounds_invalid_upwards_162322;
    bool range_valid_c_162324;
    
    if (!valid_162323) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) group_no_149567, " is invalid.", "-> #0  /prelude/soacs.fut:133:41-49\n   #1  ft_SortGroupBy.fut:12:49-51\n   #2  ft_SortGroupBy.fut:242:68-70\n   #3  ftRelational.fut:337:23-50\n   #4  ftRelational.fut:337:5-50\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171820 = (int64_t) 2 * group_no_149567;
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_149567; nest_i_172501++) {
        ((int16_t *) mem_171821.mem)[nest_i_172501] = (int16_t) 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_149566; iter_171545++) {
        int64_t pixel_171547 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int16_t pixel_171548 = ((int16_t *) eta_p_mem_171819.mem)[iter_171545];
        bool less_than_zzero_171549 = slt64(pixel_171547, (int64_t) 0);
        bool greater_than_sizze_171550 = sle64(group_no_149567, pixel_171547);
        bool outside_bounds_dim_171551 = less_than_zzero_171549 || greater_than_sizze_171550;
        
        if (!outside_bounds_dim_171551) {
            int16_t read_hist_171553 = ((int16_t *) mem_171821.mem)[pixel_171547];
            int16_t zp_res_162329 = add16(pixel_171548, read_hist_171553);
            
            ((int16_t *) mem_171821.mem)[pixel_171547] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171821, "mem_171821") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173107, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_short_sum_xy(struct futhark_context *ctx, struct memblock *mem_out_p_173108, struct memblock eta_p_mem_171818, struct memblock eta_p_mem_171819, struct memblock eta_p_mem_171820, int64_t nz2080U_149643, int64_t group_no_149644)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171822;
    
    mem_171822.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171821 = (int64_t) 2 * group_no_149644;
    
    if (memblock_alloc(ctx, &mem_171822, bytes_171821, "mem_171822")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172501 = 0; nest_i_172501 < group_no_149644; nest_i_172501++) {
        ((int16_t *) mem_171822.mem)[nest_i_172501] = (int16_t) 0;
    }
    for (int64_t iter_171545 = 0; iter_171545 < nz2080U_149643; iter_171545++) {
        int16_t pixel_171547 = ((int16_t *) eta_p_mem_171819.mem)[iter_171545];
        int16_t pixel_171548 = ((int16_t *) eta_p_mem_171820.mem)[iter_171545];
        int64_t pixel_171549 = ((int64_t *) eta_p_mem_171818.mem)[iter_171545];
        int16_t zt_res_162518 = mul16(pixel_171547, pixel_171548);
        bool less_than_zzero_171550 = slt64(pixel_171549, (int64_t) 0);
        bool greater_than_sizze_171551 = sle64(group_no_149644, pixel_171549);
        bool outside_bounds_dim_171552 = less_than_zzero_171550 || greater_than_sizze_171551;
        
        if (!outside_bounds_dim_171552) {
            int16_t read_hist_171554 = ((int16_t *) mem_171822.mem)[pixel_171549];
            int16_t zp_res_162329 = add16(zt_res_162518, read_hist_171554);
            
            ((int16_t *) mem_171822.mem)[pixel_171549] = zp_res_162329;
        }
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171822, "mem_171822") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173108, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171822, "mem_171822") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_173109, struct memblock *mem_out_p_173110, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_147656, int64_t dz2081U_147657)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171826;
    
    mem_171826.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171835;
    
    ext_mem_171835.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * dz2080U_147656;
    double i64_res_153527 = sitofp_i64_f64(dz2081U_147657);
    double log2_res_153528 = futrts_log2_64(i64_res_153527);
    double ceil_res_153529 = futrts_ceil64(log2_res_153528);
    int64_t f64_res_153530 = fptosi_f64_i64(ceil_res_153529);
    int64_t num_iter_153531 = add64((int64_t) 1, f64_res_153530);
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < dz2080U_147656; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_153533 = sub64(dz2081U_147657, (int64_t) 1);
    int64_t bsearch_first_153535;
    int64_t last_step_153538;
    
    if (memblock_set(ctx, &mem_param_171824, &mem_171821, "mem_171821") != 0)
        return 1;
    last_step_153538 = dz2081U_147657;
    for (int64_t i_153536 = 0; i_153536 < num_iter_153531; i_153536++) {
        int64_t zs_lhs_153539 = add64((int64_t) 1, last_step_153538);
        int64_t this_step_153540 = sdiv64(zs_lhs_153539, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171826, bytes_171820, "mem_171826")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < dz2080U_147656; i_171547++) {
            int64_t eta_p_162517 = ((int64_t *) mem_param_171824.mem)[i_171547];
            double eta_p_162518 = ((double *) k_ids_mem_171818.mem)[i_171547];
            bool cond_162520 = sle64(eta_p_162517, (int64_t) 0);
            double prev_elem_162521;
            
            if (cond_162520) {
                bool y_162710 = slt64((int64_t) 0, dz2081U_147657);
                bool index_certs_162711;
                
                if (!y_162710) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:55:78-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double prev_elem_t_res_162712 = ((double *) ks_mem_171819.mem)[(int64_t) 0];
                
                prev_elem_162521 = prev_elem_t_res_162712;
            } else {
                int64_t tmp_162525 = sub64(eta_p_162517, (int64_t) 1);
                bool x_162526 = sle64((int64_t) 0, tmp_162525);
                bool y_162527 = slt64(tmp_162525, dz2081U_147657);
                bool bounds_check_162528 = x_162526 && y_162527;
                bool index_certs_162529;
                
                if (!bounds_check_162528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162525, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:55:96-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double prev_elem_f_res_162530 = ((double *) ks_mem_171819.mem)[tmp_162525];
                
                prev_elem_162521 = prev_elem_f_res_162530;
            }
            
            bool cond_162531 = slt64(eta_p_162517, (int64_t) 0);
            double cur_elem_162532;
            
            if (cond_162531) {
                bool y_162713 = slt64((int64_t) 0, dz2081U_147657);
                bool index_certs_162714;
                
                if (!y_162713) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:56:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_t_res_162715 = ((double *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162532 = cur_elem_t_res_162715;
            } else {
                bool x_162536 = sle64((int64_t) 0, eta_p_162517);
                bool y_162537 = slt64(eta_p_162517, dz2081U_147657);
                bool bounds_check_162538 = x_162536 && y_162537;
                bool index_certs_162539;
                
                if (!bounds_check_162538) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162517, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:56:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_f_res_162540 = ((double *) ks_mem_171819.mem)[eta_p_162517];
                
                cur_elem_162532 = cur_elem_f_res_162540;
            }
            
            bool cond_162541 = sle64(zgze_rhs_153533, eta_p_162517);
            double next_elem_162542;
            
            if (cond_162541) {
                bool x_162717 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162718 = slt64(zgze_rhs_153533, dz2081U_147657);
                bool bounds_check_162719 = x_162717 && y_162718;
                bool index_certs_162720;
                
                if (!bounds_check_162719) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:57:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_t_res_162721 = ((double *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162542 = next_elem_t_res_162721;
            } else {
                int64_t tmp_162549 = add64((int64_t) 1, eta_p_162517);
                bool x_162550 = sle64((int64_t) 0, tmp_162549);
                bool y_162551 = slt64(tmp_162549, dz2081U_147657);
                bool bounds_check_162552 = x_162550 && y_162551;
                bool index_certs_162553;
                
                if (!bounds_check_162552) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162549, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:57:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_f_res_162554 = ((double *) ks_mem_171819.mem)[tmp_162549];
                
                next_elem_162542 = next_elem_f_res_162554;
            }
            
            int64_t defunc_0_f_res_162559;
            
            if (cond_162531) {
                defunc_0_f_res_162559 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162560 = eta_p_162518 == cur_elem_162532;
                bool cond_162561 = eta_p_162517 == (int64_t) 0;
                bool defunc_0_gt_res_162562 = prev_elem_162521 < eta_p_162518;
                bool x_162563 = !cond_162561;
                bool y_162564 = defunc_0_gt_res_162562 && x_162563;
                bool cond_t_res_162565 = cond_162561 || y_162564;
                bool x_162566 = defunc_0_eq_res_162560 && cond_t_res_162565;
                int64_t defunc_0_f_res_f_res_162567;
                
                if (x_162566) {
                    defunc_0_f_res_f_res_162567 = eta_p_162517;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162568;
                    
                    if (defunc_0_eq_res_162560) {
                        int64_t max_arg1_162722 = sub64(eta_p_162517, this_step_153540);
                        int64_t max_res_162723 = smax64((int64_t) 0, max_arg1_162722);
                        
                        defunc_0_f_res_f_res_f_res_162568 = max_res_162723;
                    } else {
                        bool defunc_0_gt_res_162571 = cur_elem_162532 < eta_p_162518;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162572;
                        
                        if (defunc_0_gt_res_162571) {
                            bool cond_162725 = eta_p_162517 == zgze_rhs_153533;
                            bool defunc_0_gt_res_162726 = eta_p_162518 < next_elem_162542;
                            bool x_162727 = !cond_162725;
                            bool y_162728 = defunc_0_gt_res_162726 && x_162727;
                            bool cond_162729 = cond_162725 || y_162728;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                            
                            if (cond_162729) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162731 = add64(this_step_153540, eta_p_162517);
                                int64_t min_res_162732 = smin64(zgze_rhs_153533, min_arg1_162731);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = min_res_162732;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                            
                            if (cond_t_res_162565) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162583 = sub64(eta_p_162517, this_step_153540);
                                int64_t max_res_162584 = smax64((int64_t) 0, max_arg1_162583);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = max_res_162584;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                        }
                        defunc_0_f_res_f_res_f_res_162568 = defunc_0_f_res_f_res_f_res_f_res_162572;
                    }
                    defunc_0_f_res_f_res_162567 = defunc_0_f_res_f_res_f_res_162568;
                }
                defunc_0_f_res_162559 = defunc_0_f_res_f_res_162567;
            }
            ((int64_t *) mem_171826.mem)[i_171547] = defunc_0_f_res_162559;
        }
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171826, "mem_171826") != 0)
            return 1;
        
        int64_t last_step_tmp_172505 = this_step_153540;
        
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        last_step_153538 = last_step_tmp_172505;
    }
    if (memblock_set(ctx, &ext_mem_171835, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    bsearch_first_153535 = last_step_153538;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    
    int64_t bsearch_last_153614;
    int64_t last_step_153617;
    
    if (memblock_set(ctx, &mem_param_171838, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    last_step_153617 = dz2081U_147657;
    for (int64_t i_153615 = 0; i_153615 < num_iter_153531; i_153615++) {
        int64_t zs_lhs_153618 = add64((int64_t) 1, last_step_153617);
        int64_t max_arg1_153619 = sdiv64(zs_lhs_153618, (int64_t) 2);
        int64_t max_res_153620 = smax64((int64_t) 1, max_arg1_153619);
        
        if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < dz2080U_147656; i_171551++) {
            int64_t eta_p_162634 = ((int64_t *) mem_param_171838.mem)[i_171551];
            double eta_p_162635 = ((double *) k_ids_mem_171818.mem)[i_171551];
            bool cond_162637 = slt64(eta_p_162634, (int64_t) 0);
            double cur_elem_162638;
            
            if (cond_162637) {
                bool y_162734 = slt64((int64_t) 0, dz2081U_147657);
                bool index_certs_162735;
                
                if (!y_162734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:81:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_t_res_162736 = ((double *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162638 = cur_elem_t_res_162736;
            } else {
                bool x_162642 = sle64((int64_t) 0, eta_p_162634);
                bool y_162643 = slt64(eta_p_162634, dz2081U_147657);
                bool bounds_check_162644 = x_162642 && y_162643;
                bool index_certs_162645;
                
                if (!bounds_check_162644) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162634, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:81:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double cur_elem_f_res_162646 = ((double *) ks_mem_171819.mem)[eta_p_162634];
                
                cur_elem_162638 = cur_elem_f_res_162646;
            }
            
            bool cond_162647 = sle64(zgze_rhs_153533, eta_p_162634);
            double next_elem_162648;
            
            if (cond_162647) {
                bool x_162738 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162739 = slt64(zgze_rhs_153533, dz2081U_147657);
                bool bounds_check_162740 = x_162738 && y_162739;
                bool index_certs_162741;
                
                if (!bounds_check_162740) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:82:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_t_res_162742 = ((double *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162648 = next_elem_t_res_162742;
            } else {
                int64_t tmp_162655 = add64((int64_t) 1, eta_p_162634);
                bool x_162656 = sle64((int64_t) 0, tmp_162655);
                bool y_162657 = slt64(tmp_162655, dz2081U_147657);
                bool bounds_check_162658 = x_162656 && y_162657;
                bool index_certs_162659;
                
                if (!bounds_check_162658) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162655, "] out of bounds for array of shape [", (long long) dz2081U_147657, "].", "-> #0  ft_SortGroupBy.fut:82:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:311:73-76\n   #4  ftRelational.fut:309:5-312:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double next_elem_f_res_162660 = ((double *) ks_mem_171819.mem)[tmp_162655];
                
                next_elem_162648 = next_elem_f_res_162660;
            }
            
            int64_t defunc_0_f_res_162664;
            
            if (cond_162637) {
                defunc_0_f_res_162664 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162665 = eta_p_162635 == cur_elem_162638;
                bool cond_162667 = eta_p_162634 == zgze_rhs_153533;
                bool defunc_0_gt_res_162668 = eta_p_162635 < next_elem_162648;
                bool x_162669 = !cond_162667;
                bool y_162670 = defunc_0_gt_res_162668 && x_162669;
                bool cond_t_res_162671 = cond_162667 || y_162670;
                bool x_162672 = defunc_0_eq_res_162665 && cond_t_res_162671;
                int64_t defunc_0_f_res_f_res_162673;
                
                if (x_162672) {
                    defunc_0_f_res_f_res_162673 = eta_p_162634;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162674;
                    
                    if (defunc_0_eq_res_162665) {
                        int64_t min_arg1_162743 = add64(max_res_153620, eta_p_162634);
                        int64_t min_res_162744 = smin64(zgze_rhs_153533, min_arg1_162743);
                        
                        defunc_0_f_res_f_res_f_res_162674 = min_res_162744;
                    } else {
                        bool defunc_0_gt_res_162677 = cur_elem_162638 < eta_p_162635;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162678;
                        
                        if (defunc_0_gt_res_162677) {
                            int64_t min_arg1_162745 = add64(max_res_153620, eta_p_162634);
                            int64_t min_res_162746 = smin64(zgze_rhs_153533, min_arg1_162745);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = min_res_162746;
                        } else {
                            int64_t max_arg1_162681 = sub64(eta_p_162634, max_res_153620);
                            int64_t max_res_162682 = smax64((int64_t) 0, max_arg1_162681);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = max_res_162682;
                        }
                        defunc_0_f_res_f_res_f_res_162674 = defunc_0_f_res_f_res_f_res_f_res_162678;
                    }
                    defunc_0_f_res_f_res_162673 = defunc_0_f_res_f_res_f_res_162674;
                }
                defunc_0_f_res_162664 = defunc_0_f_res_f_res_162673;
            }
            ((int64_t *) mem_171840.mem)[i_171551] = defunc_0_f_res_162664;
        }
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171840, "mem_171840") != 0)
            return 1;
        
        int64_t last_step_tmp_172509 = max_res_153620;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        last_step_153617 = last_step_tmp_172509;
    }
    if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
        return 1;
    bsearch_last_153614 = last_step_153617;
    if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < dz2080U_147656; i_171555++) {
        int64_t eta_p_153674 = ((int64_t *) ext_mem_171835.mem)[i_171555];
        int64_t eta_p_153675 = ((int64_t *) ext_mem_171849.mem)[i_171555];
        bool cond_153676 = slt64(eta_p_153674, (int64_t) 0);
        int64_t lifted_lambda_res_153677;
        
        if (cond_153676) {
            lifted_lambda_res_153677 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153678 = sub64(eta_p_153675, eta_p_153674);
            int64_t lifted_lambda_res_f_res_153679 = add64((int64_t) 1, zp_lhs_153678);
            
            lifted_lambda_res_153677 = lifted_lambda_res_f_res_153679;
        }
        ((int64_t *) mem_171851.mem)[i_171555] = lifted_lambda_res_153677;
    }
    if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171851, "mem_171851") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173109, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173110, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171826, "mem_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171835, "ext_mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_173111, struct memblock *mem_out_p_173112, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_146866, int64_t dz2081U_146867)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171826;
    
    mem_171826.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171835;
    
    ext_mem_171835.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * dz2080U_146866;
    double i64_res_153527 = sitofp_i64_f64(dz2081U_146867);
    double log2_res_153528 = futrts_log2_64(i64_res_153527);
    double ceil_res_153529 = futrts_ceil64(log2_res_153528);
    int64_t f64_res_153530 = fptosi_f64_i64(ceil_res_153529);
    int64_t num_iter_153531 = add64((int64_t) 1, f64_res_153530);
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < dz2080U_146866; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_153533 = sub64(dz2081U_146867, (int64_t) 1);
    int64_t bsearch_first_153535;
    int64_t last_step_153538;
    
    if (memblock_set(ctx, &mem_param_171824, &mem_171821, "mem_171821") != 0)
        return 1;
    last_step_153538 = dz2081U_146867;
    for (int64_t i_153536 = 0; i_153536 < num_iter_153531; i_153536++) {
        int64_t zs_lhs_153539 = add64((int64_t) 1, last_step_153538);
        int64_t this_step_153540 = sdiv64(zs_lhs_153539, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171826, bytes_171820, "mem_171826")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < dz2080U_146866; i_171547++) {
            int64_t eta_p_162517 = ((int64_t *) mem_param_171824.mem)[i_171547];
            float eta_p_162518 = ((float *) k_ids_mem_171818.mem)[i_171547];
            bool cond_162520 = sle64(eta_p_162517, (int64_t) 0);
            float prev_elem_162521;
            
            if (cond_162520) {
                bool y_162710 = slt64((int64_t) 0, dz2081U_146867);
                bool index_certs_162711;
                
                if (!y_162710) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:55:78-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float prev_elem_t_res_162712 = ((float *) ks_mem_171819.mem)[(int64_t) 0];
                
                prev_elem_162521 = prev_elem_t_res_162712;
            } else {
                int64_t tmp_162525 = sub64(eta_p_162517, (int64_t) 1);
                bool x_162526 = sle64((int64_t) 0, tmp_162525);
                bool y_162527 = slt64(tmp_162525, dz2081U_146867);
                bool bounds_check_162528 = x_162526 && y_162527;
                bool index_certs_162529;
                
                if (!bounds_check_162528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162525, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:55:96-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float prev_elem_f_res_162530 = ((float *) ks_mem_171819.mem)[tmp_162525];
                
                prev_elem_162521 = prev_elem_f_res_162530;
            }
            
            bool cond_162531 = slt64(eta_p_162517, (int64_t) 0);
            float cur_elem_162532;
            
            if (cond_162531) {
                bool y_162713 = slt64((int64_t) 0, dz2081U_146867);
                bool index_certs_162714;
                
                if (!y_162713) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:56:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_t_res_162715 = ((float *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162532 = cur_elem_t_res_162715;
            } else {
                bool x_162536 = sle64((int64_t) 0, eta_p_162517);
                bool y_162537 = slt64(eta_p_162517, dz2081U_146867);
                bool bounds_check_162538 = x_162536 && y_162537;
                bool index_certs_162539;
                
                if (!bounds_check_162538) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162517, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:56:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_f_res_162540 = ((float *) ks_mem_171819.mem)[eta_p_162517];
                
                cur_elem_162532 = cur_elem_f_res_162540;
            }
            
            bool cond_162541 = sle64(zgze_rhs_153533, eta_p_162517);
            float next_elem_162542;
            
            if (cond_162541) {
                bool x_162717 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162718 = slt64(zgze_rhs_153533, dz2081U_146867);
                bool bounds_check_162719 = x_162717 && y_162718;
                bool index_certs_162720;
                
                if (!bounds_check_162719) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:57:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_t_res_162721 = ((float *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162542 = next_elem_t_res_162721;
            } else {
                int64_t tmp_162549 = add64((int64_t) 1, eta_p_162517);
                bool x_162550 = sle64((int64_t) 0, tmp_162549);
                bool y_162551 = slt64(tmp_162549, dz2081U_146867);
                bool bounds_check_162552 = x_162550 && y_162551;
                bool index_certs_162553;
                
                if (!bounds_check_162552) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162549, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:57:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_f_res_162554 = ((float *) ks_mem_171819.mem)[tmp_162549];
                
                next_elem_162542 = next_elem_f_res_162554;
            }
            
            int64_t defunc_0_f_res_162559;
            
            if (cond_162531) {
                defunc_0_f_res_162559 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162560 = eta_p_162518 == cur_elem_162532;
                bool cond_162561 = eta_p_162517 == (int64_t) 0;
                bool defunc_0_gt_res_162562 = prev_elem_162521 < eta_p_162518;
                bool x_162563 = !cond_162561;
                bool y_162564 = defunc_0_gt_res_162562 && x_162563;
                bool cond_t_res_162565 = cond_162561 || y_162564;
                bool x_162566 = defunc_0_eq_res_162560 && cond_t_res_162565;
                int64_t defunc_0_f_res_f_res_162567;
                
                if (x_162566) {
                    defunc_0_f_res_f_res_162567 = eta_p_162517;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162568;
                    
                    if (defunc_0_eq_res_162560) {
                        int64_t max_arg1_162722 = sub64(eta_p_162517, this_step_153540);
                        int64_t max_res_162723 = smax64((int64_t) 0, max_arg1_162722);
                        
                        defunc_0_f_res_f_res_f_res_162568 = max_res_162723;
                    } else {
                        bool defunc_0_gt_res_162571 = cur_elem_162532 < eta_p_162518;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162572;
                        
                        if (defunc_0_gt_res_162571) {
                            bool cond_162725 = eta_p_162517 == zgze_rhs_153533;
                            bool defunc_0_gt_res_162726 = eta_p_162518 < next_elem_162542;
                            bool x_162727 = !cond_162725;
                            bool y_162728 = defunc_0_gt_res_162726 && x_162727;
                            bool cond_162729 = cond_162725 || y_162728;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                            
                            if (cond_162729) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162731 = add64(this_step_153540, eta_p_162517);
                                int64_t min_res_162732 = smin64(zgze_rhs_153533, min_arg1_162731);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = min_res_162732;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                            
                            if (cond_t_res_162565) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162583 = sub64(eta_p_162517, this_step_153540);
                                int64_t max_res_162584 = smax64((int64_t) 0, max_arg1_162583);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = max_res_162584;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                        }
                        defunc_0_f_res_f_res_f_res_162568 = defunc_0_f_res_f_res_f_res_f_res_162572;
                    }
                    defunc_0_f_res_f_res_162567 = defunc_0_f_res_f_res_f_res_162568;
                }
                defunc_0_f_res_162559 = defunc_0_f_res_f_res_162567;
            }
            ((int64_t *) mem_171826.mem)[i_171547] = defunc_0_f_res_162559;
        }
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171826, "mem_171826") != 0)
            return 1;
        
        int64_t last_step_tmp_172505 = this_step_153540;
        
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        last_step_153538 = last_step_tmp_172505;
    }
    if (memblock_set(ctx, &ext_mem_171835, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    bsearch_first_153535 = last_step_153538;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    
    int64_t bsearch_last_153614;
    int64_t last_step_153617;
    
    if (memblock_set(ctx, &mem_param_171838, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    last_step_153617 = dz2081U_146867;
    for (int64_t i_153615 = 0; i_153615 < num_iter_153531; i_153615++) {
        int64_t zs_lhs_153618 = add64((int64_t) 1, last_step_153617);
        int64_t max_arg1_153619 = sdiv64(zs_lhs_153618, (int64_t) 2);
        int64_t max_res_153620 = smax64((int64_t) 1, max_arg1_153619);
        
        if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < dz2080U_146866; i_171551++) {
            int64_t eta_p_162634 = ((int64_t *) mem_param_171838.mem)[i_171551];
            float eta_p_162635 = ((float *) k_ids_mem_171818.mem)[i_171551];
            bool cond_162637 = slt64(eta_p_162634, (int64_t) 0);
            float cur_elem_162638;
            
            if (cond_162637) {
                bool y_162734 = slt64((int64_t) 0, dz2081U_146867);
                bool index_certs_162735;
                
                if (!y_162734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:81:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_t_res_162736 = ((float *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162638 = cur_elem_t_res_162736;
            } else {
                bool x_162642 = sle64((int64_t) 0, eta_p_162634);
                bool y_162643 = slt64(eta_p_162634, dz2081U_146867);
                bool bounds_check_162644 = x_162642 && y_162643;
                bool index_certs_162645;
                
                if (!bounds_check_162644) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162634, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:81:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float cur_elem_f_res_162646 = ((float *) ks_mem_171819.mem)[eta_p_162634];
                
                cur_elem_162638 = cur_elem_f_res_162646;
            }
            
            bool cond_162647 = sle64(zgze_rhs_153533, eta_p_162634);
            float next_elem_162648;
            
            if (cond_162647) {
                bool x_162738 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162739 = slt64(zgze_rhs_153533, dz2081U_146867);
                bool bounds_check_162740 = x_162738 && y_162739;
                bool index_certs_162741;
                
                if (!bounds_check_162740) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:82:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_t_res_162742 = ((float *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162648 = next_elem_t_res_162742;
            } else {
                int64_t tmp_162655 = add64((int64_t) 1, eta_p_162634);
                bool x_162656 = sle64((int64_t) 0, tmp_162655);
                bool y_162657 = slt64(tmp_162655, dz2081U_146867);
                bool bounds_check_162658 = x_162656 && y_162657;
                bool index_certs_162659;
                
                if (!bounds_check_162658) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162655, "] out of bounds for array of shape [", (long long) dz2081U_146867, "].", "-> #0  ft_SortGroupBy.fut:82:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:307:73-76\n   #4  ftRelational.fut:305:5-308:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float next_elem_f_res_162660 = ((float *) ks_mem_171819.mem)[tmp_162655];
                
                next_elem_162648 = next_elem_f_res_162660;
            }
            
            int64_t defunc_0_f_res_162664;
            
            if (cond_162637) {
                defunc_0_f_res_162664 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162665 = eta_p_162635 == cur_elem_162638;
                bool cond_162667 = eta_p_162634 == zgze_rhs_153533;
                bool defunc_0_gt_res_162668 = eta_p_162635 < next_elem_162648;
                bool x_162669 = !cond_162667;
                bool y_162670 = defunc_0_gt_res_162668 && x_162669;
                bool cond_t_res_162671 = cond_162667 || y_162670;
                bool x_162672 = defunc_0_eq_res_162665 && cond_t_res_162671;
                int64_t defunc_0_f_res_f_res_162673;
                
                if (x_162672) {
                    defunc_0_f_res_f_res_162673 = eta_p_162634;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162674;
                    
                    if (defunc_0_eq_res_162665) {
                        int64_t min_arg1_162743 = add64(max_res_153620, eta_p_162634);
                        int64_t min_res_162744 = smin64(zgze_rhs_153533, min_arg1_162743);
                        
                        defunc_0_f_res_f_res_f_res_162674 = min_res_162744;
                    } else {
                        bool defunc_0_gt_res_162677 = cur_elem_162638 < eta_p_162635;
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162678;
                        
                        if (defunc_0_gt_res_162677) {
                            int64_t min_arg1_162745 = add64(max_res_153620, eta_p_162634);
                            int64_t min_res_162746 = smin64(zgze_rhs_153533, min_arg1_162745);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = min_res_162746;
                        } else {
                            int64_t max_arg1_162681 = sub64(eta_p_162634, max_res_153620);
                            int64_t max_res_162682 = smax64((int64_t) 0, max_arg1_162681);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = max_res_162682;
                        }
                        defunc_0_f_res_f_res_f_res_162674 = defunc_0_f_res_f_res_f_res_f_res_162678;
                    }
                    defunc_0_f_res_f_res_162673 = defunc_0_f_res_f_res_f_res_162674;
                }
                defunc_0_f_res_162664 = defunc_0_f_res_f_res_162673;
            }
            ((int64_t *) mem_171840.mem)[i_171551] = defunc_0_f_res_162664;
        }
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171840, "mem_171840") != 0)
            return 1;
        
        int64_t last_step_tmp_172509 = max_res_153620;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        last_step_153617 = last_step_tmp_172509;
    }
    if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
        return 1;
    bsearch_last_153614 = last_step_153617;
    if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < dz2080U_146866; i_171555++) {
        int64_t eta_p_153674 = ((int64_t *) ext_mem_171835.mem)[i_171555];
        int64_t eta_p_153675 = ((int64_t *) ext_mem_171849.mem)[i_171555];
        bool cond_153676 = slt64(eta_p_153674, (int64_t) 0);
        int64_t lifted_lambda_res_153677;
        
        if (cond_153676) {
            lifted_lambda_res_153677 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153678 = sub64(eta_p_153675, eta_p_153674);
            int64_t lifted_lambda_res_f_res_153679 = add64((int64_t) 1, zp_lhs_153678);
            
            lifted_lambda_res_153677 = lifted_lambda_res_f_res_153679;
        }
        ((int64_t *) mem_171851.mem)[i_171555] = lifted_lambda_res_153677;
    }
    if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171851, "mem_171851") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173111, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173112, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171826, "mem_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171835, "ext_mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_173113, struct memblock *mem_out_p_173114, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_145286, int64_t dz2081U_145287)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171826;
    
    mem_171826.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171835;
    
    ext_mem_171835.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * dz2080U_145286;
    double i64_res_153527 = sitofp_i64_f64(dz2081U_145287);
    double log2_res_153528 = futrts_log2_64(i64_res_153527);
    double ceil_res_153529 = futrts_ceil64(log2_res_153528);
    int64_t f64_res_153530 = fptosi_f64_i64(ceil_res_153529);
    int64_t num_iter_153531 = add64((int64_t) 1, f64_res_153530);
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < dz2080U_145286; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_153533 = sub64(dz2081U_145287, (int64_t) 1);
    int64_t bsearch_first_153535;
    int64_t last_step_153538;
    
    if (memblock_set(ctx, &mem_param_171824, &mem_171821, "mem_171821") != 0)
        return 1;
    last_step_153538 = dz2081U_145287;
    for (int64_t i_153536 = 0; i_153536 < num_iter_153531; i_153536++) {
        int64_t zs_lhs_153539 = add64((int64_t) 1, last_step_153538);
        int64_t this_step_153540 = sdiv64(zs_lhs_153539, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171826, bytes_171820, "mem_171826")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < dz2080U_145286; i_171547++) {
            int64_t eta_p_162517 = ((int64_t *) mem_param_171824.mem)[i_171547];
            int32_t eta_p_162518 = ((int32_t *) k_ids_mem_171818.mem)[i_171547];
            bool cond_162520 = sle64(eta_p_162517, (int64_t) 0);
            int32_t prev_elem_162521;
            
            if (cond_162520) {
                bool y_162710 = slt64((int64_t) 0, dz2081U_145287);
                bool index_certs_162711;
                
                if (!y_162710) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:55:78-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t prev_elem_t_res_162712 = ((int32_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                prev_elem_162521 = prev_elem_t_res_162712;
            } else {
                int64_t tmp_162525 = sub64(eta_p_162517, (int64_t) 1);
                bool x_162526 = sle64((int64_t) 0, tmp_162525);
                bool y_162527 = slt64(tmp_162525, dz2081U_145287);
                bool bounds_check_162528 = x_162526 && y_162527;
                bool index_certs_162529;
                
                if (!bounds_check_162528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162525, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:55:96-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t prev_elem_f_res_162530 = ((int32_t *) ks_mem_171819.mem)[tmp_162525];
                
                prev_elem_162521 = prev_elem_f_res_162530;
            }
            
            bool cond_162531 = slt64(eta_p_162517, (int64_t) 0);
            int32_t cur_elem_162532;
            
            if (cond_162531) {
                bool y_162713 = slt64((int64_t) 0, dz2081U_145287);
                bool index_certs_162714;
                
                if (!y_162713) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:56:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_t_res_162715 = ((int32_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162532 = cur_elem_t_res_162715;
            } else {
                bool x_162536 = sle64((int64_t) 0, eta_p_162517);
                bool y_162537 = slt64(eta_p_162517, dz2081U_145287);
                bool bounds_check_162538 = x_162536 && y_162537;
                bool index_certs_162539;
                
                if (!bounds_check_162538) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162517, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:56:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_f_res_162540 = ((int32_t *) ks_mem_171819.mem)[eta_p_162517];
                
                cur_elem_162532 = cur_elem_f_res_162540;
            }
            
            bool cond_162541 = sle64(zgze_rhs_153533, eta_p_162517);
            int32_t next_elem_162542;
            
            if (cond_162541) {
                bool x_162717 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162718 = slt64(zgze_rhs_153533, dz2081U_145287);
                bool bounds_check_162719 = x_162717 && y_162718;
                bool index_certs_162720;
                
                if (!bounds_check_162719) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:57:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_t_res_162721 = ((int32_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162542 = next_elem_t_res_162721;
            } else {
                int64_t tmp_162549 = add64((int64_t) 1, eta_p_162517);
                bool x_162550 = sle64((int64_t) 0, tmp_162549);
                bool y_162551 = slt64(tmp_162549, dz2081U_145287);
                bool bounds_check_162552 = x_162550 && y_162551;
                bool index_certs_162553;
                
                if (!bounds_check_162552) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162549, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:57:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_f_res_162554 = ((int32_t *) ks_mem_171819.mem)[tmp_162549];
                
                next_elem_162542 = next_elem_f_res_162554;
            }
            
            int64_t defunc_0_f_res_162559;
            
            if (cond_162531) {
                defunc_0_f_res_162559 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162560 = eta_p_162518 == cur_elem_162532;
                bool cond_162561 = eta_p_162517 == (int64_t) 0;
                bool defunc_0_gt_res_162562 = slt32(prev_elem_162521, eta_p_162518);
                bool x_162563 = !cond_162561;
                bool y_162564 = defunc_0_gt_res_162562 && x_162563;
                bool cond_t_res_162565 = cond_162561 || y_162564;
                bool x_162566 = defunc_0_eq_res_162560 && cond_t_res_162565;
                int64_t defunc_0_f_res_f_res_162567;
                
                if (x_162566) {
                    defunc_0_f_res_f_res_162567 = eta_p_162517;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162568;
                    
                    if (defunc_0_eq_res_162560) {
                        int64_t max_arg1_162722 = sub64(eta_p_162517, this_step_153540);
                        int64_t max_res_162723 = smax64((int64_t) 0, max_arg1_162722);
                        
                        defunc_0_f_res_f_res_f_res_162568 = max_res_162723;
                    } else {
                        bool defunc_0_gt_res_162571 = slt32(cur_elem_162532, eta_p_162518);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162572;
                        
                        if (defunc_0_gt_res_162571) {
                            bool cond_162725 = eta_p_162517 == zgze_rhs_153533;
                            bool defunc_0_gt_res_162726 = slt32(eta_p_162518, next_elem_162542);
                            bool x_162727 = !cond_162725;
                            bool y_162728 = defunc_0_gt_res_162726 && x_162727;
                            bool cond_162729 = cond_162725 || y_162728;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                            
                            if (cond_162729) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162731 = add64(this_step_153540, eta_p_162517);
                                int64_t min_res_162732 = smin64(zgze_rhs_153533, min_arg1_162731);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = min_res_162732;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                            
                            if (cond_t_res_162565) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162583 = sub64(eta_p_162517, this_step_153540);
                                int64_t max_res_162584 = smax64((int64_t) 0, max_arg1_162583);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = max_res_162584;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                        }
                        defunc_0_f_res_f_res_f_res_162568 = defunc_0_f_res_f_res_f_res_f_res_162572;
                    }
                    defunc_0_f_res_f_res_162567 = defunc_0_f_res_f_res_f_res_162568;
                }
                defunc_0_f_res_162559 = defunc_0_f_res_f_res_162567;
            }
            ((int64_t *) mem_171826.mem)[i_171547] = defunc_0_f_res_162559;
        }
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171826, "mem_171826") != 0)
            return 1;
        
        int64_t last_step_tmp_172505 = this_step_153540;
        
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        last_step_153538 = last_step_tmp_172505;
    }
    if (memblock_set(ctx, &ext_mem_171835, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    bsearch_first_153535 = last_step_153538;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    
    int64_t bsearch_last_153614;
    int64_t last_step_153617;
    
    if (memblock_set(ctx, &mem_param_171838, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    last_step_153617 = dz2081U_145287;
    for (int64_t i_153615 = 0; i_153615 < num_iter_153531; i_153615++) {
        int64_t zs_lhs_153618 = add64((int64_t) 1, last_step_153617);
        int64_t max_arg1_153619 = sdiv64(zs_lhs_153618, (int64_t) 2);
        int64_t max_res_153620 = smax64((int64_t) 1, max_arg1_153619);
        
        if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < dz2080U_145286; i_171551++) {
            int64_t eta_p_162634 = ((int64_t *) mem_param_171838.mem)[i_171551];
            int32_t eta_p_162635 = ((int32_t *) k_ids_mem_171818.mem)[i_171551];
            bool cond_162637 = slt64(eta_p_162634, (int64_t) 0);
            int32_t cur_elem_162638;
            
            if (cond_162637) {
                bool y_162734 = slt64((int64_t) 0, dz2081U_145287);
                bool index_certs_162735;
                
                if (!y_162734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:81:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_t_res_162736 = ((int32_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162638 = cur_elem_t_res_162736;
            } else {
                bool x_162642 = sle64((int64_t) 0, eta_p_162634);
                bool y_162643 = slt64(eta_p_162634, dz2081U_145287);
                bool bounds_check_162644 = x_162642 && y_162643;
                bool index_certs_162645;
                
                if (!bounds_check_162644) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162634, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:81:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t cur_elem_f_res_162646 = ((int32_t *) ks_mem_171819.mem)[eta_p_162634];
                
                cur_elem_162638 = cur_elem_f_res_162646;
            }
            
            bool cond_162647 = sle64(zgze_rhs_153533, eta_p_162634);
            int32_t next_elem_162648;
            
            if (cond_162647) {
                bool x_162738 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162739 = slt64(zgze_rhs_153533, dz2081U_145287);
                bool bounds_check_162740 = x_162738 && y_162739;
                bool index_certs_162741;
                
                if (!bounds_check_162740) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:82:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_t_res_162742 = ((int32_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162648 = next_elem_t_res_162742;
            } else {
                int64_t tmp_162655 = add64((int64_t) 1, eta_p_162634);
                bool x_162656 = sle64((int64_t) 0, tmp_162655);
                bool y_162657 = slt64(tmp_162655, dz2081U_145287);
                bool bounds_check_162658 = x_162656 && y_162657;
                bool index_certs_162659;
                
                if (!bounds_check_162658) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162655, "] out of bounds for array of shape [", (long long) dz2081U_145287, "].", "-> #0  ft_SortGroupBy.fut:82:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:299:73-76\n   #4  ftRelational.fut:297:5-300:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t next_elem_f_res_162660 = ((int32_t *) ks_mem_171819.mem)[tmp_162655];
                
                next_elem_162648 = next_elem_f_res_162660;
            }
            
            int64_t defunc_0_f_res_162664;
            
            if (cond_162637) {
                defunc_0_f_res_162664 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162665 = eta_p_162635 == cur_elem_162638;
                bool cond_162667 = eta_p_162634 == zgze_rhs_153533;
                bool defunc_0_gt_res_162668 = slt32(eta_p_162635, next_elem_162648);
                bool x_162669 = !cond_162667;
                bool y_162670 = defunc_0_gt_res_162668 && x_162669;
                bool cond_t_res_162671 = cond_162667 || y_162670;
                bool x_162672 = defunc_0_eq_res_162665 && cond_t_res_162671;
                int64_t defunc_0_f_res_f_res_162673;
                
                if (x_162672) {
                    defunc_0_f_res_f_res_162673 = eta_p_162634;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162674;
                    
                    if (defunc_0_eq_res_162665) {
                        int64_t min_arg1_162743 = add64(max_res_153620, eta_p_162634);
                        int64_t min_res_162744 = smin64(zgze_rhs_153533, min_arg1_162743);
                        
                        defunc_0_f_res_f_res_f_res_162674 = min_res_162744;
                    } else {
                        bool defunc_0_gt_res_162677 = slt32(cur_elem_162638, eta_p_162635);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162678;
                        
                        if (defunc_0_gt_res_162677) {
                            int64_t min_arg1_162745 = add64(max_res_153620, eta_p_162634);
                            int64_t min_res_162746 = smin64(zgze_rhs_153533, min_arg1_162745);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = min_res_162746;
                        } else {
                            int64_t max_arg1_162681 = sub64(eta_p_162634, max_res_153620);
                            int64_t max_res_162682 = smax64((int64_t) 0, max_arg1_162681);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = max_res_162682;
                        }
                        defunc_0_f_res_f_res_f_res_162674 = defunc_0_f_res_f_res_f_res_f_res_162678;
                    }
                    defunc_0_f_res_f_res_162673 = defunc_0_f_res_f_res_f_res_162674;
                }
                defunc_0_f_res_162664 = defunc_0_f_res_f_res_162673;
            }
            ((int64_t *) mem_171840.mem)[i_171551] = defunc_0_f_res_162664;
        }
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171840, "mem_171840") != 0)
            return 1;
        
        int64_t last_step_tmp_172509 = max_res_153620;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        last_step_153617 = last_step_tmp_172509;
    }
    if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
        return 1;
    bsearch_last_153614 = last_step_153617;
    if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < dz2080U_145286; i_171555++) {
        int64_t eta_p_153674 = ((int64_t *) ext_mem_171835.mem)[i_171555];
        int64_t eta_p_153675 = ((int64_t *) ext_mem_171849.mem)[i_171555];
        bool cond_153676 = slt64(eta_p_153674, (int64_t) 0);
        int64_t lifted_lambda_res_153677;
        
        if (cond_153676) {
            lifted_lambda_res_153677 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153678 = sub64(eta_p_153675, eta_p_153674);
            int64_t lifted_lambda_res_f_res_153679 = add64((int64_t) 1, zp_lhs_153678);
            
            lifted_lambda_res_153677 = lifted_lambda_res_f_res_153679;
        }
        ((int64_t *) mem_171851.mem)[i_171555] = lifted_lambda_res_153677;
    }
    if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171851, "mem_171851") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173113, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173114, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171826, "mem_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171835, "ext_mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_173115, struct memblock *mem_out_p_173116, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_146076, int64_t dz2081U_146077)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171826;
    
    mem_171826.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171835;
    
    ext_mem_171835.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * dz2080U_146076;
    double i64_res_153527 = sitofp_i64_f64(dz2081U_146077);
    double log2_res_153528 = futrts_log2_64(i64_res_153527);
    double ceil_res_153529 = futrts_ceil64(log2_res_153528);
    int64_t f64_res_153530 = fptosi_f64_i64(ceil_res_153529);
    int64_t num_iter_153531 = add64((int64_t) 1, f64_res_153530);
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < dz2080U_146076; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_153533 = sub64(dz2081U_146077, (int64_t) 1);
    int64_t bsearch_first_153535;
    int64_t last_step_153538;
    
    if (memblock_set(ctx, &mem_param_171824, &mem_171821, "mem_171821") != 0)
        return 1;
    last_step_153538 = dz2081U_146077;
    for (int64_t i_153536 = 0; i_153536 < num_iter_153531; i_153536++) {
        int64_t zs_lhs_153539 = add64((int64_t) 1, last_step_153538);
        int64_t this_step_153540 = sdiv64(zs_lhs_153539, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171826, bytes_171820, "mem_171826")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < dz2080U_146076; i_171547++) {
            int64_t eta_p_162517 = ((int64_t *) mem_param_171824.mem)[i_171547];
            int64_t eta_p_162518 = ((int64_t *) k_ids_mem_171818.mem)[i_171547];
            bool cond_162520 = sle64(eta_p_162517, (int64_t) 0);
            int64_t prev_elem_162521;
            
            if (cond_162520) {
                bool y_162710 = slt64((int64_t) 0, dz2081U_146077);
                bool index_certs_162711;
                
                if (!y_162710) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:55:78-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t prev_elem_t_res_162712 = ((int64_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                prev_elem_162521 = prev_elem_t_res_162712;
            } else {
                int64_t tmp_162525 = sub64(eta_p_162517, (int64_t) 1);
                bool x_162526 = sle64((int64_t) 0, tmp_162525);
                bool y_162527 = slt64(tmp_162525, dz2081U_146077);
                bool bounds_check_162528 = x_162526 && y_162527;
                bool index_certs_162529;
                
                if (!bounds_check_162528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162525, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:55:96-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t prev_elem_f_res_162530 = ((int64_t *) ks_mem_171819.mem)[tmp_162525];
                
                prev_elem_162521 = prev_elem_f_res_162530;
            }
            
            bool cond_162531 = slt64(eta_p_162517, (int64_t) 0);
            int64_t cur_elem_162532;
            
            if (cond_162531) {
                bool y_162713 = slt64((int64_t) 0, dz2081U_146077);
                bool index_certs_162714;
                
                if (!y_162713) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:56:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_t_res_162715 = ((int64_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162532 = cur_elem_t_res_162715;
            } else {
                bool x_162536 = sle64((int64_t) 0, eta_p_162517);
                bool y_162537 = slt64(eta_p_162517, dz2081U_146077);
                bool bounds_check_162538 = x_162536 && y_162537;
                bool index_certs_162539;
                
                if (!bounds_check_162538) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162517, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:56:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_f_res_162540 = ((int64_t *) ks_mem_171819.mem)[eta_p_162517];
                
                cur_elem_162532 = cur_elem_f_res_162540;
            }
            
            bool cond_162541 = sle64(zgze_rhs_153533, eta_p_162517);
            int64_t next_elem_162542;
            
            if (cond_162541) {
                bool x_162717 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162718 = slt64(zgze_rhs_153533, dz2081U_146077);
                bool bounds_check_162719 = x_162717 && y_162718;
                bool index_certs_162720;
                
                if (!bounds_check_162719) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:57:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_t_res_162721 = ((int64_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162542 = next_elem_t_res_162721;
            } else {
                int64_t tmp_162549 = add64((int64_t) 1, eta_p_162517);
                bool x_162550 = sle64((int64_t) 0, tmp_162549);
                bool y_162551 = slt64(tmp_162549, dz2081U_146077);
                bool bounds_check_162552 = x_162550 && y_162551;
                bool index_certs_162553;
                
                if (!bounds_check_162552) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162549, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:57:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_f_res_162554 = ((int64_t *) ks_mem_171819.mem)[tmp_162549];
                
                next_elem_162542 = next_elem_f_res_162554;
            }
            
            int64_t defunc_0_f_res_162559;
            
            if (cond_162531) {
                defunc_0_f_res_162559 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162560 = eta_p_162518 == cur_elem_162532;
                bool cond_162561 = eta_p_162517 == (int64_t) 0;
                bool defunc_0_gt_res_162562 = slt64(prev_elem_162521, eta_p_162518);
                bool x_162563 = !cond_162561;
                bool y_162564 = defunc_0_gt_res_162562 && x_162563;
                bool cond_t_res_162565 = cond_162561 || y_162564;
                bool x_162566 = defunc_0_eq_res_162560 && cond_t_res_162565;
                int64_t defunc_0_f_res_f_res_162567;
                
                if (x_162566) {
                    defunc_0_f_res_f_res_162567 = eta_p_162517;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162568;
                    
                    if (defunc_0_eq_res_162560) {
                        int64_t max_arg1_162722 = sub64(eta_p_162517, this_step_153540);
                        int64_t max_res_162723 = smax64((int64_t) 0, max_arg1_162722);
                        
                        defunc_0_f_res_f_res_f_res_162568 = max_res_162723;
                    } else {
                        bool defunc_0_gt_res_162571 = slt64(cur_elem_162532, eta_p_162518);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162572;
                        
                        if (defunc_0_gt_res_162571) {
                            bool cond_162725 = eta_p_162517 == zgze_rhs_153533;
                            bool defunc_0_gt_res_162726 = slt64(eta_p_162518, next_elem_162542);
                            bool x_162727 = !cond_162725;
                            bool y_162728 = defunc_0_gt_res_162726 && x_162727;
                            bool cond_162729 = cond_162725 || y_162728;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                            
                            if (cond_162729) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162731 = add64(this_step_153540, eta_p_162517);
                                int64_t min_res_162732 = smin64(zgze_rhs_153533, min_arg1_162731);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = min_res_162732;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                            
                            if (cond_t_res_162565) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162583 = sub64(eta_p_162517, this_step_153540);
                                int64_t max_res_162584 = smax64((int64_t) 0, max_arg1_162583);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = max_res_162584;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                        }
                        defunc_0_f_res_f_res_f_res_162568 = defunc_0_f_res_f_res_f_res_f_res_162572;
                    }
                    defunc_0_f_res_f_res_162567 = defunc_0_f_res_f_res_f_res_162568;
                }
                defunc_0_f_res_162559 = defunc_0_f_res_f_res_162567;
            }
            ((int64_t *) mem_171826.mem)[i_171547] = defunc_0_f_res_162559;
        }
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171826, "mem_171826") != 0)
            return 1;
        
        int64_t last_step_tmp_172505 = this_step_153540;
        
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        last_step_153538 = last_step_tmp_172505;
    }
    if (memblock_set(ctx, &ext_mem_171835, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    bsearch_first_153535 = last_step_153538;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    
    int64_t bsearch_last_153614;
    int64_t last_step_153617;
    
    if (memblock_set(ctx, &mem_param_171838, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    last_step_153617 = dz2081U_146077;
    for (int64_t i_153615 = 0; i_153615 < num_iter_153531; i_153615++) {
        int64_t zs_lhs_153618 = add64((int64_t) 1, last_step_153617);
        int64_t max_arg1_153619 = sdiv64(zs_lhs_153618, (int64_t) 2);
        int64_t max_res_153620 = smax64((int64_t) 1, max_arg1_153619);
        
        if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < dz2080U_146076; i_171551++) {
            int64_t eta_p_162634 = ((int64_t *) mem_param_171838.mem)[i_171551];
            int64_t eta_p_162635 = ((int64_t *) k_ids_mem_171818.mem)[i_171551];
            bool cond_162637 = slt64(eta_p_162634, (int64_t) 0);
            int64_t cur_elem_162638;
            
            if (cond_162637) {
                bool y_162734 = slt64((int64_t) 0, dz2081U_146077);
                bool index_certs_162735;
                
                if (!y_162734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:81:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_t_res_162736 = ((int64_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162638 = cur_elem_t_res_162736;
            } else {
                bool x_162642 = sle64((int64_t) 0, eta_p_162634);
                bool y_162643 = slt64(eta_p_162634, dz2081U_146077);
                bool bounds_check_162644 = x_162642 && y_162643;
                bool index_certs_162645;
                
                if (!bounds_check_162644) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162634, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:81:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t cur_elem_f_res_162646 = ((int64_t *) ks_mem_171819.mem)[eta_p_162634];
                
                cur_elem_162638 = cur_elem_f_res_162646;
            }
            
            bool cond_162647 = sle64(zgze_rhs_153533, eta_p_162634);
            int64_t next_elem_162648;
            
            if (cond_162647) {
                bool x_162738 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162739 = slt64(zgze_rhs_153533, dz2081U_146077);
                bool bounds_check_162740 = x_162738 && y_162739;
                bool index_certs_162741;
                
                if (!bounds_check_162740) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:82:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_t_res_162742 = ((int64_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162648 = next_elem_t_res_162742;
            } else {
                int64_t tmp_162655 = add64((int64_t) 1, eta_p_162634);
                bool x_162656 = sle64((int64_t) 0, tmp_162655);
                bool y_162657 = slt64(tmp_162655, dz2081U_146077);
                bool bounds_check_162658 = x_162656 && y_162657;
                bool index_certs_162659;
                
                if (!bounds_check_162658) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162655, "] out of bounds for array of shape [", (long long) dz2081U_146077, "].", "-> #0  ft_SortGroupBy.fut:82:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:303:73-76\n   #4  ftRelational.fut:301:5-304:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t next_elem_f_res_162660 = ((int64_t *) ks_mem_171819.mem)[tmp_162655];
                
                next_elem_162648 = next_elem_f_res_162660;
            }
            
            int64_t defunc_0_f_res_162664;
            
            if (cond_162637) {
                defunc_0_f_res_162664 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162665 = eta_p_162635 == cur_elem_162638;
                bool cond_162667 = eta_p_162634 == zgze_rhs_153533;
                bool defunc_0_gt_res_162668 = slt64(eta_p_162635, next_elem_162648);
                bool x_162669 = !cond_162667;
                bool y_162670 = defunc_0_gt_res_162668 && x_162669;
                bool cond_t_res_162671 = cond_162667 || y_162670;
                bool x_162672 = defunc_0_eq_res_162665 && cond_t_res_162671;
                int64_t defunc_0_f_res_f_res_162673;
                
                if (x_162672) {
                    defunc_0_f_res_f_res_162673 = eta_p_162634;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162674;
                    
                    if (defunc_0_eq_res_162665) {
                        int64_t min_arg1_162743 = add64(max_res_153620, eta_p_162634);
                        int64_t min_res_162744 = smin64(zgze_rhs_153533, min_arg1_162743);
                        
                        defunc_0_f_res_f_res_f_res_162674 = min_res_162744;
                    } else {
                        bool defunc_0_gt_res_162677 = slt64(cur_elem_162638, eta_p_162635);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162678;
                        
                        if (defunc_0_gt_res_162677) {
                            int64_t min_arg1_162745 = add64(max_res_153620, eta_p_162634);
                            int64_t min_res_162746 = smin64(zgze_rhs_153533, min_arg1_162745);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = min_res_162746;
                        } else {
                            int64_t max_arg1_162681 = sub64(eta_p_162634, max_res_153620);
                            int64_t max_res_162682 = smax64((int64_t) 0, max_arg1_162681);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = max_res_162682;
                        }
                        defunc_0_f_res_f_res_f_res_162674 = defunc_0_f_res_f_res_f_res_f_res_162678;
                    }
                    defunc_0_f_res_f_res_162673 = defunc_0_f_res_f_res_f_res_162674;
                }
                defunc_0_f_res_162664 = defunc_0_f_res_f_res_162673;
            }
            ((int64_t *) mem_171840.mem)[i_171551] = defunc_0_f_res_162664;
        }
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171840, "mem_171840") != 0)
            return 1;
        
        int64_t last_step_tmp_172509 = max_res_153620;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        last_step_153617 = last_step_tmp_172509;
    }
    if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
        return 1;
    bsearch_last_153614 = last_step_153617;
    if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < dz2080U_146076; i_171555++) {
        int64_t eta_p_153674 = ((int64_t *) ext_mem_171835.mem)[i_171555];
        int64_t eta_p_153675 = ((int64_t *) ext_mem_171849.mem)[i_171555];
        bool cond_153676 = slt64(eta_p_153674, (int64_t) 0);
        int64_t lifted_lambda_res_153677;
        
        if (cond_153676) {
            lifted_lambda_res_153677 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153678 = sub64(eta_p_153675, eta_p_153674);
            int64_t lifted_lambda_res_f_res_153679 = add64((int64_t) 1, zp_lhs_153678);
            
            lifted_lambda_res_153677 = lifted_lambda_res_f_res_153679;
        }
        ((int64_t *) mem_171851.mem)[i_171555] = lifted_lambda_res_153677;
    }
    if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171851, "mem_171851") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173115, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173116, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171826, "mem_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171835, "ext_mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_173117, struct memblock *mem_out_p_173118, struct memblock k_ids_mem_171818, struct memblock ks_mem_171819, int64_t dz2080U_144496, int64_t dz2081U_144497)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171851;
    
    mem_171851.references = NULL;
    
    struct memblock mem_param_tmp_172507;
    
    mem_param_tmp_172507.references = NULL;
    
    struct memblock mem_171840;
    
    mem_171840.references = NULL;
    
    struct memblock mem_param_171838;
    
    mem_param_171838.references = NULL;
    
    struct memblock ext_mem_171849;
    
    ext_mem_171849.references = NULL;
    
    struct memblock mem_param_tmp_172503;
    
    mem_param_tmp_172503.references = NULL;
    
    struct memblock mem_171826;
    
    mem_171826.references = NULL;
    
    struct memblock mem_param_171824;
    
    mem_param_171824.references = NULL;
    
    struct memblock ext_mem_171835;
    
    ext_mem_171835.references = NULL;
    
    struct memblock mem_171821;
    
    mem_171821.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t bytes_171820 = (int64_t) 8 * dz2080U_144496;
    double i64_res_153527 = sitofp_i64_f64(dz2081U_144497);
    double log2_res_153528 = futrts_log2_64(i64_res_153527);
    double ceil_res_153529 = futrts_ceil64(log2_res_153528);
    int64_t f64_res_153530 = fptosi_f64_i64(ceil_res_153529);
    int64_t num_iter_153531 = add64((int64_t) 1, f64_res_153530);
    
    if (memblock_alloc(ctx, &mem_171821, bytes_171820, "mem_171821")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172502 = 0; nest_i_172502 < dz2080U_144496; nest_i_172502++) {
        ((int64_t *) mem_171821.mem)[nest_i_172502] = (int64_t) 0;
    }
    
    int64_t zgze_rhs_153533 = sub64(dz2081U_144497, (int64_t) 1);
    int64_t bsearch_first_153535;
    int64_t last_step_153538;
    
    if (memblock_set(ctx, &mem_param_171824, &mem_171821, "mem_171821") != 0)
        return 1;
    last_step_153538 = dz2081U_144497;
    for (int64_t i_153536 = 0; i_153536 < num_iter_153531; i_153536++) {
        int64_t zs_lhs_153539 = add64((int64_t) 1, last_step_153538);
        int64_t this_step_153540 = sdiv64(zs_lhs_153539, (int64_t) 2);
        
        if (memblock_alloc(ctx, &mem_171826, bytes_171820, "mem_171826")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < dz2080U_144496; i_171547++) {
            int64_t eta_p_162517 = ((int64_t *) mem_param_171824.mem)[i_171547];
            int16_t eta_p_162518 = ((int16_t *) k_ids_mem_171818.mem)[i_171547];
            bool cond_162520 = sle64(eta_p_162517, (int64_t) 0);
            int16_t prev_elem_162521;
            
            if (cond_162520) {
                bool y_162710 = slt64((int64_t) 0, dz2081U_144497);
                bool index_certs_162711;
                
                if (!y_162710) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:55:78-90\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t prev_elem_t_res_162712 = ((int16_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                prev_elem_162521 = prev_elem_t_res_162712;
            } else {
                int64_t tmp_162525 = sub64(eta_p_162517, (int64_t) 1);
                bool x_162526 = sle64((int64_t) 0, tmp_162525);
                bool y_162527 = slt64(tmp_162525, dz2081U_144497);
                bool bounds_check_162528 = x_162526 && y_162527;
                bool index_certs_162529;
                
                if (!bounds_check_162528) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162525, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:55:96-110\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t prev_elem_f_res_162530 = ((int16_t *) ks_mem_171819.mem)[tmp_162525];
                
                prev_elem_162521 = prev_elem_f_res_162530;
            }
            
            bool cond_162531 = slt64(eta_p_162517, (int64_t) 0);
            int16_t cur_elem_162532;
            
            if (cond_162531) {
                bool y_162713 = slt64((int64_t) 0, dz2081U_144497);
                bool index_certs_162714;
                
                if (!y_162713) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:56:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_t_res_162715 = ((int16_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162532 = cur_elem_t_res_162715;
            } else {
                bool x_162536 = sle64((int64_t) 0, eta_p_162517);
                bool y_162537 = slt64(eta_p_162517, dz2081U_144497);
                bool bounds_check_162538 = x_162536 && y_162537;
                bool index_certs_162539;
                
                if (!bounds_check_162538) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162517, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:56:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_f_res_162540 = ((int16_t *) ks_mem_171819.mem)[eta_p_162517];
                
                cur_elem_162532 = cur_elem_f_res_162540;
            }
            
            bool cond_162541 = sle64(zgze_rhs_153533, eta_p_162517);
            int16_t next_elem_162542;
            
            if (cond_162541) {
                bool x_162717 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162718 = slt64(zgze_rhs_153533, dz2081U_144497);
                bool bounds_check_162719 = x_162717 && y_162718;
                bool index_certs_162720;
                
                if (!bounds_check_162719) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:57:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_t_res_162721 = ((int16_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162542 = next_elem_t_res_162721;
            } else {
                int64_t tmp_162549 = add64((int64_t) 1, eta_p_162517);
                bool x_162550 = sle64((int64_t) 0, tmp_162549);
                bool y_162551 = slt64(tmp_162549, dz2081U_144497);
                bool bounds_check_162552 = x_162550 && y_162551;
                bool index_certs_162553;
                
                if (!bounds_check_162552) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162549, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:57:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:54:44-59:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_f_res_162554 = ((int16_t *) ks_mem_171819.mem)[tmp_162549];
                
                next_elem_162542 = next_elem_f_res_162554;
            }
            
            int64_t defunc_0_f_res_162559;
            
            if (cond_162531) {
                defunc_0_f_res_162559 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162560 = eta_p_162518 == cur_elem_162532;
                bool cond_162561 = eta_p_162517 == (int64_t) 0;
                bool defunc_0_gt_res_162562 = slt16(prev_elem_162521, eta_p_162518);
                bool x_162563 = !cond_162561;
                bool y_162564 = defunc_0_gt_res_162562 && x_162563;
                bool cond_t_res_162565 = cond_162561 || y_162564;
                bool x_162566 = defunc_0_eq_res_162560 && cond_t_res_162565;
                int64_t defunc_0_f_res_f_res_162567;
                
                if (x_162566) {
                    defunc_0_f_res_f_res_162567 = eta_p_162517;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162568;
                    
                    if (defunc_0_eq_res_162560) {
                        int64_t max_arg1_162722 = sub64(eta_p_162517, this_step_153540);
                        int64_t max_res_162723 = smax64((int64_t) 0, max_arg1_162722);
                        
                        defunc_0_f_res_f_res_f_res_162568 = max_res_162723;
                    } else {
                        bool defunc_0_gt_res_162571 = slt16(cur_elem_162532, eta_p_162518);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162572;
                        
                        if (defunc_0_gt_res_162571) {
                            bool cond_162725 = eta_p_162517 == zgze_rhs_153533;
                            bool defunc_0_gt_res_162726 = slt16(eta_p_162518, next_elem_162542);
                            bool x_162727 = !cond_162725;
                            bool y_162728 = defunc_0_gt_res_162726 && x_162727;
                            bool cond_162729 = cond_162725 || y_162728;
                            int64_t defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                            
                            if (cond_162729) {
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = (int64_t) -1;
                            } else {
                                int64_t min_arg1_162731 = add64(this_step_153540, eta_p_162517);
                                int64_t min_res_162732 = smin64(zgze_rhs_153533, min_arg1_162731);
                                
                                defunc_0_f_res_f_res_f_res_f_res_t_res_162730 = min_res_162732;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_t_res_162730;
                        } else {
                            int64_t defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                            
                            if (cond_t_res_162565) {
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = (int64_t) -1;
                            } else {
                                int64_t max_arg1_162583 = sub64(eta_p_162517, this_step_153540);
                                int64_t max_res_162584 = smax64((int64_t) 0, max_arg1_162583);
                                
                                defunc_0_f_res_f_res_f_res_f_res_f_res_162582 = max_res_162584;
                            }
                            defunc_0_f_res_f_res_f_res_f_res_162572 = defunc_0_f_res_f_res_f_res_f_res_f_res_162582;
                        }
                        defunc_0_f_res_f_res_f_res_162568 = defunc_0_f_res_f_res_f_res_f_res_162572;
                    }
                    defunc_0_f_res_f_res_162567 = defunc_0_f_res_f_res_f_res_162568;
                }
                defunc_0_f_res_162559 = defunc_0_f_res_f_res_162567;
            }
            ((int64_t *) mem_171826.mem)[i_171547] = defunc_0_f_res_162559;
        }
        if (memblock_set(ctx, &mem_param_tmp_172503, &mem_171826, "mem_171826") != 0)
            return 1;
        
        int64_t last_step_tmp_172505 = this_step_153540;
        
        if (memblock_set(ctx, &mem_param_171824, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        last_step_153538 = last_step_tmp_172505;
    }
    if (memblock_set(ctx, &ext_mem_171835, &mem_param_171824, "mem_param_171824") != 0)
        return 1;
    bsearch_first_153535 = last_step_153538;
    if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
        return 1;
    
    int64_t bsearch_last_153614;
    int64_t last_step_153617;
    
    if (memblock_set(ctx, &mem_param_171838, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    last_step_153617 = dz2081U_144497;
    for (int64_t i_153615 = 0; i_153615 < num_iter_153531; i_153615++) {
        int64_t zs_lhs_153618 = add64((int64_t) 1, last_step_153617);
        int64_t max_arg1_153619 = sdiv64(zs_lhs_153618, (int64_t) 2);
        int64_t max_res_153620 = smax64((int64_t) 1, max_arg1_153619);
        
        if (memblock_alloc(ctx, &mem_171840, bytes_171820, "mem_171840")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171551 = 0; i_171551 < dz2080U_144496; i_171551++) {
            int64_t eta_p_162634 = ((int64_t *) mem_param_171838.mem)[i_171551];
            int16_t eta_p_162635 = ((int16_t *) k_ids_mem_171818.mem)[i_171551];
            bool cond_162637 = slt64(eta_p_162634, (int64_t) 0);
            int16_t cur_elem_162638;
            
            if (cond_162637) {
                bool y_162734 = slt64((int64_t) 0, dz2081U_144497);
                bool index_certs_162735;
                
                if (!y_162734) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) (int64_t) 0, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:81:76-88\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_t_res_162736 = ((int16_t *) ks_mem_171819.mem)[(int64_t) 0];
                
                cur_elem_162638 = cur_elem_t_res_162736;
            } else {
                bool x_162642 = sle64((int64_t) 0, eta_p_162634);
                bool y_162643 = slt64(eta_p_162634, dz2081U_144497);
                bool bounds_check_162644 = x_162642 && y_162643;
                bool index_certs_162645;
                
                if (!bounds_check_162644) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_162634, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:81:94-106\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t cur_elem_f_res_162646 = ((int16_t *) ks_mem_171819.mem)[eta_p_162634];
                
                cur_elem_162638 = cur_elem_f_res_162646;
            }
            
            bool cond_162647 = sle64(zgze_rhs_153533, eta_p_162634);
            int16_t next_elem_162648;
            
            if (cond_162647) {
                bool x_162738 = sle64((int64_t) 0, zgze_rhs_153533);
                bool y_162739 = slt64(zgze_rhs_153533, dz2081U_144497);
                bool bounds_check_162740 = x_162738 && y_162739;
                bool index_certs_162741;
                
                if (!bounds_check_162740) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) zgze_rhs_153533, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:82:82-96\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_t_res_162742 = ((int16_t *) ks_mem_171819.mem)[zgze_rhs_153533];
                
                next_elem_162648 = next_elem_t_res_162742;
            } else {
                int64_t tmp_162655 = add64((int64_t) 1, eta_p_162634);
                bool x_162656 = sle64((int64_t) 0, tmp_162655);
                bool y_162657 = slt64(tmp_162655, dz2081U_144497);
                bool bounds_check_162658 = x_162656 && y_162657;
                bool index_certs_162659;
                
                if (!bounds_check_162658) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_162655, "] out of bounds for array of shape [", (long long) dz2081U_144497, "].", "-> #0  ft_SortGroupBy.fut:82:102-116\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:80:44-84:42\n   #3  ftRelational.fut:295:73-76\n   #4  ftRelational.fut:293:5-296:49\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t next_elem_f_res_162660 = ((int16_t *) ks_mem_171819.mem)[tmp_162655];
                
                next_elem_162648 = next_elem_f_res_162660;
            }
            
            int64_t defunc_0_f_res_162664;
            
            if (cond_162637) {
                defunc_0_f_res_162664 = (int64_t) -1;
            } else {
                bool defunc_0_eq_res_162665 = eta_p_162635 == cur_elem_162638;
                bool cond_162667 = eta_p_162634 == zgze_rhs_153533;
                bool defunc_0_gt_res_162668 = slt16(eta_p_162635, next_elem_162648);
                bool x_162669 = !cond_162667;
                bool y_162670 = defunc_0_gt_res_162668 && x_162669;
                bool cond_t_res_162671 = cond_162667 || y_162670;
                bool x_162672 = defunc_0_eq_res_162665 && cond_t_res_162671;
                int64_t defunc_0_f_res_f_res_162673;
                
                if (x_162672) {
                    defunc_0_f_res_f_res_162673 = eta_p_162634;
                } else {
                    int64_t defunc_0_f_res_f_res_f_res_162674;
                    
                    if (defunc_0_eq_res_162665) {
                        int64_t min_arg1_162743 = add64(max_res_153620, eta_p_162634);
                        int64_t min_res_162744 = smin64(zgze_rhs_153533, min_arg1_162743);
                        
                        defunc_0_f_res_f_res_f_res_162674 = min_res_162744;
                    } else {
                        bool defunc_0_gt_res_162677 = slt16(cur_elem_162638, eta_p_162635);
                        int64_t defunc_0_f_res_f_res_f_res_f_res_162678;
                        
                        if (defunc_0_gt_res_162677) {
                            int64_t min_arg1_162745 = add64(max_res_153620, eta_p_162634);
                            int64_t min_res_162746 = smin64(zgze_rhs_153533, min_arg1_162745);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = min_res_162746;
                        } else {
                            int64_t max_arg1_162681 = sub64(eta_p_162634, max_res_153620);
                            int64_t max_res_162682 = smax64((int64_t) 0, max_arg1_162681);
                            
                            defunc_0_f_res_f_res_f_res_f_res_162678 = max_res_162682;
                        }
                        defunc_0_f_res_f_res_f_res_162674 = defunc_0_f_res_f_res_f_res_f_res_162678;
                    }
                    defunc_0_f_res_f_res_162673 = defunc_0_f_res_f_res_f_res_162674;
                }
                defunc_0_f_res_162664 = defunc_0_f_res_f_res_162673;
            }
            ((int64_t *) mem_171840.mem)[i_171551] = defunc_0_f_res_162664;
        }
        if (memblock_set(ctx, &mem_param_tmp_172507, &mem_171840, "mem_171840") != 0)
            return 1;
        
        int64_t last_step_tmp_172509 = max_res_153620;
        
        if (memblock_set(ctx, &mem_param_171838, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        last_step_153617 = last_step_tmp_172509;
    }
    if (memblock_set(ctx, &ext_mem_171849, &mem_param_171838, "mem_param_171838") != 0)
        return 1;
    bsearch_last_153614 = last_step_153617;
    if (memblock_alloc(ctx, &mem_171851, bytes_171820, "mem_171851")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171555 = 0; i_171555 < dz2080U_144496; i_171555++) {
        int64_t eta_p_153674 = ((int64_t *) ext_mem_171835.mem)[i_171555];
        int64_t eta_p_153675 = ((int64_t *) ext_mem_171849.mem)[i_171555];
        bool cond_153676 = slt64(eta_p_153674, (int64_t) 0);
        int64_t lifted_lambda_res_153677;
        
        if (cond_153676) {
            lifted_lambda_res_153677 = (int64_t) 0;
        } else {
            int64_t zp_lhs_153678 = sub64(eta_p_153675, eta_p_153674);
            int64_t lifted_lambda_res_f_res_153679 = add64((int64_t) 1, zp_lhs_153678);
            
            lifted_lambda_res_153677 = lifted_lambda_res_f_res_153679;
        }
        ((int64_t *) mem_171851.mem)[i_171555] = lifted_lambda_res_153677;
    }
    if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &mem_171851, "mem_171851") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &ext_mem_171835, "ext_mem_171835") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173117, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173118, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171851, "mem_171851") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172507, "mem_param_tmp_172507") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171840, "mem_171840") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171838, "mem_param_171838") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171849, "ext_mem_171849") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_tmp_172503, "mem_param_tmp_172503") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171826, "mem_171826") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171824, "mem_param_171824") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171835, "ext_mem_171835") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171821, "mem_171821") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct memblock *mem_out_p_173119, struct memblock *mem_out_p_173120, int64_t *out_prim_out_173121, struct memblock ks_mem_171818, int64_t dz2080U_149434)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173122 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173123 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock mem_171844;
    
    mem_171844.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t bytes_171819 = (int64_t) 8 * dz2080U_149434;
    
    if (mem_171820_cached_sizze_173122 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173122, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173123 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173123, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171554;
    int64_t defunc_res_162602;
    int64_t scanacc_171547;
    int64_t redout_171549;
    
    scanacc_171547 = (int64_t) 0;
    redout_171549 = (int64_t) 0;
    for (int64_t i_171551 = 0; i_171551 < dz2080U_149434; i_171551++) {
        bool cond_162566 = i_171551 == (int64_t) 0;
        int64_t defunc_0_f_res_162567;
        
        if (cond_162566) {
            defunc_0_f_res_162567 = (int64_t) 0;
        } else {
            int64_t prev_k_162573 = sub64(i_171551, (int64_t) 1);
            bool x_162574 = sle64((int64_t) 0, prev_k_162573);
            bool y_162575 = slt64(prev_k_162573, dz2080U_149434);
            bool bounds_check_162576 = x_162574 && y_162575;
            bool index_certs_162577;
            
            if (!bounds_check_162576) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162573, "] out of bounds for array of shape [", (long long) dz2080U_149434, "].", "-> #0  ft_SortGroupBy.fut:108:46-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:28-113:26\n   #3  ftRelational.fut:332:64-68\n   #4  ftRelational.fut:330:5-333:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            double this_k_162572 = ((double *) ks_mem_171818.mem)[i_171551];
            double prev_k_162578 = ((double *) ks_mem_171818.mem)[prev_k_162573];
            bool defunc_0_eq_res_162579 = this_k_162572 == prev_k_162578;
            int64_t defunc_0_f_res_f_res_162580;
            
            if (defunc_0_eq_res_162579) {
                defunc_0_f_res_f_res_162580 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162580 = i_171551;
            }
            defunc_0_f_res_162567 = defunc_0_f_res_f_res_162580;
        }
        
        bool lifted_lambda_res_162582 = sle64((int64_t) 0, defunc_0_f_res_162567);
        int64_t bool_res_162583 = btoi_bool_i64(lifted_lambda_res_162582);
        int64_t defunc_0_op_res_154532 = add64(bool_res_162583, scanacc_171547);
        int64_t zp_res_154523 = add64(bool_res_162583, redout_171549);
        
        ((int64_t *) mem_171820)[i_171551] = defunc_0_op_res_154532;
        ((int64_t *) mem_171822)[i_171551] = defunc_0_f_res_162567;
        
        int64_t scanacc_tmp_172503 = defunc_0_op_res_154532;
        int64_t redout_tmp_172505 = zp_res_154523;
        
        scanacc_171547 = scanacc_tmp_172503;
        redout_171549 = redout_tmp_172505;
    }
    discard_171554 = scanacc_171547;
    defunc_res_162602 = redout_171549;
    
    int64_t bytes_171835 = (int64_t) 8 * defunc_res_162602;
    
    if (memblock_alloc(ctx, &mem_171836, bytes_171835, "mem_171836")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172507 = 0; nest_i_172507 < defunc_res_162602; nest_i_172507++) {
        ((int64_t *) mem_171836.mem)[nest_i_172507] = (int64_t) -1;
    }
    for (int64_t write_iter_171555 = 0; write_iter_171555 < dz2080U_149434; write_iter_171555++) {
        int64_t write_iv_171558 = ((int64_t *) mem_171822)[write_iter_171555];
        int64_t zv_lhs_162525 = add64((int64_t) -1, write_iter_171555);
        int64_t tmp_162526 = smod64(zv_lhs_162525, dz2080U_149434);
        int64_t lifted_lambda_res_162527 = ((int64_t *) mem_171820)[tmp_162526];
        bool cond_162529 = write_iter_171555 == (int64_t) 0;
        int64_t lifted_lambda_res_162530;
        
        if (cond_162529) {
            lifted_lambda_res_162530 = (int64_t) 0;
        } else {
            lifted_lambda_res_162530 = lifted_lambda_res_162527;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162530) && slt64(lifted_lambda_res_162530, defunc_res_162602)) {
            ((int64_t *) mem_171836.mem)[lifted_lambda_res_162530] = write_iv_171558;
        }
    }
    
    int64_t zeze_rhs_154548 = sub64(defunc_res_162602, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171844, bytes_171835, "mem_171844")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171562 = 0; i_171562 < defunc_res_162602; i_171562++) {
        bool cond_154551 = i_171562 == zeze_rhs_154548;
        int64_t lifted_lambda_res_154552;
        
        if (cond_154551) {
            int64_t zm_rhs_162599 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t lifted_lambda_res_t_res_162600 = sub64(dz2080U_149434, zm_rhs_162599);
            
            lifted_lambda_res_154552 = lifted_lambda_res_t_res_162600;
        } else {
            int64_t next_ind_154564 = add64((int64_t) 1, i_171562);
            bool x_154565 = sle64((int64_t) 0, next_ind_154564);
            bool y_154566 = slt64(next_ind_154564, defunc_res_162602);
            bool bounds_check_154567 = x_154565 && y_154566;
            bool index_certs_154568;
            
            if (!bounds_check_154567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154564, "] out of bounds for array of shape [", (long long) defunc_res_162602, "].", "-> #0  ft_SortGroupBy.fut:121:48-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:332:64-68\n   #3  ftRelational.fut:330:5-333:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154563 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t next_ind_154569 = ((int64_t *) mem_171836.mem)[next_ind_154564];
            int64_t lifted_lambda_res_f_res_154570 = sub64(next_ind_154569, this_ind_154563);
            
            lifted_lambda_res_154552 = lifted_lambda_res_f_res_154570;
        }
        ((int64_t *) mem_171844.mem)[i_171562] = lifted_lambda_res_154552;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171844, "mem_171844") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171836, "mem_171836") != 0)
        return 1;
    prim_out_172502 = defunc_res_162602;
    if (memblock_set(ctx, &*mem_out_p_173119, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173120, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173121 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        if (memblock_unref(ctx, &mem_171844, "mem_171844") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct memblock *mem_out_p_173124, struct memblock *mem_out_p_173125, int64_t *out_prim_out_173126, struct memblock ks_mem_171818, int64_t dz2080U_149086)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173127 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173128 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock mem_171844;
    
    mem_171844.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t bytes_171819 = (int64_t) 8 * dz2080U_149086;
    
    if (mem_171820_cached_sizze_173127 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173127, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173128 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173128, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171554;
    int64_t defunc_res_162602;
    int64_t scanacc_171547;
    int64_t redout_171549;
    
    scanacc_171547 = (int64_t) 0;
    redout_171549 = (int64_t) 0;
    for (int64_t i_171551 = 0; i_171551 < dz2080U_149086; i_171551++) {
        bool cond_162566 = i_171551 == (int64_t) 0;
        int64_t defunc_0_f_res_162567;
        
        if (cond_162566) {
            defunc_0_f_res_162567 = (int64_t) 0;
        } else {
            int64_t prev_k_162573 = sub64(i_171551, (int64_t) 1);
            bool x_162574 = sle64((int64_t) 0, prev_k_162573);
            bool y_162575 = slt64(prev_k_162573, dz2080U_149086);
            bool bounds_check_162576 = x_162574 && y_162575;
            bool index_certs_162577;
            
            if (!bounds_check_162576) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162573, "] out of bounds for array of shape [", (long long) dz2080U_149086, "].", "-> #0  ft_SortGroupBy.fut:108:46-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:28-113:26\n   #3  ftRelational.fut:328:64-68\n   #4  ftRelational.fut:326:5-329:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            float this_k_162572 = ((float *) ks_mem_171818.mem)[i_171551];
            float prev_k_162578 = ((float *) ks_mem_171818.mem)[prev_k_162573];
            bool defunc_0_eq_res_162579 = this_k_162572 == prev_k_162578;
            int64_t defunc_0_f_res_f_res_162580;
            
            if (defunc_0_eq_res_162579) {
                defunc_0_f_res_f_res_162580 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162580 = i_171551;
            }
            defunc_0_f_res_162567 = defunc_0_f_res_f_res_162580;
        }
        
        bool lifted_lambda_res_162582 = sle64((int64_t) 0, defunc_0_f_res_162567);
        int64_t bool_res_162583 = btoi_bool_i64(lifted_lambda_res_162582);
        int64_t defunc_0_op_res_154532 = add64(bool_res_162583, scanacc_171547);
        int64_t zp_res_154523 = add64(bool_res_162583, redout_171549);
        
        ((int64_t *) mem_171820)[i_171551] = defunc_0_op_res_154532;
        ((int64_t *) mem_171822)[i_171551] = defunc_0_f_res_162567;
        
        int64_t scanacc_tmp_172503 = defunc_0_op_res_154532;
        int64_t redout_tmp_172505 = zp_res_154523;
        
        scanacc_171547 = scanacc_tmp_172503;
        redout_171549 = redout_tmp_172505;
    }
    discard_171554 = scanacc_171547;
    defunc_res_162602 = redout_171549;
    
    int64_t bytes_171835 = (int64_t) 8 * defunc_res_162602;
    
    if (memblock_alloc(ctx, &mem_171836, bytes_171835, "mem_171836")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172507 = 0; nest_i_172507 < defunc_res_162602; nest_i_172507++) {
        ((int64_t *) mem_171836.mem)[nest_i_172507] = (int64_t) -1;
    }
    for (int64_t write_iter_171555 = 0; write_iter_171555 < dz2080U_149086; write_iter_171555++) {
        int64_t write_iv_171558 = ((int64_t *) mem_171822)[write_iter_171555];
        int64_t zv_lhs_162525 = add64((int64_t) -1, write_iter_171555);
        int64_t tmp_162526 = smod64(zv_lhs_162525, dz2080U_149086);
        int64_t lifted_lambda_res_162527 = ((int64_t *) mem_171820)[tmp_162526];
        bool cond_162529 = write_iter_171555 == (int64_t) 0;
        int64_t lifted_lambda_res_162530;
        
        if (cond_162529) {
            lifted_lambda_res_162530 = (int64_t) 0;
        } else {
            lifted_lambda_res_162530 = lifted_lambda_res_162527;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162530) && slt64(lifted_lambda_res_162530, defunc_res_162602)) {
            ((int64_t *) mem_171836.mem)[lifted_lambda_res_162530] = write_iv_171558;
        }
    }
    
    int64_t zeze_rhs_154548 = sub64(defunc_res_162602, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171844, bytes_171835, "mem_171844")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171562 = 0; i_171562 < defunc_res_162602; i_171562++) {
        bool cond_154551 = i_171562 == zeze_rhs_154548;
        int64_t lifted_lambda_res_154552;
        
        if (cond_154551) {
            int64_t zm_rhs_162599 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t lifted_lambda_res_t_res_162600 = sub64(dz2080U_149086, zm_rhs_162599);
            
            lifted_lambda_res_154552 = lifted_lambda_res_t_res_162600;
        } else {
            int64_t next_ind_154564 = add64((int64_t) 1, i_171562);
            bool x_154565 = sle64((int64_t) 0, next_ind_154564);
            bool y_154566 = slt64(next_ind_154564, defunc_res_162602);
            bool bounds_check_154567 = x_154565 && y_154566;
            bool index_certs_154568;
            
            if (!bounds_check_154567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154564, "] out of bounds for array of shape [", (long long) defunc_res_162602, "].", "-> #0  ft_SortGroupBy.fut:121:48-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:328:64-68\n   #3  ftRelational.fut:326:5-329:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154563 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t next_ind_154569 = ((int64_t *) mem_171836.mem)[next_ind_154564];
            int64_t lifted_lambda_res_f_res_154570 = sub64(next_ind_154569, this_ind_154563);
            
            lifted_lambda_res_154552 = lifted_lambda_res_f_res_154570;
        }
        ((int64_t *) mem_171844.mem)[i_171562] = lifted_lambda_res_154552;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171844, "mem_171844") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171836, "mem_171836") != 0)
        return 1;
    prim_out_172502 = defunc_res_162602;
    if (memblock_set(ctx, &*mem_out_p_173124, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173125, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173126 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        if (memblock_unref(ctx, &mem_171844, "mem_171844") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct memblock *mem_out_p_173129, struct memblock *mem_out_p_173130, int64_t *out_prim_out_173131, struct memblock ks_mem_171818, int64_t dz2080U_148390)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173132 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173133 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock mem_171844;
    
    mem_171844.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t bytes_171819 = (int64_t) 8 * dz2080U_148390;
    
    if (mem_171820_cached_sizze_173132 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173132, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173133 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173133, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171554;
    int64_t defunc_res_162602;
    int64_t scanacc_171547;
    int64_t redout_171549;
    
    scanacc_171547 = (int64_t) 0;
    redout_171549 = (int64_t) 0;
    for (int64_t i_171551 = 0; i_171551 < dz2080U_148390; i_171551++) {
        bool cond_162566 = i_171551 == (int64_t) 0;
        int64_t defunc_0_f_res_162567;
        
        if (cond_162566) {
            defunc_0_f_res_162567 = (int64_t) 0;
        } else {
            int64_t prev_k_162573 = sub64(i_171551, (int64_t) 1);
            bool x_162574 = sle64((int64_t) 0, prev_k_162573);
            bool y_162575 = slt64(prev_k_162573, dz2080U_148390);
            bool bounds_check_162576 = x_162574 && y_162575;
            bool index_certs_162577;
            
            if (!bounds_check_162576) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162573, "] out of bounds for array of shape [", (long long) dz2080U_148390, "].", "-> #0  ft_SortGroupBy.fut:108:46-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:28-113:26\n   #3  ftRelational.fut:320:64-68\n   #4  ftRelational.fut:318:5-321:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int32_t this_k_162572 = ((int32_t *) ks_mem_171818.mem)[i_171551];
            int32_t prev_k_162578 = ((int32_t *) ks_mem_171818.mem)[prev_k_162573];
            bool defunc_0_eq_res_162579 = this_k_162572 == prev_k_162578;
            int64_t defunc_0_f_res_f_res_162580;
            
            if (defunc_0_eq_res_162579) {
                defunc_0_f_res_f_res_162580 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162580 = i_171551;
            }
            defunc_0_f_res_162567 = defunc_0_f_res_f_res_162580;
        }
        
        bool lifted_lambda_res_162582 = sle64((int64_t) 0, defunc_0_f_res_162567);
        int64_t bool_res_162583 = btoi_bool_i64(lifted_lambda_res_162582);
        int64_t defunc_0_op_res_154532 = add64(bool_res_162583, scanacc_171547);
        int64_t zp_res_154523 = add64(bool_res_162583, redout_171549);
        
        ((int64_t *) mem_171820)[i_171551] = defunc_0_op_res_154532;
        ((int64_t *) mem_171822)[i_171551] = defunc_0_f_res_162567;
        
        int64_t scanacc_tmp_172503 = defunc_0_op_res_154532;
        int64_t redout_tmp_172505 = zp_res_154523;
        
        scanacc_171547 = scanacc_tmp_172503;
        redout_171549 = redout_tmp_172505;
    }
    discard_171554 = scanacc_171547;
    defunc_res_162602 = redout_171549;
    
    int64_t bytes_171835 = (int64_t) 8 * defunc_res_162602;
    
    if (memblock_alloc(ctx, &mem_171836, bytes_171835, "mem_171836")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172507 = 0; nest_i_172507 < defunc_res_162602; nest_i_172507++) {
        ((int64_t *) mem_171836.mem)[nest_i_172507] = (int64_t) -1;
    }
    for (int64_t write_iter_171555 = 0; write_iter_171555 < dz2080U_148390; write_iter_171555++) {
        int64_t write_iv_171558 = ((int64_t *) mem_171822)[write_iter_171555];
        int64_t zv_lhs_162525 = add64((int64_t) -1, write_iter_171555);
        int64_t tmp_162526 = smod64(zv_lhs_162525, dz2080U_148390);
        int64_t lifted_lambda_res_162527 = ((int64_t *) mem_171820)[tmp_162526];
        bool cond_162529 = write_iter_171555 == (int64_t) 0;
        int64_t lifted_lambda_res_162530;
        
        if (cond_162529) {
            lifted_lambda_res_162530 = (int64_t) 0;
        } else {
            lifted_lambda_res_162530 = lifted_lambda_res_162527;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162530) && slt64(lifted_lambda_res_162530, defunc_res_162602)) {
            ((int64_t *) mem_171836.mem)[lifted_lambda_res_162530] = write_iv_171558;
        }
    }
    
    int64_t zeze_rhs_154548 = sub64(defunc_res_162602, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171844, bytes_171835, "mem_171844")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171562 = 0; i_171562 < defunc_res_162602; i_171562++) {
        bool cond_154551 = i_171562 == zeze_rhs_154548;
        int64_t lifted_lambda_res_154552;
        
        if (cond_154551) {
            int64_t zm_rhs_162599 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t lifted_lambda_res_t_res_162600 = sub64(dz2080U_148390, zm_rhs_162599);
            
            lifted_lambda_res_154552 = lifted_lambda_res_t_res_162600;
        } else {
            int64_t next_ind_154564 = add64((int64_t) 1, i_171562);
            bool x_154565 = sle64((int64_t) 0, next_ind_154564);
            bool y_154566 = slt64(next_ind_154564, defunc_res_162602);
            bool bounds_check_154567 = x_154565 && y_154566;
            bool index_certs_154568;
            
            if (!bounds_check_154567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154564, "] out of bounds for array of shape [", (long long) defunc_res_162602, "].", "-> #0  ft_SortGroupBy.fut:121:48-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:320:64-68\n   #3  ftRelational.fut:318:5-321:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154563 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t next_ind_154569 = ((int64_t *) mem_171836.mem)[next_ind_154564];
            int64_t lifted_lambda_res_f_res_154570 = sub64(next_ind_154569, this_ind_154563);
            
            lifted_lambda_res_154552 = lifted_lambda_res_f_res_154570;
        }
        ((int64_t *) mem_171844.mem)[i_171562] = lifted_lambda_res_154552;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171844, "mem_171844") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171836, "mem_171836") != 0)
        return 1;
    prim_out_172502 = defunc_res_162602;
    if (memblock_set(ctx, &*mem_out_p_173129, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173130, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173131 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        if (memblock_unref(ctx, &mem_171844, "mem_171844") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct memblock *mem_out_p_173134, struct memblock *mem_out_p_173135, int64_t *out_prim_out_173136, struct memblock ks_mem_171818, int64_t dz2080U_148738)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173137 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173138 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock mem_171844;
    
    mem_171844.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t bytes_171819 = (int64_t) 8 * dz2080U_148738;
    
    if (mem_171820_cached_sizze_173137 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173137, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173138 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173138, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171554;
    int64_t defunc_res_162602;
    int64_t scanacc_171547;
    int64_t redout_171549;
    
    scanacc_171547 = (int64_t) 0;
    redout_171549 = (int64_t) 0;
    for (int64_t i_171551 = 0; i_171551 < dz2080U_148738; i_171551++) {
        bool cond_162566 = i_171551 == (int64_t) 0;
        int64_t defunc_0_f_res_162567;
        
        if (cond_162566) {
            defunc_0_f_res_162567 = (int64_t) 0;
        } else {
            int64_t prev_k_162573 = sub64(i_171551, (int64_t) 1);
            bool x_162574 = sle64((int64_t) 0, prev_k_162573);
            bool y_162575 = slt64(prev_k_162573, dz2080U_148738);
            bool bounds_check_162576 = x_162574 && y_162575;
            bool index_certs_162577;
            
            if (!bounds_check_162576) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162573, "] out of bounds for array of shape [", (long long) dz2080U_148738, "].", "-> #0  ft_SortGroupBy.fut:108:46-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:28-113:26\n   #3  ftRelational.fut:324:64-68\n   #4  ftRelational.fut:322:5-325:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_k_162572 = ((int64_t *) ks_mem_171818.mem)[i_171551];
            int64_t prev_k_162578 = ((int64_t *) ks_mem_171818.mem)[prev_k_162573];
            bool defunc_0_eq_res_162579 = this_k_162572 == prev_k_162578;
            int64_t defunc_0_f_res_f_res_162580;
            
            if (defunc_0_eq_res_162579) {
                defunc_0_f_res_f_res_162580 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162580 = i_171551;
            }
            defunc_0_f_res_162567 = defunc_0_f_res_f_res_162580;
        }
        
        bool lifted_lambda_res_162582 = sle64((int64_t) 0, defunc_0_f_res_162567);
        int64_t bool_res_162583 = btoi_bool_i64(lifted_lambda_res_162582);
        int64_t defunc_0_op_res_154532 = add64(bool_res_162583, scanacc_171547);
        int64_t zp_res_154523 = add64(bool_res_162583, redout_171549);
        
        ((int64_t *) mem_171820)[i_171551] = defunc_0_op_res_154532;
        ((int64_t *) mem_171822)[i_171551] = defunc_0_f_res_162567;
        
        int64_t scanacc_tmp_172503 = defunc_0_op_res_154532;
        int64_t redout_tmp_172505 = zp_res_154523;
        
        scanacc_171547 = scanacc_tmp_172503;
        redout_171549 = redout_tmp_172505;
    }
    discard_171554 = scanacc_171547;
    defunc_res_162602 = redout_171549;
    
    int64_t bytes_171835 = (int64_t) 8 * defunc_res_162602;
    
    if (memblock_alloc(ctx, &mem_171836, bytes_171835, "mem_171836")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172507 = 0; nest_i_172507 < defunc_res_162602; nest_i_172507++) {
        ((int64_t *) mem_171836.mem)[nest_i_172507] = (int64_t) -1;
    }
    for (int64_t write_iter_171555 = 0; write_iter_171555 < dz2080U_148738; write_iter_171555++) {
        int64_t write_iv_171558 = ((int64_t *) mem_171822)[write_iter_171555];
        int64_t zv_lhs_162525 = add64((int64_t) -1, write_iter_171555);
        int64_t tmp_162526 = smod64(zv_lhs_162525, dz2080U_148738);
        int64_t lifted_lambda_res_162527 = ((int64_t *) mem_171820)[tmp_162526];
        bool cond_162529 = write_iter_171555 == (int64_t) 0;
        int64_t lifted_lambda_res_162530;
        
        if (cond_162529) {
            lifted_lambda_res_162530 = (int64_t) 0;
        } else {
            lifted_lambda_res_162530 = lifted_lambda_res_162527;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162530) && slt64(lifted_lambda_res_162530, defunc_res_162602)) {
            ((int64_t *) mem_171836.mem)[lifted_lambda_res_162530] = write_iv_171558;
        }
    }
    
    int64_t zeze_rhs_154548 = sub64(defunc_res_162602, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171844, bytes_171835, "mem_171844")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171562 = 0; i_171562 < defunc_res_162602; i_171562++) {
        bool cond_154551 = i_171562 == zeze_rhs_154548;
        int64_t lifted_lambda_res_154552;
        
        if (cond_154551) {
            int64_t zm_rhs_162599 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t lifted_lambda_res_t_res_162600 = sub64(dz2080U_148738, zm_rhs_162599);
            
            lifted_lambda_res_154552 = lifted_lambda_res_t_res_162600;
        } else {
            int64_t next_ind_154564 = add64((int64_t) 1, i_171562);
            bool x_154565 = sle64((int64_t) 0, next_ind_154564);
            bool y_154566 = slt64(next_ind_154564, defunc_res_162602);
            bool bounds_check_154567 = x_154565 && y_154566;
            bool index_certs_154568;
            
            if (!bounds_check_154567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154564, "] out of bounds for array of shape [", (long long) defunc_res_162602, "].", "-> #0  ft_SortGroupBy.fut:121:48-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:324:64-68\n   #3  ftRelational.fut:322:5-325:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154563 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t next_ind_154569 = ((int64_t *) mem_171836.mem)[next_ind_154564];
            int64_t lifted_lambda_res_f_res_154570 = sub64(next_ind_154569, this_ind_154563);
            
            lifted_lambda_res_154552 = lifted_lambda_res_f_res_154570;
        }
        ((int64_t *) mem_171844.mem)[i_171562] = lifted_lambda_res_154552;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171844, "mem_171844") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171836, "mem_171836") != 0)
        return 1;
    prim_out_172502 = defunc_res_162602;
    if (memblock_set(ctx, &*mem_out_p_173134, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173135, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173136 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        if (memblock_unref(ctx, &mem_171844, "mem_171844") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct memblock *mem_out_p_173139, struct memblock *mem_out_p_173140, int64_t *out_prim_out_173141, struct memblock ks_mem_171818, int64_t dz2080U_148042)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173142 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173143 = 0;
    unsigned char *mem_171822 = NULL;
    struct memblock mem_171844;
    
    mem_171844.references = NULL;
    
    struct memblock mem_171836;
    
    mem_171836.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t bytes_171819 = (int64_t) 8 * dz2080U_148042;
    
    if (mem_171820_cached_sizze_173142 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173142, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173143 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173143, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171554;
    int64_t defunc_res_162602;
    int64_t scanacc_171547;
    int64_t redout_171549;
    
    scanacc_171547 = (int64_t) 0;
    redout_171549 = (int64_t) 0;
    for (int64_t i_171551 = 0; i_171551 < dz2080U_148042; i_171551++) {
        bool cond_162566 = i_171551 == (int64_t) 0;
        int64_t defunc_0_f_res_162567;
        
        if (cond_162566) {
            defunc_0_f_res_162567 = (int64_t) 0;
        } else {
            int64_t prev_k_162573 = sub64(i_171551, (int64_t) 1);
            bool x_162574 = sle64((int64_t) 0, prev_k_162573);
            bool y_162575 = slt64(prev_k_162573, dz2080U_148042);
            bool bounds_check_162576 = x_162574 && y_162575;
            bool index_certs_162577;
            
            if (!bounds_check_162576) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) prev_k_162573, "] out of bounds for array of shape [", (long long) dz2080U_148042, "].", "-> #0  ft_SortGroupBy.fut:108:46-60\n   #1  /prelude/functional.fut:9:44-45\n   #2  ft_SortGroupBy.fut:105:28-113:26\n   #3  ftRelational.fut:316:64-68\n   #4  ftRelational.fut:314:5-317:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int16_t this_k_162572 = ((int16_t *) ks_mem_171818.mem)[i_171551];
            int16_t prev_k_162578 = ((int16_t *) ks_mem_171818.mem)[prev_k_162573];
            bool defunc_0_eq_res_162579 = this_k_162572 == prev_k_162578;
            int64_t defunc_0_f_res_f_res_162580;
            
            if (defunc_0_eq_res_162579) {
                defunc_0_f_res_f_res_162580 = (int64_t) -1;
            } else {
                defunc_0_f_res_f_res_162580 = i_171551;
            }
            defunc_0_f_res_162567 = defunc_0_f_res_f_res_162580;
        }
        
        bool lifted_lambda_res_162582 = sle64((int64_t) 0, defunc_0_f_res_162567);
        int64_t bool_res_162583 = btoi_bool_i64(lifted_lambda_res_162582);
        int64_t defunc_0_op_res_154532 = add64(bool_res_162583, scanacc_171547);
        int64_t zp_res_154523 = add64(bool_res_162583, redout_171549);
        
        ((int64_t *) mem_171820)[i_171551] = defunc_0_op_res_154532;
        ((int64_t *) mem_171822)[i_171551] = defunc_0_f_res_162567;
        
        int64_t scanacc_tmp_172503 = defunc_0_op_res_154532;
        int64_t redout_tmp_172505 = zp_res_154523;
        
        scanacc_171547 = scanacc_tmp_172503;
        redout_171549 = redout_tmp_172505;
    }
    discard_171554 = scanacc_171547;
    defunc_res_162602 = redout_171549;
    
    int64_t bytes_171835 = (int64_t) 8 * defunc_res_162602;
    
    if (memblock_alloc(ctx, &mem_171836, bytes_171835, "mem_171836")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172507 = 0; nest_i_172507 < defunc_res_162602; nest_i_172507++) {
        ((int64_t *) mem_171836.mem)[nest_i_172507] = (int64_t) -1;
    }
    for (int64_t write_iter_171555 = 0; write_iter_171555 < dz2080U_148042; write_iter_171555++) {
        int64_t write_iv_171558 = ((int64_t *) mem_171822)[write_iter_171555];
        int64_t zv_lhs_162525 = add64((int64_t) -1, write_iter_171555);
        int64_t tmp_162526 = smod64(zv_lhs_162525, dz2080U_148042);
        int64_t lifted_lambda_res_162527 = ((int64_t *) mem_171820)[tmp_162526];
        bool cond_162529 = write_iter_171555 == (int64_t) 0;
        int64_t lifted_lambda_res_162530;
        
        if (cond_162529) {
            lifted_lambda_res_162530 = (int64_t) 0;
        } else {
            lifted_lambda_res_162530 = lifted_lambda_res_162527;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162530) && slt64(lifted_lambda_res_162530, defunc_res_162602)) {
            ((int64_t *) mem_171836.mem)[lifted_lambda_res_162530] = write_iv_171558;
        }
    }
    
    int64_t zeze_rhs_154548 = sub64(defunc_res_162602, (int64_t) 1);
    
    if (memblock_alloc(ctx, &mem_171844, bytes_171835, "mem_171844")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_171562 = 0; i_171562 < defunc_res_162602; i_171562++) {
        bool cond_154551 = i_171562 == zeze_rhs_154548;
        int64_t lifted_lambda_res_154552;
        
        if (cond_154551) {
            int64_t zm_rhs_162599 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t lifted_lambda_res_t_res_162600 = sub64(dz2080U_148042, zm_rhs_162599);
            
            lifted_lambda_res_154552 = lifted_lambda_res_t_res_162600;
        } else {
            int64_t next_ind_154564 = add64((int64_t) 1, i_171562);
            bool x_154565 = sle64((int64_t) 0, next_ind_154564);
            bool y_154566 = slt64(next_ind_154564, defunc_res_162602);
            bool bounds_check_154567 = x_154565 && y_154566;
            bool index_certs_154568;
            
            if (!bounds_check_154567) {
                set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) next_ind_154564, "] out of bounds for array of shape [", (long long) defunc_res_162602, "].", "-> #0  ft_SortGroupBy.fut:121:48-59\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftRelational.fut:316:64-68\n   #3  ftRelational.fut:314:5-317:49\n"));
                err = FUTHARK_PROGRAM_ERROR;
                goto cleanup;
            }
            
            int64_t this_ind_154563 = ((int64_t *) mem_171836.mem)[i_171562];
            int64_t next_ind_154569 = ((int64_t *) mem_171836.mem)[next_ind_154564];
            int64_t lifted_lambda_res_f_res_154570 = sub64(next_ind_154569, this_ind_154563);
            
            lifted_lambda_res_154552 = lifted_lambda_res_f_res_154570;
        }
        ((int64_t *) mem_171844.mem)[i_171562] = lifted_lambda_res_154552;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171844, "mem_171844") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171836, "mem_171836") != 0)
        return 1;
    prim_out_172502 = defunc_res_162602;
    if (memblock_set(ctx, &*mem_out_p_173139, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173140, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173141 = prim_out_172502;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        if (memblock_unref(ctx, &mem_171844, "mem_171844") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171836, "mem_171836") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_getPartitionBounds_16885(struct futhark_context *ctx, struct memblock *mem_out_p_173144, struct memblock *mem_out_p_173145, int64_t *out_prim_out_173146, int64_t *out_prim_out_173147, int32_t *out_prim_out_173148, struct memblock pXs_mem_171818, int64_t n_129182, int64_t b_129183, int32_t curDepth_129184, int32_t i_129186, int32_t j_129187)
{
    (void) ctx;
    
    int err = 0;
    int64_t mem_171820_cached_sizze_173149 = 0;
    unsigned char *mem_171820 = NULL;
    int64_t mem_171822_cached_sizze_173150 = 0;
    unsigned char *mem_171822 = NULL;
    int64_t mem_171829_cached_sizze_173151 = 0;
    unsigned char *mem_171829 = NULL;
    int64_t mem_171830_cached_sizze_173152 = 0;
    unsigned char *mem_171830 = NULL;
    int64_t mem_171843_cached_sizze_173153 = 0;
    unsigned char *mem_171843 = NULL;
    int64_t mem_171857_cached_sizze_173154 = 0;
    unsigned char *mem_171857 = NULL;
    struct memblock mem_171868;
    
    mem_171868.references = NULL;
    
    struct memblock mem_171866;
    
    mem_171866.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t prim_out_172502;
    int64_t prim_out_172503;
    int32_t prim_out_172504;
    int64_t dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188 = sub64(n_129182, (int64_t) 1);
    bool bounds_invalid_upwards_129192 = slt64(n_129182, (int64_t) 1);
    bool valid_129197 = !bounds_invalid_upwards_129192;
    bool range_valid_c_129198;
    
    if (!valid_129197) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 1, "..<", (long long) n_129182, " is invalid.", "-> #0  ftHashJoin.fut:233:25-30\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t zm_lhs_162336 = mul64((int64_t) 8, b_129183);
    int64_t min_arg1_162337 = sub64(zm_lhs_162336, (int64_t) 1);
    int32_t i64_res_162322 = sext_i64_i32(b_129183);
    int32_t zm_lhs_162323 = mul32(8, i64_res_162322);
    int32_t min_arg1_162324 = sub32(zm_lhs_162323, 1);
    int32_t min_res_162325 = smin32(j_129187, min_arg1_162324);
    int32_t zm_rhs_162332 = sdiv32(min_res_162325, 8);
    int32_t zm_lhs_162333 = sub32(i64_res_162322, zm_rhs_162332);
    int32_t i32_arg0_162334 = sub32(zm_lhs_162333, 1);
    int64_t i32_res_162335 = sext_i32_i64(i32_arg0_162334);
    int64_t min_res_162338 = smin64(i32_res_162335, min_arg1_162337);
    bool y_162367 = slt64(min_res_162338, b_129183);
    bool x_162366 = sle64((int64_t) 0, min_res_162338);
    bool bounds_check_162368 = x_162366 && y_162367;
    bool index_certs_162369;
    
    if (!bounds_check_162368) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) min_res_162338, "] out of bounds for array of shape [", (long long) b_129183, "].", "-> #0  ftHashJoin.fut:34:40-56\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t zm_rhs_162327 = sdiv32(i_129186, 8);
    int32_t zm_lhs_162328 = sub32(i64_res_162322, zm_rhs_162327);
    int32_t i32_arg0_162329 = sub32(zm_lhs_162328, 1);
    int64_t i32_res_162330 = sext_i32_i64(i32_arg0_162329);
    bool y_162356 = slt64(i32_res_162330, b_129183);
    bool x_162355 = sle64((int64_t) 0, i32_res_162330);
    bool bounds_check_162357 = x_162355 && y_162356;
    bool index_certs_162358;
    
    if (!bounds_check_162357) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i32_res_162330, "] out of bounds for array of shape [", (long long) b_129183, "].", "-> #0  ftHashJoin.fut:33:50-66\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int32_t lastBit_162340 = smod32(min_res_162325, 8);
    int32_t zm_lhs_162343 = sub32(8, lastBit_162340);
    int32_t i32_arg0_162344 = sub32(zm_lhs_162343, 1);
    int8_t unsign_arg0_162345 = zext_i32_i8(i32_arg0_162344);
    int8_t unsign_arg0_162346 = lshr8((int8_t) -1, unsign_arg0_162345);
    int32_t firstBit_162339 = smod32(i_129186, 8);
    int8_t unsign_arg0_162341 = zext_i32_i8(firstBit_162339);
    int8_t first_bitMask_162342 = shl8((int8_t) -1, unsign_arg0_162341);
    int64_t bytes_171819 = (int64_t) 8 * dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188;
    
    if (mem_171820_cached_sizze_173149 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171820, &mem_171820_cached_sizze_173149, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171822_cached_sizze_173150 < bytes_171819) {
        err = lexical_realloc(ctx, &mem_171822, &mem_171822_cached_sizze_173150, bytes_171819);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171829_cached_sizze_173151 < b_129183) {
        err = lexical_realloc(ctx, &mem_171829, &mem_171829_cached_sizze_173151, b_129183);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171830_cached_sizze_173152 < b_129183) {
        err = lexical_realloc(ctx, &mem_171830, &mem_171830_cached_sizze_173152, b_129183);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    if (mem_171843_cached_sizze_173153 < b_129183) {
        err = lexical_realloc(ctx, &mem_171843, &mem_171843_cached_sizze_173153, b_129183);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    
    int64_t discard_171564;
    int64_t scanacc_171558 = (int64_t) 0;
    
    for (int64_t i_171561 = 0; i_171561 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188; i_171561++) {
        int64_t index_primexp_171794 = add64((int64_t) 1, i_171561);
        bool x_162584 = sle64((int64_t) 0, index_primexp_171794);
        bool y_162585 = slt64(index_primexp_171794, n_129182);
        bool bounds_check_162586 = x_162584 && y_162585;
        bool index_certs_162587;
        
        if (!bounds_check_162586) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) index_primexp_171794, "] out of bounds for array of shape [", (long long) n_129182, "].", "-> #0  ftHashJoin.fut:234:24-32\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:234:10-46\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        bool y_162591 = slt64(i_171561, n_129182);
        bool index_certs_162593;
        
        if (!y_162591) {
            set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) i_171561, "] out of bounds for array of shape [", (long long) n_129182, "].", "-> #0  ftHashJoin.fut:234:34-44\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftHashJoin.fut:234:10-46\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        for (int64_t i_171549 = 0; i_171549 < b_129183; i_171549++) {
            int8_t eta_p_162639 = ((int8_t *) pXs_mem_171818.mem)[index_primexp_171794 * b_129183 + i_171549];
            int8_t eta_p_162640 = ((int8_t *) pXs_mem_171818.mem)[i_171561 * b_129183 + i_171549];
            bool cond_162642 = sle64(i_171549, i32_res_162330);
            bool cond_t_res_162643 = sle64(min_res_162338, i_171549);
            bool x_162644 = cond_162642 && cond_t_res_162643;
            int8_t lifted_lambda_res_162645;
            
            if (x_162644) {
                lifted_lambda_res_162645 = eta_p_162639;
            } else {
                lifted_lambda_res_162645 = (int8_t) 0;
            }
            
            int8_t lifted_lambda_res_162650;
            
            if (x_162644) {
                lifted_lambda_res_162650 = eta_p_162640;
            } else {
                lifted_lambda_res_162650 = (int8_t) 0;
            }
            ((int8_t *) mem_171829)[i_171549] = lifted_lambda_res_162650;
            ((int8_t *) mem_171830)[i_171549] = lifted_lambda_res_162645;
        }
        
        int8_t za_lhs_162604 = ((int8_t *) mem_171830)[i32_res_162330];
        int8_t mod1_x_162605 = first_bitMask_162342 & za_lhs_162604;
        
        ((int8_t *) mem_171830)[i32_res_162330] = mod1_x_162605;
        
        int8_t za_lhs_162607 = ((int8_t *) mem_171830)[min_res_162338];
        int8_t tmp_162608 = unsign_arg0_162346 & za_lhs_162607;
        
        ((int8_t *) mem_171830)[min_res_162338] = tmp_162608;
        
        int8_t za_lhs_162617 = ((int8_t *) mem_171829)[i32_res_162330];
        int8_t mod1_x_162618 = first_bitMask_162342 & za_lhs_162617;
        
        ((int8_t *) mem_171829)[i32_res_162330] = mod1_x_162618;
        
        int8_t za_lhs_162620 = ((int8_t *) mem_171829)[min_res_162338];
        int8_t tmp_162621 = unsign_arg0_162346 & za_lhs_162620;
        
        ((int8_t *) mem_171829)[min_res_162338] = tmp_162621;
        for (int64_t i_171554 = 0; i_171554 < b_129183; i_171554++) {
            int8_t eta_p_162626 = ((int8_t *) mem_171830)[i_171554];
            int8_t eta_p_162627 = ((int8_t *) mem_171829)[i_171554];
            bool lifted_lambda_res_162628 = eta_p_162626 == eta_p_162627;
            bool lifted_lambda_res_162629 = !lifted_lambda_res_162628;
            
            ((bool *) mem_171843)[i_171554] = lifted_lambda_res_162629;
        }
        
        bool defunc_0_foldl_res_162630;
        bool acc_162632 = 0;
        
        for (int64_t i_162631 = 0; i_162631 < b_129183; i_162631++) {
            bool b_162633 = ((bool *) mem_171843)[i_162631];
            bool defunc_0_f_res_162634 = acc_162632 || b_162633;
            bool acc_tmp_172511 = defunc_0_f_res_162634;
            
            acc_162632 = acc_tmp_172511;
        }
        defunc_0_foldl_res_162630 = acc_162632;
        
        int64_t defunc_0_f_res_162635 = btoi_bool_i64(defunc_0_foldl_res_162630);
        int64_t defunc_0_op_res_154520 = add64(defunc_0_f_res_162635, scanacc_171558);
        
        ((int64_t *) mem_171820)[i_171561] = defunc_0_op_res_154520;
        ((int64_t *) mem_171822)[i_171561] = defunc_0_f_res_162635;
        
        int64_t scanacc_tmp_172505 = defunc_0_op_res_154520;
        
        scanacc_171558 = scanacc_tmp_172505;
    }
    discard_171564 = scanacc_171558;
    
    bool cond_154521 = dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188 == (int64_t) 0;
    bool x_154522 = !cond_154521;
    int64_t tmp_154523 = sub64(dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188, (int64_t) 1);
    bool x_154524 = sle64((int64_t) 0, tmp_154523);
    bool y_154525 = slt64(tmp_154523, dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188);
    bool bounds_check_154526 = x_154524 && y_154525;
    bool protect_assert_disj_154527 = cond_154521 || bounds_check_154526;
    bool index_certs_154528;
    
    if (!protect_assert_disj_154527) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) tmp_154523, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188, "].", "-> #0  /prelude/soacs.fut:257:33-47\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t m_f_res_154529;
    
    if (x_154522) {
        int64_t x_162663 = ((int64_t *) mem_171820)[tmp_154523];
        
        m_f_res_154529 = x_162663;
    } else {
        m_f_res_154529 = (int64_t) 0;
    }
    
    int64_t m_154531;
    
    if (cond_154521) {
        m_154531 = (int64_t) 0;
    } else {
        m_154531 = m_f_res_154529;
    }
    
    int64_t m_154541 = sub64(m_154531, (int64_t) 1);
    bool i_p_m_t_s_leq_w_154543 = slt64(m_154541, dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188);
    bool zzero_leq_i_p_m_t_s_154542 = sle64((int64_t) 0, m_154541);
    bool y_154545 = zzero_leq_i_p_m_t_s_154542 && i_p_m_t_s_leq_w_154543;
    bool i_lte_j_154544 = sle64((int64_t) 0, m_154531);
    bool forwards_ok_154546 = i_lte_j_154544 && y_154545;
    bool eq_x_zz_154538 = (int64_t) 0 == m_f_res_154529;
    bool p_and_eq_x_y_154539 = x_154522 && eq_x_zz_154538;
    bool empty_slice_154540 = cond_154521 || p_and_eq_x_y_154539;
    bool ok_or_empty_154547 = empty_slice_154540 || forwards_ok_154546;
    bool index_certs_154548;
    
    if (!ok_or_empty_154547) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [:", (long long) m_154531, "] out of bounds for array of shape [", (long long) dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188, "].", "-> #0  /prelude/soacs.fut:258:29-35\n   #1  /prelude/functional.fut:9:44-45\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171856 = (int64_t) 8 * m_154531;
    int64_t conc_tmp_152819 = (int64_t) 1 + m_154531;
    int64_t bytes_171865 = (int64_t) 8 * conc_tmp_152819;
    int64_t bytes_171867 = (int64_t) 4 * conc_tmp_152819;
    
    if (mem_171857_cached_sizze_173154 < bytes_171856) {
        err = lexical_realloc(ctx, &mem_171857, &mem_171857_cached_sizze_173154, bytes_171856);
        if (err != FUTHARK_SUCCESS)
            goto cleanup;
    }
    for (int64_t i_172512 = 0; i_172512 < m_154531; i_172512++) {
        int64_t x_172513 = (int64_t) 1 + i_172512 * (int64_t) 1;
        
        ((int64_t *) mem_171857)[i_172512] = x_172513;
    }
    for (int64_t write_iter_171565 = 0; write_iter_171565 < dzlz7bUZLzmZRz20Unz20U1z7dUzg_129188; write_iter_171565++) {
        int64_t write_iv_171567 = ((int64_t *) mem_171822)[write_iter_171565];
        int64_t write_iv_171568 = ((int64_t *) mem_171820)[write_iter_171565];
        int64_t index_primexp_171790 = add64((int64_t) 1, write_iter_171565);
        bool cond_162518 = write_iv_171567 == (int64_t) 1;
        int64_t lifted_lambda_res_162519;
        
        if (cond_162518) {
            int64_t lifted_lambda_res_t_res_162664 = sub64(write_iv_171568, (int64_t) 1);
            
            lifted_lambda_res_162519 = lifted_lambda_res_t_res_162664;
        } else {
            lifted_lambda_res_162519 = (int64_t) -1;
        }
        if (sle64((int64_t) 0, lifted_lambda_res_162519) && slt64(lifted_lambda_res_162519, m_154531)) {
            ((int64_t *) mem_171857)[lifted_lambda_res_162519] = index_primexp_171790;
        }
    }
    if (memblock_alloc(ctx, &mem_171866, bytes_171865, "mem_171866")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172515 = 0; nest_i_172515 < (int64_t) 1; nest_i_172515++) {
        ((int64_t *) mem_171866.mem)[nest_i_172515] = (int64_t) 0;
    }
    
    int64_t tmp_offs_172516 = (int64_t) 0;
    
    if (!(tmp_offs_172516 == (int64_t) 0)) {
        lmad_copy_8b(ctx, 1, (uint64_t *) mem_171866.mem, tmp_offs_172516, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171866.mem, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {(int64_t) 1});
    }
    tmp_offs_172516 += (int64_t) 1;
    lmad_copy_8b(ctx, 1, (uint64_t *) mem_171866.mem, tmp_offs_172516, (int64_t []) {(int64_t) 1}, (uint64_t *) mem_171857, (int64_t) 0, (int64_t []) {(int64_t) 1}, (int64_t []) {m_154531});
    tmp_offs_172516 += m_154531;
    if (memblock_alloc(ctx, &mem_171868, bytes_171867, "mem_171868")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t nest_i_172517 = 0; nest_i_172517 < conc_tmp_152819; nest_i_172517++) {
        ((int32_t *) mem_171868.mem)[nest_i_172517] = curDepth_129184;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171866, "mem_171866") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172501, &mem_171868, "mem_171868") != 0)
        return 1;
    prim_out_172502 = conc_tmp_152819;
    prim_out_172503 = conc_tmp_152819;
    prim_out_172504 = curDepth_129184;
    if (memblock_set(ctx, &*mem_out_p_173144, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173145, &mem_out_172501, "mem_out_172501") != 0)
        return 1;
    *out_prim_out_173146 = prim_out_172502;
    *out_prim_out_173147 = prim_out_172503;
    *out_prim_out_173148 = prim_out_172504;
    
  cleanup:
    {
        free(mem_171820);
        free(mem_171822);
        free(mem_171829);
        free(mem_171830);
        free(mem_171843);
        free(mem_171857);
        if (memblock_unref(ctx, &mem_171868, "mem_171868") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171866, "mem_171866") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172501, "mem_out_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_1844(struct futhark_context *ctx, int32_t *out_prim_out_173155, int32_t bit_82646, int16_t x_82647)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_172500;
    int16_t i32_res_152736 = sext_i32_i16(bit_82646);
    int16_t zgzg_res_152739 = ashr16(x_82647, i32_res_152736);
    int16_t za_res_152744 = (int16_t) 1 & zgzg_res_152739;
    int32_t to_i32_res_152746 = sext_i16_i32(za_res_152744);
    
    prim_out_172500 = to_i32_res_152746;
    *out_prim_out_173155 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_get_bit_2253(struct futhark_context *ctx, int32_t *out_prim_out_173156, int32_t bit_84412, int64_t x_84413)
{
    (void) ctx;
    
    int err = 0;
    int32_t prim_out_172500;
    int64_t i32_res_152736 = sext_i32_i64(bit_84412);
    int64_t zgzg_res_152739 = ashr64(x_84413, i32_res_152736);
    int64_t za_res_152744 = (int64_t) 1 & zgzg_res_152739;
    int32_t to_i32_res_152746 = sext_i64_i32(za_res_152744);
    
    prim_out_172500 = to_i32_res_152746;
    *out_prim_out_173156 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_greatest_divisor_leq_than_5312(struct futhark_context *ctx, int64_t *out_prim_out_173157, int64_t upper_bound_86947, int64_t n_86948)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    bool upper_bound_86949 = sle64((int64_t) 1, upper_bound_86947);
    bool assert_c_86951;
    
    if (!upper_bound_86949) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "Assertion is false: (upper_bound >= 1)", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:189:21-58\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    bool cond_86960 = slt64(upper_bound_86947, n_86948);
    bool d_86969;
    int64_t d_86970;
    bool loop_while_86971;
    int64_t d_86972;
    
    loop_while_86971 = cond_86960;
    d_86972 = (int64_t) 1;
    while (loop_while_86971) {
        int64_t loopres_86973 = add64((int64_t) 1, d_86972);
        bool zzero_86975 = loopres_86973 == (int64_t) 0;
        bool nonzzero_86976 = !zzero_86975;
        bool nonzzero_cert_86977;
        
        if (!nonzzero_86976) {
            set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:190:36-38\n"));
            err = FUTHARK_PROGRAM_ERROR;
            goto cleanup;
        }
        
        int64_t zg_lhs_86978 = sdiv64(n_86948, loopres_86973);
        bool cond_86980 = slt64(upper_bound_86947, zg_lhs_86978);
        bool loop_cond_86981;
        
        if (cond_86980) {
            loop_cond_86981 = 1;
        } else {
            int64_t znze_lhs_86985 = smod64(n_86948, loopres_86973);
            bool loop_cond_f_res_86987 = znze_lhs_86985 == (int64_t) 0;
            bool loop_cond_f_res_86988 = !loop_cond_f_res_86987;
            
            loop_cond_86981 = loop_cond_f_res_86988;
        }
        
        bool loop_while_tmp_172501 = loop_cond_86981;
        int64_t d_tmp_172502 = loopres_86973;
        
        loop_while_86971 = loop_while_tmp_172501;
        d_86972 = d_tmp_172502;
    }
    d_86969 = loop_while_86971;
    d_86970 = d_86972;
    
    bool zzero_86990 = d_86970 == (int64_t) 0;
    bool nonzzero_86991 = !zzero_86990;
    bool nonzzero_cert_86992;
    
    if (!nonzzero_86991) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  lib/github.com/diku-dk/sorts/merge_sort.fut:191:7-9\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t greatest_divisor_leq_than_res_86993 = sdiv64(n_86948, d_86970);
    
    prim_out_172500 = greatest_divisor_leq_than_res_86993;
    *out_prim_out_173157 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16298(struct futhark_context *ctx, struct memblock *mem_out_p_173158, struct memblock nameless_mem_171818, int64_t n_98868, int64_t incr_98869)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t rng_98874 = add64(n_98868, incr_98869);
    bool bounds_invalid_upwards_98878 = slt64(rng_98874, incr_98869);
    bool valid_98883 = !bounds_invalid_upwards_98878;
    bool range_valid_c_98884;
    
    if (!valid_98883) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_98869, "..<", (long long) rng_98874, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_98868;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172501 = 0; i_172501 < n_98868; i_172501++) {
        int64_t x_172502 = incr_98869 + i_172501 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172501] = x_172502;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173158, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16319(struct futhark_context *ctx, struct memblock *mem_out_p_173159, struct memblock nameless_mem_171818, int64_t n_99729, int64_t incr_99730)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t rng_99735 = add64(n_99729, incr_99730);
    bool bounds_invalid_upwards_99739 = slt64(rng_99735, incr_99730);
    bool valid_99744 = !bounds_invalid_upwards_99739;
    bool range_valid_c_99745;
    
    if (!valid_99744) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_99730, "..<", (long long) rng_99735, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_99729;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172501 = 0; i_172501 < n_99729; i_172501++) {
        int64_t x_172502 = incr_99730 + i_172501 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172501] = x_172502;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173159, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16341(struct futhark_context *ctx, struct memblock *mem_out_p_173160, struct memblock nameless_mem_171818, int64_t n_100590, int64_t incr_100591)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t rng_100596 = add64(n_100590, incr_100591);
    bool bounds_invalid_upwards_100600 = slt64(rng_100596, incr_100591);
    bool valid_100605 = !bounds_invalid_upwards_100600;
    bool range_valid_c_100606;
    
    if (!valid_100605) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_100591, "..<", (long long) rng_100596, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_100590;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172501 = 0; i_172501 < n_100590; i_172501++) {
        int64_t x_172502 = incr_100591 + i_172501 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172501] = x_172502;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173160, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16363(struct futhark_context *ctx, struct memblock *mem_out_p_173161, struct memblock nameless_mem_171818, int64_t n_101451, int64_t incr_101452)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t rng_101457 = add64(n_101451, incr_101452);
    bool bounds_invalid_upwards_101461 = slt64(rng_101457, incr_101452);
    bool valid_101466 = !bounds_invalid_upwards_101461;
    bool range_valid_c_101467;
    
    if (!valid_101466) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_101452, "..<", (long long) rng_101457, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_101451;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172501 = 0; i_172501 < n_101451; i_172501++) {
        int64_t x_172502 = incr_101452 + i_172501 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172501] = x_172502;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173161, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_indicesWithIncrement_16384(struct futhark_context *ctx, struct memblock *mem_out_p_173162, struct memblock nameless_mem_171818, int64_t n_102333, int64_t incr_102334)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_171820;
    
    mem_171820.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int64_t rng_102339 = add64(n_102333, incr_102334);
    bool bounds_invalid_upwards_102343 = slt64(rng_102339, incr_102334);
    bool valid_102348 = !bounds_invalid_upwards_102343;
    bool range_valid_c_102349;
    
    if (!valid_102348) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) incr_102334, "..<", (long long) rng_102339, " is invalid.", "-> #0  ftbasics.fut:11:25-40\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171819 = (int64_t) 8 * n_102333;
    
    if (memblock_alloc(ctx, &mem_171820, bytes_171819, "mem_171820")) {
        err = 1;
        goto cleanup;
    }
    for (int64_t i_172501 = 0; i_172501 < n_102333; i_172501++) {
        int64_t x_172502 = incr_102334 + i_172501 * (int64_t) 1;
        
        ((int64_t *) mem_171820.mem)[i_172501] = x_172502;
    }
    if (memblock_set(ctx, &mem_out_172500, &mem_171820, "mem_171820") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173162, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_171820, "mem_171820") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_lifted_normalizze_15243(struct futhark_context *ctx, int64_t *out_prim_out_173163, int64_t *out_prim_out_173164, int64_t *out_prim_out_173165, int64_t *out_prim_out_173166, int64_t *out_prim_out_173167, int64_t slo_87177, int64_t shi_87178, int64_t tlo_87179, int64_t thi_87180, int64_t count_87181)
{
    (void) ctx;
    
    int err = 0;
    int64_t prim_out_172500;
    int64_t prim_out_172501;
    int64_t prim_out_172502;
    int64_t prim_out_172503;
    int64_t prim_out_172504;
    int64_t min_arg1_87184 = add64(slo_87177, count_87181);
    int64_t min_res_152737 = smin64(shi_87178, min_arg1_87184);
    int64_t min_arg1_87188 = add64(tlo_87179, count_87181);
    int64_t min_res_152740 = smin64(thi_87180, min_arg1_87188);
    int64_t zp_lhs_87192 = sub64(min_res_152737, slo_87177);
    int64_t zp_rhs_87194 = sub64(min_res_152740, tlo_87179);
    int64_t zm_lhs_87196 = add64(zp_lhs_87192, zp_rhs_87194);
    int64_t slack_87198 = sub64(zm_lhs_87196, count_87181);
    int64_t min_res_152743 = smin64(zp_lhs_87192, slack_87198);
    int64_t min_res_152746 = smin64(zp_rhs_87194, min_res_152743);
    int64_t max_arg1_87208 = sub64(min_res_152737, min_res_152746);
    int64_t max_res_152749 = smax64(slo_87177, max_arg1_87208);
    int64_t max_arg1_87212 = sub64(min_res_152740, min_res_152746);
    int64_t max_res_152752 = smax64(tlo_87179, max_arg1_87212);
    int64_t zm_rhs_87216 = sub64(max_res_152749, slo_87177);
    int64_t zm_lhs_87218 = sub64(count_87181, zm_rhs_87216);
    int64_t zm_rhs_87220 = sub64(max_res_152752, tlo_87179);
    int64_t count_87222 = sub64(zm_lhs_87218, zm_rhs_87220);
    
    prim_out_172500 = max_res_152749;
    prim_out_172501 = min_res_152737;
    prim_out_172502 = max_res_152752;
    prim_out_172503 = min_res_152740;
    prim_out_172504 = count_87222;
    *out_prim_out_173163 = prim_out_172500;
    *out_prim_out_173164 = prim_out_172501;
    *out_prim_out_173165 = prim_out_172502;
    *out_prim_out_173166 = prim_out_172503;
    *out_prim_out_173167 = prim_out_172504;
    
  cleanup:
    { }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15620(struct futhark_context *ctx, struct memblock *mem_out_p_173168, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80196, int64_t n_80197, int32_t n_bits_80198, int64_t psizze_80199)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_172501;
    
    mem_param_tmp_172501.references = NULL;
    
    struct memblock mem_171825;
    
    mem_171825.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171834;
    
    ext_mem_171834.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t zm_lhs_80203 = add32(8, n_bits_80198);
    int32_t zs_lhs_80205 = sub32(zm_lhs_80203, 1);
    int32_t i32_arg0_80210 = sdiv32(zs_lhs_80205, 8);
    int64_t i32_res_152736 = sext_i32_i64(i32_arg0_80210);
    bool zzero_80214 = i32_res_152736 == (int64_t) 0;
    bool nonzzero_80215 = !zzero_80214;
    bool nonzzero_cert_80216;
    
    if (!nonzzero_80215) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80217 = sdiv64(psizze_80199, i32_res_152736);
    int64_t max_res_152739 = smax64((int64_t) 1, max_arg1_80217);
    int64_t zm_lhs_80221 = add64(n_80197, max_res_152739);
    int64_t zs_lhs_80223 = sub64(zm_lhs_80221, (int64_t) 1);
    bool zzero_80225 = max_res_152739 == (int64_t) 0;
    bool nonzzero_80226 = !zzero_80225;
    bool nonzzero_cert_80227;
    
    if (!nonzzero_80226) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80228 = sdiv64(zs_lhs_80223, max_res_152739);
    bool bounds_invalid_upwards_152741 = slt64(max_iter_80228, (int64_t) 0);
    bool valid_152742 = !bounds_invalid_upwards_152741;
    bool range_valid_c_152743;
    
    if (!valid_152742) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80228, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 2 * ni_80196;
    
    if (memblock_set(ctx, &mem_param_171823, &dest_mem_171818, "dest_mem_171818") != 0)
        return 1;
    for (int64_t i_80232 = 0; i_80232 < max_iter_80228; i_80232++) {
        int64_t inf_80235 = mul64(i_80232, max_res_152739);
        int64_t min_arg1_80237 = add64(inf_80235, max_res_152739);
        int64_t min_res_152977 = smin64(n_80197, min_arg1_80237);
        
        if (memblock_alloc(ctx, &mem_171825, bytes_171824, "mem_171825")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < ni_80196; i_171547++) {
            int64_t eta_p_153106 = ((int64_t *) is_mem_171820.mem)[i_171547];
            int16_t eta_p_153107 = ((int16_t *) mem_param_171823.mem)[i_171547];
            bool cond_153108 = sle64(inf_80235, eta_p_153106);
            bool cond_t_res_153109 = slt64(eta_p_153106, min_res_152977);
            bool x_153110 = cond_153108 && cond_t_res_153109;
            int16_t lifted_lambda_res_153111;
            
            if (x_153110) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153106);
                bool y_162515 = slt64(eta_p_153106, n_80197);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153106, "] out of bounds for array of shape [", (long long) n_80197, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int16_t lifted_lambda_res_t_res_162518 = ((int16_t *) xs_mem_171819.mem)[eta_p_153106];
                
                lifted_lambda_res_153111 = lifted_lambda_res_t_res_162518;
            } else {
                lifted_lambda_res_153111 = eta_p_153107;
            }
            ((int16_t *) mem_171825.mem)[i_171547] = lifted_lambda_res_153111;
        }
        if (memblock_set(ctx, &mem_param_tmp_172501, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171834, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171834, "ext_mem_171834") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173168, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171834, "ext_mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15632(struct futhark_context *ctx, struct memblock *mem_out_p_173169, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80448, int64_t n_80449, int32_t n_bits_80450, int64_t psizze_80451)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_172501;
    
    mem_param_tmp_172501.references = NULL;
    
    struct memblock mem_171825;
    
    mem_171825.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171834;
    
    ext_mem_171834.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t zm_lhs_80455 = add32(8, n_bits_80450);
    int32_t zs_lhs_80457 = sub32(zm_lhs_80455, 1);
    int32_t i32_arg0_80462 = sdiv32(zs_lhs_80457, 8);
    int64_t i32_res_152736 = sext_i32_i64(i32_arg0_80462);
    bool zzero_80466 = i32_res_152736 == (int64_t) 0;
    bool nonzzero_80467 = !zzero_80466;
    bool nonzzero_cert_80468;
    
    if (!nonzzero_80467) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80469 = sdiv64(psizze_80451, i32_res_152736);
    int64_t max_res_152739 = smax64((int64_t) 1, max_arg1_80469);
    int64_t zm_lhs_80473 = add64(n_80449, max_res_152739);
    int64_t zs_lhs_80475 = sub64(zm_lhs_80473, (int64_t) 1);
    bool zzero_80477 = max_res_152739 == (int64_t) 0;
    bool nonzzero_80478 = !zzero_80477;
    bool nonzzero_cert_80479;
    
    if (!nonzzero_80478) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80480 = sdiv64(zs_lhs_80475, max_res_152739);
    bool bounds_invalid_upwards_152741 = slt64(max_iter_80480, (int64_t) 0);
    bool valid_152742 = !bounds_invalid_upwards_152741;
    bool range_valid_c_152743;
    
    if (!valid_152742) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80480, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 4 * ni_80448;
    
    if (memblock_set(ctx, &mem_param_171823, &dest_mem_171818, "dest_mem_171818") != 0)
        return 1;
    for (int64_t i_80484 = 0; i_80484 < max_iter_80480; i_80484++) {
        int64_t inf_80487 = mul64(i_80484, max_res_152739);
        int64_t min_arg1_80489 = add64(inf_80487, max_res_152739);
        int64_t min_res_152977 = smin64(n_80449, min_arg1_80489);
        
        if (memblock_alloc(ctx, &mem_171825, bytes_171824, "mem_171825")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < ni_80448; i_171547++) {
            int64_t eta_p_153106 = ((int64_t *) is_mem_171820.mem)[i_171547];
            int32_t eta_p_153107 = ((int32_t *) mem_param_171823.mem)[i_171547];
            bool cond_153108 = sle64(inf_80487, eta_p_153106);
            bool cond_t_res_153109 = slt64(eta_p_153106, min_res_152977);
            bool x_153110 = cond_153108 && cond_t_res_153109;
            int32_t lifted_lambda_res_153111;
            
            if (x_153110) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153106);
                bool y_162515 = slt64(eta_p_153106, n_80449);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153106, "] out of bounds for array of shape [", (long long) n_80449, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int32_t lifted_lambda_res_t_res_162518 = ((int32_t *) xs_mem_171819.mem)[eta_p_153106];
                
                lifted_lambda_res_153111 = lifted_lambda_res_t_res_162518;
            } else {
                lifted_lambda_res_153111 = eta_p_153107;
            }
            ((int32_t *) mem_171825.mem)[i_171547] = lifted_lambda_res_153111;
        }
        if (memblock_set(ctx, &mem_param_tmp_172501, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171834, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171834, "ext_mem_171834") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173169, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171834, "ext_mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15643(struct futhark_context *ctx, struct memblock *mem_out_p_173170, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80700, int64_t n_80701, int32_t n_bits_80702, int64_t psizze_80703)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_172501;
    
    mem_param_tmp_172501.references = NULL;
    
    struct memblock mem_171825;
    
    mem_171825.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171834;
    
    ext_mem_171834.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t zm_lhs_80707 = add32(8, n_bits_80702);
    int32_t zs_lhs_80709 = sub32(zm_lhs_80707, 1);
    int32_t i32_arg0_80714 = sdiv32(zs_lhs_80709, 8);
    int64_t i32_res_152736 = sext_i32_i64(i32_arg0_80714);
    bool zzero_80718 = i32_res_152736 == (int64_t) 0;
    bool nonzzero_80719 = !zzero_80718;
    bool nonzzero_cert_80720;
    
    if (!nonzzero_80719) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80721 = sdiv64(psizze_80703, i32_res_152736);
    int64_t max_res_152739 = smax64((int64_t) 1, max_arg1_80721);
    int64_t zm_lhs_80725 = add64(n_80701, max_res_152739);
    int64_t zs_lhs_80727 = sub64(zm_lhs_80725, (int64_t) 1);
    bool zzero_80729 = max_res_152739 == (int64_t) 0;
    bool nonzzero_80730 = !zzero_80729;
    bool nonzzero_cert_80731;
    
    if (!nonzzero_80730) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80732 = sdiv64(zs_lhs_80727, max_res_152739);
    bool bounds_invalid_upwards_152741 = slt64(max_iter_80732, (int64_t) 0);
    bool valid_152742 = !bounds_invalid_upwards_152741;
    bool range_valid_c_152743;
    
    if (!valid_152742) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80732, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 8 * ni_80700;
    
    if (memblock_set(ctx, &mem_param_171823, &dest_mem_171818, "dest_mem_171818") != 0)
        return 1;
    for (int64_t i_80736 = 0; i_80736 < max_iter_80732; i_80736++) {
        int64_t inf_80739 = mul64(i_80736, max_res_152739);
        int64_t min_arg1_80741 = add64(inf_80739, max_res_152739);
        int64_t min_res_152977 = smin64(n_80701, min_arg1_80741);
        
        if (memblock_alloc(ctx, &mem_171825, bytes_171824, "mem_171825")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < ni_80700; i_171547++) {
            int64_t eta_p_153106 = ((int64_t *) is_mem_171820.mem)[i_171547];
            int64_t eta_p_153107 = ((int64_t *) mem_param_171823.mem)[i_171547];
            bool cond_153108 = sle64(inf_80739, eta_p_153106);
            bool cond_t_res_153109 = slt64(eta_p_153106, min_res_152977);
            bool x_153110 = cond_153108 && cond_t_res_153109;
            int64_t lifted_lambda_res_153111;
            
            if (x_153110) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153106);
                bool y_162515 = slt64(eta_p_153106, n_80701);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153106, "] out of bounds for array of shape [", (long long) n_80701, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                int64_t lifted_lambda_res_t_res_162518 = ((int64_t *) xs_mem_171819.mem)[eta_p_153106];
                
                lifted_lambda_res_153111 = lifted_lambda_res_t_res_162518;
            } else {
                lifted_lambda_res_153111 = eta_p_153107;
            }
            ((int64_t *) mem_171825.mem)[i_171547] = lifted_lambda_res_153111;
        }
        if (memblock_set(ctx, &mem_param_tmp_172501, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171834, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171834, "ext_mem_171834") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173170, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171834, "ext_mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15655(struct futhark_context *ctx, struct memblock *mem_out_p_173171, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_80952, int64_t n_80953, int32_t n_bits_80954, int64_t psizze_80955)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_172501;
    
    mem_param_tmp_172501.references = NULL;
    
    struct memblock mem_171825;
    
    mem_171825.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171834;
    
    ext_mem_171834.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t zm_lhs_80959 = add32(8, n_bits_80954);
    int32_t zs_lhs_80961 = sub32(zm_lhs_80959, 1);
    int32_t i32_arg0_80966 = sdiv32(zs_lhs_80961, 8);
    int64_t i32_res_152736 = sext_i32_i64(i32_arg0_80966);
    bool zzero_80970 = i32_res_152736 == (int64_t) 0;
    bool nonzzero_80971 = !zzero_80970;
    bool nonzzero_cert_80972;
    
    if (!nonzzero_80971) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_80973 = sdiv64(psizze_80955, i32_res_152736);
    int64_t max_res_152739 = smax64((int64_t) 1, max_arg1_80973);
    int64_t zm_lhs_80977 = add64(n_80953, max_res_152739);
    int64_t zs_lhs_80979 = sub64(zm_lhs_80977, (int64_t) 1);
    bool zzero_80981 = max_res_152739 == (int64_t) 0;
    bool nonzzero_80982 = !zzero_80981;
    bool nonzzero_cert_80983;
    
    if (!nonzzero_80982) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_80984 = sdiv64(zs_lhs_80979, max_res_152739);
    bool bounds_invalid_upwards_152741 = slt64(max_iter_80984, (int64_t) 0);
    bool valid_152742 = !bounds_invalid_upwards_152741;
    bool range_valid_c_152743;
    
    if (!valid_152742) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_80984, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 4 * ni_80952;
    
    if (memblock_set(ctx, &mem_param_171823, &dest_mem_171818, "dest_mem_171818") != 0)
        return 1;
    for (int64_t i_80988 = 0; i_80988 < max_iter_80984; i_80988++) {
        int64_t inf_80991 = mul64(i_80988, max_res_152739);
        int64_t min_arg1_80993 = add64(inf_80991, max_res_152739);
        int64_t min_res_152977 = smin64(n_80953, min_arg1_80993);
        
        if (memblock_alloc(ctx, &mem_171825, bytes_171824, "mem_171825")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < ni_80952; i_171547++) {
            int64_t eta_p_153106 = ((int64_t *) is_mem_171820.mem)[i_171547];
            float eta_p_153107 = ((float *) mem_param_171823.mem)[i_171547];
            bool cond_153108 = sle64(inf_80991, eta_p_153106);
            bool cond_t_res_153109 = slt64(eta_p_153106, min_res_152977);
            bool x_153110 = cond_153108 && cond_t_res_153109;
            float lifted_lambda_res_153111;
            
            if (x_153110) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153106);
                bool y_162515 = slt64(eta_p_153106, n_80953);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153106, "] out of bounds for array of shape [", (long long) n_80953, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                float lifted_lambda_res_t_res_162518 = ((float *) xs_mem_171819.mem)[eta_p_153106];
                
                lifted_lambda_res_153111 = lifted_lambda_res_t_res_162518;
            } else {
                lifted_lambda_res_153111 = eta_p_153107;
            }
            ((float *) mem_171825.mem)[i_171547] = lifted_lambda_res_153111;
        }
        if (memblock_set(ctx, &mem_param_tmp_172501, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171834, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171834, "ext_mem_171834") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173171, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171834, "ext_mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_partitioned_gather_over_array_15667(struct futhark_context *ctx, struct memblock *mem_out_p_173172, struct memblock dest_mem_171818, struct memblock xs_mem_171819, struct memblock is_mem_171820, int64_t ni_81204, int64_t n_81205, int32_t n_bits_81206, int64_t psizze_81207)
{
    (void) ctx;
    
    int err = 0;
    struct memblock mem_param_tmp_172501;
    
    mem_param_tmp_172501.references = NULL;
    
    struct memblock mem_171825;
    
    mem_171825.references = NULL;
    
    struct memblock mem_param_171823;
    
    mem_param_171823.references = NULL;
    
    struct memblock ext_mem_171834;
    
    ext_mem_171834.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    int32_t zm_lhs_81211 = add32(8, n_bits_81206);
    int32_t zs_lhs_81213 = sub32(zm_lhs_81211, 1);
    int32_t i32_arg0_81218 = sdiv32(zs_lhs_81213, 8);
    int64_t i32_res_152736 = sext_i32_i64(i32_arg0_81218);
    bool zzero_81222 = i32_res_152736 == (int64_t) 0;
    bool nonzzero_81223 = !zzero_81222;
    bool nonzzero_cert_81224;
    
    if (!nonzzero_81223) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:26:33-80\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_arg1_81225 = sdiv64(psizze_81207, i32_res_152736);
    int64_t max_res_152739 = smax64((int64_t) 1, max_arg1_81225);
    int64_t zm_lhs_81229 = add64(n_81205, max_res_152739);
    int64_t zs_lhs_81231 = sub64(zm_lhs_81229, (int64_t) 1);
    bool zzero_81233 = max_res_152739 == (int64_t) 0;
    bool nonzzero_81234 = !zzero_81233;
    bool nonzzero_cert_81235;
    
    if (!nonzzero_81234) {
        set_error(ctx, msgprintf("Error: %s\n\nBacktrace:\n%s", "division by zero", "-> #0  ftbasics.fut:27:31-39\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t max_iter_81236 = sdiv64(zs_lhs_81231, max_res_152739);
    bool bounds_invalid_upwards_152741 = slt64(max_iter_81236, (int64_t) 0);
    bool valid_152742 = !bounds_invalid_upwards_152741;
    bool range_valid_c_152743;
    
    if (!valid_152742) {
        set_error(ctx, msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s", "Range ", (long long) (int64_t) 0, "..", (long long) (int64_t) 1, "..<", (long long) max_iter_81236, " is invalid.", "-> #0  /prelude/array.fut:94:3-11\n   #1  ftbasics.fut:28:33-46\n"));
        err = FUTHARK_PROGRAM_ERROR;
        goto cleanup;
    }
    
    int64_t bytes_171824 = (int64_t) 8 * ni_81204;
    
    if (memblock_set(ctx, &mem_param_171823, &dest_mem_171818, "dest_mem_171818") != 0)
        return 1;
    for (int64_t i_81240 = 0; i_81240 < max_iter_81236; i_81240++) {
        int64_t inf_81243 = mul64(i_81240, max_res_152739);
        int64_t min_arg1_81245 = add64(inf_81243, max_res_152739);
        int64_t min_res_152977 = smin64(n_81205, min_arg1_81245);
        
        if (memblock_alloc(ctx, &mem_171825, bytes_171824, "mem_171825")) {
            err = 1;
            goto cleanup;
        }
        for (int64_t i_171547 = 0; i_171547 < ni_81204; i_171547++) {
            int64_t eta_p_153106 = ((int64_t *) is_mem_171820.mem)[i_171547];
            double eta_p_153107 = ((double *) mem_param_171823.mem)[i_171547];
            bool cond_153108 = sle64(inf_81243, eta_p_153106);
            bool cond_t_res_153109 = slt64(eta_p_153106, min_res_152977);
            bool x_153110 = cond_153108 && cond_t_res_153109;
            double lifted_lambda_res_153111;
            
            if (x_153110) {
                bool x_162514 = sle64((int64_t) 0, eta_p_153106);
                bool y_162515 = slt64(eta_p_153106, n_81205);
                bool bounds_check_162516 = x_162514 && y_162515;
                bool index_certs_162517;
                
                if (!bounds_check_162516) {
                    set_error(ctx, msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s", "Index [", (long long) eta_p_153106, "] out of bounds for array of shape [", (long long) n_81205, "].", "-> #0  ftbasics.fut:35:14-19\n   #1  /prelude/functional.fut:9:44-45\n   #2  ftbasics.fut:33:10-37:8\n"));
                    err = FUTHARK_PROGRAM_ERROR;
                    goto cleanup;
                }
                
                double lifted_lambda_res_t_res_162518 = ((double *) xs_mem_171819.mem)[eta_p_153106];
                
                lifted_lambda_res_153111 = lifted_lambda_res_t_res_162518;
            } else {
                lifted_lambda_res_153111 = eta_p_153107;
            }
            ((double *) mem_171825.mem)[i_171547] = lifted_lambda_res_153111;
        }
        if (memblock_set(ctx, &mem_param_tmp_172501, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_set(ctx, &mem_param_171823, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
    }
    if (memblock_set(ctx, &ext_mem_171834, &mem_param_171823, "mem_param_171823") != 0)
        return 1;
    if (memblock_set(ctx, &mem_out_172500, &ext_mem_171834, "ext_mem_171834") != 0)
        return 1;
    if (memblock_set(ctx, &*mem_out_p_173172, &mem_out_172500, "mem_out_172500") != 0)
        return 1;
    
  cleanup:
    {
        if (memblock_unref(ctx, &mem_param_tmp_172501, "mem_param_tmp_172501") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_171825, "mem_171825") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_param_171823, "mem_param_171823") != 0)
            return 1;
        if (memblock_unref(ctx, &ext_mem_171834, "ext_mem_171834") != 0)
            return 1;
        if (memblock_unref(ctx, &mem_out_172500, "mem_out_172500") != 0)
            return 1;
    }
    return err;
}
FUTHARK_FUN_ATTR int futrts_set_bit_2464(struct futhark_context *ctx, int8_t *out_prim_out_173173, int32_t bit_82355, int8_t x_82356, int32_t b_82357)
{
    (void) ctx;
    
    int err = 0;
    int8_t prim_out_172500;
    int32_t i32_arg0_82358 = shl32(1, bit_82355);
    int32_t i32_arg_82360 = ~i32_arg0_82358;
    int8_t unsign_arg0_152976 = zext_i32_i8(i32_arg_82360);
    int8_t unsign_arg0_162320 = x_82356 & unsign_arg0_152976;
    int32_t i32_arg0_82365 = shl32(b_82357, bit_82355);
    int8_t unsign_arg0_152978 = zext_i32_i8(i32_arg0_82365);
    int8_t unsign_arg0_162323 = unsign_arg0_152978 | unsign_arg0_162320;
    
    prim_out_172500 = unsign_arg0_162323;
    *out_prim_out_173173 = prim_out_172500;
    
  cleanup:
    { }
    return err;
}

int futhark_entry_Inner_Radix_Hash_Join(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_141120 = (int64_t) 0;
    int64_t b_141121 = (int64_t) 0;
    int64_t nS_141122 = (int64_t) 0;
    int64_t dz2081U_141123 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124 = (int64_t) 0;
    int32_t radix_sizze_141125 = 0;
    int32_t maxDepth_141130 = 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock last_info_idx_mem_171823;
    
    last_info_idx_mem_171823.references = NULL;
    
    struct memblock first_info_idx_mem_171822;
    
    first_info_idx_mem_171822.references = NULL;
    
    struct memblock depths_mem_171821;
    
    depths_mem_171821.references = NULL;
    
    struct memblock bounds_mem_171820;
    
    bounds_mem_171820.references = NULL;
    
    struct memblock pS_mem_171819;
    
    pS_mem_171819.references = NULL;
    
    struct memblock pR_mem_171818;
    
    pR_mem_171818.references = NULL;
    radix_sizze_141125 = in0;
    pR_mem_171818 = in1->mem;
    nR_141120 = in1->shape[0];
    b_141121 = in1->shape[1];
    pS_mem_171819 = in2->mem;
    nS_141122 = in2->shape[0];
    b_141121 = in2->shape[1];
    bounds_mem_171820 = in3->v0->mem;
    dz2081U_141123 = in3->v0->shape[0];
    depths_mem_171821 = in3->v1->mem;
    dz2081U_141123 = in3->v1->shape[0];
    maxDepth_141130 = in3->v2;
    first_info_idx_mem_171822 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124 = in4->v0->shape[0];
    last_info_idx_mem_171823 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124 = in4->v1->shape[0];
    if (!((nR_141120 == in1->shape[0] && b_141121 == in1->shape[1]) && ((nS_141122 == in2->shape[0] && b_141121 == in2->shape[1]) && ((dz2081U_141123 == in3->v0->shape[0] && dz2081U_141123 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, pR_mem_171818, pS_mem_171819, bounds_mem_171820, depths_mem_171821, first_info_idx_mem_171822, last_info_idx_mem_171823, nR_141120, b_141121, nS_141122, dz2081U_141123, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_141124, radix_sizze_141125, maxDepth_141130);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
            (*out0)->v2->shape[1] = b_141121;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_Inner_Radix_Hash_Join_with_right_keys_unique(struct futhark_context *ctx, struct futhark_opaque_joinPairs_bsq **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_u8_2d *in2, const struct futhark_opaque_partitionInfo *in3, const struct futhark_opaque_radix_hashTable *in4)
{
    int64_t nR_143593 = (int64_t) 0;
    int64_t b_143594 = (int64_t) 0;
    int64_t nS_143595 = (int64_t) 0;
    int64_t dz2081U_143596 = (int64_t) 0;
    int64_t dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597 = (int64_t) 0;
    int32_t radix_sizze_143598 = 0;
    int32_t maxDepth_143603 = 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock last_info_idx_mem_171823;
    
    last_info_idx_mem_171823.references = NULL;
    
    struct memblock first_info_idx_mem_171822;
    
    first_info_idx_mem_171822.references = NULL;
    
    struct memblock depths_mem_171821;
    
    depths_mem_171821.references = NULL;
    
    struct memblock bounds_mem_171820;
    
    bounds_mem_171820.references = NULL;
    
    struct memblock pS_mem_171819;
    
    pS_mem_171819.references = NULL;
    
    struct memblock pR_mem_171818;
    
    pR_mem_171818.references = NULL;
    radix_sizze_143598 = in0;
    pR_mem_171818 = in1->mem;
    nR_143593 = in1->shape[0];
    b_143594 = in1->shape[1];
    pS_mem_171819 = in2->mem;
    nS_143595 = in2->shape[0];
    b_143594 = in2->shape[1];
    bounds_mem_171820 = in3->v0->mem;
    dz2081U_143596 = in3->v0->shape[0];
    depths_mem_171821 = in3->v1->mem;
    dz2081U_143596 = in3->v1->shape[0];
    maxDepth_143603 = in3->v2;
    first_info_idx_mem_171822 = in4->v0->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597 = in4->v0->shape[0];
    last_info_idx_mem_171823 = in4->v1->mem;
    dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597 = in4->v1->shape[0];
    if (!((nR_143593 == in1->shape[0] && b_143594 == in1->shape[1]) && ((nS_143595 == in2->shape[0] && b_143594 == in2->shape[1]) && ((dz2081U_143596 == in3->v0->shape[0] && dz2081U_143596 == in3->v1->shape[0]) && (dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597 == in4->v0->shape[0] && dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597 == in4->v1->shape[0]))))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_Inner_Radix_Hash_Join_with_right_keys_unique(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, pR_mem_171818, pS_mem_171819, bounds_mem_171820, depths_mem_171821, first_info_idx_mem_171822, last_info_idx_mem_171823, nR_143593, b_143594, nS_143595, dz2081U_143596, dzlz7bUZLztztZRz20U2z20UZLi32z20Uradix_sizzeZRz7dUzg_143597, radix_sizze_143598, maxDepth_143603);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_bsq *) malloc(sizeof(struct futhark_opaque_joinPairs_bsq))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
            (*out0)->v2->shape[1] = b_143594;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2)
{
    int64_t group_noz2081U_152590 = (int64_t) 0;
    int64_t nz2080U_152591 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_152590 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_152590 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_152591 = in2->shape[0];
    if (!(group_noz2081U_152590 == in0->shape[0] && (group_noz2081U_152590 == in1->shape[0] && nz2080U_152591 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_double_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, group_noz2081U_152590, nz2080U_152591);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_152590;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t group_noz2081U_152657 = (int64_t) 0;
    int64_t nz2080U_152658 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171821;
    
    eta_p_mem_171821.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_152657 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_152657 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_152658 = in2->shape[0];
    eta_p_mem_171821 = in3->mem;
    nz2080U_152658 = in3->shape[0];
    if (!(group_noz2081U_152657 == in0->shape[0] && (group_noz2081U_152657 == in1->shape[0] && (nz2080U_152658 == in2->shape[0] && nz2080U_152658 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_double_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, eta_p_mem_171821, group_noz2081U_152657, nz2080U_152658);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_152657;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2)
{
    int64_t group_noz2081U_152149 = (int64_t) 0;
    int64_t nz2080U_152150 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_152149 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_152149 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_152150 = in2->shape[0];
    if (!(group_noz2081U_152149 == in0->shape[0] && (group_noz2081U_152149 == in1->shape[0] && nz2080U_152150 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_float_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, group_noz2081U_152149, nz2080U_152150);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_152149;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t group_noz2081U_152216 = (int64_t) 0;
    int64_t nz2080U_152217 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171821;
    
    eta_p_mem_171821.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_152216 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_152216 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_152217 = in2->shape[0];
    eta_p_mem_171821 = in3->mem;
    nz2080U_152217 = in3->shape[0];
    if (!(group_noz2081U_152216 == in0->shape[0] && (group_noz2081U_152216 == in1->shape[0] && (nz2080U_152217 == in2->shape[0] && nz2080U_152217 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_float_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, eta_p_mem_171821, group_noz2081U_152216, nz2080U_152217);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_152216;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t group_noz2081U_151276 = (int64_t) 0;
    int64_t nz2080U_151277 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_151276 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_151276 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_151277 = in2->shape[0];
    if (!(group_noz2081U_151276 == in0->shape[0] && (group_noz2081U_151276 == in1->shape[0] && nz2080U_151277 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_int_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, group_noz2081U_151276, nz2080U_151277);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_151276;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t group_noz2081U_151343 = (int64_t) 0;
    int64_t nz2080U_151344 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171821;
    
    eta_p_mem_171821.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_151343 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_151343 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_151344 = in2->shape[0];
    eta_p_mem_171821 = in3->mem;
    nz2080U_151344 = in3->shape[0];
    if (!(group_noz2081U_151343 == in0->shape[0] && (group_noz2081U_151343 == in1->shape[0] && (nz2080U_151344 == in2->shape[0] && nz2080U_151344 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_int_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, eta_p_mem_171821, group_noz2081U_151343, nz2080U_151344);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_151343;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2)
{
    int64_t group_noz2081U_151708 = (int64_t) 0;
    int64_t nz2080U_151709 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_151708 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_151708 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_151709 = in2->shape[0];
    if (!(group_noz2081U_151708 == in0->shape[0] && (group_noz2081U_151708 == in1->shape[0] && nz2080U_151709 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_long_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, group_noz2081U_151708, nz2080U_151709);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_151708;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t group_noz2081U_151775 = (int64_t) 0;
    int64_t nz2080U_151776 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171821;
    
    eta_p_mem_171821.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_151775 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_151775 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_151776 = in2->shape[0];
    eta_p_mem_171821 = in3->mem;
    nz2080U_151776 = in3->shape[0];
    if (!(group_noz2081U_151775 == in0->shape[0] && (group_noz2081U_151775 == in1->shape[0] && (nz2080U_151776 == in2->shape[0] && nz2080U_151776 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_long_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, eta_p_mem_171821, group_noz2081U_151775, nz2080U_151776);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_151775;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2)
{
    int64_t group_noz2081U_150844 = (int64_t) 0;
    int64_t nz2080U_150845 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_150844 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_150844 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_150845 = in2->shape[0];
    if (!(group_noz2081U_150844 == in0->shape[0] && (group_noz2081U_150844 == in1->shape[0] && nz2080U_150845 == in2->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_short_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, group_noz2081U_150844, nz2080U_150845);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_150844;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_alt_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t group_noz2081U_150911 = (int64_t) 0;
    int64_t nz2080U_150912 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171821;
    
    eta_p_mem_171821.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    group_noz2081U_150911 = in0->shape[0];
    eta_p_mem_171819 = in1->mem;
    group_noz2081U_150911 = in1->shape[0];
    eta_p_mem_171820 = in2->mem;
    nz2080U_150912 = in2->shape[0];
    eta_p_mem_171821 = in3->mem;
    nz2080U_150912 = in3->shape[0];
    if (!(group_noz2081U_150911 == in0->shape[0] && (group_noz2081U_150911 == in1->shape[0] && (nz2080U_150912 == in2->shape[0] && nz2080U_150912 == in3->shape[0])))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_alt_short_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, eta_p_mem_171821, group_noz2081U_150911, nz2080U_150912);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_noz2081U_150911;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_double(struct futhark_context *ctx, int64_t *out0, const struct futhark_f64_1d *in0)
{
    int64_t n_79709 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    n_79709 = in0->shape[0];
    if (!(n_79709 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_double(ctx, &prim_out_172500, ks_mem_171818, n_79709);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_float(struct futhark_context *ctx, int64_t *out0, const struct futhark_f32_1d *in0)
{
    int64_t n_79532 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    n_79532 = in0->shape[0];
    if (!(n_79532 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_float(ctx, &prim_out_172500, ks_mem_171818, n_79532);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_int(struct futhark_context *ctx, int64_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t n_79181 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    n_79181 = in0->shape[0];
    if (!(n_79181 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_int(ctx, &prim_out_172500, ks_mem_171818, n_79181);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t n_79355 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    n_79355 = in0->shape[0];
    if (!(n_79355 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_long(ctx, &prim_out_172500, ks_mem_171818, n_79355);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_argmin_short(struct futhark_context *ctx, int64_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t n_79007 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    n_79007 = in0->shape[0];
    if (!(n_79007 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_argmin_short(ctx, &prim_out_172500, ks_mem_171818, n_79007);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_calc_partitions_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_partitionInfo **out0, const int32_t in0, const struct futhark_u8_2d *in1, const int64_t in2, const int64_t in3, const int32_t in4)
{
    int64_t n_132232 = (int64_t) 0;
    int64_t b_132233 = (int64_t) 0;
    int32_t radix_sizze_132234 = 0;
    int64_t offset_132236 = (int64_t) 0;
    int64_t sizze_thresh_132237 = (int64_t) 0;
    int32_t max_depth_132238 = 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int32_t prim_out_172503 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pXs_mem_171818;
    
    pXs_mem_171818.references = NULL;
    radix_sizze_132234 = in0;
    pXs_mem_171818 = in1->mem;
    n_132232 = in1->shape[0];
    b_132233 = in1->shape[1];
    offset_132236 = in2;
    sizze_thresh_132237 = in3;
    max_depth_132238 = in4;
    if (!(n_132232 == in1->shape[0] && b_132233 == in1->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_calc_partitions_from_partitioned_set(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, &prim_out_172503, pXs_mem_171818, n_132232, b_132233, radix_sizze_132234, offset_132236, sizze_thresh_132237, max_depth_132238);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionInfo *) malloc(sizeof(struct futhark_opaque_partitionInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
            (*out0)->v2 = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_create_hash_table_from_partitioned_set(struct futhark_context *ctx, struct futhark_opaque_radix_hashTable **out0, const int32_t in0, const struct futhark_u8_2d *in1, const struct futhark_opaque_partitionInfo *in2, const int64_t in3)
{
    int64_t n_132814 = (int64_t) 0;
    int64_t b_132815 = (int64_t) 0;
    int64_t dz2080U_132816 = (int64_t) 0;
    int64_t dz2081U_132817 = (int64_t) 0;
    int32_t radix_sizze_132818 = 0;
    int32_t maxDepth_132822 = 0;
    int64_t scatter_psizze_132823 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock depths_mem_171820;
    
    depths_mem_171820.references = NULL;
    
    struct memblock bounds_mem_171819;
    
    bounds_mem_171819.references = NULL;
    
    struct memblock pXs_mem_171818;
    
    pXs_mem_171818.references = NULL;
    radix_sizze_132818 = in0;
    pXs_mem_171818 = in1->mem;
    n_132814 = in1->shape[0];
    b_132815 = in1->shape[1];
    bounds_mem_171819 = in2->v0->mem;
    dz2080U_132816 = in2->v0->shape[0];
    depths_mem_171820 = in2->v1->mem;
    dz2081U_132817 = in2->v1->shape[0];
    maxDepth_132822 = in2->v2;
    scatter_psizze_132823 = in3;
    if (!((n_132814 == in1->shape[0] && b_132815 == in1->shape[1]) && (dz2080U_132816 == in2->v0->shape[0] && dz2081U_132817 == in2->v1->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_create_hash_table_from_partitioned_set(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, pXs_mem_171818, bounds_mem_171819, depths_mem_171820, n_132814, b_132815, dz2080U_132816, dz2081U_132817, radix_sizze_132818, maxDepth_132822, scatter_psizze_132823);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_radix_hashTable *) malloc(sizeof(struct futhark_opaque_radix_hashTable))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_double_sum(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2)
{
    int64_t nz2080U_150394 = (int64_t) 0;
    int64_t group_no_150395 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_150395 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_150394 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_150394 = in2->shape[0];
    if (!(nz2080U_150394 == in1->shape[0] && nz2080U_150394 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_double_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, nz2080U_150394, group_no_150395);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_150395;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_double_sum_xy(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t nz2080U_150471 = (int64_t) 0;
    int64_t group_no_150472 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_150472 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_150471 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_150471 = in2->shape[0];
    eta_p_mem_171820 = in3->mem;
    nz2080U_150471 = in3->shape[0];
    if (!(nz2080U_150471 == in1->shape[0] && (nz2080U_150471 == in2->shape[0] && nz2080U_150471 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_double_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, nz2080U_150471, group_no_150472);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_150472;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t nz2082U_143701 = (int64_t) 0;
    int64_t key_no_143702 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    key_no_143702 = in0;
    ks_mem_171818 = in1->mem;
    nz2082U_143701 = in1->shape[0];
    if (!(nz2082U_143701 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_find_known_key_counts_long(ctx, &mem_out_172500, ks_mem_171818, nz2082U_143701, key_no_143702);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = key_no_143702;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_float_sum(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2)
{
    int64_t nz2080U_150183 = (int64_t) 0;
    int64_t group_no_150184 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_150184 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_150183 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_150183 = in2->shape[0];
    if (!(nz2080U_150183 == in1->shape[0] && nz2080U_150183 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_float_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, nz2080U_150183, group_no_150184);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_150184;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_float_sum_xy(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_f32_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t nz2080U_150260 = (int64_t) 0;
    int64_t group_no_150261 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_150261 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_150260 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_150260 = in2->shape[0];
    eta_p_mem_171820 = in3->mem;
    nz2080U_150260 = in3->shape[0];
    if (!(nz2080U_150260 == in1->shape[0] && (nz2080U_150260 == in2->shape[0] && nz2080U_150260 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_float_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, nz2080U_150260, group_no_150261);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_150261;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_GFTR(struct futhark_context *ctx, struct futhark_u8_2d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const int64_t in3, const struct futhark_u8_2d *in4)
{
    int64_t niz2084U_82032 = (int64_t) 0;
    int64_t dz2083U_82033 = (int64_t) 0;
    int64_t incr_82034 = (int64_t) 0;
    int64_t psizze_82035 = (int64_t) 0;
    int64_t pL_bytes_82037 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_82034 = in0;
    psizze_82035 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_82032 = in2->shape[0];
    pL_bytes_82037 = in3;
    ys_mem_171819 = in4->mem;
    dz2083U_82033 = in4->shape[0];
    if (!(niz2084U_82032 == in2->shape[0] && (dz2083U_82033 == in4->shape[0] && pL_bytes_82037 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_GFTR(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_82032, dz2083U_82033, incr_82034, psizze_82035, pL_bytes_82037);
        if (ret == 0) {
            assert((*out0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_82032;
            (*out0)->shape[1] = pL_bytes_82037;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t niz2084U_81665 = (int64_t) 0;
    int64_t dz2083U_81666 = (int64_t) 0;
    int64_t incr_81667 = (int64_t) 0;
    int64_t psizze_81668 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81667 = in0;
    psizze_81668 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_81665 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    dz2083U_81666 = in3->shape[0];
    if (!(niz2084U_81665 == in2->shape[0] && dz2083U_81666 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_81665, dz2083U_81666, incr_81667, psizze_81668);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_81665;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_double_GFUR(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f64_1d *in4)
{
    int64_t ni_82320 = (int64_t) 0;
    int64_t n_82321 = (int64_t) 0;
    int64_t incr_82322 = (int64_t) 0;
    int64_t psizze_82323 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171820;
    
    ys_mem_171820.references = NULL;
    
    struct memblock is_mem_171819;
    
    is_mem_171819.references = NULL;
    
    struct memblock preVals_mem_171818;
    
    preVals_mem_171818.references = NULL;
    incr_82322 = in0;
    psizze_82323 = in1;
    preVals_mem_171818 = in2->mem;
    ni_82320 = in2->shape[0];
    is_mem_171819 = in3->mem;
    ni_82320 = in3->shape[0];
    ys_mem_171820 = in4->mem;
    n_82321 = in4->shape[0];
    if (!(ni_82320 == in2->shape[0] && (ni_82320 == in3->shape[0] && n_82321 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_double_GFUR(ctx, &mem_out_172500, preVals_mem_171818, is_mem_171819, ys_mem_171820, ni_82320, n_82321, incr_82322, psizze_82323);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = ni_82320;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t niz2084U_81600 = (int64_t) 0;
    int64_t dz2083U_81601 = (int64_t) 0;
    int64_t incr_81602 = (int64_t) 0;
    int64_t psizze_81603 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81602 = in0;
    psizze_81603 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_81600 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    dz2083U_81601 = in3->shape[0];
    if (!(niz2084U_81600 == in2->shape[0] && dz2083U_81601 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_81600, dz2083U_81601, incr_81602, psizze_81603);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_81600;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_float_GFUR(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_f32_1d *in4)
{
    int64_t ni_82263 = (int64_t) 0;
    int64_t n_82264 = (int64_t) 0;
    int64_t incr_82265 = (int64_t) 0;
    int64_t psizze_82266 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171820;
    
    ys_mem_171820.references = NULL;
    
    struct memblock is_mem_171819;
    
    is_mem_171819.references = NULL;
    
    struct memblock preVals_mem_171818;
    
    preVals_mem_171818.references = NULL;
    incr_82265 = in0;
    psizze_82266 = in1;
    preVals_mem_171818 = in2->mem;
    ni_82263 = in2->shape[0];
    is_mem_171819 = in3->mem;
    ni_82263 = in3->shape[0];
    ys_mem_171820 = in4->mem;
    n_82264 = in4->shape[0];
    if (!(ni_82263 == in2->shape[0] && (ni_82263 == in3->shape[0] && n_82264 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_float_GFUR(ctx, &mem_out_172500, preVals_mem_171818, is_mem_171819, ys_mem_171820, ni_82263, n_82264, incr_82265, psizze_82266);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = ni_82263;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t niz2084U_81470 = (int64_t) 0;
    int64_t dz2083U_81471 = (int64_t) 0;
    int64_t incr_81472 = (int64_t) 0;
    int64_t psizze_81473 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81472 = in0;
    psizze_81473 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_81470 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    dz2083U_81471 = in3->shape[0];
    if (!(niz2084U_81470 == in2->shape[0] && dz2083U_81471 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_81470, dz2083U_81471, incr_81472, psizze_81473);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_81470;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_int_GFUR(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i32_1d *in4)
{
    int64_t ni_82149 = (int64_t) 0;
    int64_t n_82150 = (int64_t) 0;
    int64_t incr_82151 = (int64_t) 0;
    int64_t psizze_82152 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171820;
    
    ys_mem_171820.references = NULL;
    
    struct memblock is_mem_171819;
    
    is_mem_171819.references = NULL;
    
    struct memblock preVals_mem_171818;
    
    preVals_mem_171818.references = NULL;
    incr_82151 = in0;
    psizze_82152 = in1;
    preVals_mem_171818 = in2->mem;
    ni_82149 = in2->shape[0];
    is_mem_171819 = in3->mem;
    ni_82149 = in3->shape[0];
    ys_mem_171820 = in4->mem;
    n_82150 = in4->shape[0];
    if (!(ni_82149 == in2->shape[0] && (ni_82149 == in3->shape[0] && n_82150 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_int_GFUR(ctx, &mem_out_172500, preVals_mem_171818, is_mem_171819, ys_mem_171820, ni_82149, n_82150, incr_82151, psizze_82152);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = ni_82149;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t niz2084U_81535 = (int64_t) 0;
    int64_t dz2083U_81536 = (int64_t) 0;
    int64_t incr_81537 = (int64_t) 0;
    int64_t psizze_81538 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81537 = in0;
    psizze_81538 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_81535 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    dz2083U_81536 = in3->shape[0];
    if (!(niz2084U_81535 == in2->shape[0] && dz2083U_81536 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_81535, dz2083U_81536, incr_81537, psizze_81538);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_81535;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_long_GFUR(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i64_1d *in4)
{
    int64_t ni_82206 = (int64_t) 0;
    int64_t n_82207 = (int64_t) 0;
    int64_t incr_82208 = (int64_t) 0;
    int64_t psizze_82209 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171820;
    
    ys_mem_171820.references = NULL;
    
    struct memblock is_mem_171819;
    
    is_mem_171819.references = NULL;
    
    struct memblock preVals_mem_171818;
    
    preVals_mem_171818.references = NULL;
    incr_82208 = in0;
    psizze_82209 = in1;
    preVals_mem_171818 = in2->mem;
    ni_82206 = in2->shape[0];
    is_mem_171819 = in3->mem;
    ni_82206 = in3->shape[0];
    ys_mem_171820 = in4->mem;
    n_82207 = in4->shape[0];
    if (!(ni_82206 == in2->shape[0] && (ni_82206 == in3->shape[0] && n_82207 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_long_GFUR(ctx, &mem_out_172500, preVals_mem_171818, is_mem_171819, ys_mem_171820, ni_82206, n_82207, incr_82208, psizze_82209);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = ni_82206;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t niz2084U_81405 = (int64_t) 0;
    int64_t dz2083U_81406 = (int64_t) 0;
    int64_t incr_81407 = (int64_t) 0;
    int64_t psizze_81408 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81407 = in0;
    psizze_81408 = in1;
    is_mem_171818 = in2->mem;
    niz2084U_81405 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    dz2083U_81406 = in3->shape[0];
    if (!(niz2084U_81405 == in2->shape[0] && dz2083U_81406 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, niz2084U_81405, dz2083U_81406, incr_81407, psizze_81408);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = niz2084U_81405;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_gather_payloads_short_GFUR(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2, const struct futhark_i64_1d *in3, const struct futhark_i16_1d *in4)
{
    int64_t ni_82092 = (int64_t) 0;
    int64_t n_82093 = (int64_t) 0;
    int64_t incr_82094 = (int64_t) 0;
    int64_t psizze_82095 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171820;
    
    ys_mem_171820.references = NULL;
    
    struct memblock is_mem_171819;
    
    is_mem_171819.references = NULL;
    
    struct memblock preVals_mem_171818;
    
    preVals_mem_171818.references = NULL;
    incr_82094 = in0;
    psizze_82095 = in1;
    preVals_mem_171818 = in2->mem;
    ni_82092 = in2->shape[0];
    is_mem_171819 = in3->mem;
    ni_82092 = in3->shape[0];
    ys_mem_171820 = in4->mem;
    n_82093 = in4->shape[0];
    if (!(ni_82092 == in2->shape[0] && (ni_82092 == in3->shape[0] && n_82093 == in4->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_gather_payloads_short_GFUR(ctx, &mem_out_172500, preVals_mem_171818, is_mem_171819, ys_mem_171820, ni_82092, n_82093, incr_82094, psizze_82095);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = ni_82092;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_double(struct futhark_context *ctx, struct futhark_opaque_joinPairs_double **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_127457 = (int64_t) 0;
    int64_t nS_127458 = (int64_t) 0;
    int64_t offset_R_127461 = (int64_t) 0;
    int64_t offset_S_127462 = (int64_t) 0;
    int64_t partitionSizze_127463 = (int64_t) 0;
    int64_t scatter_psizze_127464 = (int64_t) 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock tS_mem_171819;
    
    tS_mem_171819.references = NULL;
    
    struct memblock tR_mem_171818;
    
    tR_mem_171818.references = NULL;
    tR_mem_171818 = in0->mem;
    nR_127457 = in0->shape[0];
    tS_mem_171819 = in1->mem;
    nS_127458 = in1->shape[0];
    offset_R_127461 = in2;
    offset_S_127462 = in3;
    partitionSizze_127463 = in4;
    scatter_psizze_127464 = in5;
    if (!(nR_127457 == in0->shape[0] && nS_127458 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_double(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, tR_mem_171818, tS_mem_171819, nR_127457, nS_127458, offset_R_127461, offset_S_127462, partitionSizze_127463, scatter_psizze_127464);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_double *) malloc(sizeof(struct futhark_opaque_joinPairs_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_float(struct futhark_context *ctx, struct futhark_opaque_joinPairs_float **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_124794 = (int64_t) 0;
    int64_t nS_124795 = (int64_t) 0;
    int64_t offset_R_124798 = (int64_t) 0;
    int64_t offset_S_124799 = (int64_t) 0;
    int64_t partitionSizze_124800 = (int64_t) 0;
    int64_t scatter_psizze_124801 = (int64_t) 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock tS_mem_171819;
    
    tS_mem_171819.references = NULL;
    
    struct memblock tR_mem_171818;
    
    tR_mem_171818.references = NULL;
    tR_mem_171818 = in0->mem;
    nR_124794 = in0->shape[0];
    tS_mem_171819 = in1->mem;
    nS_124795 = in1->shape[0];
    offset_R_124798 = in2;
    offset_S_124799 = in3;
    partitionSizze_124800 = in4;
    scatter_psizze_124801 = in5;
    if (!(nR_124794 == in0->shape[0] && nS_124795 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_float(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, tR_mem_171818, tS_mem_171819, nR_124794, nS_124795, offset_R_124798, offset_S_124799, partitionSizze_124800, scatter_psizze_124801);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_float *) malloc(sizeof(struct futhark_opaque_joinPairs_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_int(struct futhark_context *ctx, struct futhark_opaque_joinPairs_int **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_119480 = (int64_t) 0;
    int64_t nS_119481 = (int64_t) 0;
    int64_t offset_R_119484 = (int64_t) 0;
    int64_t offset_S_119485 = (int64_t) 0;
    int64_t partitionSizze_119486 = (int64_t) 0;
    int64_t scatter_psizze_119487 = (int64_t) 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock tS_mem_171819;
    
    tS_mem_171819.references = NULL;
    
    struct memblock tR_mem_171818;
    
    tR_mem_171818.references = NULL;
    tR_mem_171818 = in0->mem;
    nR_119480 = in0->shape[0];
    tS_mem_171819 = in1->mem;
    nS_119481 = in1->shape[0];
    offset_R_119484 = in2;
    offset_S_119485 = in3;
    partitionSizze_119486 = in4;
    scatter_psizze_119487 = in5;
    if (!(nR_119480 == in0->shape[0] && nS_119481 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_int(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, tR_mem_171818, tS_mem_171819, nR_119480, nS_119481, offset_R_119484, offset_S_119485, partitionSizze_119486, scatter_psizze_119487);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_int *) malloc(sizeof(struct futhark_opaque_joinPairs_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_long(struct futhark_context *ctx, struct futhark_opaque_joinPairs_long **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_122131 = (int64_t) 0;
    int64_t nS_122132 = (int64_t) 0;
    int64_t offset_R_122135 = (int64_t) 0;
    int64_t offset_S_122136 = (int64_t) 0;
    int64_t partitionSizze_122137 = (int64_t) 0;
    int64_t scatter_psizze_122138 = (int64_t) 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock tS_mem_171819;
    
    tS_mem_171819.references = NULL;
    
    struct memblock tR_mem_171818;
    
    tR_mem_171818.references = NULL;
    tR_mem_171818 = in0->mem;
    nR_122131 = in0->shape[0];
    tS_mem_171819 = in1->mem;
    nS_122132 = in1->shape[0];
    offset_R_122135 = in2;
    offset_S_122136 = in3;
    partitionSizze_122137 = in4;
    scatter_psizze_122138 = in5;
    if (!(nR_122131 == in0->shape[0] && nS_122132 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_long(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, tR_mem_171818, tS_mem_171819, nR_122131, nS_122132, offset_R_122135, offset_S_122136, partitionSizze_122137, scatter_psizze_122138);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_long *) malloc(sizeof(struct futhark_opaque_joinPairs_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_inner_SMJ_short(struct futhark_context *ctx, struct futhark_opaque_joinPairs_short **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1, const int64_t in2, const int64_t in3, const int64_t in4, const int64_t in5)
{
    int64_t nR_116817 = (int64_t) 0;
    int64_t nS_116818 = (int64_t) 0;
    int64_t offset_R_116821 = (int64_t) 0;
    int64_t offset_S_116822 = (int64_t) 0;
    int64_t partitionSizze_116823 = (int64_t) 0;
    int64_t scatter_psizze_116824 = (int64_t) 0;
    int64_t prim_out_172503 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172502;
    
    mem_out_172502.references = NULL;
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock tS_mem_171819;
    
    tS_mem_171819.references = NULL;
    
    struct memblock tR_mem_171818;
    
    tR_mem_171818.references = NULL;
    tR_mem_171818 = in0->mem;
    nR_116817 = in0->shape[0];
    tS_mem_171819 = in1->mem;
    nS_116818 = in1->shape[0];
    offset_R_116821 = in2;
    offset_S_116822 = in3;
    partitionSizze_116823 = in4;
    scatter_psizze_116824 = in5;
    if (!(nR_116817 == in0->shape[0] && nS_116818 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_inner_SMJ_short(ctx, &mem_out_172500, &mem_out_172501, &mem_out_172502, &prim_out_172503, tR_mem_171818, tS_mem_171819, nR_116817, nS_116818, offset_R_116821, offset_S_116822, partitionSizze_116823, scatter_psizze_116824);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_joinPairs_short *) malloc(sizeof(struct futhark_opaque_joinPairs_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172503;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172503;
            assert(((*out0)->v2 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v2->mem = mem_out_172502;
            (*out0)->v2->shape[0] = prim_out_172503;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_int_sum(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2)
{
    int64_t nz2080U_149774 = (int64_t) 0;
    int64_t group_no_149775 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_149775 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_149774 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_149774 = in2->shape[0];
    if (!(nz2080U_149774 == in1->shape[0] && nz2080U_149774 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_int_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, nz2080U_149774, group_no_149775);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_149775;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_int_sum_xy(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i32_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t nz2080U_149851 = (int64_t) 0;
    int64_t group_no_149852 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_149852 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_149851 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_149851 = in2->shape[0];
    eta_p_mem_171820 = in3->mem;
    nz2080U_149851 = in3->shape[0];
    if (!(nz2080U_149851 == in1->shape[0] && (nz2080U_149851 == in2->shape[0] && nz2080U_149851 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_int_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, nz2080U_149851, group_no_149852);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_149852;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_long_sum(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2)
{
    int64_t nz2080U_149980 = (int64_t) 0;
    int64_t group_no_149981 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_149981 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_149980 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_149980 = in2->shape[0];
    if (!(nz2080U_149980 == in1->shape[0] && nz2080U_149980 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_long_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, nz2080U_149980, group_no_149981);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_149981;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_long_sum_xy(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t nz2080U_150047 = (int64_t) 0;
    int64_t group_no_150048 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_150048 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_150047 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_150047 = in2->shape[0];
    eta_p_mem_171820 = in3->mem;
    nz2080U_150047 = in3->shape[0];
    if (!(nz2080U_150047 == in1->shape[0] && (nz2080U_150047 == in2->shape[0] && nz2080U_150047 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_long_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, nz2080U_150047, group_no_150048);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_150048;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_max_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_80076 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_80076 = in0->shape[0];
    if (!(nz2080U_80076 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_max_idx(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_80076);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_maximum_double(struct futhark_context *ctx, double *out0, const struct futhark_f64_1d *in0)
{
    int64_t nz2080U_80058 = (int64_t) 0;
    double prim_out_172500 = 0.0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_80058 = in0->shape[0];
    if (!(nz2080U_80058 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_maximum_double(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_80058);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_maximum_float(struct futhark_context *ctx, float *out0, const struct futhark_f32_1d *in0)
{
    int64_t nz2080U_79990 = (int64_t) 0;
    float prim_out_172500 = 0.0F;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79990 = in0->shape[0];
    if (!(nz2080U_79990 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_maximum_float(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79990);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_maximum_int(struct futhark_context *ctx, int32_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t nz2080U_79851 = (int64_t) 0;
    int32_t prim_out_172500 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79851 = in0->shape[0];
    if (!(nz2080U_79851 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_maximum_int(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79851);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_maximum_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_79922 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79922 = in0->shape[0];
    if (!(nz2080U_79922 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_maximum_long(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79922);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_maximum_short(struct futhark_context *ctx, int16_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t nz2080U_79780 = (int64_t) 0;
    int16_t prim_out_172500 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79780 = in0->shape[0];
    if (!(nz2080U_79780 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_maximum_short(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79780);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const struct futhark_f64_1d *in1)
{
    int64_t n_113912 = (int64_t) 0;
    int64_t incr_113913 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_113913 = in0;
    xs_mem_171818 = in1->mem;
    n_113912 = in1->shape[0];
    if (!(n_113912 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_double(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_113912, incr_113913);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_113912;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_113912;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const struct futhark_f32_1d *in1)
{
    int64_t n_111767 = (int64_t) 0;
    int64_t incr_111768 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_111768 = in0;
    xs_mem_171818 = in1->mem;
    n_111767 = in1->shape[0];
    if (!(n_111767 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_float(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_111767, incr_111768);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_111767;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_111767;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const struct futhark_i32_1d *in1)
{
    int64_t n_107481 = (int64_t) 0;
    int64_t incr_107482 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_107482 = in0;
    xs_mem_171818 = in1->mem;
    n_107481 = in1->shape[0];
    if (!(n_107481 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_int(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_107481, incr_107482);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_107481;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_107481;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const struct futhark_i64_1d *in1)
{
    int64_t n_109622 = (int64_t) 0;
    int64_t incr_109623 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_109623 = in0;
    xs_mem_171818 = in1->mem;
    n_109622 = in1->shape[0];
    if (!(n_109622 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_long(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_109622, incr_109623);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_109622;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_109622;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const struct futhark_i16_1d *in1)
{
    int64_t n_105336 = (int64_t) 0;
    int64_t incr_105337 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_105337 = in0;
    xs_mem_171818 = in1->mem;
    n_105336 = in1->shape[0];
    if (!(n_105336 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortColumn_short(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_105336, incr_105337);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_105336;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_105336;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const struct futhark_opaque_sortStruct_double *in0)
{
    int64_t n_98843 = (int64_t) 0;
    int64_t b_98844 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    k_mem_171818 = in0->v0->mem;
    n_98843 = in0->v0->shape[0];
    pL_mem_171819 = in0->v1->mem;
    n_98843 = in0->v1->shape[0];
    b_98844 = in0->v1->shape[1];
    if (!(n_98843 == in0->v0->shape[0] && (n_98843 == in0->v1->shape[0] && b_98844 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_double(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_98843, b_98844);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_98843;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_98843;
            (*out0)->v1->shape[1] = b_98844;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const struct futhark_opaque_sortStruct_float *in0)
{
    int64_t n_96478 = (int64_t) 0;
    int64_t b_96479 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    k_mem_171818 = in0->v0->mem;
    n_96478 = in0->v0->shape[0];
    pL_mem_171819 = in0->v1->mem;
    n_96478 = in0->v1->shape[0];
    b_96479 = in0->v1->shape[1];
    if (!(n_96478 == in0->v0->shape[0] && (n_96478 == in0->v1->shape[0] && b_96479 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_float(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_96478, b_96479);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_96478;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_96478;
            (*out0)->v1->shape[1] = b_96479;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const struct futhark_opaque_sortStruct_int *in0)
{
    int64_t n_91754 = (int64_t) 0;
    int64_t b_91755 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    k_mem_171818 = in0->v0->mem;
    n_91754 = in0->v0->shape[0];
    pL_mem_171819 = in0->v1->mem;
    n_91754 = in0->v1->shape[0];
    b_91755 = in0->v1->shape[1];
    if (!(n_91754 == in0->v0->shape[0] && (n_91754 == in0->v1->shape[0] && b_91755 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_int(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_91754, b_91755);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_91754;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_91754;
            (*out0)->v1->shape[1] = b_91755;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const struct futhark_opaque_sortStruct_long *in0)
{
    int64_t n_94113 = (int64_t) 0;
    int64_t b_94114 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    k_mem_171818 = in0->v0->mem;
    n_94113 = in0->v0->shape[0];
    pL_mem_171819 = in0->v1->mem;
    n_94113 = in0->v1->shape[0];
    b_94114 = in0->v1->shape[1];
    if (!(n_94113 == in0->v0->shape[0] && (n_94113 == in0->v1->shape[0] && b_94114 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_long(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_94113, b_94114);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_94113;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_94113;
            (*out0)->v1->shape[1] = b_94114;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_mergeSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const struct futhark_opaque_sortStruct_short *in0)
{
    int64_t n_89389 = (int64_t) 0;
    int64_t b_89390 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    k_mem_171818 = in0->v0->mem;
    n_89389 = in0->v0->shape[0];
    pL_mem_171819 = in0->v1->mem;
    n_89389 = in0->v1->shape[0];
    b_89390 = in0->v1->shape[1];
    if (!(n_89389 == in0->v0->shape[0] && (n_89389 == in0->v1->shape[0] && b_89390 == in0->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_mergeSortRelation_short(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_89389, b_89390);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_89389;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_89389;
            (*out0)->v1->shape[1] = b_89390;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_min_idx(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_80067 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_80067 = in0->shape[0];
    if (!(nz2080U_80067 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_min_idx(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_80067);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_minimum_double(struct futhark_context *ctx, double *out0, const struct futhark_f64_1d *in0)
{
    int64_t nz2080U_80024 = (int64_t) 0;
    double prim_out_172500 = 0.0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_80024 = in0->shape[0];
    if (!(nz2080U_80024 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_minimum_double(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_80024);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_minimum_float(struct futhark_context *ctx, float *out0, const struct futhark_f32_1d *in0)
{
    int64_t nz2080U_79956 = (int64_t) 0;
    float prim_out_172500 = 0.0F;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79956 = in0->shape[0];
    if (!(nz2080U_79956 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_minimum_float(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79956);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_minimum_int(struct futhark_context *ctx, int32_t *out0, const struct futhark_i32_1d *in0)
{
    int64_t nz2080U_79814 = (int64_t) 0;
    int32_t prim_out_172500 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79814 = in0->shape[0];
    if (!(nz2080U_79814 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_minimum_int(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79814);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_minimum_long(struct futhark_context *ctx, int64_t *out0, const struct futhark_i64_1d *in0)
{
    int64_t nz2080U_79885 = (int64_t) 0;
    int64_t prim_out_172500 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79885 = in0->shape[0];
    if (!(nz2080U_79885 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_minimum_long(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79885);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_minimum_short(struct futhark_context *ctx, int16_t *out0, const struct futhark_i16_1d *in0)
{
    int64_t nz2080U_79743 = (int64_t) 0;
    int16_t prim_out_172500 = (int16_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    eta_p_mem_171818 = in0->mem;
    nz2080U_79743 = in0->shape[0];
    if (!(nz2080U_79743 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_minimum_short(ctx, &prim_out_172500, eta_p_mem_171818, nz2080U_79743);
        if (ret == 0) {
            *out0 = prim_out_172500;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_double(struct futhark_context *ctx, struct futhark_f64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f64_1d *in3)
{
    int64_t n_81338 = (int64_t) 0;
    int64_t incr_81339 = (int64_t) 0;
    int64_t block_sizze_81340 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81339 = in0;
    block_sizze_81340 = in1;
    is_mem_171818 = in2->mem;
    n_81338 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    n_81338 = in3->shape[0];
    if (!(n_81338 == in2->shape[0] && n_81338 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_double(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, n_81338, incr_81339, block_sizze_81340);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = n_81338;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_float(struct futhark_context *ctx, struct futhark_f32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_f32_1d *in3)
{
    int64_t n_81086 = (int64_t) 0;
    int64_t incr_81087 = (int64_t) 0;
    int64_t block_sizze_81088 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_81087 = in0;
    block_sizze_81088 = in1;
    is_mem_171818 = in2->mem;
    n_81086 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    n_81086 = in3->shape[0];
    if (!(n_81086 == in2->shape[0] && n_81086 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_float(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, n_81086, incr_81087, block_sizze_81088);
        if (ret == 0) {
            assert((*out0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = n_81086;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_int(struct futhark_context *ctx, struct futhark_i32_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i32_1d *in3)
{
    int64_t n_80582 = (int64_t) 0;
    int64_t incr_80583 = (int64_t) 0;
    int64_t block_sizze_80584 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_80583 = in0;
    block_sizze_80584 = in1;
    is_mem_171818 = in2->mem;
    n_80582 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    n_80582 = in3->shape[0];
    if (!(n_80582 == in2->shape[0] && n_80582 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_int(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, n_80582, incr_80583, block_sizze_80584);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = n_80582;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_long(struct futhark_context *ctx, struct futhark_i64_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i64_1d *in3)
{
    int64_t n_80834 = (int64_t) 0;
    int64_t incr_80835 = (int64_t) 0;
    int64_t block_sizze_80836 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_80835 = in0;
    block_sizze_80836 = in1;
    is_mem_171818 = in2->mem;
    n_80834 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    n_80834 = in3->shape[0];
    if (!(n_80834 == in2->shape[0] && n_80834 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_long(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, n_80834, incr_80835, block_sizze_80836);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = n_80834;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_orderByIndices_short(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t n_80330 = (int64_t) 0;
    int64_t incr_80331 = (int64_t) 0;
    int64_t block_sizze_80332 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ys_mem_171819;
    
    ys_mem_171819.references = NULL;
    
    struct memblock is_mem_171818;
    
    is_mem_171818.references = NULL;
    incr_80331 = in0;
    block_sizze_80332 = in1;
    is_mem_171818 = in2->mem;
    n_80330 = in2->shape[0];
    ys_mem_171819 = in3->mem;
    n_80330 = in3->shape[0];
    if (!(n_80330 == in2->shape[0] && n_80330 == in3->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_orderByIndices_short(ctx, &mem_out_172500, is_mem_171818, ys_mem_171819, n_80330, incr_80331, block_sizze_80332);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = n_80330;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFTR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFTR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const struct futhark_u8_2d *in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_130036 = (int64_t) 0;
    int64_t b_130037 = (int64_t) 0;
    int64_t pL_b_130038 = (int64_t) 0;
    int16_t block_sizze_130039 = (int16_t) 0;
    int64_t gather_psizze_130040 = (int64_t) 0;
    int32_t radix_sizze_130041 = 0;
    int64_t sizze_thresh_130044 = (int64_t) 0;
    int32_t max_depth_130045 = 0;
    int32_t bit_step_130046 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    block_sizze_130039 = in0;
    gather_psizze_130040 = in1;
    radix_sizze_130041 = in2;
    xs_mem_171818 = in3->mem;
    n_130036 = in3->shape[0];
    b_130037 = in3->shape[1];
    pL_mem_171819 = in4->mem;
    n_130036 = in4->shape[0];
    pL_b_130038 = in4->shape[1];
    sizze_thresh_130044 = in5;
    max_depth_130045 = in6;
    bit_step_130046 = in7;
    if (!((n_130036 == in3->shape[0] && b_130037 == in3->shape[1]) && (n_130036 == in4->shape[0] && pL_b_130038 == in4->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFTR(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, pL_mem_171819, n_130036, b_130037, pL_b_130038, block_sizze_130039, gather_psizze_130040, radix_sizze_130041, sizze_thresh_130044, max_depth_130045, bit_step_130046);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFTR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFTR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_130036;
            (*out0)->v0->shape[1] = b_130037;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_130036;
            (*out0)->v1->shape[1] = pL_b_130038;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_partition_and_deepen_GFUR(struct futhark_context *ctx, struct futhark_opaque_partitionedSet_GFUR **out0, const int16_t in0, const int64_t in1, const int32_t in2, const struct futhark_u8_2d *in3, const int64_t in4, const int64_t in5, const int32_t in6, const int32_t in7)
{
    int64_t n_131406 = (int64_t) 0;
    int64_t b_131407 = (int64_t) 0;
    int16_t block_sizze_131408 = (int16_t) 0;
    int64_t gather_psizze_131409 = (int64_t) 0;
    int32_t radix_sizze_131410 = 0;
    int64_t offset_131412 = (int64_t) 0;
    int64_t sizze_thresh_131413 = (int64_t) 0;
    int32_t max_depth_131414 = 0;
    int32_t bit_step_131415 = 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    block_sizze_131408 = in0;
    gather_psizze_131409 = in1;
    radix_sizze_131410 = in2;
    xs_mem_171818 = in3->mem;
    n_131406 = in3->shape[0];
    b_131407 = in3->shape[1];
    offset_131412 = in4;
    sizze_thresh_131413 = in5;
    max_depth_131414 = in6;
    bit_step_131415 = in7;
    if (!(n_131406 == in3->shape[0] && b_131407 == in3->shape[1])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_partition_and_deepen_GFUR(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_131406, b_131407, block_sizze_131408, gather_psizze_131409, radix_sizze_131410, offset_131412, sizze_thresh_131413, max_depth_131414, bit_step_131415);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_partitionedSet_GFUR *) malloc(sizeof(struct futhark_opaque_partitionedSet_GFUR))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_131406;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_131406;
            (*out0)->v1->shape[1] = b_131407;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_double(struct futhark_context *ctx, struct futhark_opaque_sortInfo_double **out0, const int64_t in0, const int64_t in1, const struct futhark_f64_1d *in2)
{
    int64_t n_103190 = (int64_t) 0;
    int64_t incr_103191 = (int64_t) 0;
    int64_t block_sizze_103192 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_103191 = in0;
    block_sizze_103192 = in1;
    xs_mem_171818 = in2->mem;
    n_103190 = in2->shape[0];
    if (!(n_103190 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_double(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_103190, incr_103191, block_sizze_103192);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_double *) malloc(sizeof(struct futhark_opaque_sortInfo_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_103190;
            assert(((*out0)->v1 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_103190;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_float(struct futhark_context *ctx, struct futhark_opaque_sortInfo_float **out0, const int64_t in0, const int64_t in1, const struct futhark_f32_1d *in2)
{
    int64_t n_102308 = (int64_t) 0;
    int64_t incr_102309 = (int64_t) 0;
    int64_t block_sizze_102310 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_102309 = in0;
    block_sizze_102310 = in1;
    xs_mem_171818 = in2->mem;
    n_102308 = in2->shape[0];
    if (!(n_102308 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_float(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_102308, incr_102309, block_sizze_102310);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_float *) malloc(sizeof(struct futhark_opaque_sortInfo_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_102308;
            assert(((*out0)->v1 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_102308;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_int(struct futhark_context *ctx, struct futhark_opaque_sortInfo_int **out0, const int64_t in0, const int64_t in1, const struct futhark_i32_1d *in2)
{
    int64_t n_100565 = (int64_t) 0;
    int64_t incr_100566 = (int64_t) 0;
    int64_t block_sizze_100567 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_100566 = in0;
    block_sizze_100567 = in1;
    xs_mem_171818 = in2->mem;
    n_100565 = in2->shape[0];
    if (!(n_100565 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_int(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_100565, incr_100566, block_sizze_100567);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_int *) malloc(sizeof(struct futhark_opaque_sortInfo_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_100565;
            assert(((*out0)->v1 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_100565;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_long(struct futhark_context *ctx, struct futhark_opaque_sortInfo_long **out0, const int64_t in0, const int64_t in1, const struct futhark_i64_1d *in2)
{
    int64_t n_101426 = (int64_t) 0;
    int64_t incr_101427 = (int64_t) 0;
    int64_t block_sizze_101428 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_101427 = in0;
    block_sizze_101428 = in1;
    xs_mem_171818 = in2->mem;
    n_101426 = in2->shape[0];
    if (!(n_101426 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_long(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_101426, incr_101427, block_sizze_101428);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_long *) malloc(sizeof(struct futhark_opaque_sortInfo_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_101426;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_101426;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortColumn_short(struct futhark_context *ctx, struct futhark_opaque_sortInfo_short **out0, const int64_t in0, const int64_t in1, const struct futhark_i16_1d *in2)
{
    int64_t n_99704 = (int64_t) 0;
    int64_t incr_99705 = (int64_t) 0;
    int64_t block_sizze_99706 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock xs_mem_171818;
    
    xs_mem_171818.references = NULL;
    incr_99705 = in0;
    block_sizze_99706 = in1;
    xs_mem_171818 = in2->mem;
    n_99704 = in2->shape[0];
    if (!(n_99704 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortColumn_short(ctx, &mem_out_172500, &mem_out_172501, xs_mem_171818, n_99704, incr_99705, block_sizze_99706);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortInfo_short *) malloc(sizeof(struct futhark_opaque_sortInfo_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_99704;
            assert(((*out0)->v1 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_99704;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_double(struct futhark_context *ctx, struct futhark_opaque_sortStruct_double **out0, const int64_t in0, const struct futhark_opaque_sortStruct_double *in1)
{
    int64_t n_86918 = (int64_t) 0;
    int64_t b_86919 = (int64_t) 0;
    int64_t block_sizze_86920 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    block_sizze_86920 = in0;
    k_mem_171818 = in1->v0->mem;
    n_86918 = in1->v0->shape[0];
    pL_mem_171819 = in1->v1->mem;
    n_86918 = in1->v1->shape[0];
    b_86919 = in1->v1->shape[1];
    if (!(n_86918 == in1->v0->shape[0] && (n_86918 == in1->v1->shape[0] && b_86919 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_double(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_86918, b_86919, block_sizze_86920);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_double *) malloc(sizeof(struct futhark_opaque_sortStruct_double))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_86918;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_86918;
            (*out0)->v1->shape[1] = b_86919;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_float(struct futhark_context *ctx, struct futhark_opaque_sortStruct_float **out0, const int64_t in0, const struct futhark_opaque_sortStruct_float *in1)
{
    int64_t n_85975 = (int64_t) 0;
    int64_t b_85976 = (int64_t) 0;
    int64_t block_sizze_85977 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    block_sizze_85977 = in0;
    k_mem_171818 = in1->v0->mem;
    n_85975 = in1->v0->shape[0];
    pL_mem_171819 = in1->v1->mem;
    n_85975 = in1->v1->shape[0];
    b_85976 = in1->v1->shape[1];
    if (!(n_85975 == in1->v0->shape[0] && (n_85975 == in1->v1->shape[0] && b_85976 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_float(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_85975, b_85976, block_sizze_85977);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_float *) malloc(sizeof(struct futhark_opaque_sortStruct_float))) != NULL);
            assert(((*out0)->v0 = (struct futhark_f32_1d *) malloc(sizeof(struct futhark_f32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_85975;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_85975;
            (*out0)->v1->shape[1] = b_85976;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_int(struct futhark_context *ctx, struct futhark_opaque_sortStruct_int **out0, const int64_t in0, const struct futhark_opaque_sortStruct_int *in1)
{
    int64_t n_84157 = (int64_t) 0;
    int64_t b_84158 = (int64_t) 0;
    int64_t block_sizze_84159 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    block_sizze_84159 = in0;
    k_mem_171818 = in1->v0->mem;
    n_84157 = in1->v0->shape[0];
    pL_mem_171819 = in1->v1->mem;
    n_84157 = in1->v1->shape[0];
    b_84158 = in1->v1->shape[1];
    if (!(n_84157 == in1->v0->shape[0] && (n_84157 == in1->v1->shape[0] && b_84158 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_int(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_84157, b_84158, block_sizze_84159);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_int *) malloc(sizeof(struct futhark_opaque_sortStruct_int))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i32_1d *) malloc(sizeof(struct futhark_i32_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_84157;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_84157;
            (*out0)->v1->shape[1] = b_84158;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_long(struct futhark_context *ctx, struct futhark_opaque_sortStruct_long **out0, const int64_t in0, const struct futhark_opaque_sortStruct_long *in1)
{
    int64_t n_85036 = (int64_t) 0;
    int64_t b_85037 = (int64_t) 0;
    int64_t block_sizze_85038 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    block_sizze_85038 = in0;
    k_mem_171818 = in1->v0->mem;
    n_85036 = in1->v0->shape[0];
    pL_mem_171819 = in1->v1->mem;
    n_85036 = in1->v1->shape[0];
    b_85037 = in1->v1->shape[1];
    if (!(n_85036 == in1->v0->shape[0] && (n_85036 == in1->v1->shape[0] && b_85037 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_long(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_85036, b_85037, block_sizze_85038);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_long *) malloc(sizeof(struct futhark_opaque_sortStruct_long))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_85036;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_85036;
            (*out0)->v1->shape[1] = b_85037;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_radixSortRelation_short(struct futhark_context *ctx, struct futhark_opaque_sortStruct_short **out0, const int64_t in0, const struct futhark_opaque_sortStruct_short *in1)
{
    int64_t n_83270 = (int64_t) 0;
    int64_t b_83271 = (int64_t) 0;
    int64_t block_sizze_83272 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock pL_mem_171819;
    
    pL_mem_171819.references = NULL;
    
    struct memblock k_mem_171818;
    
    k_mem_171818.references = NULL;
    block_sizze_83272 = in0;
    k_mem_171818 = in1->v0->mem;
    n_83270 = in1->v0->shape[0];
    pL_mem_171819 = in1->v1->mem;
    n_83270 = in1->v1->shape[0];
    b_83271 = in1->v1->shape[1];
    if (!(n_83270 == in1->v0->shape[0] && (n_83270 == in1->v1->shape[0] && b_83271 == in1->v1->shape[1]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_radixSortRelation_short(ctx, &mem_out_172500, &mem_out_172501, k_mem_171818, pL_mem_171819, n_83270, b_83271, block_sizze_83272);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortStruct_short *) malloc(sizeof(struct futhark_opaque_sortStruct_short))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = n_83270;
            assert(((*out0)->v1 = (struct futhark_u8_2d *) malloc(sizeof(struct futhark_u8_2d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = n_83270;
            (*out0)->v1->shape[1] = b_83271;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_short_sum(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2)
{
    int64_t nz2080U_149566 = (int64_t) 0;
    int64_t group_no_149567 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_149567 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_149566 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_149566 = in2->shape[0];
    if (!(nz2080U_149566 == in1->shape[0] && nz2080U_149566 == in2->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_short_sum(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, nz2080U_149566, group_no_149567);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_149567;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_short_sum_xy(struct futhark_context *ctx, struct futhark_i16_1d **out0, const int64_t in0, const struct futhark_i64_1d *in1, const struct futhark_i16_1d *in2, const struct futhark_i16_1d *in3)
{
    int64_t nz2080U_149643 = (int64_t) 0;
    int64_t group_no_149644 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock eta_p_mem_171820;
    
    eta_p_mem_171820.references = NULL;
    
    struct memblock eta_p_mem_171819;
    
    eta_p_mem_171819.references = NULL;
    
    struct memblock eta_p_mem_171818;
    
    eta_p_mem_171818.references = NULL;
    group_no_149644 = in0;
    eta_p_mem_171818 = in1->mem;
    nz2080U_149643 = in1->shape[0];
    eta_p_mem_171819 = in2->mem;
    nz2080U_149643 = in2->shape[0];
    eta_p_mem_171820 = in3->mem;
    nz2080U_149643 = in3->shape[0];
    if (!(nz2080U_149643 == in1->shape[0] && (nz2080U_149643 == in2->shape[0] && nz2080U_149643 == in3->shape[0]))) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_short_sum_xy(ctx, &mem_out_172500, eta_p_mem_171818, eta_p_mem_171819, eta_p_mem_171820, nz2080U_149643, group_no_149644);
        if (ret == 0) {
            assert((*out0 = (struct futhark_i16_1d *) malloc(sizeof(struct futhark_i16_1d))) != NULL);
            (*out0)->mem = mem_out_172500;
            (*out0)->shape[0] = group_no_149644;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0, const struct futhark_f64_1d *in1)
{
    int64_t dz2080U_147656 = (int64_t) 0;
    int64_t dz2081U_147657 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171819;
    
    ks_mem_171819.references = NULL;
    
    struct memblock k_ids_mem_171818;
    
    k_ids_mem_171818.references = NULL;
    k_ids_mem_171818 = in0->mem;
    dz2080U_147656 = in0->shape[0];
    ks_mem_171819 = in1->mem;
    dz2081U_147657 = in1->shape[0];
    if (!(dz2080U_147656 == in0->shape[0] && dz2081U_147657 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_double(ctx, &mem_out_172500, &mem_out_172501, k_ids_mem_171818, ks_mem_171819, dz2080U_147656, dz2081U_147657);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = dz2080U_147656;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = dz2080U_147656;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0, const struct futhark_f32_1d *in1)
{
    int64_t dz2080U_146866 = (int64_t) 0;
    int64_t dz2081U_146867 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171819;
    
    ks_mem_171819.references = NULL;
    
    struct memblock k_ids_mem_171818;
    
    k_ids_mem_171818.references = NULL;
    k_ids_mem_171818 = in0->mem;
    dz2080U_146866 = in0->shape[0];
    ks_mem_171819 = in1->mem;
    dz2081U_146867 = in1->shape[0];
    if (!(dz2080U_146866 == in0->shape[0] && dz2081U_146867 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_float(ctx, &mem_out_172500, &mem_out_172501, k_ids_mem_171818, ks_mem_171819, dz2080U_146866, dz2081U_146867);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = dz2080U_146866;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = dz2080U_146866;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0, const struct futhark_i32_1d *in1)
{
    int64_t dz2080U_145286 = (int64_t) 0;
    int64_t dz2081U_145287 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171819;
    
    ks_mem_171819.references = NULL;
    
    struct memblock k_ids_mem_171818;
    
    k_ids_mem_171818.references = NULL;
    k_ids_mem_171818 = in0->mem;
    dz2080U_145286 = in0->shape[0];
    ks_mem_171819 = in1->mem;
    dz2081U_145287 = in1->shape[0];
    if (!(dz2080U_145286 == in0->shape[0] && dz2081U_145287 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_int(ctx, &mem_out_172500, &mem_out_172501, k_ids_mem_171818, ks_mem_171819, dz2080U_145286, dz2081U_145287);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = dz2080U_145286;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = dz2080U_145286;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0, const struct futhark_i64_1d *in1)
{
    int64_t dz2080U_146076 = (int64_t) 0;
    int64_t dz2081U_146077 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171819;
    
    ks_mem_171819.references = NULL;
    
    struct memblock k_ids_mem_171818;
    
    k_ids_mem_171818.references = NULL;
    k_ids_mem_171818 = in0->mem;
    dz2080U_146076 = in0->shape[0];
    ks_mem_171819 = in1->mem;
    dz2081U_146077 = in1->shape[0];
    if (!(dz2080U_146076 == in0->shape[0] && dz2081U_146077 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_long(ctx, &mem_out_172500, &mem_out_172501, k_ids_mem_171818, ks_mem_171819, dz2080U_146076, dz2081U_146077);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = dz2080U_146076;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = dz2080U_146076;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_known_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0, const struct futhark_i16_1d *in1)
{
    int64_t dz2080U_144496 = (int64_t) 0;
    int64_t dz2081U_144497 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171819;
    
    ks_mem_171819.references = NULL;
    
    struct memblock k_ids_mem_171818;
    
    k_ids_mem_171818.references = NULL;
    k_ids_mem_171818 = in0->mem;
    dz2080U_144496 = in0->shape[0];
    ks_mem_171819 = in1->mem;
    dz2081U_144497 = in1->shape[0];
    if (!(dz2080U_144496 == in0->shape[0] && dz2081U_144497 == in1->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_known_key_counts_short(ctx, &mem_out_172500, &mem_out_172501, k_ids_mem_171818, ks_mem_171819, dz2080U_144496, dz2081U_144497);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = dz2080U_144496;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = dz2080U_144496;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_double(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f64_1d *in0)
{
    int64_t dz2080U_149434 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    dz2080U_149434 = in0->shape[0];
    if (!(dz2080U_149434 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_double(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, ks_mem_171818, dz2080U_149434);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_float(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_f32_1d *in0)
{
    int64_t dz2080U_149086 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    dz2080U_149086 = in0->shape[0];
    if (!(dz2080U_149086 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_float(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, ks_mem_171818, dz2080U_149086);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_int(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i32_1d *in0)
{
    int64_t dz2080U_148390 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    dz2080U_148390 = in0->shape[0];
    if (!(dz2080U_148390 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_int(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, ks_mem_171818, dz2080U_148390);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_long(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i64_1d *in0)
{
    int64_t dz2080U_148738 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    dz2080U_148738 = in0->shape[0];
    if (!(dz2080U_148738 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_long(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, ks_mem_171818, dz2080U_148738);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_sortgroup_find_unknown_key_counts_short(struct futhark_context *ctx, struct futhark_opaque_sortgroupInfo **out0, const struct futhark_i16_1d *in0)
{
    int64_t dz2080U_148042 = (int64_t) 0;
    int64_t prim_out_172502 = (int64_t) 0;
    int ret = 0;
    
    lock_lock(&ctx->lock);
    
    struct memblock mem_out_172501;
    
    mem_out_172501.references = NULL;
    
    struct memblock mem_out_172500;
    
    mem_out_172500.references = NULL;
    
    struct memblock ks_mem_171818;
    
    ks_mem_171818.references = NULL;
    ks_mem_171818 = in0->mem;
    dz2080U_148042 = in0->shape[0];
    if (!(dz2080U_148042 == in0->shape[0])) {
        ret = 1;
        set_error(ctx, msgprintf("Error: entry point arguments have invalid sizes.\n"));
    }
    if (ret == 0) {
        ret = futrts_entry_sortgroup_find_unknown_key_counts_short(ctx, &mem_out_172500, &mem_out_172501, &prim_out_172502, ks_mem_171818, dz2080U_148042);
        if (ret == 0) {
            assert((*out0 = (struct futhark_opaque_sortgroupInfo *) malloc(sizeof(struct futhark_opaque_sortgroupInfo))) != NULL);
            assert(((*out0)->v0 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v0->mem = mem_out_172500;
            (*out0)->v0->shape[0] = prim_out_172502;
            assert(((*out0)->v1 = (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) != NULL);
            (*out0)->v1->mem = mem_out_172501;
            (*out0)->v1->shape[0] = prim_out_172502;
        }
    }
    lock_unlock(&ctx->lock);
    return ret;
}
  
